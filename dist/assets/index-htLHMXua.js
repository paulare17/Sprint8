var V$=Object.defineProperty;var U$=(t,e,n)=>e in t?V$(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n;var ki=(t,e,n)=>U$(t,typeof e!="symbol"?e+"":e,n);function j$(t,e){for(var n=0;n<e.length;n++){const r=e[n];if(typeof r!="string"&&!Array.isArray(r)){for(const c in r)if(c!=="default"&&!(c in t)){const d=Object.getOwnPropertyDescriptor(r,c);d&&Object.defineProperty(t,c,d.get?d:{enumerable:!0,get:()=>r[c]})}}}return Object.freeze(Object.defineProperty(t,Symbol.toStringTag,{value:"Module"}))}(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const c of document.querySelectorAll('link[rel="modulepreload"]'))r(c);new MutationObserver(c=>{for(const d of c)if(d.type==="childList")for(const m of d.addedNodes)m.tagName==="LINK"&&m.rel==="modulepreload"&&r(m)}).observe(document,{childList:!0,subtree:!0});function n(c){const d={};return c.integrity&&(d.integrity=c.integrity),c.referrerPolicy&&(d.referrerPolicy=c.referrerPolicy),c.crossOrigin==="use-credentials"?d.credentials="include":c.crossOrigin==="anonymous"?d.credentials="omit":d.credentials="same-origin",d}function r(c){if(c.ep)return;c.ep=!0;const d=n(c);fetch(c.href,d)}})();function AA(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var ZM={exports:{}},qD={},XM={exports:{}},bS={exports:{}};bS.exports;var KL;function H$(){return KL||(KL=1,function(t,e){/**
 * @license React
 * react.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){function n(Ge,xt){Object.defineProperty(d.prototype,Ge,{get:function(){console.warn("%s(...) is deprecated in plain JavaScript React classes. %s",xt[0],xt[1])}})}function r(Ge){return Ge===null||typeof Ge!="object"?null:(Ge=Kn&&Ge[Kn]||Ge["@@iterator"],typeof Ge=="function"?Ge:null)}function c(Ge,xt){Ge=(Ge=Ge.constructor)&&(Ge.displayName||Ge.name)||"ReactClass";var Pn=Ge+"."+xt;Bt[Pn]||(console.error("Can't call %s on a component that is not yet mounted. This is a no-op, but it might indicate a bug in your application. Instead, assign to `this.state` directly or define a `state = {};` class property with the desired state in the %s component.",xt,Ge),Bt[Pn]=!0)}function d(Ge,xt,Pn){this.props=Ge,this.context=xt,this.refs=_r,this.updater=Pn||ni}function m(){}function s(Ge,xt,Pn){this.props=Ge,this.context=xt,this.refs=_r,this.updater=Pn||ni}function T(Ge){return""+Ge}function D(Ge){try{T(Ge);var xt=!1}catch{xt=!0}if(xt){xt=console;var Pn=xt.error,jn=typeof Symbol=="function"&&Symbol.toStringTag&&Ge[Symbol.toStringTag]||Ge.constructor.name||"Object";return Pn.call(xt,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",jn),T(Ge)}}function P(Ge){if(Ge==null)return null;if(typeof Ge=="function")return Ge.$$typeof===Nr?null:Ge.displayName||Ge.name||null;if(typeof Ge=="string")return Ge;switch(Ge){case Fe:return"Fragment";case Ut:return"Profiler";case Ot:return"StrictMode";case Ht:return"Suspense";case Mn:return"SuspenseList";case Cn:return"Activity"}if(typeof Ge=="object")switch(typeof Ge.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),Ge.$$typeof){case Xt:return"Portal";case wn:return(Ge.displayName||"Context")+".Provider";case ln:return(Ge._context.displayName||"Context")+".Consumer";case dn:var xt=Ge.render;return Ge=Ge.displayName,Ge||(Ge=xt.displayName||xt.name||"",Ge=Ge!==""?"ForwardRef("+Ge+")":"ForwardRef"),Ge;case yn:return xt=Ge.displayName||null,xt!==null?xt:P(Ge.type)||"Memo";case Tn:xt=Ge._payload,Ge=Ge._init;try{return P(Ge(xt))}catch{}}return null}function z(Ge){if(Ge===Fe)return"<>";if(typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===Tn)return"<...>";try{var xt=P(Ge);return xt?"<"+xt+">":"<...>"}catch{return"<...>"}}function F(){var Ge=ti.A;return Ge===null?null:Ge.getOwner()}function $(){return Error("react-stack-top-frame")}function J(Ge){if(dr.call(Ge,"key")){var xt=Object.getOwnPropertyDescriptor(Ge,"key").get;if(xt&&xt.isReactWarning)return!1}return Ge.key!==void 0}function X(Ge,xt){function Pn(){ks||(ks=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",xt))}Pn.isReactWarning=!0,Object.defineProperty(Ge,"key",{get:Pn,configurable:!0})}function te(){var Ge=P(this.type);return Uo[Ge]||(Uo[Ge]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),Ge=this.props.ref,Ge!==void 0?Ge:null}function ie(Ge,xt,Pn,jn,Wn,zi,Ri,Ii){return Pn=zi.ref,Ge={$$typeof:rn,type:Ge,key:xt,props:zi,_owner:Wn},(Pn!==void 0?Pn:null)!==null?Object.defineProperty(Ge,"ref",{enumerable:!1,get:te}):Object.defineProperty(Ge,"ref",{enumerable:!1,value:null}),Ge._store={},Object.defineProperty(Ge._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(Ge,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(Ge,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Ri}),Object.defineProperty(Ge,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:Ii}),Object.freeze&&(Object.freeze(Ge.props),Object.freeze(Ge)),Ge}function we(Ge,xt){return xt=ie(Ge.type,xt,void 0,void 0,Ge._owner,Ge.props,Ge._debugStack,Ge._debugTask),Ge._store&&(xt._store.validated=Ge._store.validated),xt}function Ie(Ge){return typeof Ge=="object"&&Ge!==null&&Ge.$$typeof===rn}function Re(Ge){var xt={"=":"=0",":":"=2"};return"$"+Ge.replace(/[=:]/g,function(Pn){return xt[Pn]})}function Ne(Ge,xt){return typeof Ge=="object"&&Ge!==null&&Ge.key!=null?(D(Ge.key),Re(""+Ge.key)):xt.toString(36)}function Xe(){}function be(Ge){switch(Ge.status){case"fulfilled":return Ge.value;case"rejected":throw Ge.reason;default:switch(typeof Ge.status=="string"?Ge.then(Xe,Xe):(Ge.status="pending",Ge.then(function(xt){Ge.status==="pending"&&(Ge.status="fulfilled",Ge.value=xt)},function(xt){Ge.status==="pending"&&(Ge.status="rejected",Ge.reason=xt)})),Ge.status){case"fulfilled":return Ge.value;case"rejected":throw Ge.reason}}throw Ge}function _e(Ge,xt,Pn,jn,Wn){var zi=typeof Ge;(zi==="undefined"||zi==="boolean")&&(Ge=null);var Ri=!1;if(Ge===null)Ri=!0;else switch(zi){case"bigint":case"string":case"number":Ri=!0;break;case"object":switch(Ge.$$typeof){case rn:case Xt:Ri=!0;break;case Tn:return Ri=Ge._init,_e(Ri(Ge._payload),xt,Pn,jn,Wn)}}if(Ri){Ri=Ge,Wn=Wn(Ri);var Ii=jn===""?"."+Ne(Ri,0):jn;return ss(Wn)?(Pn="",Ii!=null&&(Pn=Ii.replace(ro,"$&/")+"/"),_e(Wn,xt,Pn,"",function($r){return $r})):Wn!=null&&(Ie(Wn)&&(Wn.key!=null&&(Ri&&Ri.key===Wn.key||D(Wn.key)),Pn=we(Wn,Pn+(Wn.key==null||Ri&&Ri.key===Wn.key?"":(""+Wn.key).replace(ro,"$&/")+"/")+Ii),jn!==""&&Ri!=null&&Ie(Ri)&&Ri.key==null&&Ri._store&&!Ri._store.validated&&(Pn._store.validated=2),Wn=Pn),xt.push(Wn)),1}if(Ri=0,Ii=jn===""?".":jn+":",ss(Ge))for(var Lt=0;Lt<Ge.length;Lt++)jn=Ge[Lt],zi=Ii+Ne(jn,Lt),Ri+=_e(jn,xt,Pn,zi,Wn);else if(Lt=r(Ge),typeof Lt=="function")for(Lt===Ge.entries&&(Po||console.warn("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),Po=!0),Ge=Lt.call(Ge),Lt=0;!(jn=Ge.next()).done;)jn=jn.value,zi=Ii+Ne(jn,Lt++),Ri+=_e(jn,xt,Pn,zi,Wn);else if(zi==="object"){if(typeof Ge.then=="function")return _e(be(Ge),xt,Pn,jn,Wn);throw xt=String(Ge),Error("Objects are not valid as a React child (found: "+(xt==="[object Object]"?"object with keys {"+Object.keys(Ge).join(", ")+"}":xt)+"). If you meant to render a collection of children, use an array instead.")}return Ri}function Te(Ge,xt,Pn){if(Ge==null)return Ge;var jn=[],Wn=0;return _e(Ge,jn,"","",function(zi){return xt.call(Pn,zi,Wn++)}),jn}function oe(Ge){if(Ge._status===-1){var xt=Ge._result;xt=xt(),xt.then(function(Pn){(Ge._status===0||Ge._status===-1)&&(Ge._status=1,Ge._result=Pn)},function(Pn){(Ge._status===0||Ge._status===-1)&&(Ge._status=2,Ge._result=Pn)}),Ge._status===-1&&(Ge._status=0,Ge._result=xt)}if(Ge._status===1)return xt=Ge._result,xt===void 0&&console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))

Did you accidentally put curly braces around the import?`,xt),"default"in xt||console.error(`lazy: Expected the result of a dynamic import() call. Instead received: %s

Your code should look like: 
  const MyComponent = lazy(() => import('./MyComponent'))`,xt),xt.default;throw Ge._result}function Ee(){var Ge=ti.H;return Ge===null&&console.error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`),Ge}function $e(){}function ze(Ge){if(ps===null)try{var xt=("require"+Math.random()).slice(0,7);ps=(t&&t[xt]).call(t,"timers").setImmediate}catch{ps=function(jn){Or===!1&&(Or=!0,typeof MessageChannel>"u"&&console.error("This browser does not have a MessageChannel implementation, so enqueuing tasks via await act(async () => ...) will fail. Please file an issue at https://github.com/facebook/react/issues if you encounter this warning."));var Wn=new MessageChannel;Wn.port1.onmessage=jn,Wn.port2.postMessage(void 0)}}return ps(Ge)}function zt(Ge){return 1<Ge.length&&typeof AggregateError=="function"?new AggregateError(Ge):Ge[0]}function St(Ge,xt){xt!==Ns-1&&console.error("You seem to have overlapping act() calls, this is not supported. Be sure to await previous act() calls before making a new one. "),Ns=xt}function mt(Ge,xt,Pn){var jn=ti.actQueue;if(jn!==null)if(jn.length!==0)try{Ft(jn),ze(function(){return mt(Ge,xt,Pn)});return}catch(Wn){ti.thrownErrors.push(Wn)}else ti.actQueue=null;0<ti.thrownErrors.length?(jn=zt(ti.thrownErrors),ti.thrownErrors.length=0,Pn(jn)):xt(Ge)}function Ft(Ge){if(!Xs){Xs=!0;var xt=0;try{for(;xt<Ge.length;xt++){var Pn=Ge[xt];do{ti.didUsePromise=!1;var jn=Pn(!1);if(jn!==null){if(ti.didUsePromise){Ge[xt]=Pn,Ge.splice(0,xt);return}Pn=jn}else break}while(!0)}Ge.length=0}catch(Wn){Ge.splice(0,xt+1),ti.thrownErrors.push(Wn)}finally{Xs=!1}}}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var rn=Symbol.for("react.transitional.element"),Xt=Symbol.for("react.portal"),Fe=Symbol.for("react.fragment"),Ot=Symbol.for("react.strict_mode"),Ut=Symbol.for("react.profiler"),ln=Symbol.for("react.consumer"),wn=Symbol.for("react.context"),dn=Symbol.for("react.forward_ref"),Ht=Symbol.for("react.suspense"),Mn=Symbol.for("react.suspense_list"),yn=Symbol.for("react.memo"),Tn=Symbol.for("react.lazy"),Cn=Symbol.for("react.activity"),Kn=Symbol.iterator,Bt={},ni={isMounted:function(){return!1},enqueueForceUpdate:function(Ge){c(Ge,"forceUpdate")},enqueueReplaceState:function(Ge){c(Ge,"replaceState")},enqueueSetState:function(Ge){c(Ge,"setState")}},er=Object.assign,_r={};Object.freeze(_r),d.prototype.isReactComponent={},d.prototype.setState=function(Ge,xt){if(typeof Ge!="object"&&typeof Ge!="function"&&Ge!=null)throw Error("takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,Ge,xt,"setState")},d.prototype.forceUpdate=function(Ge){this.updater.enqueueForceUpdate(this,Ge,"forceUpdate")};var Li={isMounted:["isMounted","Instead, make sure to clean up subscriptions and pending requests in componentWillUnmount to prevent memory leaks."],replaceState:["replaceState","Refactor your code to use setState instead (see https://github.com/facebook/react/issues/3236)."]},jr;for(jr in Li)Li.hasOwnProperty(jr)&&n(jr,Li[jr]);m.prototype=d.prototype,Li=s.prototype=new m,Li.constructor=s,er(Li,d.prototype),Li.isPureReactComponent=!0;var ss=Array.isArray,Nr=Symbol.for("react.client.reference"),ti={H:null,A:null,T:null,S:null,V:null,actQueue:null,isBatchingLegacy:!1,didScheduleLegacyUpdate:!1,didUsePromise:!1,thrownErrors:[],getCurrentStack:null,recentlyCreatedOwnerStacks:0},dr=Object.prototype.hasOwnProperty,di=console.createTask?console.createTask:function(){return null};Li={"react-stack-bottom-frame":function(Ge){return Ge()}};var ks,fs,Uo={},Kr=Li["react-stack-bottom-frame"].bind(Li,$)(),ir=di(z($)),Po=!1,ro=/\/+/g,jo=typeof reportError=="function"?reportError:function(Ge){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var xt=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof Ge=="object"&&Ge!==null&&typeof Ge.message=="string"?String(Ge.message):String(Ge),error:Ge});if(!window.dispatchEvent(xt))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",Ge);return}console.error(Ge)},Or=!1,ps=null,Ns=0,Hr=!1,Xs=!1,ho=typeof queueMicrotask=="function"?function(Ge){queueMicrotask(function(){return queueMicrotask(Ge)})}:ze;Li=Object.freeze({__proto__:null,c:function(Ge){return Ee().useMemoCache(Ge)}}),e.Children={map:Te,forEach:function(Ge,xt,Pn){Te(Ge,function(){xt.apply(this,arguments)},Pn)},count:function(Ge){var xt=0;return Te(Ge,function(){xt++}),xt},toArray:function(Ge){return Te(Ge,function(xt){return xt})||[]},only:function(Ge){if(!Ie(Ge))throw Error("React.Children.only expected to receive a single React element child.");return Ge}},e.Component=d,e.Fragment=Fe,e.Profiler=Ut,e.PureComponent=s,e.StrictMode=Ot,e.Suspense=Ht,e.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=ti,e.__COMPILER_RUNTIME=Li,e.act=function(Ge){var xt=ti.actQueue,Pn=Ns;Ns++;var jn=ti.actQueue=xt!==null?xt:[],Wn=!1;try{var zi=Ge()}catch(Lt){ti.thrownErrors.push(Lt)}if(0<ti.thrownErrors.length)throw St(xt,Pn),Ge=zt(ti.thrownErrors),ti.thrownErrors.length=0,Ge;if(zi!==null&&typeof zi=="object"&&typeof zi.then=="function"){var Ri=zi;return ho(function(){Wn||Hr||(Hr=!0,console.error("You called act(async () => ...) without await. This could lead to unexpected testing behaviour, interleaving multiple act calls and mixing their scopes. You should - await act(async () => ...);"))}),{then:function(Lt,$r){Wn=!0,Ri.then(function(_i){if(St(xt,Pn),Pn===0){try{Ft(jn),ze(function(){return mt(_i,Lt,$r)})}catch(bi){ti.thrownErrors.push(bi)}if(0<ti.thrownErrors.length){var Ls=zt(ti.thrownErrors);ti.thrownErrors.length=0,$r(Ls)}}else Lt(_i)},function(_i){St(xt,Pn),0<ti.thrownErrors.length&&(_i=zt(ti.thrownErrors),ti.thrownErrors.length=0),$r(_i)})}}}var Ii=zi;if(St(xt,Pn),Pn===0&&(Ft(jn),jn.length!==0&&ho(function(){Wn||Hr||(Hr=!0,console.error("A component suspended inside an `act` scope, but the `act` call was not awaited. When testing React components that depend on asynchronous data, you must await the result:\n\nawait act(() => ...)"))}),ti.actQueue=null),0<ti.thrownErrors.length)throw Ge=zt(ti.thrownErrors),ti.thrownErrors.length=0,Ge;return{then:function(Lt,$r){Wn=!0,Pn===0?(ti.actQueue=jn,ze(function(){return mt(Ii,Lt,$r)})):Lt(Ii)}}},e.cache=function(Ge){return function(){return Ge.apply(null,arguments)}},e.captureOwnerStack=function(){var Ge=ti.getCurrentStack;return Ge===null?null:Ge()},e.cloneElement=function(Ge,xt,Pn){if(Ge==null)throw Error("The argument must be a React element, but you passed "+Ge+".");var jn=er({},Ge.props),Wn=Ge.key,zi=Ge._owner;if(xt!=null){var Ri;e:{if(dr.call(xt,"ref")&&(Ri=Object.getOwnPropertyDescriptor(xt,"ref").get)&&Ri.isReactWarning){Ri=!1;break e}Ri=xt.ref!==void 0}Ri&&(zi=F()),J(xt)&&(D(xt.key),Wn=""+xt.key);for(Ii in xt)!dr.call(xt,Ii)||Ii==="key"||Ii==="__self"||Ii==="__source"||Ii==="ref"&&xt.ref===void 0||(jn[Ii]=xt[Ii])}var Ii=arguments.length-2;if(Ii===1)jn.children=Pn;else if(1<Ii){Ri=Array(Ii);for(var Lt=0;Lt<Ii;Lt++)Ri[Lt]=arguments[Lt+2];jn.children=Ri}for(jn=ie(Ge.type,Wn,void 0,void 0,zi,jn,Ge._debugStack,Ge._debugTask),Wn=2;Wn<arguments.length;Wn++)zi=arguments[Wn],Ie(zi)&&zi._store&&(zi._store.validated=1);return jn},e.createContext=function(Ge){return Ge={$$typeof:wn,_currentValue:Ge,_currentValue2:Ge,_threadCount:0,Provider:null,Consumer:null},Ge.Provider=Ge,Ge.Consumer={$$typeof:ln,_context:Ge},Ge._currentRenderer=null,Ge._currentRenderer2=null,Ge},e.createElement=function(Ge,xt,Pn){for(var jn=2;jn<arguments.length;jn++){var Wn=arguments[jn];Ie(Wn)&&Wn._store&&(Wn._store.validated=1)}if(jn={},Wn=null,xt!=null)for(Lt in fs||!("__self"in xt)||"key"in xt||(fs=!0,console.warn("Your app (or one of its dependencies) is using an outdated JSX transform. Update to the modern JSX transform for faster performance: https://react.dev/link/new-jsx-transform")),J(xt)&&(D(xt.key),Wn=""+xt.key),xt)dr.call(xt,Lt)&&Lt!=="key"&&Lt!=="__self"&&Lt!=="__source"&&(jn[Lt]=xt[Lt]);var zi=arguments.length-2;if(zi===1)jn.children=Pn;else if(1<zi){for(var Ri=Array(zi),Ii=0;Ii<zi;Ii++)Ri[Ii]=arguments[Ii+2];Object.freeze&&Object.freeze(Ri),jn.children=Ri}if(Ge&&Ge.defaultProps)for(Lt in zi=Ge.defaultProps,zi)jn[Lt]===void 0&&(jn[Lt]=zi[Lt]);Wn&&X(jn,typeof Ge=="function"?Ge.displayName||Ge.name||"Unknown":Ge);var Lt=1e4>ti.recentlyCreatedOwnerStacks++;return ie(Ge,Wn,void 0,void 0,F(),jn,Lt?Error("react-stack-top-frame"):Kr,Lt?di(z(Ge)):ir)},e.createRef=function(){var Ge={current:null};return Object.seal(Ge),Ge},e.forwardRef=function(Ge){Ge!=null&&Ge.$$typeof===yn?console.error("forwardRef requires a render function but received a `memo` component. Instead of forwardRef(memo(...)), use memo(forwardRef(...))."):typeof Ge!="function"?console.error("forwardRef requires a render function but was given %s.",Ge===null?"null":typeof Ge):Ge.length!==0&&Ge.length!==2&&console.error("forwardRef render functions accept exactly two parameters: props and ref. %s",Ge.length===1?"Did you forget to use the ref parameter?":"Any additional parameter will be undefined."),Ge!=null&&Ge.defaultProps!=null&&console.error("forwardRef render functions do not support defaultProps. Did you accidentally pass a React component?");var xt={$$typeof:dn,render:Ge},Pn;return Object.defineProperty(xt,"displayName",{enumerable:!1,configurable:!0,get:function(){return Pn},set:function(jn){Pn=jn,Ge.name||Ge.displayName||(Object.defineProperty(Ge,"name",{value:jn}),Ge.displayName=jn)}}),xt},e.isValidElement=Ie,e.lazy=function(Ge){return{$$typeof:Tn,_payload:{_status:-1,_result:Ge},_init:oe}},e.memo=function(Ge,xt){Ge==null&&console.error("memo: The first argument must be a component. Instead received: %s",Ge===null?"null":typeof Ge),xt={$$typeof:yn,type:Ge,compare:xt===void 0?null:xt};var Pn;return Object.defineProperty(xt,"displayName",{enumerable:!1,configurable:!0,get:function(){return Pn},set:function(jn){Pn=jn,Ge.name||Ge.displayName||(Object.defineProperty(Ge,"name",{value:jn}),Ge.displayName=jn)}}),xt},e.startTransition=function(Ge){var xt=ti.T,Pn={};ti.T=Pn,Pn._updatedFibers=new Set;try{var jn=Ge(),Wn=ti.S;Wn!==null&&Wn(Pn,jn),typeof jn=="object"&&jn!==null&&typeof jn.then=="function"&&jn.then($e,jo)}catch(zi){jo(zi)}finally{xt===null&&Pn._updatedFibers&&(Ge=Pn._updatedFibers.size,Pn._updatedFibers.clear(),10<Ge&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table.")),ti.T=xt}},e.unstable_useCacheRefresh=function(){return Ee().useCacheRefresh()},e.use=function(Ge){return Ee().use(Ge)},e.useActionState=function(Ge,xt,Pn){return Ee().useActionState(Ge,xt,Pn)},e.useCallback=function(Ge,xt){return Ee().useCallback(Ge,xt)},e.useContext=function(Ge){var xt=Ee();return Ge.$$typeof===ln&&console.error("Calling useContext(Context.Consumer) is not supported and will cause bugs. Did you mean to call useContext(Context) instead?"),xt.useContext(Ge)},e.useDebugValue=function(Ge,xt){return Ee().useDebugValue(Ge,xt)},e.useDeferredValue=function(Ge,xt){return Ee().useDeferredValue(Ge,xt)},e.useEffect=function(Ge,xt,Pn){Ge==null&&console.warn("React Hook useEffect requires an effect callback. Did you forget to pass a callback to the hook?");var jn=Ee();if(typeof Pn=="function")throw Error("useEffect CRUD overload is not enabled in this build of React.");return jn.useEffect(Ge,xt)},e.useId=function(){return Ee().useId()},e.useImperativeHandle=function(Ge,xt,Pn){return Ee().useImperativeHandle(Ge,xt,Pn)},e.useInsertionEffect=function(Ge,xt){return Ge==null&&console.warn("React Hook useInsertionEffect requires an effect callback. Did you forget to pass a callback to the hook?"),Ee().useInsertionEffect(Ge,xt)},e.useLayoutEffect=function(Ge,xt){return Ge==null&&console.warn("React Hook useLayoutEffect requires an effect callback. Did you forget to pass a callback to the hook?"),Ee().useLayoutEffect(Ge,xt)},e.useMemo=function(Ge,xt){return Ee().useMemo(Ge,xt)},e.useOptimistic=function(Ge,xt){return Ee().useOptimistic(Ge,xt)},e.useReducer=function(Ge,xt,Pn){return Ee().useReducer(Ge,xt,Pn)},e.useRef=function(Ge){return Ee().useRef(Ge)},e.useState=function(Ge){return Ee().useState(Ge)},e.useSyncExternalStore=function(Ge,xt,Pn){return Ee().useSyncExternalStore(Ge,xt,Pn)},e.useTransition=function(){return Ee().useTransition()},e.version="19.1.0",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())})()}(bS,bS.exports)),bS.exports}var JL;function CA(){return JL||(JL=1,XM.exports=H$()),XM.exports}var ez;function $$(){if(ez)return qD;ez=1;/**
 * @license React
 * react-jsx-dev-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){function t(Fe){if(Fe==null)return null;if(typeof Fe=="function")return Fe.$$typeof===oe?null:Fe.displayName||Fe.name||null;if(typeof Fe=="string")return Fe;switch(Fe){case X:return"Fragment";case ie:return"Profiler";case te:return"StrictMode";case Ne:return"Suspense";case Xe:return"SuspenseList";case Te:return"Activity"}if(typeof Fe=="object")switch(typeof Fe.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),Fe.$$typeof){case J:return"Portal";case Ie:return(Fe.displayName||"Context")+".Provider";case we:return(Fe._context.displayName||"Context")+".Consumer";case Re:var Ot=Fe.render;return Fe=Fe.displayName,Fe||(Fe=Ot.displayName||Ot.name||"",Fe=Fe!==""?"ForwardRef("+Fe+")":"ForwardRef"),Fe;case be:return Ot=Fe.displayName||null,Ot!==null?Ot:t(Fe.type)||"Memo";case _e:Ot=Fe._payload,Fe=Fe._init;try{return t(Fe(Ot))}catch{}}return null}function e(Fe){return""+Fe}function n(Fe){try{e(Fe);var Ot=!1}catch{Ot=!0}if(Ot){Ot=console;var Ut=Ot.error,ln=typeof Symbol=="function"&&Symbol.toStringTag&&Fe[Symbol.toStringTag]||Fe.constructor.name||"Object";return Ut.call(Ot,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",ln),e(Fe)}}function r(Fe){if(Fe===X)return"<>";if(typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===_e)return"<...>";try{var Ot=t(Fe);return Ot?"<"+Ot+">":"<...>"}catch{return"<...>"}}function c(){var Fe=Ee.A;return Fe===null?null:Fe.getOwner()}function d(){return Error("react-stack-top-frame")}function m(Fe){if($e.call(Fe,"key")){var Ot=Object.getOwnPropertyDescriptor(Fe,"key").get;if(Ot&&Ot.isReactWarning)return!1}return Fe.key!==void 0}function s(Fe,Ot){function Ut(){St||(St=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",Ot))}Ut.isReactWarning=!0,Object.defineProperty(Fe,"key",{get:Ut,configurable:!0})}function T(){var Fe=t(this.type);return mt[Fe]||(mt[Fe]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),Fe=this.props.ref,Fe!==void 0?Fe:null}function D(Fe,Ot,Ut,ln,wn,dn,Ht,Mn){return Ut=dn.ref,Fe={$$typeof:$,type:Fe,key:Ot,props:dn,_owner:wn},(Ut!==void 0?Ut:null)!==null?Object.defineProperty(Fe,"ref",{enumerable:!1,get:T}):Object.defineProperty(Fe,"ref",{enumerable:!1,value:null}),Fe._store={},Object.defineProperty(Fe._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(Fe,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(Fe,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Ht}),Object.defineProperty(Fe,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:Mn}),Object.freeze&&(Object.freeze(Fe.props),Object.freeze(Fe)),Fe}function P(Fe,Ot,Ut,ln,wn,dn,Ht,Mn){var yn=Ot.children;if(yn!==void 0)if(ln)if(ze(yn)){for(ln=0;ln<yn.length;ln++)z(yn[ln]);Object.freeze&&Object.freeze(yn)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else z(yn);if($e.call(Ot,"key")){yn=t(Fe);var Tn=Object.keys(Ot).filter(function(Kn){return Kn!=="key"});ln=0<Tn.length?"{key: someKey, "+Tn.join(": ..., ")+": ...}":"{key: someKey}",Xt[yn+ln]||(Tn=0<Tn.length?"{"+Tn.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,ln,yn,Tn,yn),Xt[yn+ln]=!0)}if(yn=null,Ut!==void 0&&(n(Ut),yn=""+Ut),m(Ot)&&(n(Ot.key),yn=""+Ot.key),"key"in Ot){Ut={};for(var Cn in Ot)Cn!=="key"&&(Ut[Cn]=Ot[Cn])}else Ut=Ot;return yn&&s(Ut,typeof Fe=="function"?Fe.displayName||Fe.name||"Unknown":Fe),D(Fe,yn,dn,wn,c(),Ut,Ht,Mn)}function z(Fe){typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===$&&Fe._store&&(Fe._store.validated=1)}var F=CA(),$=Symbol.for("react.transitional.element"),J=Symbol.for("react.portal"),X=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),we=Symbol.for("react.consumer"),Ie=Symbol.for("react.context"),Re=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),Xe=Symbol.for("react.suspense_list"),be=Symbol.for("react.memo"),_e=Symbol.for("react.lazy"),Te=Symbol.for("react.activity"),oe=Symbol.for("react.client.reference"),Ee=F.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$e=Object.prototype.hasOwnProperty,ze=Array.isArray,zt=console.createTask?console.createTask:function(){return null};F={"react-stack-bottom-frame":function(Fe){return Fe()}};var St,mt={},Ft=F["react-stack-bottom-frame"].bind(F,d)(),rn=zt(r(d)),Xt={};qD.Fragment=X,qD.jsxDEV=function(Fe,Ot,Ut,ln,wn,dn){var Ht=1e4>Ee.recentlyCreatedOwnerStacks++;return P(Fe,Ot,Ut,ln,wn,dn,Ht?Error("react-stack-top-frame"):Ft,Ht?zt(r(Fe)):rn)}}(),qD}var tz;function G$(){return tz||(tz=1,ZM.exports=$$()),ZM.exports}var de=G$(),ke=CA();const Bc=AA(ke),lk=j$({__proto__:null,default:Bc},[ke]);var QM={exports:{}},rS={},KM={exports:{}},JM={},nz;function q$(){return nz||(nz=1,function(t){/**
 * @license React
 * scheduler.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(){function e(){if(Ne=!1,Te){var mt=t.unstable_now();$e=mt;var Ft=!0;try{e:{Ie=!1,Re&&(Re=!1,be(oe),oe=-1),we=!0;var rn=ie;try{t:{for(m(mt),te=r($);te!==null&&!(te.expirationTime>mt&&T());){var Xt=te.callback;if(typeof Xt=="function"){te.callback=null,ie=te.priorityLevel;var Fe=Xt(te.expirationTime<=mt);if(mt=t.unstable_now(),typeof Fe=="function"){te.callback=Fe,m(mt),Ft=!0;break t}te===r($)&&c($),m(mt)}else c($);te=r($)}if(te!==null)Ft=!0;else{var Ot=r(J);Ot!==null&&D(s,Ot.startTime-mt),Ft=!1}}break e}finally{te=null,ie=rn,we=!1}Ft=void 0}}finally{Ft?ze():Te=!1}}}function n(mt,Ft){var rn=mt.length;mt.push(Ft);e:for(;0<rn;){var Xt=rn-1>>>1,Fe=mt[Xt];if(0<d(Fe,Ft))mt[Xt]=Ft,mt[rn]=Fe,rn=Xt;else break e}}function r(mt){return mt.length===0?null:mt[0]}function c(mt){if(mt.length===0)return null;var Ft=mt[0],rn=mt.pop();if(rn!==Ft){mt[0]=rn;e:for(var Xt=0,Fe=mt.length,Ot=Fe>>>1;Xt<Ot;){var Ut=2*(Xt+1)-1,ln=mt[Ut],wn=Ut+1,dn=mt[wn];if(0>d(ln,rn))wn<Fe&&0>d(dn,ln)?(mt[Xt]=dn,mt[wn]=rn,Xt=wn):(mt[Xt]=ln,mt[Ut]=rn,Xt=Ut);else if(wn<Fe&&0>d(dn,rn))mt[Xt]=dn,mt[wn]=rn,Xt=wn;else break e}}return Ft}function d(mt,Ft){var rn=mt.sortIndex-Ft.sortIndex;return rn!==0?rn:mt.id-Ft.id}function m(mt){for(var Ft=r(J);Ft!==null;){if(Ft.callback===null)c(J);else if(Ft.startTime<=mt)c(J),Ft.sortIndex=Ft.expirationTime,n($,Ft);else break;Ft=r(J)}}function s(mt){if(Re=!1,m(mt),!Ie)if(r($)!==null)Ie=!0,Te||(Te=!0,ze());else{var Ft=r(J);Ft!==null&&D(s,Ft.startTime-mt)}}function T(){return Ne?!0:!(t.unstable_now()-$e<Ee)}function D(mt,Ft){oe=Xe(function(){mt(t.unstable_now())},Ft)}if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error()),t.unstable_now=void 0,typeof performance=="object"&&typeof performance.now=="function"){var P=performance;t.unstable_now=function(){return P.now()}}else{var z=Date,F=z.now();t.unstable_now=function(){return z.now()-F}}var $=[],J=[],X=1,te=null,ie=3,we=!1,Ie=!1,Re=!1,Ne=!1,Xe=typeof setTimeout=="function"?setTimeout:null,be=typeof clearTimeout=="function"?clearTimeout:null,_e=typeof setImmediate<"u"?setImmediate:null,Te=!1,oe=-1,Ee=5,$e=-1;if(typeof _e=="function")var ze=function(){_e(e)};else if(typeof MessageChannel<"u"){var zt=new MessageChannel,St=zt.port2;zt.port1.onmessage=e,ze=function(){St.postMessage(null)}}else ze=function(){Xe(e,0)};t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(mt){mt.callback=null},t.unstable_forceFrameRate=function(mt){0>mt||125<mt?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):Ee=0<mt?Math.floor(1e3/mt):5},t.unstable_getCurrentPriorityLevel=function(){return ie},t.unstable_next=function(mt){switch(ie){case 1:case 2:case 3:var Ft=3;break;default:Ft=ie}var rn=ie;ie=Ft;try{return mt()}finally{ie=rn}},t.unstable_requestPaint=function(){Ne=!0},t.unstable_runWithPriority=function(mt,Ft){switch(mt){case 1:case 2:case 3:case 4:case 5:break;default:mt=3}var rn=ie;ie=mt;try{return Ft()}finally{ie=rn}},t.unstable_scheduleCallback=function(mt,Ft,rn){var Xt=t.unstable_now();switch(typeof rn=="object"&&rn!==null?(rn=rn.delay,rn=typeof rn=="number"&&0<rn?Xt+rn:Xt):rn=Xt,mt){case 1:var Fe=-1;break;case 2:Fe=250;break;case 5:Fe=1073741823;break;case 4:Fe=1e4;break;default:Fe=5e3}return Fe=rn+Fe,mt={id:X++,callback:Ft,priorityLevel:mt,startTime:rn,expirationTime:Fe,sortIndex:-1},rn>Xt?(mt.sortIndex=rn,n(J,mt),r($)===null&&mt===r(J)&&(Re?(be(oe),oe=-1):Re=!0,D(s,rn-Xt))):(mt.sortIndex=Fe,n($,mt),Ie||we||(Ie=!0,Te||(Te=!0,ze()))),mt},t.unstable_shouldYield=T,t.unstable_wrapCallback=function(mt){var Ft=ie;return function(){var rn=ie;ie=Ft;try{return mt.apply(this,arguments)}finally{ie=rn}}},typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())})()}(JM)),JM}var iz;function W$(){return iz||(iz=1,KM.exports=q$()),KM.exports}var eP={exports:{}},Oc={},rz;function Y$(){if(rz)return Oc;rz=1;/**
 * @license React
 * react-dom.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){function t(){}function e(z){return""+z}function n(z,F,$){var J=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;try{e(J);var X=!1}catch{X=!0}return X&&(console.error("The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",typeof Symbol=="function"&&Symbol.toStringTag&&J[Symbol.toStringTag]||J.constructor.name||"Object"),e(J)),{$$typeof:D,key:J==null?null:""+J,children:z,containerInfo:F,implementation:$}}function r(z,F){if(z==="font")return"";if(typeof F=="string")return F==="use-credentials"?F:""}function c(z){return z===null?"`null`":z===void 0?"`undefined`":z===""?"an empty string":'something with type "'+typeof z+'"'}function d(z){return z===null?"`null`":z===void 0?"`undefined`":z===""?"an empty string":typeof z=="string"?JSON.stringify(z):typeof z=="number"?"`"+z+"`":'something with type "'+typeof z+'"'}function m(){var z=P.H;return z===null&&console.error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`),z}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var s=CA(),T={d:{f:t,r:function(){throw Error("Invalid form element. requestFormReset must be passed a form that was rendered by React.")},D:t,C:t,L:t,m:t,X:t,S:t,M:t},p:0,findDOMNode:null},D=Symbol.for("react.portal"),P=s.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE;typeof Map=="function"&&Map.prototype!=null&&typeof Map.prototype.forEach=="function"&&typeof Set=="function"&&Set.prototype!=null&&typeof Set.prototype.clear=="function"&&typeof Set.prototype.forEach=="function"||console.error("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://reactjs.org/link/react-polyfills"),Oc.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE=T,Oc.createPortal=function(z,F){var $=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!F||F.nodeType!==1&&F.nodeType!==9&&F.nodeType!==11)throw Error("Target container is not a DOM element.");return n(z,F,null,$)},Oc.flushSync=function(z){var F=P.T,$=T.p;try{if(P.T=null,T.p=2,z)return z()}finally{P.T=F,T.p=$,T.d.f()&&console.error("flushSync was called from inside a lifecycle method. React cannot flush when React is already rendering. Consider moving this call to a scheduler task or micro task.")}},Oc.preconnect=function(z,F){typeof z=="string"&&z?F!=null&&typeof F!="object"?console.error("ReactDOM.preconnect(): Expected the `options` argument (second) to be an object but encountered %s instead. The only supported option at this time is `crossOrigin` which accepts a string.",d(F)):F!=null&&typeof F.crossOrigin!="string"&&console.error("ReactDOM.preconnect(): Expected the `crossOrigin` option (second argument) to be a string but encountered %s instead. Try removing this option or passing a string value instead.",c(F.crossOrigin)):console.error("ReactDOM.preconnect(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",c(z)),typeof z=="string"&&(F?(F=F.crossOrigin,F=typeof F=="string"?F==="use-credentials"?F:"":void 0):F=null,T.d.C(z,F))},Oc.prefetchDNS=function(z){if(typeof z!="string"||!z)console.error("ReactDOM.prefetchDNS(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",c(z));else if(1<arguments.length){var F=arguments[1];typeof F=="object"&&F.hasOwnProperty("crossOrigin")?console.error("ReactDOM.prefetchDNS(): Expected only one argument, `href`, but encountered %s as a second argument instead. This argument is reserved for future options and is currently disallowed. It looks like the you are attempting to set a crossOrigin property for this DNS lookup hint. Browsers do not perform DNS queries using CORS and setting this attribute on the resource hint has no effect. Try calling ReactDOM.prefetchDNS() with just a single string argument, `href`.",d(F)):console.error("ReactDOM.prefetchDNS(): Expected only one argument, `href`, but encountered %s as a second argument instead. This argument is reserved for future options and is currently disallowed. Try calling ReactDOM.prefetchDNS() with just a single string argument, `href`.",d(F))}typeof z=="string"&&T.d.D(z)},Oc.preinit=function(z,F){if(typeof z=="string"&&z?F==null||typeof F!="object"?console.error("ReactDOM.preinit(): Expected the `options` argument (second) to be an object with an `as` property describing the type of resource to be preinitialized but encountered %s instead.",d(F)):F.as!=="style"&&F.as!=="script"&&console.error('ReactDOM.preinit(): Expected the `as` property in the `options` argument (second) to contain a valid value describing the type of resource to be preinitialized but encountered %s instead. Valid values for `as` are "style" and "script".',d(F.as)):console.error("ReactDOM.preinit(): Expected the `href` argument (first) to be a non-empty string but encountered %s instead.",c(z)),typeof z=="string"&&F&&typeof F.as=="string"){var $=F.as,J=r($,F.crossOrigin),X=typeof F.integrity=="string"?F.integrity:void 0,te=typeof F.fetchPriority=="string"?F.fetchPriority:void 0;$==="style"?T.d.S(z,typeof F.precedence=="string"?F.precedence:void 0,{crossOrigin:J,integrity:X,fetchPriority:te}):$==="script"&&T.d.X(z,{crossOrigin:J,integrity:X,fetchPriority:te,nonce:typeof F.nonce=="string"?F.nonce:void 0})}},Oc.preinitModule=function(z,F){var $="";if(typeof z=="string"&&z||($+=" The `href` argument encountered was "+c(z)+"."),F!==void 0&&typeof F!="object"?$+=" The `options` argument encountered was "+c(F)+".":F&&"as"in F&&F.as!=="script"&&($+=" The `as` option encountered was "+d(F.as)+"."),$)console.error("ReactDOM.preinitModule(): Expected up to two arguments, a non-empty `href` string and, optionally, an `options` object with a valid `as` property.%s",$);else switch($=F&&typeof F.as=="string"?F.as:"script",$){case"script":break;default:$=d($),console.error('ReactDOM.preinitModule(): Currently the only supported "as" type for this function is "script" but received "%s" instead. This warning was generated for `href` "%s". In the future other module types will be supported, aligning with the import-attributes proposal. Learn more here: (https://github.com/tc39/proposal-import-attributes)',$,z)}typeof z=="string"&&(typeof F=="object"&&F!==null?(F.as==null||F.as==="script")&&($=r(F.as,F.crossOrigin),T.d.M(z,{crossOrigin:$,integrity:typeof F.integrity=="string"?F.integrity:void 0,nonce:typeof F.nonce=="string"?F.nonce:void 0})):F==null&&T.d.M(z))},Oc.preload=function(z,F){var $="";if(typeof z=="string"&&z||($+=" The `href` argument encountered was "+c(z)+"."),F==null||typeof F!="object"?$+=" The `options` argument encountered was "+c(F)+".":typeof F.as=="string"&&F.as||($+=" The `as` option encountered was "+c(F.as)+"."),$&&console.error('ReactDOM.preload(): Expected two arguments, a non-empty `href` string and an `options` object with an `as` property valid for a `<link rel="preload" as="..." />` tag.%s',$),typeof z=="string"&&typeof F=="object"&&F!==null&&typeof F.as=="string"){$=F.as;var J=r($,F.crossOrigin);T.d.L(z,$,{crossOrigin:J,integrity:typeof F.integrity=="string"?F.integrity:void 0,nonce:typeof F.nonce=="string"?F.nonce:void 0,type:typeof F.type=="string"?F.type:void 0,fetchPriority:typeof F.fetchPriority=="string"?F.fetchPriority:void 0,referrerPolicy:typeof F.referrerPolicy=="string"?F.referrerPolicy:void 0,imageSrcSet:typeof F.imageSrcSet=="string"?F.imageSrcSet:void 0,imageSizes:typeof F.imageSizes=="string"?F.imageSizes:void 0,media:typeof F.media=="string"?F.media:void 0})}},Oc.preloadModule=function(z,F){var $="";typeof z=="string"&&z||($+=" The `href` argument encountered was "+c(z)+"."),F!==void 0&&typeof F!="object"?$+=" The `options` argument encountered was "+c(F)+".":F&&"as"in F&&typeof F.as!="string"&&($+=" The `as` option encountered was "+c(F.as)+"."),$&&console.error('ReactDOM.preloadModule(): Expected two arguments, a non-empty `href` string and, optionally, an `options` object with an `as` property valid for a `<link rel="modulepreload" as="..." />` tag.%s',$),typeof z=="string"&&(F?($=r(F.as,F.crossOrigin),T.d.m(z,{as:typeof F.as=="string"&&F.as!=="script"?F.as:void 0,crossOrigin:$,integrity:typeof F.integrity=="string"?F.integrity:void 0})):T.d.m(z))},Oc.requestFormReset=function(z){T.d.r(z)},Oc.unstable_batchedUpdates=function(z,F){return z(F)},Oc.useFormState=function(z,F,$){return m().useFormState(z,F,$)},Oc.useFormStatus=function(){return m().useHostTransitionStatus()},Oc.version="19.1.0",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}(),Oc}var sz;function zU(){return sz||(sz=1,eP.exports=Y$()),eP.exports}var oz;function Z$(){if(oz)return rS;oz=1;/**
 * @license React
 * react-dom-client.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){function t(a,h){for(a=a.memoizedState;a!==null&&0<h;)a=a.next,h--;return a}function e(a,h,v,S){if(v>=h.length)return S;var I=h[v],k=Ka(a)?a.slice():br({},a);return k[I]=e(a[I],h,v+1,S),k}function n(a,h,v){if(h.length!==v.length)console.warn("copyWithRename() expects paths of the same length");else{for(var S=0;S<v.length-1;S++)if(h[S]!==v[S]){console.warn("copyWithRename() expects paths to be the same except for the deepest key");return}return r(a,h,v,0)}}function r(a,h,v,S){var I=h[S],k=Ka(a)?a.slice():br({},a);return S+1===h.length?(k[v[S]]=k[I],Ka(k)?k.splice(I,1):delete k[I]):k[I]=r(a[I],h,v,S+1),k}function c(a,h,v){var S=h[v],I=Ka(a)?a.slice():br({},a);return v+1===h.length?(Ka(I)?I.splice(S,1):delete I[S],I):(I[S]=c(a[S],h,v+1),I)}function d(){return!1}function m(){return null}function s(){}function T(){console.error("Do not call Hooks inside useEffect(...), useMemo(...), or other built-in Hooks. You can only call Hooks at the top level of your React function. For more information, see https://react.dev/link/rules-of-hooks")}function D(){console.error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().")}function P(){}function z(a){var h=[];return a.forEach(function(v){h.push(v)}),h.sort().join(", ")}function F(a,h,v,S){return new V(a,h,v,S)}function $(a,h){a.context===rm&&(Dy(a.current,2,h,a,null,null),kf())}function J(a,h){if(du!==null){var v=h.staleFamilies;h=h.updatedFamilies,Gp(),Za(a.current,h,v),kf()}}function X(a){du=a}function te(a){return!(!a||a.nodeType!==1&&a.nodeType!==9&&a.nodeType!==11)}function ie(a){var h=a,v=a;if(a.alternate)for(;h.return;)h=h.return;else{a=h;do h=a,(h.flags&4098)!==0&&(v=h.return),a=h.return;while(a)}return h.tag===3?v:null}function we(a){if(a.tag===13){var h=a.memoizedState;if(h===null&&(a=a.alternate,a!==null&&(h=a.memoizedState)),h!==null)return h.dehydrated}return null}function Ie(a){if(ie(a)!==a)throw Error("Unable to find node on an unmounted component.")}function Re(a){var h=a.alternate;if(!h){if(h=ie(a),h===null)throw Error("Unable to find node on an unmounted component.");return h!==a?null:a}for(var v=a,S=h;;){var I=v.return;if(I===null)break;var k=I.alternate;if(k===null){if(S=I.return,S!==null){v=S;continue}break}if(I.child===k.child){for(k=I.child;k;){if(k===v)return Ie(I),a;if(k===S)return Ie(I),h;k=k.sibling}throw Error("Unable to find node on an unmounted component.")}if(v.return!==S.return)v=I,S=k;else{for(var K=!1,ee=I.child;ee;){if(ee===v){K=!0,v=I,S=k;break}if(ee===S){K=!0,S=I,v=k;break}ee=ee.sibling}if(!K){for(ee=k.child;ee;){if(ee===v){K=!0,v=k,S=I;break}if(ee===S){K=!0,S=k,v=I;break}ee=ee.sibling}if(!K)throw Error("Child was not found in either parent set. This indicates a bug in React related to the return pointer. Please file an issue.")}}if(v.alternate!==S)throw Error("Return fibers should always be each others' alternates. This error is likely caused by a bug in React. Please file an issue.")}if(v.tag!==3)throw Error("Unable to find node on an unmounted component.");return v.stateNode.current===v?a:h}function Ne(a){var h=a.tag;if(h===5||h===26||h===27||h===6)return a;for(a=a.child;a!==null;){if(h=Ne(a),h!==null)return h;a=a.sibling}return null}function Xe(a){return a===null||typeof a!="object"?null:(a=gC&&a[gC]||a["@@iterator"],typeof a=="function"?a:null)}function be(a){if(a==null)return null;if(typeof a=="function")return a.$$typeof===wM?null:a.displayName||a.name||null;if(typeof a=="string")return a;switch(a){case Pg:return"Fragment";case l1:return"Profiler";case eb:return"StrictMode";case tb:return"Suspense";case Ed:return"SuspenseList";case kg:return"Activity"}if(typeof a=="object")switch(typeof a.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),a.$$typeof){case Py:return"Portal";case Ph:return(a.displayName||"Context")+".Provider";case c1:return(a._context.displayName||"Context")+".Consumer";case ky:var h=a.render;return a=a.displayName,a||(a=h.displayName||h.name||"",a=a!==""?"ForwardRef("+a+")":"ForwardRef"),a;case go:return h=a.displayName||null,h!==null?h:be(a.type)||"Memo";case _c:h=a._payload,a=a._init;try{return be(a(h))}catch{}}return null}function _e(a){return typeof a.tag=="number"?Te(a):typeof a.name=="string"?a.name:null}function Te(a){var h=a.type;switch(a.tag){case 31:return"Activity";case 24:return"Cache";case 9:return(h._context.displayName||"Context")+".Consumer";case 10:return(h.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return a=h.render,a=a.displayName||a.name||"",h.displayName||(a!==""?"ForwardRef("+a+")":"ForwardRef");case 7:return"Fragment";case 26:case 27:case 5:return h;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return be(h);case 8:return h===eb?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 14:case 15:if(typeof h=="function")return h.displayName||h.name||null;if(typeof h=="string")return h;break;case 29:if(h=a._debugInfo,h!=null){for(var v=h.length-1;0<=v;v--)if(typeof h[v].name=="string")return h[v].name}if(a.return!==null)return Te(a.return)}return null}function oe(a){return{current:a}}function Ee(a,h){0>Hf?console.error("Unexpected pop."):(h!==zT[Hf]&&console.error("Unexpected Fiber popped."),a.current=Lg[Hf],Lg[Hf]=null,zT[Hf]=null,Hf--)}function $e(a,h,v){Hf++,Lg[Hf]=a.current,zT[Hf]=v,a.current=h}function ze(a){return a===null&&console.error("Expected host context to exist. This error is likely caused by a bug in React. Please file an issue."),a}function zt(a,h){$e(Qp,h,a),$e(nb,a,a),$e(Xp,null,a);var v=h.nodeType;switch(v){case 9:case 11:v=v===9?"#document":"#fragment",h=(h=h.documentElement)&&(h=h.namespaceURI)?pr(h):jh;break;default:if(v=h.tagName,h=h.namespaceURI)h=pr(h),h=Gi(h,v);else switch(v){case"svg":h=dp;break;case"math":h=Gb;break;default:h=jh}}v=v.toLowerCase(),v=Mr(null,v),v={context:h,ancestorInfo:v},Ee(Xp,a),$e(Xp,v,a)}function St(a){Ee(Xp,a),Ee(nb,a),Ee(Qp,a)}function mt(){return ze(Xp.current)}function Ft(a){a.memoizedState!==null&&$e(u1,a,a);var h=ze(Xp.current),v=a.type,S=Gi(h.context,v);v=Mr(h.ancestorInfo,v),S={context:S,ancestorInfo:v},h!==S&&($e(nb,a,a),$e(Xp,S,a))}function rn(a){nb.current===a&&(Ee(Xp,a),Ee(nb,a)),u1.current===a&&(Ee(u1,a),u._currentValue=Em)}function Xt(a){return typeof Symbol=="function"&&Symbol.toStringTag&&a[Symbol.toStringTag]||a.constructor.name||"Object"}function Fe(a){try{return Ot(a),!1}catch{return!0}}function Ot(a){return""+a}function Ut(a,h){if(Fe(a))return console.error("The provided `%s` attribute is an unsupported type %s. This value must be coerced to a string before using it here.",h,Xt(a)),Ot(a)}function ln(a,h){if(Fe(a))return console.error("The provided `%s` CSS property is an unsupported type %s. This value must be coerced to a string before using it here.",h,Xt(a)),Ot(a)}function wn(a){if(Fe(a))return console.error("Form field values (value, checked, defaultValue, or defaultChecked props) must be strings, not %s. This value must be coerced to a string before using it here.",Xt(a)),Ot(a)}function dn(a){if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u")return!1;var h=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(h.isDisabled)return!0;if(!h.supportsFiber)return console.error("The installed version of React DevTools is too old and will not work with the current version of React. Please update React DevTools. https://react.dev/link/react-devtools"),!0;try{Ad=h.inject(a),Ra=h}catch(v){console.error("React instrumentation encountered an error: %s.",v)}return!!h.checkDCE}function Ht(a){if(typeof yC=="function"&&vC(a),Ra&&typeof Ra.setStrictMode=="function")try{Ra.setStrictMode(Ad,a)}catch(h){Cd||(Cd=!0,console.error("React instrumentation encountered an error: %s",h))}}function Mn(a){ei=a}function yn(){ei!==null&&typeof ei.markCommitStopped=="function"&&ei.markCommitStopped()}function Tn(a){ei!==null&&typeof ei.markComponentRenderStarted=="function"&&ei.markComponentRenderStarted(a)}function Cn(){ei!==null&&typeof ei.markComponentRenderStopped=="function"&&ei.markComponentRenderStopped()}function Kn(a){ei!==null&&typeof ei.markRenderStarted=="function"&&ei.markRenderStarted(a)}function Bt(){ei!==null&&typeof ei.markRenderStopped=="function"&&ei.markRenderStopped()}function ni(a,h){ei!==null&&typeof ei.markStateUpdateScheduled=="function"&&ei.markStateUpdateScheduled(a,h)}function er(a){return a>>>=0,a===0?32:31-(BT(a)/bC|0)|0}function _r(a){if(a&1)return"SyncHydrationLane";if(a&2)return"Sync";if(a&4)return"InputContinuousHydration";if(a&8)return"InputContinuous";if(a&16)return"DefaultHydration";if(a&32)return"Default";if(a&128)return"TransitionHydration";if(a&4194048)return"Transition";if(a&62914560)return"Retry";if(a&67108864)return"SelectiveHydration";if(a&134217728)return"IdleHydration";if(a&268435456)return"Idle";if(a&536870912)return"Offscreen";if(a&1073741824)return"Deferred"}function Li(a){var h=a&42;if(h!==0)return h;switch(a&-a){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:return 64;case 128:return 128;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return a&4194048;case 4194304:case 8388608:case 16777216:case 33554432:return a&62914560;case 67108864:return 67108864;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 0;default:return console.error("Should have found matching lanes. This is a bug in React."),a}}function jr(a,h,v){var S=a.pendingLanes;if(S===0)return 0;var I=0,k=a.suspendedLanes,K=a.pingedLanes;a=a.warmLanes;var ee=S&134217727;return ee!==0?(S=ee&~k,S!==0?I=Li(S):(K&=ee,K!==0?I=Li(K):v||(v=ee&~a,v!==0&&(I=Li(v))))):(ee=S&~k,ee!==0?I=Li(ee):K!==0?I=Li(K):v||(v=S&~a,v!==0&&(I=Li(v)))),I===0?0:h!==0&&h!==I&&(h&k)===0&&(k=I&-I,v=h&-h,k>=v||k===32&&(v&4194048)!==0)?h:I}function ss(a,h){return(a.pendingLanes&~(a.suspendedLanes&~a.pingedLanes)&h)===0}function Nr(a,h){switch(a){case 1:case 2:case 4:case 8:case 64:return h+250;case 16:case 32:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return h+5e3;case 4194304:case 8388608:case 16777216:case 33554432:return-1;case 67108864:case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return console.error("Should have found matching lanes. This is a bug in React."),-1}}function ti(){var a=Dd;return Dd<<=1,(Dd&4194048)===0&&(Dd=256),a}function dr(){var a=f1;return f1<<=1,(f1&62914560)===0&&(f1=4194304),a}function di(a){for(var h=[],v=0;31>v;v++)h.push(a);return h}function ks(a,h){a.pendingLanes|=h,h!==268435456&&(a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0)}function fs(a,h,v,S,I,k){var K=a.pendingLanes;a.pendingLanes=v,a.suspendedLanes=0,a.pingedLanes=0,a.warmLanes=0,a.expiredLanes&=v,a.entangledLanes&=v,a.errorRecoveryDisabledLanes&=v,a.shellSuspendCounter=0;var ee=a.entanglements,me=a.expirationTimes,De=a.hiddenUpdates;for(v=K&~v;0<v;){var it=31-Ja(v),yt=1<<it;ee[it]=0,me[it]=-1;var ct=De[it];if(ct!==null)for(De[it]=null,it=0;it<ct.length;it++){var ut=ct[it];ut!==null&&(ut.lane&=-536870913)}v&=~yt}S!==0&&Uo(a,S,0),k!==0&&I===0&&a.tag!==0&&(a.suspendedLanes|=k&~(K&~h))}function Uo(a,h,v){a.pendingLanes|=h,a.suspendedLanes&=~h;var S=31-Ja(h);a.entangledLanes|=h,a.entanglements[S]=a.entanglements[S]|1073741824|v&4194090}function Kr(a,h){var v=a.entangledLanes|=h;for(a=a.entanglements;v;){var S=31-Ja(v),I=1<<S;I&h|a[S]&h&&(a[S]|=h),v&=~I}}function ir(a){switch(a){case 2:a=1;break;case 8:a=4;break;case 32:a=16;break;case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:a=128;break;case 268435456:a=134217728;break;default:a=0}return a}function Po(a,h,v){if(Nu)for(a=a.pendingUpdatersLaneMap;0<v;){var S=31-Ja(v),I=1<<S;a[S].add(h),v&=~I}}function ro(a,h){if(Nu)for(var v=a.pendingUpdatersLaneMap,S=a.memoizedUpdaters;0<h;){var I=31-Ja(h);a=1<<I,I=v[I],0<I.size&&(I.forEach(function(k){var K=k.alternate;K!==null&&S.has(K)||S.add(k)}),I.clear()),h&=~a}}function jo(a){return a&=-a,Qs<a?kh<a?(a&134217727)!==0?Rd:sb:kh:Qs}function Or(){var a=us.p;return a!==0?a:(a=window.event,a===void 0?Rd:Oy(a.type))}function ps(a,h){var v=us.p;try{return us.p=a,h()}finally{us.p=v}}function Ns(a){delete a[_l],delete a[yc],delete a[p1],delete a[FT],delete a[VT]}function Hr(a){var h=a[_l];if(h)return h;for(var v=a.parentNode;v;){if(h=v[Od]||v[_l]){if(v=h.alternate,h.child!==null||v!==null&&v.child!==null)for(a=Fl(a);a!==null;){if(v=a[_l])return v;a=Fl(a)}return h}a=v,v=a.parentNode}return null}function Xs(a){if(a=a[_l]||a[Od]){var h=a.tag;if(h===5||h===6||h===13||h===26||h===27||h===3)return a}return null}function ho(a){var h=a.tag;if(h===5||h===26||h===27||h===6)return a.stateNode;throw Error("getNodeFromInstance: Invalid argument.")}function Ge(a){var h=a[UT];return h||(h=a[UT]={hoistableStyles:new Map,hoistableScripts:new Map}),h}function xt(a){a[Ny]=!0}function Pn(a,h){jn(a,h),jn(a+"Capture",h)}function jn(a,h){Jp[a]&&console.error("EventRegistry: More than one plugin attempted to publish the same registration name, `%s`.",a),Jp[a]=h;var v=a.toLowerCase();for(ob[v]=a,a==="onDoubleClick"&&(ob.ondblclick=a),a=0;a<h.length;a++)jT.add(h[a])}function Wn(a,h){Id[h.type]||h.onChange||h.onInput||h.readOnly||h.disabled||h.value==null||console.error(a==="select"?"You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set `onChange`.":"You provided a `value` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultValue`. Otherwise, set either `onChange` or `readOnly`."),h.onChange||h.readOnly||h.disabled||h.checked==null||console.error("You provided a `checked` prop to a form field without an `onChange` handler. This will render a read-only field. If the field should be mutable use `defaultChecked`. Otherwise, set either `onChange` or `readOnly`.")}function zi(a){return $f.call(TC,a)?!0:$f.call(wC,a)?!1:xC.test(a)?TC[a]=!0:(wC[a]=!0,console.error("Invalid attribute name: `%s`",a),!1)}function Ri(a,h,v){if(zi(h)){if(!a.hasAttribute(h)){switch(typeof v){case"symbol":case"object":return v;case"function":return v;case"boolean":if(v===!1)return v}return v===void 0?void 0:null}return a=a.getAttribute(h),a===""&&v===!0?!0:(Ut(v,h),a===""+v?v:a)}}function Ii(a,h,v){if(zi(h))if(v===null)a.removeAttribute(h);else{switch(typeof v){case"undefined":case"function":case"symbol":a.removeAttribute(h);return;case"boolean":var S=h.toLowerCase().slice(0,5);if(S!=="data-"&&S!=="aria-"){a.removeAttribute(h);return}}Ut(v,h),a.setAttribute(h,""+v)}}function Lt(a,h,v){if(v===null)a.removeAttribute(h);else{switch(typeof v){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(h);return}Ut(v,h),a.setAttribute(h,""+v)}}function $r(a,h,v,S){if(S===null)a.removeAttribute(v);else{switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":a.removeAttribute(v);return}Ut(S,v),a.setAttributeNS(h,v,""+S)}}function _i(){}function Ls(){if(ab===0){EC=console.log,SC=console.info,AC=console.warn,CC=console.error,lb=console.group,HT=console.groupCollapsed,cb=console.groupEnd;var a={configurable:!0,enumerable:!0,value:_i,writable:!0};Object.defineProperties(console,{info:a,log:a,warn:a,error:a,group:a,groupCollapsed:a,groupEnd:a})}ab++}function bi(){if(ab--,ab===0){var a={configurable:!0,enumerable:!0,writable:!0};Object.defineProperties(console,{log:br({},a,{value:EC}),info:br({},a,{value:SC}),warn:br({},a,{value:AC}),error:br({},a,{value:CC}),group:br({},a,{value:lb}),groupCollapsed:br({},a,{value:HT}),groupEnd:br({},a,{value:cb})})}0>ab&&console.error("disabledDepth fell below zero. This is a bug in React. Please file an issue.")}function gt(a){if(m1===void 0)try{throw Error()}catch(v){var h=v.stack.trim().match(/\n( *(at )?)/);m1=h&&h[1]||"",g1=-1<v.stack.indexOf(`
    at`)?" (<anonymous>)":-1<v.stack.indexOf("@")?"@unknown:0:0":""}return`
`+m1+a+g1}function fe(a,h){if(!a||ub)return"";var v=_1.get(a);if(v!==void 0)return v;ub=!0,v=Error.prepareStackTrace,Error.prepareStackTrace=void 0;var S=null;S=Jt.H,Jt.H=null,Ls();try{var I={DetermineComponentFrameRoot:function(){try{if(h){var ct=function(){throw Error()};if(Object.defineProperty(ct.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(ct,[])}catch(Ct){var ut=Ct}Reflect.construct(a,[],ct)}else{try{ct.call()}catch(Ct){ut=Ct}a.call(ct.prototype)}}else{try{throw Error()}catch(Ct){ut=Ct}(ct=a())&&typeof ct.catch=="function"&&ct.catch(function(){})}}catch(Ct){if(Ct&&ut&&typeof Ct.stack=="string")return[Ct.stack,ut.stack]}return[null,null]}};I.DetermineComponentFrameRoot.displayName="DetermineComponentFrameRoot";var k=Object.getOwnPropertyDescriptor(I.DetermineComponentFrameRoot,"name");k&&k.configurable&&Object.defineProperty(I.DetermineComponentFrameRoot,"name",{value:"DetermineComponentFrameRoot"});var K=I.DetermineComponentFrameRoot(),ee=K[0],me=K[1];if(ee&&me){var De=ee.split(`
`),it=me.split(`
`);for(K=k=0;k<De.length&&!De[k].includes("DetermineComponentFrameRoot");)k++;for(;K<it.length&&!it[K].includes("DetermineComponentFrameRoot");)K++;if(k===De.length||K===it.length)for(k=De.length-1,K=it.length-1;1<=k&&0<=K&&De[k]!==it[K];)K--;for(;1<=k&&0<=K;k--,K--)if(De[k]!==it[K]){if(k!==1||K!==1)do if(k--,K--,0>K||De[k]!==it[K]){var yt=`
`+De[k].replace(" at new "," at ");return a.displayName&&yt.includes("<anonymous>")&&(yt=yt.replace("<anonymous>",a.displayName)),typeof a=="function"&&_1.set(a,yt),yt}while(1<=k&&0<=K);break}}}finally{ub=!1,Jt.H=S,bi(),Error.prepareStackTrace=v}return De=(De=a?a.displayName||a.name:"")?gt(De):"",typeof a=="function"&&_1.set(a,De),De}function ve(a){var h=Error.prepareStackTrace;if(Error.prepareStackTrace=void 0,a=a.stack,Error.prepareStackTrace=h,a.startsWith(`Error: react-stack-top-frame
`)&&(a=a.slice(29)),h=a.indexOf(`
`),h!==-1&&(a=a.slice(h+1)),h=a.indexOf("react-stack-bottom-frame"),h!==-1&&(h=a.lastIndexOf(`
`,h)),h!==-1)a=a.slice(0,h);else return"";return a}function Be(a){switch(a.tag){case 26:case 27:case 5:return gt(a.type);case 16:return gt("Lazy");case 13:return gt("Suspense");case 19:return gt("SuspenseList");case 0:case 15:return fe(a.type,!1);case 11:return fe(a.type.render,!1);case 1:return fe(a.type,!0);case 31:return gt("Activity");default:return""}}function tt(a){try{var h="";do{h+=Be(a);var v=a._debugInfo;if(v)for(var S=v.length-1;0<=S;S--){var I=v[S];if(typeof I.name=="string"){var k=h,K=I.env,ee=gt(I.name+(K?" ["+K+"]":""));h=k+ee}}a=a.return}while(a);return h}catch(me){return`
Error generating stack: `+me.message+`
`+me.stack}}function He(a){return(a=a?a.displayName||a.name:"")?gt(a):""}function at(){if(hu===null)return null;var a=hu._debugOwner;return a!=null?_e(a):null}function bt(){if(hu===null)return"";var a=hu;try{var h="";switch(a.tag===6&&(a=a.return),a.tag){case 26:case 27:case 5:h+=gt(a.type);break;case 13:h+=gt("Suspense");break;case 19:h+=gt("SuspenseList");break;case 31:h+=gt("Activity");break;case 30:case 0:case 15:case 1:a._debugOwner||h!==""||(h+=He(a.type));break;case 11:a._debugOwner||h!==""||(h+=He(a.type.render))}for(;a;)if(typeof a.tag=="number"){var v=a;a=v._debugOwner;var S=v._debugStack;a&&S&&(typeof S!="string"&&(v._debugStack=S=ve(S)),S!==""&&(h+=`
`+S))}else if(a.debugStack!=null){var I=a.debugStack;(a=a.owner)&&I&&(h+=`
`+ve(I))}else break;var k=h}catch(K){k=`
Error generating stack: `+K.message+`
`+K.stack}return k}function Ze(a,h,v,S,I,k,K){var ee=hu;vt(a);try{return a!==null&&a._debugTask?a._debugTask.run(h.bind(null,v,S,I,k,K)):h(v,S,I,k,K)}finally{vt(ee)}throw Error("runWithFiberInDEV should never be called in production. This is a bug in React.")}function vt(a){Jt.getCurrentStack=a===null?null:bt,Lh=!1,hu=a}function It(a){switch(typeof a){case"bigint":case"boolean":case"number":case"string":case"undefined":return a;case"object":return wn(a),a;default:return""}}function Et(a){var h=a.type;return(a=a.nodeName)&&a.toLowerCase()==="input"&&(h==="checkbox"||h==="radio")}function Kt(a){var h=Et(a)?"checked":"value",v=Object.getOwnPropertyDescriptor(a.constructor.prototype,h);wn(a[h]);var S=""+a[h];if(!a.hasOwnProperty(h)&&typeof v<"u"&&typeof v.get=="function"&&typeof v.set=="function"){var I=v.get,k=v.set;return Object.defineProperty(a,h,{configurable:!0,get:function(){return I.call(this)},set:function(K){wn(K),S=""+K,k.call(this,K)}}),Object.defineProperty(a,h,{enumerable:v.enumerable}),{getValue:function(){return S},setValue:function(K){wn(K),S=""+K},stopTracking:function(){a._valueTracker=null,delete a[h]}}}}function _n(a){a._valueTracker||(a._valueTracker=Kt(a))}function Sn(a){if(!a)return!1;var h=a._valueTracker;if(!h)return!0;var v=h.getValue(),S="";return a&&(S=Et(a)?a.checked?"true":"false":a.value),a=S,a!==v?(h.setValue(a),!0):!1}function Gn(a){if(a=a||(typeof document<"u"?document:void 0),typeof a>"u")return null;try{return a.activeElement||a.body}catch{return a.body}}function Vn(a){return a.replace(DC,function(h){return"\\"+h.charCodeAt(0).toString(16)+" "})}function Jn(a,h){h.checked===void 0||h.defaultChecked===void 0||GT||(console.error("%s contains an input of type %s with both checked and defaultChecked props. Input elements must be either controlled or uncontrolled (specify either the checked prop, or the defaultChecked prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://react.dev/link/controlled-components",at()||"A component",h.type),GT=!0),h.value===void 0||h.defaultValue===void 0||$T||(console.error("%s contains an input of type %s with both value and defaultValue props. Input elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled input element and remove one of these props. More info: https://react.dev/link/controlled-components",at()||"A component",h.type),$T=!0)}function oi(a,h,v,S,I,k,K,ee){a.name="",K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"?(Ut(K,"type"),a.type=K):a.removeAttribute("type"),h!=null?K==="number"?(h===0&&a.value===""||a.value!=h)&&(a.value=""+It(h)):a.value!==""+It(h)&&(a.value=""+It(h)):K!=="submit"&&K!=="reset"||a.removeAttribute("value"),h!=null?Xi(a,K,It(h)):v!=null?Xi(a,K,It(v)):S!=null&&a.removeAttribute("value"),I==null&&k!=null&&(a.defaultChecked=!!k),I!=null&&(a.checked=I&&typeof I!="function"&&typeof I!="symbol"),ee!=null&&typeof ee!="function"&&typeof ee!="symbol"&&typeof ee!="boolean"?(Ut(ee,"name"),a.name=""+It(ee)):a.removeAttribute("name")}function ii(a,h,v,S,I,k,K,ee){if(k!=null&&typeof k!="function"&&typeof k!="symbol"&&typeof k!="boolean"&&(Ut(k,"type"),a.type=k),h!=null||v!=null){if(!(k!=="submit"&&k!=="reset"||h!=null))return;v=v!=null?""+It(v):"",h=h!=null?""+It(h):v,ee||h===a.value||(a.value=h),a.defaultValue=h}S=S??I,S=typeof S!="function"&&typeof S!="symbol"&&!!S,a.checked=ee?a.checked:!!S,a.defaultChecked=!!S,K!=null&&typeof K!="function"&&typeof K!="symbol"&&typeof K!="boolean"&&(Ut(K,"name"),a.name=K)}function Xi(a,h,v){h==="number"&&Gn(a.ownerDocument)===a||a.defaultValue===""+v||(a.defaultValue=""+v)}function tr(a,h){h.value==null&&(typeof h.children=="object"&&h.children!==null?a1.Children.forEach(h.children,function(v){v==null||typeof v=="string"||typeof v=="number"||typeof v=="bigint"||qT||(qT=!0,console.error("Cannot infer the option value of complex children. Pass a `value` prop or use a plain string as children to <option>."))}):h.dangerouslySetInnerHTML==null||v1||(v1=!0,console.error("Pass a `value` prop if you set dangerouslyInnerHTML so React knows which value should be selected."))),h.selected==null||y1||(console.error("Use the `defaultValue` or `value` props on <select> instead of setting `selected` on <option>."),y1=!0)}function cr(){var a=at();return a?`

Check the render method of \``+a+"`.":""}function Ai(a,h,v,S){if(a=a.options,h){h={};for(var I=0;I<v.length;I++)h["$"+v[I]]=!0;for(v=0;v<a.length;v++)I=h.hasOwnProperty("$"+a[v].value),a[v].selected!==I&&(a[v].selected=I),I&&S&&(a[v].defaultSelected=!0)}else{for(v=""+It(v),h=null,I=0;I<a.length;I++){if(a[I].value===v){a[I].selected=!0,S&&(a[I].defaultSelected=!0);return}h!==null||a[I].disabled||(h=a[I])}h!==null&&(h.selected=!0)}}function Ei(a,h){for(a=0;a<OC.length;a++){var v=OC[a];if(h[v]!=null){var S=Ka(h[v]);h.multiple&&!S?console.error("The `%s` prop supplied to <select> must be an array if `multiple` is true.%s",v,cr()):!h.multiple&&S&&console.error("The `%s` prop supplied to <select> must be a scalar value if `multiple` is false.%s",v,cr())}}h.value===void 0||h.defaultValue===void 0||RC||(console.error("Select elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled select element and remove one of these props. More info: https://react.dev/link/controlled-components"),RC=!0)}function fr(a,h){h.value===void 0||h.defaultValue===void 0||IC||(console.error("%s contains a textarea with both value and defaultValue props. Textarea elements must be either controlled or uncontrolled (specify either the value prop, or the defaultValue prop, but not both). Decide between using a controlled or uncontrolled textarea and remove one of these props. More info: https://react.dev/link/controlled-components",at()||"A component"),IC=!0),h.children!=null&&h.value==null&&console.error("Use the `defaultValue` or `value` props instead of setting children on <textarea>.")}function xr(a,h,v){if(h!=null&&(h=""+It(h),h!==a.value&&(a.value=h),v==null)){a.defaultValue!==h&&(a.defaultValue=h);return}a.defaultValue=v!=null?""+It(v):""}function Ir(a,h,v,S){if(h==null){if(S!=null){if(v!=null)throw Error("If you supply `defaultValue` on a <textarea>, do not pass children.");if(Ka(S)){if(1<S.length)throw Error("<textarea> can only have at most one child.");S=S[0]}v=S}v==null&&(v=""),h=v}v=It(h),a.defaultValue=v,S=a.textContent,S===v&&S!==""&&S!==null&&(a.value=S)}function qs(a,h){return a.serverProps===void 0&&a.serverTail.length===0&&a.children.length===1&&3<a.distanceFromLeaf&&a.distanceFromLeaf>15-h?qs(a.children[0],h):a}function os(a){return"  "+"  ".repeat(a)}function zs(a){return"+ "+"  ".repeat(a)}function Ua(a){return"- "+"  ".repeat(a)}function Ws(a){switch(a.tag){case 26:case 27:case 5:return a.type;case 16:return"Lazy";case 13:return"Suspense";case 19:return"SuspenseList";case 0:case 15:return a=a.type,a.displayName||a.name||null;case 11:return a=a.type.render,a.displayName||a.name||null;case 1:return a=a.type,a.displayName||a.name||null;default:return null}}function ja(a,h){return MC.test(a)?(a=JSON.stringify(a),a.length>h-2?8>h?'{"..."}':"{"+a.slice(0,h-7)+'..."}':"{"+a+"}"):a.length>h?5>h?'{"..."}':a.slice(0,h-3)+"...":a}function wu(a,h,v){var S=120-2*v;if(h===null)return zs(v)+ja(a,S)+`
`;if(typeof h=="string"){for(var I=0;I<h.length&&I<a.length&&h.charCodeAt(I)===a.charCodeAt(I);I++);return I>S-8&&10<I&&(a="..."+a.slice(I-8),h="..."+h.slice(I-8)),zs(v)+ja(a,S)+`
`+Ua(v)+ja(h,S)+`
`}return os(v)+ja(a,S)+`
`}function Zu(a){return Object.prototype.toString.call(a).replace(/^\[object (.*)\]$/,function(h,v){return v})}function Hc(a,h){switch(typeof a){case"string":return a=JSON.stringify(a),a.length>h?5>h?'"..."':a.slice(0,h-4)+'..."':a;case"object":if(a===null)return"null";if(Ka(a))return"[...]";if(a.$$typeof===Zp)return(h=be(a.type))?"<"+h+">":"<...>";var v=Zu(a);if(v==="Object"){v="",h-=2;for(var S in a)if(a.hasOwnProperty(S)){var I=JSON.stringify(S);if(I!=='"'+S+'"'&&(S=I),h-=S.length-2,I=Hc(a[S],15>h?h:15),h-=I.length,0>h){v+=v===""?"...":", ...";break}v+=(v===""?"":",")+S+":"+I}return"{"+v+"}"}return v;case"function":return(h=a.displayName||a.name)?"function "+h:"function";default:return String(a)}}function Jl(a,h){return typeof a!="string"||MC.test(a)?"{"+Hc(a,h-2)+"}":a.length>h-2?5>h?'"..."':'"'+a.slice(0,h-5)+'..."':'"'+a+'"'}function Xu(a,h,v){var S=120-v.length-a.length,I=[],k;for(k in h)if(h.hasOwnProperty(k)&&k!=="children"){var K=Jl(h[k],120-v.length-k.length-1);S-=k.length+K.length+2,I.push(k+"="+K)}return I.length===0?v+"<"+a+`>
`:0<S?v+"<"+a+" "+I.join(" ")+`>
`:v+"<"+a+`
`+v+"  "+I.join(`
`+v+"  ")+`
`+v+`>
`}function Qu(a,h,v){var S="",I=br({},h),k;for(k in a)if(a.hasOwnProperty(k)){delete I[k];var K=120-2*v-k.length-2,ee=Hc(a[k],K);h.hasOwnProperty(k)?(K=Hc(h[k],K),S+=zs(v)+k+": "+ee+`
`,S+=Ua(v)+k+": "+K+`
`):S+=zs(v)+k+": "+ee+`
`}for(var me in I)I.hasOwnProperty(me)&&(a=Hc(I[me],120-2*v-me.length-2),S+=Ua(v)+me+": "+a+`
`);return S}function Dl(a,h,v,S){var I="",k=new Map;for(De in v)v.hasOwnProperty(De)&&k.set(De.toLowerCase(),De);if(k.size===1&&k.has("children"))I+=Xu(a,h,os(S));else{for(var K in h)if(h.hasOwnProperty(K)&&K!=="children"){var ee=120-2*(S+1)-K.length-1,me=k.get(K.toLowerCase());if(me!==void 0){k.delete(K.toLowerCase());var De=h[K];me=v[me];var it=Jl(De,ee);ee=Jl(me,ee),typeof De=="object"&&De!==null&&typeof me=="object"&&me!==null&&Zu(De)==="Object"&&Zu(me)==="Object"&&(2<Object.keys(De).length||2<Object.keys(me).length||-1<it.indexOf("...")||-1<ee.indexOf("..."))?I+=os(S+1)+K+`={{
`+Qu(De,me,S+2)+os(S+1)+`}}
`:(I+=zs(S+1)+K+"="+it+`
`,I+=Ua(S+1)+K+"="+ee+`
`)}else I+=os(S+1)+K+"="+Jl(h[K],ee)+`
`}k.forEach(function(yt){if(yt!=="children"){var ct=120-2*(S+1)-yt.length-1;I+=Ua(S+1)+yt+"="+Jl(v[yt],ct)+`
`}}),I=I===""?os(S)+"<"+a+`>
`:os(S)+"<"+a+`
`+I+os(S)+`>
`}return a=v.children,h=h.children,typeof a=="string"||typeof a=="number"||typeof a=="bigint"?(k="",(typeof h=="string"||typeof h=="number"||typeof h=="bigint")&&(k=""+h),I+=wu(k,""+a,S+1)):(typeof h=="string"||typeof h=="number"||typeof h=="bigint")&&(I=a==null?I+wu(""+h,null,S+1):I+wu(""+h,void 0,S+1)),I}function Ha(a,h){var v=Ws(a);if(v===null){for(v="",a=a.child;a;)v+=Ha(a,h),a=a.sibling;return v}return os(h)+"<"+v+`>
`}function Ho(a,h){var v=qs(a,h);if(v!==a&&(a.children.length!==1||a.children[0]!==v))return os(h)+`...
`+Ho(v,h+1);v="";var S=a.fiber._debugInfo;if(S)for(var I=0;I<S.length;I++){var k=S[I].name;typeof k=="string"&&(v+=os(h)+"<"+k+`>
`,h++)}if(S="",I=a.fiber.pendingProps,a.fiber.tag===6)S=wu(I,a.serverProps,h),h++;else if(k=Ws(a.fiber),k!==null)if(a.serverProps===void 0){S=h;var K=120-2*S-k.length-2,ee="";for(De in I)if(I.hasOwnProperty(De)&&De!=="children"){var me=Jl(I[De],15);if(K-=De.length+me.length+2,0>K){ee+=" ...";break}ee+=" "+De+"="+me}S=os(S)+"<"+k+ee+`>
`,h++}else a.serverProps===null?(S=Xu(k,I,zs(h)),h++):typeof a.serverProps=="string"?console.error("Should not have matched a non HostText fiber to a Text node. This is a bug in React."):(S=Dl(k,I,a.serverProps,h),h++);var De="";for(I=a.fiber.child,k=0;I&&k<a.children.length;)K=a.children[k],K.fiber===I?(De+=Ho(K,h),k++):De+=Ha(I,h),I=I.sibling;for(I&&0<a.children.length&&(De+=os(h)+`...
`),I=a.serverTail,a.serverProps===null&&h--,a=0;a<I.length;a++)k=I[a],De=typeof k=="string"?De+(Ua(h)+ja(k,120-2*h)+`
`):De+Xu(k.type,k.props,Ua(h));return v+S+De}function To(a){try{return`

`+Ho(a,0)}catch{return""}}function ya(a,h,v){for(var S=h,I=null,k=0;S;)S===a&&(k=0),I={fiber:S,children:I!==null?[I]:[],serverProps:S===h?v:S===a?null:void 0,serverTail:[],distanceFromLeaf:k},k++,S=S.return;return I!==null?To(I).replaceAll(/^[+-]/gm,">"):""}function Mr(a,h){var v=br({},a||fb),S={tag:h};return qf.indexOf(h)!==-1&&(v.aTagInScope=null,v.buttonTagInScope=null,v.nobrTagInScope=null),hb.indexOf(h)!==-1&&(v.pTagInButtonScope=null),PC.indexOf(h)!==-1&&h!=="address"&&h!=="div"&&h!=="p"&&(v.listItemTagAutoclosing=null,v.dlItemTagAutoclosing=null),v.current=S,h==="form"&&(v.formTag=S),h==="a"&&(v.aTagInScope=S),h==="button"&&(v.buttonTagInScope=S),h==="nobr"&&(v.nobrTagInScope=S),h==="p"&&(v.pTagInButtonScope=S),h==="li"&&(v.listItemTagAutoclosing=S),(h==="dd"||h==="dt")&&(v.dlItemTagAutoclosing=S),h==="#document"||h==="html"?v.containerTagInScope=null:v.containerTagInScope||(v.containerTagInScope=S),a!==null||h!=="#document"&&h!=="html"&&h!=="body"?v.implicitRootScope===!0&&(v.implicitRootScope=!1):v.implicitRootScope=!0,v}function na(a,h,v){switch(h){case"select":return a==="hr"||a==="option"||a==="optgroup"||a==="script"||a==="template"||a==="#text";case"optgroup":return a==="option"||a==="#text";case"option":return a==="#text";case"tr":return a==="th"||a==="td"||a==="style"||a==="script"||a==="template";case"tbody":case"thead":case"tfoot":return a==="tr"||a==="style"||a==="script"||a==="template";case"colgroup":return a==="col"||a==="template";case"table":return a==="caption"||a==="colgroup"||a==="tbody"||a==="tfoot"||a==="thead"||a==="style"||a==="script"||a==="template";case"head":return a==="base"||a==="basefont"||a==="bgsound"||a==="link"||a==="meta"||a==="title"||a==="noscript"||a==="noframes"||a==="style"||a==="script"||a==="template";case"html":if(v)break;return a==="head"||a==="body"||a==="frameset";case"frameset":return a==="frame";case"#document":if(!v)return a==="html"}switch(a){case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return h!=="h1"&&h!=="h2"&&h!=="h3"&&h!=="h4"&&h!=="h5"&&h!=="h6";case"rp":case"rt":return db.indexOf(h)===-1;case"caption":case"col":case"colgroup":case"frameset":case"frame":case"tbody":case"td":case"tfoot":case"th":case"thead":case"tr":return h==null;case"head":return v||h===null;case"html":return v&&h==="#document"||h===null;case"body":return v&&(h==="#document"||h==="html")||h===null}return!0}function $a(a,h){switch(a){case"address":case"article":case"aside":case"blockquote":case"center":case"details":case"dialog":case"dir":case"div":case"dl":case"fieldset":case"figcaption":case"figure":case"footer":case"header":case"hgroup":case"main":case"menu":case"nav":case"ol":case"p":case"section":case"summary":case"ul":case"pre":case"listing":case"table":case"hr":case"xmp":case"h1":case"h2":case"h3":case"h4":case"h5":case"h6":return h.pTagInButtonScope;case"form":return h.formTag||h.pTagInButtonScope;case"li":return h.listItemTagAutoclosing;case"dd":case"dt":return h.dlItemTagAutoclosing;case"button":return h.buttonTagInScope;case"a":return h.aTagInScope;case"nobr":return h.nobrTagInScope}return null}function ec(a,h){for(;a;){switch(a.tag){case 5:case 26:case 27:if(a.type===h)return a}a=a.return}return null}function ll(a,h){h=h||fb;var v=h.current;if(h=(v=na(a,v&&v.tag,h.implicitRootScope)?null:v)?null:$a(a,h),h=v||h,!h)return!0;var S=h.tag;if(h=String(!!v)+"|"+a+"|"+S,em[h])return!1;em[h]=!0;var I=(h=hu)?ec(h.return,S):null,k=h!==null&&I!==null?ya(I,h,null):"",K="<"+a+">";return v?(v="",S==="table"&&a==="tr"&&(v+=" Add a <tbody>, <thead> or <tfoot> to your code to match the DOM tree generated by the browser."),console.error(`In HTML, %s cannot be a child of <%s>.%s
This will cause a hydration error.%s`,K,S,v,k)):console.error(`In HTML, %s cannot be a descendant of <%s>.
This will cause a hydration error.%s`,K,S,k),h&&(a=h.return,I===null||a===null||I===a&&a._debugOwner===h._debugOwner||Ze(I,function(){console.error(`<%s> cannot contain a nested %s.
See this log for the ancestor stack trace.`,S,K)})),!1}function $c(a,h,v){if(v||na("#text",h,!1))return!0;if(v="#text|"+h,em[v])return!1;em[v]=!0;var S=(v=hu)?ec(v,h):null;return v=v!==null&&S!==null?ya(S,v,v.tag!==6?{children:null}:null):"",/\S/.test(a)?console.error(`In HTML, text nodes cannot be a child of <%s>.
This will cause a hydration error.%s`,h,v):console.error(`In HTML, whitespace text nodes cannot be a child of <%s>. Make sure you don't have any extra whitespace between tags on each line of your source code.
This will cause a hydration error.%s`,h,v),!1}function Rl(a,h){if(h){var v=a.firstChild;if(v&&v===a.lastChild&&v.nodeType===3){v.nodeValue=h;return}}a.textContent=h}function Xh(a){return a.replace(SM,function(h,v){return v.toUpperCase()})}function bp(a,h,v){var S=h.indexOf("--")===0;S||(-1<h.indexOf("-")?Wf.hasOwnProperty(h)&&Wf[h]||(Wf[h]=!0,console.error("Unsupported style property %s. Did you mean %s?",h,Xh(h.replace(EM,"ms-")))):kC.test(h)?Wf.hasOwnProperty(h)&&Wf[h]||(Wf[h]=!0,console.error("Unsupported vendor-prefixed style property %s. Did you mean %s?",h,h.charAt(0).toUpperCase()+h.slice(1))):!ZT.test(v)||x1.hasOwnProperty(v)&&x1[v]||(x1[v]=!0,console.error(`Style property values shouldn't contain a semicolon. Try "%s: %s" instead.`,h,v.replace(ZT,""))),typeof v=="number"&&(isNaN(v)?NC||(NC=!0,console.error("`NaN` is an invalid value for the `%s` css style property.",h)):isFinite(v)||XT||(XT=!0,console.error("`Infinity` is an invalid value for the `%s` css style property.",h)))),v==null||typeof v=="boolean"||v===""?S?a.setProperty(h,""):h==="float"?a.cssFloat="":a[h]="":S?a.setProperty(h,v):typeof v!="number"||v===0||w1.has(h)?h==="float"?a.cssFloat=v:(ln(v,h),a[h]=(""+v).trim()):a[h]=v+"px"}function xp(a,h,v){if(h!=null&&typeof h!="object")throw Error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");if(h&&Object.freeze(h),a=a.style,v!=null){if(h){var S={};if(v){for(var I in v)if(v.hasOwnProperty(I)&&!h.hasOwnProperty(I))for(var k=b1[I]||[I],K=0;K<k.length;K++)S[k[K]]=I}for(var ee in h)if(h.hasOwnProperty(ee)&&(!v||v[ee]!==h[ee]))for(I=b1[ee]||[ee],k=0;k<I.length;k++)S[I[k]]=ee;ee={};for(var me in h)for(I=b1[me]||[me],k=0;k<I.length;k++)ee[I[k]]=me;me={};for(var De in S)if(I=S[De],(k=ee[De])&&I!==k&&(K=I+","+k,!me[K])){me[K]=!0,K=console;var it=h[I];K.error.call(K,"%s a style property during rerender (%s) when a conflicting property is set (%s) can lead to styling bugs. To avoid this, don't mix shorthand and non-shorthand properties for the same value; instead, replace the shorthand with separate values.",it==null||typeof it=="boolean"||it===""?"Removing":"Updating",I,k)}}for(var yt in v)!v.hasOwnProperty(yt)||h!=null&&h.hasOwnProperty(yt)||(yt.indexOf("--")===0?a.setProperty(yt,""):yt==="float"?a.cssFloat="":a[yt]="");for(var ct in h)De=h[ct],h.hasOwnProperty(ct)&&v[ct]!==De&&bp(a,ct,De)}else for(S in h)h.hasOwnProperty(S)&&bp(a,S,h[S])}function Bs(a){if(a.indexOf("-")===-1)return!1;switch(a){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}function ia(a){return LC.get(a)||a}function Qh(a,h){if($f.call(Ly,h)&&Ly[h])return!0;if(BC.test(h)){if(a="aria-"+h.slice(4).toLowerCase(),a=QT.hasOwnProperty(a)?a:null,a==null)return console.error("Invalid ARIA attribute `%s`. ARIA attributes follow the pattern aria-* and must be lowercase.",h),Ly[h]=!0;if(h!==a)return console.error("Invalid ARIA attribute `%s`. Did you mean `%s`?",h,a),Ly[h]=!0}if(zC.test(h)){if(a=h.toLowerCase(),a=QT.hasOwnProperty(a)?a:null,a==null)return Ly[h]=!0,!1;h!==a&&(console.error("Unknown ARIA attribute `%s`. Did you mean `%s`?",h,a),Ly[h]=!0)}return!0}function Ku(a,h){var v=[],S;for(S in h)Qh(a,S)||v.push(S);h=v.map(function(I){return"`"+I+"`"}).join(", "),v.length===1?console.error("Invalid aria prop %s on <%s> tag. For details, see https://react.dev/link/invalid-aria-props",h,a):1<v.length&&console.error("Invalid aria props %s on <%s> tag. For details, see https://react.dev/link/invalid-aria-props",h,a)}function Qm(a,h,v,S){if($f.call(yl,h)&&yl[h])return!0;var I=h.toLowerCase();if(I==="onfocusin"||I==="onfocusout")return console.error("React uses onFocus and onBlur instead of onFocusIn and onFocusOut. All React events are normalized to bubble, so onFocusIn and onFocusOut are not needed/supported by React."),yl[h]=!0;if(typeof v=="function"&&(a==="form"&&h==="action"||a==="input"&&h==="formAction"||a==="button"&&h==="formAction"))return!0;if(S!=null){if(a=S.possibleRegistrationNames,S.registrationNameDependencies.hasOwnProperty(h))return!0;if(S=a.hasOwnProperty(I)?a[I]:null,S!=null)return console.error("Invalid event handler property `%s`. Did you mean `%s`?",h,S),yl[h]=!0;if(KT.test(h))return console.error("Unknown event handler property `%s`. It will be ignored.",h),yl[h]=!0}else if(KT.test(h))return FC.test(h)&&console.error("Invalid event handler property `%s`. React events use the camelCase naming convention, for example `onClick`.",h),yl[h]=!0;if(T1.test(h)||AM.test(h))return!0;if(I==="innerhtml")return console.error("Directly setting property `innerHTML` is not permitted. For more information, lookup documentation on `dangerouslySetInnerHTML`."),yl[h]=!0;if(I==="aria")return console.error("The `aria` attribute is reserved for future use in React. Pass individual `aria-` attributes instead."),yl[h]=!0;if(I==="is"&&v!==null&&v!==void 0&&typeof v!="string")return console.error("Received a `%s` for a string attribute `is`. If this is expected, cast the value to a string.",typeof v),yl[h]=!0;if(typeof v=="number"&&isNaN(v))return console.error("Received NaN for the `%s` attribute. If this is expected, cast the value to a string.",h),yl[h]=!0;if(mb.hasOwnProperty(I)){if(I=mb[I],I!==h)return console.error("Invalid DOM property `%s`. Did you mean `%s`?",h,I),yl[h]=!0}else if(h!==I)return console.error("React does not recognize the `%s` prop on a DOM element. If you intentionally want it to appear in the DOM as a custom attribute, spell it as lowercase `%s` instead. If you accidentally passed it from a parent component, remove it from the DOM element.",h,I),yl[h]=!0;switch(h){case"dangerouslySetInnerHTML":case"children":case"style":case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":return!0;case"innerText":case"textContent":return!0}switch(typeof v){case"boolean":switch(h){case"autoFocus":case"checked":case"multiple":case"muted":case"selected":case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":case"capture":case"download":case"inert":return!0;default:return I=h.toLowerCase().slice(0,5),I==="data-"||I==="aria-"?!0:(v?console.error('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.',v,h,h,v,h):console.error('Received `%s` for a non-boolean attribute `%s`.\n\nIf you want to write it to the DOM, pass a string instead: %s="%s" or %s={value.toString()}.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.',v,h,h,v,h,h,h),yl[h]=!0)}case"function":case"symbol":return yl[h]=!0,!1;case"string":if(v==="false"||v==="true"){switch(h){case"checked":case"selected":case"multiple":case"muted":case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":case"inert":break;default:return!0}console.error("Received the string `%s` for the boolean attribute `%s`. %s Did you mean %s={%s}?",v,h,v==="false"?"The browser will interpret it as a truthy value.":'Although this works, it will not work as expected if you pass the string "false".',h,v),yl[h]=!0}}return!0}function Ju(a,h,v){var S=[],I;for(I in h)Qm(a,I,h[I],v)||S.push(I);h=S.map(function(k){return"`"+k+"`"}).join(", "),S.length===1?console.error("Invalid value for prop %s on <%s> tag. Either remove it from the element, or pass a string or number value to keep it in the DOM. For details, see https://react.dev/link/attribute-behavior ",h,a):1<S.length&&console.error("Invalid values for props %s on <%s> tag. Either remove them from the element, or pass a string or number value to keep them in the DOM. For details, see https://react.dev/link/attribute-behavior ",h,a)}function Gc(a){return VC.test(""+a)?"javascript:throw new Error('React has blocked a javascript: URL as a security precaution.')":a}function Si(a){return a=a.target||a.srcElement||window,a.correspondingUseElement&&(a=a.correspondingUseElement),a.nodeType===3?a.parentNode:a}function uf(a){var h=Xs(a);if(h&&(a=h.stateNode)){var v=a[yc]||null;e:switch(a=h.stateNode,h.type){case"input":if(oi(a,v.value,v.defaultValue,v.defaultValue,v.checked,v.defaultChecked,v.type,v.name),h=v.name,v.type==="radio"&&h!=null){for(v=a;v.parentNode;)v=v.parentNode;for(Ut(h,"name"),v=v.querySelectorAll('input[name="'+Vn(""+h)+'"][type="radio"]'),h=0;h<v.length;h++){var S=v[h];if(S!==a&&S.form===a.form){var I=S[yc]||null;if(!I)throw Error("ReactDOMInput: Mixing React and non-React radio inputs with the same `name` is not supported.");oi(S,I.value,I.defaultValue,I.defaultValue,I.checked,I.defaultChecked,I.type,I.name)}}for(h=0;h<v.length;h++)S=v[h],S.form===a.form&&Sn(S)}break e;case"textarea":xr(a,v.value,v.defaultValue);break e;case"select":h=v.value,h!=null&&Ai(a,!!v.multiple,h,!1)}}}function va(a,h,v){if(JT)return a(h,v);JT=!0;try{var S=a(h);return S}finally{if(JT=!1,(Fg!==null||Vg!==null)&&(kf(),Fg&&(h=Fg,a=Vg,Vg=Fg=null,uf(h),a)))for(h=0;h<a.length;h++)uf(a[h])}}function qc(a,h){var v=a.stateNode;if(v===null)return null;var S=v[yc]||null;if(S===null)return null;v=S[h];e:switch(h){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(S=!S.disabled)||(a=a.type,S=!(a==="button"||a==="input"||a==="select"||a==="textarea")),a=!S;break e;default:a=!1}if(a)return null;if(v&&typeof v!="function")throw Error("Expected `"+h+"` listener to be a function, instead got a value of `"+typeof v+"` type.");return v}function B_(){if(Qf)return Qf;var a,h=Xf,v=h.length,S,I="value"in Pd?Pd.value:Pd.textContent,k=I.length;for(a=0;a<v&&h[a]===I[a];a++);var K=v-a;for(S=1;S<=K&&h[v-S]===I[k-S];S++);return Qf=I.slice(a,1<S?1-S:void 0)}function Ol(a){var h=a.keyCode;return"charCode"in a?(a=a.charCode,a===0&&h===13&&(a=13)):a=h,a===10&&(a=13),32<=a||a===13?a:0}function Ga(){return!0}function tc(){return!1}function so(a){function h(v,S,I,k,K){this._reactName=v,this._targetInst=I,this.type=S,this.nativeEvent=k,this.target=K,this.currentTarget=null;for(var ee in a)a.hasOwnProperty(ee)&&(v=a[ee],this[ee]=v?v(k):k[ee]);return this.isDefaultPrevented=(k.defaultPrevented!=null?k.defaultPrevented:k.returnValue===!1)?Ga:tc,this.isPropagationStopped=tc,this}return br(h.prototype,{preventDefault:function(){this.defaultPrevented=!0;var v=this.nativeEvent;v&&(v.preventDefault?v.preventDefault():typeof v.returnValue!="unknown"&&(v.returnValue=!1),this.isDefaultPrevented=Ga)},stopPropagation:function(){var v=this.nativeEvent;v&&(v.stopPropagation?v.stopPropagation():typeof v.cancelBubble!="unknown"&&(v.cancelBubble=!0),this.isPropagationStopped=Ga)},persist:function(){},isPersistent:Ga}),h}function eh(a){var h=this.nativeEvent;return h.getModifierState?h.getModifierState(a):(a=OM[a])?!!h[a]:!1}function nc(){return eh}function hf(a,h){switch(a){case"keyup":return kM.indexOf(h.keyCode)!==-1;case"keydown":return h.keyCode!==JC;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function Gr(a){return a=a.detail,typeof a=="object"&&"data"in a?a.data:null}function wp(a,h){switch(a){case"compositionend":return Gr(h);case"keypress":return h.which!==eD?null:(nD=!0,tD);case"textInput":return a=h.data,a===tD&&nD?null:a;default:return null}}function Tp(a,h){if(im)return a==="compositionend"||!nE&&hf(a,h)?(a=B_(),Qf=Xf=Pd=null,im=!1,a):null;switch(a){case"paste":return null;case"keypress":if(!(h.ctrlKey||h.altKey||h.metaKey)||h.ctrlKey&&h.altKey){if(h.char&&1<h.char.length)return h.char;if(h.which)return String.fromCharCode(h.which)}return null;case"compositionend":return iE&&h.locale!=="ko"?null:h.data;default:return null}}function qa(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h==="input"?!!rE[a.type]:h==="textarea"}function Kh(a){if(!Md)return!1;a="on"+a;var h=a in document;return h||(h=document.createElement("div"),h.setAttribute(a,"return;"),h=typeof h[a]=="function"),h}function Wc(a,h,v,S){Fg?Vg?Vg.push(S):Vg=[S]:Fg=S,h=Ue(h,"onChange"),0<h.length&&(v=new zy("onChange","change",null,v,S),a.push({event:v,listeners:h}))}function th(a){pe(a,0)}function nh(a){var h=ho(a);if(Sn(h))return a}function Wa(a,h){if(a==="change")return h}function Yc(){Vy&&(Vy.detachEvent("onpropertychange",ra),Uy=Vy=null)}function ra(a){if(a.propertyName==="value"&&nh(Uy)){var h=[];Wc(h,Uy,a,Si(a)),va(th,h)}}function ih(a,h,v){a==="focusin"?(Yc(),Vy=h,Uy=v,Vy.attachEvent("onpropertychange",ra)):a==="focusout"&&Yc()}function rh(a){if(a==="selectionchange"||a==="keyup"||a==="keydown")return nh(Uy)}function Zc(a,h){if(a==="click")return nh(h)}function Mi(a,h){if(a==="input"||a==="change")return nh(h)}function cl(a,h){return a===h&&(a!==0||1/a===1/h)||a!==a&&h!==h}function Tu(a,h){if(vl(a,h))return!0;if(typeof a!="object"||a===null||typeof h!="object"||h===null)return!1;var v=Object.keys(a),S=Object.keys(h);if(v.length!==S.length)return!1;for(S=0;S<v.length;S++){var I=v[S];if(!$f.call(h,I)||!vl(a[I],h[I]))return!1}return!0}function Ep(a){for(;a&&a.firstChild;)a=a.firstChild;return a}function $n(a,h){var v=Ep(a);a=0;for(var S;v;){if(v.nodeType===3){if(S=a+v.textContent.length,a<=h&&S>=h)return{node:v,offset:h-a};a=S}e:{for(;v;){if(v.nextSibling){v=v.nextSibling;break e}v=v.parentNode}v=void 0}v=Ep(v)}}function Xc(a,h){return a&&h?a===h?!0:a&&a.nodeType===3?!1:h&&h.nodeType===3?Xc(a,h.parentNode):"contains"in a?a.contains(h):a.compareDocumentPosition?!!(a.compareDocumentPosition(h)&16):!1:!1}function sh(a){a=a!=null&&a.ownerDocument!=null&&a.ownerDocument.defaultView!=null?a.ownerDocument.defaultView:window;for(var h=Gn(a.document);h instanceof a.HTMLIFrameElement;){try{var v=typeof h.contentWindow.location.href=="string"}catch{v=!1}if(v)a=h.contentWindow;else break;h=Gn(a.document)}return h}function ic(a){var h=a&&a.nodeName&&a.nodeName.toLowerCase();return h&&(h==="input"&&(a.type==="text"||a.type==="search"||a.type==="tel"||a.type==="url"||a.type==="password")||h==="textarea"||a.contentEditable==="true")}function $o(a,h,v){var S=v.window===v?v.document:v.nodeType===9?v:v.ownerDocument;bb||jg==null||jg!==Gn(S)||(S=jg,"selectionStart"in S&&ic(S)?S={start:S.selectionStart,end:S.selectionEnd}:(S=(S.ownerDocument&&S.ownerDocument.defaultView||window).getSelection(),S={anchorNode:S.anchorNode,anchorOffset:S.anchorOffset,focusNode:S.focusNode,focusOffset:S.focusOffset}),jy&&Tu(jy,S)||(jy=S,S=Ue(D1,"onSelect"),0<S.length&&(h=new zy("onSelect","select",null,h,v),a.push({event:h,listeners:S}),h.target=jg)))}function Il(a,h){var v={};return v[a.toLowerCase()]=h.toLowerCase(),v["Webkit"+a]="webkit"+h,v["Moz"+a]="moz"+h,v}function Ya(a){if(oE[a])return oE[a];if(!Hg[a])return a;var h=Hg[a],v;for(v in h)if(h.hasOwnProperty(v)&&v in Hy)return oE[a]=h[v];return a}function xn(a,h){aD.set(a,h),Pn(h,[a])}function gi(a,h){if(typeof a=="object"&&a!==null){var v=R1.get(a);return v!==void 0?v:(h={value:a,source:h,stack:tt(h)},R1.set(a,h),h)}return{value:a,source:h,stack:tt(h)}}function Di(){for(var a=kd,h=cE=kd=0;h<a;){var v=Lu[h];Lu[h++]=null;var S=Lu[h];Lu[h++]=null;var I=Lu[h];Lu[h++]=null;var k=Lu[h];if(Lu[h++]=null,S!==null&&I!==null){var K=S.pending;K===null?I.next=I:(I.next=K.next,K.next=I),S.pending=I}k!==0&&Jh(v,I,k)}}function Fs(a,h,v,S){Lu[kd++]=a,Lu[kd++]=h,Lu[kd++]=v,Lu[kd++]=S,cE|=S,a.lanes|=S,a=a.alternate,a!==null&&(a.lanes|=S)}function ul(a,h,v,S){return Fs(a,h,v,S),Qc(a)}function fi(a,h){return Fs(a,null,null,h),Qc(a)}function Jh(a,h,v){a.lanes|=v;var S=a.alternate;S!==null&&(S.lanes|=v);for(var I=!1,k=a.return;k!==null;)k.childLanes|=v,S=k.alternate,S!==null&&(S.childLanes|=v),k.tag===22&&(a=k.stateNode,a===null||a._visibility&O1||(I=!0)),a=k,k=k.return;return a.tag===3?(k=a.stateNode,I&&h!==null&&(I=31-Ja(v),a=k.hiddenUpdates,S=a[I],S===null?a[I]=[h]:S.push(h),h.lane=v|536870912),k):null}function Qc(a){if(gv>zD)throw qd=gv=0,Vb=Gd=null,Error("Maximum update depth exceeded. This can happen when a component repeatedly calls setState inside componentWillUpdate or componentDidUpdate. React limits the number of nested updates to prevent infinite loops.");qd>VM&&(qd=0,Vb=null,console.error("Maximum update depth exceeded. This can happen when a component calls setState inside useEffect, but useEffect either doesn't have a dependency array, or one of the dependencies changes on every render.")),a.alternate===null&&(a.flags&4098)!==0&&Bf(a);for(var h=a,v=h.return;v!==null;)h.alternate===null&&(h.flags&4098)!==0&&Bf(a),h=v,v=h.return;return h.tag===3?h.stateNode:null}function ba(a){if(du===null)return a;var h=du(a);return h===void 0?a:h.current}function Wr(a){if(du===null)return a;var h=du(a);return h===void 0?a!=null&&typeof a.render=="function"&&(h=ba(a.render),a.render!==h)?(h={$$typeof:ky,render:h},a.displayName!==void 0&&(h.displayName=a.displayName),h):a:h.current}function ys(a,h){if(du===null)return!1;var v=a.elementType;h=h.type;var S=!1,I=typeof h=="object"&&h!==null?h.$$typeof:null;switch(a.tag){case 1:typeof h=="function"&&(S=!0);break;case 0:(typeof h=="function"||I===_c)&&(S=!0);break;case 11:(I===ky||I===_c)&&(S=!0);break;case 14:case 15:(I===go||I===_c)&&(S=!0);break;default:return!1}return!!(S&&(a=du(v),a!==void 0&&a===du(h)))}function Km(a){du!==null&&typeof WeakSet=="function"&&(sm===null&&(sm=new WeakSet),sm.add(a))}function Za(a,h,v){var S=a.alternate,I=a.child,k=a.sibling,K=a.tag,ee=a.type,me=null;switch(K){case 0:case 15:case 1:me=ee;break;case 11:me=ee.render}if(du===null)throw Error("Expected resolveFamily to be set during hot reload.");var De=!1;ee=!1,me!==null&&(me=du(me),me!==void 0&&(v.has(me)?ee=!0:h.has(me)&&(K===1?ee=!0:De=!0))),sm!==null&&(sm.has(a)||S!==null&&sm.has(S))&&(ee=!0),ee&&(a._debugNeedsRemount=!0),(ee||De)&&(S=fi(a,2),S!==null&&oo(S,a,2)),I===null||ee||Za(I,h,v),k!==null&&Za(k,h,v)}function V(a,h,v,S){this.tag=a,this.key=v,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.refCleanup=this.ref=null,this.pendingProps=h,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=S,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null,this.actualDuration=-0,this.actualStartTime=-1.1,this.treeBaseDuration=this.selfBaseDuration=-0,this._debugTask=this._debugStack=this._debugOwner=this._debugInfo=null,this._debugNeedsRemount=!1,this._debugHookTypes=null,lD||typeof Object.preventExtensions!="function"||Object.preventExtensions(this)}function le(a){return a=a.prototype,!(!a||!a.isReactComponent)}function xe(a,h){var v=a.alternate;switch(v===null?(v=F(a.tag,h,a.key,a.mode),v.elementType=a.elementType,v.type=a.type,v.stateNode=a.stateNode,v._debugOwner=a._debugOwner,v._debugStack=a._debugStack,v._debugTask=a._debugTask,v._debugHookTypes=a._debugHookTypes,v.alternate=a,a.alternate=v):(v.pendingProps=h,v.type=a.type,v.flags=0,v.subtreeFlags=0,v.deletions=null,v.actualDuration=-0,v.actualStartTime=-1.1),v.flags=a.flags&65011712,v.childLanes=a.childLanes,v.lanes=a.lanes,v.child=a.child,v.memoizedProps=a.memoizedProps,v.memoizedState=a.memoizedState,v.updateQueue=a.updateQueue,h=a.dependencies,v.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext,_debugThenableState:h._debugThenableState},v.sibling=a.sibling,v.index=a.index,v.ref=a.ref,v.refCleanup=a.refCleanup,v.selfBaseDuration=a.selfBaseDuration,v.treeBaseDuration=a.treeBaseDuration,v._debugInfo=a._debugInfo,v._debugNeedsRemount=a._debugNeedsRemount,v.tag){case 0:case 15:v.type=ba(a.type);break;case 1:v.type=ba(a.type);break;case 11:v.type=Wr(a.type)}return v}function Ke(a,h){a.flags&=65011714;var v=a.alternate;return v===null?(a.childLanes=0,a.lanes=h,a.child=null,a.subtreeFlags=0,a.memoizedProps=null,a.memoizedState=null,a.updateQueue=null,a.dependencies=null,a.stateNode=null,a.selfBaseDuration=0,a.treeBaseDuration=0):(a.childLanes=v.childLanes,a.lanes=v.lanes,a.child=v.child,a.subtreeFlags=0,a.deletions=null,a.memoizedProps=v.memoizedProps,a.memoizedState=v.memoizedState,a.updateQueue=v.updateQueue,a.type=v.type,h=v.dependencies,a.dependencies=h===null?null:{lanes:h.lanes,firstContext:h.firstContext,_debugThenableState:h._debugThenableState},a.selfBaseDuration=v.selfBaseDuration,a.treeBaseDuration=v.treeBaseDuration),a}function Vt(a,h,v,S,I,k){var K=0,ee=a;if(typeof a=="function")le(a)&&(K=1),ee=ba(ee);else if(typeof a=="string")K=mt(),K=sC(a,v,K)?26:a==="html"||a==="head"||a==="body"?27:5;else e:switch(a){case kg:return h=F(31,v,h,I),h.elementType=kg,h.lanes=k,h;case Pg:return Ln(v.children,I,k,h);case eb:K=8,I|=tl,I|=vc;break;case l1:return a=v,S=I,typeof a.id!="string"&&console.error('Profiler must specify an "id" of type `string` as a prop. Received the type `%s` instead.',typeof a.id),h=F(12,a,h,S|el),h.elementType=l1,h.lanes=k,h.stateNode={effectDuration:0,passiveEffectDuration:0},h;case tb:return h=F(13,v,h,I),h.elementType=tb,h.lanes=k,h;case Ed:return h=F(19,v,h,I),h.elementType=Ed,h.lanes=k,h;default:if(typeof a=="object"&&a!==null)switch(a.$$typeof){case mC:case Ph:K=10;break e;case c1:K=9;break e;case ky:K=11,ee=Wr(ee);break e;case go:K=14;break e;case _c:K=16,ee=null;break e}ee="",(a===void 0||typeof a=="object"&&a!==null&&Object.keys(a).length===0)&&(ee+=" You likely forgot to export your component from the file it's defined in, or you might have mixed up default and named imports."),a===null?v="null":Ka(a)?v="array":a!==void 0&&a.$$typeof===Zp?(v="<"+(be(a.type)||"Unknown")+" />",ee=" Did you accidentally export a JSX literal instead of a component?"):v=typeof a,(K=S?_e(S):null)&&(ee+=`

Check the render method of \``+K+"`."),K=29,v=Error("Element type is invalid: expected a string (for built-in components) or a class/function (for composite components) but got: "+(v+"."+ee)),ee=null}return h=F(K,v,h,I),h.elementType=a,h.type=ee,h.lanes=k,h._debugOwner=S,h}function $t(a,h,v){return h=Vt(a.type,a.key,a.props,a._owner,h,v),h._debugOwner=a._owner,h._debugStack=a._debugStack,h._debugTask=a._debugTask,h}function Ln(a,h,v,S){return a=F(7,a,S,h),a.lanes=v,a}function Hi(a,h,v){return a=F(6,a,null,h),a.lanes=v,a}function Ss(a,h,v){return h=F(4,a.children!==null?a.children:[],a.key,h),h.lanes=v,h.stateNode={containerInfo:a.containerInfo,pendingChildren:null,implementation:a.implementation},h}function kn(a,h){Ki(),$y[Gy++]=om,$y[Gy++]=Oa,Oa=a,om=h}function an(a,h,v){Ki(),nl[bc++]=Jf,nl[bc++]=Ld,nl[bc++]=Nd,Nd=a;var S=Jf;a=Ld;var I=32-Ja(S)-1;S&=~(1<<I),v+=1;var k=32-Ja(h)+I;if(30<k){var K=I-I%5;k=(S&(1<<K)-1).toString(32),S>>=K,I-=K,Jf=1<<32-Ja(h)+I|v<<I|S,Ld=k+a}else Jf=1<<k|v<<I|S,Ld=a}function Jr(a){Ki(),a.return!==null&&(kn(a,1),an(a,1,0))}function Hn(a){for(;a===Oa;)Oa=$y[--Gy],$y[Gy]=null,om=$y[--Gy],$y[Gy]=null;for(;a===Nd;)Nd=nl[--bc],nl[bc]=null,Ld=nl[--bc],nl[bc]=null,Jf=nl[--bc],nl[bc]=null}function Ki(){qr||console.error("Expected to be hydrating. This is a bug in React. Please file an issue.")}function xa(a,h){if(a.return===null){if(xc===null)xc={fiber:a,children:[],serverProps:void 0,serverTail:[],distanceFromLeaf:h};else{if(xc.fiber!==a)throw Error("Saw multiple hydration diff roots in a pass. This is a bug in React.");xc.distanceFromLeaf>h&&(xc.distanceFromLeaf=h)}return xc}var v=xa(a.return,h+1).children;return 0<v.length&&v[v.length-1].fiber===a?(v=v[v.length-1],v.distanceFromLeaf>h&&(v.distanceFromLeaf=h),v):(h={fiber:a,children:[],serverProps:void 0,serverTail:[],distanceFromLeaf:h},v.push(h),h)}function Un(a,h){zd||(a=xa(a,0),a.serverProps=null,h!==null&&(h=Ca(h),a.serverTail.push(h)))}function rc(a){var h="",v=xc;throw v!==null&&(xc=null,h=To(v)),ah(gi(Error(`Hydration failed because the server rendered HTML didn't match the client. As a result this tree will be regenerated on the client. This can happen if a SSR-ed Client Component used:

- A server/client branch \`if (typeof window !== 'undefined')\`.
- Variable input such as \`Date.now()\` or \`Math.random()\` which changes each time it's called.
- Date formatting in a user's locale which doesn't match the server.
- External changing data without sending a snapshot of it along with the HTML.
- Invalid HTML tag nesting.

It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.

https://react.dev/link/hydration-mismatch`+h),a)),hE}function df(a){var h=a.stateNode,v=a.type,S=a.memoizedProps;switch(h[_l]=a,h[yc]=S,_t(v,S),v){case"dialog":ge("cancel",h),ge("close",h);break;case"iframe":case"object":case"embed":ge("load",h);break;case"video":case"audio":for(v=0;v<vv.length;v++)ge(vv[v],h);break;case"source":ge("error",h);break;case"img":case"image":case"link":ge("error",h),ge("load",h);break;case"details":ge("toggle",h);break;case"input":Wn("input",S),ge("invalid",h),Jn(h,S),ii(h,S.value,S.defaultValue,S.checked,S.defaultChecked,S.type,S.name,!0),_n(h);break;case"option":tr(h,S);break;case"select":Wn("select",S),ge("invalid",h),Ei(h,S);break;case"textarea":Wn("textarea",S),ge("invalid",h),fr(h,S),Ir(h,S.value,S.defaultValue,S.children),_n(h)}v=S.children,typeof v!="string"&&typeof v!="number"&&typeof v!="bigint"||h.textContent===""+v||S.suppressHydrationWarning===!0||Dt(h.textContent,v)?(S.popover!=null&&(ge("beforetoggle",h),ge("toggle",h)),S.onScroll!=null&&ge("scroll",h),S.onScrollEnd!=null&&ge("scrollend",h),S.onClick!=null&&(h.onclick=ot),h=!0):h=!1,h||rc(a)}function oh(a){for(bl=a.return;bl;)switch(bl.tag){case 5:case 13:Bh=!1;return;case 27:case 3:Bh=!0;return;default:bl=bl.return}}function Sp(a){if(a!==bl)return!1;if(!qr)return oh(a),qr=!0,!1;var h=a.tag,v;if((v=h!==3&&h!==27)&&((v=h===5)&&(v=a.type,v=!(v!=="form"&&v!=="button")||qi(a.type,a.memoizedProps)),v=!v),v&&So){for(v=So;v;){var S=xa(a,0),I=Ca(v);S.serverTail.push(I),v=I.type==="Suspense"?fc(v):js(v.nextSibling)}rc(a)}if(oh(a),h===13){if(a=a.memoizedState,a=a!==null?a.dehydrated:null,!a)throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");So=fc(a)}else h===27?(h=So,Wi(a.type)?(a=nS,nS=null,So=a):So=h):So=bl?js(a.stateNode.nextSibling):null;return!0}function wa(){So=bl=null,zd=qr=!1}function sa(){var a=am;return a!==null&&(Gl===null?Gl=a:Gl.push.apply(Gl,a),am=null),a}function ah(a){am===null?am=[a]:am.push(a)}function fo(){var a=xc;if(a!==null){xc=null;for(var h=To(a);0<a.children.length;)a=a.children[0];Ze(a.fiber,function(){console.error(`A tree hydrated but some attributes of the server rendered HTML didn't match the client properties. This won't be patched up. This can happen if a SSR-ed Client Component used:

- A server/client branch \`if (typeof window !== 'undefined')\`.
- Variable input such as \`Date.now()\` or \`Math.random()\` which changes each time it's called.
- Date formatting in a user's locale which doesn't match the server.
- External changing data without sending a snapshot of it along with the HTML.
- Invalid HTML tag nesting.

It can also happen if the client has a browser extension installed which messes with the HTML before React loaded.

%s%s`,"https://react.dev/link/hydration-mismatch",h)})}}function Ap(){wc=lm=null,$g=!1}function oa(a,h,v){$e(zu,h._currentValue,a),h._currentValue=v,$e(M1,h._currentRenderer,a),h._currentRenderer!==void 0&&h._currentRenderer!==null&&h._currentRenderer!==P1&&console.error("Detected multiple renderers concurrently rendering the same context provider. This is currently unsupported."),h._currentRenderer=P1}function Vs(a,h){a._currentValue=zu.current;var v=M1.current;Ee(M1,h),a._currentRenderer=v,Ee(zu,h)}function ff(a,h,v){for(;a!==null;){var S=a.alternate;if((a.childLanes&h)!==h?(a.childLanes|=h,S!==null&&(S.childLanes|=h)):S!==null&&(S.childLanes&h)!==h&&(S.childLanes|=h),a===v)break;a=a.return}a!==v&&console.error("Expected to find the propagation root when scheduling context work. This error is likely caused by a bug in React. Please file an issue.")}function f0(a,h,v,S){var I=a.child;for(I!==null&&(I.return=a);I!==null;){var k=I.dependencies;if(k!==null){var K=I.child;k=k.firstContext;e:for(;k!==null;){var ee=k;k=I;for(var me=0;me<h.length;me++)if(ee.context===h[me]){k.lanes|=v,ee=k.alternate,ee!==null&&(ee.lanes|=v),ff(k.return,v,a),S||(K=null);break e}k=ee.next}}else if(I.tag===18){if(K=I.return,K===null)throw Error("We just came from a parent so we must have had a parent. This is a bug in React.");K.lanes|=v,k=K.alternate,k!==null&&(k.lanes|=v),ff(K,v,a),K=null}else K=I.child;if(K!==null)K.return=I;else for(K=I;K!==null;){if(K===a){K=null;break}if(I=K.sibling,I!==null){I.return=K.return,K=I;break}K=K.return}I=K}}function Jm(a,h,v,S){a=null;for(var I=h,k=!1;I!==null;){if(!k){if((I.flags&524288)!==0)k=!0;else if((I.flags&262144)!==0)break}if(I.tag===10){var K=I.alternate;if(K===null)throw Error("Should have a current fiber. This is a bug in React.");if(K=K.memoizedProps,K!==null){var ee=I.type;vl(I.pendingProps.value,K.value)||(a!==null?a.push(ee):a=[ee])}}else if(I===u1.current){if(K=I.alternate,K===null)throw Error("Should have a current fiber. This is a bug in React.");K.memoizedState.memoizedState!==I.memoizedState.memoizedState&&(a!==null?a.push(u):a=[u])}I=I.return}a!==null&&f0(h,a,v,S),h.flags|=262144}function Kc(a){for(a=a.firstContext;a!==null;){if(!vl(a.context._currentValue,a.memoizedValue))return!0;a=a.next}return!1}function sc(a){lm=a,wc=null,a=a.dependencies,a!==null&&(a.firstContext=null)}function as(a){return $g&&console.error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo()."),p0(lm,a)}function lh(a,h){return lm===null&&sc(a),p0(a,h)}function p0(a,h){var v=h._currentValue;if(h={context:h,memoizedValue:v,next:null},wc===null){if(a===null)throw Error("Context can only be read while React is rendering. In classes, you can read it in the render method or getDerivedStateFromProps. In function components, you can read it directly in the function body, but not inside Hooks like useReducer() or useMemo().");wc=h,a.dependencies={lanes:0,firstContext:h,_debugThenableState:null},a.flags|=524288}else wc=wc.next=h;return v}function Cp(){return{controller:new dD,data:new Map,refCount:0}}function ch(a){a.controller.signal.aborted&&console.warn("A cache instance was retained after it was already freed. This likely indicates a bug in React."),a.refCount++}function Ml(a){a.refCount--,0>a.refCount&&console.warn("A cache instance was released after it was already freed. This likely indicates a bug in React."),a.refCount===0&&fD(pD,function(){a.controller.abort()})}function uh(){var a=Fh;return Fh=0,a}function F_(a){var h=Fh;return Fh=a,h}function Dp(a){var h=Fh;return Fh+=a,h}function V_(a){Yo=qy(),0>a.actualStartTime&&(a.actualStartTime=Yo)}function hh(a){if(0<=Yo){var h=qy()-Yo;a.actualDuration+=h,a.selfBaseDuration=h,Yo=-1}}function U_(a){if(0<=Yo){var h=qy()-Yo;a.actualDuration+=h,Yo=-1}}function Jc(){if(0<=Yo){var a=qy()-Yo;Yo=-1,Fh+=a}}function Pl(){Yo=qy()}function Rp(a){for(var h=a.child;h;)a.actualDuration+=h.actualDuration,h=h.sibling}function m0(a,h){if(cm===null){var v=cm=[];k1=0,um=W(),xl={status:"pending",value:void 0,then:function(S){v.push(S)}}}return k1++,h.then(Go,Go),h}function Go(){if(--k1===0&&cm!==null){xl!==null&&(xl.status="fulfilled");var a=cm;cm=null,um=0,xl=null;for(var h=0;h<a.length;h++)(0,a[h])()}}function eg(a,h){var v=[],S={status:"pending",value:null,reason:null,then:function(I){v.push(I)}};return a.then(function(){S.status="fulfilled",S.value=h;for(var I=0;I<v.length;I++)(0,v[I])(h)},function(I){for(S.status="rejected",S.reason=I,I=0;I<v.length;I++)(0,v[I])(void 0)}),S}function tg(){var a=Bu.current;return a!==null?a:ws.pooledCache}function Op(a,h){h===null?$e(Bu,Bu.current,a):$e(Bu,h.pool,a)}function pf(){var a=tg();return a===null?null:{parent:da._currentValue,pool:a}}function mf(){return{didWarnAboutUncachedPromise:!1,thenables:[]}}function j_(a){return a=a.status,a==="fulfilled"||a==="rejected"}function gf(){}function hl(a,h,v){Jt.actQueue!==null&&(Jt.didUsePromise=!0);var S=a.thenables;switch(v=S[v],v===void 0?S.push(h):v!==h&&(a.didWarnAboutUncachedPromise||(a.didWarnAboutUncachedPromise=!0,console.error("A component was suspended by an uncached promise. Creating promises inside a Client Component or hook is not yet supported, except via a Suspense-compatible library or framework.")),h.then(gf,gf),h=v),h.status){case"fulfilled":return h.value;case"rejected":throw a=h.reason,sn(a),a;default:if(typeof h.status=="string")h.then(gf,gf);else{if(a=ws,a!==null&&100<a.shellSuspendCounter)throw Error("An unknown Component is an async Client Component. Only Server Components can be async at the moment. This error is often caused by accidentally adding `'use client'` to a module that was originally written for the server.");a=h,a.status="pending",a.then(function(I){if(h.status==="pending"){var k=h;k.status="fulfilled",k.value=I}},function(I){if(h.status==="pending"){var k=h;k.status="rejected",k.reason=I}})}switch(h.status){case"fulfilled":return h.value;case"rejected":throw a=h.reason,sn(a),a}throw Ky=h,qg=!0,Bd}}function ng(){if(Ky===null)throw Error("Expected a suspended thenable. This is a bug in React. Please file an issue.");var a=Ky;return Ky=null,qg=!1,a}function sn(a){if(a===Bd||a===Qy)throw Error("Hooks are not supported inside an async component. This error is often caused by accidentally adding `'use client'` to a module that was originally written for the server.")}function ig(a){a.updateQueue={baseState:a.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,lanes:0,hiddenCallbacks:null},callbacks:null}}function ed(a,h){a=a.updateQueue,h.updateQueue===a&&(h.updateQueue={baseState:a.baseState,firstBaseUpdate:a.firstBaseUpdate,lastBaseUpdate:a.lastBaseUpdate,shared:a.shared,callbacks:null})}function kl(a){return{lane:a,tag:gE,payload:null,callback:null,next:null}}function oc(a,h,v){var S=a.updateQueue;if(S===null)return null;if(S=S.shared,B1===S&&!ep){var I=Te(a);console.error(`An update (setState, replaceState, or forceUpdate) was scheduled from inside an update function. Update functions should be pure, with zero side-effects. Consider using componentDidUpdate or a callback.

Please update the following component: %s`,I),ep=!0}return(ns&Pa)!==Sc?(I=S.pending,I===null?h.next=h:(h.next=I.next,I.next=h),S.pending=h,h=Qc(a),Jh(a,null,v),h):(Fs(a,S,h,v),Qc(a))}function dh(a,h,v){if(h=h.updateQueue,h!==null&&(h=h.shared,(v&4194048)!==0)){var S=h.lanes;S&=a.pendingLanes,v|=S,h.lanes=v,Kr(a,v)}}function Nl(a,h){var v=a.updateQueue,S=a.alternate;if(S!==null&&(S=S.updateQueue,v===S)){var I=null,k=null;if(v=v.firstBaseUpdate,v!==null){do{var K={lane:v.lane,tag:v.tag,payload:v.payload,callback:null,next:null};k===null?I=k=K:k=k.next=K,v=v.next}while(v!==null);k===null?I=k=h:k=k.next=h}else I=k=h;v={baseState:S.baseState,firstBaseUpdate:I,lastBaseUpdate:k,shared:S.shared,callbacks:S.callbacks},a.updateQueue=v;return}a=v.lastBaseUpdate,a===null?v.firstBaseUpdate=h:a.next=h,v.lastBaseUpdate=h}function td(){if(Tb){var a=xl;if(a!==null)throw a}}function Ta(a,h,v,S){Tb=!1;var I=a.updateQueue;Fu=!1,B1=I.shared;var k=I.firstBaseUpdate,K=I.lastBaseUpdate,ee=I.shared.pending;if(ee!==null){I.shared.pending=null;var me=ee,De=me.next;me.next=null,K===null?k=De:K.next=De,K=me;var it=a.alternate;it!==null&&(it=it.updateQueue,ee=it.lastBaseUpdate,ee!==K&&(ee===null?it.firstBaseUpdate=De:ee.next=De,it.lastBaseUpdate=me))}if(k!==null){var yt=I.baseState;K=0,it=De=me=null,ee=k;do{var ct=ee.lane&-536870913,ut=ct!==ee.lane;if(ut?(ur&ct)===ct:(S&ct)===ct){ct!==0&&ct===um&&(Tb=!0),it!==null&&(it=it.next={lane:0,tag:ee.tag,payload:ee.payload,callback:null,next:null});e:{ct=a;var Ct=ee,mn=h,tn=v;switch(Ct.tag){case z1:if(Ct=Ct.payload,typeof Ct=="function"){$g=!0;var Qt=Ct.call(tn,yt,mn);if(ct.mode&tl){Ht(!0);try{Ct.call(tn,yt,mn)}finally{Ht(!1)}}$g=!1,yt=Qt;break e}yt=Ct;break e;case _E:ct.flags=ct.flags&-65537|128;case gE:if(Qt=Ct.payload,typeof Qt=="function"){if($g=!0,Ct=Qt.call(tn,yt,mn),ct.mode&tl){Ht(!0);try{Qt.call(tn,yt,mn)}finally{Ht(!1)}}$g=!1}else Ct=Qt;if(Ct==null)break e;yt=br({},yt,Ct);break e;case _D:Fu=!0}}ct=ee.callback,ct!==null&&(a.flags|=64,ut&&(a.flags|=8192),ut=I.callbacks,ut===null?I.callbacks=[ct]:ut.push(ct))}else ut={lane:ct,tag:ee.tag,payload:ee.payload,callback:ee.callback,next:null},it===null?(De=it=ut,me=yt):it=it.next=ut,K|=ct;if(ee=ee.next,ee===null){if(ee=I.shared.pending,ee===null)break;ut=ee,ee=ut.next,ut.next=null,I.lastBaseUpdate=ut,I.shared.pending=null}}while(!0);it===null&&(me=yt),I.baseState=me,I.firstBaseUpdate=De,I.lastBaseUpdate=it,k===null&&(I.shared.lanes=0),bm|=K,a.lanes=K,a.memoizedState=yt}B1=null}function yi(a,h){if(typeof a!="function")throw Error("Invalid argument passed as callback. Expected a function. Instead received: "+a);a.call(h)}function Ip(a,h){var v=a.shared.hiddenCallbacks;if(v!==null)for(a.shared.hiddenCallbacks=null,a=0;a<v.length;a++)yi(v[a],h)}function Bx(a,h){var v=a.callbacks;if(v!==null)for(a.callbacks=null,a=0;a<v.length;a++)yi(v[a],h)}function Fx(a,h){var v=_u;$e(Jy,v,a),$e(tp,h,a),_u=v|h.baseLanes}function Mp(a){$e(Jy,_u,a),$e(tp,tp.current,a)}function g0(a){_u=Jy.current,Ee(tp,a),Ee(Jy,a)}function ri(){var a=en;mu===null?mu=[a]:mu.push(a)}function zn(){var a=en;if(mu!==null&&(np++,mu[np]!==a)){var h=Te(Qi);if(!yE.has(h)&&(yE.add(h),mu!==null)){for(var v="",S=0;S<=np;S++){var I=mu[S],k=S===np?a:I;for(I=S+1+". "+I;30>I.length;)I+=" ";I+=k+`
`,v+=I}console.error(`React has detected a change in the order of Hooks called by %s. This will lead to bugs and errors if not fixed. For more information, read the Rules of Hooks: https://react.dev/link/rules-of-hooks

   Previous render            Next render
   ------------------------------------------------------
%s   ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
`,h,v)}}}function nd(a){a==null||Ka(a)||console.error("%s received a final argument that is not an array (instead, received `%s`). When specified, the final argument must be an array.",en,typeof a)}function H_(){var a=Te(Qi);yD.has(a)||(yD.add(a),console.error("ReactDOM.useFormState has been renamed to React.useActionState. Please update %s to use React.useActionState.",a))}function po(){throw Error(`Invalid hook call. Hooks can only be called inside of the body of a function component. This could happen for one of the following reasons:
1. You might have mismatching versions of React and the renderer (such as React DOM)
2. You might be breaking the Rules of Hooks
3. You might have more than one copy of React in the same app
See https://react.dev/link/invalid-hook-call for tips about how to debug and fix this problem.`)}function _0(a,h){if(nv)return!1;if(h===null)return console.error("%s received a final argument during this render, but not during the previous render. Even though the final argument is optional, its type cannot change between renders.",en),!1;a.length!==h.length&&console.error(`The final argument passed to %s changed size between renders. The order and size of this array must remain constant.

Previous: %s
Incoming: %s`,en,"["+h.join(", ")+"]","["+a.join(", ")+"]");for(var v=0;v<h.length&&v<a.length;v++)if(!vl(a[v],h[v]))return!1;return!0}function y0(a,h,v,S,I,k){jl=k,Qi=h,mu=a!==null?a._debugHookTypes:null,np=-1,nv=a!==null&&a.type!==h.type,(Object.prototype.toString.call(v)==="[object AsyncFunction]"||Object.prototype.toString.call(v)==="[object AsyncGeneratorFunction]")&&(k=Te(Qi),F1.has(k)||(F1.add(k),console.error("%s is an async Client Component. Only Server Components can be async at the moment. This error is often caused by accidentally adding `'use client'` to a module that was originally written for the server.",k===null?"An unknown Component":"<"+k+">"))),h.memoizedState=null,h.updateQueue=null,h.lanes=0,Jt.H=a!==null&&a.memoizedState!==null?$1:mu!==null?vD:H1,Vd=k=(h.mode&tl)!==Hs;var K=iv(v,S,I);if(Vd=!1,Fd&&(K=b0(h,v,S,I)),k){Ht(!0);try{K=b0(h,v,S,I)}finally{Ht(!1)}}return v0(a,h),K}function v0(a,h){h._debugHookTypes=mu,h.dependencies===null?Tc!==null&&(h.dependencies={lanes:0,firstContext:null,_debugThenableState:Tc}):h.dependencies._debugThenableState=Tc,Jt.H=j1;var v=hs!==null&&hs.next!==null;if(jl=0,mu=en=ao=hs=Qi=null,np=-1,a!==null&&(a.flags&65011712)!==(h.flags&65011712)&&console.error("Internal React error: Expected static flag was missing. Please notify the React team."),pm=!1,Eb=0,Tc=null,v)throw Error("Rendered fewer hooks than expected. This may be caused by an accidental early return statement.");a===null||Ma||(a=a.dependencies,a!==null&&Kc(a)&&(Ma=!0)),qg?(qg=!1,a=!0):a=!1,a&&(h=Te(h)||"Unknown",tv.has(h)||F1.has(h)||(tv.add(h),console.error("`use` was called from inside a try/catch block. This is not allowed and can lead to unexpected behavior. To handle errors triggered by `use`, wrap your component in a error boundary.")))}function b0(a,h,v,S){Qi=a;var I=0;do{if(Fd&&(Tc=null),Eb=0,Fd=!1,I>=FM)throw Error("Too many re-renders. React limits the number of renders to prevent an infinite loop.");if(I+=1,nv=!1,ao=hs=null,a.updateQueue!=null){var k=a.updateQueue;k.lastEffect=null,k.events=null,k.stores=null,k.memoCache!=null&&(k.memoCache.index=0)}np=-1,Jt.H=bD,k=iv(h,v,S)}while(Fd);return k}function $_(){var a=Jt.H,h=a.useState()[0];return h=typeof h.then=="function"?Eu(h):h,a=a.useState()[0],(hs!==null?hs.memoizedState:null)!==a&&(Qi.flags|=1024),h}function x0(){var a=V1!==0;return V1=0,a}function G_(a,h,v){h.updateQueue=a.updateQueue,h.flags=(h.mode&vc)!==Hs?h.flags&-402655237:h.flags&-2053,a.lanes&=~v}function rg(a){if(pm){for(a=a.memoizedState;a!==null;){var h=a.queue;h!==null&&(h.pending=null),a=a.next}pm=!1}jl=0,mu=ao=hs=Qi=null,np=-1,en=null,Fd=!1,Eb=V1=0,Tc=null}function aa(){var a={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return ao===null?Qi.memoizedState=ao=a:ao=ao.next=a,ao}function es(){if(hs===null){var a=Qi.alternate;a=a!==null?a.memoizedState:null}else a=hs.next;var h=ao===null?Qi.memoizedState:ao.next;if(h!==null)ao=h,hs=a;else{if(a===null)throw Qi.alternate===null?Error("Update hook called on initial render. This is likely a bug in React. Please file an issue."):Error("Rendered more hooks than during the previous render.");hs=a,a={memoizedState:hs.memoizedState,baseState:hs.baseState,baseQueue:hs.baseQueue,queue:hs.queue,next:null},ao===null?Qi.memoizedState=ao=a:ao=ao.next=a}return ao}function fh(){return{lastEffect:null,events:null,stores:null,memoCache:null}}function Eu(a){var h=Eb;return Eb+=1,Tc===null&&(Tc=mf()),a=hl(Tc,a,h),h=Qi,(ao===null?h.memoizedState:ao.next)===null&&(h=h.alternate,Jt.H=h!==null&&h.memoizedState!==null?$1:H1),a}function eu(a){if(a!==null&&typeof a=="object"){if(typeof a.then=="function")return Eu(a);if(a.$$typeof===Ph)return as(a)}throw Error("An unsupported type was passed to use(): "+String(a))}function Su(a){var h=null,v=Qi.updateQueue;if(v!==null&&(h=v.memoCache),h==null){var S=Qi.alternate;S!==null&&(S=S.updateQueue,S!==null&&(S=S.memoCache,S!=null&&(h={data:S.data.map(function(I){return I.slice()}),index:0})))}if(h==null&&(h={data:[],index:0}),v===null&&(v=fh(),Qi.updateQueue=v),v.memoCache=h,v=h.data[h.index],v===void 0||nv)for(v=h.data[h.index]=Array(a),S=0;S<a;S++)v[S]=xM;else v.length!==a&&console.error("Expected a constant size argument for each invocation of useMemoCache. The previous cache was allocated with size %s but size %s was requested.",v.length,a);return h.index++,v}function Ea(a,h){return typeof h=="function"?h(a):h}function q_(a,h,v){var S=aa();if(v!==void 0){var I=v(h);if(Vd){Ht(!0);try{v(h)}finally{Ht(!1)}}}else I=h;return S.memoizedState=S.baseState=I,a={pending:null,lanes:0,dispatch:null,lastRenderedReducer:a,lastRenderedState:I},S.queue=a,a=a.dispatch=pg.bind(null,Qi,a),[S.memoizedState,a]}function id(a){var h=es();return W_(h,hs,a)}function W_(a,h,v){var S=a.queue;if(S===null)throw Error("Should have a queue. You are likely calling Hooks conditionally, which is not allowed. (https://react.dev/link/invalid-hook-call)");S.lastRenderedReducer=v;var I=a.baseQueue,k=S.pending;if(k!==null){if(I!==null){var K=I.next;I.next=k.next,k.next=K}h.baseQueue!==I&&console.error("Internal error: Expected work-in-progress queue to be a clone. This is a bug in React."),h.baseQueue=I=k,S.pending=null}if(k=a.baseState,I===null)a.memoizedState=k;else{h=I.next;var ee=K=null,me=null,De=h,it=!1;do{var yt=De.lane&-536870913;if(yt!==De.lane?(ur&yt)===yt:(jl&yt)===yt){var ct=De.revertLane;if(ct===0)me!==null&&(me=me.next={lane:0,revertLane:0,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null}),yt===um&&(it=!0);else if((jl&ct)===ct){De=De.next,ct===um&&(it=!0);continue}else yt={lane:0,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},me===null?(ee=me=yt,K=k):me=me.next=yt,Qi.lanes|=ct,bm|=ct;yt=De.action,Vd&&v(k,yt),k=De.hasEagerState?De.eagerState:v(k,yt)}else ct={lane:yt,revertLane:De.revertLane,action:De.action,hasEagerState:De.hasEagerState,eagerState:De.eagerState,next:null},me===null?(ee=me=ct,K=k):me=me.next=ct,Qi.lanes|=yt,bm|=yt;De=De.next}while(De!==null&&De!==h);if(me===null?K=k:me.next=ee,!vl(k,a.memoizedState)&&(Ma=!0,it&&(v=xl,v!==null)))throw v;a.memoizedState=k,a.baseState=K,a.baseQueue=me,S.lastRenderedState=k}return I===null&&(S.lanes=0),[a.memoizedState,S.dispatch]}function Au(a){var h=es(),v=h.queue;if(v===null)throw Error("Should have a queue. You are likely calling Hooks conditionally, which is not allowed. (https://react.dev/link/invalid-hook-call)");v.lastRenderedReducer=a;var S=v.dispatch,I=v.pending,k=h.memoizedState;if(I!==null){v.pending=null;var K=I=I.next;do k=a(k,K.action),K=K.next;while(K!==I);vl(k,h.memoizedState)||(Ma=!0),h.memoizedState=k,h.baseQueue===null&&(h.baseState=k),v.lastRenderedState=k}return[k,S]}function Pp(a,h,v){var S=Qi,I=aa();if(qr){if(v===void 0)throw Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");var k=v();ev||k===v()||(console.error("The result of getServerSnapshot should be cached to avoid an infinite loop"),ev=!0)}else{if(k=h(),ev||(v=h(),vl(k,v)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),ev=!0)),ws===null)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");(ur&124)!==0||Y_(S,h,k)}return I.memoizedState=k,v={value:k,getSnapshot:h},I.queue=v,rd(kp.bind(null,S,v,a),[a]),S.flags|=2048,Ru(pu|fa,vf(),sg.bind(null,S,v,k,h),null),k}function _f(a,h,v){var S=Qi,I=es(),k=qr;if(k){if(v===void 0)throw Error("Missing getServerSnapshot, which is required for server-rendered content. Will revert to client rendering.");v=v()}else if(v=h(),!ev){var K=h();vl(v,K)||(console.error("The result of getSnapshot should be cached to avoid an infinite loop"),ev=!0)}(K=!vl((hs||I).memoizedState,v))&&(I.memoizedState=v,Ma=!0),I=I.queue;var ee=kp.bind(null,S,I,a);if(la(2048,fa,ee,[a]),I.getSnapshot!==h||K||ao!==null&&ao.memoizedState.tag&pu){if(S.flags|=2048,Ru(pu|fa,vf(),sg.bind(null,S,I,v,h),null),ws===null)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");k||(jl&124)!==0||Y_(S,h,v)}return v}function Y_(a,h,v){a.flags|=16384,a={getSnapshot:h,value:v},h=Qi.updateQueue,h===null?(h=fh(),Qi.updateQueue=h,h.stores=[a]):(v=h.stores,v===null?h.stores=[a]:v.push(a))}function sg(a,h,v,S){h.value=v,h.getSnapshot=S,w0(h)&&T0(a)}function kp(a,h,v){return v(function(){w0(h)&&T0(a)})}function w0(a){var h=a.getSnapshot;a=a.value;try{var v=h();return!vl(a,v)}catch{return!0}}function T0(a){var h=fi(a,2);h!==null&&oo(h,a,2)}function Z_(a){var h=aa();if(typeof a=="function"){var v=a;if(a=v(),Vd){Ht(!0);try{v()}finally{Ht(!1)}}}return h.memoizedState=h.baseState=a,h.queue={pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:a},h}function Cu(a){a=Z_(a);var h=a.queue,v=ay.bind(null,Qi,h);return h.dispatch=v,[a.memoizedState,v]}function X_(a){var h=aa();h.memoizedState=h.baseState=a;var v={pending:null,lanes:0,dispatch:null,lastRenderedReducer:null,lastRenderedState:null};return h.queue=v,h=wf.bind(null,Qi,!0,v),v.dispatch=h,[a,h]}function E0(a,h){var v=es();return Vx(v,hs,a,h)}function Vx(a,h,v,S){return a.baseState=v,W_(a,hs,typeof S=="function"?S:Ea)}function Ux(a,h){var v=es();return hs!==null?Vx(v,hs,a,h):(v.baseState=a,[a,v.queue.dispatch])}function S0(a,h,v,S,I){if(ad(a))throw Error("Cannot update form state while rendering.");if(a=h.action,a!==null){var k={payload:I,action:a,next:null,isTransition:!0,status:"pending",value:null,reason:null,listeners:[],then:function(K){k.listeners.push(K)}};Jt.T!==null?v(!0):k.isTransition=!1,S(k),v=h.pending,v===null?(k.next=h.pending=k,og(h,k)):(k.next=v.next,h.pending=v.next=k)}}function og(a,h){var v=h.action,S=h.payload,I=a.state;if(h.isTransition){var k=Jt.T,K={};Jt.T=K,Jt.T._updatedFibers=new Set;try{var ee=v(I,S),me=Jt.S;me!==null&&me(K,ee),ag(a,h,ee)}catch(De){lg(a,h,De)}finally{Jt.T=k,k===null&&K._updatedFibers&&(a=K._updatedFibers.size,K._updatedFibers.clear(),10<a&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."))}}else try{K=v(I,S),ag(a,h,K)}catch(De){lg(a,h,De)}}function ag(a,h,v){v!==null&&typeof v=="object"&&typeof v.then=="function"?(v.then(function(S){ph(a,h,S)},function(S){return lg(a,h,S)}),h.isTransition||console.error("An async function with useActionState was called outside of a transition. This is likely not what you intended (for example, isPending will not update correctly). Either call the returned function inside startTransition, or pass it to an `action` or `formAction` prop.")):ph(a,h,v)}function ph(a,h,v){h.status="fulfilled",h.value=v,Q_(h),a.state=v,h=a.pending,h!==null&&(v=h.next,v===h?a.pending=null:(v=v.next,h.next=v,og(a,v)))}function lg(a,h,v){var S=a.pending;if(a.pending=null,S!==null){S=S.next;do h.status="rejected",h.reason=v,Q_(h),h=h.next;while(h!==S)}a.action=null}function Q_(a){a=a.listeners;for(var h=0;h<a.length;h++)(0,a[h])()}function jx(a,h){return h}function ac(a,h){if(qr){var v=ws.formState;if(v!==null){e:{var S=Qi;if(qr){if(So){t:{for(var I=So,k=Bh;I.nodeType!==8;){if(!k){I=null;break t}if(I=js(I.nextSibling),I===null){I=null;break t}}k=I.data,I=k===Cc||k===UD?I:null}if(I){So=js(I.nextSibling),S=I.data===Cc;break e}}rc(S)}S=!1}S&&(h=v[0])}}return v=aa(),v.memoizedState=v.baseState=h,S={pending:null,lanes:0,dispatch:null,lastRenderedReducer:jx,lastRenderedState:h},v.queue=S,v=ay.bind(null,Qi,S),S.dispatch=v,S=Z_(!1),k=wf.bind(null,Qi,!1,S.queue),S=aa(),I={state:h,dispatch:null,action:a,pending:null},S.queue=I,v=S0.bind(null,Qi,I,k,v),I.dispatch=v,S.memoizedState=a,[h,v,!1]}function Du(a){var h=es();return A0(h,hs,a)}function A0(a,h,v){if(h=W_(a,h,jx)[0],a=id(Ea)[0],typeof h=="object"&&h!==null&&typeof h.then=="function")try{var S=Eu(h)}catch(K){throw K===Bd?Qy:K}else S=h;h=es();var I=h.queue,k=I.dispatch;return v!==h.memoizedState&&(Qi.flags|=2048,Ru(pu|fa,vf(),Ll.bind(null,I,v),null)),[S,k,a]}function Ll(a,h){a.action=h}function yf(a){var h=es(),v=hs;if(v!==null)return A0(h,v,a);es(),h=h.memoizedState,v=es();var S=v.queue.dispatch;return v.memoizedState=a,[h,S,!1]}function Ru(a,h,v,S){return a={tag:a,create:v,deps:S,inst:h,next:null},h=Qi.updateQueue,h===null&&(h=fh(),Qi.updateQueue=h),v=h.lastEffect,v===null?h.lastEffect=a.next=a:(S=v.next,v.next=a,a.next=S,h.lastEffect=a),a}function vf(){return{destroy:void 0,resource:void 0}}function cg(a){var h=aa();return a={current:a},h.memoizedState=a}function mh(a,h,v,S){var I=aa();S=S===void 0?null:S,Qi.flags|=a,I.memoizedState=Ru(pu|h,vf(),v,S)}function la(a,h,v,S){var I=es();S=S===void 0?null:S;var k=I.memoizedState.inst;hs!==null&&S!==null&&_0(S,hs.memoizedState.deps)?I.memoizedState=Ru(h,k,v,S):(Qi.flags|=a,I.memoizedState=Ru(pu|h,k,v,S))}function rd(a,h){(Qi.mode&vc)!==Hs&&(Qi.mode&I1)===Hs?mh(276826112,fa,a,h):mh(8390656,fa,a,h)}function sd(a,h){var v=4194308;return(Qi.mode&vc)!==Hs&&(v|=134217728),mh(v,Ia,a,h)}function K_(a,h){if(typeof h=="function"){a=a();var v=h(a);return function(){typeof v=="function"?v():h(null)}}if(h!=null)return h.hasOwnProperty("current")||console.error("Expected useImperativeHandle() first argument to either be a ref callback or React.createRef() object. Instead received: %s.","an object with keys {"+Object.keys(h).join(", ")+"}"),a=a(),h.current=a,function(){h.current=null}}function bf(a,h,v){typeof h!="function"&&console.error("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",h!==null?typeof h:"null"),v=v!=null?v.concat([a]):null;var S=4194308;(Qi.mode&vc)!==Hs&&(S|=134217728),mh(S,Ia,K_.bind(null,h,a),v)}function ug(a,h,v){typeof h!="function"&&console.error("Expected useImperativeHandle() second argument to be a function that creates a handle. Instead received: %s.",h!==null?typeof h:"null"),v=v!=null?v.concat([a]):null,la(4,Ia,K_.bind(null,h,a),v)}function J_(a,h){return aa().memoizedState=[a,h===void 0?null:h],a}function Ou(a,h){var v=es();h=h===void 0?null:h;var S=v.memoizedState;return h!==null&&_0(h,S[1])?S[0]:(v.memoizedState=[a,h],a)}function ey(a,h){var v=aa();h=h===void 0?null:h;var S=a();if(Vd){Ht(!0);try{a()}finally{Ht(!1)}}return v.memoizedState=[S,h],S}function ty(a,h){var v=es();h=h===void 0?null:h;var S=v.memoizedState;if(h!==null&&_0(h,S[1]))return S[0];if(S=a(),Vd){Ht(!0);try{a()}finally{Ht(!1)}}return v.memoizedState=[S,h],S}function C0(a,h){var v=aa();return D0(v,a,h)}function Hx(a,h){var v=es();return dg(v,hs.memoizedState,a,h)}function hg(a,h){var v=es();return hs===null?D0(v,a,h):dg(v,hs.memoizedState,a,h)}function D0(a,h,v){return v===void 0||(jl&1073741824)!==0?a.memoizedState=h:(a.memoizedState=v,a=$0(),Qi.lanes|=a,bm|=a,v)}function dg(a,h,v,S){return vl(v,h)?v:tp.current!==null?(a=D0(a,v,S),vl(a,h)||(Ma=!0),a):(jl&42)===0?(Ma=!0,a.memoizedState=v):(a=$0(),Qi.lanes|=a,bm|=a,h)}function ny(a,h,v,S,I){var k=us.p;us.p=k!==0&&k<kh?k:kh;var K=Jt.T,ee={};Jt.T=ee,wf(a,!1,h,v),ee._updatedFibers=new Set;try{var me=I(),De=Jt.S;if(De!==null&&De(ee,me),me!==null&&typeof me=="object"&&typeof me.then=="function"){var it=eg(me,S);xf(a,h,it,Aa(a))}else xf(a,h,S,Aa(a))}catch(yt){xf(a,h,{then:function(){},status:"rejected",reason:yt},Aa(a))}finally{us.p=k,Jt.T=K,K===null&&ee._updatedFibers&&(a=ee._updatedFibers.size,ee._updatedFibers.clear(),10<a&&console.warn("Detected a large number of updates inside startTransition. If this is due to a subscription please re-write it to use React provided hooks. Otherwise concurrent mode guarantees are off the table."))}}function iy(a,h,v,S){if(a.tag!==5)throw Error("Expected the form instance to be a HostComponent. This is a bug in React.");var I=od(a).queue;ny(a,I,h,Em,v===null?P:function(){return ry(a),v(S)})}function od(a){var h=a.memoizedState;if(h!==null)return h;h={memoizedState:Em,baseState:Em,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:Em},next:null};var v={};return h.next={memoizedState:v,baseState:v,baseQueue:null,queue:{pending:null,lanes:0,dispatch:null,lastRenderedReducer:Ea,lastRenderedState:v},next:null},a.memoizedState=h,a=a.alternate,a!==null&&(a.memoizedState=h),h}function ry(a){Jt.T===null&&console.error("requestFormReset was called outside a transition or action. To fix, move to an action, or wrap with startTransition.");var h=od(a).next.queue;xf(a,h,{},Aa(a))}function fg(){var a=Z_(!1);return a=ny.bind(null,Qi,a.queue,!0,!1),aa().memoizedState=a,[!1,a]}function R0(){var a=id(Ea)[0],h=es().memoizedState;return[typeof a=="boolean"?a:Eu(a),h]}function gh(){var a=Au(Ea)[0],h=es().memoizedState;return[typeof a=="boolean"?a:Eu(a),h]}function zl(){return as(u)}function sy(){var a=aa(),h=ws.identifierPrefix;if(qr){var v=Ld,S=Jf;v=(S&~(1<<32-Ja(S)-1)).toString(32)+v,h="«"+h+"R"+v,v=V1++,0<v&&(h+="H"+v.toString(32)),h+="»"}else v=U1++,h="«"+h+"r"+v.toString(32)+"»";return a.memoizedState=h}function Iu(){return aa().memoizedState=oy.bind(null,Qi)}function oy(a,h){for(var v=a.return;v!==null;){switch(v.tag){case 24:case 3:var S=Aa(v);a=kl(S);var I=oc(v,a,S);I!==null&&(oo(I,v,S),dh(I,v,S)),v=Cp(),h!=null&&I!==null&&console.error("The seed argument is not enabled outside experimental channels."),a.payload={cache:v};return}v=v.return}}function pg(a,h,v){var S=arguments;typeof S[3]=="function"&&console.error("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect()."),S=Aa(a);var I={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};ad(a)?O0(h,I):(I=ul(a,h,I,S),I!==null&&(oo(I,a,S),I0(I,h,S))),ni(a,S)}function ay(a,h,v){var S=arguments;typeof S[3]=="function"&&console.error("State updates from the useState() and useReducer() Hooks don't support the second callback argument. To execute a side effect after rendering, declare it in the component body with useEffect()."),S=Aa(a),xf(a,h,v,S),ni(a,S)}function xf(a,h,v,S){var I={lane:S,revertLane:0,action:v,hasEagerState:!1,eagerState:null,next:null};if(ad(a))O0(h,I);else{var k=a.alternate;if(a.lanes===0&&(k===null||k.lanes===0)&&(k=h.lastRenderedReducer,k!==null)){var K=Jt.H;Jt.H=Ec;try{var ee=h.lastRenderedState,me=k(ee,v);if(I.hasEagerState=!0,I.eagerState=me,vl(me,ee))return Fs(a,h,I,0),ws===null&&Di(),!1}catch{}finally{Jt.H=K}}if(v=ul(a,h,I,S),v!==null)return oo(v,a,S),I0(v,h,S),!0}return!1}function wf(a,h,v,S){if(Jt.T===null&&um===0&&console.error("An optimistic state update occurred outside a transition or action. To fix, move the update to an action, or wrap with startTransition."),S={lane:2,revertLane:W(),action:S,hasEagerState:!1,eagerState:null,next:null},ad(a)){if(h)throw Error("Cannot update optimistic state while rendering.");console.error("Cannot call startTransition while rendering.")}else h=ul(a,v,S,2),h!==null&&oo(h,a,2);ni(a,2)}function ad(a){var h=a.alternate;return a===Qi||h!==null&&h===Qi}function O0(a,h){Fd=pm=!0;var v=a.pending;v===null?h.next=h:(h.next=v.next,v.next=h),a.pending=h}function I0(a,h,v){if((v&4194048)!==0){var S=h.lanes;S&=a.pendingLanes,v|=S,h.lanes=v,Kr(a,v)}}function vs(a){var h=rr;return a!=null&&(rr=h===null?a:h.concat(a)),h}function ly(a,h,v){for(var S=Object.keys(a.props),I=0;I<S.length;I++){var k=S[I];if(k!=="children"&&k!=="key"){h===null&&(h=$t(a,v.mode,0),h._debugInfo=rr,h.return=v),Ze(h,function(K){console.error("Invalid prop `%s` supplied to `React.Fragment`. React.Fragment can only have `key` and `children` props.",K)},k);break}}}function cy(a){var h=Yg;return Yg+=1,mm===null&&(mm=mf()),hl(mm,a,h)}function Tf(a,h){h=h.props.ref,a.ref=h!==void 0?h:null}function uy(a,h){throw h.$$typeof===pC?Error(`A React Element from an older version of React was rendered. This is not supported. It can happen if:
- Multiple copies of the "react" package is used.
- A library pre-bundled an old copy of "react" or "react/jsx-runtime".
- A compiler tries to "inline" JSX instead of using the runtime.`):(a=Object.prototype.toString.call(h),Error("Objects are not valid as a React child (found: "+(a==="[object Object]"?"object with keys {"+Object.keys(h).join(", ")+"}":a)+"). If you meant to render a collection of children, use an array instead."))}function _h(a,h){var v=Te(a)||"Component";Ib[v]||(Ib[v]=!0,h=h.displayName||h.name||"Component",a.tag===3?console.error(`Functions are not valid as a React child. This may happen if you return %s instead of <%s /> from render. Or maybe you meant to call this function rather than return it.
  root.render(%s)`,h,h,h):console.error(`Functions are not valid as a React child. This may happen if you return %s instead of <%s /> from render. Or maybe you meant to call this function rather than return it.
  <%s>{%s}</%s>`,h,h,v,h,v))}function Ef(a,h){var v=Te(a)||"Component";AE[v]||(AE[v]=!0,h=String(h),a.tag===3?console.error(`Symbols are not valid as a React child.
  root.render(%s)`,h):console.error(`Symbols are not valid as a React child.
  <%s>%s</%s>`,v,h,v))}function Mu(a){function h(Je,rt){if(a){var lt=Je.deletions;lt===null?(Je.deletions=[rt],Je.flags|=16):lt.push(rt)}}function v(Je,rt){if(!a)return null;for(;rt!==null;)h(Je,rt),rt=rt.sibling;return null}function S(Je){for(var rt=new Map;Je!==null;)Je.key!==null?rt.set(Je.key,Je):rt.set(Je.index,Je),Je=Je.sibling;return rt}function I(Je,rt){return Je=xe(Je,rt),Je.index=0,Je.sibling=null,Je}function k(Je,rt,lt){return Je.index=lt,a?(lt=Je.alternate,lt!==null?(lt=lt.index,lt<rt?(Je.flags|=67108866,rt):lt):(Je.flags|=67108866,rt)):(Je.flags|=1048576,rt)}function K(Je){return a&&Je.alternate===null&&(Je.flags|=67108866),Je}function ee(Je,rt,lt,kt){return rt===null||rt.tag!==6?(rt=Hi(lt,Je.mode,kt),rt.return=Je,rt._debugOwner=Je,rt._debugTask=Je._debugTask,rt._debugInfo=rr,rt):(rt=I(rt,lt),rt.return=Je,rt._debugInfo=rr,rt)}function me(Je,rt,lt,kt){var Zt=lt.type;return Zt===Pg?(rt=it(Je,rt,lt.props.children,kt,lt.key),ly(lt,rt,Je),rt):rt!==null&&(rt.elementType===Zt||ys(rt,lt)||typeof Zt=="object"&&Zt!==null&&Zt.$$typeof===_c&&jd(Zt)===rt.type)?(rt=I(rt,lt.props),Tf(rt,lt),rt.return=Je,rt._debugOwner=lt._owner,rt._debugInfo=rr,rt):(rt=$t(lt,Je.mode,kt),Tf(rt,lt),rt.return=Je,rt._debugInfo=rr,rt)}function De(Je,rt,lt,kt){return rt===null||rt.tag!==4||rt.stateNode.containerInfo!==lt.containerInfo||rt.stateNode.implementation!==lt.implementation?(rt=Ss(lt,Je.mode,kt),rt.return=Je,rt._debugInfo=rr,rt):(rt=I(rt,lt.children||[]),rt.return=Je,rt._debugInfo=rr,rt)}function it(Je,rt,lt,kt,Zt){return rt===null||rt.tag!==7?(rt=Ln(lt,Je.mode,kt,Zt),rt.return=Je,rt._debugOwner=Je,rt._debugTask=Je._debugTask,rt._debugInfo=rr,rt):(rt=I(rt,lt),rt.return=Je,rt._debugInfo=rr,rt)}function yt(Je,rt,lt){if(typeof rt=="string"&&rt!==""||typeof rt=="number"||typeof rt=="bigint")return rt=Hi(""+rt,Je.mode,lt),rt.return=Je,rt._debugOwner=Je,rt._debugTask=Je._debugTask,rt._debugInfo=rr,rt;if(typeof rt=="object"&&rt!==null){switch(rt.$$typeof){case Zp:return lt=$t(rt,Je.mode,lt),Tf(lt,rt),lt.return=Je,Je=vs(rt._debugInfo),lt._debugInfo=rr,rr=Je,lt;case Py:return rt=Ss(rt,Je.mode,lt),rt.return=Je,rt._debugInfo=rr,rt;case _c:var kt=vs(rt._debugInfo);return rt=jd(rt),Je=yt(Je,rt,lt),rr=kt,Je}if(Ka(rt)||Xe(rt))return lt=Ln(rt,Je.mode,lt,null),lt.return=Je,lt._debugOwner=Je,lt._debugTask=Je._debugTask,Je=vs(rt._debugInfo),lt._debugInfo=rr,rr=Je,lt;if(typeof rt.then=="function")return kt=vs(rt._debugInfo),Je=yt(Je,cy(rt),lt),rr=kt,Je;if(rt.$$typeof===Ph)return yt(Je,lh(Je,rt),lt);uy(Je,rt)}return typeof rt=="function"&&_h(Je,rt),typeof rt=="symbol"&&Ef(Je,rt),null}function ct(Je,rt,lt,kt){var Zt=rt!==null?rt.key:null;if(typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint")return Zt!==null?null:ee(Je,rt,""+lt,kt);if(typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case Zp:return lt.key===Zt?(Zt=vs(lt._debugInfo),Je=me(Je,rt,lt,kt),rr=Zt,Je):null;case Py:return lt.key===Zt?De(Je,rt,lt,kt):null;case _c:return Zt=vs(lt._debugInfo),lt=jd(lt),Je=ct(Je,rt,lt,kt),rr=Zt,Je}if(Ka(lt)||Xe(lt))return Zt!==null?null:(Zt=vs(lt._debugInfo),Je=it(Je,rt,lt,kt,null),rr=Zt,Je);if(typeof lt.then=="function")return Zt=vs(lt._debugInfo),Je=ct(Je,rt,cy(lt),kt),rr=Zt,Je;if(lt.$$typeof===Ph)return ct(Je,rt,lh(Je,lt),kt);uy(Je,lt)}return typeof lt=="function"&&_h(Je,lt),typeof lt=="symbol"&&Ef(Je,lt),null}function ut(Je,rt,lt,kt,Zt){if(typeof kt=="string"&&kt!==""||typeof kt=="number"||typeof kt=="bigint")return Je=Je.get(lt)||null,ee(rt,Je,""+kt,Zt);if(typeof kt=="object"&&kt!==null){switch(kt.$$typeof){case Zp:return lt=Je.get(kt.key===null?lt:kt.key)||null,Je=vs(kt._debugInfo),rt=me(rt,lt,kt,Zt),rr=Je,rt;case Py:return Je=Je.get(kt.key===null?lt:kt.key)||null,De(rt,Je,kt,Zt);case _c:var On=vs(kt._debugInfo);return kt=jd(kt),rt=ut(Je,rt,lt,kt,Zt),rr=On,rt}if(Ka(kt)||Xe(kt))return lt=Je.get(lt)||null,Je=vs(kt._debugInfo),rt=it(rt,lt,kt,Zt,null),rr=Je,rt;if(typeof kt.then=="function")return On=vs(kt._debugInfo),rt=ut(Je,rt,lt,cy(kt),Zt),rr=On,rt;if(kt.$$typeof===Ph)return ut(Je,rt,lt,lh(rt,kt),Zt);uy(rt,kt)}return typeof kt=="function"&&_h(rt,kt),typeof kt=="symbol"&&Ef(rt,kt),null}function Ct(Je,rt,lt,kt){if(typeof lt!="object"||lt===null)return kt;switch(lt.$$typeof){case Zp:case Py:s(Je,rt,lt);var Zt=lt.key;if(typeof Zt!="string")break;if(kt===null){kt=new Set,kt.add(Zt);break}if(!kt.has(Zt)){kt.add(Zt);break}Ze(rt,function(){console.error("Encountered two children with the same key, `%s`. Keys should be unique so that components maintain their identity across updates. Non-unique keys may cause children to be duplicated and/or omitted — the behavior is unsupported and could change in a future version.",Zt)});break;case _c:lt=jd(lt),Ct(Je,rt,lt,kt)}return kt}function mn(Je,rt,lt,kt){for(var Zt=null,On=null,An=null,Yn=rt,Ce=rt=0,Me=null;Yn!==null&&Ce<lt.length;Ce++){Yn.index>Ce?(Me=Yn,Yn=null):Me=Yn.sibling;var wt=ct(Je,Yn,lt[Ce],kt);if(wt===null){Yn===null&&(Yn=Me);break}Zt=Ct(Je,wt,lt[Ce],Zt),a&&Yn&&wt.alternate===null&&h(Je,Yn),rt=k(wt,rt,Ce),An===null?On=wt:An.sibling=wt,An=wt,Yn=Me}if(Ce===lt.length)return v(Je,Yn),qr&&kn(Je,Ce),On;if(Yn===null){for(;Ce<lt.length;Ce++)Yn=yt(Je,lt[Ce],kt),Yn!==null&&(Zt=Ct(Je,Yn,lt[Ce],Zt),rt=k(Yn,rt,Ce),An===null?On=Yn:An.sibling=Yn,An=Yn);return qr&&kn(Je,Ce),On}for(Yn=S(Yn);Ce<lt.length;Ce++)Me=ut(Yn,Je,Ce,lt[Ce],kt),Me!==null&&(Zt=Ct(Je,Me,lt[Ce],Zt),a&&Me.alternate!==null&&Yn.delete(Me.key===null?Ce:Me.key),rt=k(Me,rt,Ce),An===null?On=Me:An.sibling=Me,An=Me);return a&&Yn.forEach(function(Wt){return h(Je,Wt)}),qr&&kn(Je,Ce),On}function tn(Je,rt,lt,kt){if(lt==null)throw Error("An iterable object provided no iterator.");for(var Zt=null,On=null,An=rt,Yn=rt=0,Ce=null,Me=null,wt=lt.next();An!==null&&!wt.done;Yn++,wt=lt.next()){An.index>Yn?(Ce=An,An=null):Ce=An.sibling;var Wt=ct(Je,An,wt.value,kt);if(Wt===null){An===null&&(An=Ce);break}Me=Ct(Je,Wt,wt.value,Me),a&&An&&Wt.alternate===null&&h(Je,An),rt=k(Wt,rt,Yn),On===null?Zt=Wt:On.sibling=Wt,On=Wt,An=Ce}if(wt.done)return v(Je,An),qr&&kn(Je,Yn),Zt;if(An===null){for(;!wt.done;Yn++,wt=lt.next())An=yt(Je,wt.value,kt),An!==null&&(Me=Ct(Je,An,wt.value,Me),rt=k(An,rt,Yn),On===null?Zt=An:On.sibling=An,On=An);return qr&&kn(Je,Yn),Zt}for(An=S(An);!wt.done;Yn++,wt=lt.next())Ce=ut(An,Je,Yn,wt.value,kt),Ce!==null&&(Me=Ct(Je,Ce,wt.value,Me),a&&Ce.alternate!==null&&An.delete(Ce.key===null?Yn:Ce.key),rt=k(Ce,rt,Yn),On===null?Zt=Ce:On.sibling=Ce,On=Ce);return a&&An.forEach(function(un){return h(Je,un)}),qr&&kn(Je,Yn),Zt}function Qt(Je,rt,lt,kt){if(typeof lt=="object"&&lt!==null&&lt.type===Pg&&lt.key===null&&(ly(lt,null,Je),lt=lt.props.children),typeof lt=="object"&&lt!==null){switch(lt.$$typeof){case Zp:var Zt=vs(lt._debugInfo);e:{for(var On=lt.key;rt!==null;){if(rt.key===On){if(On=lt.type,On===Pg){if(rt.tag===7){v(Je,rt.sibling),kt=I(rt,lt.props.children),kt.return=Je,kt._debugOwner=lt._owner,kt._debugInfo=rr,ly(lt,kt,Je),Je=kt;break e}}else if(rt.elementType===On||ys(rt,lt)||typeof On=="object"&&On!==null&&On.$$typeof===_c&&jd(On)===rt.type){v(Je,rt.sibling),kt=I(rt,lt.props),Tf(kt,lt),kt.return=Je,kt._debugOwner=lt._owner,kt._debugInfo=rr,Je=kt;break e}v(Je,rt);break}else h(Je,rt);rt=rt.sibling}lt.type===Pg?(kt=Ln(lt.props.children,Je.mode,kt,lt.key),kt.return=Je,kt._debugOwner=Je,kt._debugTask=Je._debugTask,kt._debugInfo=rr,ly(lt,kt,Je),Je=kt):(kt=$t(lt,Je.mode,kt),Tf(kt,lt),kt.return=Je,kt._debugInfo=rr,Je=kt)}return Je=K(Je),rr=Zt,Je;case Py:e:{for(Zt=lt,lt=Zt.key;rt!==null;){if(rt.key===lt)if(rt.tag===4&&rt.stateNode.containerInfo===Zt.containerInfo&&rt.stateNode.implementation===Zt.implementation){v(Je,rt.sibling),kt=I(rt,Zt.children||[]),kt.return=Je,Je=kt;break e}else{v(Je,rt);break}else h(Je,rt);rt=rt.sibling}kt=Ss(Zt,Je.mode,kt),kt.return=Je,Je=kt}return K(Je);case _c:return Zt=vs(lt._debugInfo),lt=jd(lt),Je=Qt(Je,rt,lt,kt),rr=Zt,Je}if(Ka(lt))return Zt=vs(lt._debugInfo),Je=mn(Je,rt,lt,kt),rr=Zt,Je;if(Xe(lt)){if(Zt=vs(lt._debugInfo),On=Xe(lt),typeof On!="function")throw Error("An object is not an iterable. This error is likely caused by a bug in React. Please file an issue.");var An=On.call(lt);return An===lt?(Je.tag!==0||Object.prototype.toString.call(Je.type)!=="[object GeneratorFunction]"||Object.prototype.toString.call(An)!=="[object Generator]")&&(Ob||console.error("Using Iterators as children is unsupported and will likely yield unexpected results because enumerating a generator mutates it. You may convert it to an array with `Array.from()` or the `[...spread]` operator before rendering. You can also use an Iterable that can iterate multiple times over the same items."),Ob=!0):lt.entries!==On||rv||(console.error("Using Maps as children is not supported. Use an array of keyed ReactElements instead."),rv=!0),Je=tn(Je,rt,An,kt),rr=Zt,Je}if(typeof lt.then=="function")return Zt=vs(lt._debugInfo),Je=Qt(Je,rt,cy(lt),kt),rr=Zt,Je;if(lt.$$typeof===Ph)return Qt(Je,rt,lh(Je,lt),kt);uy(Je,lt)}return typeof lt=="string"&&lt!==""||typeof lt=="number"||typeof lt=="bigint"?(Zt=""+lt,rt!==null&&rt.tag===6?(v(Je,rt.sibling),kt=I(rt,Zt),kt.return=Je,Je=kt):(v(Je,rt),kt=Hi(Zt,Je.mode,kt),kt.return=Je,kt._debugOwner=Je,kt._debugTask=Je._debugTask,kt._debugInfo=rr,Je=kt),K(Je)):(typeof lt=="function"&&_h(Je,lt),typeof lt=="symbol"&&Ef(Je,lt),v(Je,rt))}return function(Je,rt,lt,kt){var Zt=rr;rr=null;try{Yg=0;var On=Qt(Je,rt,lt,kt);return mm=null,On}catch(Me){if(Me===Bd||Me===Qy)throw Me;var An=F(29,Me,null,Je.mode);An.lanes=kt,An.return=Je;var Yn=An._debugInfo=rr;if(An._debugOwner=Je._debugOwner,An._debugTask=Je._debugTask,Yn!=null){for(var Ce=Yn.length-1;0<=Ce;Ce--)if(typeof Yn[Ce].stack=="string"){An._debugOwner=Yn[Ce],An._debugTask=Yn[Ce].debugTask;break}}return An}finally{rr=Zt}}}function lc(a){var h=a.alternate;$e(Zo,Zo.current&Zg,a),$e(gu,a,a),Vh===null&&(h===null||tp.current!==null||h.memoizedState!==null)&&(Vh=a)}function Np(a){if(a.tag===22){if($e(Zo,Zo.current,a),$e(gu,a,a),Vh===null){var h=a.alternate;h!==null&&h.memoizedState!==null&&(Vh=a)}}else yh(a)}function yh(a){$e(Zo,Zo.current,a),$e(gu,gu.current,a)}function dl(a){Ee(gu,a),Vh===a&&(Vh=null),Ee(Zo,a)}function vh(a){for(var h=a;h!==null;){if(h.tag===13){var v=h.memoizedState;if(v!==null&&(v=v.dehydrated,v===null||v.data===hp||vr(v)))return h}else if(h.tag===19&&h.memoizedProps.revealOrder!==void 0){if((h.flags&128)!==0)return h}else if(h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return null;h=h.return}h.sibling.return=h.return,h=h.sibling}return null}function Lp(a){if(a!==null&&typeof a!="function"){var h=String(a);Pb.has(h)||(Pb.add(h),console.error("Expected the last optional `callback` argument to be a function. Instead received: %s.",a))}}function mg(a,h,v,S){var I=a.memoizedState,k=v(S,I);if(a.mode&tl){Ht(!0);try{k=v(S,I)}finally{Ht(!1)}}k===void 0&&(h=be(h)||"Component",ip.has(h)||(ip.add(h),console.error("%s.getDerivedStateFromProps(): A valid state object (or null) must be returned. You have returned undefined.",h))),I=k==null?I:br({},I,k),a.memoizedState=I,a.lanes===0&&(a.updateQueue.baseState=I)}function hy(a,h,v,S,I,k,K){var ee=a.stateNode;if(typeof ee.shouldComponentUpdate=="function"){if(v=ee.shouldComponentUpdate(S,k,K),a.mode&tl){Ht(!0);try{v=ee.shouldComponentUpdate(S,k,K)}finally{Ht(!1)}}return v===void 0&&console.error("%s.shouldComponentUpdate(): Returned undefined instead of a boolean value. Make sure to return true or false.",be(h)||"Component"),v}return h.prototype&&h.prototype.isPureReactComponent?!Tu(v,S)||!Tu(I,k):!0}function Pu(a,h,v,S){var I=h.state;typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps(v,S),typeof h.UNSAFE_componentWillReceiveProps=="function"&&h.UNSAFE_componentWillReceiveProps(v,S),h.state!==I&&(a=Te(a)||"Component",ED.has(a)||(ED.add(a),console.error("%s.componentWillReceiveProps(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",a)),kb.enqueueReplaceState(h,h.state,null))}function Xa(a,h){var v=h;if("ref"in h){v={};for(var S in h)S!=="ref"&&(v[S]=h[S])}if(a=a.defaultProps){v===h&&(v=br({},v));for(var I in a)v[I]===void 0&&(v[I]=a[I])}return v}function vn(a){Z1(a),console.warn(`%s

%s
`,av?"An error occurred in the <"+av+"> component.":"An error occurred in one of your React components.",`Consider adding an error boundary to your tree to customize error handling behavior.
Visit https://react.dev/link/error-boundaries to learn more about error boundaries.`)}function M0(a){var h=av?"The above error occurred in the <"+av+"> component.":"The above error occurred in one of your React components.",v="React will try to recreate this component tree from scratch using the error boundary you provided, "+((PE||"Anonymous")+".");if(typeof a=="object"&&a!==null&&typeof a.environmentName=="string"){var S=a.environmentName;a=[`%o

%s

%s
`,a,h,v].slice(0),typeof a[0]=="string"?a.splice(0,1,i+a[0],l,g+S+g,p):a.splice(0,0,i,l,g+S+g,p),a.unshift(console),S=b.apply(console.error,a),S()}else console.error(`%o

%s

%s
`,a,h,v)}function P0(a){Z1(a)}function tu(a,h){try{av=h.source?Te(h.source):null,PE=null;var v=h.value;if(Jt.actQueue!==null)Jt.thrownErrors.push(v);else{var S=a.onUncaughtError;S(v,{componentStack:h.stack})}}catch(I){setTimeout(function(){throw I})}}function bh(a,h,v){try{av=v.source?Te(v.source):null,PE=Te(h);var S=a.onCaughtError;S(v.value,{componentStack:v.stack,errorBoundary:h.tag===1?h.stateNode:null})}catch(I){setTimeout(function(){throw I})}}function Fn(a,h,v){return v=kl(v),v.tag=_E,v.payload={element:null},v.callback=function(){Ze(h.source,tu,a,h)},v}function Sf(a){return a=kl(a),a.tag=_E,a}function k0(a,h,v,S){var I=v.type.getDerivedStateFromError;if(typeof I=="function"){var k=S.value;a.payload=function(){return I(k)},a.callback=function(){Km(v),Ze(S.source,bh,h,v,S)}}var K=v.stateNode;K!==null&&typeof K.componentDidCatch=="function"&&(a.callback=function(){Km(v),Ze(S.source,bh,h,v,S),typeof I!="function"&&(lp===null?lp=new Set([this]):lp.add(this)),xE(this,S),typeof I=="function"||(v.lanes&2)===0&&console.error("%s: Error boundaries should implement getDerivedStateFromError(). In that method, return a state update to display an error message or fallback UI.",Te(v)||"Unknown")})}function DT(a,h,v,S,I){if(v.flags|=32768,Nu&&_(a,I),S!==null&&typeof S=="object"&&typeof S.then=="function"){if(h=v.alternate,h!==null&&Jm(h,v,I,!0),qr&&(zd=!0),v=gu.current,v!==null){switch(v.tag){case 13:return Vh===null?X0():v.alternate===null&&Co===sp&&(Co=zE),v.flags&=-257,v.flags|=65536,v.lanes=I,S===mE?v.flags|=16384:(h=v.updateQueue,h===null?v.updateQueue=new Set([S]):h.add(S),hc(a,S,I)),!1;case 22:return v.flags|=65536,S===mE?v.flags|=16384:(h=v.updateQueue,h===null?(h={transitions:null,markerInstances:null,retryQueue:new Set([S])},v.updateQueue=h):(v=h.retryQueue,v===null?h.retryQueue=new Set([S]):v.add(S)),hc(a,S,I)),!1}throw Error("Unexpected Suspense handler tag ("+v.tag+"). This is a bug in React.")}return hc(a,S,I),X0(),!1}if(qr)return zd=!0,h=gu.current,h!==null?((h.flags&65536)===0&&(h.flags|=256),h.flags|=65536,h.lanes=I,S!==hE&&ah(gi(Error("There was an error while hydrating but React was able to recover by instead client rendering from the nearest Suspense boundary.",{cause:S}),v))):(S!==hE&&ah(gi(Error("There was an error while hydrating but React was able to recover by instead client rendering the entire root.",{cause:S}),v)),a=a.current.alternate,a.flags|=65536,I&=-I,a.lanes|=I,S=gi(S,v),I=Fn(a.stateNode,S,I),Nl(a,I),Co!==Jg&&(Co=Kg)),!1;var k=gi(Error("There was an error during concurrent rendering but React was able to recover by instead synchronously rendering the entire root.",{cause:S}),v);if(Fb===null?Fb=[k]:Fb.push(k),Co!==Jg&&(Co=Kg),h===null)return!0;S=gi(S,v),v=h;do{switch(v.tag){case 3:return v.flags|=65536,a=I&-I,v.lanes|=a,a=Fn(v.stateNode,S,a),Nl(v,a),!1;case 1:if(h=v.type,k=v.stateNode,(v.flags&128)===0&&(typeof h.getDerivedStateFromError=="function"||k!==null&&typeof k.componentDidCatch=="function"&&(lp===null||!lp.has(k))))return v.flags|=65536,I&=-I,v.lanes|=I,I=Sf(I),k0(I,a,v,S),Nl(v,I),!1}v=v.return}while(v!==null);return!1}function ko(a,h,v,S){h.child=a===null?CE(h,null,v,S):sv(h,a.child,v,S)}function N0(a,h,v,S,I){v=v.render;var k=h.ref;if("ref"in S){var K={};for(var ee in S)ee!=="ref"&&(K[ee]=S[ee])}else K=S;return sc(h),Tn(h),S=y0(a,h,v,K,k,I),ee=x0(),Cn(),a!==null&&!Ma?(G_(a,h,I),wh(a,h,I)):(qr&&ee&&Jr(h),h.flags|=1,ko(a,h,S,I),h.child)}function $x(a,h,v,S,I){if(a===null){var k=v.type;return typeof k=="function"&&!le(k)&&k.defaultProps===void 0&&v.compare===null?(v=ba(k),h.tag=15,h.type=v,zp(h,k),L0(a,h,v,S,I)):(a=Vt(v.type,null,S,h,h.mode,I),a.ref=h.ref,a.return=h,h.child=a)}if(k=a.child,!ud(a,I)){var K=k.memoizedProps;if(v=v.compare,v=v!==null?v:Tu,v(K,S)&&a.ref===h.ref)return wh(a,h,I)}return h.flags|=1,a=xe(k,S),a.ref=h.ref,a.return=h,h.child=a}function L0(a,h,v,S,I){if(a!==null){var k=a.memoizedProps;if(Tu(k,S)&&a.ref===h.ref&&h.type===a.type)if(Ma=!1,h.pendingProps=S=k,ud(a,I))(a.flags&131072)!==0&&(Ma=!0);else return h.lanes=a.lanes,wh(a,h,I)}return gg(a,h,v,S,I)}function Gx(a,h,v){var S=h.pendingProps,I=S.children,k=a!==null?a.memoizedState:null;if(S.mode==="hidden"){if((h.flags&128)!==0){if(S=k!==null?k.baseLanes|v:v,a!==null){for(I=h.child=a.child,k=0;I!==null;)k=k|I.lanes|I.childLanes,I=I.sibling;h.childLanes=k&~S}else h.childLanes=0,h.child=null;return qx(a,h,S,v)}if((v&536870912)!==0)h.memoizedState={baseLanes:0,cachePool:null},a!==null&&Op(h,k!==null?k.cachePool:null),k!==null?Fx(h,k):Mp(h),Np(h);else return h.lanes=h.childLanes=536870912,qx(a,h,k!==null?k.baseLanes|v:v,v)}else k!==null?(Op(h,k.cachePool),Fx(h,k),yh(h),h.memoizedState=null):(a!==null&&Op(h,null),Mp(h),yh(h));return ko(a,h,I,v),h.child}function qx(a,h,v,S){var I=tg();return I=I===null?null:{parent:da._currentValue,pool:I},h.memoizedState={baseLanes:v,cachePool:I},a!==null&&Op(h,null),Mp(h),Np(h),a!==null&&Jm(a,h,S,!0),null}function ca(a,h){var v=h.ref;if(v===null)a!==null&&a.ref!==null&&(h.flags|=4194816);else{if(typeof v!="function"&&typeof v!="object")throw Error("Expected ref to be a function, an object returned by React.createRef(), or undefined/null.");(a===null||a.ref!==v)&&(h.flags|=4194816)}}function gg(a,h,v,S,I){if(v.prototype&&typeof v.prototype.render=="function"){var k=be(v)||"Unknown";AD[k]||(console.error("The <%s /> component appears to have a render method, but doesn't extend React.Component. This is likely to cause errors. Change %s to extend React.Component instead.",k,k),AD[k]=!0)}return h.mode&tl&&il.recordLegacyContextWarning(h,null),a===null&&(zp(h,h.type),v.contextTypes&&(k=be(v)||"Unknown",DD[k]||(DD[k]=!0,console.error("%s uses the legacy contextTypes API which was removed in React 19. Use React.createContext() with React.useContext() instead. (https://react.dev/link/legacy-context)",k)))),sc(h),Tn(h),v=y0(a,h,v,S,void 0,I),S=x0(),Cn(),a!==null&&!Ma?(G_(a,h,I),wh(a,h,I)):(qr&&S&&Jr(h),h.flags|=1,ko(a,h,v,I),h.child)}function ua(a,h,v,S,I,k){return sc(h),Tn(h),np=-1,nv=a!==null&&a.type!==h.type,h.updateQueue=null,v=b0(h,S,v,I),v0(a,h),S=x0(),Cn(),a!==null&&!Ma?(G_(a,h,k),wh(a,h,k)):(qr&&S&&Jr(h),h.flags|=1,ko(a,h,v,k),h.child)}function ku(a,h,v,S,I){switch(m(h)){case!1:var k=h.stateNode,K=new h.type(h.memoizedProps,k.context).state;k.updater.enqueueSetState(k,K,null);break;case!0:h.flags|=128,h.flags|=65536,k=Error("Simulated error coming from DevTools");var ee=I&-I;if(h.lanes|=ee,K=ws,K===null)throw Error("Expected a work-in-progress root. This is a bug in React. Please file an issue.");ee=Sf(ee),k0(ee,K,h,gi(k,h)),Nl(h,ee)}if(sc(h),h.stateNode===null){if(K=rm,k=v.contextType,"contextType"in v&&k!==null&&(k===void 0||k.$$typeof!==Ph)&&!ME.has(v)&&(ME.add(v),ee=k===void 0?" However, it is set to undefined. This can be caused by a typo or by mixing up named and default imports. This can also happen due to a circular dependency, so try moving the createContext() call to a separate file.":typeof k!="object"?" However, it is set to a "+typeof k+".":k.$$typeof===c1?" Did you accidentally pass the Context.Consumer instead?":" However, it is set to an object with keys {"+Object.keys(k).join(", ")+"}.",console.error("%s defines an invalid contextType. contextType should point to the Context object returned by React.createContext().%s",be(v)||"Component",ee)),typeof k=="object"&&k!==null&&(K=as(k)),k=new v(S,K),h.mode&tl){Ht(!0);try{k=new v(S,K)}finally{Ht(!1)}}if(K=h.memoizedState=k.state!==null&&k.state!==void 0?k.state:null,k.updater=kb,h.stateNode=k,k._reactInternals=h,k._reactInternalInstance=DE,typeof v.getDerivedStateFromProps=="function"&&K===null&&(K=be(v)||"Component",W1.has(K)||(W1.add(K),console.error("`%s` uses `getDerivedStateFromProps` but its initial state is %s. This is not recommended. Instead, define the initial state by assigning an object to `this.state` in the constructor of `%s`. This ensures that `getDerivedStateFromProps` arguments have a consistent shape.",K,k.state===null?"null":"undefined",K))),typeof v.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"){var me=ee=K=null;if(typeof k.componentWillMount=="function"&&k.componentWillMount.__suppressDeprecationWarning!==!0?K="componentWillMount":typeof k.UNSAFE_componentWillMount=="function"&&(K="UNSAFE_componentWillMount"),typeof k.componentWillReceiveProps=="function"&&k.componentWillReceiveProps.__suppressDeprecationWarning!==!0?ee="componentWillReceiveProps":typeof k.UNSAFE_componentWillReceiveProps=="function"&&(ee="UNSAFE_componentWillReceiveProps"),typeof k.componentWillUpdate=="function"&&k.componentWillUpdate.__suppressDeprecationWarning!==!0?me="componentWillUpdate":typeof k.UNSAFE_componentWillUpdate=="function"&&(me="UNSAFE_componentWillUpdate"),K!==null||ee!==null||me!==null){k=be(v)||"Component";var De=typeof v.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";OE.has(k)||(OE.add(k),console.error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

%s uses %s but also contains the following legacy lifecycles:%s%s%s

The above lifecycles should be removed. Learn more about this warning here:
https://react.dev/link/unsafe-component-lifecycles`,k,De,K!==null?`
  `+K:"",ee!==null?`
  `+ee:"",me!==null?`
  `+me:""))}}k=h.stateNode,K=be(v)||"Component",k.render||(v.prototype&&typeof v.prototype.render=="function"?console.error("No `render` method found on the %s instance: did you accidentally return an object from the constructor?",K):console.error("No `render` method found on the %s instance: you may have forgotten to define `render`.",K)),!k.getInitialState||k.getInitialState.isReactClassApproved||k.state||console.error("getInitialState was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Did you mean to define a state property instead?",K),k.getDefaultProps&&!k.getDefaultProps.isReactClassApproved&&console.error("getDefaultProps was defined on %s, a plain JavaScript class. This is only supported for classes created using React.createClass. Use a static property to define defaultProps instead.",K),k.contextType&&console.error("contextType was defined as an instance property on %s. Use a static property to define contextType instead.",K),v.childContextTypes&&!IE.has(v)&&(IE.add(v),console.error("%s uses the legacy childContextTypes API which was removed in React 19. Use React.createContext() instead. (https://react.dev/link/legacy-context)",K)),v.contextTypes&&!Y1.has(v)&&(Y1.add(v),console.error("%s uses the legacy contextTypes API which was removed in React 19. Use React.createContext() with static contextType instead. (https://react.dev/link/legacy-context)",K)),typeof k.componentShouldUpdate=="function"&&console.error("%s has a method called componentShouldUpdate(). Did you mean shouldComponentUpdate()? The name is phrased as a question because the function is expected to return a value.",K),v.prototype&&v.prototype.isPureReactComponent&&typeof k.shouldComponentUpdate<"u"&&console.error("%s has a method called shouldComponentUpdate(). shouldComponentUpdate should not be used when extending React.PureComponent. Please extend React.Component if shouldComponentUpdate is used.",be(v)||"A pure component"),typeof k.componentDidUnmount=="function"&&console.error("%s has a method called componentDidUnmount(). But there is no such lifecycle method. Did you mean componentWillUnmount()?",K),typeof k.componentDidReceiveProps=="function"&&console.error("%s has a method called componentDidReceiveProps(). But there is no such lifecycle method. If you meant to update the state in response to changing props, use componentWillReceiveProps(). If you meant to fetch data or run side-effects or mutations after React has updated the UI, use componentDidUpdate().",K),typeof k.componentWillRecieveProps=="function"&&console.error("%s has a method called componentWillRecieveProps(). Did you mean componentWillReceiveProps()?",K),typeof k.UNSAFE_componentWillRecieveProps=="function"&&console.error("%s has a method called UNSAFE_componentWillRecieveProps(). Did you mean UNSAFE_componentWillReceiveProps()?",K),ee=k.props!==S,k.props!==void 0&&ee&&console.error("When calling super() in `%s`, make sure to pass up the same props that your component's constructor was passed.",K),k.defaultProps&&console.error("Setting defaultProps as an instance property on %s is not supported and will be ignored. Instead, define defaultProps as a static property on %s.",K,K),typeof k.getSnapshotBeforeUpdate!="function"||typeof k.componentDidUpdate=="function"||RE.has(v)||(RE.add(v),console.error("%s: getSnapshotBeforeUpdate() should be used with componentDidUpdate(). This component defines getSnapshotBeforeUpdate() only.",be(v))),typeof k.getDerivedStateFromProps=="function"&&console.error("%s: getDerivedStateFromProps() is defined as an instance method and will be ignored. Instead, declare it as a static method.",K),typeof k.getDerivedStateFromError=="function"&&console.error("%s: getDerivedStateFromError() is defined as an instance method and will be ignored. Instead, declare it as a static method.",K),typeof v.getSnapshotBeforeUpdate=="function"&&console.error("%s: getSnapshotBeforeUpdate() is defined as a static method and will be ignored. Instead, declare it as an instance method.",K),(ee=k.state)&&(typeof ee!="object"||Ka(ee))&&console.error("%s.state: must be set to an object or null",K),typeof k.getChildContext=="function"&&typeof v.childContextTypes!="object"&&console.error("%s.getChildContext(): childContextTypes must be defined in order to use getChildContext().",K),k=h.stateNode,k.props=S,k.state=h.memoizedState,k.refs={},ig(h),K=v.contextType,k.context=typeof K=="object"&&K!==null?as(K):rm,k.state===S&&(K=be(v)||"Component",Mb.has(K)||(Mb.add(K),console.error("%s: It is not recommended to assign props directly to state because updates to props won't be reflected in state. In most cases, it is better to use props directly.",K))),h.mode&tl&&il.recordLegacyContextWarning(h,k),il.recordUnsafeLifecycleWarnings(h,k),k.state=h.memoizedState,K=v.getDerivedStateFromProps,typeof K=="function"&&(mg(h,v,K,S),k.state=h.memoizedState),typeof v.getDerivedStateFromProps=="function"||typeof k.getSnapshotBeforeUpdate=="function"||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(K=k.state,typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount(),K!==k.state&&(console.error("%s.componentWillMount(): Assigning directly to this.state is deprecated (except inside a component's constructor). Use setState instead.",Te(h)||"Component"),kb.enqueueReplaceState(k,k.state,null)),Ta(h,S,k,I),td(),k.state=h.memoizedState),typeof k.componentDidMount=="function"&&(h.flags|=4194308),(h.mode&vc)!==Hs&&(h.flags|=134217728),k=!0}else if(a===null){k=h.stateNode;var it=h.memoizedProps;ee=Xa(v,it),k.props=ee;var yt=k.context;me=v.contextType,K=rm,typeof me=="object"&&me!==null&&(K=as(me)),De=v.getDerivedStateFromProps,me=typeof De=="function"||typeof k.getSnapshotBeforeUpdate=="function",it=h.pendingProps!==it,me||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(it||yt!==K)&&Pu(h,k,S,K),Fu=!1;var ct=h.memoizedState;k.state=ct,Ta(h,S,k,I),td(),yt=h.memoizedState,it||ct!==yt||Fu?(typeof De=="function"&&(mg(h,v,De,S),yt=h.memoizedState),(ee=Fu||hy(h,v,ee,S,ct,yt,K))?(me||typeof k.UNSAFE_componentWillMount!="function"&&typeof k.componentWillMount!="function"||(typeof k.componentWillMount=="function"&&k.componentWillMount(),typeof k.UNSAFE_componentWillMount=="function"&&k.UNSAFE_componentWillMount()),typeof k.componentDidMount=="function"&&(h.flags|=4194308),(h.mode&vc)!==Hs&&(h.flags|=134217728)):(typeof k.componentDidMount=="function"&&(h.flags|=4194308),(h.mode&vc)!==Hs&&(h.flags|=134217728),h.memoizedProps=S,h.memoizedState=yt),k.props=S,k.state=yt,k.context=K,k=ee):(typeof k.componentDidMount=="function"&&(h.flags|=4194308),(h.mode&vc)!==Hs&&(h.flags|=134217728),k=!1)}else{k=h.stateNode,ed(a,h),K=h.memoizedProps,me=Xa(v,K),k.props=me,De=h.pendingProps,ct=k.context,yt=v.contextType,ee=rm,typeof yt=="object"&&yt!==null&&(ee=as(yt)),it=v.getDerivedStateFromProps,(yt=typeof it=="function"||typeof k.getSnapshotBeforeUpdate=="function")||typeof k.UNSAFE_componentWillReceiveProps!="function"&&typeof k.componentWillReceiveProps!="function"||(K!==De||ct!==ee)&&Pu(h,k,S,ee),Fu=!1,ct=h.memoizedState,k.state=ct,Ta(h,S,k,I),td();var ut=h.memoizedState;K!==De||ct!==ut||Fu||a!==null&&a.dependencies!==null&&Kc(a.dependencies)?(typeof it=="function"&&(mg(h,v,it,S),ut=h.memoizedState),(me=Fu||hy(h,v,me,S,ct,ut,ee)||a!==null&&a.dependencies!==null&&Kc(a.dependencies))?(yt||typeof k.UNSAFE_componentWillUpdate!="function"&&typeof k.componentWillUpdate!="function"||(typeof k.componentWillUpdate=="function"&&k.componentWillUpdate(S,ut,ee),typeof k.UNSAFE_componentWillUpdate=="function"&&k.UNSAFE_componentWillUpdate(S,ut,ee)),typeof k.componentDidUpdate=="function"&&(h.flags|=4),typeof k.getSnapshotBeforeUpdate=="function"&&(h.flags|=1024)):(typeof k.componentDidUpdate!="function"||K===a.memoizedProps&&ct===a.memoizedState||(h.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||K===a.memoizedProps&&ct===a.memoizedState||(h.flags|=1024),h.memoizedProps=S,h.memoizedState=ut),k.props=S,k.state=ut,k.context=ee,k=me):(typeof k.componentDidUpdate!="function"||K===a.memoizedProps&&ct===a.memoizedState||(h.flags|=4),typeof k.getSnapshotBeforeUpdate!="function"||K===a.memoizedProps&&ct===a.memoizedState||(h.flags|=1024),k=!1)}if(ee=k,ca(a,h),K=(h.flags&128)!==0,ee||K){if(ee=h.stateNode,vt(h),K&&typeof v.getDerivedStateFromError!="function")v=null,Yo=-1;else{if(Tn(h),v=xD(ee),h.mode&tl){Ht(!0);try{xD(ee)}finally{Ht(!1)}}Cn()}h.flags|=1,a!==null&&K?(h.child=sv(h,a.child,null,I),h.child=sv(h,null,v,I)):ko(a,h,v,I),h.memoizedState=ee.state,a=h.child}else a=wh(a,h,I);return I=h.stateNode,k&&I.props!==S&&(rp||console.error("It looks like %s is reassigning its own `this.props` while rendering. This is not supported and can lead to confusing bugs.",Te(h)||"a component"),rp=!0),a}function ld(a,h,v,S){return wa(),h.flags|=256,ko(a,h,v,S),h.child}function zp(a,h){h&&h.childContextTypes&&console.error(`childContextTypes cannot be defined on a function component.
  %s.childContextTypes = ...`,h.displayName||h.name||"Component"),typeof h.getDerivedStateFromProps=="function"&&(a=be(h)||"Unknown",kE[a]||(console.error("%s: Function components do not support getDerivedStateFromProps.",a),kE[a]=!0)),typeof h.contextType=="object"&&h.contextType!==null&&(h=be(h)||"Unknown",CD[h]||(console.error("%s: Function components do not support contextType.",h),CD[h]=!0))}function Bp(a){return{baseLanes:a,cachePool:pf()}}function cd(a,h,v){return a=a!==null?a.childLanes&~v:0,h&&(a|=yu),a}function z0(a,h,v){var S,I=h.pendingProps;d(h)&&(h.flags|=128);var k=!1,K=(h.flags&128)!==0;if((S=K)||(S=a!==null&&a.memoizedState===null?!1:(Zo.current&ov)!==0),S&&(k=!0,h.flags&=-129),S=(h.flags&32)!==0,h.flags&=-33,a===null){if(qr){if(k?lc(h):yh(h),qr){var ee=So,me;if(!(me=!ee)){e:{var De=ee;for(me=Bh;De.nodeType!==8;){if(!me){me=null;break e}if(De=js(De.nextSibling),De===null){me=null;break e}}me=De}me!==null?(Ki(),h.memoizedState={dehydrated:me,treeContext:Nd!==null?{id:Jf,overflow:Ld}:null,retryLane:536870912,hydrationErrors:null},De=F(18,null,null,Hs),De.stateNode=me,De.return=h,h.child=De,bl=h,So=null,me=!0):me=!1,me=!me}me&&(Un(h,ee),rc(h))}if(ee=h.memoizedState,ee!==null&&(ee=ee.dehydrated,ee!==null))return vr(ee)?h.lanes=32:h.lanes=536870912,null;dl(h)}return ee=I.children,I=I.fallback,k?(yh(h),k=h.mode,ee=$i({mode:"hidden",children:ee},k),I=Ln(I,k,v,null),ee.return=h,I.return=h,ee.sibling=I,h.child=ee,k=h.child,k.memoizedState=Bp(v),k.childLanes=cd(a,S,v),h.memoizedState=K1,I):(lc(h),nu(h,ee))}var it=a.memoizedState;if(it!==null&&(ee=it.dehydrated,ee!==null)){if(K)h.flags&256?(lc(h),h.flags&=-257,h=Af(a,h,v)):h.memoizedState!==null?(yh(h),h.child=a.child,h.flags|=128,h=null):(yh(h),k=I.fallback,ee=h.mode,I=$i({mode:"visible",children:I.children},ee),k=Ln(k,ee,v,null),k.flags|=2,I.return=h,k.return=h,I.sibling=k,h.child=I,sv(h,a.child,null,v),I=h.child,I.memoizedState=Bp(v),I.childLanes=cd(a,S,v),h.memoizedState=K1,h=k);else if(lc(h),qr&&console.error("We should not be hydrating here. This is a bug in React. Please file a bug."),vr(ee)){if(S=ee.nextSibling&&ee.nextSibling.dataset,S){me=S.dgst;var yt=S.msg;De=S.stck;var ct=S.cstck}ee=yt,S=me,I=De,me=k=ct,k=Error(ee||"The server could not finish this Suspense boundary, likely due to an error during server rendering. Switched to client rendering."),k.stack=I||"",k.digest=S,S=me===void 0?null:me,I={value:k,source:null,stack:S},typeof S=="string"&&R1.set(k,I),ah(I),h=Af(a,h,v)}else if(Ma||Jm(a,h,v,!1),S=(v&a.childLanes)!==0,Ma||S){if(S=ws,S!==null&&(I=v&-v,I=(I&42)!==0?1:ir(I),I=(I&(S.suspendedLanes|v))!==0?0:I,I!==0&&I!==it.retryLane))throw it.retryLane=I,fi(a,I),oo(S,a,I),SD;ee.data===hp||X0(),h=Af(a,h,v)}else ee.data===hp?(h.flags|=192,h.child=a.child,h=null):(a=it.treeContext,So=js(ee.nextSibling),bl=h,qr=!0,am=null,zd=!1,xc=null,Bh=!1,a!==null&&(Ki(),nl[bc++]=Jf,nl[bc++]=Ld,nl[bc++]=Nd,Jf=a.id,Ld=a.overflow,Nd=h),h=nu(h,I.children),h.flags|=4096);return h}return k?(yh(h),k=I.fallback,ee=h.mode,me=a.child,De=me.sibling,I=xe(me,{mode:"hidden",children:I.children}),I.subtreeFlags=me.subtreeFlags&65011712,De!==null?k=xe(De,k):(k=Ln(k,ee,v,null),k.flags|=2),k.return=h,I.return=h,I.sibling=k,h.child=I,I=k,k=h.child,ee=a.child.memoizedState,ee===null?ee=Bp(v):(me=ee.cachePool,me!==null?(De=da._currentValue,me=me.parent!==De?{parent:De,pool:De}:me):me=pf(),ee={baseLanes:ee.baseLanes|v,cachePool:me}),k.memoizedState=ee,k.childLanes=cd(a,S,v),h.memoizedState=K1,I):(lc(h),v=a.child,a=v.sibling,v=xe(v,{mode:"visible",children:I.children}),v.return=h,v.sibling=null,a!==null&&(S=h.deletions,S===null?(h.deletions=[a],h.flags|=16):S.push(a)),h.child=v,h.memoizedState=null,v)}function nu(a,h){return h=$i({mode:"visible",children:h},a.mode),h.return=a,a.child=h}function $i(a,h){return a=F(22,a,null,h),a.lanes=0,a.stateNode={_visibility:O1,_pendingMarkers:null,_retryCache:null,_transitions:null},a}function Af(a,h,v){return sv(h,a.child,null,v),a=nu(h,h.pendingProps.children),a.flags|=2,h.memoizedState=null,a}function xh(a,h,v){a.lanes|=h;var S=a.alternate;S!==null&&(S.lanes|=h),ff(a.return,h,v)}function B0(a,h){var v=Ka(a);return a=!v&&typeof Xe(a)=="function",v||a?(v=v?"array":"iterable",console.error("A nested %s was passed to row #%s in <SuspenseList />. Wrap it in an additional SuspenseList to configure its revealOrder: <SuspenseList revealOrder=...> ... <SuspenseList revealOrder=...>{%s}</SuspenseList> ... </SuspenseList>",v,h,v),!1):!0}function dy(a,h,v,S,I){var k=a.memoizedState;k===null?a.memoizedState={isBackwards:h,rendering:null,renderingStartTime:0,last:S,tail:v,tailMode:I}:(k.isBackwards=h,k.rendering=null,k.renderingStartTime=0,k.last=S,k.tail=v,k.tailMode=I)}function F0(a,h,v){var S=h.pendingProps,I=S.revealOrder,k=S.tail;if(S=S.children,I!==void 0&&I!=="forwards"&&I!=="backwards"&&I!=="together"&&!X1[I])if(X1[I]=!0,typeof I=="string")switch(I.toLowerCase()){case"together":case"forwards":case"backwards":console.error('"%s" is not a valid value for revealOrder on <SuspenseList />. Use lowercase "%s" instead.',I,I.toLowerCase());break;case"forward":case"backward":console.error('"%s" is not a valid value for revealOrder on <SuspenseList />. React uses the -s suffix in the spelling. Use "%ss" instead.',I,I.toLowerCase());break;default:console.error('"%s" is not a supported revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',I)}else console.error('%s is not a supported value for revealOrder on <SuspenseList />. Did you mean "together", "forwards" or "backwards"?',I);k===void 0||Q1[k]||(k!=="collapsed"&&k!=="hidden"?(Q1[k]=!0,console.error('"%s" is not a supported value for tail on <SuspenseList />. Did you mean "collapsed" or "hidden"?',k)):I!=="forwards"&&I!=="backwards"&&(Q1[k]=!0,console.error('<SuspenseList tail="%s" /> is only valid if revealOrder is "forwards" or "backwards". Did you mean to specify revealOrder="forwards"?',k)));e:if((I==="forwards"||I==="backwards")&&S!==void 0&&S!==null&&S!==!1)if(Ka(S)){for(var K=0;K<S.length;K++)if(!B0(S[K],K))break e}else if(K=Xe(S),typeof K=="function"){if(K=K.call(S))for(var ee=K.next(),me=0;!ee.done;ee=K.next()){if(!B0(ee.value,me))break e;me++}}else console.error('A single row was passed to a <SuspenseList revealOrder="%s" />. This is not useful since it needs multiple rows. Did you mean to pass multiple children or an array?',I);if(ko(a,h,S,v),S=Zo.current,(S&ov)!==0)S=S&Zg|ov,h.flags|=128;else{if(a!==null&&(a.flags&128)!==0)e:for(a=h.child;a!==null;){if(a.tag===13)a.memoizedState!==null&&xh(a,v,h);else if(a.tag===19)xh(a,v,h);else if(a.child!==null){a.child.return=a,a=a.child;continue}if(a===h)break e;for(;a.sibling===null;){if(a.return===null||a.return===h)break e;a=a.return}a.sibling.return=a.return,a=a.sibling}S&=Zg}switch($e(Zo,S,h),I){case"forwards":for(v=h.child,I=null;v!==null;)a=v.alternate,a!==null&&vh(a)===null&&(I=v),v=v.sibling;v=I,v===null?(I=h.child,h.child=null):(I=v.sibling,v.sibling=null),dy(h,!1,I,v,k);break;case"backwards":for(v=null,I=h.child,h.child=null;I!==null;){if(a=I.alternate,a!==null&&vh(a)===null){h.child=I;break}a=I.sibling,I.sibling=v,v=I,I=a}dy(h,!0,v,null,k);break;case"together":dy(h,!1,null,null,void 0);break;default:h.memoizedState=null}return h.child}function wh(a,h,v){if(a!==null&&(h.dependencies=a.dependencies),Yo=-1,bm|=h.lanes,(v&h.childLanes)===0)if(a!==null){if(Jm(a,h,v,!1),(v&h.childLanes)===0)return null}else return null;if(a!==null&&h.child!==a.child)throw Error("Resuming work not yet implemented.");if(h.child!==null){for(a=h.child,v=xe(a,a.pendingProps),h.child=v,v.return=h;a.sibling!==null;)a=a.sibling,v=v.sibling=xe(a,a.pendingProps),v.return=h;v.sibling=null}return h.child}function ud(a,h){return(a.lanes&h)!==0?!0:(a=a.dependencies,!!(a!==null&&Kc(a)))}function Cf(a,h,v){switch(h.tag){case 3:zt(h,h.stateNode.containerInfo),oa(h,da,a.memoizedState.cache),wa();break;case 27:case 5:Ft(h);break;case 4:zt(h,h.stateNode.containerInfo);break;case 10:oa(h,h.type,h.memoizedProps.value);break;case 12:(v&h.childLanes)!==0&&(h.flags|=4),h.flags|=2048;var S=h.stateNode;S.effectDuration=-0,S.passiveEffectDuration=-0;break;case 13:if(S=h.memoizedState,S!==null)return S.dehydrated!==null?(lc(h),h.flags|=128,null):(v&h.child.childLanes)!==0?z0(a,h,v):(lc(h),a=wh(a,h,v),a!==null?a.sibling:null);lc(h);break;case 19:var I=(a.flags&128)!==0;if(S=(v&h.childLanes)!==0,S||(Jm(a,h,v,!1),S=(v&h.childLanes)!==0),I){if(S)return F0(a,h,v);h.flags|=128}if(I=h.memoizedState,I!==null&&(I.rendering=null,I.tail=null,I.lastEffect=null),$e(Zo,Zo.current,h),S)break;return null;case 22:case 23:return h.lanes=0,Gx(a,h,v);case 24:oa(h,da,a.memoizedState.cache)}return wh(a,h,v)}function Gt(a,h,v){if(h._debugNeedsRemount&&a!==null){v=Vt(h.type,h.key,h.pendingProps,h._debugOwner||null,h.mode,h.lanes),v._debugStack=h._debugStack,v._debugTask=h._debugTask;var S=h.return;if(S===null)throw Error("Cannot swap the root fiber.");if(a.alternate=null,h.alternate=null,v.index=h.index,v.sibling=h.sibling,v.return=h.return,v.ref=h.ref,v._debugInfo=h._debugInfo,h===S.child)S.child=v;else{var I=S.child;if(I===null)throw Error("Expected parent to have a child.");for(;I.sibling!==h;)if(I=I.sibling,I===null)throw Error("Expected to find the previous sibling.");I.sibling=v}return h=S.deletions,h===null?(S.deletions=[a],S.flags|=16):h.push(a),v.flags|=2,v}if(a!==null)if(a.memoizedProps!==h.pendingProps||h.type!==a.type)Ma=!0;else{if(!ud(a,v)&&(h.flags&128)===0)return Ma=!1,Cf(a,h,v);Ma=(a.flags&131072)!==0}else Ma=!1,(S=qr)&&(Ki(),S=(h.flags&1048576)!==0),S&&(S=h.index,Ki(),an(h,om,S));switch(h.lanes=0,h.tag){case 16:e:if(S=h.pendingProps,a=jd(h.elementType),h.type=a,typeof a=="function")le(a)?(S=Xa(a,S),h.tag=1,h.type=a=ba(a),h=ku(null,h,a,S,v)):(h.tag=0,zp(h,a),h.type=a=ba(a),h=gg(null,h,a,S,v));else{if(a!=null){if(I=a.$$typeof,I===ky){h.tag=11,h.type=a=Wr(a),h=N0(null,h,a,S,v);break e}else if(I===go){h.tag=14,h=$x(null,h,a,S,v);break e}}throw h="",a!==null&&typeof a=="object"&&a.$$typeof===_c&&(h=" Did you wrap a component in React.lazy() more than once?"),a=be(a)||a,Error("Element type is invalid. Received a promise that resolves to: "+a+". Lazy element type must resolve to a class or function."+h)}return h;case 0:return gg(a,h,h.type,h.pendingProps,v);case 1:return S=h.type,I=Xa(S,h.pendingProps),ku(a,h,S,I,v);case 3:e:{if(zt(h,h.stateNode.containerInfo),a===null)throw Error("Should have a current fiber. This is a bug in React.");S=h.pendingProps;var k=h.memoizedState;I=k.element,ed(a,h),Ta(h,S,null,v);var K=h.memoizedState;if(S=K.cache,oa(h,da,S),S!==k.cache&&f0(h,[da],v,!0),td(),S=K.element,k.isDehydrated)if(k={element:S,isDehydrated:!1,cache:K.cache},h.updateQueue.baseState=k,h.memoizedState=k,h.flags&256){h=ld(a,h,S,v);break e}else if(S!==I){I=gi(Error("This root received an early update, before anything was able hydrate. Switched the entire root to client rendering."),h),ah(I),h=ld(a,h,S,v);break e}else{switch(a=h.stateNode.containerInfo,a.nodeType){case 9:a=a.body;break;default:a=a.nodeName==="HTML"?a.ownerDocument.body:a}for(So=js(a.firstChild),bl=h,qr=!0,am=null,zd=!1,xc=null,Bh=!0,a=CE(h,null,S,v),h.child=a;a;)a.flags=a.flags&-3|4096,a=a.sibling}else{if(wa(),S===I){h=wh(a,h,v);break e}ko(a,h,S,v)}h=h.child}return h;case 26:return ca(a,h),a===null?(a=Ay(h.type,null,h.pendingProps,null))?h.memoizedState=a:qr||(a=h.type,v=h.pendingProps,S=ze(Qp.current),S=Bi(S).createElement(a),S[_l]=h,S[yc]=v,Nt(S,a,v),xt(S),h.stateNode=S):h.memoizedState=Ay(h.type,a.memoizedProps,h.pendingProps,a.memoizedState),null;case 27:return Ft(h),a===null&&qr&&(S=ze(Qp.current),I=mt(),S=h.stateNode=pc(h.type,h.pendingProps,S,I,!1),zd||(I=Xn(S,h.type,h.pendingProps,I),I!==null&&(xa(h,0).serverProps=I)),bl=h,Bh=!0,I=So,Wi(h.type)?(nS=I,So=js(S.firstChild)):So=I),ko(a,h,h.pendingProps.children,v),ca(a,h),a===null&&(h.flags|=4194304),h.child;case 5:return a===null&&qr&&(k=mt(),S=ll(h.type,k.ancestorInfo),I=So,(K=!I)||(K=ts(I,h.type,h.pendingProps,Bh),K!==null?(h.stateNode=K,zd||(k=Xn(K,h.type,h.pendingProps,k),k!==null&&(xa(h,0).serverProps=k)),bl=h,So=js(K.firstChild),Bh=!1,k=!0):k=!1,K=!k),K&&(S&&Un(h,I),rc(h))),Ft(h),I=h.type,k=h.pendingProps,K=a!==null?a.memoizedProps:null,S=k.children,qi(I,k)?S=null:K!==null&&qi(I,K)&&(h.flags|=32),h.memoizedState!==null&&(I=y0(a,h,$_,null,null,v),u._currentValue=I),ca(a,h),ko(a,h,S,v),h.child;case 6:return a===null&&qr&&(a=h.pendingProps,v=mt(),S=v.ancestorInfo.current,a=S!=null?$c(a,S.tag,v.ancestorInfo.implicitRootScope):!0,v=So,(S=!v)||(S=No(v,h.pendingProps,Bh),S!==null?(h.stateNode=S,bl=h,So=null,S=!0):S=!1,S=!S),S&&(a&&Un(h,v),rc(h))),null;case 13:return z0(a,h,v);case 4:return zt(h,h.stateNode.containerInfo),S=h.pendingProps,a===null?h.child=sv(h,null,S,v):ko(a,h,S,v),h.child;case 11:return N0(a,h,h.type,h.pendingProps,v);case 7:return ko(a,h,h.pendingProps,v),h.child;case 8:return ko(a,h,h.pendingProps.children,v),h.child;case 12:return h.flags|=4,h.flags|=2048,S=h.stateNode,S.effectDuration=-0,S.passiveEffectDuration=-0,ko(a,h,h.pendingProps.children,v),h.child;case 10:return S=h.type,I=h.pendingProps,k=I.value,"value"in I||J1||(J1=!0,console.error("The `value` prop is required for the `<Context.Provider>`. Did you misspell it or forget to pass it?")),oa(h,S,k),ko(a,h,I.children,v),h.child;case 9:return I=h.type._context,S=h.pendingProps.children,typeof S!="function"&&console.error("A context consumer was rendered with multiple children, or a child that isn't a function. A context consumer expects a single child that is a function. If you did pass a function, make sure there is no trailing or leading whitespace around it."),sc(h),I=as(I),Tn(h),S=iv(S,I,void 0),Cn(),h.flags|=1,ko(a,h,S,v),h.child;case 14:return $x(a,h,h.type,h.pendingProps,v);case 15:return L0(a,h,h.type,h.pendingProps,v);case 19:return F0(a,h,v);case 31:return S=h.pendingProps,v=h.mode,S={mode:S.mode,children:S.children},a===null?(a=$i(S,v),a.ref=h.ref,h.child=a,a.return=h,h=a):(a=xe(a.child,S),a.ref=h.ref,h.child=a,a.return=h,h=a),h;case 22:return Gx(a,h,v);case 24:return sc(h),S=as(da),a===null?(I=tg(),I===null&&(I=ws,k=Cp(),I.pooledCache=k,ch(k),k!==null&&(I.pooledCacheLanes|=v),I=k),h.memoizedState={parent:S,cache:I},ig(h),oa(h,da,I)):((a.lanes&v)!==0&&(ed(a,h),Ta(h,null,null,v),td()),I=a.memoizedState,k=h.memoizedState,I.parent!==S?(I={parent:S,cache:S},h.memoizedState=I,h.lanes===0&&(h.memoizedState=h.updateQueue.baseState=I),oa(h,da,S)):(S=k.cache,oa(h,da,S),S!==I.cache&&f0(h,[da],v,!0))),ko(a,h,h.pendingProps.children,v),h.child;case 29:throw h.pendingProps}throw Error("Unknown unit of work tag ("+h.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function cn(a){a.flags|=4}function hd(a,h){if(h.type!=="stylesheet"||(h.state.loading&vu)!==o_)a.flags&=-16777217;else if(a.flags|=16777216,!IT(h)){if(h=gu.current,h!==null&&((ur&4194048)===ur?Vh!==null:(ur&62914560)!==ur&&(ur&536870912)===0||h!==Vh))throw Ky=mE,gD;a.flags|=8192}}function Lr(a,h){h!==null&&(a.flags|=4),a.flags&16384&&(h=a.tag!==22?dr():536870912,a.lanes|=h,t_|=h)}function pt(a,h){if(!qr)switch(a.tailMode){case"hidden":h=a.tail;for(var v=null;h!==null;)h.alternate!==null&&(v=h),h=h.sibling;v===null?a.tail=null:v.sibling=null;break;case"collapsed":v=a.tail;for(var S=null;v!==null;)v.alternate!==null&&(S=v),v=v.sibling;S===null?h||a.tail===null?a.tail=null:a.tail.sibling=null:S.sibling=null}}function Vr(a){var h=a.alternate!==null&&a.alternate.child===a.child,v=0,S=0;if(h)if((a.mode&el)!==Hs){for(var I=a.selfBaseDuration,k=a.child;k!==null;)v|=k.lanes|k.childLanes,S|=k.subtreeFlags&65011712,S|=k.flags&65011712,I+=k.treeBaseDuration,k=k.sibling;a.treeBaseDuration=I}else for(I=a.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags&65011712,S|=I.flags&65011712,I.return=a,I=I.sibling;else if((a.mode&el)!==Hs){I=a.actualDuration,k=a.selfBaseDuration;for(var K=a.child;K!==null;)v|=K.lanes|K.childLanes,S|=K.subtreeFlags,S|=K.flags,I+=K.actualDuration,k+=K.treeBaseDuration,K=K.sibling;a.actualDuration=I,a.treeBaseDuration=k}else for(I=a.child;I!==null;)v|=I.lanes|I.childLanes,S|=I.subtreeFlags,S|=I.flags,I.return=a,I=I.sibling;return a.subtreeFlags|=S,a.childLanes=v,h}function fy(a,h,v){var S=h.pendingProps;switch(Hn(h),h.tag){case 31:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return Vr(h),null;case 1:return Vr(h),null;case 3:return v=h.stateNode,S=null,a!==null&&(S=a.memoizedState.cache),h.memoizedState.cache!==S&&(h.flags|=2048),Vs(da,h),St(h),v.pendingContext&&(v.context=v.pendingContext,v.pendingContext=null),(a===null||a.child===null)&&(Sp(h)?(fo(),cn(h)):a===null||a.memoizedState.isDehydrated&&(h.flags&256)===0||(h.flags|=1024,sa())),Vr(h),null;case 26:return v=h.memoizedState,a===null?(cn(h),v!==null?(Vr(h),hd(h,v)):(Vr(h),h.flags&=-16777217)):v?v!==a.memoizedState?(cn(h),Vr(h),hd(h,v)):(Vr(h),h.flags&=-16777217):(a.memoizedProps!==S&&cn(h),Vr(h),h.flags&=-16777217),null;case 27:rn(h),v=ze(Qp.current);var I=h.type;if(a!==null&&h.stateNode!=null)a.memoizedProps!==S&&cn(h);else{if(!S){if(h.stateNode===null)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return Vr(h),null}a=mt(),Sp(h)?df(h):(a=pc(I,S,v,a,!0),h.stateNode=a,cn(h))}return Vr(h),null;case 5:if(rn(h),v=h.type,a!==null&&h.stateNode!=null)a.memoizedProps!==S&&cn(h);else{if(!S){if(h.stateNode===null)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");return Vr(h),null}if(I=mt(),Sp(h))df(h);else{switch(a=ze(Qp.current),ll(v,I.ancestorInfo),I=I.context,a=Bi(a),I){case dp:a=a.createElementNS(Bg,v);break;case Gb:a=a.createElementNS(pb,v);break;default:switch(v){case"svg":a=a.createElementNS(Bg,v);break;case"math":a=a.createElementNS(pb,v);break;case"script":a=a.createElement("div"),a.innerHTML="<script><\/script>",a=a.removeChild(a.firstChild);break;case"select":a=typeof S.is=="string"?a.createElement("select",{is:S.is}):a.createElement("select"),S.multiple?a.multiple=!0:S.size&&(a.size=S.size);break;default:a=typeof S.is=="string"?a.createElement(v,{is:S.is}):a.createElement(v),v.indexOf("-")===-1&&(v!==v.toLowerCase()&&console.error("<%s /> is using incorrect casing. Use PascalCase for React components, or lowercase for HTML elements.",v),Object.prototype.toString.call(a)!=="[object HTMLUnknownElement]"||$f.call(dw,v)||(dw[v]=!0,console.error("The tag <%s> is unrecognized in this browser. If you meant to render a React component, start its name with an uppercase letter.",v)))}}a[_l]=h,a[yc]=S;e:for(I=h.child;I!==null;){if(I.tag===5||I.tag===6)a.appendChild(I.stateNode);else if(I.tag!==4&&I.tag!==27&&I.child!==null){I.child.return=I,I=I.child;continue}if(I===h)break e;for(;I.sibling===null;){if(I.return===null||I.return===h)break e;I=I.return}I.sibling.return=I.return,I=I.sibling}h.stateNode=a;e:switch(Nt(a,v,S),v){case"button":case"input":case"select":case"textarea":a=!!S.autoFocus;break e;case"img":a=!0;break e;default:a=!1}a&&cn(h)}}return Vr(h),h.flags&=-16777217,null;case 6:if(a&&h.stateNode!=null)a.memoizedProps!==S&&cn(h);else{if(typeof S!="string"&&h.stateNode===null)throw Error("We must have new props for new mounts. This error is likely caused by a bug in React. Please file an issue.");if(a=ze(Qp.current),v=mt(),Sp(h)){a=h.stateNode,v=h.memoizedProps,I=!zd,S=null;var k=bl;if(k!==null)switch(k.tag){case 3:I&&(I=gl(a,v,S),I!==null&&(xa(h,0).serverProps=I));break;case 27:case 5:S=k.memoizedProps,I&&(I=gl(a,v,S),I!==null&&(xa(h,0).serverProps=I))}a[_l]=h,a=!!(a.nodeValue===v||S!==null&&S.suppressHydrationWarning===!0||Dt(a.nodeValue,v)),a||rc(h)}else I=v.ancestorInfo.current,I!=null&&$c(S,I.tag,v.ancestorInfo.implicitRootScope),a=Bi(a).createTextNode(S),a[_l]=h,h.stateNode=a}return Vr(h),null;case 13:if(S=h.memoizedState,a===null||a.memoizedState!==null&&a.memoizedState.dehydrated!==null){if(I=Sp(h),S!==null&&S.dehydrated!==null){if(a===null){if(!I)throw Error("A dehydrated suspense component was completed without a hydrated node. This is probably a bug in React.");if(I=h.memoizedState,I=I!==null?I.dehydrated:null,!I)throw Error("Expected to have a hydrated suspense instance. This error is likely caused by a bug in React. Please file an issue.");I[_l]=h,Vr(h),(h.mode&el)!==Hs&&S!==null&&(I=h.child,I!==null&&(h.treeBaseDuration-=I.treeBaseDuration))}else fo(),wa(),(h.flags&128)===0&&(h.memoizedState=null),h.flags|=4,Vr(h),(h.mode&el)!==Hs&&S!==null&&(I=h.child,I!==null&&(h.treeBaseDuration-=I.treeBaseDuration));I=!1}else I=sa(),a!==null&&a.memoizedState!==null&&(a.memoizedState.hydrationErrors=I),I=!0;if(!I)return h.flags&256?(dl(h),h):(dl(h),null)}return dl(h),(h.flags&128)!==0?(h.lanes=v,(h.mode&el)!==Hs&&Rp(h),h):(v=S!==null,a=a!==null&&a.memoizedState!==null,v&&(S=h.child,I=null,S.alternate!==null&&S.alternate.memoizedState!==null&&S.alternate.memoizedState.cachePool!==null&&(I=S.alternate.memoizedState.cachePool.pool),k=null,S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(k=S.memoizedState.cachePool.pool),k!==I&&(S.flags|=2048)),v!==a&&v&&(h.child.flags|=8192),Lr(h,h.updateQueue),Vr(h),(h.mode&el)!==Hs&&v&&(a=h.child,a!==null&&(h.treeBaseDuration-=a.treeBaseDuration)),null);case 4:return St(h),a===null&&Ve(h.stateNode.containerInfo),Vr(h),null;case 10:return Vs(h.type,h),Vr(h),null;case 19:if(Ee(Zo,h),I=h.memoizedState,I===null)return Vr(h),null;if(S=(h.flags&128)!==0,k=I.rendering,k===null)if(S)pt(I,!1);else{if(Co!==sp||a!==null&&(a.flags&128)!==0)for(a=h.child;a!==null;){if(k=vh(a),k!==null){for(h.flags|=128,pt(I,!1),a=k.updateQueue,h.updateQueue=a,Lr(h,a),h.subtreeFlags=0,a=v,v=h.child;v!==null;)Ke(v,a),v=v.sibling;return $e(Zo,Zo.current&Zg|ov,h),h.child}a=a.sibling}I.tail!==null&&Sd()>pv&&(h.flags|=128,S=!0,pt(I,!1),h.lanes=4194304)}else{if(!S)if(a=vh(k),a!==null){if(h.flags|=128,S=!0,a=a.updateQueue,h.updateQueue=a,Lr(h,a),pt(I,!0),I.tail===null&&I.tailMode==="hidden"&&!k.alternate&&!qr)return Vr(h),null}else 2*Sd()-I.renderingStartTime>pv&&v!==536870912&&(h.flags|=128,S=!0,pt(I,!1),h.lanes=4194304);I.isBackwards?(k.sibling=h.child,h.child=k):(a=I.last,a!==null?a.sibling=k:h.child=k,I.last=k)}return I.tail!==null?(a=I.tail,I.rendering=a,I.tail=a.sibling,I.renderingStartTime=Sd(),a.sibling=null,v=Zo.current,v=S?v&Zg|ov:v&Zg,$e(Zo,v,h),a):(Vr(h),null);case 22:case 23:return dl(h),g0(h),S=h.memoizedState!==null,a!==null?a.memoizedState!==null!==S&&(h.flags|=8192):S&&(h.flags|=8192),S?(v&536870912)!==0&&(h.flags&128)===0&&(Vr(h),h.subtreeFlags&6&&(h.flags|=8192)):Vr(h),v=h.updateQueue,v!==null&&Lr(h,v.retryQueue),v=null,a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(v=a.memoizedState.cachePool.pool),S=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(S=h.memoizedState.cachePool.pool),S!==v&&(h.flags|=2048),a!==null&&Ee(Bu,h),null;case 24:return v=null,a!==null&&(v=a.memoizedState.cache),h.memoizedState.cache!==v&&(h.flags|=2048),Vs(da,h),Vr(h),null;case 25:return null;case 30:return null}throw Error("Unknown unit of work tag ("+h.tag+"). This error is likely caused by a bug in React. Please file an issue.")}function py(a,h){switch(Hn(h),h.tag){case 1:return a=h.flags,a&65536?(h.flags=a&-65537|128,(h.mode&el)!==Hs&&Rp(h),h):null;case 3:return Vs(da,h),St(h),a=h.flags,(a&65536)!==0&&(a&128)===0?(h.flags=a&-65537|128,h):null;case 26:case 27:case 5:return rn(h),null;case 13:if(dl(h),a=h.memoizedState,a!==null&&a.dehydrated!==null){if(h.alternate===null)throw Error("Threw in newly mounted dehydrated component. This is likely a bug in React. Please file an issue.");wa()}return a=h.flags,a&65536?(h.flags=a&-65537|128,(h.mode&el)!==Hs&&Rp(h),h):null;case 19:return Ee(Zo,h),null;case 4:return St(h),null;case 10:return Vs(h.type,h),null;case 22:case 23:return dl(h),g0(h),a!==null&&Ee(Bu,h),a=h.flags,a&65536?(h.flags=a&-65537|128,(h.mode&el)!==Hs&&Rp(h),h):null;case 24:return Vs(da,h),null;case 25:return null;default:return null}}function my(a,h){switch(Hn(h),h.tag){case 3:Vs(da,h),St(h);break;case 26:case 27:case 5:rn(h);break;case 4:St(h);break;case 13:dl(h);break;case 19:Ee(Zo,h);break;case 10:Vs(h.type,h);break;case 22:case 23:dl(h),g0(h),a!==null&&Ee(Bu,h);break;case 24:Vs(da,h)}}function iu(a){return(a.mode&el)!==Hs}function V0(a,h){iu(a)?(Pl(),_g(h,a),Jc()):_g(h,a)}function dd(a,h,v){iu(a)?(Pl(),Fp(v,a,h),Jc()):Fp(v,a,h)}function _g(a,h){try{var v=h.updateQueue,S=v!==null?v.lastEffect:null;if(S!==null){var I=S.next;v=I;do{if((v.tag&a)===a&&((a&fa)!==fu?ei!==null&&typeof ei.markComponentPassiveEffectMountStarted=="function"&&ei.markComponentPassiveEffectMountStarted(h):(a&Ia)!==fu&&ei!==null&&typeof ei.markComponentLayoutEffectMountStarted=="function"&&ei.markComponentLayoutEffectMountStarted(h),S=void 0,(a&Ul)!==fu&&(_v=!0),S=Ze(h,wD,v),(a&Ul)!==fu&&(_v=!1),(a&fa)!==fu?ei!==null&&typeof ei.markComponentPassiveEffectMountStopped=="function"&&ei.markComponentPassiveEffectMountStopped():(a&Ia)!==fu&&ei!==null&&typeof ei.markComponentLayoutEffectMountStopped=="function"&&ei.markComponentLayoutEffectMountStopped(),S!==void 0&&typeof S!="function")){var k=void 0;k=(v.tag&Ia)!==0?"useLayoutEffect":(v.tag&Ul)!==0?"useInsertionEffect":"useEffect";var K=void 0;K=S===null?" You returned null. If your effect does not require clean up, return undefined (or nothing).":typeof S.then=="function"?`

It looks like you wrote `+k+`(async () => ...) or returned a Promise. Instead, write the async function inside your effect and call it immediately:

`+k+`(() => {
  async function fetchData() {
    // You can await here
    const response = await MyAPI.getData(someId);
    // ...
  }
  fetchData();
}, [someId]); // Or [] if effect doesn't need props or state

Learn more about data fetching with Hooks: https://react.dev/link/hooks-data-fetching`:" You returned: "+S,Ze(h,function(ee,me){console.error("%s must not return anything besides a function, which is used for clean-up.%s",ee,me)},k,K)}v=v.next}while(v!==I)}}catch(ee){ls(h,h.return,ee)}}function Fp(a,h,v){try{var S=h.updateQueue,I=S!==null?S.lastEffect:null;if(I!==null){var k=I.next;S=k;do{if((S.tag&a)===a){var K=S.inst,ee=K.destroy;ee!==void 0&&(K.destroy=void 0,(a&fa)!==fu?ei!==null&&typeof ei.markComponentPassiveEffectUnmountStarted=="function"&&ei.markComponentPassiveEffectUnmountStarted(h):(a&Ia)!==fu&&ei!==null&&typeof ei.markComponentLayoutEffectUnmountStarted=="function"&&ei.markComponentLayoutEffectUnmountStarted(h),(a&Ul)!==fu&&(_v=!0),I=h,Ze(I,TD,I,v,ee),(a&Ul)!==fu&&(_v=!1),(a&fa)!==fu?ei!==null&&typeof ei.markComponentPassiveEffectUnmountStopped=="function"&&ei.markComponentPassiveEffectUnmountStopped():(a&Ia)!==fu&&ei!==null&&typeof ei.markComponentLayoutEffectUnmountStopped=="function"&&ei.markComponentLayoutEffectUnmountStopped())}S=S.next}while(S!==k)}}catch(me){ls(h,h.return,me)}}function U0(a,h){iu(a)?(Pl(),_g(h,a),Jc()):_g(h,a)}function Vp(a,h,v){iu(a)?(Pl(),Fp(v,a,h),Jc()):Fp(v,a,h)}function gy(a){var h=a.updateQueue;if(h!==null){var v=a.stateNode;a.type.defaultProps||"ref"in a.memoizedProps||rp||(v.props!==a.memoizedProps&&console.error("Expected %s props to match memoized props before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",Te(a)||"instance"),v.state!==a.memoizedState&&console.error("Expected %s state to match memoized state before processing the update queue. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",Te(a)||"instance"));try{Ze(a,Bx,h,v)}catch(S){ls(a,a.return,S)}}}function j0(a,h,v){return a.getSnapshotBeforeUpdate(h,v)}function Wx(a,h){var v=h.memoizedProps,S=h.memoizedState;h=a.stateNode,a.type.defaultProps||"ref"in a.memoizedProps||rp||(h.props!==a.memoizedProps&&console.error("Expected %s props to match memoized props before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",Te(a)||"instance"),h.state!==a.memoizedState&&console.error("Expected %s state to match memoized state before getSnapshotBeforeUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",Te(a)||"instance"));try{var I=Xa(a.type,v,a.elementType===a.type),k=Ze(a,j0,h,I,S);v=NE,k!==void 0||v.has(a.type)||(v.add(a.type),Ze(a,function(){console.error("%s.getSnapshotBeforeUpdate(): A snapshot value (or null) must be returned. You have returned undefined.",Te(a))})),h.__reactInternalSnapshotBeforeUpdate=k}catch(K){ls(a,a.return,K)}}function yg(a,h,v){v.props=Xa(a.type,a.memoizedProps),v.state=a.memoizedState,iu(a)?(Pl(),Ze(a,q1,a,h,v),Jc()):Ze(a,q1,a,h,v)}function vg(a){var h=a.ref;if(h!==null){switch(a.tag){case 26:case 27:case 5:var v=a.stateNode;break;case 30:v=a.stateNode;break;default:v=a.stateNode}if(typeof h=="function")if(iu(a))try{Pl(),a.refCleanup=h(v)}finally{Jc()}else a.refCleanup=h(v);else typeof h=="string"?console.error("String refs are no longer supported."):h.hasOwnProperty("current")||console.error("Unexpected ref object provided for %s. Use either a ref-setter function or React.createRef().",Te(a)),h.current=v}}function ru(a,h){try{Ze(a,vg,a)}catch(v){ls(a,h,v)}}function cc(a,h){var v=a.ref,S=a.refCleanup;if(v!==null)if(typeof S=="function")try{if(iu(a))try{Pl(),Ze(a,S)}finally{Jc(a)}else Ze(a,S)}catch(I){ls(a,h,I)}finally{a.refCleanup=null,a=a.alternate,a!=null&&(a.refCleanup=null)}else if(typeof v=="function")try{if(iu(a))try{Pl(),Ze(a,v,null)}finally{Jc(a)}else Ze(a,v,null)}catch(I){ls(a,h,I)}else v.current=null}function Th(a,h,v,S){var I=a.memoizedProps,k=I.id,K=I.onCommit;I=I.onRender,h=h===null?"mount":"update",Wy&&(h="nested-update"),typeof I=="function"&&I(k,h,a.actualDuration,a.treeBaseDuration,a.actualStartTime,v),typeof K=="function"&&K(a.memoizedProps.id,h,S,v)}function ha(a,h,v,S){var I=a.memoizedProps;a=I.id,I=I.onPostCommit,h=h===null?"mount":"update",Wy&&(h="nested-update"),typeof I=="function"&&I(a,h,S,v)}function Yx(a){var h=a.type,v=a.memoizedProps,S=a.stateNode;try{Ze(a,li,S,h,v,a)}catch(I){ls(a,a.return,I)}}function Df(a,h,v){try{Ze(a,mi,a.stateNode,a.type,v,h,a)}catch(S){ls(a,a.return,S)}}function wr(a){return a.tag===5||a.tag===3||a.tag===26||a.tag===27&&Wi(a.type)||a.tag===4}function Oi(a){e:for(;;){for(;a.sibling===null;){if(a.return===null||wr(a.return))return null;a=a.return}for(a.sibling.return=a.return,a=a.sibling;a.tag!==5&&a.tag!==6&&a.tag!==18;){if(a.tag===27&&Wi(a.type)||a.flags&2||a.child===null||a.tag===4)continue e;a.child.return=a,a=a.child}if(!(a.flags&2))return a.stateNode}}function bg(a,h,v){var S=a.tag;if(S===5||S===6)a=a.stateNode,h?(v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v).insertBefore(a,h):(h=v.nodeType===9?v.body:v.nodeName==="HTML"?v.ownerDocument.body:v,h.appendChild(a),v=v._reactRootContainer,v!=null||h.onclick!==null||(h.onclick=ot));else if(S!==4&&(S===27&&Wi(a.type)&&(v=a.stateNode,h=null),a=a.child,a!==null))for(bg(a,h,v),a=a.sibling;a!==null;)bg(a,h,v),a=a.sibling}function uc(a,h,v){var S=a.tag;if(S===5||S===6)a=a.stateNode,h?v.insertBefore(a,h):v.appendChild(a);else if(S!==4&&(S===27&&Wi(a.type)&&(v=a.stateNode),a=a.child,a!==null))for(uc(a,h,v),a=a.sibling;a!==null;)uc(a,h,v),a=a.sibling}function xg(a){for(var h,v=a.return;v!==null;){if(wr(v)){h=v;break}v=v.return}if(h==null)throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");switch(h.tag){case 27:h=h.stateNode,v=Oi(a),uc(a,v,h);break;case 5:v=h.stateNode,h.flags&32&&(yr(v),h.flags&=-33),h=Oi(a),uc(a,h,v);break;case 3:case 4:h=h.stateNode.containerInfo,v=Oi(a),bg(a,v,h);break;default:throw Error("Invalid host parent fiber. This error is likely caused by a bug in React. Please file an issue.")}}function Rf(a){var h=a.stateNode,v=a.memoizedProps;try{Ze(a,bd,a.type,v,h,a)}catch(S){ls(a,a.return,S)}}function fd(a,h){if(a=a.containerInfo,hw=ae,a=sh(a),ic(a)){if("selectionStart"in a)var v={start:a.selectionStart,end:a.selectionEnd};else e:{v=(v=a.ownerDocument)&&v.defaultView||window;var S=v.getSelection&&v.getSelection();if(S&&S.rangeCount!==0){v=S.anchorNode;var I=S.anchorOffset,k=S.focusNode;S=S.focusOffset;try{v.nodeType,k.nodeType}catch{v=null;break e}var K=0,ee=-1,me=-1,De=0,it=0,yt=a,ct=null;t:for(;;){for(var ut;yt!==v||I!==0&&yt.nodeType!==3||(ee=K+I),yt!==k||S!==0&&yt.nodeType!==3||(me=K+S),yt.nodeType===3&&(K+=yt.nodeValue.length),(ut=yt.firstChild)!==null;)ct=yt,yt=ut;for(;;){if(yt===a)break t;if(ct===v&&++De===I&&(ee=K),ct===k&&++it===S&&(me=K),(ut=yt.nextSibling)!==null)break;yt=ct,ct=yt.parentNode}yt=ut}v=ee===-1||me===-1?null:{start:ee,end:me}}else v=null}v=v||{start:0,end:0}}else v=null;for(fp={focusedElem:a,selectionRange:v},ae=!1,Ao=h;Ao!==null;)if(h=Ao,a=h.child,(h.subtreeFlags&1024)!==0&&a!==null)a.return=h,Ao=a;else for(;Ao!==null;){switch(a=h=Ao,v=a.alternate,I=a.flags,a.tag){case 0:break;case 11:case 15:break;case 1:(I&1024)!==0&&v!==null&&Wx(a,v);break;case 3:if((I&1024)!==0){if(a=a.stateNode.containerInfo,v=a.nodeType,v===9)Fi(a);else if(v===1)switch(a.nodeName){case"HEAD":case"HTML":case"BODY":Fi(a);break;default:a.textContent=""}}break;case 5:case 26:case 27:case 6:case 4:case 17:break;default:if((I&1024)!==0)throw Error("This unit of work tag should not have side-effects. This error is likely caused by a bug in React. Please file an issue.")}if(a=h.sibling,a!==null){a.return=h.return,Ao=a;break}Ao=h.return}}function _y(a,h,v){var S=v.flags;switch(v.tag){case 0:case 11:case 15:pl(a,v),S&4&&V0(v,Ia|pu);break;case 1:if(pl(a,v),S&4)if(a=v.stateNode,h===null)v.type.defaultProps||"ref"in v.memoizedProps||rp||(a.props!==v.memoizedProps&&console.error("Expected %s props to match memoized props before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",Te(v)||"instance"),a.state!==v.memoizedState&&console.error("Expected %s state to match memoized state before componentDidMount. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",Te(v)||"instance")),iu(v)?(Pl(),Ze(v,Cb,v,a),Jc()):Ze(v,Cb,v,a);else{var I=Xa(v.type,h.memoizedProps);h=h.memoizedState,v.type.defaultProps||"ref"in v.memoizedProps||rp||(a.props!==v.memoizedProps&&console.error("Expected %s props to match memoized props before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.props`. Please file an issue.",Te(v)||"instance"),a.state!==v.memoizedState&&console.error("Expected %s state to match memoized state before componentDidUpdate. This might either be because of a bug in React, or because a component reassigns its own `this.state`. Please file an issue.",Te(v)||"instance")),iu(v)?(Pl(),Ze(v,vE,v,a,I,h,a.__reactInternalSnapshotBeforeUpdate),Jc()):Ze(v,vE,v,a,I,h,a.__reactInternalSnapshotBeforeUpdate)}S&64&&gy(v),S&512&&ru(v,v.return);break;case 3:if(h=uh(),pl(a,v),S&64&&(S=v.updateQueue,S!==null)){if(I=null,v.child!==null)switch(v.child.tag){case 27:case 5:I=v.child.stateNode;break;case 1:I=v.child.stateNode}try{Ze(v,Bx,S,I)}catch(K){ls(v,v.return,K)}}a.effectDuration+=F_(h);break;case 27:h===null&&S&4&&Rf(v);case 26:case 5:pl(a,v),h===null&&S&4&&Yx(v),S&512&&ru(v,v.return);break;case 12:if(S&4){S=uh(),pl(a,v),a=v.stateNode,a.effectDuration+=Dp(S);try{Ze(v,Th,v,h,xb,a.effectDuration)}catch(K){ls(v,v.return,K)}}else pl(a,v);break;case 13:pl(a,v),S&4&&su(a,v),S&64&&(a=v.memoizedState,a!==null&&(a=a.dehydrated,a!==null&&(v=Og.bind(null,v),Vi(a,v))));break;case 22:if(S=v.memoizedState!==null||Hd,!S){h=h!==null&&h.memoizedState!==null||$s,I=Hd;var k=$s;Hd=S,($s=h)&&!k?ou(a,v,(v.subtreeFlags&8772)!==0):pl(a,v),Hd=I,$s=k}break;case 30:break;default:pl(a,v)}}function wg(a){var h=a.alternate;h!==null&&(a.alternate=null,wg(h)),a.child=null,a.deletions=null,a.sibling=null,a.tag===5&&(h=a.stateNode,h!==null&&Ns(h)),a.stateNode=null,a._debugOwner=null,a.return=null,a.dependencies=null,a.memoizedProps=null,a.memoizedState=null,a.pendingProps=null,a.stateNode=null,a.updateQueue=null}function fl(a,h,v){for(v=v.child;v!==null;)yy(a,h,v),v=v.sibling}function yy(a,h,v){if(Ra&&typeof Ra.onCommitFiberUnmount=="function")try{Ra.onCommitFiberUnmount(Ad,v)}catch(k){Cd||(Cd=!0,console.error("React instrumentation encountered an error: %s",k))}switch(v.tag){case 26:$s||cc(v,h),fl(a,h,v),v.memoizedState?v.memoizedState.count--:v.stateNode&&(v=v.stateNode,v.parentNode.removeChild(v));break;case 27:$s||cc(v,h);var S=yo,I=wl;Wi(v.type)&&(yo=v.stateNode,wl=!1),fl(a,h,v),Ze(v,Oh,v.stateNode),yo=S,wl=I;break;case 5:$s||cc(v,h);case 6:if(S=yo,I=wl,yo=null,fl(a,h,v),yo=S,wl=I,yo!==null)if(wl)try{Ze(v,Zr,yo,v.stateNode)}catch(k){ls(v,h,k)}else try{Ze(v,ji,yo,v.stateNode)}catch(k){ls(v,h,k)}break;case 18:yo!==null&&(wl?(a=yo,Ci(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a,v.stateNode),Mg(a)):Ci(yo,v.stateNode));break;case 4:S=yo,I=wl,yo=v.stateNode.containerInfo,wl=!0,fl(a,h,v),yo=S,wl=I;break;case 0:case 11:case 14:case 15:$s||Fp(Ul,v,h),$s||dd(v,h,Ia),fl(a,h,v);break;case 1:$s||(cc(v,h),S=v.stateNode,typeof S.componentWillUnmount=="function"&&yg(v,h,S)),fl(a,h,v);break;case 21:fl(a,h,v);break;case 22:$s=(S=$s)||v.memoizedState!==null,fl(a,h,v),$s=S;break;default:fl(a,h,v)}}function su(a,h){if(h.memoizedState===null&&(a=h.alternate,a!==null&&(a=a.memoizedState,a!==null&&(a=a.dehydrated,a!==null))))try{Ze(h,vd,a)}catch(v){ls(h,h.return,v)}}function pd(a){switch(a.tag){case 13:case 19:var h=a.stateNode;return h===null&&(h=a.stateNode=new LE),h;case 22:return a=a.stateNode,h=a._retryCache,h===null&&(h=a._retryCache=new LE),h;default:throw Error("Unexpected Suspense handler tag ("+a.tag+"). This is a bug in React.")}}function Of(a,h){var v=pd(a);h.forEach(function(S){var I=qp.bind(null,a,S);if(!v.has(S)){if(v.add(S),Nu)if(lv!==null&&_m!==null)_(_m,lv);else throw Error("Expected finished root and lanes to be set. This is a bug in React.");S.then(I,I)}})}function Sa(a,h){var v=h.deletions;if(v!==null)for(var S=0;S<v.length;S++){var I=a,k=h,K=v[S],ee=k;e:for(;ee!==null;){switch(ee.tag){case 27:if(Wi(ee.type)){yo=ee.stateNode,wl=!1;break e}break;case 5:yo=ee.stateNode,wl=!1;break e;case 3:case 4:yo=ee.stateNode.containerInfo,wl=!0;break e}ee=ee.return}if(yo===null)throw Error("Expected to find a host parent. This error is likely caused by a bug in React. Please file an issue.");yy(I,k,K),yo=null,wl=!1,I=K,k=I.alternate,k!==null&&(k.return=null),I.return=null}if(h.subtreeFlags&13878)for(h=h.child;h!==null;)If(h,a),h=h.sibling}function If(a,h){var v=a.alternate,S=a.flags;switch(a.tag){case 0:case 11:case 14:case 15:Sa(h,a),qo(a),S&4&&(Fp(Ul|pu,a,a.return),_g(Ul|pu,a),dd(a,a.return,Ia|pu));break;case 1:Sa(h,a),qo(a),S&512&&($s||v===null||cc(v,v.return)),S&64&&Hd&&(a=a.updateQueue,a!==null&&(S=a.callbacks,S!==null&&(v=a.shared.hiddenCallbacks,a.shared.hiddenCallbacks=v===null?S:v.concat(S))));break;case 26:var I=Tl;if(Sa(h,a),qo(a),S&512&&($s||v===null||cc(v,v.return)),S&4)if(h=v!==null?v.memoizedState:null,S=a.memoizedState,v===null)if(S===null)if(a.stateNode===null){e:{S=a.type,v=a.memoizedProps,h=I.ownerDocument||I;t:switch(S){case"title":I=h.getElementsByTagName("title")[0],(!I||I[Ny]||I[_l]||I.namespaceURI===Bg||I.hasAttribute("itemprop"))&&(I=h.createElement(S),h.head.insertBefore(I,h.querySelector("head > title"))),Nt(I,S,v),I[_l]=a,xt(I),S=I;break e;case"link":var k=RT("link","href",h).get(S+(v.href||""));if(k){for(var K=0;K<k.length;K++)if(I=k[K],I.getAttribute("href")===(v.href==null||v.href===""?null:v.href)&&I.getAttribute("rel")===(v.rel==null?null:v.rel)&&I.getAttribute("title")===(v.title==null?null:v.title)&&I.getAttribute("crossorigin")===(v.crossOrigin==null?null:v.crossOrigin)){k.splice(K,1);break t}}I=h.createElement(S),Nt(I,S,v),h.head.appendChild(I);break;case"meta":if(k=RT("meta","content",h).get(S+(v.content||""))){for(K=0;K<k.length;K++)if(I=k[K],Ut(v.content,"content"),I.getAttribute("content")===(v.content==null?null:""+v.content)&&I.getAttribute("name")===(v.name==null?null:v.name)&&I.getAttribute("property")===(v.property==null?null:v.property)&&I.getAttribute("http-equiv")===(v.httpEquiv==null?null:v.httpEquiv)&&I.getAttribute("charset")===(v.charSet==null?null:v.charSet)){k.splice(K,1);break t}}I=h.createElement(S),Nt(I,S,v),h.head.appendChild(I);break;default:throw Error('getNodesForType encountered a type it did not expect: "'+S+'". This is a bug in React.')}I[_l]=a,xt(I),S=I}a.stateNode=S}else OT(I,a.type,a.stateNode);else a.stateNode=Kx(I,S,a.memoizedProps);else h!==S?(h===null?v.stateNode!==null&&(v=v.stateNode,v.parentNode.removeChild(v)):h.count--,S===null?OT(I,a.type,a.stateNode):Kx(I,S,a.memoizedProps)):S===null&&a.stateNode!==null&&Df(a,a.memoizedProps,v.memoizedProps);break;case 27:Sa(h,a),qo(a),S&512&&($s||v===null||cc(v,v.return)),v!==null&&S&4&&Df(a,a.memoizedProps,v.memoizedProps);break;case 5:if(Sa(h,a),qo(a),S&512&&($s||v===null||cc(v,v.return)),a.flags&32){h=a.stateNode;try{Ze(a,yr,h)}catch(it){ls(a,a.return,it)}}S&4&&a.stateNode!=null&&(h=a.memoizedProps,Df(a,h,v!==null?v.memoizedProps:h)),S&1024&&(gm=!0,a.type!=="form"&&console.error("Unexpected host component type. Expected a form. This is a bug in React."));break;case 6:if(Sa(h,a),qo(a),S&4){if(a.stateNode===null)throw Error("This should have a text node initialized. This error is likely caused by a bug in React. Please file an issue.");S=a.memoizedProps,v=v!==null?v.memoizedProps:S,h=a.stateNode;try{Ze(a,Us,h,v,S)}catch(it){ls(a,a.return,it)}}break;case 3:if(I=uh(),wv=null,k=Tl,Tl=Wp(h.containerInfo),Sa(h,a),Tl=k,qo(a),S&4&&v!==null&&v.memoizedState.isDehydrated)try{Ze(a,Qa,h.containerInfo)}catch(it){ls(a,a.return,it)}gm&&(gm=!1,Eo(a)),h.effectDuration+=F_(I);break;case 4:S=Tl,Tl=Wp(a.stateNode.containerInfo),Sa(h,a),qo(a),Tl=S;break;case 12:S=uh(),Sa(h,a),qo(a),a.stateNode.effectDuration+=Dp(S);break;case 13:Sa(h,a),qo(a),a.child.flags&8192&&a.memoizedState!==null!=(v!==null&&v.memoizedState!==null)&&(n_=Sd()),S&4&&(S=a.updateQueue,S!==null&&(a.updateQueue=null,Of(a,S)));break;case 22:I=a.memoizedState!==null;var ee=v!==null&&v.memoizedState!==null,me=Hd,De=$s;if(Hd=me||I,$s=De||ee,Sa(h,a),$s=De,Hd=me,qo(a),S&8192)e:for(h=a.stateNode,h._visibility=I?h._visibility&~O1:h._visibility|O1,I&&(v===null||ee||Hd||$s||Sh(a)),v=null,h=a;;){if(h.tag===5||h.tag===26){if(v===null){ee=v=h;try{k=ee.stateNode,I?Ze(ee,As,k):Ze(ee,mr,ee.stateNode,ee.memoizedProps)}catch(it){ls(ee,ee.return,it)}}}else if(h.tag===6){if(v===null){ee=h;try{K=ee.stateNode,I?Ze(ee,Tr,K):Ze(ee,Er,K,ee.memoizedProps)}catch(it){ls(ee,ee.return,it)}}}else if((h.tag!==22&&h.tag!==23||h.memoizedState===null||h===a)&&h.child!==null){h.child.return=h,h=h.child;continue}if(h===a)break e;for(;h.sibling===null;){if(h.return===null||h.return===a)break e;v===h&&(v=null),h=h.return}v===h&&(v=null),h.sibling.return=h.return,h=h.sibling}S&4&&(S=a.updateQueue,S!==null&&(v=S.retryQueue,v!==null&&(S.retryQueue=null,Of(a,v))));break;case 19:Sa(h,a),qo(a),S&4&&(S=a.updateQueue,S!==null&&(a.updateQueue=null,Of(a,S)));break;case 30:break;case 21:break;default:Sa(h,a),qo(a)}}function qo(a){var h=a.flags;if(h&2){try{Ze(a,xg,a)}catch(v){ls(a,a.return,v)}a.flags&=-3}h&4096&&(a.flags&=-4097)}function Eo(a){if(a.subtreeFlags&1024)for(a=a.child;a!==null;){var h=a;Eo(h),h.tag===5&&h.flags&1024&&h.stateNode.reset(),a=a.sibling}}function pl(a,h){if(h.subtreeFlags&8772)for(h=h.child;h!==null;)_y(a,h.alternate,h),h=h.sibling}function Eh(a){switch(a.tag){case 0:case 11:case 14:case 15:dd(a,a.return,Ia),Sh(a);break;case 1:cc(a,a.return);var h=a.stateNode;typeof h.componentWillUnmount=="function"&&yg(a,a.return,h),Sh(a);break;case 27:Ze(a,Oh,a.stateNode);case 26:case 5:cc(a,a.return),Sh(a);break;case 22:a.memoizedState===null&&Sh(a);break;case 30:Sh(a);break;default:Sh(a)}}function Sh(a){for(a=a.child;a!==null;)Eh(a),a=a.sibling}function Tg(a,h,v,S){var I=v.flags;switch(v.tag){case 0:case 11:case 15:ou(a,v,S),V0(v,Ia);break;case 1:if(ou(a,v,S),h=v.stateNode,typeof h.componentDidMount=="function"&&Ze(v,Cb,v,h),h=v.updateQueue,h!==null){a=v.stateNode;try{Ze(v,Ip,h,a)}catch(k){ls(v,v.return,k)}}S&&I&64&&gy(v),ru(v,v.return);break;case 27:Rf(v);case 26:case 5:ou(a,v,S),S&&h===null&&I&4&&Yx(v),ru(v,v.return);break;case 12:if(S&&I&4){I=uh(),ou(a,v,S),S=v.stateNode,S.effectDuration+=Dp(I);try{Ze(v,Th,v,h,xb,S.effectDuration)}catch(k){ls(v,v.return,k)}}else ou(a,v,S);break;case 13:ou(a,v,S),S&&I&4&&su(a,v);break;case 22:v.memoizedState===null&&ou(a,v,S),ru(v,v.return);break;case 30:break;default:ou(a,v,S)}}function ou(a,h,v){for(v=v&&(h.subtreeFlags&8772)!==0,h=h.child;h!==null;)Tg(a,h.alternate,h,v),h=h.sibling}function Mf(a,h){var v=null;a!==null&&a.memoizedState!==null&&a.memoizedState.cachePool!==null&&(v=a.memoizedState.cachePool.pool),a=null,h.memoizedState!==null&&h.memoizedState.cachePool!==null&&(a=h.memoizedState.cachePool.pool),a!==v&&(a!=null&&ch(a),v!=null&&Ml(v))}function mo(a,h){a=null,h.alternate!==null&&(a=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==a&&(ch(h),a!=null&&Ml(a))}function ml(a,h,v,S){if(h.subtreeFlags&10256)for(h=h.child;h!==null;)vy(a,h,v,S),h=h.sibling}function vy(a,h,v,S){var I=h.flags;switch(h.tag){case 0:case 11:case 15:ml(a,h,v,S),I&2048&&U0(h,fa|pu);break;case 1:ml(a,h,v,S);break;case 3:var k=uh();ml(a,h,v,S),I&2048&&(v=null,h.alternate!==null&&(v=h.alternate.memoizedState.cache),h=h.memoizedState.cache,h!==v&&(ch(h),v!=null&&Ml(v))),a.passiveEffectDuration+=F_(k);break;case 12:if(I&2048){I=uh(),ml(a,h,v,S),a=h.stateNode,a.passiveEffectDuration+=Dp(I);try{Ze(h,ha,h,h.alternate,xb,a.passiveEffectDuration)}catch(ee){ls(h,h.return,ee)}}else ml(a,h,v,S);break;case 13:ml(a,h,v,S);break;case 23:break;case 22:k=h.stateNode;var K=h.alternate;h.memoizedState!==null?k._visibility&xs?ml(a,h,v,S):Ch(a,h):k._visibility&xs?ml(a,h,v,S):(k._visibility|=xs,md(a,h,v,S,(h.subtreeFlags&10256)!==0)),I&2048&&Mf(K,h);break;case 24:ml(a,h,v,S),I&2048&&mo(h.alternate,h);break;default:ml(a,h,v,S)}}function md(a,h,v,S,I){for(I=I&&(h.subtreeFlags&10256)!==0,h=h.child;h!==null;)Ah(a,h,v,S,I),h=h.sibling}function Ah(a,h,v,S,I){var k=h.flags;switch(h.tag){case 0:case 11:case 15:md(a,h,v,S,I),U0(h,fa);break;case 23:break;case 22:var K=h.stateNode;h.memoizedState!==null?K._visibility&xs?md(a,h,v,S,I):Ch(a,h):(K._visibility|=xs,md(a,h,v,S,I)),I&&k&2048&&Mf(h.alternate,h);break;case 24:md(a,h,v,S,I),I&&k&2048&&mo(h.alternate,h);break;default:md(a,h,v,S,I)}}function Ch(a,h){if(h.subtreeFlags&10256)for(h=h.child;h!==null;){var v=a,S=h,I=S.flags;switch(S.tag){case 22:Ch(v,S),I&2048&&Mf(S.alternate,S);break;case 24:Ch(v,S),I&2048&&mo(S.alternate,S);break;default:Ch(v,S)}h=h.sibling}}function gd(a){if(a.subtreeFlags&Xg)for(a=a.child;a!==null;)Eg(a),a=a.sibling}function Eg(a){switch(a.tag){case 26:gd(a),a.flags&Xg&&a.memoizedState!==null&&oC(Tl,a.memoizedState,a.memoizedProps);break;case 5:gd(a);break;case 3:case 4:var h=Tl;Tl=Wp(a.stateNode.containerInfo),gd(a),Tl=h;break;case 22:a.memoizedState===null&&(h=a.alternate,h!==null&&h.memoizedState!==null?(h=Xg,Xg=16777216,gd(a),Xg=h):gd(a));break;default:gd(a)}}function _d(a){var h=a.alternate;if(h!==null&&(a=h.child,a!==null)){h.child=null;do h=a.sibling,a.sibling=null,a=h;while(a!==null)}}function Pf(a){var h=a.deletions;if((a.flags&16)!==0){if(h!==null)for(var v=0;v<h.length;v++){var S=h[v];Ao=S,by(S,a)}_d(a)}if(a.subtreeFlags&10256)for(a=a.child;a!==null;)Up(a),a=a.sibling}function Up(a){switch(a.tag){case 0:case 11:case 15:Pf(a),a.flags&2048&&Vp(a,a.return,fa|pu);break;case 3:var h=uh();Pf(a),a.stateNode.passiveEffectDuration+=F_(h);break;case 12:h=uh(),Pf(a),a.stateNode.passiveEffectDuration+=Dp(h);break;case 22:h=a.stateNode,a.memoizedState!==null&&h._visibility&xs&&(a.return===null||a.return.tag!==13)?(h._visibility&=~xs,Dh(a)):Pf(a);break;default:Pf(a)}}function Dh(a){var h=a.deletions;if((a.flags&16)!==0){if(h!==null)for(var v=0;v<h.length;v++){var S=h[v];Ao=S,by(S,a)}_d(a)}for(a=a.child;a!==null;)jp(a),a=a.sibling}function jp(a){switch(a.tag){case 0:case 11:case 15:Vp(a,a.return,fa),Dh(a);break;case 22:var h=a.stateNode;h._visibility&xs&&(h._visibility&=~xs,Dh(a));break;default:Dh(a)}}function by(a,h){for(;Ao!==null;){var v=Ao,S=v;switch(S.tag){case 0:case 11:case 15:Vp(S,h,fa);break;case 23:case 22:S.memoizedState!==null&&S.memoizedState.cachePool!==null&&(S=S.memoizedState.cachePool.pool,S!=null&&ch(S));break;case 24:Ml(S.memoizedState.cache)}if(S=v.child,S!==null)S.return=v,Ao=S;else e:for(v=a;Ao!==null;){S=Ao;var I=S.sibling,k=S.return;if(wg(S),S===v){Ao=null;break e}if(I!==null){I.return=k,Ao=I;break e}Ao=k}}}function xy(){RD.forEach(function(a){return a()})}function H0(){var a=typeof IS_REACT_ACT_ENVIRONMENT<"u"?IS_REACT_ACT_ENVIRONMENT:void 0;return a||Jt.actQueue===null||console.error("The current testing environment is not configured to support act(...)"),a}function Aa(a){if((ns&Pa)!==Sc&&ur!==0)return ur&-ur;var h=Jt.T;return h!==null?(h._updatedFibers||(h._updatedFibers=new Set),h._updatedFibers.add(a),a=um,a!==0?a:W()):Or()}function $0(){yu===0&&(yu=(ur&536870912)===0||qr?ti():536870912);var a=gu.current;return a!==null&&(a.flags|=32),yu}function oo(a,h,v){if(_v&&console.error("useInsertionEffect must not schedule updates."),GE&&(rw=!0),(a===ws&&(Ts===ym||Ts===e_)||a.cancelPendingCommit!==null)&&(Nf(a,0),Rh(a,ur,yu,!1)),ks(a,v),(ns&Pa)!==0&&a===ws){if(Lh)switch(h.tag){case 0:case 11:case 15:a=Sr&&Te(Sr)||"Unknown",FD.has(a)||(FD.add(a),h=Te(h)||"Unknown",console.error("Cannot update a component (`%s`) while rendering a different component (`%s`). To locate the bad setState() call inside `%s`, follow the stack trace as described in https://react.dev/link/setstate-in-render",h,a,a));break;case 1:BD||(console.error("Cannot update during an existing state transition (such as within `render`). Render methods should be a pure function of props and state."),BD=!0)}}else Nu&&Po(a,h,v),f(h),a===ws&&((ns&Pa)===Sc&&(op|=v),Co===Jg&&Rh(a,ur,yu,!1)),y(a)}function G0(a,h,v){if((ns&(Pa|Hl))!==Sc)throw Error("Should not already be working.");var S=!v&&(h&124)===0&&(h&a.expiredLanes)===0||ss(a,h),I=S?Xx(a,h):Hp(a,h,!0),k=S;do{if(I===sp){fv&&!S&&Rh(a,h,0,!1);break}else{if(v=a.current.alternate,k&&!W0(v)){I=Hp(a,h,!1),k=!1;continue}if(I===Kg){if(k=h,a.errorRecoveryDisabledLanes&k)var K=0;else K=a.pendingLanes&-536870913,K=K!==0?K:K&536870912?536870912:0;if(K!==0){h=K;e:{I=a;var ee=K;K=Fb;var me=I.current.memoizedState.isDehydrated;if(me&&(Nf(I,ee).flags|=256),ee=Hp(I,ee,!1),ee!==Kg){if(FE&&!me){I.errorRecoveryDisabledLanes|=k,op|=k,I=Jg;break e}I=Gl,Gl=K,I!==null&&(Gl===null?Gl=I:Gl.push.apply(Gl,I))}I=ee}if(k=!1,I!==Kg)continue}}if(I===Nb){Nf(a,0),Rh(a,h,0,!0);break}e:{switch(S=a,I){case sp:case Nb:throw Error("Root did not complete. This is a bug in React.");case Jg:if((h&4194048)!==h)break;case uv:Rh(S,h,yu,!vm);break e;case Kg:Gl=null;break;case zE:case ew:break;default:throw Error("Unknown root exit status.")}if(Jt.actQueue!==null)au(S,v,h,Gl,mv,ap,yu,op,t_);else{if((h&62914560)===h&&(k=n_+MD-Sd(),10<k)){if(Rh(S,h,yu,!vm),jr(S,0,!0)!==0)break e;S.timeoutHandle=tS(q0.bind(null,S,v,Gl,mv,ap,h,yu,op,t_,vm,I,ND,pE,0),k);break e}q0(S,v,Gl,mv,ap,h,yu,op,t_,vm,I,PD,pE,0)}}}break}while(!0);y(a)}function q0(a,h,v,S,I,k,K,ee,me,De,it,yt,ct,ut){if(a.timeoutHandle=s_,yt=h.subtreeFlags,(yt&8192||(yt&16785408)===16785408)&&(Tv={stylesheets:null,count:0,unsuspend:Ig},Eg(h),yt=Da(),yt!==null)){a.cancelPendingCommit=yt(au.bind(null,a,h,k,v,S,I,K,ee,me,it,kD,ct,ut)),Rh(a,k,K,!De);return}au(a,h,k,v,S,I,K,ee,me)}function W0(a){for(var h=a;;){var v=h.tag;if((v===0||v===11||v===15)&&h.flags&16384&&(v=h.updateQueue,v!==null&&(v=v.stores,v!==null)))for(var S=0;S<v.length;S++){var I=v[S],k=I.getSnapshot;I=I.value;try{if(!vl(k(),I))return!1}catch{return!1}}if(v=h.child,h.subtreeFlags&16384&&v!==null)v.return=h,h=v;else{if(h===a)break;for(;h.sibling===null;){if(h.return===null||h.return===a)return!0;h=h.return}h.sibling.return=h.return,h=h.sibling}}return!0}function Rh(a,h,v,S){h&=~VE,h&=~op,a.suspendedLanes|=h,a.pingedLanes&=~h,S&&(a.warmLanes|=h),S=a.expirationTimes;for(var I=h;0<I;){var k=31-Ja(I),K=1<<k;S[k]=-1,I&=~K}v!==0&&Uo(a,v,h)}function kf(){return(ns&(Pa|Hl))===Sc?(w(0),!1):!0}function wy(){if(Sr!==null){if(Ts===$l)var a=Sr.return;else a=Sr,Ap(),rg(a),mm=null,Yg=0,a=Sr;for(;a!==null;)my(a.alternate,a),a=a.return;Sr=null}}function Nf(a,h){var v=a.timeoutHandle;v!==s_&&(a.timeoutHandle=s_,WM(v)),v=a.cancelPendingCommit,v!==null&&(a.cancelPendingCommit=null,v()),wy(),ws=a,Sr=v=xe(a.current,null),ur=h,Ts=$l,El=null,vm=!1,fv=ss(a,h),FE=!1,Co=sp,t_=yu=VE=op=bm=0,Gl=Fb=null,ap=!1,(h&8)!==0&&(h|=h&32);var S=a.entangledLanes;if(S!==0)for(a=a.entanglements,S&=h;0<S;){var I=31-Ja(S),k=1<<I;h|=a[I],S&=~k}return _u=h,Di(),h=fE(),1e3<h-dE&&(Jt.recentlyCreatedOwnerStacks=0,dE=h),il.discardPendingWarnings(),v}function Y0(a,h){Qi=null,Jt.H=j1,Jt.getCurrentStack=null,Lh=!1,hu=null,h===Bd||h===Qy?(h=ng(),Ts=zb):h===gD?(h=ng(),Ts=ID):Ts=h===SD?dv:h!==null&&typeof h=="object"&&typeof h.then=="function"?hv:Lb,El=h;var v=Sr;if(v===null)Co=Nb,tu(a,gi(h,a.current));else switch(v.mode&el&&hh(v),Cn(),Ts){case Lb:ei!==null&&typeof ei.markComponentErrored=="function"&&ei.markComponentErrored(v,h,ur);break;case ym:case e_:case zb:case hv:case Bb:ei!==null&&typeof ei.markComponentSuspended=="function"&&ei.markComponentSuspended(v,h,ur)}}function Z0(){var a=Jt.H;return Jt.H=j1,a===null?j1:a}function Zx(){var a=Jt.A;return Jt.A=Qg,a}function X0(){Co=Jg,vm||(ur&4194048)!==ur&&gu.current!==null||(fv=!0),(bm&134217727)===0&&(op&134217727)===0||ws===null||Rh(ws,ur,yu,!1)}function Hp(a,h,v){var S=ns;ns|=Pa;var I=Z0(),k=Zx();if(ws!==a||ur!==h){if(Nu){var K=a.memoizedUpdaters;0<K.size&&(_(a,ur),K.clear()),ro(a,h)}mv=null,Nf(a,h)}Kn(h),h=!1,K=Co;e:do try{if(Ts!==$l&&Sr!==null){var ee=Sr,me=El;switch(Ts){case dv:wy(),K=uv;break e;case zb:case ym:case e_:case hv:gu.current===null&&(h=!0);var De=Ts;if(Ts=$l,El=null,yd(a,ee,me,De),v&&fv){K=sp;break e}break;default:De=Ts,Ts=$l,El=null,yd(a,ee,me,De)}}Yr(),K=Co;break}catch(it){Y0(a,it)}while(!0);return h&&a.shellSuspendCounter++,Ap(),ns=S,Jt.H=I,Jt.A=k,Bt(),Sr===null&&(ws=null,ur=0,Di()),K}function Yr(){for(;Sr!==null;)Ey(Sr)}function Xx(a,h){var v=ns;ns|=Pa;var S=Z0(),I=Zx();if(ws!==a||ur!==h){if(Nu){var k=a.memoizedUpdaters;0<k.size&&(_(a,ur),k.clear()),ro(a,h)}mv=null,pv=Sd()+UE,Nf(a,h)}else fv=ss(a,h);Kn(h);e:do try{if(Ts!==$l&&Sr!==null)t:switch(h=Sr,k=El,Ts){case Lb:Ts=$l,El=null,yd(a,h,k,Lb);break;case ym:case e_:if(j_(k)){Ts=$l,El=null,Q0(h);break}h=function(){Ts!==ym&&Ts!==e_||ws!==a||(Ts=Bb),y(a)},k.then(h,h);break e;case zb:Ts=Bb;break e;case ID:Ts=BE;break e;case Bb:j_(k)?(Ts=$l,El=null,Q0(h)):(Ts=$l,El=null,yd(a,h,k,Bb));break;case BE:var K=null;switch(Sr.tag){case 26:K=Sr.memoizedState;case 5:case 27:var ee=Sr;if(!K||IT(K)){Ts=$l,El=null;var me=ee.sibling;if(me!==null)Sr=me;else{var De=ee.return;De!==null?(Sr=De,Lf(De)):Sr=null}break t}break;default:console.error("Unexpected type of fiber triggered a suspensey commit. This is a bug in React.")}Ts=$l,El=null,yd(a,h,k,BE);break;case hv:Ts=$l,El=null,yd(a,h,k,hv);break;case dv:wy(),Co=uv;break e;default:throw Error("Unexpected SuspendedReason. This is a bug in React.")}Jt.actQueue!==null?Yr():Ty();break}catch(it){Y0(a,it)}while(!0);return Ap(),Jt.H=S,Jt.A=I,ns=v,Sr!==null?(ei!==null&&typeof ei.markRenderYielded=="function"&&ei.markRenderYielded(),sp):(Bt(),ws=null,ur=0,Di(),Co)}function Ty(){for(;Sr!==null&&!_C();)Ey(Sr)}function Ey(a){var h=a.alternate;(a.mode&el)!==Hs?(V_(a),h=Ze(a,Gt,h,a,_u),hh(a)):h=Ze(a,Gt,h,a,_u),a.memoizedProps=a.pendingProps,h===null?Lf(a):Sr=h}function Q0(a){var h=Ze(a,Sg,a);a.memoizedProps=a.pendingProps,h===null?Lf(a):Sr=h}function Sg(a){var h=a.alternate,v=(a.mode&el)!==Hs;switch(v&&V_(a),a.tag){case 15:case 0:h=ua(h,a,a.pendingProps,a.type,void 0,ur);break;case 11:h=ua(h,a,a.pendingProps,a.type.render,a.ref,ur);break;case 5:rg(a);default:my(h,a),a=Sr=Ke(a,_u),h=Gt(h,a,_u)}return v&&hh(a),h}function yd(a,h,v,S){Ap(),rg(h),mm=null,Yg=0;var I=h.return;try{if(DT(a,I,h,v,ur)){Co=Nb,tu(a,gi(v,a.current)),Sr=null;return}}catch(k){if(I!==null)throw Sr=I,k;Co=Nb,tu(a,gi(v,a.current)),Sr=null;return}h.flags&32768?(qr||S===Lb?a=!0:fv||(ur&536870912)!==0?a=!1:(vm=a=!0,(S===ym||S===e_||S===zb||S===hv)&&(S=gu.current,S!==null&&S.tag===13&&(S.flags|=16384))),$p(h,a)):Lf(h)}function Lf(a){var h=a;do{if((h.flags&32768)!==0){$p(h,vm);return}var v=h.alternate;if(a=h.return,V_(h),v=Ze(h,fy,v,h,_u),(h.mode&el)!==Hs&&U_(h),v!==null){Sr=v;return}if(h=h.sibling,h!==null){Sr=h;return}Sr=h=a}while(h!==null);Co===sp&&(Co=ew)}function $p(a,h){do{var v=py(a.alternate,a);if(v!==null){v.flags&=32767,Sr=v;return}if((a.mode&el)!==Hs){U_(a),v=a.actualDuration;for(var S=a.child;S!==null;)v+=S.actualDuration,S=S.sibling;a.actualDuration=v}if(v=a.return,v!==null&&(v.flags|=32768,v.subtreeFlags=0,v.deletions=null),!h&&(a=a.sibling,a!==null)){Sr=a;return}Sr=a=v}while(a!==null);Co=uv,Sr=null}function au(a,h,v,S,I,k,K,ee,me){a.cancelPendingCommit=null;do Gp();while(Xo!==xm);if(il.flushLegacyContextWarning(),il.flushPendingUnsafeLifecycleWarnings(),(ns&(Pa|Hl))!==Sc)throw Error("Should not already be working.");if(ei!==null&&typeof ei.markCommitStarted=="function"&&ei.markCommitStarted(v),h===null)yn();else{if(v===0&&console.error("finishedLanes should not be empty during a commit. This is a bug in React."),h===a.current)throw Error("Cannot commit the same tree as before. This error is likely caused by a bug in React. Please file an issue.");if(k=h.lanes|h.childLanes,k|=cE,fs(a,v,k,K,ee,me),a===ws&&(Sr=ws=null,ur=0),r_=h,$d=a,cp=v,nw=k,iw=I,$E=S,(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0?(a.callbackNode=null,a.callbackPriority=0,o(Gf,function(){return Qx(),null})):(a.callbackNode=null,a.callbackPriority=0),xb=qy(),S=(h.flags&13878)!==0,(h.subtreeFlags&13878)!==0||S){S=Jt.T,Jt.T=null,I=us.p,us.p=Qs,K=ns,ns|=Hl;try{fd(a,h,v)}finally{ns=K,us.p=I,Jt.T=S}}Xo=jE,Ag(),bs(),lu()}}function Ag(){if(Xo===jE){Xo=xm;var a=$d,h=r_,v=cp,S=(h.flags&13878)!==0;if((h.subtreeFlags&13878)!==0||S){S=Jt.T,Jt.T=null;var I=us.p;us.p=Qs;var k=ns;ns|=Hl;try{lv=v,_m=a,If(h,a),_m=lv=null,v=fp;var K=sh(a.containerInfo),ee=v.focusedElem,me=v.selectionRange;if(K!==ee&&ee&&ee.ownerDocument&&Xc(ee.ownerDocument.documentElement,ee)){if(me!==null&&ic(ee)){var De=me.start,it=me.end;if(it===void 0&&(it=De),"selectionStart"in ee)ee.selectionStart=De,ee.selectionEnd=Math.min(it,ee.value.length);else{var yt=ee.ownerDocument||document,ct=yt&&yt.defaultView||window;if(ct.getSelection){var ut=ct.getSelection(),Ct=ee.textContent.length,mn=Math.min(me.start,Ct),tn=me.end===void 0?mn:Math.min(me.end,Ct);!ut.extend&&mn>tn&&(K=tn,tn=mn,mn=K);var Qt=$n(ee,mn),Je=$n(ee,tn);if(Qt&&Je&&(ut.rangeCount!==1||ut.anchorNode!==Qt.node||ut.anchorOffset!==Qt.offset||ut.focusNode!==Je.node||ut.focusOffset!==Je.offset)){var rt=yt.createRange();rt.setStart(Qt.node,Qt.offset),ut.removeAllRanges(),mn>tn?(ut.addRange(rt),ut.extend(Je.node,Je.offset)):(rt.setEnd(Je.node,Je.offset),ut.addRange(rt))}}}}for(yt=[],ut=ee;ut=ut.parentNode;)ut.nodeType===1&&yt.push({element:ut,left:ut.scrollLeft,top:ut.scrollTop});for(typeof ee.focus=="function"&&ee.focus(),ee=0;ee<yt.length;ee++){var lt=yt[ee];lt.element.scrollLeft=lt.left,lt.element.scrollTop=lt.top}}ae=!!hw,fp=hw=null}finally{ns=k,us.p=I,Jt.T=S}}a.current=h,Xo=HE}}function bs(){if(Xo===HE){Xo=xm;var a=$d,h=r_,v=cp,S=(h.flags&8772)!==0;if((h.subtreeFlags&8772)!==0||S){S=Jt.T,Jt.T=null;var I=us.p;us.p=Qs;var k=ns;ns|=Hl;try{ei!==null&&typeof ei.markLayoutEffectsStarted=="function"&&ei.markLayoutEffectsStarted(v),lv=v,_m=a,_y(a,h.alternate,h),_m=lv=null,ei!==null&&typeof ei.markLayoutEffectsStopped=="function"&&ei.markLayoutEffectsStopped()}finally{ns=k,us.p=I,Jt.T=S}}Xo=i_}}function lu(){if(Xo===LD||Xo===i_){Xo=xm,rb();var a=$d,h=r_,v=cp,S=$E,I=(h.subtreeFlags&10256)!==0||(h.flags&10256)!==0;I?Xo=tw:(Xo=xm,r_=$d=null,Dg(a,a.pendingLanes),qd=0,Vb=null);var k=a.pendingLanes;if(k===0&&(lp=null),I||Bl(a),I=jo(v),h=h.stateNode,Ra&&typeof Ra.onCommitFiberRoot=="function")try{var K=(h.current.flags&128)===128;switch(I){case Qs:var ee=Kp;break;case kh:ee=h1;break;case Rd:ee=Gf;break;case sb:ee=zg;break;default:ee=Gf}Ra.onCommitFiberRoot(Ad,h,ee,K)}catch(yt){Cd||(Cd=!0,console.error("React instrumentation encountered an error: %s",yt))}if(Nu&&a.memoizedUpdaters.clear(),xy(),S!==null){K=Jt.T,ee=us.p,us.p=Qs,Jt.T=null;try{var me=a.onRecoverableError;for(h=0;h<S.length;h++){var De=S[h],it=Cg(De.stack);Ze(De.source,me,De.value,it)}}finally{Jt.T=K,us.p=ee}}(cp&3)!==0&&Gp(),y(a),k=a.pendingLanes,(v&4194090)!==0&&(k&42)!==0?(wb=!0,a===Gd?gv++:(gv=0,Gd=a)):gv=0,w(0),yn()}}function Cg(a){return a={componentStack:a},Object.defineProperty(a,"digest",{get:function(){console.error('You are accessing "digest" from the errorInfo object passed to onRecoverableError. This property is no longer provided as part of errorInfo but can be accessed as a property of the Error instance itself.')}}),a}function Dg(a,h){(a.pooledCacheLanes&=h)===0&&(h=a.pooledCache,h!=null&&(a.pooledCache=null,Ml(h)))}function Gp(a){return Ag(),bs(),lu(),Qx()}function Qx(){if(Xo!==tw)return!1;var a=$d,h=nw;nw=0;var v=jo(cp),S=Rd>v?Rd:v;v=Jt.T;var I=us.p;try{us.p=S,Jt.T=null,S=iw,iw=null;var k=$d,K=cp;if(Xo=xm,r_=$d=null,cp=0,(ns&(Pa|Hl))!==Sc)throw Error("Cannot flush passive effects while already rendering.");GE=!0,rw=!1,ei!==null&&typeof ei.markPassiveEffectsStarted=="function"&&ei.markPassiveEffectsStarted(K);var ee=ns;if(ns|=Hl,Up(k.current),vy(k,k.current,K,S),ei!==null&&typeof ei.markPassiveEffectsStopped=="function"&&ei.markPassiveEffectsStopped(),Bl(k),ns=ee,w(0,!1),rw?k===Vb?qd++:(qd=0,Vb=k):qd=0,rw=GE=!1,Ra&&typeof Ra.onPostCommitFiberRoot=="function")try{Ra.onPostCommitFiberRoot(Ad,k)}catch(De){Cd||(Cd=!0,console.error("React instrumentation encountered an error: %s",De))}var me=k.current.stateNode;return me.effectDuration=0,me.passiveEffectDuration=0,!0}finally{us.p=I,Jt.T=v,Dg(a,h)}}function zf(a,h,v){h=gi(v,h),h=Fn(a.stateNode,h,2),a=oc(a,h,2),a!==null&&(ks(a,2),y(a))}function ls(a,h,v){if(_v=!1,a.tag===3)zf(a,a,v);else{for(;h!==null;){if(h.tag===3){zf(h,a,v);return}if(h.tag===1){var S=h.stateNode;if(typeof h.type.getDerivedStateFromError=="function"||typeof S.componentDidCatch=="function"&&(lp===null||!lp.has(S))){a=gi(v,a),v=Sf(2),S=oc(h,v,2),S!==null&&(k0(v,S,h,a),ks(S,2),y(S));return}}h=h.return}console.error(`Internal React error: Attempted to capture a commit phase error inside a detached tree. This indicates a bug in React. Potential causes include deleting the same fiber more than once, committing an already-finished tree, or an inconsistent return pointer.

Error message:

%s`,v)}}function hc(a,h,v){var S=a.pingCache;if(S===null){S=a.pingCache=new OD;var I=new Set;S.set(h,I)}else I=S.get(h),I===void 0&&(I=new Set,S.set(h,I));I.has(v)||(FE=!0,I.add(v),S=Rg.bind(null,a,h,v),Nu&&_(a,v),h.then(S,S))}function Rg(a,h,v){var S=a.pingCache;S!==null&&S.delete(h),a.pingedLanes|=a.suspendedLanes&v,a.warmLanes&=~v,H0()&&Jt.actQueue===null&&console.error(`A suspended resource finished loading inside a test, but the event was not wrapped in act(...).

When testing, code that resolves suspended data should be wrapped into act(...):

act(() => {
  /* finish loading suspended data */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act`),ws===a&&(ur&v)===v&&(Co===Jg||Co===zE&&(ur&62914560)===ur&&Sd()-n_<MD?(ns&Pa)===Sc&&Nf(a,0):VE|=v,t_===ur&&(t_=0)),y(a)}function Sy(a,h){h===0&&(h=dr()),a=fi(a,h),a!==null&&(ks(a,h),y(a))}function Og(a){var h=a.memoizedState,v=0;h!==null&&(v=h.retryLane),Sy(a,v)}function qp(a,h){var v=0;switch(a.tag){case 13:var S=a.stateNode,I=a.memoizedState;I!==null&&(v=I.retryLane);break;case 19:S=a.stateNode;break;case 22:S=a.stateNode._retryCache;break;default:throw Error("Pinged unknown suspense boundary type. This is probably a bug in React.")}S!==null&&S.delete(h),Sy(a,v)}function cu(a,h,v){if((h.subtreeFlags&67117056)!==0)for(h=h.child;h!==null;){var S=a,I=h,k=I.type===eb;k=v||k,I.tag!==22?I.flags&67108864?k&&Ze(I,dc,S,I,(I.mode&I1)===Hs):cu(S,I,k):I.memoizedState===null&&(k&&I.flags&8192?Ze(I,dc,S,I):I.subtreeFlags&67108864&&Ze(I,cu,S,I,k)),h=h.sibling}}function dc(a,h){var v=2<arguments.length&&arguments[2]!==void 0?arguments[2]:!0;Ht(!0);try{Eh(h),v&&jp(h),Tg(a,h.alternate,h,!1),v&&Ah(a,h,0,null,!1,0)}finally{Ht(!1)}}function Bl(a){var h=!0;a.current.mode&(tl|vc)||(h=!1),cu(a,a.current,h)}function Bf(a){if((ns&Pa)===Sc){var h=a.tag;if(h===3||h===1||h===0||h===11||h===14||h===15){if(h=Te(a)||"ReactComponent",sw!==null){if(sw.has(h))return;sw.add(h)}else sw=new Set([h]);Ze(a,function(){console.error("Can't perform a React state update on a component that hasn't mounted yet. This indicates that you have a side-effect in your render function that asynchronously later calls tries to update the component. Move this work to useEffect instead.")})}}}function _(a,h){Nu&&a.memoizedUpdaters.forEach(function(v){Po(a,v,h)})}function o(a,h){var v=Jt.actQueue;return v!==null?(v.push(h),UM):ib(a,h)}function f(a){H0()&&Jt.actQueue===null&&Ze(a,function(){console.error(`An update to %s inside a test was not wrapped in act(...).

When testing, code that causes React state updates should be wrapped into act(...):

act(() => {
  /* fire events that update state */
});
/* assert on the output */

This ensures that you're testing the behavior the user would see in the browser. Learn more at https://react.dev/link/wrap-tests-with-act`,Te(a))})}function y(a){a!==yv&&a.next===null&&(yv===null?ow=yv=a:yv=yv.next=a),aw=!0,Jt.actQueue!==null?WE||(WE=!0,Z()):qE||(qE=!0,Z())}function w(a,h){if(!ql&&aw){ql=!0;do for(var v=!1,S=ow;S!==null;){if(a!==0){var I=S.pendingLanes;if(I===0)var k=0;else{var K=S.suspendedLanes,ee=S.pingedLanes;k=(1<<31-Ja(42|a)+1)-1,k&=I&~(K&~ee),k=k&201326741?k&201326741|1:k?k|2:0}k!==0&&(v=!0,j(S,k))}else k=ur,k=jr(S,S===ws?k:0,S.cancelPendingCommit!==null||S.timeoutHandle!==s_),(k&3)===0||ss(S,k)||(v=!0,j(S,k));S=S.next}while(v);ql=!1}}function E(){C()}function C(){aw=WE=qE=!1;var a=0;Uh!==0&&(cs()&&(a=Uh),Uh=0);for(var h=Sd(),v=null,S=ow;S!==null;){var I=S.next,k=M(S,h);k===0?(S.next=null,v===null?ow=I:v.next=I,I===null&&(yv=v)):(v=S,(a!==0||(k&3)!==0)&&(aw=!0)),S=I}w(a)}function M(a,h){for(var v=a.suspendedLanes,S=a.pingedLanes,I=a.expirationTimes,k=a.pendingLanes&-62914561;0<k;){var K=31-Ja(k),ee=1<<K,me=I[K];me===-1?((ee&v)===0||(ee&S)!==0)&&(I[K]=Nr(ee,h)):me<=h&&(a.expiredLanes|=ee),k&=~ee}if(h=ws,v=ur,v=jr(a,a===h?v:0,a.cancelPendingCommit!==null||a.timeoutHandle!==s_),S=a.callbackNode,v===0||a===h&&(Ts===ym||Ts===e_)||a.cancelPendingCommit!==null)return S!==null&&H(S),a.callbackNode=null,a.callbackPriority=0;if((v&3)===0||ss(a,v)){if(h=v&-v,h!==a.callbackPriority||Jt.actQueue!==null&&S!==YE)H(S);else return h;switch(jo(v)){case Qs:case kh:v=h1;break;case Rd:v=Gf;break;case sb:v=zg;break;default:v=Gf}return S=N.bind(null,a),Jt.actQueue!==null?(Jt.actQueue.push(S),v=YE):v=ib(v,S),a.callbackPriority=h,a.callbackNode=v,h}return S!==null&&H(S),a.callbackPriority=2,a.callbackNode=null,2}function N(a,h){if(wb=Wy=!1,Xo!==xm&&Xo!==tw)return a.callbackNode=null,a.callbackPriority=0,null;var v=a.callbackNode;if(Gp()&&a.callbackNode!==v)return null;var S=ur;return S=jr(a,a===ws?S:0,a.cancelPendingCommit!==null||a.timeoutHandle!==s_),S===0?null:(G0(a,S,h),M(a,Sd()),a.callbackNode!=null&&a.callbackNode===v?N.bind(null,a):null)}function j(a,h){if(Gp())return null;Wy=wb,wb=!1,G0(a,h,!0)}function H(a){a!==YE&&a!==null&&TM(a)}function Z(){Jt.actQueue!==null&&Jt.actQueue.push(function(){return C(),null}),HD(function(){(ns&(Pa|Hl))!==Sc?ib(Kp,E):C()})}function W(){return Uh===0&&(Uh=ti()),Uh}function Q(a){return a==null||typeof a=="symbol"||typeof a=="boolean"?null:typeof a=="function"?a:(Ut(a,"action"),Gc(""+a))}function ce(a,h){var v=h.ownerDocument.createElement("input");return v.name=h.name,v.value=h.value,a.id&&v.setAttribute("form",a.id),h.parentNode.insertBefore(v,h),a=new FormData(a),v.parentNode.removeChild(v),a}function se(a,h,v,S,I){if(h==="submit"&&v&&v.stateNode===I){var k=Q((I[yc]||null).action),K=S.submitter;K&&(h=(h=K[yc]||null)?Q(h.formAction):K.getAttribute("formAction"),h!==null&&(k=h,K=null));var ee=new zy("action","action",null,S,I);a.push({event:ee,listeners:[{instance:null,listener:function(){if(S.defaultPrevented){if(Uh!==0){var me=K?ce(I,K):new FormData(I),De={pending:!0,data:me,method:I.method,action:k};Object.freeze(De),iy(v,De,null,me)}}else typeof k=="function"&&(ee.preventDefault(),me=K?ce(I,K):new FormData(I),De={pending:!0,data:me,method:I.method,action:k},Object.freeze(De),iy(v,De,k,me))},currentTarget:I}]})}}function ue(a,h,v){a.currentTarget=v;try{h(a)}catch(S){Z1(S)}a.currentTarget=null}function pe(a,h){h=(h&4)!==0;for(var v=0;v<a.length;v++){var S=a[v];e:{var I=void 0,k=S.event;if(S=S.listeners,h)for(var K=S.length-1;0<=K;K--){var ee=S[K],me=ee.instance,De=ee.currentTarget;if(ee=ee.listener,me!==I&&k.isPropagationStopped())break e;me!==null?Ze(me,ue,k,ee,De):ue(k,ee,De),I=me}else for(K=0;K<S.length;K++){if(ee=S[K],me=ee.instance,De=ee.currentTarget,ee=ee.listener,me!==I&&k.isPropagationStopped())break e;me!==null?Ze(me,ue,k,ee,De):ue(k,ee,De),I=me}}}}function ge(a,h){lw.has(a)||console.error('Did not expect a listenToNonDelegatedEvent() call for "%s". This is a bug in React. Please file an issue.',a);var v=h[p1];v===void 0&&(v=h[p1]=new Set);var S=a+"__bubble";v.has(S)||(Ye(h,a,2,!1),v.add(S))}function Pe(a,h,v){lw.has(a)&&!h&&console.error('Did not expect a listenToNativeEvent() call for "%s" in the bubble phase. This is a bug in React. Please file an issue.',a);var S=0;h&&(S|=4),Ye(v,a,S,h)}function Ve(a){if(!a[cw]){a[cw]=!0,jT.forEach(function(v){v!=="selectionchange"&&(lw.has(v)||Pe(v,!1,a),Pe(v,!0,a))});var h=a.nodeType===9?a:a.ownerDocument;h===null||h[cw]||(h[cw]=!0,Pe("selectionchange",!1,h))}}function Ye(a,h,v,S){switch(Oy(h)){case Qs:var I=jf;break;case kh:I=uC;break;default:I=n1}v=I.bind(null,h,v,a),I=void 0,!E1||h!=="touchstart"&&h!=="touchmove"&&h!=="wheel"||(I=!0),S?I!==void 0?a.addEventListener(h,v,{capture:!0,passive:I}):a.addEventListener(h,v,!0):I!==void 0?a.addEventListener(h,v,{passive:I}):a.addEventListener(h,v,!1)}function qe(a,h,v,S,I){var k=S;if((h&1)===0&&(h&2)===0&&S!==null)e:for(;;){if(S===null)return;var K=S.tag;if(K===3||K===4){var ee=S.stateNode.containerInfo;if(ee===I)break;if(K===4)for(K=S.return;K!==null;){var me=K.tag;if((me===3||me===4)&&K.stateNode.containerInfo===I)return;K=K.return}for(;ee!==null;){if(K=Hr(ee),K===null)return;if(me=K.tag,me===5||me===6||me===26||me===27){S=k=K;continue e}ee=ee.parentNode}}S=S.return}va(function(){var De=k,it=Si(v),yt=[];e:{var ct=aD.get(a);if(ct!==void 0){var ut=zy,Ct=a;switch(a){case"keypress":if(Ol(v)===0)break e;case"keydown":case"keyup":ut=GC;break;case"focusin":Ct="focus",ut=_b;break;case"focusout":Ct="blur",ut=_b;break;case"beforeblur":case"afterblur":ut=_b;break;case"click":if(v.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":ut=S1;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":ut=Fy;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":ut=IM;break;case aE:case rD:case sD:ut=HC;break;case oD:ut=XC;break;case"scroll":case"scrollend":ut=CM;break;case"wheel":ut=KC;break;case"copy":case"cut":case"paste":ut=DM;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":ut=WC;break;case"toggle":case"beforetoggle":ut=PM}var mn=(h&4)!==0,tn=!mn&&(a==="scroll"||a==="scrollend"),Qt=mn?ct!==null?ct+"Capture":null:ct;mn=[];for(var Je=De,rt;Je!==null;){var lt=Je;if(rt=lt.stateNode,lt=lt.tag,lt!==5&&lt!==26&&lt!==27||rt===null||Qt===null||(lt=qc(Je,Qt),lt!=null&&mn.push(je(Je,lt,rt))),tn)break;Je=Je.return}0<mn.length&&(ct=new ut(ct,Ct,null,v,it),yt.push({event:ct,listeners:mn}))}}if((h&7)===0){e:{if(ct=a==="mouseover"||a==="pointerover",ut=a==="mouseout"||a==="pointerout",ct&&v!==Yf&&(Ct=v.relatedTarget||v.fromElement)&&(Hr(Ct)||Ct[Od]))break e;if((ut||ct)&&(ct=it.window===it?it:(ct=it.ownerDocument)?ct.defaultView||ct.parentWindow:window,ut?(Ct=v.relatedTarget||v.toElement,ut=De,Ct=Ct?Hr(Ct):null,Ct!==null&&(tn=ie(Ct),mn=Ct.tag,Ct!==tn||mn!==5&&mn!==27&&mn!==6)&&(Ct=null)):(ut=null,Ct=De),ut!==Ct)){if(mn=S1,lt="onMouseLeave",Qt="onMouseEnter",Je="mouse",(a==="pointerout"||a==="pointerover")&&(mn=WC,lt="onPointerLeave",Qt="onPointerEnter",Je="pointer"),tn=ut==null?ct:ho(ut),rt=Ct==null?ct:ho(Ct),ct=new mn(lt,Je+"leave",ut,v,it),ct.target=tn,ct.relatedTarget=rt,lt=null,Hr(it)===De&&(mn=new mn(Qt,Je+"enter",Ct,v,it),mn.target=rt,mn.relatedTarget=tn,lt=mn),tn=lt,ut&&Ct)t:{for(mn=ut,Qt=Ct,Je=0,rt=mn;rt;rt=We(rt))Je++;for(rt=0,lt=Qt;lt;lt=We(lt))rt++;for(;0<Je-rt;)mn=We(mn),Je--;for(;0<rt-Je;)Qt=We(Qt),rt--;for(;Je--;){if(mn===Qt||Qt!==null&&mn===Qt.alternate)break t;mn=We(mn),Qt=We(Qt)}mn=null}else mn=null;ut!==null&&et(yt,ct,ut,mn,!1),Ct!==null&&tn!==null&&et(yt,tn,Ct,mn,!0)}}e:{if(ct=De?ho(De):window,ut=ct.nodeName&&ct.nodeName.toLowerCase(),ut==="select"||ut==="input"&&ct.type==="file")var kt=Wa;else if(qa(ct))if(sE)kt=Mi;else{kt=rh;var Zt=ih}else ut=ct.nodeName,!ut||ut.toLowerCase()!=="input"||ct.type!=="checkbox"&&ct.type!=="radio"?De&&Bs(De.elementType)&&(kt=Wa):kt=Zc;if(kt&&(kt=kt(a,De))){Wc(yt,kt,v,it);break e}Zt&&Zt(a,ct,De),a==="focusout"&&De&&ct.type==="number"&&De.memoizedProps.value!=null&&Xi(ct,"number",ct.value)}switch(Zt=De?ho(De):window,a){case"focusin":(qa(Zt)||Zt.contentEditable==="true")&&(jg=Zt,D1=De,jy=null);break;case"focusout":jy=D1=jg=null;break;case"mousedown":bb=!0;break;case"contextmenu":case"mouseup":case"dragend":bb=!1,$o(yt,v,it);break;case"selectionchange":if(iD)break;case"keydown":case"keyup":$o(yt,v,it)}var On;if(nE)e:{switch(a){case"compositionstart":var An="onCompositionStart";break e;case"compositionend":An="onCompositionEnd";break e;case"compositionupdate":An="onCompositionUpdate";break e}An=void 0}else im?hf(a,v)&&(An="onCompositionEnd"):a==="keydown"&&v.keyCode===JC&&(An="onCompositionStart");An&&(iE&&v.locale!=="ko"&&(im||An!=="onCompositionStart"?An==="onCompositionEnd"&&im&&(On=B_()):(Pd=it,Xf="value"in Pd?Pd.value:Pd.textContent,im=!0)),Zt=Ue(De,An),0<Zt.length&&(An=new eE(An,a,null,v,it),yt.push({event:An,listeners:Zt}),On?An.data=On:(On=Gr(v),On!==null&&(An.data=On)))),(On=NM?wp(a,v):Tp(a,v))&&(An=Ue(De,"onBeforeInput"),0<An.length&&(Zt=new tE("onBeforeInput","beforeinput",null,v,it),yt.push({event:Zt,listeners:An}),Zt.data=On)),se(yt,a,De,v,it)}pe(yt,h)})}function je(a,h,v){return{instance:a,listener:h,currentTarget:v}}function Ue(a,h){for(var v=h+"Capture",S=[];a!==null;){var I=a,k=I.stateNode;if(I=I.tag,I!==5&&I!==26&&I!==27||k===null||(I=qc(a,v),I!=null&&S.unshift(je(a,I,k)),I=qc(a,h),I!=null&&S.push(je(a,I,k))),a.tag===3)return S;a=a.return}return[]}function We(a){if(a===null)return null;do a=a.return;while(a&&a.tag!==5&&a.tag!==27);return a||null}function et(a,h,v,S,I){for(var k=h._reactName,K=[];v!==null&&v!==S;){var ee=v,me=ee.alternate,De=ee.stateNode;if(ee=ee.tag,me!==null&&me===S)break;ee!==5&&ee!==26&&ee!==27||De===null||(me=De,I?(De=qc(v,k),De!=null&&K.unshift(je(v,De,me))):I||(De=qc(v,k),De!=null&&K.push(je(v,De,me)))),v=v.return}K.length!==0&&a.push({event:h,listeners:K})}function _t(a,h){Ku(a,h),a!=="input"&&a!=="textarea"&&a!=="select"||h==null||h.value!==null||tm||(tm=!0,a==="select"&&h.multiple?console.error("`value` prop on `%s` should not be null. Consider using an empty array when `multiple` is set to `true` to clear the component or `undefined` for uncontrolled components.",a):console.error("`value` prop on `%s` should not be null. Consider using an empty string to clear the component or `undefined` for uncontrolled components.",a));var v={registrationNameDependencies:Jp,possibleRegistrationNames:ob};Bs(a)||typeof h.is=="string"||Ju(a,h,v),h.contentEditable&&!h.suppressContentEditableWarning&&h.children!=null&&console.error("A component is `contentEditable` and contains `children` managed by React. It is now your responsibility to guarantee that none of those nodes are unexpectedly modified or duplicated. This is probably not intentional.")}function ft(a,h,v,S){h!==v&&(v=ht(v),ht(h)!==v&&(S[a]=h))}function Mt(a,h,v){h.forEach(function(S){v[Pt(S)]=S==="style"?qt(a):a.getAttribute(S)})}function Rt(a,h){h===!1?console.error("Expected `%s` listener to be a function, instead got `false`.\n\nIf you used to conditionally omit it with %s={condition && value}, pass %s={condition ? value : undefined} instead.",a,a,a):console.error("Expected `%s` listener to be a function, instead got a value of `%s` type.",a,typeof h)}function jt(a,h){return a=a.namespaceURI===pb||a.namespaceURI===Bg?a.ownerDocument.createElementNS(a.namespaceURI,a.tagName):a.ownerDocument.createElement(a.tagName),a.innerHTML=h,a.innerHTML}function ht(a){return Fe(a)&&(console.error("The provided HTML markup uses a value of unsupported type %s. This value must be coerced to a string before using it here.",Xt(a)),Ot(a)),(typeof a=="string"?a:""+a).replace(Hb,`
`).replace($b,"")}function Dt(a,h){return h=ht(h),ht(a)===h}function ot(){}function At(a,h,v,S,I,k){switch(v){case"children":typeof S=="string"?($c(S,h,!1),h==="body"||h==="textarea"&&S===""||Rl(a,S)):(typeof S=="number"||typeof S=="bigint")&&($c(""+S,h,!1),h!=="body"&&Rl(a,""+S));break;case"className":Lt(a,"class",S);break;case"tabIndex":Lt(a,"tabindex",S);break;case"dir":case"role":case"viewBox":case"width":case"height":Lt(a,v,S);break;case"style":xp(a,S,k);break;case"data":if(h!=="object"){Lt(a,"data",S);break}case"src":case"href":if(S===""&&(h!=="a"||v!=="href")){console.error(v==="src"?'An empty string ("") was passed to the %s attribute. This may cause the browser to download the whole page again over the network. To fix this, either do not render the element at all or pass null to %s instead of an empty string.':'An empty string ("") was passed to the %s attribute. To fix this, either do not render the element at all or pass null to %s instead of an empty string.',v,v),a.removeAttribute(v);break}if(S==null||typeof S=="function"||typeof S=="symbol"||typeof S=="boolean"){a.removeAttribute(v);break}Ut(S,v),S=Gc(""+S),a.setAttribute(v,S);break;case"action":case"formAction":if(S!=null&&(h==="form"?v==="formAction"?console.error("You can only pass the formAction prop to <input> or <button>. Use the action prop on <form>."):typeof S=="function"&&(I.encType==null&&I.method==null||jb||(jb=!0,console.error("Cannot specify a encType or method for a form that specifies a function as the action. React provides those automatically. They will get overridden.")),I.target==null||uw||(uw=!0,console.error("Cannot specify a target for a form that specifies a function as the action. The function will always be executed in the same window."))):h==="input"||h==="button"?v==="action"?console.error("You can only pass the action prop to <form>. Use the formAction prop on <input> or <button>."):h!=="input"||I.type==="submit"||I.type==="image"||Ub?h!=="button"||I.type==null||I.type==="submit"||Ub?typeof S=="function"&&(I.name==null||VD||(VD=!0,console.error('Cannot specify a "name" prop for a button that specifies a function as a formAction. React needs it to encode which action should be invoked. It will get overridden.')),I.formEncType==null&&I.formMethod==null||jb||(jb=!0,console.error("Cannot specify a formEncType or formMethod for a button that specifies a function as a formAction. React provides those automatically. They will get overridden.")),I.formTarget==null||uw||(uw=!0,console.error("Cannot specify a formTarget for a button that specifies a function as a formAction. The function will always be executed in the same window."))):(Ub=!0,console.error('A button can only specify a formAction along with type="submit" or no type.')):(Ub=!0,console.error('An input can only specify a formAction along with type="submit" or type="image".')):console.error(v==="action"?"You can only pass the action prop to <form>.":"You can only pass the formAction prop to <input> or <button>.")),typeof S=="function"){a.setAttribute(v,"javascript:throw new Error('A React form was unexpectedly submitted. If you called form.submit() manually, consider using form.requestSubmit() instead. If you\\'re trying to use event.stopPropagation() in a submit event handler, consider also calling event.preventDefault().')");break}else typeof k=="function"&&(v==="formAction"?(h!=="input"&&At(a,h,"name",I.name,I,null),At(a,h,"formEncType",I.formEncType,I,null),At(a,h,"formMethod",I.formMethod,I,null),At(a,h,"formTarget",I.formTarget,I,null)):(At(a,h,"encType",I.encType,I,null),At(a,h,"method",I.method,I,null),At(a,h,"target",I.target,I,null)));if(S==null||typeof S=="symbol"||typeof S=="boolean"){a.removeAttribute(v);break}Ut(S,v),S=Gc(""+S),a.setAttribute(v,S);break;case"onClick":S!=null&&(typeof S!="function"&&Rt(v,S),a.onclick=ot);break;case"onScroll":S!=null&&(typeof S!="function"&&Rt(v,S),ge("scroll",a));break;case"onScrollEnd":S!=null&&(typeof S!="function"&&Rt(v,S),ge("scrollend",a));break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://react.dev/link/dangerously-set-inner-html for more information.");if(v=S.__html,v!=null){if(I.children!=null)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");a.innerHTML=v}}break;case"multiple":a.multiple=S&&typeof S!="function"&&typeof S!="symbol";break;case"muted":a.muted=S&&typeof S!="function"&&typeof S!="symbol";break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":break;case"autoFocus":break;case"xlinkHref":if(S==null||typeof S=="function"||typeof S=="boolean"||typeof S=="symbol"){a.removeAttribute("xlink:href");break}Ut(S,v),v=Gc(""+S),a.setAttributeNS(wm,"xlink:href",v);break;case"contentEditable":case"spellCheck":case"draggable":case"value":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":S!=null&&typeof S!="function"&&typeof S!="symbol"?(Ut(S,v),a.setAttribute(v,""+S)):a.removeAttribute(v);break;case"inert":S!==""||up[v]||(up[v]=!0,console.error("Received an empty string for a boolean attribute `%s`. This will treat the attribute as if it were false. Either pass `false` to silence this warning, or pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.",v));case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":S&&typeof S!="function"&&typeof S!="symbol"?a.setAttribute(v,""):a.removeAttribute(v);break;case"capture":case"download":S===!0?a.setAttribute(v,""):S!==!1&&S!=null&&typeof S!="function"&&typeof S!="symbol"?(Ut(S,v),a.setAttribute(v,S)):a.removeAttribute(v);break;case"cols":case"rows":case"size":case"span":S!=null&&typeof S!="function"&&typeof S!="symbol"&&!isNaN(S)&&1<=S?(Ut(S,v),a.setAttribute(v,S)):a.removeAttribute(v);break;case"rowSpan":case"start":S==null||typeof S=="function"||typeof S=="symbol"||isNaN(S)?a.removeAttribute(v):(Ut(S,v),a.setAttribute(v,S));break;case"popover":ge("beforetoggle",a),ge("toggle",a),Ii(a,"popover",S);break;case"xlinkActuate":$r(a,wm,"xlink:actuate",S);break;case"xlinkArcrole":$r(a,wm,"xlink:arcrole",S);break;case"xlinkRole":$r(a,wm,"xlink:role",S);break;case"xlinkShow":$r(a,wm,"xlink:show",S);break;case"xlinkTitle":$r(a,wm,"xlink:title",S);break;case"xlinkType":$r(a,wm,"xlink:type",S);break;case"xmlBase":$r(a,QE,"xml:base",S);break;case"xmlLang":$r(a,QE,"xml:lang",S);break;case"xmlSpace":$r(a,QE,"xml:space",S);break;case"is":k!=null&&console.error('Cannot update the "is" prop after it has been initialized.'),Ii(a,"is",S);break;case"innerText":case"textContent":break;case"popoverTarget":Ys||S==null||typeof S!="object"||(Ys=!0,console.error("The `popoverTarget` prop expects the ID of an Element as a string. Received %s instead.",S));default:!(2<v.length)||v[0]!=="o"&&v[0]!=="O"||v[1]!=="n"&&v[1]!=="N"?(v=ia(v),Ii(a,v,S)):Jp.hasOwnProperty(v)&&S!=null&&typeof S!="function"&&Rt(v,S)}}function Tt(a,h,v,S,I,k){switch(v){case"style":xp(a,S,k);break;case"dangerouslySetInnerHTML":if(S!=null){if(typeof S!="object"||!("__html"in S))throw Error("`props.dangerouslySetInnerHTML` must be in the form `{__html: ...}`. Please visit https://react.dev/link/dangerously-set-inner-html for more information.");if(v=S.__html,v!=null){if(I.children!=null)throw Error("Can only set one of `children` or `props.dangerouslySetInnerHTML`.");a.innerHTML=v}}break;case"children":typeof S=="string"?Rl(a,S):(typeof S=="number"||typeof S=="bigint")&&Rl(a,""+S);break;case"onScroll":S!=null&&(typeof S!="function"&&Rt(v,S),ge("scroll",a));break;case"onScrollEnd":S!=null&&(typeof S!="function"&&Rt(v,S),ge("scrollend",a));break;case"onClick":S!=null&&(typeof S!="function"&&Rt(v,S),a.onclick=ot);break;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"innerHTML":case"ref":break;case"innerText":case"textContent":break;default:if(Jp.hasOwnProperty(v))S!=null&&typeof S!="function"&&Rt(v,S);else e:{if(v[0]==="o"&&v[1]==="n"&&(I=v.endsWith("Capture"),h=v.slice(2,I?v.length-7:void 0),k=a[yc]||null,k=k!=null?k[v]:null,typeof k=="function"&&a.removeEventListener(h,k,I),typeof S=="function")){typeof k!="function"&&k!==null&&(v in a?a[v]=null:a.hasAttribute(v)&&a.removeAttribute(v)),a.addEventListener(h,S,I);break e}v in a?a[v]=S:S===!0?a.setAttribute(v,""):Ii(a,v,S)}}}function Nt(a,h,v){switch(_t(h,v),h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"img":ge("error",a),ge("load",a);var S=!1,I=!1,k;for(k in v)if(v.hasOwnProperty(k)){var K=v[k];if(K!=null)switch(k){case"src":S=!0;break;case"srcSet":I=!0;break;case"children":case"dangerouslySetInnerHTML":throw Error(h+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:At(a,h,k,K,v,null)}}I&&At(a,h,"srcSet",v.srcSet,v,null),S&&At(a,h,"src",v.src,v,null);return;case"input":Wn("input",v),ge("invalid",a);var ee=k=K=I=null,me=null,De=null;for(S in v)if(v.hasOwnProperty(S)){var it=v[S];if(it!=null)switch(S){case"name":I=it;break;case"type":K=it;break;case"checked":me=it;break;case"defaultChecked":De=it;break;case"value":k=it;break;case"defaultValue":ee=it;break;case"children":case"dangerouslySetInnerHTML":if(it!=null)throw Error(h+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");break;default:At(a,h,S,it,v,null)}}Jn(a,v),ii(a,k,ee,me,De,K,I,!1),_n(a);return;case"select":Wn("select",v),ge("invalid",a),S=K=k=null;for(I in v)if(v.hasOwnProperty(I)&&(ee=v[I],ee!=null))switch(I){case"value":k=ee;break;case"defaultValue":K=ee;break;case"multiple":S=ee;default:At(a,h,I,ee,v,null)}Ei(a,v),h=k,v=K,a.multiple=!!S,h!=null?Ai(a,!!S,h,!1):v!=null&&Ai(a,!!S,v,!0);return;case"textarea":Wn("textarea",v),ge("invalid",a),k=I=S=null;for(K in v)if(v.hasOwnProperty(K)&&(ee=v[K],ee!=null))switch(K){case"value":S=ee;break;case"defaultValue":I=ee;break;case"children":k=ee;break;case"dangerouslySetInnerHTML":if(ee!=null)throw Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");break;default:At(a,h,K,ee,v,null)}fr(a,v),Ir(a,S,I,k),_n(a);return;case"option":tr(a,v);for(me in v)if(v.hasOwnProperty(me)&&(S=v[me],S!=null))switch(me){case"selected":a.selected=S&&typeof S!="function"&&typeof S!="symbol";break;default:At(a,h,me,S,v,null)}return;case"dialog":ge("beforetoggle",a),ge("toggle",a),ge("cancel",a),ge("close",a);break;case"iframe":case"object":ge("load",a);break;case"video":case"audio":for(S=0;S<vv.length;S++)ge(vv[S],a);break;case"image":ge("error",a),ge("load",a);break;case"details":ge("toggle",a);break;case"embed":case"source":case"link":ge("error",a),ge("load",a);case"area":case"base":case"br":case"col":case"hr":case"keygen":case"meta":case"param":case"track":case"wbr":case"menuitem":for(De in v)if(v.hasOwnProperty(De)&&(S=v[De],S!=null))switch(De){case"children":case"dangerouslySetInnerHTML":throw Error(h+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");default:At(a,h,De,S,v,null)}return;default:if(Bs(h)){for(it in v)v.hasOwnProperty(it)&&(S=v[it],S!==void 0&&Tt(a,h,it,S,v,void 0));return}}for(ee in v)v.hasOwnProperty(ee)&&(S=v[ee],S!=null&&At(a,h,ee,S,v,null))}function Yt(a,h,v,S){switch(_t(h,S),h){case"div":case"span":case"svg":case"path":case"a":case"g":case"p":case"li":break;case"input":var I=null,k=null,K=null,ee=null,me=null,De=null,it=null;for(ut in v){var yt=v[ut];if(v.hasOwnProperty(ut)&&yt!=null)switch(ut){case"checked":break;case"value":break;case"defaultValue":me=yt;default:S.hasOwnProperty(ut)||At(a,h,ut,null,S,yt)}}for(var ct in S){var ut=S[ct];if(yt=v[ct],S.hasOwnProperty(ct)&&(ut!=null||yt!=null))switch(ct){case"type":k=ut;break;case"name":I=ut;break;case"checked":De=ut;break;case"defaultChecked":it=ut;break;case"value":K=ut;break;case"defaultValue":ee=ut;break;case"children":case"dangerouslySetInnerHTML":if(ut!=null)throw Error(h+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");break;default:ut!==yt&&At(a,h,ct,ut,S,yt)}}h=v.type==="checkbox"||v.type==="radio"?v.checked!=null:v.value!=null,S=S.type==="checkbox"||S.type==="radio"?S.checked!=null:S.value!=null,h||!S||XE||(console.error("A component is changing an uncontrolled input to be controlled. This is likely caused by the value changing from undefined to a defined value, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://react.dev/link/controlled-components"),XE=!0),!h||S||ZE||(console.error("A component is changing a controlled input to be uncontrolled. This is likely caused by the value changing from a defined to undefined, which should not happen. Decide between using a controlled or uncontrolled input element for the lifetime of the component. More info: https://react.dev/link/controlled-components"),ZE=!0),oi(a,K,ee,me,De,it,k,I);return;case"select":ut=K=ee=ct=null;for(k in v)if(me=v[k],v.hasOwnProperty(k)&&me!=null)switch(k){case"value":break;case"multiple":ut=me;default:S.hasOwnProperty(k)||At(a,h,k,null,S,me)}for(I in S)if(k=S[I],me=v[I],S.hasOwnProperty(I)&&(k!=null||me!=null))switch(I){case"value":ct=k;break;case"defaultValue":ee=k;break;case"multiple":K=k;default:k!==me&&At(a,h,I,k,S,me)}S=ee,h=K,v=ut,ct!=null?Ai(a,!!h,ct,!1):!!v!=!!h&&(S!=null?Ai(a,!!h,S,!0):Ai(a,!!h,h?[]:"",!1));return;case"textarea":ut=ct=null;for(ee in v)if(I=v[ee],v.hasOwnProperty(ee)&&I!=null&&!S.hasOwnProperty(ee))switch(ee){case"value":break;case"children":break;default:At(a,h,ee,null,S,I)}for(K in S)if(I=S[K],k=v[K],S.hasOwnProperty(K)&&(I!=null||k!=null))switch(K){case"value":ct=I;break;case"defaultValue":ut=I;break;case"children":break;case"dangerouslySetInnerHTML":if(I!=null)throw Error("`dangerouslySetInnerHTML` does not make sense on <textarea>.");break;default:I!==k&&At(a,h,K,I,S,k)}xr(a,ct,ut);return;case"option":for(var Ct in v)if(ct=v[Ct],v.hasOwnProperty(Ct)&&ct!=null&&!S.hasOwnProperty(Ct))switch(Ct){case"selected":a.selected=!1;break;default:At(a,h,Ct,null,S,ct)}for(me in S)if(ct=S[me],ut=v[me],S.hasOwnProperty(me)&&ct!==ut&&(ct!=null||ut!=null))switch(me){case"selected":a.selected=ct&&typeof ct!="function"&&typeof ct!="symbol";break;default:At(a,h,me,ct,S,ut)}return;case"img":case"link":case"area":case"base":case"br":case"col":case"embed":case"hr":case"keygen":case"meta":case"param":case"source":case"track":case"wbr":case"menuitem":for(var mn in v)ct=v[mn],v.hasOwnProperty(mn)&&ct!=null&&!S.hasOwnProperty(mn)&&At(a,h,mn,null,S,ct);for(De in S)if(ct=S[De],ut=v[De],S.hasOwnProperty(De)&&ct!==ut&&(ct!=null||ut!=null))switch(De){case"children":case"dangerouslySetInnerHTML":if(ct!=null)throw Error(h+" is a void element tag and must neither have `children` nor use `dangerouslySetInnerHTML`.");break;default:At(a,h,De,ct,S,ut)}return;default:if(Bs(h)){for(var tn in v)ct=v[tn],v.hasOwnProperty(tn)&&ct!==void 0&&!S.hasOwnProperty(tn)&&Tt(a,h,tn,void 0,S,ct);for(it in S)ct=S[it],ut=v[it],!S.hasOwnProperty(it)||ct===ut||ct===void 0&&ut===void 0||Tt(a,h,it,ct,S,ut);return}}for(var Qt in v)ct=v[Qt],v.hasOwnProperty(Qt)&&ct!=null&&!S.hasOwnProperty(Qt)&&At(a,h,Qt,null,S,ct);for(yt in S)ct=S[yt],ut=v[yt],!S.hasOwnProperty(yt)||ct===ut||ct==null&&ut==null||At(a,h,yt,ct,S,ut)}function Pt(a){switch(a){case"class":return"className";case"for":return"htmlFor";default:return a}}function qt(a){var h={};a=a.style;for(var v=0;v<a.length;v++){var S=a[v];h[S]=a.getPropertyValue(S)}return h}function bn(a,h,v){if(h!=null&&typeof h!="object")console.error("The `style` prop expects a mapping from style properties to values, not a string. For example, style={{marginRight: spacing + 'em'}} when using JSX.");else{var S,I=S="",k;for(k in h)if(h.hasOwnProperty(k)){var K=h[k];K!=null&&typeof K!="boolean"&&K!==""&&(k.indexOf("--")===0?(ln(K,k),S+=I+k+":"+(""+K).trim()):typeof K!="number"||K===0||w1.has(k)?(ln(K,k),S+=I+k.replace(WT,"-$1").toLowerCase().replace(YT,"-ms-")+":"+(""+K).trim()):S+=I+k.replace(WT,"-$1").toLowerCase().replace(YT,"-ms-")+":"+K+"px",I=";")}S=S||null,h=a.getAttribute("style"),h!==S&&(S=ht(S),ht(h)!==S&&(v.style=qt(a)))}}function fn(a,h,v,S,I,k){if(I.delete(v),a=a.getAttribute(v),a===null)switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":return}else if(S!=null)switch(typeof S){case"function":case"symbol":case"boolean":break;default:if(Ut(S,h),a===""+S)return}ft(h,a,S,k)}function pn(a,h,v,S,I,k){if(I.delete(v),a=a.getAttribute(v),a===null){switch(typeof S){case"function":case"symbol":return}if(!S)return}else switch(typeof S){case"function":case"symbol":break;default:if(S)return}ft(h,a,S,k)}function Rn(a,h,v,S,I,k){if(I.delete(v),a=a.getAttribute(v),a===null)switch(typeof S){case"undefined":case"function":case"symbol":return}else if(S!=null)switch(typeof S){case"function":case"symbol":break;default:if(Ut(S,v),a===""+S)return}ft(h,a,S,k)}function Nn(a,h,v,S,I,k){if(I.delete(v),a=a.getAttribute(v),a===null)switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":return;default:if(isNaN(S))return}else if(S!=null)switch(typeof S){case"function":case"symbol":case"boolean":break;default:if(!isNaN(S)&&(Ut(S,h),a===""+S))return}ft(h,a,S,k)}function Bn(a,h,v,S,I,k){if(I.delete(v),a=a.getAttribute(v),a===null)switch(typeof S){case"undefined":case"function":case"symbol":case"boolean":return}else if(S!=null)switch(typeof S){case"function":case"symbol":case"boolean":break;default:if(Ut(S,h),v=Gc(""+S),a===v)return}ft(h,a,S,k)}function Xn(a,h,v,S){for(var I={},k=new Set,K=a.attributes,ee=0;ee<K.length;ee++)switch(K[ee].name.toLowerCase()){case"value":break;case"checked":break;case"selected":break;default:k.add(K[ee].name)}if(Bs(h)){for(var me in v)if(v.hasOwnProperty(me)){var De=v[me];if(De!=null){if(Jp.hasOwnProperty(me))typeof De!="function"&&Rt(me,De);else if(v.suppressHydrationWarning!==!0)switch(me){case"children":typeof De!="string"&&typeof De!="number"||ft("children",a.textContent,De,I);continue;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":continue;case"dangerouslySetInnerHTML":K=a.innerHTML,De=De?De.__html:void 0,De!=null&&(De=jt(a,De),ft(me,K,De,I));continue;case"style":k.delete(me),bn(a,De,I);continue;case"offsetParent":case"offsetTop":case"offsetLeft":case"offsetWidth":case"offsetHeight":case"isContentEditable":case"outerText":case"outerHTML":k.delete(me.toLowerCase()),console.error("Assignment to read-only property will result in a no-op: `%s`",me);continue;case"className":k.delete("class"),K=Ri(a,"class",De),ft("className",K,De,I);continue;default:S.context===jh&&h!=="svg"&&h!=="math"?k.delete(me.toLowerCase()):k.delete(me),K=Ri(a,me,De),ft(me,K,De,I)}}}}else for(De in v)if(v.hasOwnProperty(De)&&(me=v[De],me!=null)){if(Jp.hasOwnProperty(De))typeof me!="function"&&Rt(De,me);else if(v.suppressHydrationWarning!==!0)switch(De){case"children":typeof me!="string"&&typeof me!="number"||ft("children",a.textContent,me,I);continue;case"suppressContentEditableWarning":case"suppressHydrationWarning":case"value":case"checked":case"selected":case"defaultValue":case"defaultChecked":case"innerHTML":case"ref":continue;case"dangerouslySetInnerHTML":K=a.innerHTML,me=me?me.__html:void 0,me!=null&&(me=jt(a,me),K!==me&&(I[De]={__html:K}));continue;case"className":fn(a,De,"class",me,k,I);continue;case"tabIndex":fn(a,De,"tabindex",me,k,I);continue;case"style":k.delete(De),bn(a,me,I);continue;case"multiple":k.delete(De),ft(De,a.multiple,me,I);continue;case"muted":k.delete(De),ft(De,a.muted,me,I);continue;case"autoFocus":k.delete("autofocus"),ft(De,a.autofocus,me,I);continue;case"data":if(h!=="object"){k.delete(De),K=a.getAttribute("data"),ft(De,K,me,I);continue}case"src":case"href":if(!(me!==""||h==="a"&&De==="href"||h==="object"&&De==="data")){console.error(De==="src"?'An empty string ("") was passed to the %s attribute. This may cause the browser to download the whole page again over the network. To fix this, either do not render the element at all or pass null to %s instead of an empty string.':'An empty string ("") was passed to the %s attribute. To fix this, either do not render the element at all or pass null to %s instead of an empty string.',De,De);continue}Bn(a,De,De,me,k,I);continue;case"action":case"formAction":if(K=a.getAttribute(De),typeof me=="function"){k.delete(De.toLowerCase()),De==="formAction"?(k.delete("name"),k.delete("formenctype"),k.delete("formmethod"),k.delete("formtarget")):(k.delete("enctype"),k.delete("method"),k.delete("target"));continue}else if(K===jM){k.delete(De.toLowerCase()),ft(De,"function",me,I);continue}Bn(a,De,De.toLowerCase(),me,k,I);continue;case"xlinkHref":Bn(a,De,"xlink:href",me,k,I);continue;case"contentEditable":Rn(a,De,"contenteditable",me,k,I);continue;case"spellCheck":Rn(a,De,"spellcheck",me,k,I);continue;case"draggable":case"autoReverse":case"externalResourcesRequired":case"focusable":case"preserveAlpha":Rn(a,De,De,me,k,I);continue;case"allowFullScreen":case"async":case"autoPlay":case"controls":case"default":case"defer":case"disabled":case"disablePictureInPicture":case"disableRemotePlayback":case"formNoValidate":case"hidden":case"loop":case"noModule":case"noValidate":case"open":case"playsInline":case"readOnly":case"required":case"reversed":case"scoped":case"seamless":case"itemScope":pn(a,De,De.toLowerCase(),me,k,I);continue;case"capture":case"download":e:{ee=a;var it=K=De,yt=I;if(k.delete(it),ee=ee.getAttribute(it),ee===null)switch(typeof me){case"undefined":case"function":case"symbol":break e;default:if(me===!1)break e}else if(me!=null)switch(typeof me){case"function":case"symbol":break;case"boolean":if(me===!0&&ee==="")break e;break;default:if(Ut(me,K),ee===""+me)break e}ft(K,ee,me,yt)}continue;case"cols":case"rows":case"size":case"span":e:{if(ee=a,it=K=De,yt=I,k.delete(it),ee=ee.getAttribute(it),ee===null)switch(typeof me){case"undefined":case"function":case"symbol":case"boolean":break e;default:if(isNaN(me)||1>me)break e}else if(me!=null)switch(typeof me){case"function":case"symbol":case"boolean":break;default:if(!(isNaN(me)||1>me)&&(Ut(me,K),ee===""+me))break e}ft(K,ee,me,yt)}continue;case"rowSpan":Nn(a,De,"rowspan",me,k,I);continue;case"start":Nn(a,De,De,me,k,I);continue;case"xHeight":fn(a,De,"x-height",me,k,I);continue;case"xlinkActuate":fn(a,De,"xlink:actuate",me,k,I);continue;case"xlinkArcrole":fn(a,De,"xlink:arcrole",me,k,I);continue;case"xlinkRole":fn(a,De,"xlink:role",me,k,I);continue;case"xlinkShow":fn(a,De,"xlink:show",me,k,I);continue;case"xlinkTitle":fn(a,De,"xlink:title",me,k,I);continue;case"xlinkType":fn(a,De,"xlink:type",me,k,I);continue;case"xmlBase":fn(a,De,"xml:base",me,k,I);continue;case"xmlLang":fn(a,De,"xml:lang",me,k,I);continue;case"xmlSpace":fn(a,De,"xml:space",me,k,I);continue;case"inert":me!==""||up[De]||(up[De]=!0,console.error("Received an empty string for a boolean attribute `%s`. This will treat the attribute as if it were false. Either pass `false` to silence this warning, or pass `true` if you used an empty string in earlier versions of React to indicate this attribute is true.",De)),pn(a,De,De,me,k,I);continue;default:if(!(2<De.length)||De[0]!=="o"&&De[0]!=="O"||De[1]!=="n"&&De[1]!=="N"){ee=ia(De),K=!1,S.context===jh&&h!=="svg"&&h!=="math"?k.delete(ee.toLowerCase()):(it=De.toLowerCase(),it=mb.hasOwnProperty(it)&&mb[it]||null,it!==null&&it!==De&&(K=!0,k.delete(it)),k.delete(ee));e:if(it=a,yt=ee,ee=me,zi(yt))if(it.hasAttribute(yt))it=it.getAttribute(yt),Ut(ee,yt),ee=it===""+ee?ee:it;else{switch(typeof ee){case"function":case"symbol":break e;case"boolean":if(it=yt.toLowerCase().slice(0,5),it!=="data-"&&it!=="aria-")break e}ee=ee===void 0?void 0:null}else ee=void 0;K||ft(De,ee,me,I)}}}return 0<k.size&&v.suppressHydrationWarning!==!0&&Mt(a,k,I),Object.keys(I).length===0?null:I}function ai(a,h){switch(a.length){case 0:return"";case 1:return a[0];case 2:return a[0]+" "+h+" "+a[1];default:return a.slice(0,-1).join(", ")+", "+h+" "+a[a.length-1]}}function Bi(a){return a.nodeType===9?a:a.ownerDocument}function pr(a){switch(a){case Bg:return dp;case pb:return Gb;default:return jh}}function Gi(a,h){if(a===jh)switch(h){case"svg":return dp;case"math":return Gb;default:return jh}return a===dp&&h==="foreignObject"?jh:a}function qi(a,h){return a==="textarea"||a==="noscript"||typeof h.children=="string"||typeof h.children=="number"||typeof h.children=="bigint"||typeof h.dangerouslySetInnerHTML=="object"&&h.dangerouslySetInnerHTML!==null&&h.dangerouslySetInnerHTML.__html!=null}function cs(){var a=window.event;return a&&a.type==="popstate"?a===eS?!1:(eS=a,!0):(eS=null,!1)}function si(a){setTimeout(function(){throw a})}function li(a,h,v){switch(h){case"button":case"input":case"select":case"textarea":v.autoFocus&&a.focus();break;case"img":v.src?a.src=v.src:v.srcSet&&(a.srcset=v.srcSet)}}function mi(a,h,v,S){Yt(a,h,v,S),a[yc]=S}function yr(a){Rl(a,"")}function Us(a,h,v){a.nodeValue=v}function Wi(a){return a==="head"}function ji(a,h){a.removeChild(h)}function Zr(a,h){(a.nodeType===9?a.body:a.nodeName==="HTML"?a.ownerDocument.body:a).removeChild(h)}function Ci(a,h){var v=h,S=0,I=0;do{var k=v.nextSibling;if(a.removeChild(v),k&&k.nodeType===8)if(v=k.data,v===bv){if(0<S&&8>S){v=S;var K=a.ownerDocument;if(v&HM&&Oh(K.documentElement),v&$M&&Oh(K.body),v&GM)for(v=K.head,Oh(v),K=v.firstChild;K;){var ee=K.nextSibling,me=K.nodeName;K[Ny]||me==="SCRIPT"||me==="STYLE"||me==="LINK"&&K.rel.toLowerCase()==="stylesheet"||v.removeChild(K),K=ee}}if(I===0){a.removeChild(k),Mg(h);return}I--}else v===Ac||v===hp||v===Wl?I++:S=v.charCodeAt(0)-48;else S=0;v=k}while(v);Mg(h)}function As(a){a=a.style,typeof a.setProperty=="function"?a.setProperty("display","none","important"):a.display="none"}function Tr(a){a.nodeValue=""}function mr(a,h){h=h[qM],h=h!=null&&h.hasOwnProperty("display")?h.display:null,a.style.display=h==null||typeof h=="boolean"?"":(""+h).trim()}function Er(a,h){a.nodeValue=h}function Fi(a){var h=a.firstChild;for(h&&h.nodeType===10&&(h=h.nextSibling);h;){var v=h;switch(h=h.nextSibling,v.nodeName){case"HTML":case"HEAD":case"BODY":Fi(v),Ns(v);continue;case"SCRIPT":case"STYLE":continue;case"LINK":if(v.rel.toLowerCase()==="stylesheet")continue}a.removeChild(v)}}function ts(a,h,v,S){for(;a.nodeType===1;){var I=v;if(a.nodeName.toLowerCase()!==h.toLowerCase()){if(!S&&(a.nodeName!=="INPUT"||a.type!=="hidden"))break}else if(S){if(!a[Ny])switch(h){case"meta":if(!a.hasAttribute("itemprop"))break;return a;case"link":if(k=a.getAttribute("rel"),k==="stylesheet"&&a.hasAttribute("data-precedence"))break;if(k!==I.rel||a.getAttribute("href")!==(I.href==null||I.href===""?null:I.href)||a.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin)||a.getAttribute("title")!==(I.title==null?null:I.title))break;return a;case"style":if(a.hasAttribute("data-precedence"))break;return a;case"script":if(k=a.getAttribute("src"),(k!==(I.src==null?null:I.src)||a.getAttribute("type")!==(I.type==null?null:I.type)||a.getAttribute("crossorigin")!==(I.crossOrigin==null?null:I.crossOrigin))&&k&&a.hasAttribute("async")&&!a.hasAttribute("itemprop"))break;return a;default:return a}}else if(h==="input"&&a.type==="hidden"){Ut(I.name,"name");var k=I.name==null?null:""+I.name;if(I.type==="hidden"&&a.getAttribute("name")===k)return a}else return a;if(a=js(a.nextSibling),a===null)break}return null}function No(a,h,v){if(h==="")return null;for(;a.nodeType!==3;)if((a.nodeType!==1||a.nodeName!=="INPUT"||a.type!=="hidden")&&!v||(a=js(a.nextSibling),a===null))return null;return a}function vr(a){return a.data===Wl||a.data===hp&&a.ownerDocument.readyState===JE}function Vi(a,h){var v=a.ownerDocument;if(a.data!==hp||v.readyState===JE)h();else{var S=function(){h(),v.removeEventListener("DOMContentLoaded",S)};v.addEventListener("DOMContentLoaded",S),a._reactRetry=S}}function js(a){for(;a!=null;a=a.nextSibling){var h=a.nodeType;if(h===1||h===3)break;if(h===8){if(h=a.data,h===Ac||h===Wl||h===hp||h===Cc||h===UD)break;if(h===bv)return null}}return a}function Ca(a){if(a.nodeType===1){for(var h=a.nodeName.toLowerCase(),v={},S=a.attributes,I=0;I<S.length;I++){var k=S[I];v[Pt(k.name)]=k.name.toLowerCase()==="style"?qt(a):k.value}return{type:h,props:v}}return a.nodeType===8?{type:"Suspense",props:{}}:a.nodeValue}function gl(a,h,v){return v===null||v[KE]!==!0?(a.nodeValue===h?a=null:(h=ht(h),a=ht(a.nodeValue)===h?null:a.nodeValue),a):null}function fc(a){a=a.nextSibling;for(var h=0;a;){if(a.nodeType===8){var v=a.data;if(v===bv){if(h===0)return js(a.nextSibling);h--}else v!==Ac&&v!==Wl&&v!==hp||h++}a=a.nextSibling}return null}function Fl(a){a=a.previousSibling;for(var h=0;a;){if(a.nodeType===8){var v=a.data;if(v===Ac||v===Wl||v===hp){if(h===0)return a;h--}else v===bv&&h++}a=a.previousSibling}return null}function Qa(a){Mg(a)}function vd(a){Mg(a)}function pc(a,h,v,S,I){switch(I&&ll(a,S.ancestorInfo),h=Bi(v),a){case"html":if(a=h.documentElement,!a)throw Error("React expected an <html> element (document.documentElement) to exist in the Document but one was not found. React never removes the documentElement for any Document it renders into so the cause is likely in some other script running on this page.");return a;case"head":if(a=h.head,!a)throw Error("React expected a <head> element (document.head) to exist in the Document but one was not found. React never removes the head for any Document it renders into so the cause is likely in some other script running on this page.");return a;case"body":if(a=h.body,!a)throw Error("React expected a <body> element (document.body) to exist in the Document but one was not found. React never removes the body for any Document it renders into so the cause is likely in some other script running on this page.");return a;default:throw Error("resolveSingletonInstance was called with an element type that is not supported. This is a bug in React.")}}function bd(a,h,v,S){if(!v[Od]&&Xs(v)){var I=v.tagName.toLowerCase();console.error("You are mounting a new %s component when a previous one has not first unmounted. It is an error to render more than one %s component at a time and attributes and children of these components will likely fail in unpredictable ways. Please only render a single instance of <%s> and if you need to mount a new one, ensure any previous ones have unmounted first.",I,I,I)}switch(a){case"html":case"head":case"body":break;default:console.error("acquireSingletonInstance was called with an element type that is not supported. This is a bug in React.")}for(I=v.attributes;I.length;)v.removeAttributeNode(I[0]);Nt(v,a,h),v[_l]=S,v[yc]=h}function Oh(a){for(var h=a.attributes;h.length;)a.removeAttributeNode(h[0]);Ns(a)}function Wp(a){return typeof a.getRootNode=="function"?a.getRootNode():a.nodeType===9?a:a.ownerDocument}function Ff(a,h,v){var S=Tm;if(S&&typeof h=="string"&&h){var I=Vn(h);I='link[rel="'+a+'"][href="'+I+'"]',typeof v=="string"&&(I+='[crossorigin="'+v+'"]'),GD.has(I)||(GD.add(I),a={rel:a,crossOrigin:v,href:h},S.querySelector(I)===null&&(h=S.createElement("link"),Nt(h,"link",a),xt(h),S.head.appendChild(h)))}}function Ay(a,h,v,S){var I=(I=Qp.current)?Wp(I):null;if(!I)throw Error('"resourceRoot" was expected to exist. This is a bug in React.');switch(a){case"meta":case"title":return null;case"style":return typeof v.precedence=="string"&&typeof v.href=="string"?(v=Ih(v.href),h=Ge(I).hoistableStyles,S=h.get(v),S||(S={type:"style",instance:null,count:0,state:null},h.set(v,S)),S):{type:"void",instance:null,count:0,state:null};case"link":if(v.rel==="stylesheet"&&typeof v.href=="string"&&typeof v.precedence=="string"){a=Ih(v.href);var k=Ge(I).hoistableStyles,K=k.get(a);if(!K&&(I=I.ownerDocument||I,K={type:"stylesheet",instance:null,count:0,state:{loading:o_,preload:null}},k.set(a,K),(k=I.querySelector(wd(a)))&&!k._p&&(K.instance=k,K.state.loading=xv|vu),!bu.has(a))){var ee={rel:"preload",as:"style",href:v.href,crossOrigin:v.crossOrigin,integrity:v.integrity,media:v.media,hrefLang:v.hrefLang,referrerPolicy:v.referrerPolicy};bu.set(a,ee),k||Yp(I,a,ee,K.state)}if(h&&S===null)throw v=`

  - `+xd(h)+`
  + `+xd(v),Error("Expected <link> not to update to be updated to a stylesheet with precedence. Check the `rel`, `href`, and `precedence` props of this component. Alternatively, check whether two different <link> components render in the same slot or share the same key."+v);return K}if(h&&S!==null)throw v=`

  - `+xd(h)+`
  + `+xd(v),Error("Expected stylesheet with precedence to not be updated to a different kind of <link>. Check the `rel`, `href`, and `precedence` props of this component. Alternatively, check whether two different <link> components render in the same slot or share the same key."+v);return null;case"script":return h=v.async,v=v.src,typeof v=="string"&&h&&typeof h!="function"&&typeof h!="symbol"?(v=mc(v),h=Ge(I).hoistableScripts,S=h.get(v),S||(S={type:"script",instance:null,count:0,state:null},h.set(v,S)),S):{type:"void",instance:null,count:0,state:null};default:throw Error('getResource encountered a type it did not expect: "'+a+'". this is a bug in React.')}}function xd(a){var h=0,v="<link";return typeof a.rel=="string"?(h++,v+=' rel="'+a.rel+'"'):$f.call(a,"rel")&&(h++,v+=' rel="'+(a.rel===null?"null":"invalid type "+typeof a.rel)+'"'),typeof a.href=="string"?(h++,v+=' href="'+a.href+'"'):$f.call(a,"href")&&(h++,v+=' href="'+(a.href===null?"null":"invalid type "+typeof a.href)+'"'),typeof a.precedence=="string"?(h++,v+=' precedence="'+a.precedence+'"'):$f.call(a,"precedence")&&(h++,v+=" precedence={"+(a.precedence===null?"null":"invalid type "+typeof a.precedence)+"}"),Object.getOwnPropertyNames(a).length>h&&(v+=" ..."),v+" />"}function Ih(a){return'href="'+Vn(a)+'"'}function wd(a){return'link[rel="stylesheet"]['+a+"]"}function uu(a){return br({},a,{"data-precedence":a.precedence,precedence:null})}function Yp(a,h,v,S){a.querySelector('link[rel="preload"][as="style"]['+h+"]")?S.loading=xv:(h=a.createElement("link"),S.preload=h,h.addEventListener("load",function(){return S.loading|=xv}),h.addEventListener("error",function(){return S.loading|=$D}),Nt(h,"link",v),xt(h),a.head.appendChild(h))}function mc(a){return'[src="'+Vn(a)+'"]'}function gc(a){return"script[async]"+a}function Kx(a,h,v){if(h.count++,h.instance===null)switch(h.type){case"style":var S=a.querySelector('style[data-href~="'+Vn(v.href)+'"]');if(S)return h.instance=S,xt(S),S;var I=br({},v,{"data-href":v.href,"data-precedence":v.precedence,href:null,precedence:null});return S=(a.ownerDocument||a).createElement("style"),xt(S),Nt(S,"style",I),Vf(S,v.precedence,a),h.instance=S;case"stylesheet":I=Ih(v.href);var k=a.querySelector(wd(I));if(k)return h.state.loading|=vu,h.instance=k,xt(k),k;S=uu(v),(I=bu.get(I))&&Cy(S,I),k=(a.ownerDocument||a).createElement("link"),xt(k);var K=k;return K._p=new Promise(function(ee,me){K.onload=ee,K.onerror=me}),Nt(k,"link",S),h.state.loading|=vu,Vf(k,v.precedence,a),h.instance=k;case"script":return k=mc(v.src),(I=a.querySelector(gc(k)))?(h.instance=I,xt(I),I):(S=v,(I=bu.get(k))&&(S=br({},v),Jx(S,I)),a=a.ownerDocument||a,I=a.createElement("script"),xt(I),Nt(I,"link",S),a.head.appendChild(I),h.instance=I);case"void":return null;default:throw Error('acquireResource encountered a resource type it did not expect: "'+h.type+'". this is a bug in React.')}else h.type==="stylesheet"&&(h.state.loading&vu)===o_&&(S=h.instance,h.state.loading|=vu,Vf(S,v.precedence,a));return h.instance}function Vf(a,h,v){for(var S=v.querySelectorAll('link[rel="stylesheet"][data-precedence],style[data-precedence]'),I=S.length?S[S.length-1]:null,k=I,K=0;K<S.length;K++){var ee=S[K];if(ee.dataset.precedence===h)k=ee;else if(k!==I)break}k?k.parentNode.insertBefore(a,k.nextSibling):(h=v.nodeType===9?v.head:v,h.insertBefore(a,h.firstChild))}function Cy(a,h){a.crossOrigin==null&&(a.crossOrigin=h.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=h.referrerPolicy),a.title==null&&(a.title=h.title)}function Jx(a,h){a.crossOrigin==null&&(a.crossOrigin=h.crossOrigin),a.referrerPolicy==null&&(a.referrerPolicy=h.referrerPolicy),a.integrity==null&&(a.integrity=h.integrity)}function RT(a,h,v){if(wv===null){var S=new Map,I=wv=new Map;I.set(v,S)}else I=wv,S=I.get(v),S||(S=new Map,I.set(v,S));if(S.has(a))return S;for(S.set(a,null),v=v.getElementsByTagName(a),I=0;I<v.length;I++){var k=v[I];if(!(k[Ny]||k[_l]||a==="link"&&k.getAttribute("rel")==="stylesheet")&&k.namespaceURI!==Bg){var K=k.getAttribute(h)||"";K=a+K;var ee=S.get(K);ee?ee.push(k):S.set(K,[k])}}return S}function OT(a,h,v){a=a.ownerDocument||a,a.head.insertBefore(v,h==="title"?a.querySelector("head > title"):null)}function sC(a,h,v){var S=!v.ancestorInfo.containerTagInScope;if(v.context===dp||h.itemProp!=null)return!S||h.itemProp==null||a!=="meta"&&a!=="title"&&a!=="style"&&a!=="link"&&a!=="script"||console.error("Cannot render a <%s> outside the main document if it has an `itemProp` prop. `itemProp` suggests the tag belongs to an `itemScope` which can appear anywhere in the DOM. If you were intending for React to hoist this <%s> remove the `itemProp` prop. Otherwise, try moving this tag into the <head> or <body> of the Document.",a,a),!1;switch(a){case"meta":case"title":return!0;case"style":if(typeof h.precedence!="string"||typeof h.href!="string"||h.href===""){S&&console.error('Cannot render a <style> outside the main document without knowing its precedence and a unique href key. React can hoist and deduplicate <style> tags if you provide a `precedence` prop along with an `href` prop that does not conflict with the `href` values used in any other hoisted <style> or <link rel="stylesheet" ...> tags.  Note that hoisting <style> tags is considered an advanced feature that most will not use directly. Consider moving the <style> tag to the <head> or consider adding a `precedence="default"` and `href="some unique resource identifier"`.');break}return!0;case"link":if(typeof h.rel!="string"||typeof h.href!="string"||h.href===""||h.onLoad||h.onError){if(h.rel==="stylesheet"&&typeof h.precedence=="string"){a=h.href;var I=h.onError,k=h.disabled;v=[],h.onLoad&&v.push("`onLoad`"),I&&v.push("`onError`"),k!=null&&v.push("`disabled`"),I=ai(v,"and"),I+=v.length===1?" prop":" props",k=v.length===1?"an "+I:"the "+I,v.length&&console.error('React encountered a <link rel="stylesheet" href="%s" ... /> with a `precedence` prop that also included %s. The presence of loading and error handlers indicates an intent to manage the stylesheet loading state from your from your Component code and React will not hoist or deduplicate this stylesheet. If your intent was to have React hoist and deduplciate this stylesheet using the `precedence` prop remove the %s, otherwise remove the `precedence` prop.',a,k,I)}S&&(typeof h.rel!="string"||typeof h.href!="string"||h.href===""?console.error("Cannot render a <link> outside the main document without a `rel` and `href` prop. Try adding a `rel` and/or `href` prop to this <link> or moving the link into the <head> tag"):(h.onError||h.onLoad)&&console.error("Cannot render a <link> with onLoad or onError listeners outside the main document. Try removing onLoad={...} and onError={...} or moving it into the root <head> tag or somewhere in the <body>."));break}switch(h.rel){case"stylesheet":return a=h.precedence,h=h.disabled,typeof a!="string"&&S&&console.error('Cannot render a <link rel="stylesheet" /> outside the main document without knowing its precedence. Consider adding precedence="default" or moving it into the root <head> tag.'),typeof a=="string"&&h==null;default:return!0}case"script":if(a=h.async&&typeof h.async!="function"&&typeof h.async!="symbol",!a||h.onLoad||h.onError||!h.src||typeof h.src!="string"){S&&(a?h.onLoad||h.onError?console.error("Cannot render a <script> with onLoad or onError listeners outside the main document. Try removing onLoad={...} and onError={...} or moving it into the root <head> tag or somewhere in the <body>."):console.error("Cannot render a <script> outside the main document without `async={true}` and a non-empty `src` prop. Ensure there is a valid `src` and either make the script async or move it into the root <head> tag or somewhere in the <body>."):console.error('Cannot render a sync or defer <script> outside the main document without knowing its order. Try adding async="" or moving it into the root <head> tag.'));break}return!0;case"noscript":case"template":S&&console.error("Cannot render <%s> outside the main document. Try moving it into the root <head> tag.",a)}return!1}function IT(a){return!(a.type==="stylesheet"&&(a.state.loading&a_)===o_)}function Ig(){}function oC(a,h,v){if(Tv===null)throw Error("Internal React Error: suspendedState null when it was expected to exists. Please report this as a React bug.");var S=Tv;if(h.type==="stylesheet"&&(typeof v.media!="string"||matchMedia(v.media).matches!==!1)&&(h.state.loading&vu)===o_){if(h.instance===null){var I=Ih(v.href),k=a.querySelector(wd(I));if(k){a=k._p,a!==null&&typeof a=="object"&&typeof a.then=="function"&&(S.count++,S=Uf.bind(S),a.then(S,S)),h.state.loading|=vu,h.instance=k,xt(k);return}k=a.ownerDocument||a,v=uu(v),(I=bu.get(I))&&Cy(v,I),k=k.createElement("link"),xt(k);var K=k;K._p=new Promise(function(ee,me){K.onload=ee,K.onerror=me}),Nt(k,"link",v),h.instance=k}S.stylesheets===null&&(S.stylesheets=new Map),S.stylesheets.set(h,a),(a=h.state.preload)&&(h.state.loading&a_)===o_&&(S.count++,h=Uf.bind(S),a.addEventListener("load",h),a.addEventListener("error",h))}}function Da(){if(Tv===null)throw Error("Internal React Error: suspendedState null when it was expected to exists. Please report this as a React bug.");var a=Tv;return a.stylesheets&&a.count===0&&MT(a,a.stylesheets),0<a.count?function(h){var v=setTimeout(function(){if(a.stylesheets&&MT(a,a.stylesheets),a.unsuspend){var S=a.unsuspend;a.unsuspend=null,S()}},6e4);return a.unsuspend=h,function(){a.unsuspend=null,clearTimeout(v)}}:null}function Uf(){if(this.count--,this.count===0){if(this.stylesheets)MT(this,this.stylesheets);else if(this.unsuspend){var a=this.unsuspend;this.unsuspend=null,a()}}}function MT(a,h){a.stylesheets=null,a.unsuspend!==null&&(a.count++,Ev=new Map,h.forEach(bM,a),Ev=null,Uf.call(a))}function bM(a,h){if(!(h.state.loading&vu)){var v=Ev.get(a);if(v)var S=v.get(l_);else{v=new Map,Ev.set(a,v);for(var I=a.querySelectorAll("link[data-precedence],style[data-precedence]"),k=0;k<I.length;k++){var K=I[k];(K.nodeName==="LINK"||K.getAttribute("media")!=="not all")&&(v.set(K.dataset.precedence,K),S=K)}S&&v.set(l_,S)}I=h.instance,K=I.getAttribute("data-precedence"),k=v.get(K)||S,k===S&&v.set(l_,I),v.set(K,I),this.count++,S=Uf.bind(this),I.addEventListener("load",S),I.addEventListener("error",S),k?k.parentNode.insertBefore(I,k.nextSibling):(a=a.nodeType===9?a.head:a,a.insertBefore(I,a.firstChild)),h.state.loading|=vu}}function e1(a,h,v,S,I,k,K,ee){for(this.tag=1,this.containerInfo=a,this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=s_,this.callbackNode=this.next=this.pendingContext=this.context=this.cancelPendingCommit=null,this.callbackPriority=0,this.expirationTimes=di(-1),this.entangledLanes=this.shellSuspendCounter=this.errorRecoveryDisabledLanes=this.expiredLanes=this.warmLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=di(0),this.hiddenUpdates=di(null),this.identifierPrefix=S,this.onUncaughtError=I,this.onCaughtError=k,this.onRecoverableError=K,this.pooledCache=null,this.pooledCacheLanes=0,this.formState=ee,this.incompleteTransitions=new Map,this.passiveEffectDuration=this.effectDuration=-0,this.memoizedUpdaters=new Set,a=this.pendingUpdatersLaneMap=[],h=0;31>h;h++)a.push(new Set);this._debugRootType=v?"hydrateRoot()":"createRoot()"}function aC(a,h,v,S,I,k,K,ee,me,De,it,yt){return a=new e1(a,h,v,K,ee,me,De,yt),h=uE,k===!0&&(h|=tl|vc),Nu&&(h|=el),k=F(3,null,null,h),a.current=k,k.stateNode=a,h=Cp(),ch(h),a.pooledCache=h,ch(h),k.memoizedState={element:S,isDehydrated:v,cache:h},ig(k),a}function PT(a){return a?(a=rm,a):rm}function Dy(a,h,v,S,I,k){if(Ra&&typeof Ra.onScheduleFiberRoot=="function")try{Ra.onScheduleFiberRoot(Ad,S,v)}catch(K){Cd||(Cd=!0,console.error("React instrumentation encountered an error: %s",K))}ei!==null&&typeof ei.markRenderScheduled=="function"&&ei.markRenderScheduled(h),I=PT(I),S.context===null?S.context=I:S.pendingContext=I,Lh&&hu!==null&&!x&&(x=!0,console.error(`Render methods should be a pure function of props and state; triggering nested component updates from render is not allowed. If necessary, trigger nested updates in componentDidUpdate.

Check the render method of %s.`,Te(hu)||"Unknown")),S=kl(h),S.payload={element:v},k=k===void 0?null:k,k!==null&&(typeof k!="function"&&console.error("Expected the last optional `callback` argument to be a function. Instead received: %s.",k),S.callback=k),v=oc(a,S,h),v!==null&&(oo(v,a,h),dh(v,a,h))}function lC(a,h){if(a=a.memoizedState,a!==null&&a.dehydrated!==null){var v=a.retryLane;a.retryLane=v!==0&&v<h?v:h}}function t1(a,h){lC(a,h),(a=a.alternate)&&lC(a,h)}function cC(a){if(a.tag===13){var h=fi(a,67108864);h!==null&&oo(h,a,67108864),t1(a,67108864)}}function kT(){return hu}function Td(){for(var a=new Map,h=1,v=0;31>v;v++){var S=_r(h);a.set(h,S),h*=2}return a}function jf(a,h,v,S){var I=Jt.T;Jt.T=null;var k=us.p;try{us.p=Qs,n1(a,h,v,S)}finally{us.p=k,Jt.T=I}}function uC(a,h,v,S){var I=Jt.T;Jt.T=null;var k=us.p;try{us.p=kh,n1(a,h,v,S)}finally{us.p=k,Jt.T=I}}function n1(a,h,v,S){if(ae){var I=Ry(S);if(I===null)qe(a,h,S,he,v),J0(a,S);else if(i1(I,a,h,v,S))S.stopPropagation();else if(J0(a,S),h&4&&-1<Qe.indexOf(a)){for(;I!==null;){var k=Xs(I);if(k!==null)switch(k.tag){case 3:if(k=k.stateNode,k.current.memoizedState.isDehydrated){var K=Li(k.pendingLanes);if(K!==0){var ee=k;for(ee.pendingLanes|=2,ee.entangledLanes|=2;K;){var me=1<<31-Ja(K);ee.entanglements[1]|=me,K&=~me}y(k),(ns&(Pa|Hl))===Sc&&(pv=Sd()+UE,w(0))}}break;case 13:ee=fi(k,2),ee!==null&&oo(ee,k,2),kf(),t1(k,2)}if(k=Ry(S),k===null&&qe(a,h,S,he,v),k===I)break;I=k}I!==null&&S.stopPropagation()}else qe(a,h,S,null,v)}}function Ry(a){return a=Si(a),K0(a)}function K0(a){if(he=null,a=Hr(a),a!==null){var h=ie(a);if(h===null)a=null;else{var v=h.tag;if(v===13){if(a=we(h),a!==null)return a;a=null}else if(v===3){if(h.stateNode.current.memoizedState.isDehydrated)return h.tag===3?h.stateNode.containerInfo:null;a=null}else h!==a&&(a=null)}}return he=a,null}function Oy(a){switch(a){case"beforetoggle":case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"toggle":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return Qs;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return kh;case"message":switch(_o()){case Kp:return Qs;case h1:return kh;case Gf:case d1:return Rd;case zg:return sb;default:return Rd}default:return Rd}}function J0(a,h){switch(a){case"focusin":case"focusout":Ae=null;break;case"dragenter":case"dragleave":re=null;break;case"mouseover":case"mouseout":ye=null;break;case"pointerover":case"pointerout":Oe.delete(h.pointerId);break;case"gotpointercapture":case"lostpointercapture":Le.delete(h.pointerId)}}function Iy(a,h,v,S,I,k){return a===null||a.nativeEvent!==k?(a={blockedOn:h,domEventName:v,eventSystemFlags:S,nativeEvent:k,targetContainers:[I]},h!==null&&(h=Xs(h),h!==null&&cC(h)),a):(a.eventSystemFlags|=S,h=a.targetContainers,I!==null&&h.indexOf(I)===-1&&h.push(I),a)}function i1(a,h,v,S,I){switch(h){case"focusin":return Ae=Iy(Ae,a,h,v,S,I),!0;case"dragenter":return re=Iy(re,a,h,v,S,I),!0;case"mouseover":return ye=Iy(ye,a,h,v,S,I),!0;case"pointerover":var k=I.pointerId;return Oe.set(k,Iy(Oe.get(k)||null,a,h,v,S,I)),!0;case"gotpointercapture":return k=I.pointerId,Le.set(k,Iy(Le.get(k)||null,a,h,v,S,I)),!0}return!1}function r1(a){var h=Hr(a.target);if(h!==null){var v=ie(h);if(v!==null){if(h=v.tag,h===13){if(h=we(v),h!==null){a.blockedOn=h,ps(a.priority,function(){if(v.tag===13){var S=Aa(v);S=ir(S);var I=fi(v,S);I!==null&&oo(I,v,S),t1(v,S)}});return}}else if(h===3&&v.stateNode.current.memoizedState.isDehydrated){a.blockedOn=v.tag===3?v.stateNode.containerInfo:null;return}}}a.blockedOn=null}function My(a){if(a.blockedOn!==null)return!1;for(var h=a.targetContainers;0<h.length;){var v=Ry(a.nativeEvent);if(v===null){v=a.nativeEvent;var S=new v.constructor(v.type,v),I=S;Yf!==null&&console.error("Expected currently replaying event to be null. This error is likely caused by a bug in React. Please file an issue."),Yf=I,v.target.dispatchEvent(S),Yf===null&&console.error("Expected currently replaying event to not be null. This error is likely caused by a bug in React. Please file an issue."),Yf=null}else return h=Xs(v),h!==null&&cC(h),a.blockedOn=v,!1;h.shift()}return!0}function NT(a,h,v){My(a)&&v.delete(h)}function hC(){Se=!1,Ae!==null&&My(Ae)&&(Ae=null),re!==null&&My(re)&&(re=null),ye!==null&&My(ye)&&(ye=null),Oe.forEach(NT),Le.forEach(NT)}function Mh(a,h){a.blockedOn===h&&(a.blockedOn=null,Se||(Se=!0,Wo.unstable_scheduleCallback(Wo.unstable_NormalPriority,hC)))}function LT(a){st!==a&&(st=a,Wo.unstable_scheduleCallback(Wo.unstable_NormalPriority,function(){st===a&&(st=null);for(var h=0;h<a.length;h+=3){var v=a[h],S=a[h+1],I=a[h+2];if(typeof S!="function"){if(K0(S||v)===null)continue;break}var k=Xs(v);k!==null&&(a.splice(h,3),h-=3,v={pending:!0,data:I,method:v.method,action:S},Object.freeze(v),iy(k,v,S,I))}}))}function Mg(a){function h(me){return Mh(me,a)}Ae!==null&&Mh(Ae,a),re!==null&&Mh(re,a),ye!==null&&Mh(ye,a),Oe.forEach(h),Le.forEach(h);for(var v=0;v<nt.length;v++){var S=nt[v];S.blockedOn===a&&(S.blockedOn=null)}for(;0<nt.length&&(v=nt[0],v.blockedOn===null);)r1(v),v.blockedOn===null&&nt.shift();if(v=(a.ownerDocument||a).$$reactFormReplay,v!=null)for(S=0;S<v.length;S+=3){var I=v[S],k=v[S+1],K=I[yc]||null;if(typeof k=="function")K||LT(v);else if(K){var ee=null;if(k&&k.hasAttribute("formAction")){if(I=k,K=k[yc]||null)ee=K.formAction;else if(K0(I)!==null)continue}else ee=K.action;typeof ee=="function"?v[S+1]=ee:(v.splice(S,3),S-=3),LT(v)}}}function s1(a){this._internalRoot=a}function o1(a){this._internalRoot=a}function dC(a){a[Od]&&(a._reactRootContainer?console.error("You are calling ReactDOMClient.createRoot() on a container that was previously passed to ReactDOM.render(). This is not supported."):console.error("You are calling ReactDOMClient.createRoot() on a container that has already been passed to createRoot() before. Instead, call root.render() on the existing root instead if you want to update it."))}typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStart(Error());var Wo=W$(),a1=CA(),fC=zU(),br=Object.assign,pC=Symbol.for("react.element"),Zp=Symbol.for("react.transitional.element"),Py=Symbol.for("react.portal"),Pg=Symbol.for("react.fragment"),eb=Symbol.for("react.strict_mode"),l1=Symbol.for("react.profiler"),mC=Symbol.for("react.provider"),c1=Symbol.for("react.consumer"),Ph=Symbol.for("react.context"),ky=Symbol.for("react.forward_ref"),tb=Symbol.for("react.suspense"),Ed=Symbol.for("react.suspense_list"),go=Symbol.for("react.memo"),_c=Symbol.for("react.lazy"),kg=Symbol.for("react.activity"),xM=Symbol.for("react.memo_cache_sentinel"),gC=Symbol.iterator,wM=Symbol.for("react.client.reference"),Ka=Array.isArray,Jt=a1.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,us=fC.__DOM_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,Ng=Object.freeze({pending:!1,data:null,method:null,action:null}),Lg=[],zT=[],Hf=-1,Xp=oe(null),nb=oe(null),Qp=oe(null),u1=oe(null),$f=Object.prototype.hasOwnProperty,ib=Wo.unstable_scheduleCallback,TM=Wo.unstable_cancelCallback,_C=Wo.unstable_shouldYield,rb=Wo.unstable_requestPaint,Sd=Wo.unstable_now,_o=Wo.unstable_getCurrentPriorityLevel,Kp=Wo.unstable_ImmediatePriority,h1=Wo.unstable_UserBlockingPriority,Gf=Wo.unstable_NormalPriority,d1=Wo.unstable_LowPriority,zg=Wo.unstable_IdlePriority,yC=Wo.log,vC=Wo.unstable_setDisableYieldValue,Ad=null,Ra=null,ei=null,Cd=!1,Nu=typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u",Ja=Math.clz32?Math.clz32:er,BT=Math.log,bC=Math.LN2,Dd=256,f1=4194304,Qs=2,kh=8,Rd=32,sb=268435456,Nh=Math.random().toString(36).slice(2),_l="__reactFiber$"+Nh,yc="__reactProps$"+Nh,Od="__reactContainer$"+Nh,p1="__reactEvents$"+Nh,FT="__reactListeners$"+Nh,VT="__reactHandles$"+Nh,UT="__reactResources$"+Nh,Ny="__reactMarker$"+Nh,jT=new Set,Jp={},ob={},Id={button:!0,checkbox:!0,image:!0,hidden:!0,radio:!0,reset:!0,submit:!0},xC=RegExp("^[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),wC={},TC={},ab=0,EC,SC,AC,CC,lb,HT,cb;_i.__reactDisabledLog=!0;var m1,g1,ub=!1,_1=new(typeof WeakMap=="function"?WeakMap:Map),hu=null,Lh=!1,DC=/[\n"\\]/g,$T=!1,GT=!1,y1=!1,qT=!1,v1=!1,RC=!1,OC=["value","defaultValue"],IC=!1,MC=/["'&<>\n\t]|^\s|\s$/,PC="address applet area article aside base basefont bgsound blockquote body br button caption center col colgroup dd details dir div dl dt embed fieldset figcaption figure footer form frame frameset h1 h2 h3 h4 h5 h6 head header hgroup hr html iframe img input isindex li link listing main marquee menu menuitem meta nav noembed noframes noscript object ol p param plaintext pre script section select source style summary table tbody td template textarea tfoot th thead title tr track ul wbr xmp".split(" "),qf="applet caption html table td th marquee object template foreignObject desc title".split(" "),hb=qf.concat(["button"]),db="dd dt li option optgroup p rp rt".split(" "),fb={current:null,formTag:null,aTagInScope:null,buttonTagInScope:null,nobrTagInScope:null,pTagInButtonScope:null,listItemTagAutoclosing:null,dlItemTagAutoclosing:null,containerTagInScope:null,implicitRootScope:!1},em={},b1={animation:"animationDelay animationDirection animationDuration animationFillMode animationIterationCount animationName animationPlayState animationTimingFunction".split(" "),background:"backgroundAttachment backgroundClip backgroundColor backgroundImage backgroundOrigin backgroundPositionX backgroundPositionY backgroundRepeat backgroundSize".split(" "),backgroundPosition:["backgroundPositionX","backgroundPositionY"],border:"borderBottomColor borderBottomStyle borderBottomWidth borderImageOutset borderImageRepeat borderImageSlice borderImageSource borderImageWidth borderLeftColor borderLeftStyle borderLeftWidth borderRightColor borderRightStyle borderRightWidth borderTopColor borderTopStyle borderTopWidth".split(" "),borderBlockEnd:["borderBlockEndColor","borderBlockEndStyle","borderBlockEndWidth"],borderBlockStart:["borderBlockStartColor","borderBlockStartStyle","borderBlockStartWidth"],borderBottom:["borderBottomColor","borderBottomStyle","borderBottomWidth"],borderColor:["borderBottomColor","borderLeftColor","borderRightColor","borderTopColor"],borderImage:["borderImageOutset","borderImageRepeat","borderImageSlice","borderImageSource","borderImageWidth"],borderInlineEnd:["borderInlineEndColor","borderInlineEndStyle","borderInlineEndWidth"],borderInlineStart:["borderInlineStartColor","borderInlineStartStyle","borderInlineStartWidth"],borderLeft:["borderLeftColor","borderLeftStyle","borderLeftWidth"],borderRadius:["borderBottomLeftRadius","borderBottomRightRadius","borderTopLeftRadius","borderTopRightRadius"],borderRight:["borderRightColor","borderRightStyle","borderRightWidth"],borderStyle:["borderBottomStyle","borderLeftStyle","borderRightStyle","borderTopStyle"],borderTop:["borderTopColor","borderTopStyle","borderTopWidth"],borderWidth:["borderBottomWidth","borderLeftWidth","borderRightWidth","borderTopWidth"],columnRule:["columnRuleColor","columnRuleStyle","columnRuleWidth"],columns:["columnCount","columnWidth"],flex:["flexBasis","flexGrow","flexShrink"],flexFlow:["flexDirection","flexWrap"],font:"fontFamily fontFeatureSettings fontKerning fontLanguageOverride fontSize fontSizeAdjust fontStretch fontStyle fontVariant fontVariantAlternates fontVariantCaps fontVariantEastAsian fontVariantLigatures fontVariantNumeric fontVariantPosition fontWeight lineHeight".split(" "),fontVariant:"fontVariantAlternates fontVariantCaps fontVariantEastAsian fontVariantLigatures fontVariantNumeric fontVariantPosition".split(" "),gap:["columnGap","rowGap"],grid:"gridAutoColumns gridAutoFlow gridAutoRows gridTemplateAreas gridTemplateColumns gridTemplateRows".split(" "),gridArea:["gridColumnEnd","gridColumnStart","gridRowEnd","gridRowStart"],gridColumn:["gridColumnEnd","gridColumnStart"],gridColumnGap:["columnGap"],gridGap:["columnGap","rowGap"],gridRow:["gridRowEnd","gridRowStart"],gridRowGap:["rowGap"],gridTemplate:["gridTemplateAreas","gridTemplateColumns","gridTemplateRows"],listStyle:["listStyleImage","listStylePosition","listStyleType"],margin:["marginBottom","marginLeft","marginRight","marginTop"],marker:["markerEnd","markerMid","markerStart"],mask:"maskClip maskComposite maskImage maskMode maskOrigin maskPositionX maskPositionY maskRepeat maskSize".split(" "),maskPosition:["maskPositionX","maskPositionY"],outline:["outlineColor","outlineStyle","outlineWidth"],overflow:["overflowX","overflowY"],padding:["paddingBottom","paddingLeft","paddingRight","paddingTop"],placeContent:["alignContent","justifyContent"],placeItems:["alignItems","justifyItems"],placeSelf:["alignSelf","justifySelf"],textDecoration:["textDecorationColor","textDecorationLine","textDecorationStyle"],textEmphasis:["textEmphasisColor","textEmphasisStyle"],transition:["transitionDelay","transitionDuration","transitionProperty","transitionTimingFunction"],wordWrap:["overflowWrap"]},WT=/([A-Z])/g,YT=/^ms-/,kC=/^(?:webkit|moz|o)[A-Z]/,EM=/^-ms-/,SM=/-(.)/g,ZT=/;\s*$/,Wf={},x1={},NC=!1,XT=!1,w1=new Set("animationIterationCount aspectRatio borderImageOutset borderImageSlice borderImageWidth boxFlex boxFlexGroup boxOrdinalGroup columnCount columns flex flexGrow flexPositive flexShrink flexNegative flexOrder gridArea gridRow gridRowEnd gridRowSpan gridRowStart gridColumn gridColumnEnd gridColumnSpan gridColumnStart fontWeight lineClamp lineHeight opacity order orphans scale tabSize widows zIndex zoom fillOpacity floodOpacity stopOpacity strokeDasharray strokeDashoffset strokeMiterlimit strokeOpacity strokeWidth MozAnimationIterationCount MozBoxFlex MozBoxFlexGroup MozLineClamp msAnimationIterationCount msFlex msZoom msFlexGrow msFlexNegative msFlexOrder msFlexPositive msFlexShrink msGridColumn msGridColumnSpan msGridRow msGridRowSpan WebkitAnimationIterationCount WebkitBoxFlex WebKitBoxFlexGroup WebkitBoxOrdinalGroup WebkitColumnCount WebkitColumns WebkitFlex WebkitFlexGrow WebkitFlexPositive WebkitFlexShrink WebkitLineClamp".split(" ")),pb="http://www.w3.org/1998/Math/MathML",Bg="http://www.w3.org/2000/svg",LC=new Map([["acceptCharset","accept-charset"],["htmlFor","for"],["httpEquiv","http-equiv"],["crossOrigin","crossorigin"],["accentHeight","accent-height"],["alignmentBaseline","alignment-baseline"],["arabicForm","arabic-form"],["baselineShift","baseline-shift"],["capHeight","cap-height"],["clipPath","clip-path"],["clipRule","clip-rule"],["colorInterpolation","color-interpolation"],["colorInterpolationFilters","color-interpolation-filters"],["colorProfile","color-profile"],["colorRendering","color-rendering"],["dominantBaseline","dominant-baseline"],["enableBackground","enable-background"],["fillOpacity","fill-opacity"],["fillRule","fill-rule"],["floodColor","flood-color"],["floodOpacity","flood-opacity"],["fontFamily","font-family"],["fontSize","font-size"],["fontSizeAdjust","font-size-adjust"],["fontStretch","font-stretch"],["fontStyle","font-style"],["fontVariant","font-variant"],["fontWeight","font-weight"],["glyphName","glyph-name"],["glyphOrientationHorizontal","glyph-orientation-horizontal"],["glyphOrientationVertical","glyph-orientation-vertical"],["horizAdvX","horiz-adv-x"],["horizOriginX","horiz-origin-x"],["imageRendering","image-rendering"],["letterSpacing","letter-spacing"],["lightingColor","lighting-color"],["markerEnd","marker-end"],["markerMid","marker-mid"],["markerStart","marker-start"],["overlinePosition","overline-position"],["overlineThickness","overline-thickness"],["paintOrder","paint-order"],["panose-1","panose-1"],["pointerEvents","pointer-events"],["renderingIntent","rendering-intent"],["shapeRendering","shape-rendering"],["stopColor","stop-color"],["stopOpacity","stop-opacity"],["strikethroughPosition","strikethrough-position"],["strikethroughThickness","strikethrough-thickness"],["strokeDasharray","stroke-dasharray"],["strokeDashoffset","stroke-dashoffset"],["strokeLinecap","stroke-linecap"],["strokeLinejoin","stroke-linejoin"],["strokeMiterlimit","stroke-miterlimit"],["strokeOpacity","stroke-opacity"],["strokeWidth","stroke-width"],["textAnchor","text-anchor"],["textDecoration","text-decoration"],["textRendering","text-rendering"],["transformOrigin","transform-origin"],["underlinePosition","underline-position"],["underlineThickness","underline-thickness"],["unicodeBidi","unicode-bidi"],["unicodeRange","unicode-range"],["unitsPerEm","units-per-em"],["vAlphabetic","v-alphabetic"],["vHanging","v-hanging"],["vIdeographic","v-ideographic"],["vMathematical","v-mathematical"],["vectorEffect","vector-effect"],["vertAdvY","vert-adv-y"],["vertOriginX","vert-origin-x"],["vertOriginY","vert-origin-y"],["wordSpacing","word-spacing"],["writingMode","writing-mode"],["xmlnsXlink","xmlns:xlink"],["xHeight","x-height"]]),mb={accept:"accept",acceptcharset:"acceptCharset","accept-charset":"acceptCharset",accesskey:"accessKey",action:"action",allowfullscreen:"allowFullScreen",alt:"alt",as:"as",async:"async",autocapitalize:"autoCapitalize",autocomplete:"autoComplete",autocorrect:"autoCorrect",autofocus:"autoFocus",autoplay:"autoPlay",autosave:"autoSave",capture:"capture",cellpadding:"cellPadding",cellspacing:"cellSpacing",challenge:"challenge",charset:"charSet",checked:"checked",children:"children",cite:"cite",class:"className",classid:"classID",classname:"className",cols:"cols",colspan:"colSpan",content:"content",contenteditable:"contentEditable",contextmenu:"contextMenu",controls:"controls",controlslist:"controlsList",coords:"coords",crossorigin:"crossOrigin",dangerouslysetinnerhtml:"dangerouslySetInnerHTML",data:"data",datetime:"dateTime",default:"default",defaultchecked:"defaultChecked",defaultvalue:"defaultValue",defer:"defer",dir:"dir",disabled:"disabled",disablepictureinpicture:"disablePictureInPicture",disableremoteplayback:"disableRemotePlayback",download:"download",draggable:"draggable",enctype:"encType",enterkeyhint:"enterKeyHint",fetchpriority:"fetchPriority",for:"htmlFor",form:"form",formmethod:"formMethod",formaction:"formAction",formenctype:"formEncType",formnovalidate:"formNoValidate",formtarget:"formTarget",frameborder:"frameBorder",headers:"headers",height:"height",hidden:"hidden",high:"high",href:"href",hreflang:"hrefLang",htmlfor:"htmlFor",httpequiv:"httpEquiv","http-equiv":"httpEquiv",icon:"icon",id:"id",imagesizes:"imageSizes",imagesrcset:"imageSrcSet",inert:"inert",innerhtml:"innerHTML",inputmode:"inputMode",integrity:"integrity",is:"is",itemid:"itemID",itemprop:"itemProp",itemref:"itemRef",itemscope:"itemScope",itemtype:"itemType",keyparams:"keyParams",keytype:"keyType",kind:"kind",label:"label",lang:"lang",list:"list",loop:"loop",low:"low",manifest:"manifest",marginwidth:"marginWidth",marginheight:"marginHeight",max:"max",maxlength:"maxLength",media:"media",mediagroup:"mediaGroup",method:"method",min:"min",minlength:"minLength",multiple:"multiple",muted:"muted",name:"name",nomodule:"noModule",nonce:"nonce",novalidate:"noValidate",open:"open",optimum:"optimum",pattern:"pattern",placeholder:"placeholder",playsinline:"playsInline",poster:"poster",preload:"preload",profile:"profile",radiogroup:"radioGroup",readonly:"readOnly",referrerpolicy:"referrerPolicy",rel:"rel",required:"required",reversed:"reversed",role:"role",rows:"rows",rowspan:"rowSpan",sandbox:"sandbox",scope:"scope",scoped:"scoped",scrolling:"scrolling",seamless:"seamless",selected:"selected",shape:"shape",size:"size",sizes:"sizes",span:"span",spellcheck:"spellCheck",src:"src",srcdoc:"srcDoc",srclang:"srcLang",srcset:"srcSet",start:"start",step:"step",style:"style",summary:"summary",tabindex:"tabIndex",target:"target",title:"title",type:"type",usemap:"useMap",value:"value",width:"width",wmode:"wmode",wrap:"wrap",about:"about",accentheight:"accentHeight","accent-height":"accentHeight",accumulate:"accumulate",additive:"additive",alignmentbaseline:"alignmentBaseline","alignment-baseline":"alignmentBaseline",allowreorder:"allowReorder",alphabetic:"alphabetic",amplitude:"amplitude",arabicform:"arabicForm","arabic-form":"arabicForm",ascent:"ascent",attributename:"attributeName",attributetype:"attributeType",autoreverse:"autoReverse",azimuth:"azimuth",basefrequency:"baseFrequency",baselineshift:"baselineShift","baseline-shift":"baselineShift",baseprofile:"baseProfile",bbox:"bbox",begin:"begin",bias:"bias",by:"by",calcmode:"calcMode",capheight:"capHeight","cap-height":"capHeight",clip:"clip",clippath:"clipPath","clip-path":"clipPath",clippathunits:"clipPathUnits",cliprule:"clipRule","clip-rule":"clipRule",color:"color",colorinterpolation:"colorInterpolation","color-interpolation":"colorInterpolation",colorinterpolationfilters:"colorInterpolationFilters","color-interpolation-filters":"colorInterpolationFilters",colorprofile:"colorProfile","color-profile":"colorProfile",colorrendering:"colorRendering","color-rendering":"colorRendering",contentscripttype:"contentScriptType",contentstyletype:"contentStyleType",cursor:"cursor",cx:"cx",cy:"cy",d:"d",datatype:"datatype",decelerate:"decelerate",descent:"descent",diffuseconstant:"diffuseConstant",direction:"direction",display:"display",divisor:"divisor",dominantbaseline:"dominantBaseline","dominant-baseline":"dominantBaseline",dur:"dur",dx:"dx",dy:"dy",edgemode:"edgeMode",elevation:"elevation",enablebackground:"enableBackground","enable-background":"enableBackground",end:"end",exponent:"exponent",externalresourcesrequired:"externalResourcesRequired",fill:"fill",fillopacity:"fillOpacity","fill-opacity":"fillOpacity",fillrule:"fillRule","fill-rule":"fillRule",filter:"filter",filterres:"filterRes",filterunits:"filterUnits",floodopacity:"floodOpacity","flood-opacity":"floodOpacity",floodcolor:"floodColor","flood-color":"floodColor",focusable:"focusable",fontfamily:"fontFamily","font-family":"fontFamily",fontsize:"fontSize","font-size":"fontSize",fontsizeadjust:"fontSizeAdjust","font-size-adjust":"fontSizeAdjust",fontstretch:"fontStretch","font-stretch":"fontStretch",fontstyle:"fontStyle","font-style":"fontStyle",fontvariant:"fontVariant","font-variant":"fontVariant",fontweight:"fontWeight","font-weight":"fontWeight",format:"format",from:"from",fx:"fx",fy:"fy",g1:"g1",g2:"g2",glyphname:"glyphName","glyph-name":"glyphName",glyphorientationhorizontal:"glyphOrientationHorizontal","glyph-orientation-horizontal":"glyphOrientationHorizontal",glyphorientationvertical:"glyphOrientationVertical","glyph-orientation-vertical":"glyphOrientationVertical",glyphref:"glyphRef",gradienttransform:"gradientTransform",gradientunits:"gradientUnits",hanging:"hanging",horizadvx:"horizAdvX","horiz-adv-x":"horizAdvX",horizoriginx:"horizOriginX","horiz-origin-x":"horizOriginX",ideographic:"ideographic",imagerendering:"imageRendering","image-rendering":"imageRendering",in2:"in2",in:"in",inlist:"inlist",intercept:"intercept",k1:"k1",k2:"k2",k3:"k3",k4:"k4",k:"k",kernelmatrix:"kernelMatrix",kernelunitlength:"kernelUnitLength",kerning:"kerning",keypoints:"keyPoints",keysplines:"keySplines",keytimes:"keyTimes",lengthadjust:"lengthAdjust",letterspacing:"letterSpacing","letter-spacing":"letterSpacing",lightingcolor:"lightingColor","lighting-color":"lightingColor",limitingconeangle:"limitingConeAngle",local:"local",markerend:"markerEnd","marker-end":"markerEnd",markerheight:"markerHeight",markermid:"markerMid","marker-mid":"markerMid",markerstart:"markerStart","marker-start":"markerStart",markerunits:"markerUnits",markerwidth:"markerWidth",mask:"mask",maskcontentunits:"maskContentUnits",maskunits:"maskUnits",mathematical:"mathematical",mode:"mode",numoctaves:"numOctaves",offset:"offset",opacity:"opacity",operator:"operator",order:"order",orient:"orient",orientation:"orientation",origin:"origin",overflow:"overflow",overlineposition:"overlinePosition","overline-position":"overlinePosition",overlinethickness:"overlineThickness","overline-thickness":"overlineThickness",paintorder:"paintOrder","paint-order":"paintOrder",panose1:"panose1","panose-1":"panose1",pathlength:"pathLength",patterncontentunits:"patternContentUnits",patterntransform:"patternTransform",patternunits:"patternUnits",pointerevents:"pointerEvents","pointer-events":"pointerEvents",points:"points",pointsatx:"pointsAtX",pointsaty:"pointsAtY",pointsatz:"pointsAtZ",popover:"popover",popovertarget:"popoverTarget",popovertargetaction:"popoverTargetAction",prefix:"prefix",preservealpha:"preserveAlpha",preserveaspectratio:"preserveAspectRatio",primitiveunits:"primitiveUnits",property:"property",r:"r",radius:"radius",refx:"refX",refy:"refY",renderingintent:"renderingIntent","rendering-intent":"renderingIntent",repeatcount:"repeatCount",repeatdur:"repeatDur",requiredextensions:"requiredExtensions",requiredfeatures:"requiredFeatures",resource:"resource",restart:"restart",result:"result",results:"results",rotate:"rotate",rx:"rx",ry:"ry",scale:"scale",security:"security",seed:"seed",shaperendering:"shapeRendering","shape-rendering":"shapeRendering",slope:"slope",spacing:"spacing",specularconstant:"specularConstant",specularexponent:"specularExponent",speed:"speed",spreadmethod:"spreadMethod",startoffset:"startOffset",stddeviation:"stdDeviation",stemh:"stemh",stemv:"stemv",stitchtiles:"stitchTiles",stopcolor:"stopColor","stop-color":"stopColor",stopopacity:"stopOpacity","stop-opacity":"stopOpacity",strikethroughposition:"strikethroughPosition","strikethrough-position":"strikethroughPosition",strikethroughthickness:"strikethroughThickness","strikethrough-thickness":"strikethroughThickness",string:"string",stroke:"stroke",strokedasharray:"strokeDasharray","stroke-dasharray":"strokeDasharray",strokedashoffset:"strokeDashoffset","stroke-dashoffset":"strokeDashoffset",strokelinecap:"strokeLinecap","stroke-linecap":"strokeLinecap",strokelinejoin:"strokeLinejoin","stroke-linejoin":"strokeLinejoin",strokemiterlimit:"strokeMiterlimit","stroke-miterlimit":"strokeMiterlimit",strokewidth:"strokeWidth","stroke-width":"strokeWidth",strokeopacity:"strokeOpacity","stroke-opacity":"strokeOpacity",suppresscontenteditablewarning:"suppressContentEditableWarning",suppresshydrationwarning:"suppressHydrationWarning",surfacescale:"surfaceScale",systemlanguage:"systemLanguage",tablevalues:"tableValues",targetx:"targetX",targety:"targetY",textanchor:"textAnchor","text-anchor":"textAnchor",textdecoration:"textDecoration","text-decoration":"textDecoration",textlength:"textLength",textrendering:"textRendering","text-rendering":"textRendering",to:"to",transform:"transform",transformorigin:"transformOrigin","transform-origin":"transformOrigin",typeof:"typeof",u1:"u1",u2:"u2",underlineposition:"underlinePosition","underline-position":"underlinePosition",underlinethickness:"underlineThickness","underline-thickness":"underlineThickness",unicode:"unicode",unicodebidi:"unicodeBidi","unicode-bidi":"unicodeBidi",unicoderange:"unicodeRange","unicode-range":"unicodeRange",unitsperem:"unitsPerEm","units-per-em":"unitsPerEm",unselectable:"unselectable",valphabetic:"vAlphabetic","v-alphabetic":"vAlphabetic",values:"values",vectoreffect:"vectorEffect","vector-effect":"vectorEffect",version:"version",vertadvy:"vertAdvY","vert-adv-y":"vertAdvY",vertoriginx:"vertOriginX","vert-origin-x":"vertOriginX",vertoriginy:"vertOriginY","vert-origin-y":"vertOriginY",vhanging:"vHanging","v-hanging":"vHanging",videographic:"vIdeographic","v-ideographic":"vIdeographic",viewbox:"viewBox",viewtarget:"viewTarget",visibility:"visibility",vmathematical:"vMathematical","v-mathematical":"vMathematical",vocab:"vocab",widths:"widths",wordspacing:"wordSpacing","word-spacing":"wordSpacing",writingmode:"writingMode","writing-mode":"writingMode",x1:"x1",x2:"x2",x:"x",xchannelselector:"xChannelSelector",xheight:"xHeight","x-height":"xHeight",xlinkactuate:"xlinkActuate","xlink:actuate":"xlinkActuate",xlinkarcrole:"xlinkArcrole","xlink:arcrole":"xlinkArcrole",xlinkhref:"xlinkHref","xlink:href":"xlinkHref",xlinkrole:"xlinkRole","xlink:role":"xlinkRole",xlinkshow:"xlinkShow","xlink:show":"xlinkShow",xlinktitle:"xlinkTitle","xlink:title":"xlinkTitle",xlinktype:"xlinkType","xlink:type":"xlinkType",xmlbase:"xmlBase","xml:base":"xmlBase",xmllang:"xmlLang","xml:lang":"xmlLang",xmlns:"xmlns","xml:space":"xmlSpace",xmlnsxlink:"xmlnsXlink","xmlns:xlink":"xmlnsXlink",xmlspace:"xmlSpace",y1:"y1",y2:"y2",y:"y",ychannelselector:"yChannelSelector",z:"z",zoomandpan:"zoomAndPan"},QT={"aria-current":0,"aria-description":0,"aria-details":0,"aria-disabled":0,"aria-hidden":0,"aria-invalid":0,"aria-keyshortcuts":0,"aria-label":0,"aria-roledescription":0,"aria-autocomplete":0,"aria-checked":0,"aria-expanded":0,"aria-haspopup":0,"aria-level":0,"aria-modal":0,"aria-multiline":0,"aria-multiselectable":0,"aria-orientation":0,"aria-placeholder":0,"aria-pressed":0,"aria-readonly":0,"aria-required":0,"aria-selected":0,"aria-sort":0,"aria-valuemax":0,"aria-valuemin":0,"aria-valuenow":0,"aria-valuetext":0,"aria-atomic":0,"aria-busy":0,"aria-live":0,"aria-relevant":0,"aria-dropeffect":0,"aria-grabbed":0,"aria-activedescendant":0,"aria-colcount":0,"aria-colindex":0,"aria-colspan":0,"aria-controls":0,"aria-describedby":0,"aria-errormessage":0,"aria-flowto":0,"aria-labelledby":0,"aria-owns":0,"aria-posinset":0,"aria-rowcount":0,"aria-rowindex":0,"aria-rowspan":0,"aria-setsize":0},Ly={},zC=RegExp("^(aria)-[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),BC=RegExp("^(aria)[A-Z][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),tm=!1,yl={},KT=/^on./,FC=/^on[^A-Z]/,T1=RegExp("^(aria)-[:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),AM=RegExp("^(aria)[A-Z][:A-Z_a-z\\u00C0-\\u00D6\\u00D8-\\u00F6\\u00F8-\\u02FF\\u0370-\\u037D\\u037F-\\u1FFF\\u200C-\\u200D\\u2070-\\u218F\\u2C00-\\u2FEF\\u3001-\\uD7FF\\uF900-\\uFDCF\\uFDF0-\\uFFFD\\-.0-9\\u00B7\\u0300-\\u036F\\u203F-\\u2040]*$"),VC=/^[\u0000-\u001F ]*j[\r\n\t]*a[\r\n\t]*v[\r\n\t]*a[\r\n\t]*s[\r\n\t]*c[\r\n\t]*r[\r\n\t]*i[\r\n\t]*p[\r\n\t]*t[\r\n\t]*:/i,Yf=null,Fg=null,Vg=null,JT=!1,Md=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),E1=!1;if(Md)try{var Zf={};Object.defineProperty(Zf,"passive",{get:function(){E1=!0}}),window.addEventListener("test",Zf,Zf),window.removeEventListener("test",Zf,Zf)}catch{E1=!1}var Pd=null,Xf=null,Qf=null,zh={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(a){return a.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},zy=so(zh),nm=br({},zh,{view:0,detail:0}),CM=so(nm),Ug,gb,Vl,Kf=br({},nm,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:nc,button:0,buttons:0,relatedTarget:function(a){return a.relatedTarget===void 0?a.fromElement===a.srcElement?a.toElement:a.fromElement:a.relatedTarget},movementX:function(a){return"movementX"in a?a.movementX:(a!==Vl&&(Vl&&a.type==="mousemove"?(Ug=a.screenX-Vl.screenX,gb=a.screenY-Vl.screenY):gb=Ug=0,Vl=a),Ug)},movementY:function(a){return"movementY"in a?a.movementY:gb}}),S1=so(Kf),By=br({},Kf,{dataTransfer:0}),Fy=so(By),UC=br({},nm,{relatedTarget:0}),_b=so(UC),jC=br({},zh,{animationName:0,elapsedTime:0,pseudoElement:0}),HC=so(jC),A1=br({},zh,{clipboardData:function(a){return"clipboardData"in a?a.clipboardData:window.clipboardData}}),DM=so(A1),yb=br({},zh,{data:0}),eE=so(yb),tE=eE,RM={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},C1={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},OM={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"},$C=br({},nm,{key:function(a){if(a.key){var h=RM[a.key]||a.key;if(h!=="Unidentified")return h}return a.type==="keypress"?(a=Ol(a),a===13?"Enter":String.fromCharCode(a)):a.type==="keydown"||a.type==="keyup"?C1[a.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:nc,charCode:function(a){return a.type==="keypress"?Ol(a):0},keyCode:function(a){return a.type==="keydown"||a.type==="keyup"?a.keyCode:0},which:function(a){return a.type==="keypress"?Ol(a):a.type==="keydown"||a.type==="keyup"?a.keyCode:0}}),GC=so($C),qC=br({},Kf,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),WC=so(qC),YC=br({},nm,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:nc}),IM=so(YC),ZC=br({},zh,{propertyName:0,elapsedTime:0,pseudoElement:0}),XC=so(ZC),QC=br({},Kf,{deltaX:function(a){return"deltaX"in a?a.deltaX:"wheelDeltaX"in a?-a.wheelDeltaX:0},deltaY:function(a){return"deltaY"in a?a.deltaY:"wheelDeltaY"in a?-a.wheelDeltaY:"wheelDelta"in a?-a.wheelDelta:0},deltaZ:0,deltaMode:0}),KC=so(QC),MM=br({},zh,{newState:0,oldState:0}),PM=so(MM),kM=[9,13,27,32],JC=229,nE=Md&&"CompositionEvent"in window,vb=null;Md&&"documentMode"in document&&(vb=document.documentMode);var NM=Md&&"TextEvent"in window&&!vb,iE=Md&&(!nE||vb&&8<vb&&11>=vb),eD=32,tD=String.fromCharCode(eD),nD=!1,im=!1,rE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0},Vy=null,Uy=null,sE=!1;Md&&(sE=Kh("input")&&(!document.documentMode||9<document.documentMode));var vl=typeof Object.is=="function"?Object.is:cl,iD=Md&&"documentMode"in document&&11>=document.documentMode,jg=null,D1=null,jy=null,bb=!1,Hg={animationend:Il("Animation","AnimationEnd"),animationiteration:Il("Animation","AnimationIteration"),animationstart:Il("Animation","AnimationStart"),transitionrun:Il("Transition","TransitionRun"),transitionstart:Il("Transition","TransitionStart"),transitioncancel:Il("Transition","TransitionCancel"),transitionend:Il("Transition","TransitionEnd")},oE={},Hy={};Md&&(Hy=document.createElement("div").style,"AnimationEvent"in window||(delete Hg.animationend.animation,delete Hg.animationiteration.animation,delete Hg.animationstart.animation),"TransitionEvent"in window||delete Hg.transitionend.transition);var aE=Ya("animationend"),rD=Ya("animationiteration"),sD=Ya("animationstart"),LM=Ya("transitionrun"),zM=Ya("transitionstart"),BM=Ya("transitioncancel"),oD=Ya("transitionend"),aD=new Map,lE="abort auxClick beforeToggle cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");lE.push("scrollEnd");var R1=new WeakMap,O1=1,xs=2,Lu=[],kd=0,cE=0,rm={};Object.freeze(rm);var du=null,sm=null,Hs=0,uE=1,el=2,tl=8,vc=16,I1=64,lD=!1;try{var cD=Object.preventExtensions({})}catch{lD=!0}var $y=[],Gy=0,Oa=null,om=0,nl=[],bc=0,Nd=null,Jf=1,Ld="",bl=null,So=null,qr=!1,zd=!1,xc=null,am=null,Bh=!1,hE=Error("Hydration Mismatch Exception: This is not a real error, and should not leak into userspace. If you're seeing this, it's likely a bug in React."),dE=0;if(typeof performance=="object"&&typeof performance.now=="function")var uD=performance,fE=function(){return uD.now()};else{var hD=Date;fE=function(){return hD.now()}}var zu=oe(null),M1=oe(null),P1={},lm=null,wc=null,$g=!1,dD=typeof AbortController<"u"?AbortController:function(){var a=[],h=this.signal={aborted:!1,addEventListener:function(v,S){a.push(S)}};this.abort=function(){h.aborted=!0,a.forEach(function(v){return v()})}},fD=Wo.unstable_scheduleCallback,pD=Wo.unstable_NormalPriority,da={$$typeof:Ph,Consumer:null,Provider:null,_currentValue:null,_currentValue2:null,_threadCount:0,_currentRenderer:null,_currentRenderer2:null},qy=Wo.unstable_now,pE=-0,xb=-0,Yo=-1.1,Fh=-0,Wy=!1,wb=!1,cm=null,k1=0,um=0,xl=null,N1=Jt.S;Jt.S=function(a,h){typeof h=="object"&&h!==null&&typeof h.then=="function"&&m0(a,h),N1!==null&&N1(a,h)};var Bu=oe(null),il={recordUnsafeLifecycleWarnings:function(){},flushPendingUnsafeLifecycleWarnings:function(){},recordLegacyContextWarning:function(){},flushLegacyContextWarning:function(){},discardPendingWarnings:function(){}},Yy=[],Zy=[],hm=[],Xy=[],dm=[],fm=[],Gg=new Set;il.recordUnsafeLifecycleWarnings=function(a,h){Gg.has(a.type)||(typeof h.componentWillMount=="function"&&h.componentWillMount.__suppressDeprecationWarning!==!0&&Yy.push(a),a.mode&tl&&typeof h.UNSAFE_componentWillMount=="function"&&Zy.push(a),typeof h.componentWillReceiveProps=="function"&&h.componentWillReceiveProps.__suppressDeprecationWarning!==!0&&hm.push(a),a.mode&tl&&typeof h.UNSAFE_componentWillReceiveProps=="function"&&Xy.push(a),typeof h.componentWillUpdate=="function"&&h.componentWillUpdate.__suppressDeprecationWarning!==!0&&dm.push(a),a.mode&tl&&typeof h.UNSAFE_componentWillUpdate=="function"&&fm.push(a))},il.flushPendingUnsafeLifecycleWarnings=function(){var a=new Set;0<Yy.length&&(Yy.forEach(function(ee){a.add(Te(ee)||"Component"),Gg.add(ee.type)}),Yy=[]);var h=new Set;0<Zy.length&&(Zy.forEach(function(ee){h.add(Te(ee)||"Component"),Gg.add(ee.type)}),Zy=[]);var v=new Set;0<hm.length&&(hm.forEach(function(ee){v.add(Te(ee)||"Component"),Gg.add(ee.type)}),hm=[]);var S=new Set;0<Xy.length&&(Xy.forEach(function(ee){S.add(Te(ee)||"Component"),Gg.add(ee.type)}),Xy=[]);var I=new Set;0<dm.length&&(dm.forEach(function(ee){I.add(Te(ee)||"Component"),Gg.add(ee.type)}),dm=[]);var k=new Set;if(0<fm.length&&(fm.forEach(function(ee){k.add(Te(ee)||"Component"),Gg.add(ee.type)}),fm=[]),0<h.size){var K=z(h);console.error(`Using UNSAFE_componentWillMount in strict mode is not recommended and may indicate bugs in your code. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.

Please update the following components: %s`,K)}0<S.size&&(K=z(S),console.error(`Using UNSAFE_componentWillReceiveProps in strict mode is not recommended and may indicate bugs in your code. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://react.dev/link/derived-state

Please update the following components: %s`,K)),0<k.size&&(K=z(k),console.error(`Using UNSAFE_componentWillUpdate in strict mode is not recommended and may indicate bugs in your code. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.

Please update the following components: %s`,K)),0<a.size&&(K=z(a),console.warn(`componentWillMount has been renamed, and is not recommended for use. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move code with side effects to componentDidMount, and set initial state in the constructor.
* Rename componentWillMount to UNSAFE_componentWillMount to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,K)),0<v.size&&(K=z(v),console.warn(`componentWillReceiveProps has been renamed, and is not recommended for use. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* If you're updating state whenever props change, refactor your code to use memoization techniques or move it to static getDerivedStateFromProps. Learn more at: https://react.dev/link/derived-state
* Rename componentWillReceiveProps to UNSAFE_componentWillReceiveProps to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,K)),0<I.size&&(K=z(I),console.warn(`componentWillUpdate has been renamed, and is not recommended for use. See https://react.dev/link/unsafe-component-lifecycles for details.

* Move data fetching code or side effects to componentDidUpdate.
* Rename componentWillUpdate to UNSAFE_componentWillUpdate to suppress this warning in non-strict mode. In React 18.x, only the UNSAFE_ name will work. To rename all deprecated lifecycles to their new names, you can run \`npx react-codemod rename-unsafe-lifecycles\` in your project source folder.

Please update the following components: %s`,K))};var L1=new Map,mD=new Set;il.recordLegacyContextWarning=function(a,h){for(var v=null,S=a;S!==null;)S.mode&tl&&(v=S),S=S.return;v===null?console.error("Expected to find a StrictMode component in a strict mode tree. This error is likely caused by a bug in React. Please file an issue."):!mD.has(a.type)&&(S=L1.get(v),a.type.contextTypes!=null||a.type.childContextTypes!=null||h!==null&&typeof h.getChildContext=="function")&&(S===void 0&&(S=[],L1.set(v,S)),S.push(a))},il.flushLegacyContextWarning=function(){L1.forEach(function(a){if(a.length!==0){var h=a[0],v=new Set;a.forEach(function(I){v.add(Te(I)||"Component"),mD.add(I.type)});var S=z(v);Ze(h,function(){console.error(`Legacy context API has been detected within a strict-mode tree.

The old API will be supported in all 16.x releases, but applications using it should migrate to the new version.

Please update the following components: %s

Learn more about this warning here: https://react.dev/link/legacy-context`,S)})}})},il.discardPendingWarnings=function(){Yy=[],Zy=[],hm=[],Xy=[],dm=[],fm=[],L1=new Map};var Bd=Error("Suspense Exception: This is not a real error! It's an implementation detail of `use` to interrupt the current render. You must either rethrow it immediately, or move the `use` call outside of the `try/catch` block. Capturing without rethrowing will lead to unexpected behavior.\n\nTo handle async errors, wrap your component in an error boundary, or call the promise's `.catch` method and pass the result to `use`."),gD=Error("Suspense Exception: This is not a real error, and should not leak into userspace. If you're seeing this, it's likely a bug in React."),Qy=Error("Suspense Exception: This is not a real error! It's an implementation detail of `useActionState` to interrupt the current render. You must either rethrow it immediately, or move the `useActionState` call outside of the `try/catch` block. Capturing without rethrowing will lead to unexpected behavior.\n\nTo handle async errors, wrap your component in an error boundary."),mE={then:function(){console.error('Internal React error: A listener was unexpectedly attached to a "noop" thenable. This is a bug in React. Please file an issue.')}},Ky=null,qg=!1,fu=0,pu=1,Ul=2,Ia=4,fa=8,gE=0,z1=1,_D=2,_E=3,Fu=!1,ep=!1,B1=null,Tb=!1,tp=oe(null),Jy=oe(0),ev,yE=new Set,tv=new Set,F1=new Set,yD=new Set,jl=0,Qi=null,hs=null,ao=null,pm=!1,Fd=!1,Vd=!1,V1=0,Eb=0,Tc=null,U1=0,FM=25,en=null,mu=null,np=-1,nv=!1,j1={readContext:as,use:eu,useCallback:po,useContext:po,useEffect:po,useImperativeHandle:po,useLayoutEffect:po,useInsertionEffect:po,useMemo:po,useReducer:po,useRef:po,useState:po,useDebugValue:po,useDeferredValue:po,useTransition:po,useSyncExternalStore:po,useId:po,useHostTransitionStatus:po,useFormState:po,useActionState:po,useOptimistic:po,useMemoCache:po,useCacheRefresh:po},H1=null,vD=null,$1=null,bD=null,Ud=null,Ec=null,Wg=null;H1={readContext:function(a){return as(a)},use:eu,useCallback:function(a,h){return en="useCallback",ri(),nd(h),J_(a,h)},useContext:function(a){return en="useContext",ri(),as(a)},useEffect:function(a,h){return en="useEffect",ri(),nd(h),rd(a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",ri(),nd(v),bf(a,h,v)},useInsertionEffect:function(a,h){en="useInsertionEffect",ri(),nd(h),mh(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",ri(),nd(h),sd(a,h)},useMemo:function(a,h){en="useMemo",ri(),nd(h);var v=Jt.H;Jt.H=Ud;try{return ey(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",ri();var S=Jt.H;Jt.H=Ud;try{return q_(a,h,v)}finally{Jt.H=S}},useRef:function(a){return en="useRef",ri(),cg(a)},useState:function(a){en="useState",ri();var h=Jt.H;Jt.H=Ud;try{return Cu(a)}finally{Jt.H=h}},useDebugValue:function(){en="useDebugValue",ri()},useDeferredValue:function(a,h){return en="useDeferredValue",ri(),C0(a,h)},useTransition:function(){return en="useTransition",ri(),fg()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",ri(),Pp(a,h,v)},useId:function(){return en="useId",ri(),sy()},useFormState:function(a,h){return en="useFormState",ri(),H_(),ac(a,h)},useActionState:function(a,h){return en="useActionState",ri(),ac(a,h)},useOptimistic:function(a){return en="useOptimistic",ri(),X_(a)},useHostTransitionStatus:zl,useMemoCache:Su,useCacheRefresh:function(){return en="useCacheRefresh",ri(),Iu()}},vD={readContext:function(a){return as(a)},use:eu,useCallback:function(a,h){return en="useCallback",zn(),J_(a,h)},useContext:function(a){return en="useContext",zn(),as(a)},useEffect:function(a,h){return en="useEffect",zn(),rd(a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",zn(),bf(a,h,v)},useInsertionEffect:function(a,h){en="useInsertionEffect",zn(),mh(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",zn(),sd(a,h)},useMemo:function(a,h){en="useMemo",zn();var v=Jt.H;Jt.H=Ud;try{return ey(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",zn();var S=Jt.H;Jt.H=Ud;try{return q_(a,h,v)}finally{Jt.H=S}},useRef:function(a){return en="useRef",zn(),cg(a)},useState:function(a){en="useState",zn();var h=Jt.H;Jt.H=Ud;try{return Cu(a)}finally{Jt.H=h}},useDebugValue:function(){en="useDebugValue",zn()},useDeferredValue:function(a,h){return en="useDeferredValue",zn(),C0(a,h)},useTransition:function(){return en="useTransition",zn(),fg()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",zn(),Pp(a,h,v)},useId:function(){return en="useId",zn(),sy()},useActionState:function(a,h){return en="useActionState",zn(),ac(a,h)},useFormState:function(a,h){return en="useFormState",zn(),H_(),ac(a,h)},useOptimistic:function(a){return en="useOptimistic",zn(),X_(a)},useHostTransitionStatus:zl,useMemoCache:Su,useCacheRefresh:function(){return en="useCacheRefresh",zn(),Iu()}},$1={readContext:function(a){return as(a)},use:eu,useCallback:function(a,h){return en="useCallback",zn(),Ou(a,h)},useContext:function(a){return en="useContext",zn(),as(a)},useEffect:function(a,h){en="useEffect",zn(),la(2048,fa,a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",zn(),ug(a,h,v)},useInsertionEffect:function(a,h){return en="useInsertionEffect",zn(),la(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",zn(),la(4,Ia,a,h)},useMemo:function(a,h){en="useMemo",zn();var v=Jt.H;Jt.H=Ec;try{return ty(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",zn();var S=Jt.H;Jt.H=Ec;try{return id(a,h,v)}finally{Jt.H=S}},useRef:function(){return en="useRef",zn(),es().memoizedState},useState:function(){en="useState",zn();var a=Jt.H;Jt.H=Ec;try{return id(Ea)}finally{Jt.H=a}},useDebugValue:function(){en="useDebugValue",zn()},useDeferredValue:function(a,h){return en="useDeferredValue",zn(),Hx(a,h)},useTransition:function(){return en="useTransition",zn(),R0()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",zn(),_f(a,h,v)},useId:function(){return en="useId",zn(),es().memoizedState},useFormState:function(a){return en="useFormState",zn(),H_(),Du(a)},useActionState:function(a){return en="useActionState",zn(),Du(a)},useOptimistic:function(a,h){return en="useOptimistic",zn(),E0(a,h)},useHostTransitionStatus:zl,useMemoCache:Su,useCacheRefresh:function(){return en="useCacheRefresh",zn(),es().memoizedState}},bD={readContext:function(a){return as(a)},use:eu,useCallback:function(a,h){return en="useCallback",zn(),Ou(a,h)},useContext:function(a){return en="useContext",zn(),as(a)},useEffect:function(a,h){en="useEffect",zn(),la(2048,fa,a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",zn(),ug(a,h,v)},useInsertionEffect:function(a,h){return en="useInsertionEffect",zn(),la(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",zn(),la(4,Ia,a,h)},useMemo:function(a,h){en="useMemo",zn();var v=Jt.H;Jt.H=Wg;try{return ty(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",zn();var S=Jt.H;Jt.H=Wg;try{return Au(a,h,v)}finally{Jt.H=S}},useRef:function(){return en="useRef",zn(),es().memoizedState},useState:function(){en="useState",zn();var a=Jt.H;Jt.H=Wg;try{return Au(Ea)}finally{Jt.H=a}},useDebugValue:function(){en="useDebugValue",zn()},useDeferredValue:function(a,h){return en="useDeferredValue",zn(),hg(a,h)},useTransition:function(){return en="useTransition",zn(),gh()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",zn(),_f(a,h,v)},useId:function(){return en="useId",zn(),es().memoizedState},useFormState:function(a){return en="useFormState",zn(),H_(),yf(a)},useActionState:function(a){return en="useActionState",zn(),yf(a)},useOptimistic:function(a,h){return en="useOptimistic",zn(),Ux(a,h)},useHostTransitionStatus:zl,useMemoCache:Su,useCacheRefresh:function(){return en="useCacheRefresh",zn(),es().memoizedState}},Ud={readContext:function(a){return D(),as(a)},use:function(a){return T(),eu(a)},useCallback:function(a,h){return en="useCallback",T(),ri(),J_(a,h)},useContext:function(a){return en="useContext",T(),ri(),as(a)},useEffect:function(a,h){return en="useEffect",T(),ri(),rd(a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",T(),ri(),bf(a,h,v)},useInsertionEffect:function(a,h){en="useInsertionEffect",T(),ri(),mh(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",T(),ri(),sd(a,h)},useMemo:function(a,h){en="useMemo",T(),ri();var v=Jt.H;Jt.H=Ud;try{return ey(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",T(),ri();var S=Jt.H;Jt.H=Ud;try{return q_(a,h,v)}finally{Jt.H=S}},useRef:function(a){return en="useRef",T(),ri(),cg(a)},useState:function(a){en="useState",T(),ri();var h=Jt.H;Jt.H=Ud;try{return Cu(a)}finally{Jt.H=h}},useDebugValue:function(){en="useDebugValue",T(),ri()},useDeferredValue:function(a,h){return en="useDeferredValue",T(),ri(),C0(a,h)},useTransition:function(){return en="useTransition",T(),ri(),fg()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",T(),ri(),Pp(a,h,v)},useId:function(){return en="useId",T(),ri(),sy()},useFormState:function(a,h){return en="useFormState",T(),ri(),ac(a,h)},useActionState:function(a,h){return en="useActionState",T(),ri(),ac(a,h)},useOptimistic:function(a){return en="useOptimistic",T(),ri(),X_(a)},useMemoCache:function(a){return T(),Su(a)},useHostTransitionStatus:zl,useCacheRefresh:function(){return en="useCacheRefresh",ri(),Iu()}},Ec={readContext:function(a){return D(),as(a)},use:function(a){return T(),eu(a)},useCallback:function(a,h){return en="useCallback",T(),zn(),Ou(a,h)},useContext:function(a){return en="useContext",T(),zn(),as(a)},useEffect:function(a,h){en="useEffect",T(),zn(),la(2048,fa,a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",T(),zn(),ug(a,h,v)},useInsertionEffect:function(a,h){return en="useInsertionEffect",T(),zn(),la(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",T(),zn(),la(4,Ia,a,h)},useMemo:function(a,h){en="useMemo",T(),zn();var v=Jt.H;Jt.H=Ec;try{return ty(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",T(),zn();var S=Jt.H;Jt.H=Ec;try{return id(a,h,v)}finally{Jt.H=S}},useRef:function(){return en="useRef",T(),zn(),es().memoizedState},useState:function(){en="useState",T(),zn();var a=Jt.H;Jt.H=Ec;try{return id(Ea)}finally{Jt.H=a}},useDebugValue:function(){en="useDebugValue",T(),zn()},useDeferredValue:function(a,h){return en="useDeferredValue",T(),zn(),Hx(a,h)},useTransition:function(){return en="useTransition",T(),zn(),R0()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",T(),zn(),_f(a,h,v)},useId:function(){return en="useId",T(),zn(),es().memoizedState},useFormState:function(a){return en="useFormState",T(),zn(),Du(a)},useActionState:function(a){return en="useActionState",T(),zn(),Du(a)},useOptimistic:function(a,h){return en="useOptimistic",T(),zn(),E0(a,h)},useMemoCache:function(a){return T(),Su(a)},useHostTransitionStatus:zl,useCacheRefresh:function(){return en="useCacheRefresh",zn(),es().memoizedState}},Wg={readContext:function(a){return D(),as(a)},use:function(a){return T(),eu(a)},useCallback:function(a,h){return en="useCallback",T(),zn(),Ou(a,h)},useContext:function(a){return en="useContext",T(),zn(),as(a)},useEffect:function(a,h){en="useEffect",T(),zn(),la(2048,fa,a,h)},useImperativeHandle:function(a,h,v){return en="useImperativeHandle",T(),zn(),ug(a,h,v)},useInsertionEffect:function(a,h){return en="useInsertionEffect",T(),zn(),la(4,Ul,a,h)},useLayoutEffect:function(a,h){return en="useLayoutEffect",T(),zn(),la(4,Ia,a,h)},useMemo:function(a,h){en="useMemo",T(),zn();var v=Jt.H;Jt.H=Ec;try{return ty(a,h)}finally{Jt.H=v}},useReducer:function(a,h,v){en="useReducer",T(),zn();var S=Jt.H;Jt.H=Ec;try{return Au(a,h,v)}finally{Jt.H=S}},useRef:function(){return en="useRef",T(),zn(),es().memoizedState},useState:function(){en="useState",T(),zn();var a=Jt.H;Jt.H=Ec;try{return Au(Ea)}finally{Jt.H=a}},useDebugValue:function(){en="useDebugValue",T(),zn()},useDeferredValue:function(a,h){return en="useDeferredValue",T(),zn(),hg(a,h)},useTransition:function(){return en="useTransition",T(),zn(),gh()},useSyncExternalStore:function(a,h,v){return en="useSyncExternalStore",T(),zn(),_f(a,h,v)},useId:function(){return en="useId",T(),zn(),es().memoizedState},useFormState:function(a){return en="useFormState",T(),zn(),yf(a)},useActionState:function(a){return en="useActionState",T(),zn(),yf(a)},useOptimistic:function(a,h){return en="useOptimistic",T(),zn(),Ux(a,h)},useMemoCache:function(a){return T(),Su(a)},useHostTransitionStatus:zl,useCacheRefresh:function(){return en="useCacheRefresh",zn(),es().memoizedState}};var Sb={"react-stack-bottom-frame":function(a,h,v){var S=Lh;Lh=!0;try{return a(h,v)}finally{Lh=S}}},iv=Sb["react-stack-bottom-frame"].bind(Sb),Ab={"react-stack-bottom-frame":function(a){var h=Lh;Lh=!0;try{return a.render()}finally{Lh=h}}},xD=Ab["react-stack-bottom-frame"].bind(Ab),G1={"react-stack-bottom-frame":function(a,h){try{h.componentDidMount()}catch(v){ls(a,a.return,v)}}},Cb=G1["react-stack-bottom-frame"].bind(G1),Db={"react-stack-bottom-frame":function(a,h,v,S,I){try{h.componentDidUpdate(v,S,I)}catch(k){ls(a,a.return,k)}}},vE=Db["react-stack-bottom-frame"].bind(Db),bE={"react-stack-bottom-frame":function(a,h){var v=h.stack;a.componentDidCatch(h.value,{componentStack:v!==null?v:""})}},xE=bE["react-stack-bottom-frame"].bind(bE),wE={"react-stack-bottom-frame":function(a,h,v){try{v.componentWillUnmount()}catch(S){ls(a,h,S)}}},q1=wE["react-stack-bottom-frame"].bind(wE),Rb={"react-stack-bottom-frame":function(a){a.resourceKind!=null&&console.error("Expected only SimpleEffects when enableUseEffectCRUDOverload is disabled, got %s",a.resourceKind);var h=a.create;return a=a.inst,h=h(),a.destroy=h}},wD=Rb["react-stack-bottom-frame"].bind(Rb),TE={"react-stack-bottom-frame":function(a,h,v){try{v()}catch(S){ls(a,h,S)}}},TD=TE["react-stack-bottom-frame"].bind(TE),EE={"react-stack-bottom-frame":function(a){var h=a._init;return h(a._payload)}},jd=EE["react-stack-bottom-frame"].bind(EE),mm=null,Yg=0,rr=null,rv,Ob=rv=!1,SE={},Ib={},AE={};s=function(a,h,v){if(v!==null&&typeof v=="object"&&v._store&&(!v._store.validated&&v.key==null||v._store.validated===2)){if(typeof v._store!="object")throw Error("React Component in warnForMissingKey should have a _store. This error is likely caused by a bug in React. Please file an issue.");v._store.validated=1;var S=Te(a),I=S||"null";if(!SE[I]){SE[I]=!0,v=v._owner,a=a._debugOwner;var k="";a&&typeof a.tag=="number"&&(I=Te(a))&&(k=`

Check the render method of \``+I+"`."),k||S&&(k=`

Check the top-level render call using <`+S+">.");var K="";v!=null&&a!==v&&(S=null,typeof v.tag=="number"?S=Te(v):typeof v.name=="string"&&(S=v.name),S&&(K=" It was passed a child from "+S+".")),Ze(h,function(){console.error('Each child in a list should have a unique "key" prop.%s%s See https://react.dev/link/warning-keys for more information.',k,K)})}}};var sv=Mu(!0),CE=Mu(!1),gu=oe(null),Vh=null,Zg=1,ov=2,Zo=oe(0),DE={},ED=new Set,W1=new Set,RE=new Set,OE=new Set,Mb=new Set,ip=new Set,Y1=new Set,IE=new Set,ME=new Set,Pb=new Set;Object.freeze(DE);var kb={enqueueSetState:function(a,h,v){a=a._reactInternals;var S=Aa(a),I=kl(S);I.payload=h,v!=null&&(Lp(v),I.callback=v),h=oc(a,I,S),h!==null&&(oo(h,a,S),dh(h,a,S)),ni(a,S)},enqueueReplaceState:function(a,h,v){a=a._reactInternals;var S=Aa(a),I=kl(S);I.tag=z1,I.payload=h,v!=null&&(Lp(v),I.callback=v),h=oc(a,I,S),h!==null&&(oo(h,a,S),dh(h,a,S)),ni(a,S)},enqueueForceUpdate:function(a,h){a=a._reactInternals;var v=Aa(a),S=kl(v);S.tag=_D,h!=null&&(Lp(h),S.callback=h),h=oc(a,S,v),h!==null&&(oo(h,a,v),dh(h,a,v)),ei!==null&&typeof ei.markForceUpdateScheduled=="function"&&ei.markForceUpdateScheduled(a,v)}},Z1=typeof reportError=="function"?reportError:function(a){if(typeof window=="object"&&typeof window.ErrorEvent=="function"){var h=new window.ErrorEvent("error",{bubbles:!0,cancelable:!0,message:typeof a=="object"&&a!==null&&typeof a.message=="string"?String(a.message):String(a),error:a});if(!window.dispatchEvent(h))return}else if(typeof process=="object"&&typeof process.emit=="function"){process.emit("uncaughtException",a);return}console.error(a)},av=null,PE=null,SD=Error("This is not a real error. It's an implementation detail of React's selective hydration feature. If this leaks into userspace, it's a bug in React. Please file an issue."),Ma=!1,AD={},CD={},DD={},kE={},rp=!1,X1={},Q1={},K1={dehydrated:null,treeContext:null,retryLane:0,hydrationErrors:null},J1=!1,NE=null;NE=new Set;var Hd=!1,$s=!1,gm=!1,LE=typeof WeakSet=="function"?WeakSet:Set,Ao=null,lv=null,_m=null,yo=null,wl=!1,Tl=null,Xg=8192,Qg={getCacheForType:function(a){var h=as(da),v=h.data.get(a);return v===void 0&&(v=a(),h.data.set(a,v)),v},getOwner:function(){return hu}};if(typeof Symbol=="function"&&Symbol.for){var cv=Symbol.for;cv("selector.component"),cv("selector.has_pseudo_class"),cv("selector.role"),cv("selector.test_id"),cv("selector.text")}var RD=[],OD=typeof WeakMap=="function"?WeakMap:Map,Sc=0,Pa=2,Hl=4,sp=0,Nb=1,Kg=2,zE=3,Jg=4,uv=6,ew=5,ns=Sc,ws=null,Sr=null,ur=0,$l=0,Lb=1,ym=2,zb=3,ID=4,BE=5,hv=6,Bb=7,dv=8,e_=9,Ts=$l,El=null,vm=!1,fv=!1,FE=!1,_u=0,Co=sp,bm=0,op=0,VE=0,yu=0,t_=0,Fb=null,Gl=null,ap=!1,n_=0,MD=300,pv=1/0,UE=500,mv=null,lp=null,PD=0,kD=1,ND=2,xm=0,jE=1,HE=2,i_=3,LD=4,tw=5,Xo=0,$d=null,r_=null,cp=0,nw=0,iw=null,$E=null,zD=50,gv=0,Gd=null,GE=!1,rw=!1,VM=50,qd=0,Vb=null,_v=!1,sw=null,BD=!1,FD=new Set,UM={},ow=null,yv=null,qE=!1,WE=!1,aw=!1,ql=!1,Uh=0,YE={};(function(){for(var a=0;a<lE.length;a++){var h=lE[a],v=h.toLowerCase();h=h[0].toUpperCase()+h.slice(1),xn(v,"on"+h)}xn(aE,"onAnimationEnd"),xn(rD,"onAnimationIteration"),xn(sD,"onAnimationStart"),xn("dblclick","onDoubleClick"),xn("focusin","onFocus"),xn("focusout","onBlur"),xn(LM,"onTransitionRun"),xn(zM,"onTransitionStart"),xn(BM,"onTransitionCancel"),xn(oD,"onTransitionEnd")})(),jn("onMouseEnter",["mouseout","mouseover"]),jn("onMouseLeave",["mouseout","mouseover"]),jn("onPointerEnter",["pointerout","pointerover"]),jn("onPointerLeave",["pointerout","pointerover"]),Pn("onChange","change click focusin focusout input keydown keyup selectionchange".split(" ")),Pn("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" ")),Pn("onBeforeInput",["compositionend","keypress","textInput","paste"]),Pn("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" ")),Pn("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" ")),Pn("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var vv="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),lw=new Set("beforetoggle cancel close invalid load scroll scrollend toggle".split(" ").concat(vv)),cw="_reactListening"+Math.random().toString(36).slice(2),ZE=!1,XE=!1,Ub=!1,VD=!1,uw=!1,jb=!1,Ys=!1,up={},Hb=/\r\n?/g,$b=/\u0000|\uFFFD/g,wm="http://www.w3.org/1999/xlink",QE="http://www.w3.org/XML/1998/namespace",jM="javascript:throw new Error('React form unexpectedly submitted.')",KE="suppressHydrationWarning",Ac="$",bv="/$",hp="$?",Wl="$!",HM=1,$M=2,GM=4,Cc="F!",UD="F",JE="complete",qM="style",jh=0,dp=1,Gb=2,hw=null,fp=null,dw={dialog:!0,webview:!0},eS=null,tS=typeof setTimeout=="function"?setTimeout:void 0,WM=typeof clearTimeout=="function"?clearTimeout:void 0,s_=-1,jD=typeof Promise=="function"?Promise:void 0,HD=typeof queueMicrotask=="function"?queueMicrotask:typeof jD<"u"?function(a){return jD.resolve(null).then(a).catch(si)}:tS,nS=null,o_=0,xv=1,$D=2,a_=3,vu=4,bu=new Map,GD=new Set,Wd=us.d;us.d={f:function(){var a=Wd.f(),h=kf();return a||h},r:function(a){var h=Xs(a);h!==null&&h.tag===5&&h.type==="form"?ry(h):Wd.r(a)},D:function(a){Wd.D(a),Ff("dns-prefetch",a,null)},C:function(a,h){Wd.C(a,h),Ff("preconnect",a,h)},L:function(a,h,v){Wd.L(a,h,v);var S=Tm;if(S&&a&&h){var I='link[rel="preload"][as="'+Vn(h)+'"]';h==="image"&&v&&v.imageSrcSet?(I+='[imagesrcset="'+Vn(v.imageSrcSet)+'"]',typeof v.imageSizes=="string"&&(I+='[imagesizes="'+Vn(v.imageSizes)+'"]')):I+='[href="'+Vn(a)+'"]';var k=I;switch(h){case"style":k=Ih(a);break;case"script":k=mc(a)}bu.has(k)||(a=br({rel:"preload",href:h==="image"&&v&&v.imageSrcSet?void 0:a,as:h},v),bu.set(k,a),S.querySelector(I)!==null||h==="style"&&S.querySelector(wd(k))||h==="script"&&S.querySelector(gc(k))||(h=S.createElement("link"),Nt(h,"link",a),xt(h),S.head.appendChild(h)))}},m:function(a,h){Wd.m(a,h);var v=Tm;if(v&&a){var S=h&&typeof h.as=="string"?h.as:"script",I='link[rel="modulepreload"][as="'+Vn(S)+'"][href="'+Vn(a)+'"]',k=I;switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":k=mc(a)}if(!bu.has(k)&&(a=br({rel:"modulepreload",href:a},h),bu.set(k,a),v.querySelector(I)===null)){switch(S){case"audioworklet":case"paintworklet":case"serviceworker":case"sharedworker":case"worker":case"script":if(v.querySelector(gc(k)))return}S=v.createElement("link"),Nt(S,"link",a),xt(S),v.head.appendChild(S)}}},X:function(a,h){Wd.X(a,h);var v=Tm;if(v&&a){var S=Ge(v).hoistableScripts,I=mc(a),k=S.get(I);k||(k=v.querySelector(gc(I)),k||(a=br({src:a,async:!0},h),(h=bu.get(I))&&Jx(a,h),k=v.createElement("script"),xt(k),Nt(k,"link",a),v.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},S.set(I,k))}},S:function(a,h,v){Wd.S(a,h,v);var S=Tm;if(S&&a){var I=Ge(S).hoistableStyles,k=Ih(a);h=h||"default";var K=I.get(k);if(!K){var ee={loading:o_,preload:null};if(K=S.querySelector(wd(k)))ee.loading=xv|vu;else{a=br({rel:"stylesheet",href:a,"data-precedence":h},v),(v=bu.get(k))&&Cy(a,v);var me=K=S.createElement("link");xt(me),Nt(me,"link",a),me._p=new Promise(function(De,it){me.onload=De,me.onerror=it}),me.addEventListener("load",function(){ee.loading|=xv}),me.addEventListener("error",function(){ee.loading|=$D}),ee.loading|=vu,Vf(K,h,S)}K={type:"stylesheet",instance:K,count:1,state:ee},I.set(k,K)}}},M:function(a,h){Wd.M(a,h);var v=Tm;if(v&&a){var S=Ge(v).hoistableScripts,I=mc(a),k=S.get(I);k||(k=v.querySelector(gc(I)),k||(a=br({src:a,async:!0,type:"module"},h),(h=bu.get(I))&&Jx(a,h),k=v.createElement("script"),xt(k),Nt(k,"link",a),v.head.appendChild(k)),k={type:"script",instance:k,count:1,state:null},S.set(I,k))}}};var Tm=typeof document>"u"?null:document,wv=null,Tv=null,l_=null,Ev=null,Em=Ng,u={$$typeof:Ph,Provider:null,Consumer:null,_currentValue:Em,_currentValue2:Em,_threadCount:0},i="%c%s%c ",l="background: #e6e6e6;background: light-dark(rgba(0,0,0,0.1), rgba(255,255,255,0.25));color: #000000;color: light-dark(#000000, #ffffff);border-radius: 2px",p="",g=" ",b=Function.prototype.bind,x=!1,A=null,R=null,O=null,L=null,B=null,U=null,q=null,Y=null,ne=null;A=function(a,h,v,S){h=t(a,h),h!==null&&(v=e(h.memoizedState,v,0,S),h.memoizedState=v,h.baseState=v,a.memoizedProps=br({},a.memoizedProps),v=fi(a,2),v!==null&&oo(v,a,2))},R=function(a,h,v){h=t(a,h),h!==null&&(v=c(h.memoizedState,v,0),h.memoizedState=v,h.baseState=v,a.memoizedProps=br({},a.memoizedProps),v=fi(a,2),v!==null&&oo(v,a,2))},O=function(a,h,v,S){h=t(a,h),h!==null&&(v=n(h.memoizedState,v,S),h.memoizedState=v,h.baseState=v,a.memoizedProps=br({},a.memoizedProps),v=fi(a,2),v!==null&&oo(v,a,2))},L=function(a,h,v){a.pendingProps=e(a.memoizedProps,h,0,v),a.alternate&&(a.alternate.pendingProps=a.pendingProps),h=fi(a,2),h!==null&&oo(h,a,2)},B=function(a,h){a.pendingProps=c(a.memoizedProps,h,0),a.alternate&&(a.alternate.pendingProps=a.pendingProps),h=fi(a,2),h!==null&&oo(h,a,2)},U=function(a,h,v){a.pendingProps=n(a.memoizedProps,h,v),a.alternate&&(a.alternate.pendingProps=a.pendingProps),h=fi(a,2),h!==null&&oo(h,a,2)},q=function(a){var h=fi(a,2);h!==null&&oo(h,a,2)},Y=function(a){m=a},ne=function(a){d=a};var ae=!0,he=null,Se=!1,Ae=null,re=null,ye=null,Oe=new Map,Le=new Map,nt=[],Qe="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset".split(" "),st=null;if(o1.prototype.render=s1.prototype.render=function(a){var h=this._internalRoot;if(h===null)throw Error("Cannot update an unmounted root.");var v=arguments;typeof v[1]=="function"?console.error("does not support the second callback argument. To execute a side effect after rendering, declare it in a component body with useEffect()."):te(v[1])?console.error("You passed a container to the second argument of root.render(...). You don't need to pass it again since you already passed it to create the root."):typeof v[1]<"u"&&console.error("You passed a second argument to root.render(...) but it only accepts one argument."),v=a;var S=h.current,I=Aa(S);Dy(S,I,v,h,null,null)},o1.prototype.unmount=s1.prototype.unmount=function(){var a=arguments;if(typeof a[0]=="function"&&console.error("does not support a callback argument. To execute a side effect after rendering, declare it in a component body with useEffect()."),a=this._internalRoot,a!==null){this._internalRoot=null;var h=a.containerInfo;(ns&(Pa|Hl))!==Sc&&console.error("Attempted to synchronously unmount a root while React was already rendering. React cannot finish unmounting the root until the current render has completed, which may lead to a race condition."),Dy(a.current,2,null,a,null,null),kf(),h[Od]=null}},o1.prototype.unstable_scheduleHydration=function(a){if(a){var h=Or();a={blockedOn:null,target:a,priority:h};for(var v=0;v<nt.length&&h!==0&&h<nt[v].priority;v++);nt.splice(v,0,a),v===0&&r1(a)}},function(){var a=a1.version;if(a!=="19.1.0")throw Error(`Incompatible React versions: The "react" and "react-dom" packages must have the exact same version. Instead got:
  - react:      `+(a+`
  - react-dom:  19.1.0
Learn more: https://react.dev/warnings/version-mismatch`))}(),typeof Map=="function"&&Map.prototype!=null&&typeof Map.prototype.forEach=="function"&&typeof Set=="function"&&Set.prototype!=null&&typeof Set.prototype.clear=="function"&&typeof Set.prototype.forEach=="function"||console.error("React depends on Map and Set built-in types. Make sure that you load a polyfill in older browsers. https://react.dev/link/react-polyfills"),us.findDOMNode=function(a){var h=a._reactInternals;if(h===void 0)throw typeof a.render=="function"?Error("Unable to find node on an unmounted component."):(a=Object.keys(a).join(","),Error("Argument appears to not be a ReactComponent. Keys: "+a));return a=Re(h),a=a!==null?Ne(a):null,a=a===null?null:a.stateNode,a},!function(){var a={bundleType:1,version:"19.1.0",rendererPackageName:"react-dom",currentDispatcherRef:Jt,reconcilerVersion:"19.1.0"};return a.overrideHookState=A,a.overrideHookStateDeletePath=R,a.overrideHookStateRenamePath=O,a.overrideProps=L,a.overridePropsDeletePath=B,a.overridePropsRenamePath=U,a.scheduleUpdate=q,a.setErrorHandler=Y,a.setSuspenseHandler=ne,a.scheduleRefresh=J,a.scheduleRoot=$,a.setRefreshHandler=X,a.getCurrentFiber=kT,a.getLaneLabelMap=Td,a.injectProfilingHooks=Mn,dn(a)}()&&Md&&window.top===window.self&&(-1<navigator.userAgent.indexOf("Chrome")&&navigator.userAgent.indexOf("Edge")===-1||-1<navigator.userAgent.indexOf("Firefox"))){var dt=window.location.protocol;/^(https?|file):$/.test(dt)&&console.info("%cDownload the React DevTools for a better development experience: https://react.dev/link/react-devtools"+(dt==="file:"?`
You might need to use a local HTTP server (instead of file://): https://react.dev/link/react-devtools-faq`:""),"font-weight:bold")}rS.createRoot=function(a,h){if(!te(a))throw Error("Target container is not a DOM element.");dC(a);var v=!1,S="",I=vn,k=M0,K=P0,ee=null;return h!=null&&(h.hydrate?console.warn("hydrate through createRoot is deprecated. Use ReactDOMClient.hydrateRoot(container, <App />) instead."):typeof h=="object"&&h!==null&&h.$$typeof===Zp&&console.error(`You passed a JSX element to createRoot. You probably meant to call root.render instead. Example usage:

  let root = createRoot(domContainer);
  root.render(<App />);`),h.unstable_strictMode===!0&&(v=!0),h.identifierPrefix!==void 0&&(S=h.identifierPrefix),h.onUncaughtError!==void 0&&(I=h.onUncaughtError),h.onCaughtError!==void 0&&(k=h.onCaughtError),h.onRecoverableError!==void 0&&(K=h.onRecoverableError),h.unstable_transitionCallbacks!==void 0&&(ee=h.unstable_transitionCallbacks)),h=aC(a,1,!1,null,null,v,S,I,k,K,ee,null),a[Od]=h.current,Ve(a),new s1(h)},rS.hydrateRoot=function(a,h,v){if(!te(a))throw Error("Target container is not a DOM element.");dC(a),h===void 0&&console.error("Must provide initial children as second argument to hydrateRoot. Example usage: hydrateRoot(domContainer, <App />)");var S=!1,I="",k=vn,K=M0,ee=P0,me=null,De=null;return v!=null&&(v.unstable_strictMode===!0&&(S=!0),v.identifierPrefix!==void 0&&(I=v.identifierPrefix),v.onUncaughtError!==void 0&&(k=v.onUncaughtError),v.onCaughtError!==void 0&&(K=v.onCaughtError),v.onRecoverableError!==void 0&&(ee=v.onRecoverableError),v.unstable_transitionCallbacks!==void 0&&(me=v.unstable_transitionCallbacks),v.formState!==void 0&&(De=v.formState)),h=aC(a,1,!0,h,v??null,S,I,k,K,ee,me,De),h.context=PT(null),v=h.current,S=Aa(v),S=ir(S),I=kl(S),I.callback=null,oc(v,I,S),v=S,h.current.lanes=v,ks(h,v),y(h),a[Od]=h.current,Ve(a),new o1(h)},rS.version="19.1.0",typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"&&typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop=="function"&&__REACT_DEVTOOLS_GLOBAL_HOOK__.registerInternalModuleStop(Error())}(),rS}var az;function X$(){return az||(az=1,QM.exports=Z$()),QM.exports}var Q$=X$();const K$=AA(Q$);var tP={exports:{}},nP={exports:{}},Is={},lz;function J$(){if(lz)return Is;lz=1;/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,c=t?Symbol.for("react.strict_mode"):60108,d=t?Symbol.for("react.profiler"):60114,m=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,T=t?Symbol.for("react.async_mode"):60111,D=t?Symbol.for("react.concurrent_mode"):60111,P=t?Symbol.for("react.forward_ref"):60112,z=t?Symbol.for("react.suspense"):60113,F=t?Symbol.for("react.suspense_list"):60120,$=t?Symbol.for("react.memo"):60115,J=t?Symbol.for("react.lazy"):60116,X=t?Symbol.for("react.block"):60121,te=t?Symbol.for("react.fundamental"):60117,ie=t?Symbol.for("react.responder"):60118,we=t?Symbol.for("react.scope"):60119;function Ie(Bt){return typeof Bt=="string"||typeof Bt=="function"||Bt===r||Bt===D||Bt===d||Bt===c||Bt===z||Bt===F||typeof Bt=="object"&&Bt!==null&&(Bt.$$typeof===J||Bt.$$typeof===$||Bt.$$typeof===m||Bt.$$typeof===s||Bt.$$typeof===P||Bt.$$typeof===te||Bt.$$typeof===ie||Bt.$$typeof===we||Bt.$$typeof===X)}function Re(Bt){if(typeof Bt=="object"&&Bt!==null){var ni=Bt.$$typeof;switch(ni){case e:var er=Bt.type;switch(er){case T:case D:case r:case d:case c:case z:return er;default:var _r=er&&er.$$typeof;switch(_r){case s:case P:case J:case $:case m:return _r;default:return ni}}case n:return ni}}}var Ne=T,Xe=D,be=s,_e=m,Te=e,oe=P,Ee=r,$e=J,ze=$,zt=n,St=d,mt=c,Ft=z,rn=!1;function Xt(Bt){return rn||(rn=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),Fe(Bt)||Re(Bt)===T}function Fe(Bt){return Re(Bt)===D}function Ot(Bt){return Re(Bt)===s}function Ut(Bt){return Re(Bt)===m}function ln(Bt){return typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===e}function wn(Bt){return Re(Bt)===P}function dn(Bt){return Re(Bt)===r}function Ht(Bt){return Re(Bt)===J}function Mn(Bt){return Re(Bt)===$}function yn(Bt){return Re(Bt)===n}function Tn(Bt){return Re(Bt)===d}function Cn(Bt){return Re(Bt)===c}function Kn(Bt){return Re(Bt)===z}Is.AsyncMode=Ne,Is.ConcurrentMode=Xe,Is.ContextConsumer=be,Is.ContextProvider=_e,Is.Element=Te,Is.ForwardRef=oe,Is.Fragment=Ee,Is.Lazy=$e,Is.Memo=ze,Is.Portal=zt,Is.Profiler=St,Is.StrictMode=mt,Is.Suspense=Ft,Is.isAsyncMode=Xt,Is.isConcurrentMode=Fe,Is.isContextConsumer=Ot,Is.isContextProvider=Ut,Is.isElement=ln,Is.isForwardRef=wn,Is.isFragment=dn,Is.isLazy=Ht,Is.isMemo=Mn,Is.isPortal=yn,Is.isProfiler=Tn,Is.isStrictMode=Cn,Is.isSuspense=Kn,Is.isValidElementType=Ie,Is.typeOf=Re}(),Is}var cz;function BU(){return cz||(cz=1,nP.exports=J$()),nP.exports}/*
object-assign
(c) Sindre Sorhus
@license MIT
*/var iP,uz;function e9(){if(uz)return iP;uz=1;var t=Object.getOwnPropertySymbols,e=Object.prototype.hasOwnProperty,n=Object.prototype.propertyIsEnumerable;function r(d){if(d==null)throw new TypeError("Object.assign cannot be called with null or undefined");return Object(d)}function c(){try{if(!Object.assign)return!1;var d=new String("abc");if(d[5]="de",Object.getOwnPropertyNames(d)[0]==="5")return!1;for(var m={},s=0;s<10;s++)m["_"+String.fromCharCode(s)]=s;var T=Object.getOwnPropertyNames(m).map(function(P){return m[P]});if(T.join("")!=="0123456789")return!1;var D={};return"abcdefghijklmnopqrst".split("").forEach(function(P){D[P]=P}),Object.keys(Object.assign({},D)).join("")==="abcdefghijklmnopqrst"}catch{return!1}}return iP=c()?Object.assign:function(d,m){for(var s,T=r(d),D,P=1;P<arguments.length;P++){s=Object(arguments[P]);for(var z in s)e.call(s,z)&&(T[z]=s[z]);if(t){D=t(s);for(var F=0;F<D.length;F++)n.call(s,D[F])&&(T[D[F]]=s[D[F]])}}return T},iP}var rP,hz;function FU(){if(hz)return rP;hz=1;var t="SECRET_DO_NOT_PASS_THIS_OR_YOU_WILL_BE_FIRED";return rP=t,rP}var sP,dz;function VU(){return dz||(dz=1,sP=Function.call.bind(Object.prototype.hasOwnProperty)),sP}var oP,fz;function t9(){if(fz)return oP;fz=1;var t=function(){};{var e=FU(),n={},r=VU();t=function(d){var m="Warning: "+d;typeof console<"u"&&console.error(m);try{throw new Error(m)}catch{}}}function c(d,m,s,T,D){for(var P in d)if(r(d,P)){var z;try{if(typeof d[P]!="function"){var F=Error((T||"React class")+": "+s+" type `"+P+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+typeof d[P]+"`.This often happens because of typos such as `PropTypes.function` instead of `PropTypes.func`.");throw F.name="Invariant Violation",F}z=d[P](m,P,T,s,null,e)}catch(J){z=J}if(z&&!(z instanceof Error)&&t((T||"React class")+": type specification of "+s+" `"+P+"` is invalid; the type checker function must return `null` or an `Error` but returned a "+typeof z+". You may have forgotten to pass an argument to the type checker creator (arrayOf, instanceOf, objectOf, oneOf, oneOfType, and shape all require an argument)."),z instanceof Error&&!(z.message in n)){n[z.message]=!0;var $=D?D():"";t("Failed "+s+" type: "+z.message+($??""))}}}return c.resetWarningCache=function(){n={}},oP=c,oP}var aP,pz;function n9(){if(pz)return aP;pz=1;var t=BU(),e=e9(),n=FU(),r=VU(),c=t9(),d=function(){};d=function(s){var T="Warning: "+s;typeof console<"u"&&console.error(T);try{throw new Error(T)}catch{}};function m(){return null}return aP=function(s,T){var D=typeof Symbol=="function"&&Symbol.iterator,P="@@iterator";function z(Fe){var Ot=Fe&&(D&&Fe[D]||Fe[P]);if(typeof Ot=="function")return Ot}var F="<<anonymous>>",$={array:ie("array"),bigint:ie("bigint"),bool:ie("boolean"),func:ie("function"),number:ie("number"),object:ie("object"),string:ie("string"),symbol:ie("symbol"),any:we(),arrayOf:Ie,element:Re(),elementType:Ne(),instanceOf:Xe,node:oe(),objectOf:_e,oneOf:be,oneOfType:Te,shape:$e,exact:ze};function J(Fe,Ot){return Fe===Ot?Fe!==0||1/Fe===1/Ot:Fe!==Fe&&Ot!==Ot}function X(Fe,Ot){this.message=Fe,this.data=Ot&&typeof Ot=="object"?Ot:{},this.stack=""}X.prototype=Error.prototype;function te(Fe){var Ot={},Ut=0;function ln(dn,Ht,Mn,yn,Tn,Cn,Kn){if(yn=yn||F,Cn=Cn||Mn,Kn!==n){if(T){var Bt=new Error("Calling PropTypes validators directly is not supported by the `prop-types` package. Use `PropTypes.checkPropTypes()` to call them. Read more at http://fb.me/use-check-prop-types");throw Bt.name="Invariant Violation",Bt}else if(typeof console<"u"){var ni=yn+":"+Mn;!Ot[ni]&&Ut<3&&(d("You are manually calling a React.PropTypes validation function for the `"+Cn+"` prop on `"+yn+"`. This is deprecated and will throw in the standalone `prop-types` package. You may be seeing this warning due to a third-party PropTypes library. See https://fb.me/react-warning-dont-call-proptypes for details."),Ot[ni]=!0,Ut++)}}return Ht[Mn]==null?dn?Ht[Mn]===null?new X("The "+Tn+" `"+Cn+"` is marked as required "+("in `"+yn+"`, but its value is `null`.")):new X("The "+Tn+" `"+Cn+"` is marked as required in "+("`"+yn+"`, but its value is `undefined`.")):null:Fe(Ht,Mn,yn,Tn,Cn)}var wn=ln.bind(null,!1);return wn.isRequired=ln.bind(null,!0),wn}function ie(Fe){function Ot(Ut,ln,wn,dn,Ht,Mn){var yn=Ut[ln],Tn=mt(yn);if(Tn!==Fe){var Cn=Ft(yn);return new X("Invalid "+dn+" `"+Ht+"` of type "+("`"+Cn+"` supplied to `"+wn+"`, expected ")+("`"+Fe+"`."),{expectedType:Fe})}return null}return te(Ot)}function we(){return te(m)}function Ie(Fe){function Ot(Ut,ln,wn,dn,Ht){if(typeof Fe!="function")return new X("Property `"+Ht+"` of component `"+wn+"` has invalid PropType notation inside arrayOf.");var Mn=Ut[ln];if(!Array.isArray(Mn)){var yn=mt(Mn);return new X("Invalid "+dn+" `"+Ht+"` of type "+("`"+yn+"` supplied to `"+wn+"`, expected an array."))}for(var Tn=0;Tn<Mn.length;Tn++){var Cn=Fe(Mn,Tn,wn,dn,Ht+"["+Tn+"]",n);if(Cn instanceof Error)return Cn}return null}return te(Ot)}function Re(){function Fe(Ot,Ut,ln,wn,dn){var Ht=Ot[Ut];if(!s(Ht)){var Mn=mt(Ht);return new X("Invalid "+wn+" `"+dn+"` of type "+("`"+Mn+"` supplied to `"+ln+"`, expected a single ReactElement."))}return null}return te(Fe)}function Ne(){function Fe(Ot,Ut,ln,wn,dn){var Ht=Ot[Ut];if(!t.isValidElementType(Ht)){var Mn=mt(Ht);return new X("Invalid "+wn+" `"+dn+"` of type "+("`"+Mn+"` supplied to `"+ln+"`, expected a single ReactElement type."))}return null}return te(Fe)}function Xe(Fe){function Ot(Ut,ln,wn,dn,Ht){if(!(Ut[ln]instanceof Fe)){var Mn=Fe.name||F,yn=Xt(Ut[ln]);return new X("Invalid "+dn+" `"+Ht+"` of type "+("`"+yn+"` supplied to `"+wn+"`, expected ")+("instance of `"+Mn+"`."))}return null}return te(Ot)}function be(Fe){if(!Array.isArray(Fe))return arguments.length>1?d("Invalid arguments supplied to oneOf, expected an array, got "+arguments.length+" arguments. A common mistake is to write oneOf(x, y, z) instead of oneOf([x, y, z])."):d("Invalid argument supplied to oneOf, expected an array."),m;function Ot(Ut,ln,wn,dn,Ht){for(var Mn=Ut[ln],yn=0;yn<Fe.length;yn++)if(J(Mn,Fe[yn]))return null;var Tn=JSON.stringify(Fe,function(Kn,Bt){var ni=Ft(Bt);return ni==="symbol"?String(Bt):Bt});return new X("Invalid "+dn+" `"+Ht+"` of value `"+String(Mn)+"` "+("supplied to `"+wn+"`, expected one of "+Tn+"."))}return te(Ot)}function _e(Fe){function Ot(Ut,ln,wn,dn,Ht){if(typeof Fe!="function")return new X("Property `"+Ht+"` of component `"+wn+"` has invalid PropType notation inside objectOf.");var Mn=Ut[ln],yn=mt(Mn);if(yn!=="object")return new X("Invalid "+dn+" `"+Ht+"` of type "+("`"+yn+"` supplied to `"+wn+"`, expected an object."));for(var Tn in Mn)if(r(Mn,Tn)){var Cn=Fe(Mn,Tn,wn,dn,Ht+"."+Tn,n);if(Cn instanceof Error)return Cn}return null}return te(Ot)}function Te(Fe){if(!Array.isArray(Fe))return d("Invalid argument supplied to oneOfType, expected an instance of array."),m;for(var Ot=0;Ot<Fe.length;Ot++){var Ut=Fe[Ot];if(typeof Ut!="function")return d("Invalid argument supplied to oneOfType. Expected an array of check functions, but received "+rn(Ut)+" at index "+Ot+"."),m}function ln(wn,dn,Ht,Mn,yn){for(var Tn=[],Cn=0;Cn<Fe.length;Cn++){var Kn=Fe[Cn],Bt=Kn(wn,dn,Ht,Mn,yn,n);if(Bt==null)return null;Bt.data&&r(Bt.data,"expectedType")&&Tn.push(Bt.data.expectedType)}var ni=Tn.length>0?", expected one of type ["+Tn.join(", ")+"]":"";return new X("Invalid "+Mn+" `"+yn+"` supplied to "+("`"+Ht+"`"+ni+"."))}return te(ln)}function oe(){function Fe(Ot,Ut,ln,wn,dn){return zt(Ot[Ut])?null:new X("Invalid "+wn+" `"+dn+"` supplied to "+("`"+ln+"`, expected a ReactNode."))}return te(Fe)}function Ee(Fe,Ot,Ut,ln,wn){return new X((Fe||"React class")+": "+Ot+" type `"+Ut+"."+ln+"` is invalid; it must be a function, usually from the `prop-types` package, but received `"+wn+"`.")}function $e(Fe){function Ot(Ut,ln,wn,dn,Ht){var Mn=Ut[ln],yn=mt(Mn);if(yn!=="object")return new X("Invalid "+dn+" `"+Ht+"` of type `"+yn+"` "+("supplied to `"+wn+"`, expected `object`."));for(var Tn in Fe){var Cn=Fe[Tn];if(typeof Cn!="function")return Ee(wn,dn,Ht,Tn,Ft(Cn));var Kn=Cn(Mn,Tn,wn,dn,Ht+"."+Tn,n);if(Kn)return Kn}return null}return te(Ot)}function ze(Fe){function Ot(Ut,ln,wn,dn,Ht){var Mn=Ut[ln],yn=mt(Mn);if(yn!=="object")return new X("Invalid "+dn+" `"+Ht+"` of type `"+yn+"` "+("supplied to `"+wn+"`, expected `object`."));var Tn=e({},Ut[ln],Fe);for(var Cn in Tn){var Kn=Fe[Cn];if(r(Fe,Cn)&&typeof Kn!="function")return Ee(wn,dn,Ht,Cn,Ft(Kn));if(!Kn)return new X("Invalid "+dn+" `"+Ht+"` key `"+Cn+"` supplied to `"+wn+"`.\nBad object: "+JSON.stringify(Ut[ln],null,"  ")+`
Valid keys: `+JSON.stringify(Object.keys(Fe),null,"  "));var Bt=Kn(Mn,Cn,wn,dn,Ht+"."+Cn,n);if(Bt)return Bt}return null}return te(Ot)}function zt(Fe){switch(typeof Fe){case"number":case"string":case"undefined":return!0;case"boolean":return!Fe;case"object":if(Array.isArray(Fe))return Fe.every(zt);if(Fe===null||s(Fe))return!0;var Ot=z(Fe);if(Ot){var Ut=Ot.call(Fe),ln;if(Ot!==Fe.entries){for(;!(ln=Ut.next()).done;)if(!zt(ln.value))return!1}else for(;!(ln=Ut.next()).done;){var wn=ln.value;if(wn&&!zt(wn[1]))return!1}}else return!1;return!0;default:return!1}}function St(Fe,Ot){return Fe==="symbol"?!0:Ot?Ot["@@toStringTag"]==="Symbol"||typeof Symbol=="function"&&Ot instanceof Symbol:!1}function mt(Fe){var Ot=typeof Fe;return Array.isArray(Fe)?"array":Fe instanceof RegExp?"object":St(Ot,Fe)?"symbol":Ot}function Ft(Fe){if(typeof Fe>"u"||Fe===null)return""+Fe;var Ot=mt(Fe);if(Ot==="object"){if(Fe instanceof Date)return"date";if(Fe instanceof RegExp)return"regexp"}return Ot}function rn(Fe){var Ot=Ft(Fe);switch(Ot){case"array":case"object":return"an "+Ot;case"boolean":case"date":case"regexp":return"a "+Ot;default:return Ot}}function Xt(Fe){return!Fe.constructor||!Fe.constructor.name?F:Fe.constructor.name}return $.checkPropTypes=c,$.resetWarningCache=c.resetWarningCache,$.PropTypes=$,$},aP}var mz;function i9(){if(mz)return tP.exports;mz=1;{var t=BU(),e=!0;tP.exports=n9()(t.isElement,e)}return tP.exports}var r9=i9();const G=AA(r9);function UU(t){var e,n,r="";if(typeof t=="string"||typeof t=="number")r+=t;else if(typeof t=="object")if(Array.isArray(t)){var c=t.length;for(e=0;e<c;e++)t[e]&&(n=UU(t[e]))&&(r&&(r+=" "),r+=n)}else for(n in t)t[n]&&(r&&(r+=" "),r+=n);return r}function Dr(){for(var t,e,n=0,r="",c=arguments.length;n<c;n++)(t=arguments[n])&&(e=UU(t))&&(r&&(r+=" "),r+=e);return r}function Fo(t,e,n=void 0){const r={};for(const c in t){const d=t[c];let m="",s=!0;for(let T=0;T<d.length;T+=1){const D=d[T];D&&(m+=(s===!0?"":" ")+e(D),s=!1,n&&n[D]&&(m+=" "+n[D]))}r[c]=m}return r}function Rr(t){if(typeof t!="string")throw new Error("MUI: `capitalize(string)` expects a string argument.");return t.charAt(0).toUpperCase()+t.slice(1)}var lP={exports:{}},Zs={},gz;function s9(){if(gz)return Zs;gz=1;/**
 * @license React
 * react-is.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){function t(X){if(typeof X=="object"&&X!==null){var te=X.$$typeof;switch(te){case e:switch(X=X.type,X){case r:case d:case c:case D:case P:case $:return X;default:switch(X=X&&X.$$typeof,X){case s:case T:case F:case z:return X;case m:return X;default:return te}}case n:return te}}}var e=Symbol.for("react.transitional.element"),n=Symbol.for("react.portal"),r=Symbol.for("react.fragment"),c=Symbol.for("react.strict_mode"),d=Symbol.for("react.profiler"),m=Symbol.for("react.consumer"),s=Symbol.for("react.context"),T=Symbol.for("react.forward_ref"),D=Symbol.for("react.suspense"),P=Symbol.for("react.suspense_list"),z=Symbol.for("react.memo"),F=Symbol.for("react.lazy"),$=Symbol.for("react.view_transition"),J=Symbol.for("react.client.reference");Zs.ContextConsumer=m,Zs.ContextProvider=s,Zs.Element=e,Zs.ForwardRef=T,Zs.Fragment=r,Zs.Lazy=F,Zs.Memo=z,Zs.Portal=n,Zs.Profiler=d,Zs.StrictMode=c,Zs.Suspense=D,Zs.SuspenseList=P,Zs.isContextConsumer=function(X){return t(X)===m},Zs.isContextProvider=function(X){return t(X)===s},Zs.isElement=function(X){return typeof X=="object"&&X!==null&&X.$$typeof===e},Zs.isForwardRef=function(X){return t(X)===T},Zs.isFragment=function(X){return t(X)===r},Zs.isLazy=function(X){return t(X)===F},Zs.isMemo=function(X){return t(X)===z},Zs.isPortal=function(X){return t(X)===n},Zs.isProfiler=function(X){return t(X)===d},Zs.isStrictMode=function(X){return t(X)===c},Zs.isSuspense=function(X){return t(X)===D},Zs.isSuspenseList=function(X){return t(X)===P},Zs.isValidElementType=function(X){return typeof X=="string"||typeof X=="function"||X===r||X===d||X===c||X===D||X===P||typeof X=="object"&&X!==null&&(X.$$typeof===F||X.$$typeof===z||X.$$typeof===s||X.$$typeof===m||X.$$typeof===T||X.$$typeof===J||X.getModuleId!==void 0)},Zs.typeOf=t}(),Zs}var _z;function o9(){return _z||(_z=1,lP.exports=s9()),lP.exports}var hx=o9();function Bm(t){if(typeof t!="object"||t===null)return!1;const e=Object.getPrototypeOf(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)}function jU(t){if(ke.isValidElement(t)||hx.isValidElementType(t)||!Bm(t))return t;const e={};return Object.keys(t).forEach(n=>{e[n]=jU(t[n])}),e}function qh(t,e,n={clone:!0}){const r=n.clone?{...t}:t;return Bm(t)&&Bm(e)&&Object.keys(e).forEach(c=>{ke.isValidElement(e[c])||hx.isValidElementType(e[c])?r[c]=e[c]:Bm(e[c])&&Object.prototype.hasOwnProperty.call(t,c)&&Bm(t[c])?r[c]=qh(t[c],e[c],n):n.clone?r[c]=Bm(e[c])?jU(e[c]):e[c]:r[c]=e[c]}),r}function LS(t,e){return e?qh(t,e,{clone:!1}):t}const o0=G.oneOfType([G.number,G.string,G.object,G.array]);function a9(t,e){if(!t.containerQueries)return e;const n=Object.keys(e).filter(r=>r.startsWith("@container")).sort((r,c)=>{var m,s;const d=/min-width:\s*([0-9.]+)/;return+(((m=r.match(d))==null?void 0:m[1])||0)-+(((s=c.match(d))==null?void 0:s[1])||0)});return n.length?n.reduce((r,c)=>{const d=e[c];return delete r[c],r[c]=d,r},{...e}):e}function l9(t,e){return e==="@"||e.startsWith("@")&&(t.some(n=>e.startsWith(`@${n}`))||!!e.match(/^@\d/))}function c9(t,e){const n=e.match(/^@([^/]+)?\/?(.+)?$/);if(!n)throw new Error(`MUI: The provided shorthand ${`(${e})`} is invalid. The format should be \`@<breakpoint | number>\` or \`@<breakpoint | number>/<container>\`.
For example, \`@sm\` or \`@600\` or \`@40rem/sidebar\`.`);const[,r,c]=n,d=Number.isNaN(+r)?r||0:+r;return t.containerQueries(c).up(d)}function u9(t){const e=(d,m)=>d.replace("@media",m?`@container ${m}`:"@container");function n(d,m){d.up=(...s)=>e(t.breakpoints.up(...s),m),d.down=(...s)=>e(t.breakpoints.down(...s),m),d.between=(...s)=>e(t.breakpoints.between(...s),m),d.only=(...s)=>e(t.breakpoints.only(...s),m),d.not=(...s)=>{const T=e(t.breakpoints.not(...s),m);return T.includes("not all and")?T.replace("not all and ","").replace("min-width:","width<").replace("max-width:","width>").replace("and","or"):T}}const r={},c=d=>(n(r,d),r);return n(c),{...t,containerQueries:c}}const fI={xs:0,sm:600,md:900,lg:1200,xl:1536},yz={keys:["xs","sm","md","lg","xl"],up:t=>`@media (min-width:${fI[t]}px)`},h9={containerQueries:t=>({up:e=>{let n=typeof e=="number"?e:fI[e]||e;return typeof n=="number"&&(n=`${n}px`),t?`@container ${t} (min-width:${n})`:`@container (min-width:${n})`}})};function w_(t,e,n){const r=t.theme||{};if(Array.isArray(e)){const d=r.breakpoints||yz;return e.reduce((m,s,T)=>(m[d.up(d.keys[T])]=n(e[T]),m),{})}if(typeof e=="object"){const d=r.breakpoints||yz;return Object.keys(e).reduce((m,s)=>{if(l9(d.keys,s)){const T=c9(r.containerQueries?r:h9,s);T&&(m[T]=n(e[s],s))}else if(Object.keys(d.values||fI).includes(s)){const T=d.up(s);m[T]=n(e[s],s)}else{const T=s;m[T]=e[T]}return m},{})}return n(e)}function d9(t={}){var n;return((n=t.keys)==null?void 0:n.reduce((r,c)=>{const d=t.up(c);return r[d]={},r},{}))||{}}function f9(t,e){return t.reduce((n,r)=>{const c=n[r];return(!c||Object.keys(c).length===0)&&delete n[r],n},e)}function pI(t,e,n=!0){if(!e||typeof e!="string")return null;if(t&&t.vars&&n){const r=`vars.${e}`.split(".").reduce((c,d)=>c&&c[d]?c[d]:null,t);if(r!=null)return r}return e.split(".").reduce((r,c)=>r&&r[c]!=null?r[c]:null,t)}function lO(t,e,n,r=n){let c;return typeof t=="function"?c=t(n):Array.isArray(t)?c=t[n]||r:c=pI(t,n)||r,e&&(c=e(c,r,t)),c}function _a(t){const{prop:e,cssProperty:n=t.prop,themeKey:r,transform:c}=t,d=m=>{if(m[e]==null)return null;const s=m[e],T=m.theme,D=pI(T,r)||{};return w_(m,s,z=>{let F=lO(D,c,z);return z===F&&typeof z=="string"&&(F=lO(D,c,`${e}${z==="default"?"":Rr(z)}`,z)),n===!1?F:{[n]:F}})};return d.propTypes={[e]:o0},d.filterProps=[e],d}function p9(t){const e={};return n=>(e[n]===void 0&&(e[n]=t(n)),e[n])}const m9={m:"margin",p:"padding"},g9={t:"Top",r:"Right",b:"Bottom",l:"Left",x:["Left","Right"],y:["Top","Bottom"]},vz={marginX:"mx",marginY:"my",paddingX:"px",paddingY:"py"},_9=p9(t=>{if(t.length>2)if(vz[t])t=vz[t];else return[t];const[e,n]=t.split(""),r=m9[e],c=g9[n]||"";return Array.isArray(c)?c.map(d=>r+d):[r+c]}),mI=["m","mt","mr","mb","ml","mx","my","margin","marginTop","marginRight","marginBottom","marginLeft","marginX","marginY","marginInline","marginInlineStart","marginInlineEnd","marginBlock","marginBlockStart","marginBlockEnd"],gI=["p","pt","pr","pb","pl","px","py","padding","paddingTop","paddingRight","paddingBottom","paddingLeft","paddingX","paddingY","paddingInline","paddingInlineStart","paddingInlineEnd","paddingBlock","paddingBlockStart","paddingBlockEnd"],y9=[...mI,...gI];function DA(t,e,n,r){const c=pI(t,e,!0)??n;return typeof c=="number"||typeof c=="string"?d=>typeof d=="string"?d:(typeof d!="number"&&console.error(`MUI: Expected ${r} argument to be a number or a string, got ${d}.`),typeof c=="string"?c.startsWith("var(")&&d===0?0:c.startsWith("var(")&&d===1?c:`calc(${d} * ${c})`:c*d):Array.isArray(c)?d=>{if(typeof d=="string")return d;const m=Math.abs(d);Number.isInteger(m)?m>c.length-1&&console.error([`MUI: The value provided (${m}) overflows.`,`The supported values are: ${JSON.stringify(c)}.`,`${m} > ${c.length-1}, you need to add the missing values.`].join(`
`)):console.error([`MUI: The \`theme.${e}\` array type cannot be combined with non integer values.You should either use an integer value that can be used as index, or define the \`theme.${e}\` as a number.`].join(`
`));const s=c[m];return d>=0?s:typeof s=="number"?-s:typeof s=="string"&&s.startsWith("var(")?`calc(-1 * ${s})`:`-${s}`}:typeof c=="function"?c:(console.error([`MUI: The \`theme.${e}\` value (${c}) is invalid.`,"It should be a number, an array or a function."].join(`
`)),()=>{})}function ON(t){return DA(t,"spacing",8,"spacing")}function RA(t,e){return typeof e=="string"||e==null?e:t(e)}function v9(t,e){return n=>t.reduce((r,c)=>(r[c]=RA(e,n),r),{})}function b9(t,e,n,r){if(!e.includes(n))return null;const c=_9(n),d=v9(c,r),m=t[n];return w_(t,m,d)}function HU(t,e){const n=ON(t.theme);return Object.keys(t).map(r=>b9(t,e,r,n)).reduce(LS,{})}function Qo(t){return HU(t,mI)}Qo.propTypes=mI.reduce((t,e)=>(t[e]=o0,t),{});Qo.filterProps=mI;function Ko(t){return HU(t,gI)}Ko.propTypes=gI.reduce((t,e)=>(t[e]=o0,t),{});Ko.filterProps=gI;y9.reduce((t,e)=>(t[e]=o0,t),{});function _I(...t){const e=t.reduce((r,c)=>(c.filterProps.forEach(d=>{r[d]=c}),r),{}),n=r=>Object.keys(r).reduce((c,d)=>e[d]?LS(c,e[d](r)):c,{});return n.propTypes=t.reduce((r,c)=>Object.assign(r,c.propTypes),{}),n.filterProps=t.reduce((r,c)=>r.concat(c.filterProps),[]),n}function Xd(t){return typeof t!="number"?t:`${t}px solid`}function af(t,e){return _a({prop:t,themeKey:"borders",transform:e})}const x9=af("border",Xd),w9=af("borderTop",Xd),T9=af("borderRight",Xd),E9=af("borderBottom",Xd),S9=af("borderLeft",Xd),A9=af("borderColor"),C9=af("borderTopColor"),D9=af("borderRightColor"),R9=af("borderBottomColor"),O9=af("borderLeftColor"),I9=af("outline",Xd),M9=af("outlineColor"),yI=t=>{if(t.borderRadius!==void 0&&t.borderRadius!==null){const e=DA(t.theme,"shape.borderRadius",4,"borderRadius"),n=r=>({borderRadius:RA(e,r)});return w_(t,t.borderRadius,n)}return null};yI.propTypes={borderRadius:o0};yI.filterProps=["borderRadius"];_I(x9,w9,T9,E9,S9,A9,C9,D9,R9,O9,yI,I9,M9);const vI=t=>{if(t.gap!==void 0&&t.gap!==null){const e=DA(t.theme,"spacing",8,"gap"),n=r=>({gap:RA(e,r)});return w_(t,t.gap,n)}return null};vI.propTypes={gap:o0};vI.filterProps=["gap"];const bI=t=>{if(t.columnGap!==void 0&&t.columnGap!==null){const e=DA(t.theme,"spacing",8,"columnGap"),n=r=>({columnGap:RA(e,r)});return w_(t,t.columnGap,n)}return null};bI.propTypes={columnGap:o0};bI.filterProps=["columnGap"];const xI=t=>{if(t.rowGap!==void 0&&t.rowGap!==null){const e=DA(t.theme,"spacing",8,"rowGap"),n=r=>({rowGap:RA(e,r)});return w_(t,t.rowGap,n)}return null};xI.propTypes={rowGap:o0};xI.filterProps=["rowGap"];const P9=_a({prop:"gridColumn"}),k9=_a({prop:"gridRow"}),N9=_a({prop:"gridAutoFlow"}),L9=_a({prop:"gridAutoColumns"}),z9=_a({prop:"gridAutoRows"}),B9=_a({prop:"gridTemplateColumns"}),F9=_a({prop:"gridTemplateRows"}),V9=_a({prop:"gridTemplateAreas"}),U9=_a({prop:"gridArea"});_I(vI,bI,xI,P9,k9,N9,L9,z9,B9,F9,V9,U9);function Iw(t,e){return e==="grey"?e:t}const j9=_a({prop:"color",themeKey:"palette",transform:Iw}),H9=_a({prop:"bgcolor",cssProperty:"backgroundColor",themeKey:"palette",transform:Iw}),$9=_a({prop:"backgroundColor",themeKey:"palette",transform:Iw});_I(j9,H9,$9);function $h(t){return t<=1&&t!==0?`${t*100}%`:t}const G9=_a({prop:"width",transform:$h}),IN=t=>{if(t.maxWidth!==void 0&&t.maxWidth!==null){const e=n=>{var c,d,m,s,T;const r=((m=(d=(c=t.theme)==null?void 0:c.breakpoints)==null?void 0:d.values)==null?void 0:m[n])||fI[n];return r?((T=(s=t.theme)==null?void 0:s.breakpoints)==null?void 0:T.unit)!=="px"?{maxWidth:`${r}${t.theme.breakpoints.unit}`}:{maxWidth:r}:{maxWidth:$h(n)}};return w_(t,t.maxWidth,e)}return null};IN.filterProps=["maxWidth"];const q9=_a({prop:"minWidth",transform:$h}),W9=_a({prop:"height",transform:$h}),Y9=_a({prop:"maxHeight",transform:$h}),Z9=_a({prop:"minHeight",transform:$h});_a({prop:"size",cssProperty:"width",transform:$h});_a({prop:"size",cssProperty:"height",transform:$h});const X9=_a({prop:"boxSizing"});_I(G9,IN,q9,W9,Y9,Z9,X9);const OA={border:{themeKey:"borders",transform:Xd},borderTop:{themeKey:"borders",transform:Xd},borderRight:{themeKey:"borders",transform:Xd},borderBottom:{themeKey:"borders",transform:Xd},borderLeft:{themeKey:"borders",transform:Xd},borderColor:{themeKey:"palette"},borderTopColor:{themeKey:"palette"},borderRightColor:{themeKey:"palette"},borderBottomColor:{themeKey:"palette"},borderLeftColor:{themeKey:"palette"},outline:{themeKey:"borders",transform:Xd},outlineColor:{themeKey:"palette"},borderRadius:{themeKey:"shape.borderRadius",style:yI},color:{themeKey:"palette",transform:Iw},bgcolor:{themeKey:"palette",cssProperty:"backgroundColor",transform:Iw},backgroundColor:{themeKey:"palette",transform:Iw},p:{style:Ko},pt:{style:Ko},pr:{style:Ko},pb:{style:Ko},pl:{style:Ko},px:{style:Ko},py:{style:Ko},padding:{style:Ko},paddingTop:{style:Ko},paddingRight:{style:Ko},paddingBottom:{style:Ko},paddingLeft:{style:Ko},paddingX:{style:Ko},paddingY:{style:Ko},paddingInline:{style:Ko},paddingInlineStart:{style:Ko},paddingInlineEnd:{style:Ko},paddingBlock:{style:Ko},paddingBlockStart:{style:Ko},paddingBlockEnd:{style:Ko},m:{style:Qo},mt:{style:Qo},mr:{style:Qo},mb:{style:Qo},ml:{style:Qo},mx:{style:Qo},my:{style:Qo},margin:{style:Qo},marginTop:{style:Qo},marginRight:{style:Qo},marginBottom:{style:Qo},marginLeft:{style:Qo},marginX:{style:Qo},marginY:{style:Qo},marginInline:{style:Qo},marginInlineStart:{style:Qo},marginInlineEnd:{style:Qo},marginBlock:{style:Qo},marginBlockStart:{style:Qo},marginBlockEnd:{style:Qo},displayPrint:{cssProperty:!1,transform:t=>({"@media print":{display:t}})},display:{},overflow:{},textOverflow:{},visibility:{},whiteSpace:{},flexBasis:{},flexDirection:{},flexWrap:{},justifyContent:{},alignItems:{},alignContent:{},order:{},flex:{},flexGrow:{},flexShrink:{},alignSelf:{},justifyItems:{},justifySelf:{},gap:{style:vI},rowGap:{style:xI},columnGap:{style:bI},gridColumn:{},gridRow:{},gridAutoFlow:{},gridAutoColumns:{},gridAutoRows:{},gridTemplateColumns:{},gridTemplateRows:{},gridTemplateAreas:{},gridArea:{},position:{},zIndex:{themeKey:"zIndex"},top:{},right:{},bottom:{},left:{},boxShadow:{themeKey:"shadows"},width:{transform:$h},maxWidth:{style:IN},minWidth:{transform:$h},height:{transform:$h},maxHeight:{transform:$h},minHeight:{transform:$h},boxSizing:{},font:{themeKey:"font"},fontFamily:{themeKey:"typography"},fontSize:{themeKey:"typography"},fontStyle:{themeKey:"typography"},fontWeight:{themeKey:"typography"},letterSpacing:{},textTransform:{},lineHeight:{},textAlign:{},typography:{cssProperty:!1,themeKey:"typography"}};function Q9(...t){const e=t.reduce((r,c)=>r.concat(Object.keys(c)),[]),n=new Set(e);return t.every(r=>n.size===Object.keys(r).length)}function K9(t,e){return typeof t=="function"?t(e):t}function J9(){function t(n,r,c,d){const m={[n]:r,theme:c},s=d[n];if(!s)return{[n]:r};const{cssProperty:T=n,themeKey:D,transform:P,style:z}=s;if(r==null)return null;if(D==="typography"&&r==="inherit")return{[n]:r};const F=pI(c,D)||{};return z?z(m):w_(m,r,J=>{let X=lO(F,P,J);return J===X&&typeof J=="string"&&(X=lO(F,P,`${n}${J==="default"?"":Rr(J)}`,J)),T===!1?X:{[T]:X}})}function e(n){const{sx:r,theme:c={}}=n||{};if(!r)return null;const d=c.unstable_sxConfig??OA;function m(s){let T=s;if(typeof s=="function")T=s(c);else if(typeof s!="object")return s;if(!T)return null;const D=d9(c.breakpoints),P=Object.keys(D);let z=D;return Object.keys(T).forEach(F=>{const $=K9(T[F],c);if($!=null)if(typeof $=="object")if(d[F])z=LS(z,t(F,$,c,d));else{const J=w_({theme:c},$,X=>({[F]:X}));Q9(J,$)?z[F]=e({sx:$,theme:c}):z=LS(z,J)}else z=LS(z,t(F,$,c,d))}),a9(c,f9(P,z))}return Array.isArray(r)?r.map(m):m(r)}return e}const dx=J9();dx.filterProps=["sx"];const eG=t=>{var r;const e={systemProps:{},otherProps:{}},n=((r=t==null?void 0:t.theme)==null?void 0:r.unstable_sxConfig)??OA;return Object.keys(t).forEach(c=>{n[c]?e.systemProps[c]=t[c]:e.otherProps[c]=t[c]}),e};function $U(t){const{sx:e,...n}=t,{systemProps:r,otherProps:c}=eG(n);let d;return Array.isArray(e)?d=[r,...e]:typeof e=="function"?d=(...m)=>{const s=e(...m);return Bm(s)?{...r,...s}:r}:d={...r,...e},{...c,sx:d}}function cO(){return cO=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var r in n)({}).hasOwnProperty.call(n,r)&&(t[r]=n[r])}return t},cO.apply(null,arguments)}function tG(t){if(t.sheet)return t.sheet;for(var e=0;e<document.styleSheets.length;e++)if(document.styleSheets[e].ownerNode===t)return document.styleSheets[e]}function nG(t){var e=document.createElement("style");return e.setAttribute("data-emotion",t.key),t.nonce!==void 0&&e.setAttribute("nonce",t.nonce),e.appendChild(document.createTextNode("")),e.setAttribute("data-s",""),e}var iG=function(){function t(n){var r=this;this._insertTag=function(c){var d;r.tags.length===0?r.insertionPoint?d=r.insertionPoint.nextSibling:r.prepend?d=r.container.firstChild:d=r.before:d=r.tags[r.tags.length-1].nextSibling,r.container.insertBefore(c,d),r.tags.push(c)},this.isSpeedy=n.speedy===void 0?!1:n.speedy,this.tags=[],this.ctr=0,this.nonce=n.nonce,this.key=n.key,this.container=n.container,this.prepend=n.prepend,this.insertionPoint=n.insertionPoint,this.before=null}var e=t.prototype;return e.hydrate=function(r){r.forEach(this._insertTag)},e.insert=function(r){this.ctr%(this.isSpeedy?65e3:1)===0&&this._insertTag(nG(this));var c=this.tags[this.tags.length-1];{var d=r.charCodeAt(0)===64&&r.charCodeAt(1)===105;d&&this._alreadyInsertedOrderInsensitiveRule&&console.error(`You're attempting to insert the following rule:
`+r+"\n\n`@import` rules must be before all other types of rules in a stylesheet but other rules have already been inserted. Please ensure that `@import` rules are before all other rules."),this._alreadyInsertedOrderInsensitiveRule=this._alreadyInsertedOrderInsensitiveRule||!d}if(this.isSpeedy){var m=tG(c);try{m.insertRule(r,m.cssRules.length)}catch(s){/:(-moz-placeholder|-moz-focus-inner|-moz-focusring|-ms-input-placeholder|-moz-read-write|-moz-read-only|-ms-clear|-ms-expand|-ms-reveal){/.test(r)||console.error('There was a problem inserting the following rule: "'+r+'"',s)}}else c.appendChild(document.createTextNode(r));this.ctr++},e.flush=function(){this.tags.forEach(function(r){var c;return(c=r.parentNode)==null?void 0:c.removeChild(r)}),this.tags=[],this.ctr=0,this._alreadyInsertedOrderInsensitiveRule=!1},t}(),Mc="-ms-",uO="-moz-",Cs="-webkit-",MN="comm",PN="rule",kN="decl",rG="@import",GU="@keyframes",sG="@layer",oG=Math.abs,wI=String.fromCharCode,aG=Object.assign;function lG(t,e){return Zl(t,0)^45?(((e<<2^Zl(t,0))<<2^Zl(t,1))<<2^Zl(t,2))<<2^Zl(t,3):0}function qU(t){return t.trim()}function cG(t,e){return(t=e.exec(t))?t[0]:t}function Ds(t,e,n){return t.replace(e,n)}function ck(t,e){return t.indexOf(e)}function Zl(t,e){return t.charCodeAt(e)|0}function eA(t,e,n){return t.slice(e,n)}function Nm(t){return t.length}function NN(t){return t.length}function WD(t,e){return e.push(t),t}function uG(t,e){return t.map(e).join("")}var TI=1,Hw=1,WU=0,Yu=0,za=0,hT="";function EI(t,e,n,r,c,d,m){return{value:t,root:e,parent:n,type:r,props:c,children:d,line:TI,column:Hw,length:m,return:""}}function sS(t,e){return aG(EI("",null,null,"",null,null,0),t,{length:-t.length},e)}function hG(){return za}function dG(){return za=Yu>0?Zl(hT,--Yu):0,Hw--,za===10&&(Hw=1,TI--),za}function Wh(){return za=Yu<WU?Zl(hT,Yu++):0,Hw++,za===10&&(Hw=1,TI++),za}function Fm(){return Zl(hT,Yu)}function PR(){return Yu}function IA(t,e){return eA(hT,t,e)}function tA(t){switch(t){case 0:case 9:case 10:case 13:case 32:return 5;case 33:case 43:case 44:case 47:case 62:case 64:case 126:case 59:case 123:case 125:return 4;case 58:return 3;case 34:case 39:case 40:case 91:return 2;case 41:case 93:return 1}return 0}function YU(t){return TI=Hw=1,WU=Nm(hT=t),Yu=0,[]}function ZU(t){return hT="",t}function kR(t){return qU(IA(Yu-1,uk(t===91?t+2:t===40?t+1:t)))}function fG(t){for(;(za=Fm())&&za<33;)Wh();return tA(t)>2||tA(za)>3?"":" "}function pG(t,e){for(;--e&&Wh()&&!(za<48||za>102||za>57&&za<65||za>70&&za<97););return IA(t,PR()+(e<6&&Fm()==32&&Wh()==32))}function uk(t){for(;Wh();)switch(za){case t:return Yu;case 34:case 39:t!==34&&t!==39&&uk(za);break;case 40:t===41&&uk(t);break;case 92:Wh();break}return Yu}function mG(t,e){for(;Wh()&&t+za!==57;)if(t+za===84&&Fm()===47)break;return"/*"+IA(e,Yu-1)+"*"+wI(t===47?t:Wh())}function gG(t){for(;!tA(Fm());)Wh();return IA(t,Yu)}function _G(t){return ZU(NR("",null,null,null,[""],t=YU(t),0,[0],t))}function NR(t,e,n,r,c,d,m,s,T){for(var D=0,P=0,z=m,F=0,$=0,J=0,X=1,te=1,ie=1,we=0,Ie="",Re=c,Ne=d,Xe=r,be=Ie;te;)switch(J=we,we=Wh()){case 40:if(J!=108&&Zl(be,z-1)==58){ck(be+=Ds(kR(we),"&","&\f"),"&\f")!=-1&&(ie=-1);break}case 34:case 39:case 91:be+=kR(we);break;case 9:case 10:case 13:case 32:be+=fG(J);break;case 92:be+=pG(PR()-1,7);continue;case 47:switch(Fm()){case 42:case 47:WD(yG(mG(Wh(),PR()),e,n),T);break;default:be+="/"}break;case 123*X:s[D++]=Nm(be)*ie;case 125*X:case 59:case 0:switch(we){case 0:case 125:te=0;case 59+P:ie==-1&&(be=Ds(be,/\f/g,"")),$>0&&Nm(be)-z&&WD($>32?xz(be+";",r,n,z-1):xz(Ds(be," ","")+";",r,n,z-2),T);break;case 59:be+=";";default:if(WD(Xe=bz(be,e,n,D,P,c,s,Ie,Re=[],Ne=[],z),d),we===123)if(P===0)NR(be,e,Xe,Xe,Re,d,z,s,Ne);else switch(F===99&&Zl(be,3)===110?100:F){case 100:case 108:case 109:case 115:NR(t,Xe,Xe,r&&WD(bz(t,Xe,Xe,0,0,c,s,Ie,c,Re=[],z),Ne),c,Ne,z,s,r?Re:Ne);break;default:NR(be,Xe,Xe,Xe,[""],Ne,0,s,Ne)}}D=P=$=0,X=ie=1,Ie=be="",z=m;break;case 58:z=1+Nm(be),$=J;default:if(X<1){if(we==123)--X;else if(we==125&&X++==0&&dG()==125)continue}switch(be+=wI(we),we*X){case 38:ie=P>0?1:(be+="\f",-1);break;case 44:s[D++]=(Nm(be)-1)*ie,ie=1;break;case 64:Fm()===45&&(be+=kR(Wh())),F=Fm(),P=z=Nm(Ie=be+=gG(PR())),we++;break;case 45:J===45&&Nm(be)==2&&(X=0)}}return d}function bz(t,e,n,r,c,d,m,s,T,D,P){for(var z=c-1,F=c===0?d:[""],$=NN(F),J=0,X=0,te=0;J<r;++J)for(var ie=0,we=eA(t,z+1,z=oG(X=m[J])),Ie=t;ie<$;++ie)(Ie=qU(X>0?F[ie]+" "+we:Ds(we,/&\f/g,F[ie])))&&(T[te++]=Ie);return EI(t,e,n,c===0?PN:s,T,D,P)}function yG(t,e,n){return EI(t,e,n,MN,wI(hG()),eA(t,2,-2),0)}function xz(t,e,n,r){return EI(t,e,n,kN,eA(t,0,r),eA(t,r+1,-1),r)}function Mw(t,e){for(var n="",r=NN(t),c=0;c<r;c++)n+=e(t[c],c,t,e)||"";return n}function vG(t,e,n,r){switch(t.type){case sG:if(t.children.length)break;case rG:case kN:return t.return=t.return||t.value;case MN:return"";case GU:return t.return=t.value+"{"+Mw(t.children,r)+"}";case PN:t.value=t.props.join(",")}return Nm(n=Mw(t.children,r))?t.return=t.value+"{"+n+"}":""}function bG(t){var e=NN(t);return function(n,r,c,d){for(var m="",s=0;s<e;s++)m+=t[s](n,r,c,d)||"";return m}}function XU(t){var e=Object.create(null);return function(n){return e[n]===void 0&&(e[n]=t(n)),e[n]}}var xG=function(e,n,r){for(var c=0,d=0;c=d,d=Fm(),c===38&&d===12&&(n[r]=1),!tA(d);)Wh();return IA(e,Yu)},wG=function(e,n){var r=-1,c=44;do switch(tA(c)){case 0:c===38&&Fm()===12&&(n[r]=1),e[r]+=xG(Yu-1,n,r);break;case 2:e[r]+=kR(c);break;case 4:if(c===44){e[++r]=Fm()===58?"&\f":"",n[r]=e[r].length;break}default:e[r]+=wI(c)}while(c=Wh());return e},TG=function(e,n){return ZU(wG(YU(e),n))},wz=new WeakMap,EG=function(e){if(!(e.type!=="rule"||!e.parent||e.length<1)){for(var n=e.value,r=e.parent,c=e.column===r.column&&e.line===r.line;r.type!=="rule";)if(r=r.parent,!r)return;if(!(e.props.length===1&&n.charCodeAt(0)!==58&&!wz.get(r))&&!c){wz.set(e,!0);for(var d=[],m=TG(n,d),s=r.props,T=0,D=0;T<m.length;T++)for(var P=0;P<s.length;P++,D++)e.props[D]=d[T]?m[T].replace(/&\f/g,s[P]):s[P]+" "+m[T]}}},SG=function(e){if(e.type==="decl"){var n=e.value;n.charCodeAt(0)===108&&n.charCodeAt(2)===98&&(e.return="",e.value="")}},AG="emotion-disable-server-rendering-unsafe-selector-warning-please-do-not-use-this-the-warning-exists-for-a-reason",CG=function(e){return e.type==="comm"&&e.children.indexOf(AG)>-1},DG=function(e){return function(n,r,c){if(!(n.type!=="rule"||e.compat)){var d=n.value.match(/(:first|:nth|:nth-last)-child/g);if(d){for(var m=!!n.parent,s=m?n.parent.children:c,T=s.length-1;T>=0;T--){var D=s[T];if(D.line<n.line)break;if(D.column<n.column){if(CG(D))return;break}}d.forEach(function(P){console.error('The pseudo class "'+P+'" is potentially unsafe when doing server-side rendering. Try changing it to "'+P.split("-child")[0]+'-of-type".')})}}}},QU=function(e){return e.type.charCodeAt(1)===105&&e.type.charCodeAt(0)===64},RG=function(e,n){for(var r=e-1;r>=0;r--)if(!QU(n[r]))return!0;return!1},Tz=function(e){e.type="",e.value="",e.return="",e.children="",e.props=""},OG=function(e,n,r){QU(e)&&(e.parent?(console.error("`@import` rules can't be nested inside other rules. Please move it to the top level and put it before regular rules. Keep in mind that they can only be used within global styles."),Tz(e)):RG(n,r)&&(console.error("`@import` rules can't be after other rules. Please put your `@import` rules before your other rules."),Tz(e)))};function KU(t,e){switch(lG(t,e)){case 5103:return Cs+"print-"+t+t;case 5737:case 4201:case 3177:case 3433:case 1641:case 4457:case 2921:case 5572:case 6356:case 5844:case 3191:case 6645:case 3005:case 6391:case 5879:case 5623:case 6135:case 4599:case 4855:case 4215:case 6389:case 5109:case 5365:case 5621:case 3829:return Cs+t+t;case 5349:case 4246:case 4810:case 6968:case 2756:return Cs+t+uO+t+Mc+t+t;case 6828:case 4268:return Cs+t+Mc+t+t;case 6165:return Cs+t+Mc+"flex-"+t+t;case 5187:return Cs+t+Ds(t,/(\w+).+(:[^]+)/,Cs+"box-$1$2"+Mc+"flex-$1$2")+t;case 5443:return Cs+t+Mc+"flex-item-"+Ds(t,/flex-|-self/,"")+t;case 4675:return Cs+t+Mc+"flex-line-pack"+Ds(t,/align-content|flex-|-self/,"")+t;case 5548:return Cs+t+Mc+Ds(t,"shrink","negative")+t;case 5292:return Cs+t+Mc+Ds(t,"basis","preferred-size")+t;case 6060:return Cs+"box-"+Ds(t,"-grow","")+Cs+t+Mc+Ds(t,"grow","positive")+t;case 4554:return Cs+Ds(t,/([^-])(transform)/g,"$1"+Cs+"$2")+t;case 6187:return Ds(Ds(Ds(t,/(zoom-|grab)/,Cs+"$1"),/(image-set)/,Cs+"$1"),t,"")+t;case 5495:case 3959:return Ds(t,/(image-set\([^]*)/,Cs+"$1$`$1");case 4968:return Ds(Ds(t,/(.+:)(flex-)?(.*)/,Cs+"box-pack:$3"+Mc+"flex-pack:$3"),/s.+-b[^;]+/,"justify")+Cs+t+t;case 4095:case 3583:case 4068:case 2532:return Ds(t,/(.+)-inline(.+)/,Cs+"$1$2")+t;case 8116:case 7059:case 5753:case 5535:case 5445:case 5701:case 4933:case 4677:case 5533:case 5789:case 5021:case 4765:if(Nm(t)-1-e>6)switch(Zl(t,e+1)){case 109:if(Zl(t,e+4)!==45)break;case 102:return Ds(t,/(.+:)(.+)-([^]+)/,"$1"+Cs+"$2-$3$1"+uO+(Zl(t,e+3)==108?"$3":"$2-$3"))+t;case 115:return~ck(t,"stretch")?KU(Ds(t,"stretch","fill-available"),e)+t:t}break;case 4949:if(Zl(t,e+1)!==115)break;case 6444:switch(Zl(t,Nm(t)-3-(~ck(t,"!important")&&10))){case 107:return Ds(t,":",":"+Cs)+t;case 101:return Ds(t,/(.+:)([^;!]+)(;|!.+)?/,"$1"+Cs+(Zl(t,14)===45?"inline-":"")+"box$3$1"+Cs+"$2$3$1"+Mc+"$2box$3")+t}break;case 5936:switch(Zl(t,e+11)){case 114:return Cs+t+Mc+Ds(t,/[svh]\w+-[tblr]{2}/,"tb")+t;case 108:return Cs+t+Mc+Ds(t,/[svh]\w+-[tblr]{2}/,"tb-rl")+t;case 45:return Cs+t+Mc+Ds(t,/[svh]\w+-[tblr]{2}/,"lr")+t}return Cs+t+Mc+t+t}return t}var IG=function(e,n,r,c){if(e.length>-1&&!e.return)switch(e.type){case kN:e.return=KU(e.value,e.length);break;case GU:return Mw([sS(e,{value:Ds(e.value,"@","@"+Cs)})],c);case PN:if(e.length)return uG(e.props,function(d){switch(cG(d,/(::plac\w+|:read-\w+)/)){case":read-only":case":read-write":return Mw([sS(e,{props:[Ds(d,/:(read-\w+)/,":"+uO+"$1")]})],c);case"::placeholder":return Mw([sS(e,{props:[Ds(d,/:(plac\w+)/,":"+Cs+"input-$1")]}),sS(e,{props:[Ds(d,/:(plac\w+)/,":"+uO+"$1")]}),sS(e,{props:[Ds(d,/:(plac\w+)/,Mc+"input-$1")]})],c)}return""})}},MG=[IG],hk;{var PG=/\/\*#\ssourceMappingURL=data:application\/json;\S+\s+\*\//g;hk=function(e){var n=e.match(PG);if(n)return n[n.length-1]}}var kG=function(e){var n=e.key;if(!n)throw new Error(`You have to configure \`key\` for your cache. Please make sure it's unique (and not equal to 'css') as it's used for linking styles to your cache.
If multiple caches share the same key they might "fight" for each other's style elements.`);if(n==="css"){var r=document.querySelectorAll("style[data-emotion]:not([data-s])");Array.prototype.forEach.call(r,function(X){var te=X.getAttribute("data-emotion");te.indexOf(" ")!==-1&&(document.head.appendChild(X),X.setAttribute("data-s",""))})}var c=e.stylisPlugins||MG;if(/[^a-z-]/.test(n))throw new Error('Emotion key must only contain lower case alphabetical characters and - but "'+n+'" was passed');var d={},m,s=[];m=e.container||document.head,Array.prototype.forEach.call(document.querySelectorAll('style[data-emotion^="'+n+' "]'),function(X){for(var te=X.getAttribute("data-emotion").split(" "),ie=1;ie<te.length;ie++)d[te[ie]]=!0;s.push(X)});var T,D=[EG,SG];D.push(DG({get compat(){return J.compat}}),OG);{var P,z=[vG,function(X){X.root||(X.return?P.insert(X.return):X.value&&X.type!==MN&&P.insert(X.value+"{}"))}],F=bG(D.concat(c,z)),$=function(te){return Mw(_G(te),F)};T=function(te,ie,we,Ie){if(P=we,hk){var Re=hk(ie.styles);Re&&(P={insert:function(Xe){we.insert(Xe+Re)}})}$(te?te+"{"+ie.styles+"}":ie.styles),Ie&&(J.inserted[ie.name]=!0)}}var J={key:n,sheet:new iG({key:n,container:m,nonce:e.nonce,speedy:e.speedy,prepend:e.prepend,insertionPoint:e.insertionPoint}),nonce:e.nonce,inserted:d,registered:{},insert:T};return J.sheet.hydrate(s),J},cP={exports:{}},Ms={},Ez;function NG(){if(Ez)return Ms;Ez=1;/** @license React v16.13.1
 * react-is.development.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){var t=typeof Symbol=="function"&&Symbol.for,e=t?Symbol.for("react.element"):60103,n=t?Symbol.for("react.portal"):60106,r=t?Symbol.for("react.fragment"):60107,c=t?Symbol.for("react.strict_mode"):60108,d=t?Symbol.for("react.profiler"):60114,m=t?Symbol.for("react.provider"):60109,s=t?Symbol.for("react.context"):60110,T=t?Symbol.for("react.async_mode"):60111,D=t?Symbol.for("react.concurrent_mode"):60111,P=t?Symbol.for("react.forward_ref"):60112,z=t?Symbol.for("react.suspense"):60113,F=t?Symbol.for("react.suspense_list"):60120,$=t?Symbol.for("react.memo"):60115,J=t?Symbol.for("react.lazy"):60116,X=t?Symbol.for("react.block"):60121,te=t?Symbol.for("react.fundamental"):60117,ie=t?Symbol.for("react.responder"):60118,we=t?Symbol.for("react.scope"):60119;function Ie(Bt){return typeof Bt=="string"||typeof Bt=="function"||Bt===r||Bt===D||Bt===d||Bt===c||Bt===z||Bt===F||typeof Bt=="object"&&Bt!==null&&(Bt.$$typeof===J||Bt.$$typeof===$||Bt.$$typeof===m||Bt.$$typeof===s||Bt.$$typeof===P||Bt.$$typeof===te||Bt.$$typeof===ie||Bt.$$typeof===we||Bt.$$typeof===X)}function Re(Bt){if(typeof Bt=="object"&&Bt!==null){var ni=Bt.$$typeof;switch(ni){case e:var er=Bt.type;switch(er){case T:case D:case r:case d:case c:case z:return er;default:var _r=er&&er.$$typeof;switch(_r){case s:case P:case J:case $:case m:return _r;default:return ni}}case n:return ni}}}var Ne=T,Xe=D,be=s,_e=m,Te=e,oe=P,Ee=r,$e=J,ze=$,zt=n,St=d,mt=c,Ft=z,rn=!1;function Xt(Bt){return rn||(rn=!0,console.warn("The ReactIs.isAsyncMode() alias has been deprecated, and will be removed in React 17+. Update your code to use ReactIs.isConcurrentMode() instead. It has the exact same API.")),Fe(Bt)||Re(Bt)===T}function Fe(Bt){return Re(Bt)===D}function Ot(Bt){return Re(Bt)===s}function Ut(Bt){return Re(Bt)===m}function ln(Bt){return typeof Bt=="object"&&Bt!==null&&Bt.$$typeof===e}function wn(Bt){return Re(Bt)===P}function dn(Bt){return Re(Bt)===r}function Ht(Bt){return Re(Bt)===J}function Mn(Bt){return Re(Bt)===$}function yn(Bt){return Re(Bt)===n}function Tn(Bt){return Re(Bt)===d}function Cn(Bt){return Re(Bt)===c}function Kn(Bt){return Re(Bt)===z}Ms.AsyncMode=Ne,Ms.ConcurrentMode=Xe,Ms.ContextConsumer=be,Ms.ContextProvider=_e,Ms.Element=Te,Ms.ForwardRef=oe,Ms.Fragment=Ee,Ms.Lazy=$e,Ms.Memo=ze,Ms.Portal=zt,Ms.Profiler=St,Ms.StrictMode=mt,Ms.Suspense=Ft,Ms.isAsyncMode=Xt,Ms.isConcurrentMode=Fe,Ms.isContextConsumer=Ot,Ms.isContextProvider=Ut,Ms.isElement=ln,Ms.isForwardRef=wn,Ms.isFragment=dn,Ms.isLazy=Ht,Ms.isMemo=Mn,Ms.isPortal=yn,Ms.isProfiler=Tn,Ms.isStrictMode=Cn,Ms.isSuspense=Kn,Ms.isValidElementType=Ie,Ms.typeOf=Re}(),Ms}var Sz;function LG(){return Sz||(Sz=1,cP.exports=NG()),cP.exports}var uP,Az;function zG(){if(Az)return uP;Az=1;var t=LG(),e={childContextTypes:!0,contextType:!0,contextTypes:!0,defaultProps:!0,displayName:!0,getDefaultProps:!0,getDerivedStateFromError:!0,getDerivedStateFromProps:!0,mixins:!0,propTypes:!0,type:!0},n={name:!0,length:!0,prototype:!0,caller:!0,callee:!0,arguments:!0,arity:!0},r={$$typeof:!0,render:!0,defaultProps:!0,displayName:!0,propTypes:!0},c={$$typeof:!0,compare:!0,defaultProps:!0,displayName:!0,propTypes:!0,type:!0},d={};d[t.ForwardRef]=r,d[t.Memo]=c;function m(J){return t.isMemo(J)?c:d[J.$$typeof]||e}var s=Object.defineProperty,T=Object.getOwnPropertyNames,D=Object.getOwnPropertySymbols,P=Object.getOwnPropertyDescriptor,z=Object.getPrototypeOf,F=Object.prototype;function $(J,X,te){if(typeof X!="string"){if(F){var ie=z(X);ie&&ie!==F&&$(J,ie,te)}var we=T(X);D&&(we=we.concat(D(X)));for(var Ie=m(J),Re=m(X),Ne=0;Ne<we.length;++Ne){var Xe=we[Ne];if(!n[Xe]&&!(te&&te[Xe])&&!(Re&&Re[Xe])&&!(Ie&&Ie[Xe])){var be=P(X,Xe);try{s(J,Xe,be)}catch{}}}}return J}return uP=$,uP}zG();var BG=!0;function LN(t,e,n){var r="";return n.split(" ").forEach(function(c){t[c]!==void 0?e.push(t[c]+";"):c&&(r+=c+" ")}),r}var SI=function(e,n,r){var c=e.key+"-"+n.name;(r===!1||BG===!1)&&e.registered[c]===void 0&&(e.registered[c]=n.styles)},AI=function(e,n,r){SI(e,n,r);var c=e.key+"-"+n.name;if(e.inserted[n.name]===void 0){var d=n;do e.insert(n===d?"."+c:"",d,e.sheet,!0),d=d.next;while(d!==void 0)}};function FG(t){for(var e=0,n,r=0,c=t.length;c>=4;++r,c-=4)n=t.charCodeAt(r)&255|(t.charCodeAt(++r)&255)<<8|(t.charCodeAt(++r)&255)<<16|(t.charCodeAt(++r)&255)<<24,n=(n&65535)*1540483477+((n>>>16)*59797<<16),n^=n>>>24,e=(n&65535)*1540483477+((n>>>16)*59797<<16)^(e&65535)*1540483477+((e>>>16)*59797<<16);switch(c){case 3:e^=(t.charCodeAt(r+2)&255)<<16;case 2:e^=(t.charCodeAt(r+1)&255)<<8;case 1:e^=t.charCodeAt(r)&255,e=(e&65535)*1540483477+((e>>>16)*59797<<16)}return e^=e>>>13,e=(e&65535)*1540483477+((e>>>16)*59797<<16),((e^e>>>15)>>>0).toString(36)}var VG={animationIterationCount:1,aspectRatio:1,borderImageOutset:1,borderImageSlice:1,borderImageWidth:1,boxFlex:1,boxFlexGroup:1,boxOrdinalGroup:1,columnCount:1,columns:1,flex:1,flexGrow:1,flexPositive:1,flexShrink:1,flexNegative:1,flexOrder:1,gridRow:1,gridRowEnd:1,gridRowSpan:1,gridRowStart:1,gridColumn:1,gridColumnEnd:1,gridColumnSpan:1,gridColumnStart:1,msGridRow:1,msGridRowSpan:1,msGridColumn:1,msGridColumnSpan:1,fontWeight:1,lineHeight:1,opacity:1,order:1,orphans:1,scale:1,tabSize:1,widows:1,zIndex:1,zoom:1,WebkitLineClamp:1,fillOpacity:1,floodOpacity:1,stopOpacity:1,strokeDasharray:1,strokeDashoffset:1,strokeMiterlimit:1,strokeOpacity:1,strokeWidth:1},UG=!0,Cz=`You have illegal escape sequence in your template literal, most likely inside content's property value.
Because you write your CSS inside a JavaScript string you actually have to do double escaping, so for example "content: '\\00d7';" should become "content: '\\\\00d7';".
You can read more about this here:
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#ES2018_revision_of_illegal_escape_sequences`,jG="You have passed in falsy value as style object's key (can happen when in example you pass unexported component as computed key).",HG=/[A-Z]|^ms/g,JU=/_EMO_([^_]+?)_([^]*?)_EMO_/g,zN=function(e){return e.charCodeAt(1)===45},Dz=function(e){return e!=null&&typeof e!="boolean"},hP=XU(function(t){return zN(t)?t:t.replace(HG,"-$&").toLowerCase()}),hO=function(e,n){switch(e){case"animation":case"animationName":if(typeof n=="string")return n.replace(JU,function(r,c,d){return Lm={name:c,styles:d,next:Lm},c})}return VG[e]!==1&&!zN(e)&&typeof n=="number"&&n!==0?n+"px":n};{var $G=/(var|attr|counters?|url|element|(((repeating-)?(linear|radial))|conic)-gradient)\(|(no-)?(open|close)-quote/,GG=["normal","none","initial","inherit","unset"],qG=hO,WG=/^-ms-/,YG=/-(.)/g,Rz={};hO=function(e,n){if(e==="content"&&(typeof n!="string"||GG.indexOf(n)===-1&&!$G.test(n)&&(n.charAt(0)!==n.charAt(n.length-1)||n.charAt(0)!=='"'&&n.charAt(0)!=="'")))throw new Error("You seem to be using a value for 'content' without quotes, try replacing it with `content: '\""+n+"\"'`");var r=qG(e,n);return r!==""&&!zN(e)&&e.indexOf("-")!==-1&&Rz[e]===void 0&&(Rz[e]=!0,console.error("Using kebab-case for css properties in objects is not supported. Did you mean "+e.replace(WG,"ms-").replace(YG,function(c,d){return d.toUpperCase()})+"?")),r}}var e5="Component selectors can only be used in conjunction with @emotion/babel-plugin, the swc Emotion plugin, or another Emotion-aware compiler transform.";function nA(t,e,n){if(n==null)return"";var r=n;if(r.__emotion_styles!==void 0){if(String(r)==="NO_COMPONENT_SELECTOR")throw new Error(e5);return r}switch(typeof n){case"boolean":return"";case"object":{var c=n;if(c.anim===1)return Lm={name:c.name,styles:c.styles,next:Lm},c.name;var d=n;if(d.styles!==void 0){var m=d.next;if(m!==void 0)for(;m!==void 0;)Lm={name:m.name,styles:m.styles,next:Lm},m=m.next;var s=d.styles+";";return s}return ZG(t,e,n)}case"function":{if(t!==void 0){var T=Lm,D=n(t);return Lm=T,nA(t,e,D)}else console.error("Functions that are interpolated in css calls will be stringified.\nIf you want to have a css call based on props, create a function that returns a css call like this\nlet dynamicStyle = (props) => css`color: ${props.color}`\nIt can be called directly with props or interpolated in a styled call like this\nlet SomeComponent = styled('div')`${dynamicStyle}`");break}case"string":{var P=[],z=n.replace(JU,function(J,X,te){var ie="animation"+P.length;return P.push("const "+ie+" = keyframes`"+te.replace(/^@keyframes animation-\w+/,"")+"`"),"${"+ie+"}"});P.length&&console.error("`keyframes` output got interpolated into plain string, please wrap it with `css`.\n\nInstead of doing this:\n\n"+[].concat(P,["`"+z+"`"]).join(`
`)+`

You should wrap it with \`css\` like this:

css\``+z+"`")}break}var F=n;if(e==null)return F;var $=e[F];return $!==void 0?$:F}function ZG(t,e,n){var r="";if(Array.isArray(n))for(var c=0;c<n.length;c++)r+=nA(t,e,n[c])+";";else for(var d in n){var m=n[d];if(typeof m!="object"){var s=m;e!=null&&e[s]!==void 0?r+=d+"{"+e[s]+"}":Dz(s)&&(r+=hP(d)+":"+hO(d,s)+";")}else{if(d==="NO_COMPONENT_SELECTOR"&&UG)throw new Error(e5);if(Array.isArray(m)&&typeof m[0]=="string"&&(e==null||e[m[0]]===void 0))for(var T=0;T<m.length;T++)Dz(m[T])&&(r+=hP(d)+":"+hO(d,m[T])+";");else{var D=nA(t,e,m);switch(d){case"animation":case"animationName":{r+=hP(d)+":"+D+";";break}default:d==="undefined"&&console.error(jG),r+=d+"{"+D+"}"}}}}return r}var Oz=/label:\s*([^\s;{]+)\s*(;|$)/g,Lm;function fx(t,e,n){if(t.length===1&&typeof t[0]=="object"&&t[0]!==null&&t[0].styles!==void 0)return t[0];var r=!0,c="";Lm=void 0;var d=t[0];if(d==null||d.raw===void 0)r=!1,c+=nA(n,e,d);else{var m=d;m[0]===void 0&&console.error(Cz),c+=m[0]}for(var s=1;s<t.length;s++)if(c+=nA(n,e,t[s]),r){var T=d;T[s]===void 0&&console.error(Cz),c+=T[s]}Oz.lastIndex=0;for(var D="",P;(P=Oz.exec(c))!==null;)D+="-"+P[1];var z=FG(c)+D;{var F={name:z,styles:c,next:Lm,toString:function(){return"You have tried to stringify object returned from `css` function. It isn't supposed to be used directly (e.g. as value of the `className` prop), but rather handed to emotion so it can handle it (e.g. as value of `css` prop)."}};return F}}var XG=function(e){return e()},t5=lk.useInsertionEffect?lk.useInsertionEffect:!1,BN=t5||XG,Iz=t5||ke.useLayoutEffect,FN=ke.createContext(typeof HTMLElement<"u"?kG({key:"css"}):null);FN.displayName="EmotionCacheContext";FN.Provider;var CI=function(e){return ke.forwardRef(function(n,r){var c=ke.useContext(FN);return e(n,c,r)})},dT=ke.createContext({});dT.displayName="EmotionThemeContext";var VN={}.hasOwnProperty,Mz=function(e){var n=e.split(".");return n[n.length-1]},QG=function(e){var n=/^\s+at\s+([A-Za-z0-9$.]+)\s/.exec(e);if(n||(n=/^([A-Za-z0-9$.]+)@/.exec(e),n))return Mz(n[1])},KG=new Set(["renderWithHooks","processChild","finishClassComponent","renderToString"]),JG=function(e){return e.replace(/\$/g,"-")},eq=function(e){if(e)for(var n=e.split(`
`),r=0;r<n.length;r++){var c=QG(n[r]);if(c){if(KG.has(c))break;if(/^[A-Z]/.test(c))return JG(c)}}},dk="__EMOTION_TYPE_PLEASE_DO_NOT_USE__",fk="__EMOTION_LABEL_PLEASE_DO_NOT_USE__",tq=function(e,n){if(typeof n.css=="string"&&n.css.indexOf(":")!==-1)throw new Error("Strings are not allowed as css prop values, please wrap it in a css template literal from '@emotion/react' like this: css`"+n.css+"`");var r={};for(var c in n)VN.call(n,c)&&(r[c]=n[c]);if(r[dk]=e,typeof globalThis<"u"&&globalThis.EMOTION_RUNTIME_AUTO_LABEL&&n.css&&(typeof n.css!="object"||!("name"in n.css)||typeof n.css.name!="string"||n.css.name.indexOf("-")===-1)){var d=eq(new Error().stack);d&&(r[fk]=d)}return r},nq=function(e){var n=e.cache,r=e.serialized,c=e.isStringTag;return SI(n,r,c),BN(function(){return AI(n,r,c)}),null},n5=CI(function(t,e,n){var r=t.css;typeof r=="string"&&e.registered[r]!==void 0&&(r=e.registered[r]);var c=t[dk],d=[r],m="";typeof t.className=="string"?m=LN(e.registered,d,t.className):t.className!=null&&(m=t.className+" ");var s=fx(d,void 0,ke.useContext(dT));if(s.name.indexOf("-")===-1){var T=t[fk];T&&(s=fx([s,"label:"+T+";"]))}m+=e.key+"-"+s.name;var D={};for(var P in t)VN.call(t,P)&&P!=="css"&&P!==dk&&P!==fk&&(D[P]=t[P]);return D.className=m,n&&(D.ref=n),ke.createElement(ke.Fragment,null,ke.createElement(nq,{cache:e,serialized:s,isStringTag:typeof c=="string"}),ke.createElement(c,D))});n5.displayName="EmotionCssPropInternal";var iq=n5,Pz=!0,rq={version:"11.14.0"},kz=function(e,n){var r=arguments;if(n==null||!VN.call(n,"css"))return ke.createElement.apply(void 0,r);var c=r.length,d=new Array(c);d[0]=iq,d[1]=tq(e,n);for(var m=2;m<c;m++)d[m]=r[m];return ke.createElement.apply(null,d)};(function(t){var e;e||(e=t.JSX||(t.JSX={}))})(kz||(kz={}));var Nz=!1,sq=CI(function(t,e){!Nz&&("className"in t&&t.className||"css"in t&&t.css)&&(console.error("It looks like you're using the css prop on Global, did you mean to use the styles prop instead?"),Nz=!0);var n=t.styles,r=fx([n],void 0,ke.useContext(dT)),c=ke.useRef();return Iz(function(){var d=e.key+"-global",m=new e.sheet.constructor({key:d,nonce:e.sheet.nonce,container:e.sheet.container,speedy:e.sheet.isSpeedy}),s=!1,T=document.querySelector('style[data-emotion="'+d+" "+r.name+'"]');return e.sheet.tags.length&&(m.before=e.sheet.tags[0]),T!==null&&(s=!0,T.setAttribute("data-emotion",d),m.hydrate([T])),c.current=[m,s],function(){m.flush()}},[e]),Iz(function(){var d=c.current,m=d[0],s=d[1];if(s){d[1]=!1;return}if(r.next!==void 0&&AI(e,r.next,!0),m.tags.length){var T=m.tags[m.tags.length-1].nextElementSibling;m.before=T,m.flush()}e.insert("",r,m,!1)},[e,r.name]),null});sq.displayName="EmotionGlobal";function UN(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return fx(e)}function MA(){var t=UN.apply(void 0,arguments),e="animation-"+t.name;return{name:e,styles:"@keyframes "+e+"{"+t.styles+"}",anim:1,toString:function(){return"_EMO_"+this.name+"_"+this.styles+"_EMO_"}}}var oq=function t(e){for(var n=e.length,r=0,c="";r<n;r++){var d=e[r];if(d!=null){var m=void 0;switch(typeof d){case"boolean":break;case"object":{if(Array.isArray(d))m=t(d);else{d.styles!==void 0&&d.name!==void 0&&console.error("You have passed styles created with `css` from `@emotion/react` package to the `cx`.\n`cx` is meant to compose class names (strings) so you should convert those styles to a class name by passing them to the `css` received from <ClassNames/> component."),m="";for(var s in d)d[s]&&s&&(m&&(m+=" "),m+=s)}break}default:m=d}m&&(c&&(c+=" "),c+=m)}}return c};function aq(t,e,n){var r=[],c=LN(t,r,n);return r.length<2?n:c+e(r)}var lq=function(e){var n=e.cache,r=e.serializedArr;return BN(function(){for(var c=0;c<r.length;c++)AI(n,r[c],!1)}),null},cq=CI(function(t,e){var n=!1,r=[],c=function(){if(n&&Pz)throw new Error("css can only be used during render");for(var D=arguments.length,P=new Array(D),z=0;z<D;z++)P[z]=arguments[z];var F=fx(P,e.registered);return r.push(F),SI(e,F,!1),e.key+"-"+F.name},d=function(){if(n&&Pz)throw new Error("cx can only be used during render");for(var D=arguments.length,P=new Array(D),z=0;z<D;z++)P[z]=arguments[z];return aq(e.registered,c,oq(P))},m={css:c,cx:d,theme:ke.useContext(dT)},s=t.children(m);return n=!0,ke.createElement(ke.Fragment,null,ke.createElement(lq,{cache:e,serializedArr:r}),s)});cq.displayName="EmotionClassNames";{var Lz=typeof document<"u",uq=typeof jest<"u"||typeof vi<"u";if(Lz&&!uq){var zz=typeof globalThis<"u"?globalThis:Lz?window:global,Bz="__EMOTION_REACT_"+rq.version.split(".")[0]+"__";zz[Bz]&&console.warn("You are loading @emotion/react when it is already loaded. Running multiple instances may cause problems. This can happen if multiple versions are used, or if multiple builds of the same version are used."),zz[Bz]=!0}}var hq=/^((children|dangerouslySetInnerHTML|key|ref|autoFocus|defaultValue|defaultChecked|innerHTML|suppressContentEditableWarning|suppressHydrationWarning|valueLink|abbr|accept|acceptCharset|accessKey|action|allow|allowUserMedia|allowPaymentRequest|allowFullScreen|allowTransparency|alt|async|autoComplete|autoPlay|capture|cellPadding|cellSpacing|challenge|charSet|checked|cite|classID|className|cols|colSpan|content|contentEditable|contextMenu|controls|controlsList|coords|crossOrigin|data|dateTime|decoding|default|defer|dir|disabled|disablePictureInPicture|disableRemotePlayback|download|draggable|encType|enterKeyHint|fetchpriority|fetchPriority|form|formAction|formEncType|formMethod|formNoValidate|formTarget|frameBorder|headers|height|hidden|high|href|hrefLang|htmlFor|httpEquiv|id|inputMode|integrity|is|keyParams|keyType|kind|label|lang|list|loading|loop|low|marginHeight|marginWidth|max|maxLength|media|mediaGroup|method|min|minLength|multiple|muted|name|nonce|noValidate|open|optimum|pattern|placeholder|playsInline|poster|preload|profile|radioGroup|readOnly|referrerPolicy|rel|required|reversed|role|rows|rowSpan|sandbox|scope|scoped|scrolling|seamless|selected|shape|size|sizes|slot|span|spellCheck|src|srcDoc|srcLang|srcSet|start|step|style|summary|tabIndex|target|title|translate|type|useMap|value|width|wmode|wrap|about|datatype|inlist|prefix|property|resource|typeof|vocab|autoCapitalize|autoCorrect|autoSave|color|incremental|fallback|inert|itemProp|itemScope|itemType|itemID|itemRef|on|option|results|security|unselectable|accentHeight|accumulate|additive|alignmentBaseline|allowReorder|alphabetic|amplitude|arabicForm|ascent|attributeName|attributeType|autoReverse|azimuth|baseFrequency|baselineShift|baseProfile|bbox|begin|bias|by|calcMode|capHeight|clip|clipPathUnits|clipPath|clipRule|colorInterpolation|colorInterpolationFilters|colorProfile|colorRendering|contentScriptType|contentStyleType|cursor|cx|cy|d|decelerate|descent|diffuseConstant|direction|display|divisor|dominantBaseline|dur|dx|dy|edgeMode|elevation|enableBackground|end|exponent|externalResourcesRequired|fill|fillOpacity|fillRule|filter|filterRes|filterUnits|floodColor|floodOpacity|focusable|fontFamily|fontSize|fontSizeAdjust|fontStretch|fontStyle|fontVariant|fontWeight|format|from|fr|fx|fy|g1|g2|glyphName|glyphOrientationHorizontal|glyphOrientationVertical|glyphRef|gradientTransform|gradientUnits|hanging|horizAdvX|horizOriginX|ideographic|imageRendering|in|in2|intercept|k|k1|k2|k3|k4|kernelMatrix|kernelUnitLength|kerning|keyPoints|keySplines|keyTimes|lengthAdjust|letterSpacing|lightingColor|limitingConeAngle|local|markerEnd|markerMid|markerStart|markerHeight|markerUnits|markerWidth|mask|maskContentUnits|maskUnits|mathematical|mode|numOctaves|offset|opacity|operator|order|orient|orientation|origin|overflow|overlinePosition|overlineThickness|panose1|paintOrder|pathLength|patternContentUnits|patternTransform|patternUnits|pointerEvents|points|pointsAtX|pointsAtY|pointsAtZ|preserveAlpha|preserveAspectRatio|primitiveUnits|r|radius|refX|refY|renderingIntent|repeatCount|repeatDur|requiredExtensions|requiredFeatures|restart|result|rotate|rx|ry|scale|seed|shapeRendering|slope|spacing|specularConstant|specularExponent|speed|spreadMethod|startOffset|stdDeviation|stemh|stemv|stitchTiles|stopColor|stopOpacity|strikethroughPosition|strikethroughThickness|string|stroke|strokeDasharray|strokeDashoffset|strokeLinecap|strokeLinejoin|strokeMiterlimit|strokeOpacity|strokeWidth|surfaceScale|systemLanguage|tableValues|targetX|targetY|textAnchor|textDecoration|textRendering|textLength|to|transform|u1|u2|underlinePosition|underlineThickness|unicode|unicodeBidi|unicodeRange|unitsPerEm|vAlphabetic|vHanging|vIdeographic|vMathematical|values|vectorEffect|version|vertAdvY|vertOriginX|vertOriginY|viewBox|viewTarget|visibility|widths|wordSpacing|writingMode|x|xHeight|x1|x2|xChannelSelector|xlinkActuate|xlinkArcrole|xlinkHref|xlinkRole|xlinkShow|xlinkTitle|xlinkType|xmlBase|xmlns|xmlnsXlink|xmlLang|xmlSpace|y|y1|y2|yChannelSelector|z|zoomAndPan|for|class|autofocus)|(([Dd][Aa][Tt][Aa]|[Aa][Rr][Ii][Aa]|x)-.*))$/,dq=XU(function(t){return hq.test(t)||t.charCodeAt(0)===111&&t.charCodeAt(1)===110&&t.charCodeAt(2)<91}),fq=!0,pq=dq,mq=function(e){return e!=="theme"},Fz=function(e){return typeof e=="string"&&e.charCodeAt(0)>96?pq:mq},Vz=function(e,n,r){var c;if(n){var d=n.shouldForwardProp;c=e.__emotion_forwardProp&&d?function(m){return e.__emotion_forwardProp(m)&&d(m)}:d}return typeof c!="function"&&r&&(c=e.__emotion_forwardProp),c},Uz=`You have illegal escape sequence in your template literal, most likely inside content's property value.
Because you write your CSS inside a JavaScript string you actually have to do double escaping, so for example "content: '\\00d7';" should become "content: '\\\\00d7';".
You can read more about this here:
https://developer.mozilla.org/en-US/docs/Web/JavaScript/Reference/Template_literals#ES2018_revision_of_illegal_escape_sequences`,gq=function(e){var n=e.cache,r=e.serialized,c=e.isStringTag;return SI(n,r,c),BN(function(){return AI(n,r,c)}),null},_q=function t(e,n){if(e===void 0)throw new Error(`You are trying to create a styled element with an undefined component.
You may have forgotten to import it.`);var r=e.__emotion_real===e,c=r&&e.__emotion_base||e,d,m;n!==void 0&&(d=n.label,m=n.target);var s=Vz(e,n,r),T=s||Fz(c),D=!T("as");return function(){var P=arguments,z=r&&e.__emotion_styles!==void 0?e.__emotion_styles.slice(0):[];if(d!==void 0&&z.push("label:"+d+";"),P[0]==null||P[0].raw===void 0)z.push.apply(z,P);else{var F=P[0];F[0]===void 0&&console.error(Uz),z.push(F[0]);for(var $=P.length,J=1;J<$;J++)F[J]===void 0&&console.error(Uz),z.push(P[J],F[J])}var X=CI(function(te,ie,we){var Ie=D&&te.as||c,Re="",Ne=[],Xe=te;if(te.theme==null){Xe={};for(var be in te)Xe[be]=te[be];Xe.theme=ke.useContext(dT)}typeof te.className=="string"?Re=LN(ie.registered,Ne,te.className):te.className!=null&&(Re=te.className+" ");var _e=fx(z.concat(Ne),ie.registered,Xe);Re+=ie.key+"-"+_e.name,m!==void 0&&(Re+=" "+m);var Te=D&&s===void 0?Fz(Ie):T,oe={};for(var Ee in te)D&&Ee==="as"||Te(Ee)&&(oe[Ee]=te[Ee]);return oe.className=Re,we&&(oe.ref=we),ke.createElement(ke.Fragment,null,ke.createElement(gq,{cache:ie,serialized:_e,isStringTag:typeof Ie=="string"}),ke.createElement(Ie,oe))});return X.displayName=d!==void 0?d:"Styled("+(typeof c=="string"?c:c.displayName||c.name||"Component")+")",X.defaultProps=e.defaultProps,X.__emotion_real=X,X.__emotion_base=c,X.__emotion_styles=z,X.__emotion_forwardProp=s,Object.defineProperty(X,"toString",{value:function(){return m===void 0&&fq?"NO_COMPONENT_SELECTOR":"."+m}}),X.withComponent=function(te,ie){var we=t(te,cO({},n,ie,{shouldForwardProp:Vz(X,ie,!0)}));return we.apply(void 0,z)},X}},yq=["a","abbr","address","area","article","aside","audio","b","base","bdi","bdo","big","blockquote","body","br","button","canvas","caption","cite","code","col","colgroup","data","datalist","dd","del","details","dfn","dialog","div","dl","dt","em","embed","fieldset","figcaption","figure","footer","form","h1","h2","h3","h4","h5","h6","head","header","hgroup","hr","html","i","iframe","img","input","ins","kbd","keygen","label","legend","li","link","main","map","mark","marquee","menu","menuitem","meta","meter","nav","noscript","object","ol","optgroup","option","output","p","param","picture","pre","progress","q","rp","rt","ruby","s","samp","script","section","select","small","source","span","strong","style","sub","summary","sup","table","tbody","td","textarea","tfoot","th","thead","time","title","tr","track","u","ul","var","video","wbr","circle","clipPath","defs","ellipse","foreignObject","g","image","line","linearGradient","mask","path","pattern","polygon","polyline","radialGradient","rect","stop","svg","text","tspan"],pk=_q.bind(null);yq.forEach(function(t){pk[t]=pk(t)});var dP={exports:{}},oS={},jz;function vq(){if(jz)return oS;jz=1;/**
 * @license React
 * react-jsx-runtime.development.js
 *
 * Copyright (c) Meta Platforms, Inc. and affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */return function(){function t(Fe){if(Fe==null)return null;if(typeof Fe=="function")return Fe.$$typeof===oe?null:Fe.displayName||Fe.name||null;if(typeof Fe=="string")return Fe;switch(Fe){case X:return"Fragment";case ie:return"Profiler";case te:return"StrictMode";case Ne:return"Suspense";case Xe:return"SuspenseList";case Te:return"Activity"}if(typeof Fe=="object")switch(typeof Fe.tag=="number"&&console.error("Received an unexpected object in getComponentNameFromType(). This is likely a bug in React. Please file an issue."),Fe.$$typeof){case J:return"Portal";case Ie:return(Fe.displayName||"Context")+".Provider";case we:return(Fe._context.displayName||"Context")+".Consumer";case Re:var Ot=Fe.render;return Fe=Fe.displayName,Fe||(Fe=Ot.displayName||Ot.name||"",Fe=Fe!==""?"ForwardRef("+Fe+")":"ForwardRef"),Fe;case be:return Ot=Fe.displayName||null,Ot!==null?Ot:t(Fe.type)||"Memo";case _e:Ot=Fe._payload,Fe=Fe._init;try{return t(Fe(Ot))}catch{}}return null}function e(Fe){return""+Fe}function n(Fe){try{e(Fe);var Ot=!1}catch{Ot=!0}if(Ot){Ot=console;var Ut=Ot.error,ln=typeof Symbol=="function"&&Symbol.toStringTag&&Fe[Symbol.toStringTag]||Fe.constructor.name||"Object";return Ut.call(Ot,"The provided key is an unsupported type %s. This value must be coerced to a string before using it here.",ln),e(Fe)}}function r(Fe){if(Fe===X)return"<>";if(typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===_e)return"<...>";try{var Ot=t(Fe);return Ot?"<"+Ot+">":"<...>"}catch{return"<...>"}}function c(){var Fe=Ee.A;return Fe===null?null:Fe.getOwner()}function d(){return Error("react-stack-top-frame")}function m(Fe){if($e.call(Fe,"key")){var Ot=Object.getOwnPropertyDescriptor(Fe,"key").get;if(Ot&&Ot.isReactWarning)return!1}return Fe.key!==void 0}function s(Fe,Ot){function Ut(){St||(St=!0,console.error("%s: `key` is not a prop. Trying to access it will result in `undefined` being returned. If you need to access the same value within the child component, you should pass it as a different prop. (https://react.dev/link/special-props)",Ot))}Ut.isReactWarning=!0,Object.defineProperty(Fe,"key",{get:Ut,configurable:!0})}function T(){var Fe=t(this.type);return mt[Fe]||(mt[Fe]=!0,console.error("Accessing element.ref was removed in React 19. ref is now a regular prop. It will be removed from the JSX Element type in a future release.")),Fe=this.props.ref,Fe!==void 0?Fe:null}function D(Fe,Ot,Ut,ln,wn,dn,Ht,Mn){return Ut=dn.ref,Fe={$$typeof:$,type:Fe,key:Ot,props:dn,_owner:wn},(Ut!==void 0?Ut:null)!==null?Object.defineProperty(Fe,"ref",{enumerable:!1,get:T}):Object.defineProperty(Fe,"ref",{enumerable:!1,value:null}),Fe._store={},Object.defineProperty(Fe._store,"validated",{configurable:!1,enumerable:!1,writable:!0,value:0}),Object.defineProperty(Fe,"_debugInfo",{configurable:!1,enumerable:!1,writable:!0,value:null}),Object.defineProperty(Fe,"_debugStack",{configurable:!1,enumerable:!1,writable:!0,value:Ht}),Object.defineProperty(Fe,"_debugTask",{configurable:!1,enumerable:!1,writable:!0,value:Mn}),Object.freeze&&(Object.freeze(Fe.props),Object.freeze(Fe)),Fe}function P(Fe,Ot,Ut,ln,wn,dn,Ht,Mn){var yn=Ot.children;if(yn!==void 0)if(ln)if(ze(yn)){for(ln=0;ln<yn.length;ln++)z(yn[ln]);Object.freeze&&Object.freeze(yn)}else console.error("React.jsx: Static children should always be an array. You are likely explicitly calling React.jsxs or React.jsxDEV. Use the Babel transform instead.");else z(yn);if($e.call(Ot,"key")){yn=t(Fe);var Tn=Object.keys(Ot).filter(function(Kn){return Kn!=="key"});ln=0<Tn.length?"{key: someKey, "+Tn.join(": ..., ")+": ...}":"{key: someKey}",Xt[yn+ln]||(Tn=0<Tn.length?"{"+Tn.join(": ..., ")+": ...}":"{}",console.error(`A props object containing a "key" prop is being spread into JSX:
  let props = %s;
  <%s {...props} />
React keys must be passed directly to JSX without using spread:
  let props = %s;
  <%s key={someKey} {...props} />`,ln,yn,Tn,yn),Xt[yn+ln]=!0)}if(yn=null,Ut!==void 0&&(n(Ut),yn=""+Ut),m(Ot)&&(n(Ot.key),yn=""+Ot.key),"key"in Ot){Ut={};for(var Cn in Ot)Cn!=="key"&&(Ut[Cn]=Ot[Cn])}else Ut=Ot;return yn&&s(Ut,typeof Fe=="function"?Fe.displayName||Fe.name||"Unknown":Fe),D(Fe,yn,dn,wn,c(),Ut,Ht,Mn)}function z(Fe){typeof Fe=="object"&&Fe!==null&&Fe.$$typeof===$&&Fe._store&&(Fe._store.validated=1)}var F=CA(),$=Symbol.for("react.transitional.element"),J=Symbol.for("react.portal"),X=Symbol.for("react.fragment"),te=Symbol.for("react.strict_mode"),ie=Symbol.for("react.profiler"),we=Symbol.for("react.consumer"),Ie=Symbol.for("react.context"),Re=Symbol.for("react.forward_ref"),Ne=Symbol.for("react.suspense"),Xe=Symbol.for("react.suspense_list"),be=Symbol.for("react.memo"),_e=Symbol.for("react.lazy"),Te=Symbol.for("react.activity"),oe=Symbol.for("react.client.reference"),Ee=F.__CLIENT_INTERNALS_DO_NOT_USE_OR_WARN_USERS_THEY_CANNOT_UPGRADE,$e=Object.prototype.hasOwnProperty,ze=Array.isArray,zt=console.createTask?console.createTask:function(){return null};F={"react-stack-bottom-frame":function(Fe){return Fe()}};var St,mt={},Ft=F["react-stack-bottom-frame"].bind(F,d)(),rn=zt(r(d)),Xt={};oS.Fragment=X,oS.jsx=function(Fe,Ot,Ut,ln,wn){var dn=1e4>Ee.recentlyCreatedOwnerStacks++;return P(Fe,Ot,Ut,!1,ln,wn,dn?Error("react-stack-top-frame"):Ft,dn?zt(r(Fe)):rn)},oS.jsxs=function(Fe,Ot,Ut,ln,wn){var dn=1e4>Ee.recentlyCreatedOwnerStacks++;return P(Fe,Ot,Ut,!0,ln,wn,dn?Error("react-stack-top-frame"):Ft,dn?zt(r(Fe)):rn)}}(),oS}var Hz;function bq(){return Hz||(Hz=1,dP.exports=vq()),dP.exports}var Qn=bq();function i5(t,e){const n=pk(t,e);return(...r)=>{const c=typeof t=="string"?`"${t}"`:"component";return r.length===0?console.error([`MUI: Seems like you called \`styled(${c})()\` without a \`style\` argument.`,'You must provide a `styles` argument: `styled("div")(styleYouForgotToPass)`.'].join(`
`)):r.some(d=>d===void 0)&&console.error(`MUI: the styled(${c})(...args) API requires all its args to be defined.`),n(...r)}}function xq(t,e){Array.isArray(t.__emotion_styles)&&(t.__emotion_styles=e(t.__emotion_styles))}const $z=[];function Gz(t){return $z[0]=t,fx($z)}const wq=t=>{const e=Object.keys(t).map(n=>({key:n,val:t[n]}))||[];return e.sort((n,r)=>n.val-r.val),e.reduce((n,r)=>({...n,[r.key]:r.val}),{})};function Tq(t){const{values:e={xs:0,sm:600,md:900,lg:1200,xl:1536},unit:n="px",step:r=5,...c}=t,d=wq(e),m=Object.keys(d);function s(F){return`@media (min-width:${typeof e[F]=="number"?e[F]:F}${n})`}function T(F){return`@media (max-width:${(typeof e[F]=="number"?e[F]:F)-r/100}${n})`}function D(F,$){const J=m.indexOf($);return`@media (min-width:${typeof e[F]=="number"?e[F]:F}${n}) and (max-width:${(J!==-1&&typeof e[m[J]]=="number"?e[m[J]]:$)-r/100}${n})`}function P(F){return m.indexOf(F)+1<m.length?D(F,m[m.indexOf(F)+1]):s(F)}function z(F){const $=m.indexOf(F);return $===0?s(m[1]):$===m.length-1?T(m[$]):D(F,m[m.indexOf(F)+1]).replace("@media","@media not all and")}return{keys:m,values:d,up:s,down:T,between:D,only:P,not:z,unit:n,...c}}const Eq={borderRadius:4};function r5(t=8,e=ON({spacing:t})){if(t.mui)return t;const n=(...r)=>(r.length<=4||console.error(`MUI: Too many arguments provided, expected between 0 and 4, got ${r.length}`),(r.length===0?[1]:r).map(d=>{const m=e(d);return typeof m=="number"?`${m}px`:m}).join(" "));return n.mui=!0,n}function Sq(t,e){var r;const n=this;if(n.vars){if(!((r=n.colorSchemes)!=null&&r[t])||typeof n.getColorSchemeSelector!="function")return{};let c=n.getColorSchemeSelector(t);return c==="&"?e:((c.includes("data-")||c.includes("."))&&(c=`*:where(${c.replace(/\s*&$/,"")}) &`),{[c]:e})}return n.palette.mode===t?e:{}}function DI(t={},...e){const{breakpoints:n={},palette:r={},spacing:c,shape:d={},...m}=t,s=Tq(n),T=r5(c);let D=qh({breakpoints:s,direction:"ltr",components:{},palette:{mode:"light",...r},spacing:T,shape:{...Eq,...d}},m);return D=u9(D),D.applyStyles=Sq,D=e.reduce((P,z)=>qh(P,z),D),D.unstable_sxConfig={...OA,...m==null?void 0:m.unstable_sxConfig},D.unstable_sx=function(z){return dx({sx:z,theme:this})},D}function Aq(t){return Object.keys(t).length===0}function Cq(t=null){const e=ke.useContext(dT);return!e||Aq(e)?t:e}const Dq=DI();function jN(t=Dq){return Cq(t)}const qz=t=>t,Rq=()=>{let t=qz;return{configure(e){t=e},generate(e){return t(e)},reset(){t=qz}}},s5=Rq();function Oq(t={}){const{themeId:e,defaultTheme:n,defaultClassName:r="MuiBox-root",generateClassName:c}=t,d=i5("div",{shouldForwardProp:s=>s!=="theme"&&s!=="sx"&&s!=="as"})(dx);return ke.forwardRef(function(T,D){const P=jN(n),{className:z,component:F="div",...$}=$U(T);return Qn.jsx(d,{as:F,ref:D,className:Dr(z,c?c(r):r),theme:e&&P[e]||P,...$})})}const Iq={active:"active",checked:"checked",completed:"completed",disabled:"disabled",error:"error",expanded:"expanded",focused:"focused",focusVisible:"focusVisible",open:"open",readOnly:"readOnly",required:"required",selected:"selected"};function wo(t,e,n="Mui"){const r=Iq[e];return r?`${n}-${r}`:`${s5.generate(t)}-${e}`}function io(t,e,n="Mui"){const r={};return e.forEach(c=>{r[c]=wo(t,c,n)}),r}function o5(t,e=""){return t.displayName||t.name||e}function Wz(t,e,n){const r=o5(e);return t.displayName||(r!==""?`${n}(${r})`:n)}function Mq(t){if(t!=null){if(typeof t=="string")return t;if(typeof t=="function")return o5(t,"Component");if(typeof t=="object")switch(t.$$typeof){case hx.ForwardRef:return Wz(t,t.render,"ForwardRef");case hx.Memo:return Wz(t,t.type,"memo");default:return}}}function a5(t){const{variants:e,...n}=t,r={variants:e,style:Gz(n),isProcessed:!0};return r.style===n||e&&e.forEach(c=>{typeof c.style!="function"&&(c.style=Gz(c.style))}),r}const Pq=DI();function fP(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}function kq(t){return t?(e,n)=>n[t]:null}function Nq(t,e,n){t.theme=Bq(t.theme)?n:t.theme[e]||t.theme}function LR(t,e){const n=typeof e=="function"?e(t):e;if(Array.isArray(n))return n.flatMap(r=>LR(t,r));if(Array.isArray(n==null?void 0:n.variants)){let r;if(n.isProcessed)r=n.style;else{const{variants:c,...d}=n;r=d}return l5(t,n.variants,[r])}return n!=null&&n.isProcessed?n.style:n}function l5(t,e,n=[]){var c;let r;e:for(let d=0;d<e.length;d+=1){const m=e[d];if(typeof m.props=="function"){if(r??(r={...t,...t.ownerState,ownerState:t.ownerState}),!m.props(r))continue}else for(const s in m.props)if(t[s]!==m.props[s]&&((c=t.ownerState)==null?void 0:c[s])!==m.props[s])continue e;typeof m.style=="function"?(r??(r={...t,...t.ownerState,ownerState:t.ownerState}),n.push(m.style(r))):n.push(m.style)}return n}function c5(t={}){const{themeId:e,defaultTheme:n=Pq,rootShouldForwardProp:r=fP,slotShouldForwardProp:c=fP}=t;function d(s){Nq(s,e,n)}return(s,T={})=>{xq(s,Ne=>Ne.filter(Xe=>Xe!==dx));const{name:D,slot:P,skipVariantsResolver:z,skipSx:F,overridesResolver:$=kq(u5(P)),...J}=T,X=z!==void 0?z:P&&P!=="Root"&&P!=="root"||!1,te=F||!1;let ie=fP;P==="Root"||P==="root"?ie=r:P?ie=c:Fq(s)&&(ie=void 0);const we=i5(s,{shouldForwardProp:ie,label:zq(D,P),...J}),Ie=Ne=>{if(Ne.__emotion_real===Ne)return Ne;if(typeof Ne=="function")return function(be){return LR(be,Ne)};if(Bm(Ne)){const Xe=a5(Ne);return Xe.variants?function(_e){return LR(_e,Xe)}:Xe.style}return Ne},Re=(...Ne)=>{const Xe=[],be=Ne.map(Ie),_e=[];if(Xe.push(d),D&&$&&_e.push(function($e){var mt,Ft;const zt=(Ft=(mt=$e.theme.components)==null?void 0:mt[D])==null?void 0:Ft.styleOverrides;if(!zt)return null;const St={};for(const rn in zt)St[rn]=LR($e,zt[rn]);return $($e,St)}),D&&!X&&_e.push(function($e){var St,mt;const ze=$e.theme,zt=(mt=(St=ze==null?void 0:ze.components)==null?void 0:St[D])==null?void 0:mt.variants;return zt?l5($e,zt):null}),te||_e.push(dx),Array.isArray(be[0])){const Ee=be.shift(),$e=new Array(Xe.length).fill(""),ze=new Array(_e.length).fill("");let zt;zt=[...$e,...Ee,...ze],zt.raw=[...$e,...Ee.raw,...ze],Xe.unshift(zt)}const Te=[...Xe,...be,..._e],oe=we(...Te);return s.muiName&&(oe.muiName=s.muiName),oe.displayName=Lq(D,P,s),oe};return we.withConfig&&(Re.withConfig=we.withConfig),Re}}function Lq(t,e,n){return t?`${t}${Rr(e||"")}`:`Styled(${Mq(n)})`}function zq(t,e){let n;return t&&(n=`${t}-${u5(e||"Root")}`),n}function Bq(t){for(const e in t)return!1;return!0}function Fq(t){return typeof t=="string"&&t.charCodeAt(0)>96}function u5(t){return t&&t.charAt(0).toLowerCase()+t.slice(1)}const Vq=c5();function iA(t,e){const n={...e};for(const r in t)if(Object.prototype.hasOwnProperty.call(t,r)){const c=r;if(c==="components"||c==="slots")n[c]={...t[c],...n[c]};else if(c==="componentsProps"||c==="slotProps"){const d=t[c],m=e[c];if(!m)n[c]=d||{};else if(!d)n[c]=m;else{n[c]={...m};for(const s in d)if(Object.prototype.hasOwnProperty.call(d,s)){const T=s;n[c][T]=iA(d[T],m[T])}}}else n[c]===void 0&&(n[c]=t[c])}return n}function Uq(t){const{theme:e,name:n,props:r}=t;return!e||!e.components||!e.components[n]||!e.components[n].defaultProps?r:iA(e.components[n].defaultProps,r)}function jq({props:t,name:e,defaultTheme:n,themeId:r}){let c=jN(n);return r&&(c=c[r]||c),Uq({theme:c,name:e,props:t})}const px=typeof window<"u"?ke.useLayoutEffect:ke.useEffect;function Hq(t,e=Number.MIN_SAFE_INTEGER,n=Number.MAX_SAFE_INTEGER){return Math.max(e,Math.min(t,n))}function HN(t,e=0,n=1){return(t<e||t>n)&&console.error(`MUI: The value provided ${t} is out of range [${e}, ${n}].`),Hq(t,e,n)}function $q(t){t=t.slice(1);const e=new RegExp(`.{1,${t.length>=6?2:1}}`,"g");let n=t.match(e);return n&&n[0].length===1&&(n=n.map(r=>r+r)),t.length!==t.trim().length&&console.error(`MUI: The color: "${t}" is invalid. Make sure the color input doesn't contain leading/trailing space.`),n?`rgb${n.length===4?"a":""}(${n.map((r,c)=>c<3?parseInt(r,16):Math.round(parseInt(r,16)/255*1e3)/1e3).join(", ")})`:""}function Zv(t){if(t.type)return t;if(t.charAt(0)==="#")return Zv($q(t));const e=t.indexOf("("),n=t.substring(0,e);if(!["rgb","rgba","hsl","hsla","color"].includes(n))throw new Error(`MUI: Unsupported \`${t}\` color.
The following formats are supported: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().`);let r=t.substring(e+1,t.length-1),c;if(n==="color"){if(r=r.split(" "),c=r.shift(),r.length===4&&r[3].charAt(0)==="/"&&(r[3]=r[3].slice(1)),!["srgb","display-p3","a98-rgb","prophoto-rgb","rec-2020"].includes(c))throw new Error(`MUI: unsupported \`${c}\` color space.
The following color spaces are supported: srgb, display-p3, a98-rgb, prophoto-rgb, rec-2020.`)}else r=r.split(",");return r=r.map(d=>parseFloat(d)),{type:n,values:r,colorSpace:c}}const Gq=t=>{const e=Zv(t);return e.values.slice(0,3).map((n,r)=>e.type.includes("hsl")&&r!==0?`${n}%`:n).join(" ")},xS=(t,e)=>{try{return Gq(t)}catch{return e&&console.warn(e),t}};function RI(t){const{type:e,colorSpace:n}=t;let{values:r}=t;return e.includes("rgb")?r=r.map((c,d)=>d<3?parseInt(c,10):c):e.includes("hsl")&&(r[1]=`${r[1]}%`,r[2]=`${r[2]}%`),e.includes("color")?r=`${n} ${r.join(" ")}`:r=`${r.join(", ")}`,`${e}(${r})`}function h5(t){t=Zv(t);const{values:e}=t,n=e[0],r=e[1]/100,c=e[2]/100,d=r*Math.min(c,1-c),m=(D,P=(D+n/30)%12)=>c-d*Math.max(Math.min(P-3,9-P,1),-1);let s="rgb";const T=[Math.round(m(0)*255),Math.round(m(8)*255),Math.round(m(4)*255)];return t.type==="hsla"&&(s+="a",T.push(e[3])),RI({type:s,values:T})}function mk(t){t=Zv(t);let e=t.type==="hsl"||t.type==="hsla"?Zv(h5(t)).values:t.values;return e=e.map(n=>(t.type!=="color"&&(n/=255),n<=.03928?n/12.92:((n+.055)/1.055)**2.4)),Number((.2126*e[0]+.7152*e[1]+.0722*e[2]).toFixed(3))}function Yz(t,e){const n=mk(t),r=mk(e);return(Math.max(n,r)+.05)/(Math.min(n,r)+.05)}function Lc(t,e){return t=Zv(t),e=HN(e),(t.type==="rgb"||t.type==="hsl")&&(t.type+="a"),t.type==="color"?t.values[3]=`/${e}`:t.values[3]=e,RI(t)}function YD(t,e,n){try{return Lc(t,e)}catch{return t}}function $N(t,e){if(t=Zv(t),e=HN(e),t.type.includes("hsl"))t.values[2]*=1-e;else if(t.type.includes("rgb")||t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]*=1-e;return RI(t)}function Js(t,e,n){try{return $N(t,e)}catch{return t}}function GN(t,e){if(t=Zv(t),e=HN(e),t.type.includes("hsl"))t.values[2]+=(100-t.values[2])*e;else if(t.type.includes("rgb"))for(let n=0;n<3;n+=1)t.values[n]+=(255-t.values[n])*e;else if(t.type.includes("color"))for(let n=0;n<3;n+=1)t.values[n]+=(1-t.values[n])*e;return RI(t)}function eo(t,e,n){try{return GN(t,e)}catch{return t}}function qq(t,e=.15){return mk(t)>.5?$N(t,e):GN(t,e)}function ZD(t,e,n){try{return qq(t,e)}catch{return t}}const Wq="exact-prop: ​";function d5(t){return{...t,[Wq]:e=>{const n=Object.keys(e).filter(r=>!t.hasOwnProperty(r));return n.length>0?new Error(`The following props are not supported: ${n.map(r=>`\`${r}\``).join(", ")}. Please remove them.`):null}}}const Yq=ke.createContext();G.node,G.bool;const qN=()=>ke.useContext(Yq)??!1,Zq=ke.createContext(void 0);G.node,G.object;function Xq(t){const{theme:e,name:n,props:r}=t;if(!e||!e.components||!e.components[n])return r;const c=e.components[n];return c.defaultProps?iA(c.defaultProps,r):!c.styleOverrides&&!c.variants?iA(c,r):r}function Qq({props:t,name:e}){const n=ke.useContext(Zq);return Xq({props:t,name:e,theme:{components:n}})}const Zz={theme:void 0};function Kq(t){let e,n;return function(c){let d=e;return(d===void 0||c.theme!==n)&&(Zz.theme=c.theme,d=a5(t(Zz)),e=d,n=c.theme),d}}function Jq(t=""){function e(...r){if(!r.length)return"";const c=r[0];return typeof c=="string"&&!c.match(/(#|\(|\)|(-?(\d*\.)?\d+)(px|em|%|ex|ch|rem|vw|vh|vmin|vmax|cm|mm|in|pt|pc))|^(-?(\d*\.)?\d+)$|(\d+ \d+ \d+)/)?`, var(--${t?`${t}-`:""}${c}${e(...r.slice(1))})`:`, ${c}`}return(r,...c)=>`var(--${t?`${t}-`:""}${r}${e(...c)})`}const Xz=(t,e,n,r=[])=>{let c=t;e.forEach((d,m)=>{m===e.length-1?Array.isArray(c)?c[Number(d)]=n:c&&typeof c=="object"&&(c[d]=n):c&&typeof c=="object"&&(c[d]||(c[d]=r.includes(d)?[]:{}),c=c[d])})},e7=(t,e,n)=>{function r(c,d=[],m=[]){Object.entries(c).forEach(([s,T])=>{(!n||n&&!n([...d,s]))&&T!=null&&(typeof T=="object"&&Object.keys(T).length>0?r(T,[...d,s],Array.isArray(T)?[...m,s]:m):e([...d,s],T,m))})}r(t)},t7=(t,e)=>typeof e=="number"?["lineHeight","fontWeight","opacity","zIndex"].some(r=>t.includes(r))||t[t.length-1].toLowerCase().includes("opacity")?e:`${e}px`:e;function pP(t,e){const{prefix:n,shouldSkipGeneratingVar:r}=e||{},c={},d={},m={};return e7(t,(s,T,D)=>{if((typeof T=="string"||typeof T=="number")&&(!r||!r(s,T))){const P=`--${n?`${n}-`:""}${s.join("-")}`,z=t7(s,T);Object.assign(c,{[P]:z}),Xz(d,s,`var(${P})`,D),Xz(m,s,`var(${P}, ${z})`,D)}},s=>s[0]==="vars"),{css:c,vars:d,varsWithDefaults:m}}function n7(t,e={}){const{getSelector:n=te,disableCssColorScheme:r,colorSchemeSelector:c}=e,{colorSchemes:d={},components:m,defaultColorScheme:s="light",...T}=t,{vars:D,css:P,varsWithDefaults:z}=pP(T,e);let F=z;const $={},{[s]:J,...X}=d;if(Object.entries(X||{}).forEach(([Ie,Re])=>{const{vars:Ne,css:Xe,varsWithDefaults:be}=pP(Re,e);F=qh(F,be),$[Ie]={css:Xe,vars:Ne}}),J){const{css:Ie,vars:Re,varsWithDefaults:Ne}=pP(J,e);F=qh(F,Ne),$[s]={css:Ie,vars:Re}}function te(Ie,Re){var Xe,be;let Ne=c;if(c==="class"&&(Ne=".%s"),c==="data"&&(Ne="[data-%s]"),c!=null&&c.startsWith("data-")&&!c.includes("%s")&&(Ne=`[${c}="%s"]`),Ie){if(Ne==="media")return t.defaultColorScheme===Ie?":root":{[`@media (prefers-color-scheme: ${((be=(Xe=d[Ie])==null?void 0:Xe.palette)==null?void 0:be.mode)||Ie})`]:{":root":Re}};if(Ne)return t.defaultColorScheme===Ie?`:root, ${Ne.replace("%s",String(Ie))}`:Ne.replace("%s",String(Ie))}return":root"}return{vars:F,generateThemeVars:()=>{let Ie={...D};return Object.entries($).forEach(([,{vars:Re}])=>{Ie=qh(Ie,Re)}),Ie},generateStyleSheets:()=>{var _e,Te;const Ie=[],Re=t.defaultColorScheme||"light";function Ne(oe,Ee){Object.keys(Ee).length&&Ie.push(typeof oe=="string"?{[oe]:{...Ee}}:oe)}Ne(n(void 0,{...P}),P);const{[Re]:Xe,...be}=$;if(Xe){const{css:oe}=Xe,Ee=(Te=(_e=d[Re])==null?void 0:_e.palette)==null?void 0:Te.mode,$e=!r&&Ee?{colorScheme:Ee,...oe}:{...oe};Ne(n(Re,{...$e}),$e)}return Object.entries(be).forEach(([oe,{css:Ee}])=>{var zt,St;const $e=(St=(zt=d[oe])==null?void 0:zt.palette)==null?void 0:St.mode,ze=!r&&$e?{colorScheme:$e,...Ee}:{...Ee};Ne(n(oe,{...ze}),ze)}),Ie}}}function i7(t){return function(n){return t==="media"?(n!=="light"&&n!=="dark"&&console.error(`MUI: @media (prefers-color-scheme) supports only 'light' or 'dark', but receive '${n}'.`),`@media (prefers-color-scheme: ${n})`):t?t.startsWith("data-")&&!t.includes("%s")?`[${t}="${n}"] &`:t==="class"?`.${n} &`:t==="data"?`[data-${n}] &`:`${t.replace("%s",n)} &`:"&"}}const r7=DI(),s7=Vq("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${Rr(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),o7=t=>jq({props:t,name:"MuiContainer",defaultTheme:r7}),a7=(t,e)=>{const n=T=>wo(e,T),{classes:r,fixed:c,disableGutters:d,maxWidth:m}=t,s={root:["root",m&&`maxWidth${Rr(String(m))}`,c&&"fixed",d&&"disableGutters"]};return Fo(s,n,r)};function l7(t={}){const{createStyledComponent:e=s7,useThemeProps:n=o7,componentName:r="MuiContainer"}=t,c=e(({theme:m,ownerState:s})=>({width:"100%",marginLeft:"auto",boxSizing:"border-box",marginRight:"auto",...!s.disableGutters&&{paddingLeft:m.spacing(2),paddingRight:m.spacing(2),[m.breakpoints.up("sm")]:{paddingLeft:m.spacing(3),paddingRight:m.spacing(3)}}}),({theme:m,ownerState:s})=>s.fixed&&Object.keys(m.breakpoints.values).reduce((T,D)=>{const P=D,z=m.breakpoints.values[P];return z!==0&&(T[m.breakpoints.up(P)]={maxWidth:`${z}${m.breakpoints.unit}`}),T},{}),({theme:m,ownerState:s})=>({...s.maxWidth==="xs"&&{[m.breakpoints.up("xs")]:{maxWidth:Math.max(m.breakpoints.values.xs,444)}},...s.maxWidth&&s.maxWidth!=="xs"&&{[m.breakpoints.up(s.maxWidth)]:{maxWidth:`${m.breakpoints.values[s.maxWidth]}${m.breakpoints.unit}`}}})),d=ke.forwardRef(function(s,T){const D=n(s),{className:P,component:z="div",disableGutters:F=!1,fixed:$=!1,maxWidth:J="lg",classes:X,...te}=D,ie={...D,component:z,disableGutters:F,fixed:$,maxWidth:J},we=a7(ie,r);return Qn.jsx(c,{as:z,ownerState:ie,className:Dr(we.root,P),ref:T,...te})});return d.propTypes={children:G.node,classes:G.object,className:G.string,component:G.elementType,disableGutters:G.bool,fixed:G.bool,maxWidth:G.oneOfType([G.oneOf(["xs","sm","md","lg","xl",!1]),G.string]),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])},d}const rA={black:"#000",white:"#fff"},c7={50:"#fafafa",100:"#f5f5f5",200:"#eeeeee",300:"#e0e0e0",400:"#bdbdbd",500:"#9e9e9e",600:"#757575",700:"#616161",800:"#424242",900:"#212121",A100:"#f5f5f5",A200:"#eeeeee",A400:"#bdbdbd",A700:"#616161"},fw={50:"#f3e5f5",200:"#ce93d8",300:"#ba68c8",400:"#ab47bc",500:"#9c27b0",700:"#7b1fa2"},pw={300:"#e57373",400:"#ef5350",500:"#f44336",700:"#d32f2f",800:"#c62828"},aS={300:"#ffb74d",400:"#ffa726",500:"#ff9800",700:"#f57c00",900:"#e65100"},mw={50:"#e3f2fd",200:"#90caf9",400:"#42a5f5",700:"#1976d2",800:"#1565c0"},gw={300:"#4fc3f7",400:"#29b6f6",500:"#03a9f4",700:"#0288d1",900:"#01579b"},_w={300:"#81c784",400:"#66bb6a",500:"#4caf50",700:"#388e3c",800:"#2e7d32",900:"#1b5e20"};function f5(){return{text:{primary:"rgba(0, 0, 0, 0.87)",secondary:"rgba(0, 0, 0, 0.6)",disabled:"rgba(0, 0, 0, 0.38)"},divider:"rgba(0, 0, 0, 0.12)",background:{paper:rA.white,default:rA.white},action:{active:"rgba(0, 0, 0, 0.54)",hover:"rgba(0, 0, 0, 0.04)",hoverOpacity:.04,selected:"rgba(0, 0, 0, 0.08)",selectedOpacity:.08,disabled:"rgba(0, 0, 0, 0.26)",disabledBackground:"rgba(0, 0, 0, 0.12)",disabledOpacity:.38,focus:"rgba(0, 0, 0, 0.12)",focusOpacity:.12,activatedOpacity:.12}}}const u7=f5();function p5(){return{text:{primary:rA.white,secondary:"rgba(255, 255, 255, 0.7)",disabled:"rgba(255, 255, 255, 0.5)",icon:"rgba(255, 255, 255, 0.5)"},divider:"rgba(255, 255, 255, 0.12)",background:{paper:"#121212",default:"#121212"},action:{active:rA.white,hover:"rgba(255, 255, 255, 0.08)",hoverOpacity:.08,selected:"rgba(255, 255, 255, 0.16)",selectedOpacity:.16,disabled:"rgba(255, 255, 255, 0.3)",disabledBackground:"rgba(255, 255, 255, 0.12)",disabledOpacity:.38,focus:"rgba(255, 255, 255, 0.12)",focusOpacity:.12,activatedOpacity:.24}}}const Qz=p5();function Kz(t,e,n,r){const c=r.light||r,d=r.dark||r*1.5;t[e]||(t.hasOwnProperty(n)?t[e]=t[n]:e==="light"?t.light=GN(t.main,c):e==="dark"&&(t.dark=$N(t.main,d)))}function h7(t="light"){return t==="dark"?{main:mw[200],light:mw[50],dark:mw[400]}:{main:mw[700],light:mw[400],dark:mw[800]}}function d7(t="light"){return t==="dark"?{main:fw[200],light:fw[50],dark:fw[400]}:{main:fw[500],light:fw[300],dark:fw[700]}}function f7(t="light"){return t==="dark"?{main:pw[500],light:pw[300],dark:pw[700]}:{main:pw[700],light:pw[400],dark:pw[800]}}function p7(t="light"){return t==="dark"?{main:gw[400],light:gw[300],dark:gw[700]}:{main:gw[700],light:gw[500],dark:gw[900]}}function m7(t="light"){return t==="dark"?{main:_w[400],light:_w[300],dark:_w[700]}:{main:_w[800],light:_w[500],dark:_w[900]}}function g7(t="light"){return t==="dark"?{main:aS[400],light:aS[300],dark:aS[700]}:{main:"#ed6c02",light:aS[500],dark:aS[900]}}function WN(t){const{mode:e="light",contrastThreshold:n=3,tonalOffset:r=.2,...c}=t,d=t.primary||h7(e),m=t.secondary||d7(e),s=t.error||f7(e),T=t.info||p7(e),D=t.success||m7(e),P=t.warning||g7(e);function z(X){const te=Yz(X,Qz.text.primary)>=n?Qz.text.primary:u7.text.primary;{const ie=Yz(X,te);ie<3&&console.error([`MUI: The contrast ratio of ${ie}:1 for ${te} on ${X}`,"falls below the WCAG recommended absolute minimum contrast ratio of 3:1.","https://www.w3.org/TR/2008/REC-WCAG20-20081211/#visual-audio-contrast-contrast"].join(`
`))}return te}const F=({color:X,name:te,mainShade:ie=500,lightShade:we=300,darkShade:Ie=700})=>{if(X={...X},!X.main&&X[ie]&&(X.main=X[ie]),!X.hasOwnProperty("main"))throw new Error(`MUI: The color${te?` (${te})`:""} provided to augmentColor(color) is invalid.
The color object needs to have a \`main\` property or a \`${ie}\` property.`);if(typeof X.main!="string")throw new Error(`MUI: The color${te?` (${te})`:""} provided to augmentColor(color) is invalid.
\`color.main\` should be a string, but \`${JSON.stringify(X.main)}\` was provided instead.

Did you intend to use one of the following approaches?

import { green } from "@mui/material/colors";

const theme1 = createTheme({ palette: {
  primary: green,
} });

const theme2 = createTheme({ palette: {
  primary: { main: green[500] },
} });`);return Kz(X,"light",we,r),Kz(X,"dark",Ie,r),X.contrastText||(X.contrastText=z(X.main)),X};let $;return e==="light"?$=f5():e==="dark"&&($=p5()),$||console.error(`MUI: The palette mode \`${e}\` is not supported.`),qh({common:{...rA},mode:e,primary:F({color:d,name:"primary"}),secondary:F({color:m,name:"secondary",mainShade:"A400",lightShade:"A200",darkShade:"A700"}),error:F({color:s,name:"error"}),warning:F({color:P,name:"warning"}),info:F({color:T,name:"info"}),success:F({color:D,name:"success"}),grey:c7,contrastThreshold:n,getContrastText:z,augmentColor:F,tonalOffset:r,...$},c)}function _7(t){const e={};return Object.entries(t).forEach(r=>{const[c,d]=r;typeof d=="object"&&(e[c]=`${d.fontStyle?`${d.fontStyle} `:""}${d.fontVariant?`${d.fontVariant} `:""}${d.fontWeight?`${d.fontWeight} `:""}${d.fontStretch?`${d.fontStretch} `:""}${d.fontSize||""}${d.lineHeight?`/${d.lineHeight} `:""}${d.fontFamily||""}`)}),e}function y7(t,e){return{toolbar:{minHeight:56,[t.up("xs")]:{"@media (orientation: landscape)":{minHeight:48}},[t.up("sm")]:{minHeight:64}},...e}}function v7(t){return Math.round(t*1e5)/1e5}const Jz={textTransform:"uppercase"},eB='"Roboto", "Helvetica", "Arial", sans-serif';function b7(t,e){const{fontFamily:n=eB,fontSize:r=14,fontWeightLight:c=300,fontWeightRegular:d=400,fontWeightMedium:m=500,fontWeightBold:s=700,htmlFontSize:T=16,allVariants:D,pxToRem:P,...z}=typeof e=="function"?e(t):e;typeof r!="number"&&console.error("MUI: `fontSize` is required to be a number."),typeof T!="number"&&console.error("MUI: `htmlFontSize` is required to be a number.");const F=r/14,$=P||(te=>`${te/T*F}rem`),J=(te,ie,we,Ie,Re)=>({fontFamily:n,fontWeight:te,fontSize:$(ie),lineHeight:we,...n===eB?{letterSpacing:`${v7(Ie/ie)}em`}:{},...Re,...D}),X={h1:J(c,96,1.167,-1.5),h2:J(c,60,1.2,-.5),h3:J(d,48,1.167,0),h4:J(d,34,1.235,.25),h5:J(d,24,1.334,0),h6:J(m,20,1.6,.15),subtitle1:J(d,16,1.75,.15),subtitle2:J(m,14,1.57,.1),body1:J(d,16,1.5,.15),body2:J(d,14,1.43,.15),button:J(m,14,1.75,.4,Jz),caption:J(d,12,1.66,.4),overline:J(d,12,2.66,1,Jz),inherit:{fontFamily:"inherit",fontWeight:"inherit",fontSize:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}};return qh({htmlFontSize:T,pxToRem:$,fontFamily:n,fontSize:r,fontWeightLight:c,fontWeightRegular:d,fontWeightMedium:m,fontWeightBold:s,...X},z,{clone:!1})}const x7=.2,w7=.14,T7=.12;function Ro(...t){return[`${t[0]}px ${t[1]}px ${t[2]}px ${t[3]}px rgba(0,0,0,${x7})`,`${t[4]}px ${t[5]}px ${t[6]}px ${t[7]}px rgba(0,0,0,${w7})`,`${t[8]}px ${t[9]}px ${t[10]}px ${t[11]}px rgba(0,0,0,${T7})`].join(",")}const E7=["none",Ro(0,2,1,-1,0,1,1,0,0,1,3,0),Ro(0,3,1,-2,0,2,2,0,0,1,5,0),Ro(0,3,3,-2,0,3,4,0,0,1,8,0),Ro(0,2,4,-1,0,4,5,0,0,1,10,0),Ro(0,3,5,-1,0,5,8,0,0,1,14,0),Ro(0,3,5,-1,0,6,10,0,0,1,18,0),Ro(0,4,5,-2,0,7,10,1,0,2,16,1),Ro(0,5,5,-3,0,8,10,1,0,3,14,2),Ro(0,5,6,-3,0,9,12,1,0,3,16,2),Ro(0,6,6,-3,0,10,14,1,0,4,18,3),Ro(0,6,7,-4,0,11,15,1,0,4,20,3),Ro(0,7,8,-4,0,12,17,2,0,5,22,4),Ro(0,7,8,-4,0,13,19,2,0,5,24,4),Ro(0,7,9,-4,0,14,21,2,0,5,26,4),Ro(0,8,9,-5,0,15,22,2,0,6,28,5),Ro(0,8,10,-5,0,16,24,2,0,6,30,5),Ro(0,8,11,-5,0,17,26,2,0,6,32,5),Ro(0,9,11,-5,0,18,28,2,0,7,34,6),Ro(0,9,12,-6,0,19,29,2,0,7,36,6),Ro(0,10,13,-6,0,20,31,3,0,8,38,7),Ro(0,10,13,-6,0,21,33,3,0,8,40,7),Ro(0,10,14,-6,0,22,35,3,0,8,42,7),Ro(0,11,14,-7,0,23,36,3,0,9,44,8),Ro(0,11,15,-7,0,24,38,3,0,9,46,8)],S7={easeInOut:"cubic-bezier(0.4, 0, 0.2, 1)",easeOut:"cubic-bezier(0.0, 0, 0.2, 1)",easeIn:"cubic-bezier(0.4, 0, 1, 1)",sharp:"cubic-bezier(0.4, 0, 0.6, 1)"},m5={shortest:150,shorter:200,short:250,standard:300,complex:375,enteringScreen:225,leavingScreen:195};function tB(t){return`${Math.round(t)}ms`}function A7(t){if(!t)return 0;const e=t/36;return Math.min(Math.round((4+15*e**.25+e/5)*10),3e3)}function C7(t){const e={...S7,...t.easing},n={...m5,...t.duration};return{getAutoHeightDuration:A7,create:(c=["all"],d={})=>{const{duration:m=n.standard,easing:s=e.easeInOut,delay:T=0,...D}=d;{const P=F=>typeof F=="string",z=F=>!Number.isNaN(parseFloat(F));!P(c)&&!Array.isArray(c)&&console.error('MUI: Argument "props" must be a string or Array.'),!z(m)&&!P(m)&&console.error(`MUI: Argument "duration" must be a number or a string but found ${m}.`),P(s)||console.error('MUI: Argument "easing" must be a string.'),!z(T)&&!P(T)&&console.error('MUI: Argument "delay" must be a number or a string.'),typeof d!="object"&&console.error(["MUI: Secong argument of transition.create must be an object.","Arguments should be either `create('prop1', options)` or `create(['prop1', 'prop2'], options)`"].join(`
`)),Object.keys(D).length!==0&&console.error(`MUI: Unrecognized argument(s) [${Object.keys(D).join(",")}].`)}return(Array.isArray(c)?c:[c]).map(P=>`${P} ${typeof m=="string"?m:tB(m)} ${s} ${typeof T=="string"?T:tB(T)}`).join(",")},...t,easing:e,duration:n}}const D7={mobileStepper:1e3,fab:1050,speedDial:1050,appBar:1100,drawer:1200,modal:1300,snackbar:1400,tooltip:1500};function R7(t){return Bm(t)||typeof t>"u"||typeof t=="string"||typeof t=="boolean"||typeof t=="number"||Array.isArray(t)}function g5(t={}){const e={...t};function n(r){const c=Object.entries(r);for(let d=0;d<c.length;d++){const[m,s]=c[d];!R7(s)||m.startsWith("unstable_")?delete r[m]:Bm(s)&&(r[m]={...s},n(r[m]))}}return n(e),`import { unstable_createBreakpoints as createBreakpoints, createTransitions } from '@mui/material/styles';

const theme = ${JSON.stringify(e,null,2)};

theme.breakpoints = createBreakpoints(theme.breakpoints || {});
theme.transitions = createTransitions(theme.transitions || {});

export default theme;`}function gk(t={},...e){const{breakpoints:n,mixins:r={},spacing:c,palette:d={},transitions:m={},typography:s={},shape:T,...D}=t;if(t.vars&&t.generateThemeVars===void 0)throw new Error("MUI: `vars` is a private field used for CSS variables support.\nPlease use another name or follow the [docs](https://mui.com/material-ui/customization/css-theme-variables/usage/) to enable the feature.");const P=WN(d),z=DI(t);let F=qh(z,{mixins:y7(z.breakpoints,r),palette:P,shadows:E7.slice(),typography:b7(P,s),transitions:C7(m),zIndex:{...D7}});F=qh(F,D),F=e.reduce(($,J)=>qh($,J),F);{const $=["active","checked","completed","disabled","error","expanded","focused","focusVisible","required","selected"],J=(X,te)=>{let ie;for(ie in X){const we=X[ie];if($.includes(ie)&&Object.keys(we).length>0){{const Ie=wo("",ie);console.error([`MUI: The \`${te}\` component increases the CSS specificity of the \`${ie}\` internal state.`,"You can not override it like this: ",JSON.stringify(X,null,2),"",`Instead, you need to use the '&.${Ie}' syntax:`,JSON.stringify({root:{[`&.${Ie}`]:we}},null,2),"","https://mui.com/r/state-classes-guide"].join(`
`))}X[ie]={}}}};Object.keys(F.components).forEach(X=>{const te=F.components[X].styleOverrides;te&&X.startsWith("Mui")&&J(te,X)})}return F.unstable_sxConfig={...OA,...D==null?void 0:D.unstable_sxConfig},F.unstable_sx=function(J){return dx({sx:J,theme:this})},F.toRuntimeSource=g5,F}function _k(t){let e;return t<1?e=5.11916*t**2:e=4.5*Math.log(t+1)+2,Math.round(e*10)/1e3}const O7=[...Array(25)].map((t,e)=>{if(e===0)return"none";const n=_k(e);return`linear-gradient(rgba(255 255 255 / ${n}), rgba(255 255 255 / ${n}))`});function _5(t){return{inputPlaceholder:t==="dark"?.5:.42,inputUnderline:t==="dark"?.7:.42,switchTrackDisabled:t==="dark"?.2:.12,switchTrack:t==="dark"?.3:.38}}function y5(t){return t==="dark"?O7:[]}function I7(t){const{palette:e={mode:"light"},opacity:n,overlays:r,...c}=t,d=WN(e);return{palette:d,opacity:{..._5(d.mode),...n},overlays:r||y5(d.mode),...c}}function M7(t){var e;return!!t[0].match(/(cssVarPrefix|colorSchemeSelector|rootSelector|typography|mixins|breakpoints|direction|transitions)/)||!!t[0].match(/sxConfig$/)||t[0]==="palette"&&!!((e=t[1])!=null&&e.match(/(mode|contrastThreshold|tonalOffset)/))}const P7=t=>[...[...Array(25)].map((e,n)=>`--${t?`${t}-`:""}overlays-${n}`),`--${t?`${t}-`:""}palette-AppBar-darkBg`,`--${t?`${t}-`:""}palette-AppBar-darkColor`],k7=t=>(e,n)=>{const r=t.rootSelector||":root",c=t.colorSchemeSelector;let d=c;if(c==="class"&&(d=".%s"),c==="data"&&(d="[data-%s]"),c!=null&&c.startsWith("data-")&&!c.includes("%s")&&(d=`[${c}="%s"]`),t.defaultColorScheme===e){if(e==="dark"){const m={};return P7(t.cssVarPrefix).forEach(s=>{m[s]=n[s],delete n[s]}),d==="media"?{[r]:n,"@media (prefers-color-scheme: dark)":{[r]:m}}:d?{[d.replace("%s",e)]:m,[`${r}, ${d.replace("%s",e)}`]:n}:{[r]:{...n,...m}}}if(d&&d!=="media")return`${r}, ${d.replace("%s",String(e))}`}else if(e){if(d==="media")return{[`@media (prefers-color-scheme: ${String(e)})`]:{[r]:n}};if(d)return d.replace("%s",String(e))}return r};function N7(t,e){e.forEach(n=>{t[n]||(t[n]={})})}function gn(t,e,n){!t[e]&&n&&(t[e]=n)}function wS(t){return typeof t!="string"||!t.startsWith("hsl")?t:h5(t)}function c_(t,e){`${e}Channel`in t||(t[`${e}Channel`]=xS(wS(t[e]),`MUI: Can't create \`palette.${e}Channel\` because \`palette.${e}\` is not one of these formats: #nnn, #nnnnnn, rgb(), rgba(), hsl(), hsla(), color().
To suppress this warning, you need to explicitly provide the \`palette.${e}Channel\` as a string (in rgb format, for example "12 12 12") or undefined if you want to remove the channel token.`))}function L7(t){return typeof t=="number"?`${t}px`:typeof t=="string"||typeof t=="function"||Array.isArray(t)?t:"8px"}const Am=t=>{try{return t()}catch{}},z7=(t="mui")=>Jq(t);function mP(t,e,n,r){if(!e)return;e=e===!0?{}:e;const c=r==="dark"?"dark":"light";if(!n){t[r]=I7({...e,palette:{mode:c,...e==null?void 0:e.palette}});return}const{palette:d,...m}=gk({...n,palette:{mode:c,...e==null?void 0:e.palette}});return t[r]={...e,palette:d,opacity:{..._5(c),...e==null?void 0:e.opacity},overlays:(e==null?void 0:e.overlays)||y5(c)},m}function B7(t={},...e){const{colorSchemes:n={light:!0},defaultColorScheme:r,disableCssColorScheme:c=!1,cssVarPrefix:d="mui",shouldSkipGeneratingVar:m=M7,colorSchemeSelector:s=n.light&&n.dark?"media":void 0,rootSelector:T=":root",...D}=t,P=Object.keys(n)[0],z=r||(n.light&&P!=="light"?"light":P),F=z7(d),{[z]:$,light:J,dark:X,...te}=n,ie={...te};let we=$;if((z==="dark"&&!("dark"in n)||z==="light"&&!("light"in n))&&(we=!0),!we)throw new Error(`MUI: The \`colorSchemes.${z}\` option is either missing or invalid.`);const Ie=mP(ie,we,D,z);J&&!ie.light&&mP(ie,J,void 0,"light"),X&&!ie.dark&&mP(ie,X,void 0,"dark");let Re={defaultColorScheme:z,...Ie,cssVarPrefix:d,colorSchemeSelector:s,rootSelector:T,getCssVar:F,colorSchemes:ie,font:{..._7(Ie.typography),...Ie.font},spacing:L7(D.spacing)};Object.keys(Re.colorSchemes).forEach(Te=>{const oe=Re.colorSchemes[Te].palette,Ee=$e=>{const ze=$e.split("-"),zt=ze[1],St=ze[2];return F($e,oe[zt][St])};if(oe.mode==="light"&&(gn(oe.common,"background","#fff"),gn(oe.common,"onBackground","#000")),oe.mode==="dark"&&(gn(oe.common,"background","#000"),gn(oe.common,"onBackground","#fff")),N7(oe,["Alert","AppBar","Avatar","Button","Chip","FilledInput","LinearProgress","Skeleton","Slider","SnackbarContent","SpeedDialAction","StepConnector","StepContent","Switch","TableCell","Tooltip"]),oe.mode==="light"){gn(oe.Alert,"errorColor",Js(oe.error.light,.6)),gn(oe.Alert,"infoColor",Js(oe.info.light,.6)),gn(oe.Alert,"successColor",Js(oe.success.light,.6)),gn(oe.Alert,"warningColor",Js(oe.warning.light,.6)),gn(oe.Alert,"errorFilledBg",Ee("palette-error-main")),gn(oe.Alert,"infoFilledBg",Ee("palette-info-main")),gn(oe.Alert,"successFilledBg",Ee("palette-success-main")),gn(oe.Alert,"warningFilledBg",Ee("palette-warning-main")),gn(oe.Alert,"errorFilledColor",Am(()=>oe.getContrastText(oe.error.main))),gn(oe.Alert,"infoFilledColor",Am(()=>oe.getContrastText(oe.info.main))),gn(oe.Alert,"successFilledColor",Am(()=>oe.getContrastText(oe.success.main))),gn(oe.Alert,"warningFilledColor",Am(()=>oe.getContrastText(oe.warning.main))),gn(oe.Alert,"errorStandardBg",eo(oe.error.light,.9)),gn(oe.Alert,"infoStandardBg",eo(oe.info.light,.9)),gn(oe.Alert,"successStandardBg",eo(oe.success.light,.9)),gn(oe.Alert,"warningStandardBg",eo(oe.warning.light,.9)),gn(oe.Alert,"errorIconColor",Ee("palette-error-main")),gn(oe.Alert,"infoIconColor",Ee("palette-info-main")),gn(oe.Alert,"successIconColor",Ee("palette-success-main")),gn(oe.Alert,"warningIconColor",Ee("palette-warning-main")),gn(oe.AppBar,"defaultBg",Ee("palette-grey-100")),gn(oe.Avatar,"defaultBg",Ee("palette-grey-400")),gn(oe.Button,"inheritContainedBg",Ee("palette-grey-300")),gn(oe.Button,"inheritContainedHoverBg",Ee("palette-grey-A100")),gn(oe.Chip,"defaultBorder",Ee("palette-grey-400")),gn(oe.Chip,"defaultAvatarColor",Ee("palette-grey-700")),gn(oe.Chip,"defaultIconColor",Ee("palette-grey-700")),gn(oe.FilledInput,"bg","rgba(0, 0, 0, 0.06)"),gn(oe.FilledInput,"hoverBg","rgba(0, 0, 0, 0.09)"),gn(oe.FilledInput,"disabledBg","rgba(0, 0, 0, 0.12)"),gn(oe.LinearProgress,"primaryBg",eo(oe.primary.main,.62)),gn(oe.LinearProgress,"secondaryBg",eo(oe.secondary.main,.62)),gn(oe.LinearProgress,"errorBg",eo(oe.error.main,.62)),gn(oe.LinearProgress,"infoBg",eo(oe.info.main,.62)),gn(oe.LinearProgress,"successBg",eo(oe.success.main,.62)),gn(oe.LinearProgress,"warningBg",eo(oe.warning.main,.62)),gn(oe.Skeleton,"bg",`rgba(${Ee("palette-text-primaryChannel")} / 0.11)`),gn(oe.Slider,"primaryTrack",eo(oe.primary.main,.62)),gn(oe.Slider,"secondaryTrack",eo(oe.secondary.main,.62)),gn(oe.Slider,"errorTrack",eo(oe.error.main,.62)),gn(oe.Slider,"infoTrack",eo(oe.info.main,.62)),gn(oe.Slider,"successTrack",eo(oe.success.main,.62)),gn(oe.Slider,"warningTrack",eo(oe.warning.main,.62));const $e=ZD(oe.background.default,.8);gn(oe.SnackbarContent,"bg",$e),gn(oe.SnackbarContent,"color",Am(()=>oe.getContrastText($e))),gn(oe.SpeedDialAction,"fabHoverBg",ZD(oe.background.paper,.15)),gn(oe.StepConnector,"border",Ee("palette-grey-400")),gn(oe.StepContent,"border",Ee("palette-grey-400")),gn(oe.Switch,"defaultColor",Ee("palette-common-white")),gn(oe.Switch,"defaultDisabledColor",Ee("palette-grey-100")),gn(oe.Switch,"primaryDisabledColor",eo(oe.primary.main,.62)),gn(oe.Switch,"secondaryDisabledColor",eo(oe.secondary.main,.62)),gn(oe.Switch,"errorDisabledColor",eo(oe.error.main,.62)),gn(oe.Switch,"infoDisabledColor",eo(oe.info.main,.62)),gn(oe.Switch,"successDisabledColor",eo(oe.success.main,.62)),gn(oe.Switch,"warningDisabledColor",eo(oe.warning.main,.62)),gn(oe.TableCell,"border",eo(YD(oe.divider,1),.88)),gn(oe.Tooltip,"bg",YD(oe.grey[700],.92))}if(oe.mode==="dark"){gn(oe.Alert,"errorColor",eo(oe.error.light,.6)),gn(oe.Alert,"infoColor",eo(oe.info.light,.6)),gn(oe.Alert,"successColor",eo(oe.success.light,.6)),gn(oe.Alert,"warningColor",eo(oe.warning.light,.6)),gn(oe.Alert,"errorFilledBg",Ee("palette-error-dark")),gn(oe.Alert,"infoFilledBg",Ee("palette-info-dark")),gn(oe.Alert,"successFilledBg",Ee("palette-success-dark")),gn(oe.Alert,"warningFilledBg",Ee("palette-warning-dark")),gn(oe.Alert,"errorFilledColor",Am(()=>oe.getContrastText(oe.error.dark))),gn(oe.Alert,"infoFilledColor",Am(()=>oe.getContrastText(oe.info.dark))),gn(oe.Alert,"successFilledColor",Am(()=>oe.getContrastText(oe.success.dark))),gn(oe.Alert,"warningFilledColor",Am(()=>oe.getContrastText(oe.warning.dark))),gn(oe.Alert,"errorStandardBg",Js(oe.error.light,.9)),gn(oe.Alert,"infoStandardBg",Js(oe.info.light,.9)),gn(oe.Alert,"successStandardBg",Js(oe.success.light,.9)),gn(oe.Alert,"warningStandardBg",Js(oe.warning.light,.9)),gn(oe.Alert,"errorIconColor",Ee("palette-error-main")),gn(oe.Alert,"infoIconColor",Ee("palette-info-main")),gn(oe.Alert,"successIconColor",Ee("palette-success-main")),gn(oe.Alert,"warningIconColor",Ee("palette-warning-main")),gn(oe.AppBar,"defaultBg",Ee("palette-grey-900")),gn(oe.AppBar,"darkBg",Ee("palette-background-paper")),gn(oe.AppBar,"darkColor",Ee("palette-text-primary")),gn(oe.Avatar,"defaultBg",Ee("palette-grey-600")),gn(oe.Button,"inheritContainedBg",Ee("palette-grey-800")),gn(oe.Button,"inheritContainedHoverBg",Ee("palette-grey-700")),gn(oe.Chip,"defaultBorder",Ee("palette-grey-700")),gn(oe.Chip,"defaultAvatarColor",Ee("palette-grey-300")),gn(oe.Chip,"defaultIconColor",Ee("palette-grey-300")),gn(oe.FilledInput,"bg","rgba(255, 255, 255, 0.09)"),gn(oe.FilledInput,"hoverBg","rgba(255, 255, 255, 0.13)"),gn(oe.FilledInput,"disabledBg","rgba(255, 255, 255, 0.12)"),gn(oe.LinearProgress,"primaryBg",Js(oe.primary.main,.5)),gn(oe.LinearProgress,"secondaryBg",Js(oe.secondary.main,.5)),gn(oe.LinearProgress,"errorBg",Js(oe.error.main,.5)),gn(oe.LinearProgress,"infoBg",Js(oe.info.main,.5)),gn(oe.LinearProgress,"successBg",Js(oe.success.main,.5)),gn(oe.LinearProgress,"warningBg",Js(oe.warning.main,.5)),gn(oe.Skeleton,"bg",`rgba(${Ee("palette-text-primaryChannel")} / 0.13)`),gn(oe.Slider,"primaryTrack",Js(oe.primary.main,.5)),gn(oe.Slider,"secondaryTrack",Js(oe.secondary.main,.5)),gn(oe.Slider,"errorTrack",Js(oe.error.main,.5)),gn(oe.Slider,"infoTrack",Js(oe.info.main,.5)),gn(oe.Slider,"successTrack",Js(oe.success.main,.5)),gn(oe.Slider,"warningTrack",Js(oe.warning.main,.5));const $e=ZD(oe.background.default,.98);gn(oe.SnackbarContent,"bg",$e),gn(oe.SnackbarContent,"color",Am(()=>oe.getContrastText($e))),gn(oe.SpeedDialAction,"fabHoverBg",ZD(oe.background.paper,.15)),gn(oe.StepConnector,"border",Ee("palette-grey-600")),gn(oe.StepContent,"border",Ee("palette-grey-600")),gn(oe.Switch,"defaultColor",Ee("palette-grey-300")),gn(oe.Switch,"defaultDisabledColor",Ee("palette-grey-600")),gn(oe.Switch,"primaryDisabledColor",Js(oe.primary.main,.55)),gn(oe.Switch,"secondaryDisabledColor",Js(oe.secondary.main,.55)),gn(oe.Switch,"errorDisabledColor",Js(oe.error.main,.55)),gn(oe.Switch,"infoDisabledColor",Js(oe.info.main,.55)),gn(oe.Switch,"successDisabledColor",Js(oe.success.main,.55)),gn(oe.Switch,"warningDisabledColor",Js(oe.warning.main,.55)),gn(oe.TableCell,"border",Js(YD(oe.divider,1),.68)),gn(oe.Tooltip,"bg",YD(oe.grey[700],.92))}c_(oe.background,"default"),c_(oe.background,"paper"),c_(oe.common,"background"),c_(oe.common,"onBackground"),c_(oe,"divider"),Object.keys(oe).forEach($e=>{const ze=oe[$e];$e!=="tonalOffset"&&ze&&typeof ze=="object"&&(ze.main&&gn(oe[$e],"mainChannel",xS(wS(ze.main))),ze.light&&gn(oe[$e],"lightChannel",xS(wS(ze.light))),ze.dark&&gn(oe[$e],"darkChannel",xS(wS(ze.dark))),ze.contrastText&&gn(oe[$e],"contrastTextChannel",xS(wS(ze.contrastText))),$e==="text"&&(c_(oe[$e],"primary"),c_(oe[$e],"secondary")),$e==="action"&&(ze.active&&c_(oe[$e],"active"),ze.selected&&c_(oe[$e],"selected")))})}),Re=e.reduce((Te,oe)=>qh(Te,oe),Re);const Ne={prefix:d,disableCssColorScheme:c,shouldSkipGeneratingVar:m,getSelector:k7(Re)},{vars:Xe,generateThemeVars:be,generateStyleSheets:_e}=n7(Re,Ne);return Re.vars=Xe,Object.entries(Re.colorSchemes[Re.defaultColorScheme]).forEach(([Te,oe])=>{Re[Te]=oe}),Re.generateThemeVars=be,Re.generateStyleSheets=_e,Re.generateSpacing=function(){return r5(D.spacing,ON(this))},Re.getColorSchemeSelector=i7(s),Re.spacing=Re.generateSpacing(),Re.shouldSkipGeneratingVar=m,Re.unstable_sxConfig={...OA,...D==null?void 0:D.unstable_sxConfig},Re.unstable_sx=function(oe){return dx({sx:oe,theme:this})},Re.toRuntimeSource=g5,Re}function nB(t,e,n){t.colorSchemes&&n&&(t.colorSchemes[e]={...n!==!0&&n,palette:WN({...n===!0?{}:n.palette,mode:e})})}function v5(t={},...e){const{palette:n,cssVariables:r=!1,colorSchemes:c=n?void 0:{light:!0},defaultColorScheme:d=n==null?void 0:n.mode,...m}=t,s=d||"light",T=c==null?void 0:c[s],D={...c,...n?{[s]:{...typeof T!="boolean"&&T,palette:n}}:void 0};if(r===!1){if(!("colorSchemes"in t))return gk(t,...e);let P=n;"palette"in t||D[s]&&(D[s]!==!0?P=D[s].palette:s==="dark"&&(P={mode:"dark"}));const z=gk({...t,palette:P},...e);return z.defaultColorScheme=s,z.colorSchemes=D,z.palette.mode==="light"&&(z.colorSchemes.light={...D.light!==!0&&D.light,palette:z.palette},nB(z,"dark",D.dark)),z.palette.mode==="dark"&&(z.colorSchemes.dark={...D.dark!==!0&&D.dark,palette:z.palette},nB(z,"light",D.light)),z}return!n&&!("light"in D)&&s==="light"&&(D.light=!0),B7({...m,colorSchemes:D,defaultColorScheme:s,...typeof r!="boolean"&&r},...e)}const b5=v5(),YN="$$material";function PA(){const t=jN(b5);return ke.useDebugValue(t),t[YN]||t}function F7(t){return t!=="ownerState"&&t!=="theme"&&t!=="sx"&&t!=="as"}const OI=t=>F7(t)&&t!=="classes",lr=c5({themeId:YN,defaultTheme:b5,rootShouldForwardProp:OI});function V7(){return $U}const zo=Kq;G.node,G.object.isRequired;function Mo(t){return Qq(t)}function U7(t){return typeof t.main=="string"}function j7(t,e=[]){if(!U7(t))return!1;for(const n of e)if(!t.hasOwnProperty(n)||typeof t[n]!="string")return!1;return!0}function $w(t=[]){return([,e])=>e&&j7(e,t)}function H7(t){const e=typeof t;switch(e){case"number":return Number.isNaN(t)?"NaN":Number.isFinite(t)?t!==Math.floor(t)?"float":"number":"Infinity";case"object":return t===null?"null":t.constructor.name;default:return e}}function x5(t,e,n,r){const c=t[e];if(c==null||!Number.isInteger(c)){const d=H7(c);return new RangeError(`Invalid ${r} \`${e}\` of type \`${d}\` supplied to \`${n}\`, expected \`integer\`.`)}return null}function w5(t,e,n,r){return t[e]===void 0?null:x5(t,e,n,r)}function iB(){return null}w5.isRequired=x5;iB.isRequired=iB;const T5=w5;function P_(t,e){return function(...r){return t(...r)||e(...r)}}function $7(t){return wo("MuiPaper",t)}io("MuiPaper",["root","rounded","outlined","elevation","elevation0","elevation1","elevation2","elevation3","elevation4","elevation5","elevation6","elevation7","elevation8","elevation9","elevation10","elevation11","elevation12","elevation13","elevation14","elevation15","elevation16","elevation17","elevation18","elevation19","elevation20","elevation21","elevation22","elevation23","elevation24"]);const G7=t=>{const{square:e,elevation:n,variant:r,classes:c}=t,d={root:["root",r,!e&&"rounded",r==="elevation"&&`elevation${n}`]};return Fo(d,$7,c)},q7=lr("div",{name:"MuiPaper",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],!n.square&&e.rounded,n.variant==="elevation"&&e[`elevation${n.elevation}`]]}})(zo(({theme:t})=>({backgroundColor:(t.vars||t).palette.background.paper,color:(t.vars||t).palette.text.primary,transition:t.transitions.create("box-shadow"),variants:[{props:({ownerState:e})=>!e.square,style:{borderRadius:t.shape.borderRadius}},{props:{variant:"outlined"},style:{border:`1px solid ${(t.vars||t).palette.divider}`}},{props:{variant:"elevation"},style:{boxShadow:"var(--Paper-shadow)",backgroundImage:"var(--Paper-overlay)"}}]}))),II=ke.forwardRef(function(e,n){var $;const r=Mo({props:e,name:"MuiPaper"}),c=PA(),{className:d,component:m="div",elevation:s=1,square:T=!1,variant:D="elevation",...P}=r,z={...r,component:m,elevation:s,square:T,variant:D},F=G7(z);return c.shadows[s]===void 0&&console.error([`MUI: The elevation provided <Paper elevation={${s}}> is not available in the theme.`,`Please make sure that \`theme.shadows[${s}]\` is defined.`].join(`
`)),Qn.jsx(q7,{as:m,ownerState:z,className:Dr(F.root,d),ref:n,...P,style:{...D==="elevation"&&{"--Paper-shadow":(c.vars||c).shadows[s],...c.vars&&{"--Paper-overlay":($=c.vars.overlays)==null?void 0:$[s]},...!c.vars&&c.palette.mode==="dark"&&{"--Paper-overlay":`linear-gradient(${Lc("#fff",_k(s))}, ${Lc("#fff",_k(s))})`}},...P.style}})});II.propTypes={children:G.node,classes:G.object,className:G.string,component:G.elementType,elevation:P_(T5,t=>{const{elevation:e,variant:n}=t;return e>0&&n==="outlined"?new Error(`MUI: Combining \`elevation={${e}}\` with \`variant="${n}"\` has no effect. Either use \`elevation={0}\` or use a different \`variant\`.`):null}),square:G.bool,style:G.object,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),variant:G.oneOfType([G.oneOf(["elevation","outlined"]),G.string])};function W7(t){return wo("MuiAppBar",t)}io("MuiAppBar",["root","positionFixed","positionAbsolute","positionSticky","positionStatic","positionRelative","colorDefault","colorPrimary","colorSecondary","colorInherit","colorTransparent","colorError","colorInfo","colorSuccess","colorWarning"]);const Y7=t=>{const{color:e,position:n,classes:r}=t,c={root:["root",`color${Rr(e)}`,`position${Rr(n)}`]};return Fo(c,W7,r)},rB=(t,e)=>t?`${t==null?void 0:t.replace(")","")}, ${e})`:e,Z7=lr(II,{name:"MuiAppBar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`position${Rr(n.position)}`],e[`color${Rr(n.color)}`]]}})(zo(({theme:t})=>({display:"flex",flexDirection:"column",width:"100%",boxSizing:"border-box",flexShrink:0,variants:[{props:{position:"fixed"},style:{position:"fixed",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0,"@media print":{position:"absolute"}}},{props:{position:"absolute"},style:{position:"absolute",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"sticky"},style:{position:"sticky",zIndex:(t.vars||t).zIndex.appBar,top:0,left:"auto",right:0}},{props:{position:"static"},style:{position:"static"}},{props:{position:"relative"},style:{position:"relative"}},{props:{color:"inherit"},style:{"--AppBar-color":"inherit"}},{props:{color:"default"},style:{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[100],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[100]),...t.applyStyles("dark",{"--AppBar-background":t.vars?t.vars.palette.AppBar.defaultBg:t.palette.grey[900],"--AppBar-color":t.vars?t.vars.palette.text.primary:t.palette.getContrastText(t.palette.grey[900])})}},...Object.entries(t.palette).filter($w(["contrastText"])).map(([e])=>({props:{color:e},style:{"--AppBar-background":(t.vars??t).palette[e].main,"--AppBar-color":(t.vars??t).palette[e].contrastText}})),{props:e=>e.enableColorOnDark===!0&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)"}},{props:e=>e.enableColorOnDark===!1&&!["inherit","transparent"].includes(e.color),style:{backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundColor:t.vars?rB(t.vars.palette.AppBar.darkBg,"var(--AppBar-background)"):null,color:t.vars?rB(t.vars.palette.AppBar.darkColor,"var(--AppBar-color)"):null})}},{props:{color:"transparent"},style:{"--AppBar-background":"transparent","--AppBar-color":"inherit",backgroundColor:"var(--AppBar-background)",color:"var(--AppBar-color)",...t.applyStyles("dark",{backgroundImage:"none"})}}]}))),E5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiAppBar"}),{className:c,color:d="primary",enableColorOnDark:m=!1,position:s="fixed",...T}=r,D={...r,color:d,position:s,enableColorOnDark:m},P=Y7(D);return Qn.jsx(Z7,{square:!0,component:"header",ownerState:D,elevation:4,className:Dr(P.root,c,s==="fixed"&&"mui-fixed"),ref:n,...T})});E5.propTypes={children:G.node,classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["default","inherit","primary","secondary","transparent","error","info","success","warning"]),G.string]),enableColorOnDark:G.bool,position:G.oneOf(["absolute","fixed","relative","static","sticky"]),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};const X7=io("MuiBox",["root"]),Q7=v5(),zR=Oq({themeId:YN,defaultTheme:Q7,defaultClassName:X7.root,generateClassName:s5.generate});zR.propTypes={children:G.node,component:G.elementType,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};function K7(t){return wo("MuiToolbar",t)}io("MuiToolbar",["root","gutters","regular","dense"]);const J7=t=>{const{classes:e,disableGutters:n,variant:r}=t;return Fo({root:["root",!n&&"gutters",r]},K7,e)},eW=lr("div",{name:"MuiToolbar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disableGutters&&e.gutters,e[n.variant]]}})(zo(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:t.spacing(2),paddingRight:t.spacing(2),[t.breakpoints.up("sm")]:{paddingLeft:t.spacing(3),paddingRight:t.spacing(3)}}},{props:{variant:"dense"},style:{minHeight:48}},{props:{variant:"regular"},style:t.mixins.toolbar}]}))),S5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiToolbar"}),{className:c,component:d="div",disableGutters:m=!1,variant:s="regular",...T}=r,D={...r,component:d,disableGutters:m,variant:s},P=J7(D);return Qn.jsx(eW,{as:d,className:Dr(P.root,c),ref:n,ownerState:D,...T})});S5.propTypes={children:G.node,classes:G.object,className:G.string,component:G.elementType,disableGutters:G.bool,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),variant:G.oneOfType([G.oneOf(["dense","regular"]),G.string])};function sB(...t){return t.reduce((e,n)=>n==null?e:function(...c){e.apply(this,c),n.apply(this,c)},()=>{})}function tW(t){return wo("MuiSvgIcon",t)}io("MuiSvgIcon",["root","colorPrimary","colorSecondary","colorAction","colorError","colorDisabled","fontSizeInherit","fontSizeSmall","fontSizeMedium","fontSizeLarge"]);const nW=t=>{const{color:e,fontSize:n,classes:r}=t,c={root:["root",e!=="inherit"&&`color${Rr(e)}`,`fontSize${Rr(n)}`]};return Fo(c,tW,r)},iW=lr("svg",{name:"MuiSvgIcon",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.color!=="inherit"&&e[`color${Rr(n.color)}`],e[`fontSize${Rr(n.fontSize)}`]]}})(zo(({theme:t})=>{var e,n,r,c,d,m,s,T,D,P,z,F,$,J;return{userSelect:"none",width:"1em",height:"1em",display:"inline-block",flexShrink:0,transition:(c=(e=t.transitions)==null?void 0:e.create)==null?void 0:c.call(e,"fill",{duration:(r=(n=(t.vars??t).transitions)==null?void 0:n.duration)==null?void 0:r.shorter}),variants:[{props:X=>!X.hasSvgAsChild,style:{fill:"currentColor"}},{props:{fontSize:"inherit"},style:{fontSize:"inherit"}},{props:{fontSize:"small"},style:{fontSize:((m=(d=t.typography)==null?void 0:d.pxToRem)==null?void 0:m.call(d,20))||"1.25rem"}},{props:{fontSize:"medium"},style:{fontSize:((T=(s=t.typography)==null?void 0:s.pxToRem)==null?void 0:T.call(s,24))||"1.5rem"}},{props:{fontSize:"large"},style:{fontSize:((P=(D=t.typography)==null?void 0:D.pxToRem)==null?void 0:P.call(D,35))||"2.1875rem"}},...Object.entries((t.vars??t).palette).filter(([,X])=>X&&X.main).map(([X])=>{var te,ie;return{props:{color:X},style:{color:(ie=(te=(t.vars??t).palette)==null?void 0:te[X])==null?void 0:ie.main}}}),{props:{color:"action"},style:{color:(F=(z=(t.vars??t).palette)==null?void 0:z.action)==null?void 0:F.active}},{props:{color:"disabled"},style:{color:(J=($=(t.vars??t).palette)==null?void 0:$.action)==null?void 0:J.disabled}},{props:{color:"inherit"},style:{color:void 0}}]}})),dO=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiSvgIcon"}),{children:c,className:d,color:m="inherit",component:s="svg",fontSize:T="medium",htmlColor:D,inheritViewBox:P=!1,titleAccess:z,viewBox:F="0 0 24 24",...$}=r,J=ke.isValidElement(c)&&c.type==="svg",X={...r,color:m,component:s,fontSize:T,instanceFontSize:e.fontSize,inheritViewBox:P,viewBox:F,hasSvgAsChild:J},te={};P||(te.viewBox=F);const ie=nW(X);return Qn.jsxs(iW,{as:s,className:Dr(ie.root,d),focusable:"false",color:D,"aria-hidden":z?void 0:!0,role:z?"img":void 0,ref:n,...te,...$,...J&&c.props,ownerState:X,children:[J?c.props.children:c,z?Qn.jsx("title",{children:z}):null]})});dO.propTypes={children:G.node,classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["inherit","action","disabled","primary","secondary","error","info","success","warning"]),G.string]),component:G.elementType,fontSize:G.oneOfType([G.oneOf(["inherit","large","medium","small"]),G.string]),htmlColor:G.string,inheritViewBox:G.bool,shapeRendering:G.string,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),titleAccess:G.string,viewBox:G.string};dO.muiName="SvgIcon";function kA(t,e){function n(r,c){return Qn.jsx(dO,{"data-testid":`${e}Icon`,ref:c,...r,children:t})}return n.displayName=`${e}Icon`,n.muiName=dO.muiName,ke.memo(ke.forwardRef(n))}function rW(t,e=166){let n;function r(...c){const d=()=>{t.apply(this,c)};clearTimeout(n),n=setTimeout(d,e)}return r.clear=()=>{clearTimeout(n)},r}function tf(t){return t&&t.ownerDocument||document}function mx(t){return tf(t).defaultView||window}function oB(t,e){typeof t=="function"?t(e):t&&(t.current=e)}let aB=0;function sW(t){const[e,n]=ke.useState(t),r=t||e;return ke.useEffect(()=>{e==null&&(aB+=1,n(`mui-${aB}`))},[e]),r}const oW={...lk},lB=oW.useId;function ZN(t){if(lB!==void 0){const e=lB();return t??e}return sW(t)}function A5(t){const{controlled:e,default:n,name:r,state:c="value"}=t,{current:d}=ke.useRef(e!==void 0),[m,s]=ke.useState(n),T=d?e:m;{ke.useEffect(()=>{d!==(e!==void 0)&&console.error([`MUI: A component is changing the ${d?"":"un"}controlled ${c} state of ${r} to be ${d?"un":""}controlled.`,"Elements should not switch from uncontrolled to controlled (or vice versa).",`Decide between using a controlled or uncontrolled ${r} element for the lifetime of the component.`,"The nature of the state is determined during the first render. It's considered controlled if the value is not `undefined`.","More info: https://fb.me/react-controlled-components"].join(`
`))},[c,r,e]);const{current:P}=ke.useRef(n);ke.useEffect(()=>{!d&&!Object.is(P,n)&&console.error([`MUI: A component is changing the default ${c} state of an uncontrolled ${r} after being initialized. To suppress this warning opt to use a controlled ${r}.`].join(`
`))},[JSON.stringify(n)])}const D=ke.useCallback(P=>{d||s(P)},[]);return[T,D]}function Fv(t){const e=ke.useRef(t);return px(()=>{e.current=t}),ke.useRef((...n)=>(0,e.current)(...n)).current}function xu(...t){const e=ke.useRef(void 0),n=ke.useCallback(r=>{const c=t.map(d=>{if(d==null)return null;if(typeof d=="function"){const m=d,s=m(r);return typeof s=="function"?s:()=>{m(null)}}return d.current=r,()=>{d.current=null}});return()=>{c.forEach(d=>d==null?void 0:d())}},t);return ke.useMemo(()=>t.every(r=>r==null)?null:r=>{e.current&&(e.current(),e.current=void 0),r!=null&&(e.current=n(r))},t)}function aW(t,e){const n=t.charCodeAt(2);return t[0]==="o"&&t[1]==="n"&&n>=65&&n<=90&&typeof e=="function"}function lW(t,e){if(!t)return e;function n(m,s){const T={};return Object.keys(s).forEach(D=>{aW(D,s[D])&&typeof m[D]=="function"&&(T[D]=(...P)=>{m[D](...P),s[D](...P)})}),T}if(typeof t=="function"||typeof e=="function")return m=>{const s=typeof e=="function"?e(m):e,T=typeof t=="function"?t({...m,...s}):t,D=Dr(m==null?void 0:m.className,s==null?void 0:s.className,T==null?void 0:T.className),P=n(T,s);return{...s,...T,...P,...!!D&&{className:D},...(s==null?void 0:s.style)&&(T==null?void 0:T.style)&&{style:{...s.style,...T.style}},...(s==null?void 0:s.sx)&&(T==null?void 0:T.sx)&&{sx:[...Array.isArray(s.sx)?s.sx:[s.sx],...Array.isArray(T.sx)?T.sx:[T.sx]]}}};const r=e,c=n(t,r),d=Dr(r==null?void 0:r.className,t==null?void 0:t.className);return{...e,...t,...c,...!!d&&{className:d},...(r==null?void 0:r.style)&&(t==null?void 0:t.style)&&{style:{...r.style,...t.style}},...(r==null?void 0:r.sx)&&(t==null?void 0:t.sx)&&{sx:[...Array.isArray(r.sx)?r.sx:[r.sx],...Array.isArray(t.sx)?t.sx:[t.sx]]}}}const MI=G.oneOfType([G.func,G.object]);function cW(t){const{prototype:e={}}=t;return!!e.isReactComponent}function uW(t,e,n,r,c){const d=t[e],m=c||e;if(d==null||typeof window>"u")return null;let s;return typeof d=="function"&&!cW(d)&&(s="Did you accidentally provide a plain function component instead?"),s!==void 0?new Error(`Invalid ${r} \`${m}\` supplied to \`${n}\`. Expected an element type that can hold a ref. ${s} For more information see https://mui.com/r/caveat-with-refs-guide`):null}const XN=P_(G.elementType,uW);function fO(t){try{return t.matches(":focus-visible")}catch{/jsdom/.test(window.navigator.userAgent)||console.warn(["MUI: The `:focus-visible` pseudo class is not supported in this browser.","Some components rely on this feature to work properly."].join(`
`))}return!1}const cB={};function C5(t,e){const n=ke.useRef(cB);return n.current===cB&&(n.current=t(e)),n}class pO{constructor(){ki(this,"mountEffect",()=>{this.shouldMount&&!this.didMount&&this.ref.current!==null&&(this.didMount=!0,this.mounted.resolve())});this.ref={current:null},this.mounted=null,this.didMount=!1,this.shouldMount=!1,this.setShouldMount=null}static create(){return new pO}static use(){const e=C5(pO.create).current,[n,r]=ke.useState(!1);return e.shouldMount=n,e.setShouldMount=r,ke.useEffect(e.mountEffect,[n]),e}mount(){return this.mounted||(this.mounted=dW(),this.shouldMount=!0,this.setShouldMount(this.shouldMount)),this.mounted}start(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.start(...e)})}stop(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.stop(...e)})}pulsate(...e){this.mount().then(()=>{var n;return(n=this.ref.current)==null?void 0:n.pulsate(...e)})}}function hW(){return pO.use()}function dW(){let t,e;const n=new Promise((r,c)=>{t=r,e=c});return n.resolve=t,n.reject=e,n}function D5(t,e){if(t==null)return{};var n={};for(var r in t)if({}.hasOwnProperty.call(t,r)){if(e.indexOf(r)!==-1)continue;n[r]=t[r]}return n}function yk(t,e){return yk=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,r){return n.__proto__=r,n},yk(t,e)}function R5(t,e){t.prototype=Object.create(e.prototype),t.prototype.constructor=t,yk(t,e)}var sA=zU();const XD=AA(sA),uB={disabled:!1};var fW=G.oneOfType([G.number,G.shape({enter:G.number,exit:G.number,appear:G.number}).isRequired]);G.oneOfType([G.string,G.shape({enter:G.string,exit:G.string,active:G.string}),G.shape({enter:G.string,enterDone:G.string,enterActive:G.string,exit:G.string,exitDone:G.string,exitActive:G.string})]);const mO=Bc.createContext(null);var pW=function(e){return e.scrollTop},TS="unmounted",Xb="exited",Qb="entering",xw="entered",vk="exiting",vp=function(t){R5(e,t);function e(r,c){var d;d=t.call(this,r,c)||this;var m=c,s=m&&!m.isMounting?r.enter:r.appear,T;return d.appearStatus=null,r.in?s?(T=Xb,d.appearStatus=Qb):T=xw:r.unmountOnExit||r.mountOnEnter?T=TS:T=Xb,d.state={status:T},d.nextCallback=null,d}e.getDerivedStateFromProps=function(c,d){var m=c.in;return m&&d.status===TS?{status:Xb}:null};var n=e.prototype;return n.componentDidMount=function(){this.updateStatus(!0,this.appearStatus)},n.componentDidUpdate=function(c){var d=null;if(c!==this.props){var m=this.state.status;this.props.in?m!==Qb&&m!==xw&&(d=Qb):(m===Qb||m===xw)&&(d=vk)}this.updateStatus(!1,d)},n.componentWillUnmount=function(){this.cancelNextCallback()},n.getTimeouts=function(){var c=this.props.timeout,d,m,s;return d=m=s=c,c!=null&&typeof c!="number"&&(d=c.exit,m=c.enter,s=c.appear!==void 0?c.appear:m),{exit:d,enter:m,appear:s}},n.updateStatus=function(c,d){if(c===void 0&&(c=!1),d!==null)if(this.cancelNextCallback(),d===Qb){if(this.props.unmountOnExit||this.props.mountOnEnter){var m=this.props.nodeRef?this.props.nodeRef.current:XD.findDOMNode(this);m&&pW(m)}this.performEnter(c)}else this.performExit();else this.props.unmountOnExit&&this.state.status===Xb&&this.setState({status:TS})},n.performEnter=function(c){var d=this,m=this.props.enter,s=this.context?this.context.isMounting:c,T=this.props.nodeRef?[s]:[XD.findDOMNode(this),s],D=T[0],P=T[1],z=this.getTimeouts(),F=s?z.appear:z.enter;if(!c&&!m||uB.disabled){this.safeSetState({status:xw},function(){d.props.onEntered(D)});return}this.props.onEnter(D,P),this.safeSetState({status:Qb},function(){d.props.onEntering(D,P),d.onTransitionEnd(F,function(){d.safeSetState({status:xw},function(){d.props.onEntered(D,P)})})})},n.performExit=function(){var c=this,d=this.props.exit,m=this.getTimeouts(),s=this.props.nodeRef?void 0:XD.findDOMNode(this);if(!d||uB.disabled){this.safeSetState({status:Xb},function(){c.props.onExited(s)});return}this.props.onExit(s),this.safeSetState({status:vk},function(){c.props.onExiting(s),c.onTransitionEnd(m.exit,function(){c.safeSetState({status:Xb},function(){c.props.onExited(s)})})})},n.cancelNextCallback=function(){this.nextCallback!==null&&(this.nextCallback.cancel(),this.nextCallback=null)},n.safeSetState=function(c,d){d=this.setNextCallback(d),this.setState(c,d)},n.setNextCallback=function(c){var d=this,m=!0;return this.nextCallback=function(s){m&&(m=!1,d.nextCallback=null,c(s))},this.nextCallback.cancel=function(){m=!1},this.nextCallback},n.onTransitionEnd=function(c,d){this.setNextCallback(d);var m=this.props.nodeRef?this.props.nodeRef.current:XD.findDOMNode(this),s=c==null&&!this.props.addEndListener;if(!m||s){setTimeout(this.nextCallback,0);return}if(this.props.addEndListener){var T=this.props.nodeRef?[this.nextCallback]:[m,this.nextCallback],D=T[0],P=T[1];this.props.addEndListener(D,P)}c!=null&&setTimeout(this.nextCallback,c)},n.render=function(){var c=this.state.status;if(c===TS)return null;var d=this.props,m=d.children;d.in,d.mountOnEnter,d.unmountOnExit,d.appear,d.enter,d.exit,d.timeout,d.addEndListener,d.onEnter,d.onEntering,d.onEntered,d.onExit,d.onExiting,d.onExited,d.nodeRef;var s=D5(d,["children","in","mountOnEnter","unmountOnExit","appear","enter","exit","timeout","addEndListener","onEnter","onEntering","onEntered","onExit","onExiting","onExited","nodeRef"]);return Bc.createElement(mO.Provider,{value:null},typeof m=="function"?m(c,s):Bc.cloneElement(Bc.Children.only(m),s))},e}(Bc.Component);vp.contextType=mO;vp.propTypes={nodeRef:G.shape({current:typeof Element>"u"?G.any:function(t,e,n,r,c,d){var m=t[e];return G.instanceOf(m&&"ownerDocument"in m?m.ownerDocument.defaultView.Element:Element)(t,e,n,r,c,d)}}),children:G.oneOfType([G.func.isRequired,G.element.isRequired]).isRequired,in:G.bool,mountOnEnter:G.bool,unmountOnExit:G.bool,appear:G.bool,enter:G.bool,exit:G.bool,timeout:function(e){var n=fW;e.addEndListener||(n=n.isRequired);for(var r=arguments.length,c=new Array(r>1?r-1:0),d=1;d<r;d++)c[d-1]=arguments[d];return n.apply(void 0,[e].concat(c))},addEndListener:G.func,onEnter:G.func,onEntering:G.func,onEntered:G.func,onExit:G.func,onExiting:G.func,onExited:G.func};function yw(){}vp.defaultProps={in:!1,mountOnEnter:!1,unmountOnExit:!1,appear:!1,enter:!0,exit:!0,onEnter:yw,onEntering:yw,onEntered:yw,onExit:yw,onExiting:yw,onExited:yw};vp.UNMOUNTED=TS;vp.EXITED=Xb;vp.ENTERING=Qb;vp.ENTERED=xw;vp.EXITING=vk;function mW(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function QN(t,e){var n=function(d){return e&&ke.isValidElement(d)?e(d):d},r=Object.create(null);return t&&ke.Children.map(t,function(c){return c}).forEach(function(c){r[c.key]=n(c)}),r}function gW(t,e){t=t||{},e=e||{};function n(P){return P in e?e[P]:t[P]}var r=Object.create(null),c=[];for(var d in t)d in e?c.length&&(r[d]=c,c=[]):c.push(d);var m,s={};for(var T in e){if(r[T])for(m=0;m<r[T].length;m++){var D=r[T][m];s[r[T][m]]=n(D)}s[T]=n(T)}for(m=0;m<c.length;m++)s[c[m]]=n(c[m]);return s}function ix(t,e,n){return n[e]!=null?n[e]:t.props[e]}function _W(t,e){return QN(t.children,function(n){return ke.cloneElement(n,{onExited:e.bind(null,n),in:!0,appear:ix(n,"appear",t),enter:ix(n,"enter",t),exit:ix(n,"exit",t)})})}function yW(t,e,n){var r=QN(t.children),c=gW(e,r);return Object.keys(c).forEach(function(d){var m=c[d];if(ke.isValidElement(m)){var s=d in e,T=d in r,D=e[d],P=ke.isValidElement(D)&&!D.props.in;T&&(!s||P)?c[d]=ke.cloneElement(m,{onExited:n.bind(null,m),in:!0,exit:ix(m,"exit",t),enter:ix(m,"enter",t)}):!T&&s&&!P?c[d]=ke.cloneElement(m,{in:!1}):T&&s&&ke.isValidElement(D)&&(c[d]=ke.cloneElement(m,{onExited:n.bind(null,m),in:D.props.in,exit:ix(m,"exit",t),enter:ix(m,"enter",t)}))}}),c}var vW=Object.values||function(t){return Object.keys(t).map(function(e){return t[e]})},bW={component:"div",childFactory:function(e){return e}},KN=function(t){R5(e,t);function e(r,c){var d;d=t.call(this,r,c)||this;var m=d.handleExited.bind(mW(d));return d.state={contextValue:{isMounting:!0},handleExited:m,firstRender:!0},d}var n=e.prototype;return n.componentDidMount=function(){this.mounted=!0,this.setState({contextValue:{isMounting:!1}})},n.componentWillUnmount=function(){this.mounted=!1},e.getDerivedStateFromProps=function(c,d){var m=d.children,s=d.handleExited,T=d.firstRender;return{children:T?_W(c,s):yW(c,m,s),firstRender:!1}},n.handleExited=function(c,d){var m=QN(this.props.children);c.key in m||(c.props.onExited&&c.props.onExited(d),this.mounted&&this.setState(function(s){var T=cO({},s.children);return delete T[c.key],{children:T}}))},n.render=function(){var c=this.props,d=c.component,m=c.childFactory,s=D5(c,["component","childFactory"]),T=this.state.contextValue,D=vW(this.state.children).map(m);return delete s.appear,delete s.enter,delete s.exit,d===null?Bc.createElement(mO.Provider,{value:T},D):Bc.createElement(mO.Provider,{value:T},Bc.createElement(d,s,D))},e}(Bc.Component);KN.propTypes={component:G.any,children:G.node,appear:G.bool,enter:G.bool,exit:G.bool,childFactory:G.func};KN.defaultProps=bW;const xW=[];function wW(t){ke.useEffect(t,xW)}class PI{constructor(){ki(this,"currentId",null);ki(this,"clear",()=>{this.currentId!==null&&(clearTimeout(this.currentId),this.currentId=null)});ki(this,"disposeEffect",()=>this.clear)}static create(){return new PI}start(e,n){this.clear(),this.currentId=setTimeout(()=>{this.currentId=null,n()},e)}}function rx(){const t=C5(PI.create).current;return wW(t.disposeEffect),t}function O5(t){const{className:e,classes:n,pulsate:r=!1,rippleX:c,rippleY:d,rippleSize:m,in:s,onExited:T,timeout:D}=t,[P,z]=ke.useState(!1),F=Dr(e,n.ripple,n.rippleVisible,r&&n.ripplePulsate),$={width:m,height:m,top:-(m/2)+d,left:-(m/2)+c},J=Dr(n.child,P&&n.childLeaving,r&&n.childPulsate);return!s&&!P&&z(!0),ke.useEffect(()=>{if(!s&&T!=null){const X=setTimeout(T,D);return()=>{clearTimeout(X)}}},[T,s,D]),Qn.jsx("span",{className:F,style:$,children:Qn.jsx("span",{className:J})})}O5.propTypes={classes:G.object.isRequired,className:G.string,in:G.bool,onExited:G.func,pulsate:G.bool,rippleSize:G.number,rippleX:G.number,rippleY:G.number,timeout:G.number.isRequired};const Zd=io("MuiTouchRipple",["root","ripple","rippleVisible","ripplePulsate","child","childLeaving","childPulsate"]),bk=550,TW=80,EW=MA`
  0% {
    transform: scale(0);
    opacity: 0.1;
  }

  100% {
    transform: scale(1);
    opacity: 0.3;
  }
`,SW=MA`
  0% {
    opacity: 1;
  }

  100% {
    opacity: 0;
  }
`,AW=MA`
  0% {
    transform: scale(1);
  }

  50% {
    transform: scale(0.92);
  }

  100% {
    transform: scale(1);
  }
`,CW=lr("span",{name:"MuiTouchRipple",slot:"Root"})({overflow:"hidden",pointerEvents:"none",position:"absolute",zIndex:0,top:0,right:0,bottom:0,left:0,borderRadius:"inherit"}),DW=lr(O5,{name:"MuiTouchRipple",slot:"Ripple"})`
  opacity: 0;
  position: absolute;

  &.${Zd.rippleVisible} {
    opacity: 0.3;
    transform: scale(1);
    animation-name: ${EW};
    animation-duration: ${bk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  &.${Zd.ripplePulsate} {
    animation-duration: ${({theme:t})=>t.transitions.duration.shorter}ms;
  }

  & .${Zd.child} {
    opacity: 1;
    display: block;
    width: 100%;
    height: 100%;
    border-radius: 50%;
    background-color: currentColor;
  }

  & .${Zd.childLeaving} {
    opacity: 0;
    animation-name: ${SW};
    animation-duration: ${bk}ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
  }

  & .${Zd.childPulsate} {
    position: absolute;
    /* @noflip */
    left: 0px;
    top: 0;
    animation-name: ${AW};
    animation-duration: 2500ms;
    animation-timing-function: ${({theme:t})=>t.transitions.easing.easeInOut};
    animation-iteration-count: infinite;
    animation-delay: 200ms;
  }
`,I5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTouchRipple"}),{center:c=!1,classes:d={},className:m,...s}=r,[T,D]=ke.useState([]),P=ke.useRef(0),z=ke.useRef(null);ke.useEffect(()=>{z.current&&(z.current(),z.current=null)},[T]);const F=ke.useRef(!1),$=rx(),J=ke.useRef(null),X=ke.useRef(null),te=ke.useCallback(Re=>{const{pulsate:Ne,rippleX:Xe,rippleY:be,rippleSize:_e,cb:Te}=Re;D(oe=>[...oe,Qn.jsx(DW,{classes:{ripple:Dr(d.ripple,Zd.ripple),rippleVisible:Dr(d.rippleVisible,Zd.rippleVisible),ripplePulsate:Dr(d.ripplePulsate,Zd.ripplePulsate),child:Dr(d.child,Zd.child),childLeaving:Dr(d.childLeaving,Zd.childLeaving),childPulsate:Dr(d.childPulsate,Zd.childPulsate)},timeout:bk,pulsate:Ne,rippleX:Xe,rippleY:be,rippleSize:_e},P.current)]),P.current+=1,z.current=Te},[d]),ie=ke.useCallback((Re={},Ne={},Xe=()=>{})=>{const{pulsate:be=!1,center:_e=c||Ne.pulsate,fakeElement:Te=!1}=Ne;if((Re==null?void 0:Re.type)==="mousedown"&&F.current){F.current=!1;return}(Re==null?void 0:Re.type)==="touchstart"&&(F.current=!0);const oe=Te?null:X.current,Ee=oe?oe.getBoundingClientRect():{width:0,height:0,left:0,top:0};let $e,ze,zt;if(_e||Re===void 0||Re.clientX===0&&Re.clientY===0||!Re.clientX&&!Re.touches)$e=Math.round(Ee.width/2),ze=Math.round(Ee.height/2);else{const{clientX:St,clientY:mt}=Re.touches&&Re.touches.length>0?Re.touches[0]:Re;$e=Math.round(St-Ee.left),ze=Math.round(mt-Ee.top)}if(_e)zt=Math.sqrt((2*Ee.width**2+Ee.height**2)/3),zt%2===0&&(zt+=1);else{const St=Math.max(Math.abs((oe?oe.clientWidth:0)-$e),$e)*2+2,mt=Math.max(Math.abs((oe?oe.clientHeight:0)-ze),ze)*2+2;zt=Math.sqrt(St**2+mt**2)}Re!=null&&Re.touches?J.current===null&&(J.current=()=>{te({pulsate:be,rippleX:$e,rippleY:ze,rippleSize:zt,cb:Xe})},$.start(TW,()=>{J.current&&(J.current(),J.current=null)})):te({pulsate:be,rippleX:$e,rippleY:ze,rippleSize:zt,cb:Xe})},[c,te,$]),we=ke.useCallback(()=>{ie({},{pulsate:!0})},[ie]),Ie=ke.useCallback((Re,Ne)=>{if($.clear(),(Re==null?void 0:Re.type)==="touchend"&&J.current){J.current(),J.current=null,$.start(0,()=>{Ie(Re,Ne)});return}J.current=null,D(Xe=>Xe.length>0?Xe.slice(1):Xe),z.current=Ne},[$]);return ke.useImperativeHandle(n,()=>({pulsate:we,start:ie,stop:Ie}),[we,ie,Ie]),Qn.jsx(CW,{className:Dr(Zd.root,d.root,m),ref:X,...s,children:Qn.jsx(KN,{component:null,exit:!0,children:T})})});I5.propTypes={center:G.bool,classes:G.object,className:G.string};function RW(t){return wo("MuiButtonBase",t)}const OW=io("MuiButtonBase",["root","disabled","focusVisible"]),IW=t=>{const{disabled:e,focusVisible:n,focusVisibleClassName:r,classes:c}=t,m=Fo({root:["root",e&&"disabled",n&&"focusVisible"]},RW,c);return n&&r&&(m.root+=` ${r}`),m},MW=lr("button",{name:"MuiButtonBase",slot:"Root"})({display:"inline-flex",alignItems:"center",justifyContent:"center",position:"relative",boxSizing:"border-box",WebkitTapHighlightColor:"transparent",backgroundColor:"transparent",outline:0,border:0,margin:0,borderRadius:0,padding:0,cursor:"pointer",userSelect:"none",verticalAlign:"middle",MozAppearance:"none",WebkitAppearance:"none",textDecoration:"none",color:"inherit","&::-moz-focus-inner":{borderStyle:"none"},[`&.${OW.disabled}`]:{pointerEvents:"none",cursor:"default"},"@media print":{colorAdjust:"exact"}}),NA=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiButtonBase"}),{action:c,centerRipple:d=!1,children:m,className:s,component:T="button",disabled:D=!1,disableRipple:P=!1,disableTouchRipple:z=!1,focusRipple:F=!1,focusVisibleClassName:$,LinkComponent:J="a",onBlur:X,onClick:te,onContextMenu:ie,onDragLeave:we,onFocus:Ie,onFocusVisible:Re,onKeyDown:Ne,onKeyUp:Xe,onMouseDown:be,onMouseLeave:_e,onMouseUp:Te,onTouchEnd:oe,onTouchMove:Ee,onTouchStart:$e,tabIndex:ze=0,TouchRippleProps:zt,touchRippleRef:St,type:mt,...Ft}=r,rn=ke.useRef(null),Xt=hW(),Fe=xu(Xt.ref,St),[Ot,Ut]=ke.useState(!1);D&&Ot&&Ut(!1),ke.useImperativeHandle(c,()=>({focusVisible:()=>{Ut(!0),rn.current.focus()}}),[]);const ln=Xt.shouldMount&&!P&&!D;ke.useEffect(()=>{Ot&&F&&!P&&Xt.pulsate()},[P,F,Ot,Xt]);const wn=u_(Xt,"start",be,z),dn=u_(Xt,"stop",ie,z),Ht=u_(Xt,"stop",we,z),Mn=u_(Xt,"stop",Te,z),yn=u_(Xt,"stop",di=>{Ot&&di.preventDefault(),_e&&_e(di)},z),Tn=u_(Xt,"start",$e,z),Cn=u_(Xt,"stop",oe,z),Kn=u_(Xt,"stop",Ee,z),Bt=u_(Xt,"stop",di=>{fO(di.target)||Ut(!1),X&&X(di)},!1),ni=Fv(di=>{rn.current||(rn.current=di.currentTarget),fO(di.target)&&(Ut(!0),Re&&Re(di)),Ie&&Ie(di)}),er=()=>{const di=rn.current;return T&&T!=="button"&&!(di.tagName==="A"&&di.href)},_r=Fv(di=>{F&&!di.repeat&&Ot&&di.key===" "&&Xt.stop(di,()=>{Xt.start(di)}),di.target===di.currentTarget&&er()&&di.key===" "&&di.preventDefault(),Ne&&Ne(di),di.target===di.currentTarget&&er()&&di.key==="Enter"&&!D&&(di.preventDefault(),te&&te(di))}),Li=Fv(di=>{F&&di.key===" "&&Ot&&!di.defaultPrevented&&Xt.stop(di,()=>{Xt.pulsate(di)}),Xe&&Xe(di),te&&di.target===di.currentTarget&&er()&&di.key===" "&&!di.defaultPrevented&&te(di)});let jr=T;jr==="button"&&(Ft.href||Ft.to)&&(jr=J);const ss={};jr==="button"?(ss.type=mt===void 0?"button":mt,ss.disabled=D):(!Ft.href&&!Ft.to&&(ss.role="button"),D&&(ss["aria-disabled"]=D));const Nr=xu(n,rn),ti={...r,centerRipple:d,component:T,disabled:D,disableRipple:P,disableTouchRipple:z,focusRipple:F,tabIndex:ze,focusVisible:Ot},dr=IW(ti);return Qn.jsxs(MW,{as:jr,className:Dr(dr.root,s),ownerState:ti,onBlur:Bt,onClick:te,onContextMenu:dn,onFocus:ni,onKeyDown:_r,onKeyUp:Li,onMouseDown:wn,onMouseLeave:yn,onMouseUp:Mn,onDragLeave:Ht,onTouchEnd:Cn,onTouchMove:Kn,onTouchStart:Tn,ref:Nr,tabIndex:D?-1:ze,type:mt,...ss,...Ft,children:[m,ln?Qn.jsx(I5,{ref:Fe,center:d,...zt}):null]})});function u_(t,e,n,r=!1){return Fv(c=>(n&&n(c),r||t[e](c),!0))}NA.propTypes={action:MI,centerRipple:G.bool,children:G.node,classes:G.object,className:G.string,component:XN,disabled:G.bool,disableRipple:G.bool,disableTouchRipple:G.bool,focusRipple:G.bool,focusVisibleClassName:G.string,href:G.any,LinkComponent:G.elementType,onBlur:G.func,onClick:G.func,onContextMenu:G.func,onDragLeave:G.func,onFocus:G.func,onFocusVisible:G.func,onKeyDown:G.func,onKeyUp:G.func,onMouseDown:G.func,onMouseLeave:G.func,onMouseUp:G.func,onTouchEnd:G.func,onTouchMove:G.func,onTouchStart:G.func,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),tabIndex:G.number,TouchRippleProps:G.object,touchRippleRef:G.oneOfType([G.func,G.shape({current:G.shape({pulsate:G.func.isRequired,start:G.func.isRequired,stop:G.func.isRequired})})]),type:G.oneOfType([G.oneOf(["button","reset","submit"]),G.string])};function PW(t){return wo("MuiCircularProgress",t)}io("MuiCircularProgress",["root","determinate","indeterminate","colorPrimary","colorSecondary","svg","circle","circleDeterminate","circleIndeterminate","circleDisableShrink"]);const Av=44,xk=MA`
  0% {
    transform: rotate(0deg);
  }

  100% {
    transform: rotate(360deg);
  }
`,wk=MA`
  0% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: 0;
  }

  50% {
    stroke-dasharray: 100px, 200px;
    stroke-dashoffset: -15px;
  }

  100% {
    stroke-dasharray: 1px, 200px;
    stroke-dashoffset: -126px;
  }
`,kW=typeof xk!="string"?UN`
        animation: ${xk} 1.4s linear infinite;
      `:null,NW=typeof wk!="string"?UN`
        animation: ${wk} 1.4s ease-in-out infinite;
      `:null,LW=t=>{const{classes:e,variant:n,color:r,disableShrink:c}=t,d={root:["root",n,`color${Rr(r)}`],svg:["svg"],circle:["circle",`circle${Rr(n)}`,c&&"circleDisableShrink"]};return Fo(d,PW,e)},zW=lr("span",{name:"MuiCircularProgress",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`color${Rr(n.color)}`]]}})(zo(({theme:t})=>({display:"inline-block",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("transform")}},{props:{variant:"indeterminate"},style:kW||{animation:`${xk} 1.4s linear infinite`}},...Object.entries(t.palette).filter($w()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}}))]}))),BW=lr("svg",{name:"MuiCircularProgress",slot:"Svg"})({display:"block"}),FW=lr("circle",{name:"MuiCircularProgress",slot:"Circle",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.circle,e[`circle${Rr(n.variant)}`],n.disableShrink&&e.circleDisableShrink]}})(zo(({theme:t})=>({stroke:"currentColor",variants:[{props:{variant:"determinate"},style:{transition:t.transitions.create("stroke-dashoffset")}},{props:{variant:"indeterminate"},style:{strokeDasharray:"80px, 200px",strokeDashoffset:0}},{props:({ownerState:e})=>e.variant==="indeterminate"&&!e.disableShrink,style:NW||{animation:`${wk} 1.4s ease-in-out infinite`}}]}))),JN=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiCircularProgress"}),{className:c,color:d="primary",disableShrink:m=!1,size:s=40,style:T,thickness:D=3.6,value:P=0,variant:z="indeterminate",...F}=r,$={...r,color:d,disableShrink:m,size:s,thickness:D,value:P,variant:z},J=LW($),X={},te={},ie={};if(z==="determinate"){const we=2*Math.PI*((Av-D)/2);X.strokeDasharray=we.toFixed(3),ie["aria-valuenow"]=Math.round(P),X.strokeDashoffset=`${((100-P)/100*we).toFixed(3)}px`,te.transform="rotate(-90deg)"}return Qn.jsx(zW,{className:Dr(J.root,c),style:{width:s,height:s,...te,...T},ownerState:$,ref:n,role:"progressbar",...ie,...F,children:Qn.jsx(BW,{className:J.svg,ownerState:$,viewBox:`${Av/2} ${Av/2} ${Av} ${Av}`,children:Qn.jsx(FW,{className:J.circle,style:X,ownerState:$,cx:Av,cy:Av,r:(Av-D)/2,fill:"none",strokeWidth:D})})})});JN.propTypes={classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["inherit","primary","secondary","error","info","success","warning"]),G.string]),disableShrink:P_(G.bool,t=>t.disableShrink&&t.variant&&t.variant!=="indeterminate"?new Error("MUI: You have provided the `disableShrink` prop with a variant other than `indeterminate`. This will have no effect."):null),size:G.oneOfType([G.number,G.string]),style:G.object,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),thickness:G.number,value:G.number,variant:G.oneOf(["determinate","indeterminate"])};function VW(t){return wo("MuiIconButton",t)}const hB=io("MuiIconButton",["root","disabled","colorInherit","colorPrimary","colorSecondary","colorError","colorInfo","colorSuccess","colorWarning","edgeStart","edgeEnd","sizeSmall","sizeMedium","sizeLarge","loading","loadingIndicator","loadingWrapper"]),UW=t=>{const{classes:e,disabled:n,color:r,edge:c,size:d,loading:m}=t,s={root:["root",m&&"loading",n&&"disabled",r!=="default"&&`color${Rr(r)}`,c&&`edge${Rr(c)}`,`size${Rr(d)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]};return Fo(s,VW,e)},jW=lr(NA,{name:"MuiIconButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.loading&&e.loading,n.color!=="default"&&e[`color${Rr(n.color)}`],n.edge&&e[`edge${Rr(n.edge)}`],e[`size${Rr(n.size)}`]]}})(zo(({theme:t})=>({textAlign:"center",flex:"0 0 auto",fontSize:t.typography.pxToRem(24),padding:8,borderRadius:"50%",color:(t.vars||t).palette.action.active,transition:t.transitions.create("background-color",{duration:t.transitions.duration.shortest}),variants:[{props:e=>!e.disableRipple,style:{"--IconButton-hoverBg":t.vars?`rgba(${t.vars.palette.action.activeChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc(t.palette.action.active,t.palette.action.hoverOpacity),"&:hover":{backgroundColor:"var(--IconButton-hoverBg)","@media (hover: none)":{backgroundColor:"transparent"}}}},{props:{edge:"start"},style:{marginLeft:-12}},{props:{edge:"start",size:"small"},style:{marginLeft:-3}},{props:{edge:"end"},style:{marginRight:-12}},{props:{edge:"end",size:"small"},style:{marginRight:-3}}]})),zo(({theme:t})=>({variants:[{props:{color:"inherit"},style:{color:"inherit"}},...Object.entries(t.palette).filter($w()).map(([e])=>({props:{color:e},style:{color:(t.vars||t).palette[e].main}})),...Object.entries(t.palette).filter($w()).map(([e])=>({props:{color:e},style:{"--IconButton-hoverBg":t.vars?`rgba(${(t.vars||t).palette[e].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc((t.vars||t).palette[e].main,t.palette.action.hoverOpacity)}})),{props:{size:"small"},style:{padding:5,fontSize:t.typography.pxToRem(18)}},{props:{size:"large"},style:{padding:12,fontSize:t.typography.pxToRem(28)}}],[`&.${hB.disabled}`]:{backgroundColor:"transparent",color:(t.vars||t).palette.action.disabled},[`&.${hB.loading}`]:{color:"transparent"}}))),HW=lr("span",{name:"MuiIconButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",top:"50%",left:"50%",transform:"translate(-50%, -50%)",color:(t.vars||t).palette.action.disabled,variants:[{props:{loading:!0},style:{display:"flex"}}]})),Tk=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiIconButton"}),{edge:c=!1,children:d,className:m,color:s="default",disabled:T=!1,disableFocusRipple:D=!1,size:P="medium",id:z,loading:F=null,loadingIndicator:$,...J}=r,X=ZN(z),te=$??Qn.jsx(JN,{"aria-labelledby":X,color:"inherit",size:16}),ie={...r,edge:c,color:s,disabled:T,disableFocusRipple:D,loading:F,loadingIndicator:te,size:P},we=UW(ie);return Qn.jsxs(jW,{id:F?X:z,className:Dr(we.root,m),centerRipple:!0,focusRipple:!D,disabled:T||F,ref:n,...J,ownerState:ie,children:[typeof F=="boolean"&&Qn.jsx("span",{className:we.loadingWrapper,style:{display:"contents"},children:Qn.jsx(HW,{className:we.loadingIndicator,ownerState:ie,children:F&&te})}),d]})});Tk.propTypes={children:P_(G.node,t=>ke.Children.toArray(t.children).some(n=>ke.isValidElement(n)&&n.props.onClick)?new Error(["MUI: You are providing an onClick event listener to a child of a button element.","Prefer applying it to the IconButton directly.","This guarantees that the whole <button> will be responsive to click events."].join(`
`)):null),classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["inherit","default","primary","secondary","error","info","success","warning"]),G.string]),disabled:G.bool,disableFocusRipple:G.bool,disableRipple:G.bool,edge:G.oneOf(["end","start",!1]),id:G.string,loading:G.bool,loadingIndicator:G.node,size:G.oneOfType([G.oneOf(["small","medium","large"]),G.string]),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};function $W(t){return wo("MuiTypography",t)}io("MuiTypography",["root","h1","h2","h3","h4","h5","h6","subtitle1","subtitle2","body1","body2","inherit","button","caption","overline","alignLeft","alignRight","alignCenter","alignJustify","noWrap","gutterBottom","paragraph"]);const GW={primary:!0,secondary:!0,error:!0,info:!0,success:!0,warning:!0,textPrimary:!0,textSecondary:!0,textDisabled:!0},qW=V7(),WW=t=>{const{align:e,gutterBottom:n,noWrap:r,paragraph:c,variant:d,classes:m}=t,s={root:["root",d,t.align!=="inherit"&&`align${Rr(e)}`,n&&"gutterBottom",r&&"noWrap",c&&"paragraph"]};return Fo(s,$W,m)},YW=lr("span",{name:"MuiTypography",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.variant&&e[n.variant],n.align!=="inherit"&&e[`align${Rr(n.align)}`],n.noWrap&&e.noWrap,n.gutterBottom&&e.gutterBottom,n.paragraph&&e.paragraph]}})(zo(({theme:t})=>{var e;return{margin:0,variants:[{props:{variant:"inherit"},style:{font:"inherit",lineHeight:"inherit",letterSpacing:"inherit"}},...Object.entries(t.typography).filter(([n,r])=>n!=="inherit"&&r&&typeof r=="object").map(([n,r])=>({props:{variant:n},style:r})),...Object.entries(t.palette).filter($w()).map(([n])=>({props:{color:n},style:{color:(t.vars||t).palette[n].main}})),...Object.entries(((e=t.palette)==null?void 0:e.text)||{}).filter(([,n])=>typeof n=="string").map(([n])=>({props:{color:`text${Rr(n)}`},style:{color:(t.vars||t).palette.text[n]}})),{props:({ownerState:n})=>n.align!=="inherit",style:{textAlign:"var(--Typography-textAlign)"}},{props:({ownerState:n})=>n.noWrap,style:{overflow:"hidden",textOverflow:"ellipsis",whiteSpace:"nowrap"}},{props:({ownerState:n})=>n.gutterBottom,style:{marginBottom:"0.35em"}},{props:({ownerState:n})=>n.paragraph,style:{marginBottom:16}}]}})),dB={h1:"h1",h2:"h2",h3:"h3",h4:"h4",h5:"h5",h6:"h6",subtitle1:"h6",subtitle2:"h6",body1:"p",body2:"p",inherit:"p"},uo=ke.forwardRef(function(e,n){const{color:r,...c}=Mo({props:e,name:"MuiTypography"}),d=!GW[r],m=qW({...c,...d&&{color:r}}),{align:s="inherit",className:T,component:D,gutterBottom:P=!1,noWrap:z=!1,paragraph:F=!1,variant:$="body1",variantMapping:J=dB,...X}=m,te={...m,align:s,color:r,className:T,component:D,gutterBottom:P,noWrap:z,paragraph:F,variant:$,variantMapping:J},ie=D||(F?"p":J[$]||dB[$])||"span",we=WW(te);return Qn.jsx(YW,{as:ie,ref:n,className:Dr(we.root,T),...X,ownerState:te,style:{...s!=="inherit"&&{"--Typography-textAlign":s},...X.style}})});uo.propTypes={align:G.oneOf(["center","inherit","justify","left","right"]),children:G.node,classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["primary","secondary","success","error","info","warning","textPrimary","textSecondary","textDisabled"]),G.string]),component:G.elementType,gutterBottom:G.bool,noWrap:G.bool,paragraph:G.bool,style:G.object,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),variant:G.oneOfType([G.oneOf(["body1","body2","button","caption","h1","h2","h3","h4","h5","h6","inherit","overline","subtitle1","subtitle2"]),G.string]),variantMapping:G.object};function T_(t,e,n,r,c){const d=t[e],m=c||e;return d==null?null:d&&d.nodeType!==1?new Error(`Invalid ${r} \`${m}\` supplied to \`${n}\`. Expected an HTMLElement.`):null}function ZW(t){return typeof t=="string"}function M5(t,e,n){return t===void 0||ZW(t)?e:{...e,ownerState:{...e.ownerState,...n}}}function P5(t,e=[]){if(t===void 0)return{};const n={};return Object.keys(t).filter(r=>r.match(/^on[A-Z]/)&&typeof t[r]=="function"&&!e.includes(r)).forEach(r=>{n[r]=t[r]}),n}function fB(t){if(t===void 0)return{};const e={};return Object.keys(t).filter(n=>!(n.match(/^on[A-Z]/)&&typeof t[n]=="function")).forEach(n=>{e[n]=t[n]}),e}function k5(t){const{getSlotProps:e,additionalProps:n,externalSlotProps:r,externalForwardedProps:c,className:d}=t;if(!e){const $=Dr(n==null?void 0:n.className,d,c==null?void 0:c.className,r==null?void 0:r.className),J={...n==null?void 0:n.style,...c==null?void 0:c.style,...r==null?void 0:r.style},X={...n,...c,...r};return $.length>0&&(X.className=$),Object.keys(J).length>0&&(X.style=J),{props:X,internalRef:void 0}}const m=P5({...c,...r}),s=fB(r),T=fB(c),D=e(m),P=Dr(D==null?void 0:D.className,n==null?void 0:n.className,d,c==null?void 0:c.className,r==null?void 0:r.className),z={...D==null?void 0:D.style,...n==null?void 0:n.style,...c==null?void 0:c.style,...r==null?void 0:r.style},F={...D,...n,...T,...s};return P.length>0&&(F.className=P),Object.keys(z).length>0&&(F.style=z),{props:F,internalRef:D.ref}}function N5(t,e,n){return typeof t=="function"?t(e,n):t}function L5(t){var z;const{elementType:e,externalSlotProps:n,ownerState:r,skipResolvingSlotProps:c=!1,...d}=t,m=c?{}:N5(n,r),{props:s,internalRef:T}=k5({...d,externalSlotProps:m}),D=xu(T,m==null?void 0:m.ref,(z=t.additionalProps)==null?void 0:z.ref);return M5(e,{...s,ref:D},r)}const gO=ke.createContext({});gO.displayName="ListContext";function XW(t){return wo("MuiList",t)}io("MuiList",["root","padding","dense","subheader"]);const QW=t=>{const{classes:e,disablePadding:n,dense:r,subheader:c}=t;return Fo({root:["root",!n&&"padding",r&&"dense",c&&"subheader"]},XW,e)},KW=lr("ul",{name:"MuiList",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.disablePadding&&e.padding,n.dense&&e.dense,n.subheader&&e.subheader]}})({listStyle:"none",margin:0,padding:0,position:"relative",variants:[{props:({ownerState:t})=>!t.disablePadding,style:{paddingTop:8,paddingBottom:8}},{props:({ownerState:t})=>t.subheader,style:{paddingTop:0}}]}),z5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiList"}),{children:c,className:d,component:m="ul",dense:s=!1,disablePadding:T=!1,subheader:D,...P}=r,z=ke.useMemo(()=>({dense:s}),[s]),F={...r,component:m,dense:s,disablePadding:T},$=QW(F);return Qn.jsx(gO.Provider,{value:z,children:Qn.jsxs(KW,{as:m,className:Dr($.root,d),ref:n,ownerState:F,...P,children:[D,c]})})});z5.propTypes={children:G.node,classes:G.object,className:G.string,component:G.elementType,dense:G.bool,disablePadding:G.bool,subheader:G.node,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};function B5(t=window){const e=t.document.documentElement.clientWidth;return t.innerWidth-e}function gP(t,e,n){return t===e?t.firstChild:e&&e.nextElementSibling?e.nextElementSibling:n?null:t.firstChild}function pB(t,e,n){return t===e?n?t.firstChild:t.lastChild:e&&e.previousElementSibling?e.previousElementSibling:n?null:t.lastChild}function F5(t,e){if(e===void 0)return!0;let n=t.innerText;return n===void 0&&(n=t.textContent),n=n.trim().toLowerCase(),n.length===0?!1:e.repeating?n[0]===e.keys[0]:n.startsWith(e.keys.join(""))}function lS(t,e,n,r,c,d){let m=!1,s=c(t,e,e?n:!1);for(;s;){if(s===t.firstChild){if(m)return!1;m=!0}const T=r?!1:s.disabled||s.getAttribute("aria-disabled")==="true";if(!s.hasAttribute("tabindex")||!F5(s,d)||T)s=c(t,s,n);else return s.focus(),!0}return!1}const V5=ke.forwardRef(function(e,n){const{actions:r,autoFocus:c=!1,autoFocusItem:d=!1,children:m,className:s,disabledItemsFocusable:T=!1,disableListWrap:D=!1,onKeyDown:P,variant:z="selectedMenu",...F}=e,$=ke.useRef(null),J=ke.useRef({keys:[],repeating:!0,previousKeyMatched:!0,lastTime:null});px(()=>{c&&$.current.focus()},[c]),ke.useImperativeHandle(r,()=>({adjustStyleForScrollbar:(Ie,{direction:Re})=>{const Ne=!$.current.style.width;if(Ie.clientHeight<$.current.clientHeight&&Ne){const Xe=`${B5(mx(Ie))}px`;$.current.style[Re==="rtl"?"paddingLeft":"paddingRight"]=Xe,$.current.style.width=`calc(100% + ${Xe})`}return $.current}}),[]);const X=Ie=>{const Re=$.current,Ne=Ie.key;if(Ie.ctrlKey||Ie.metaKey||Ie.altKey){P&&P(Ie);return}const be=tf(Re).activeElement;if(Ne==="ArrowDown")Ie.preventDefault(),lS(Re,be,D,T,gP);else if(Ne==="ArrowUp")Ie.preventDefault(),lS(Re,be,D,T,pB);else if(Ne==="Home")Ie.preventDefault(),lS(Re,null,D,T,gP);else if(Ne==="End")Ie.preventDefault(),lS(Re,null,D,T,pB);else if(Ne.length===1){const _e=J.current,Te=Ne.toLowerCase(),oe=performance.now();_e.keys.length>0&&(oe-_e.lastTime>500?(_e.keys=[],_e.repeating=!0,_e.previousKeyMatched=!0):_e.repeating&&Te!==_e.keys[0]&&(_e.repeating=!1)),_e.lastTime=oe,_e.keys.push(Te);const Ee=be&&!_e.repeating&&F5(be,_e);_e.previousKeyMatched&&(Ee||lS(Re,be,!1,T,gP,_e))?Ie.preventDefault():_e.previousKeyMatched=!1}P&&P(Ie)},te=xu($,n);let ie=-1;ke.Children.forEach(m,(Ie,Re)=>{if(!ke.isValidElement(Ie)){ie===Re&&(ie+=1,ie>=m.length&&(ie=-1));return}hx.isFragment(Ie)&&console.error(["MUI: The Menu component doesn't accept a Fragment as a child.","Consider providing an array instead."].join(`
`)),Ie.props.disabled||(z==="selectedMenu"&&Ie.props.selected||ie===-1)&&(ie=Re),ie===Re&&(Ie.props.disabled||Ie.props.muiSkipListHighlight||Ie.type.muiSkipListHighlight)&&(ie+=1,ie>=m.length&&(ie=-1))});const we=ke.Children.map(m,(Ie,Re)=>{if(Re===ie){const Ne={};return d&&(Ne.autoFocus=!0),Ie.props.tabIndex===void 0&&z==="selectedMenu"&&(Ne.tabIndex=0),ke.cloneElement(Ie,Ne)}return Ie});return Qn.jsx(z5,{role:"menu",ref:te,className:s,onKeyDown:X,tabIndex:c?0:-1,...F,children:we})});V5.propTypes={autoFocus:G.bool,autoFocusItem:G.bool,children:G.node,className:G.string,disabledItemsFocusable:G.bool,disableListWrap:G.bool,onKeyDown:G.func,variant:G.oneOf(["menu","selectedMenu"])};function JW(t){return typeof t=="string"}function eY(t){const{prototype:e={}}=t;return!!e.isReactComponent}function U5(t,e,n,r,c){const d=t[e],m=c||e;if(d==null||typeof window>"u")return null;let s;const T=d.type;return typeof T=="function"&&!eY(T)&&(s="Did you accidentally use a plain function component for an element instead?"),s!==void 0?new Error(`Invalid ${r} \`${m}\` supplied to \`${n}\`. Expected an element that can hold a ref. ${s} For more information see https://mui.com/r/caveat-with-refs-guide`):null}const fT=P_(G.element,U5);fT.isRequired=P_(G.element.isRequired,U5);function LA(t){var e;return parseInt(ke.version,10)>=19?((e=t==null?void 0:t.props)==null?void 0:e.ref)||null:(t==null?void 0:t.ref)||null}const j5=t=>t.scrollTop;function Gw(t,e){const{timeout:n,easing:r,style:c={}}=t;return{duration:c.transitionDuration??(typeof n=="number"?n:n[e.mode]||0),easing:c.transitionTimingFunction??(typeof r=="object"?r[e.mode]:r),delay:c.transitionDelay}}function Ek(t){return`scale(${t}, ${t**2})`}const tY={entering:{opacity:1,transform:Ek(1)},entered:{opacity:1,transform:"none"}},_P=typeof navigator<"u"&&/^((?!chrome|android).)*(safari|mobile)/i.test(navigator.userAgent)&&/(os |version\/)15(.|_)4/i.test(navigator.userAgent),oA=ke.forwardRef(function(e,n){const{addEndListener:r,appear:c=!0,children:d,easing:m,in:s,onEnter:T,onEntered:D,onEntering:P,onExit:z,onExited:F,onExiting:$,style:J,timeout:X="auto",TransitionComponent:te=vp,...ie}=e,we=rx(),Ie=ke.useRef(),Re=PA(),Ne=ke.useRef(null),Xe=xu(Ne,LA(d),n),be=St=>mt=>{if(St){const Ft=Ne.current;mt===void 0?St(Ft):St(Ft,mt)}},_e=be(P),Te=be((St,mt)=>{j5(St);const{duration:Ft,delay:rn,easing:Xt}=Gw({style:J,timeout:X,easing:m},{mode:"enter"});let Fe;X==="auto"?(Fe=Re.transitions.getAutoHeightDuration(St.clientHeight),Ie.current=Fe):Fe=Ft,St.style.transition=[Re.transitions.create("opacity",{duration:Fe,delay:rn}),Re.transitions.create("transform",{duration:_P?Fe:Fe*.666,delay:rn,easing:Xt})].join(","),T&&T(St,mt)}),oe=be(D),Ee=be($),$e=be(St=>{const{duration:mt,delay:Ft,easing:rn}=Gw({style:J,timeout:X,easing:m},{mode:"exit"});let Xt;X==="auto"?(Xt=Re.transitions.getAutoHeightDuration(St.clientHeight),Ie.current=Xt):Xt=mt,St.style.transition=[Re.transitions.create("opacity",{duration:Xt,delay:Ft}),Re.transitions.create("transform",{duration:_P?Xt:Xt*.666,delay:_P?Ft:Ft||Xt*.333,easing:rn})].join(","),St.style.opacity=0,St.style.transform=Ek(.75),z&&z(St)}),ze=be(F),zt=St=>{X==="auto"&&we.start(Ie.current||0,St),r&&r(Ne.current,St)};return Qn.jsx(te,{appear:c,in:s,nodeRef:Ne,onEnter:Te,onEntered:oe,onEntering:_e,onExit:$e,onExited:ze,onExiting:Ee,addEndListener:zt,timeout:X==="auto"?null:X,...ie,children:(St,{ownerState:mt,...Ft})=>ke.cloneElement(d,{style:{opacity:0,transform:Ek(.75),visibility:St==="exited"&&!s?"hidden":void 0,...tY[St],...J,...d.props.style},ref:Xe,...Ft})})});oA.propTypes={addEndListener:G.func,appear:G.bool,children:fT.isRequired,easing:G.oneOfType([G.shape({enter:G.string,exit:G.string}),G.string]),in:G.bool,onEnter:G.func,onEntered:G.func,onEntering:G.func,onExit:G.func,onExited:G.func,onExiting:G.func,style:G.object,timeout:G.oneOfType([G.oneOf(["auto"]),G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})])};oA&&(oA.muiSupportAuto=!0);function nY(t){const e=tf(t);return e.body===t?mx(t).innerWidth>e.documentElement.clientWidth:t.scrollHeight>t.clientHeight}function zS(t,e){e?t.setAttribute("aria-hidden","true"):t.removeAttribute("aria-hidden")}function mB(t){return parseInt(mx(t).getComputedStyle(t).paddingRight,10)||0}function iY(t){const n=["TEMPLATE","SCRIPT","STYLE","LINK","MAP","META","NOSCRIPT","PICTURE","COL","COLGROUP","PARAM","SLOT","SOURCE","TRACK"].includes(t.tagName),r=t.tagName==="INPUT"&&t.getAttribute("type")==="hidden";return n||r}function gB(t,e,n,r,c){const d=[e,n,...r];[].forEach.call(t.children,m=>{const s=!d.includes(m),T=!iY(m);s&&T&&zS(m,c)})}function yP(t,e){let n=-1;return t.some((r,c)=>e(r)?(n=c,!0):!1),n}function rY(t,e){const n=[],r=t.container;if(!e.disableScrollLock){if(nY(r)){const m=B5(mx(r));n.push({value:r.style.paddingRight,property:"padding-right",el:r}),r.style.paddingRight=`${mB(r)+m}px`;const s=tf(r).querySelectorAll(".mui-fixed");[].forEach.call(s,T=>{n.push({value:T.style.paddingRight,property:"padding-right",el:T}),T.style.paddingRight=`${mB(T)+m}px`})}let d;if(r.parentNode instanceof DocumentFragment)d=tf(r).body;else{const m=r.parentElement,s=mx(r);d=(m==null?void 0:m.nodeName)==="HTML"&&s.getComputedStyle(m).overflowY==="scroll"?m:r}n.push({value:d.style.overflow,property:"overflow",el:d},{value:d.style.overflowX,property:"overflow-x",el:d},{value:d.style.overflowY,property:"overflow-y",el:d}),d.style.overflow="hidden"}return()=>{n.forEach(({value:d,el:m,property:s})=>{d?m.style.setProperty(s,d):m.style.removeProperty(s)})}}function sY(t){const e=[];return[].forEach.call(t.children,n=>{n.getAttribute("aria-hidden")==="true"&&e.push(n)}),e}class oY{constructor(){this.modals=[],this.containers=[]}add(e,n){let r=this.modals.indexOf(e);if(r!==-1)return r;r=this.modals.length,this.modals.push(e),e.modalRef&&zS(e.modalRef,!1);const c=sY(n);gB(n,e.mount,e.modalRef,c,!0);const d=yP(this.containers,m=>m.container===n);return d!==-1?(this.containers[d].modals.push(e),r):(this.containers.push({modals:[e],container:n,restore:null,hiddenSiblings:c}),r)}mount(e,n){const r=yP(this.containers,d=>d.modals.includes(e)),c=this.containers[r];c.restore||(c.restore=rY(c,n))}remove(e,n=!0){const r=this.modals.indexOf(e);if(r===-1)return r;const c=yP(this.containers,m=>m.modals.includes(e)),d=this.containers[c];if(d.modals.splice(d.modals.indexOf(e),1),this.modals.splice(r,1),d.modals.length===0)d.restore&&d.restore(),e.modalRef&&zS(e.modalRef,n),gB(d.container,e.mount,e.modalRef,d.hiddenSiblings,!1),this.containers.splice(c,1);else{const m=d.modals[d.modals.length-1];m.modalRef&&zS(m.modalRef,!1)}return r}isTopModal(e){return this.modals.length>0&&this.modals[this.modals.length-1]===e}}const aY=["input","select","textarea","a[href]","button","[tabindex]","audio[controls]","video[controls]",'[contenteditable]:not([contenteditable="false"])'].join(",");function lY(t){const e=parseInt(t.getAttribute("tabindex")||"",10);return Number.isNaN(e)?t.contentEditable==="true"||(t.nodeName==="AUDIO"||t.nodeName==="VIDEO"||t.nodeName==="DETAILS")&&t.getAttribute("tabindex")===null?0:t.tabIndex:e}function cY(t){if(t.tagName!=="INPUT"||t.type!=="radio"||!t.name)return!1;const e=r=>t.ownerDocument.querySelector(`input[type="radio"]${r}`);let n=e(`[name="${t.name}"]:checked`);return n||(n=e(`[name="${t.name}"]`)),n!==t}function uY(t){return!(t.disabled||t.tagName==="INPUT"&&t.type==="hidden"||cY(t))}function hY(t){const e=[],n=[];return Array.from(t.querySelectorAll(aY)).forEach((r,c)=>{const d=lY(r);d===-1||!uY(r)||(d===0?e.push(r):n.push({documentOrder:c,tabIndex:d,node:r}))}),n.sort((r,c)=>r.tabIndex===c.tabIndex?r.documentOrder-c.documentOrder:r.tabIndex-c.tabIndex).map(r=>r.node).concat(e)}function dY(){return!0}function _O(t){const{children:e,disableAutoFocus:n=!1,disableEnforceFocus:r=!1,disableRestoreFocus:c=!1,getTabbable:d=hY,isEnabled:m=dY,open:s}=t,T=ke.useRef(!1),D=ke.useRef(null),P=ke.useRef(null),z=ke.useRef(null),F=ke.useRef(null),$=ke.useRef(!1),J=ke.useRef(null),X=xu(LA(e),J),te=ke.useRef(null);ke.useEffect(()=>{!s||!J.current||($.current=!n)},[n,s]),ke.useEffect(()=>{if(!s||!J.current)return;const Ie=tf(J.current);return J.current.contains(Ie.activeElement)||(J.current.hasAttribute("tabIndex")||(console.error(["MUI: The modal content node does not accept focus.",'For the benefit of assistive technologies, the tabIndex of the node is being set to "-1".'].join(`
`)),J.current.setAttribute("tabIndex","-1")),$.current&&J.current.focus()),()=>{c||(z.current&&z.current.focus&&(T.current=!0,z.current.focus()),z.current=null)}},[s]),ke.useEffect(()=>{if(!s||!J.current)return;const Ie=tf(J.current),Re=be=>{te.current=be,!(r||!m()||be.key!=="Tab")&&Ie.activeElement===J.current&&be.shiftKey&&(T.current=!0,P.current&&P.current.focus())},Ne=()=>{var Te,oe;const be=J.current;if(be===null)return;if(!Ie.hasFocus()||!m()||T.current){T.current=!1;return}if(be.contains(Ie.activeElement)||r&&Ie.activeElement!==D.current&&Ie.activeElement!==P.current)return;if(Ie.activeElement!==F.current)F.current=null;else if(F.current!==null)return;if(!$.current)return;let _e=[];if((Ie.activeElement===D.current||Ie.activeElement===P.current)&&(_e=d(J.current)),_e.length>0){const Ee=!!((Te=te.current)!=null&&Te.shiftKey&&((oe=te.current)==null?void 0:oe.key)==="Tab"),$e=_e[0],ze=_e[_e.length-1];typeof $e!="string"&&typeof ze!="string"&&(Ee?ze.focus():$e.focus())}else be.focus()};Ie.addEventListener("focusin",Ne),Ie.addEventListener("keydown",Re,!0);const Xe=setInterval(()=>{Ie.activeElement&&Ie.activeElement.tagName==="BODY"&&Ne()},50);return()=>{clearInterval(Xe),Ie.removeEventListener("focusin",Ne),Ie.removeEventListener("keydown",Re,!0)}},[n,r,c,m,s,d]);const ie=Ie=>{z.current===null&&(z.current=Ie.relatedTarget),$.current=!0,F.current=Ie.target;const Re=e.props.onFocus;Re&&Re(Ie)},we=Ie=>{z.current===null&&(z.current=Ie.relatedTarget),$.current=!0};return Qn.jsxs(ke.Fragment,{children:[Qn.jsx("div",{tabIndex:s?0:-1,onFocus:we,ref:D,"data-testid":"sentinelStart"}),ke.cloneElement(e,{ref:X,onFocus:ie}),Qn.jsx("div",{tabIndex:s?0:-1,onFocus:we,ref:P,"data-testid":"sentinelEnd"})]})}_O.propTypes={children:fT,disableAutoFocus:G.bool,disableEnforceFocus:G.bool,disableRestoreFocus:G.bool,getTabbable:G.func,isEnabled:G.func,open:G.bool.isRequired};_O.propTypes=d5(_O.propTypes);function fY(t){return typeof t=="function"?t():t}const aA=ke.forwardRef(function(e,n){const{children:r,container:c,disablePortal:d=!1}=e,[m,s]=ke.useState(null),T=xu(ke.isValidElement(r)?LA(r):null,n);if(px(()=>{d||s(fY(c)||document.body)},[c,d]),px(()=>{if(m&&!d)return oB(n,m),()=>{oB(n,null)}},[n,m,d]),d){if(ke.isValidElement(r)){const D={ref:T};return ke.cloneElement(r,D)}return r}return m&&sA.createPortal(r,m)});aA.propTypes={children:G.node,container:G.oneOfType([T_,G.func]),disablePortal:G.bool};aA.propTypes=d5(aA.propTypes);function ta(t,e){const{className:n,elementType:r,ownerState:c,externalForwardedProps:d,internalForwardedProps:m,shouldForwardComponentProp:s=!1,...T}=e,{component:D,slots:P={[t]:void 0},slotProps:z={[t]:void 0},...F}=d,$=P[t]||r,J=N5(z[t],c),{props:{component:X,...te},internalRef:ie}=k5({className:n,...T,externalForwardedProps:t==="root"?F:void 0,externalSlotProps:J}),we=xu(ie,J==null?void 0:J.ref,e.ref),Ie=t==="root"?X||D:X,Re=M5($,{...t==="root"&&!D&&!P[t]&&m,...t!=="root"&&!P[t]&&m,...te,...Ie&&!s&&{as:Ie},...Ie&&s&&{component:Ie},ref:we},c);return[$,Re]}const pY={entering:{opacity:1},entered:{opacity:1}},H5=ke.forwardRef(function(e,n){const r=PA(),c={enter:r.transitions.duration.enteringScreen,exit:r.transitions.duration.leavingScreen},{addEndListener:d,appear:m=!0,children:s,easing:T,in:D,onEnter:P,onEntered:z,onEntering:F,onExit:$,onExited:J,onExiting:X,style:te,timeout:ie=c,TransitionComponent:we=vp,...Ie}=e,Re=ke.useRef(null),Ne=xu(Re,LA(s),n),Xe=zt=>St=>{if(zt){const mt=Re.current;St===void 0?zt(mt):zt(mt,St)}},be=Xe(F),_e=Xe((zt,St)=>{j5(zt);const mt=Gw({style:te,timeout:ie,easing:T},{mode:"enter"});zt.style.webkitTransition=r.transitions.create("opacity",mt),zt.style.transition=r.transitions.create("opacity",mt),P&&P(zt,St)}),Te=Xe(z),oe=Xe(X),Ee=Xe(zt=>{const St=Gw({style:te,timeout:ie,easing:T},{mode:"exit"});zt.style.webkitTransition=r.transitions.create("opacity",St),zt.style.transition=r.transitions.create("opacity",St),$&&$(zt)}),$e=Xe(J),ze=zt=>{d&&d(Re.current,zt)};return Qn.jsx(we,{appear:m,in:D,nodeRef:Re,onEnter:_e,onEntered:Te,onEntering:be,onExit:Ee,onExited:$e,onExiting:oe,addEndListener:ze,timeout:ie,...Ie,children:(zt,{ownerState:St,...mt})=>ke.cloneElement(s,{style:{opacity:0,visibility:zt==="exited"&&!D?"hidden":void 0,...pY[zt],...te,...s.props.style},ref:Ne,...mt})})});H5.propTypes={addEndListener:G.func,appear:G.bool,children:fT.isRequired,easing:G.oneOfType([G.shape({enter:G.string,exit:G.string}),G.string]),in:G.bool,onEnter:G.func,onEntered:G.func,onEntering:G.func,onExit:G.func,onExited:G.func,onExiting:G.func,style:G.object,timeout:G.oneOfType([G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})])};function mY(t){return wo("MuiBackdrop",t)}io("MuiBackdrop",["root","invisible"]);const gY=t=>{const{classes:e,invisible:n}=t;return Fo({root:["root",n&&"invisible"]},mY,e)},_Y=lr("div",{name:"MuiBackdrop",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,n.invisible&&e.invisible]}})({position:"fixed",display:"flex",alignItems:"center",justifyContent:"center",right:0,bottom:0,top:0,left:0,backgroundColor:"rgba(0, 0, 0, 0.5)",WebkitTapHighlightColor:"transparent",variants:[{props:{invisible:!0},style:{backgroundColor:"transparent"}}]}),$5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiBackdrop"}),{children:c,className:d,component:m="div",invisible:s=!1,open:T,components:D={},componentsProps:P={},slotProps:z={},slots:F={},TransitionComponent:$,transitionDuration:J,...X}=r,te={...r,component:m,invisible:s},ie=gY(te),we={transition:$,root:D.Root,...F},Ie={...P,...z},Re={slots:we,slotProps:Ie},[Ne,Xe]=ta("root",{elementType:_Y,externalForwardedProps:Re,className:Dr(ie.root,d),ownerState:te}),[be,_e]=ta("transition",{elementType:H5,externalForwardedProps:Re,ownerState:te});return Qn.jsx(be,{in:T,timeout:J,...X,..._e,children:Qn.jsx(Ne,{"aria-hidden":!0,...Xe,classes:ie,ref:n,children:c})})});$5.propTypes={children:G.node,classes:G.object,className:G.string,component:G.elementType,components:G.shape({Root:G.elementType}),componentsProps:G.shape({root:G.object}),invisible:G.bool,open:G.bool.isRequired,slotProps:G.shape({root:G.oneOfType([G.func,G.object]),transition:G.oneOfType([G.func,G.object])}),slots:G.shape({root:G.elementType,transition:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),TransitionComponent:G.elementType,transitionDuration:G.oneOfType([G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})])};function yY(t){return typeof t=="function"?t():t}function vY(t){return t?t.props.hasOwnProperty("in"):!1}const _B=()=>{},QD=new oY;function bY(t){const{container:e,disableEscapeKeyDown:n=!1,disableScrollLock:r=!1,closeAfterTransition:c=!1,onTransitionEnter:d,onTransitionExited:m,children:s,onClose:T,open:D,rootRef:P}=t,z=ke.useRef({}),F=ke.useRef(null),$=ke.useRef(null),J=xu($,P),[X,te]=ke.useState(!D),ie=vY(s);let we=!0;(t["aria-hidden"]==="false"||t["aria-hidden"]===!1)&&(we=!1);const Ie=()=>tf(F.current),Re=()=>(z.current.modalRef=$.current,z.current.mount=F.current,z.current),Ne=()=>{QD.mount(Re(),{disableScrollLock:r}),$.current&&($.current.scrollTop=0)},Xe=Fv(()=>{const St=yY(e)||Ie().body;QD.add(Re(),St),$.current&&Ne()}),be=()=>QD.isTopModal(Re()),_e=Fv(St=>{F.current=St,St&&(D&&be()?Ne():$.current&&zS($.current,we))}),Te=ke.useCallback(()=>{QD.remove(Re(),we)},[we]);ke.useEffect(()=>()=>{Te()},[Te]),ke.useEffect(()=>{D?Xe():(!ie||!c)&&Te()},[D,Te,ie,c,Xe]);const oe=St=>mt=>{var Ft;(Ft=St.onKeyDown)==null||Ft.call(St,mt),!(mt.key!=="Escape"||mt.which===229||!be())&&(n||(mt.stopPropagation(),T&&T(mt,"escapeKeyDown")))},Ee=St=>mt=>{var Ft;(Ft=St.onClick)==null||Ft.call(St,mt),mt.target===mt.currentTarget&&T&&T(mt,"backdropClick")};return{getRootProps:(St={})=>{const mt=P5(t);delete mt.onTransitionEnter,delete mt.onTransitionExited;const Ft={...mt,...St};return{role:"presentation",...Ft,onKeyDown:oe(Ft),ref:J}},getBackdropProps:(St={})=>{const mt=St;return{"aria-hidden":!0,...mt,onClick:Ee(mt),open:D}},getTransitionProps:()=>{const St=()=>{te(!1),d&&d()},mt=()=>{te(!0),m&&m(),c&&Te()};return{onEnter:sB(St,(s==null?void 0:s.props.onEnter)??_B),onExited:sB(mt,(s==null?void 0:s.props.onExited)??_B)}},rootRef:J,portalRef:_e,isTopModal:be,exited:X,hasTransition:ie}}function xY(t){return wo("MuiModal",t)}io("MuiModal",["root","hidden","backdrop"]);const wY=t=>{const{open:e,exited:n,classes:r}=t;return Fo({root:["root",!e&&n&&"hidden"],backdrop:["backdrop"]},xY,r)},TY=lr("div",{name:"MuiModal",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,!n.open&&n.exited&&e.hidden]}})(zo(({theme:t})=>({position:"fixed",zIndex:(t.vars||t).zIndex.modal,right:0,bottom:0,top:0,left:0,variants:[{props:({ownerState:e})=>!e.open&&e.exited,style:{visibility:"hidden"}}]}))),EY=lr($5,{name:"MuiModal",slot:"Backdrop"})({zIndex:-1}),G5=ke.forwardRef(function(e,n){const r=Mo({name:"MuiModal",props:e}),{BackdropComponent:c=EY,BackdropProps:d,classes:m,className:s,closeAfterTransition:T=!1,children:D,container:P,component:z,components:F={},componentsProps:$={},disableAutoFocus:J=!1,disableEnforceFocus:X=!1,disableEscapeKeyDown:te=!1,disablePortal:ie=!1,disableRestoreFocus:we=!1,disableScrollLock:Ie=!1,hideBackdrop:Re=!1,keepMounted:Ne=!1,onClose:Xe,onTransitionEnter:be,onTransitionExited:_e,open:Te,slotProps:oe={},slots:Ee={},theme:$e,...ze}=r,zt={...r,closeAfterTransition:T,disableAutoFocus:J,disableEnforceFocus:X,disableEscapeKeyDown:te,disablePortal:ie,disableRestoreFocus:we,disableScrollLock:Ie,hideBackdrop:Re,keepMounted:Ne},{getRootProps:St,getBackdropProps:mt,getTransitionProps:Ft,portalRef:rn,isTopModal:Xt,exited:Fe,hasTransition:Ot}=bY({...zt,rootRef:n}),Ut={...zt,exited:Fe},ln=wY(Ut),wn={};if(D.props.tabIndex===void 0&&(wn.tabIndex="-1"),Ot){const{onEnter:Cn,onExited:Kn}=Ft();wn.onEnter=Cn,wn.onExited=Kn}const dn={slots:{root:F.Root,backdrop:F.Backdrop,...Ee},slotProps:{...$,...oe}},[Ht,Mn]=ta("root",{ref:n,elementType:TY,externalForwardedProps:{...dn,...ze,component:z},getSlotProps:St,ownerState:Ut,className:Dr(s,ln==null?void 0:ln.root,!Ut.open&&Ut.exited&&(ln==null?void 0:ln.hidden))}),[yn,Tn]=ta("backdrop",{ref:d==null?void 0:d.ref,elementType:c,externalForwardedProps:dn,shouldForwardComponentProp:!0,additionalProps:d,getSlotProps:Cn=>mt({...Cn,onClick:Kn=>{Cn!=null&&Cn.onClick&&Cn.onClick(Kn)}}),className:Dr(d==null?void 0:d.className,ln==null?void 0:ln.backdrop),ownerState:Ut});return!Ne&&!Te&&(!Ot||Fe)?null:Qn.jsx(aA,{ref:rn,container:P,disablePortal:ie,children:Qn.jsxs(Ht,{...Mn,children:[!Re&&c?Qn.jsx(yn,{...Tn}):null,Qn.jsx(_O,{disableEnforceFocus:X,disableAutoFocus:J,disableRestoreFocus:we,isEnabled:Xt,open:Te,children:ke.cloneElement(D,wn)})]})})});G5.propTypes={BackdropComponent:G.elementType,BackdropProps:G.object,children:fT.isRequired,classes:G.object,className:G.string,closeAfterTransition:G.bool,component:G.elementType,components:G.shape({Backdrop:G.elementType,Root:G.elementType}),componentsProps:G.shape({backdrop:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object])}),container:G.oneOfType([T_,G.func]),disableAutoFocus:G.bool,disableEnforceFocus:G.bool,disableEscapeKeyDown:G.bool,disablePortal:G.bool,disableRestoreFocus:G.bool,disableScrollLock:G.bool,hideBackdrop:G.bool,keepMounted:G.bool,onClose:G.func,onTransitionEnter:G.func,onTransitionExited:G.func,open:G.bool.isRequired,slotProps:G.shape({backdrop:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object])}),slots:G.shape({backdrop:G.elementType,root:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};function SY(t){return wo("MuiPopover",t)}io("MuiPopover",["root","paper"]);function yB(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.height/2:e==="bottom"&&(n=t.height),n}function vB(t,e){let n=0;return typeof e=="number"?n=e:e==="center"?n=t.width/2:e==="right"&&(n=t.width),n}function bB(t){return[t.horizontal,t.vertical].map(e=>typeof e=="number"?`${e}px`:e).join(" ")}function ES(t){return typeof t=="function"?t():t}const AY=t=>{const{classes:e}=t;return Fo({root:["root"],paper:["paper"]},SY,e)},CY=lr(G5,{name:"MuiPopover",slot:"Root"})({}),q5=lr(II,{name:"MuiPopover",slot:"Paper"})({position:"absolute",overflowY:"auto",overflowX:"hidden",minWidth:16,minHeight:16,maxWidth:"calc(100% - 32px)",maxHeight:"calc(100% - 32px)",outline:0}),W5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiPopover"}),{action:c,anchorEl:d,anchorOrigin:m={vertical:"top",horizontal:"left"},anchorPosition:s,anchorReference:T="anchorEl",children:D,className:P,container:z,elevation:F=8,marginThreshold:$=16,open:J,PaperProps:X={},slots:te={},slotProps:ie={},transformOrigin:we={vertical:"top",horizontal:"left"},TransitionComponent:Ie,transitionDuration:Re="auto",TransitionProps:Ne={},disableScrollLock:Xe=!1,...be}=r,_e=ke.useRef(),Te={...r,anchorOrigin:m,anchorReference:T,elevation:F,marginThreshold:$,transformOrigin:we,TransitionComponent:Ie,transitionDuration:Re,TransitionProps:Ne},oe=AY(Te),Ee=ke.useCallback(()=>{if(T==="anchorPosition")return s||console.error('MUI: You need to provide a `anchorPosition` prop when using <Popover anchorReference="anchorPosition" />.'),s;const Cn=ES(d),Kn=Cn&&Cn.nodeType===1?Cn:tf(_e.current).body,Bt=Kn.getBoundingClientRect();{const ni=Kn.getBoundingClientRect();ni.top===0&&ni.left===0&&ni.right===0&&ni.bottom===0&&console.warn(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join(`
`))}return{top:Bt.top+yB(Bt,m.vertical),left:Bt.left+vB(Bt,m.horizontal)}},[d,m.horizontal,m.vertical,s,T]),$e=ke.useCallback(Cn=>({vertical:yB(Cn,we.vertical),horizontal:vB(Cn,we.horizontal)}),[we.horizontal,we.vertical]),ze=ke.useCallback(Cn=>{const Kn={width:Cn.offsetWidth,height:Cn.offsetHeight},Bt=$e(Kn);if(T==="none")return{top:null,left:null,transformOrigin:bB(Bt)};const ni=Ee();let er=ni.top-Bt.vertical,_r=ni.left-Bt.horizontal;const Li=er+Kn.height,jr=_r+Kn.width,ss=mx(ES(d)),Nr=ss.innerHeight-$,ti=ss.innerWidth-$;if($!==null&&er<$){const dr=er-$;er-=dr,Bt.vertical+=dr}else if($!==null&&Li>Nr){const dr=Li-Nr;er-=dr,Bt.vertical+=dr}if(Kn.height>Nr&&Kn.height&&Nr&&console.error(["MUI: The popover component is too tall.",`Some part of it can not be seen on the screen (${Kn.height-Nr}px).`,"Please consider adding a `max-height` to improve the user-experience."].join(`
`)),$!==null&&_r<$){const dr=_r-$;_r-=dr,Bt.horizontal+=dr}else if(jr>ti){const dr=jr-ti;_r-=dr,Bt.horizontal+=dr}return{top:`${Math.round(er)}px`,left:`${Math.round(_r)}px`,transformOrigin:bB(Bt)}},[d,T,Ee,$e,$]),[zt,St]=ke.useState(J),mt=ke.useCallback(()=>{const Cn=_e.current;if(!Cn)return;const Kn=ze(Cn);Kn.top!==null&&Cn.style.setProperty("top",Kn.top),Kn.left!==null&&(Cn.style.left=Kn.left),Cn.style.transformOrigin=Kn.transformOrigin,St(!0)},[ze]);ke.useEffect(()=>(Xe&&window.addEventListener("scroll",mt),()=>window.removeEventListener("scroll",mt)),[d,Xe,mt]);const Ft=()=>{mt()},rn=()=>{St(!1)};ke.useEffect(()=>{J&&mt()}),ke.useImperativeHandle(c,()=>J?{updatePosition:()=>{mt()}}:null,[J,mt]),ke.useEffect(()=>{if(!J)return;const Cn=rW(()=>{mt()}),Kn=mx(ES(d));return Kn.addEventListener("resize",Cn),()=>{Cn.clear(),Kn.removeEventListener("resize",Cn)}},[d,J,mt]);let Xt=Re;const Fe={slots:{transition:Ie,...te},slotProps:{transition:Ne,paper:X,...ie}},[Ot,Ut]=ta("transition",{elementType:oA,externalForwardedProps:Fe,ownerState:Te,getSlotProps:Cn=>({...Cn,onEntering:(Kn,Bt)=>{var ni;(ni=Cn.onEntering)==null||ni.call(Cn,Kn,Bt),Ft()},onExited:Kn=>{var Bt;(Bt=Cn.onExited)==null||Bt.call(Cn,Kn),rn()}}),additionalProps:{appear:!0,in:J}});Re==="auto"&&!Ot.muiSupportAuto&&(Xt=void 0);const ln=z||(d?tf(ES(d)).body:void 0),[wn,{slots:dn,slotProps:Ht,...Mn}]=ta("root",{ref:n,elementType:CY,externalForwardedProps:{...Fe,...be},shouldForwardComponentProp:!0,additionalProps:{slots:{backdrop:te.backdrop},slotProps:{backdrop:lW(typeof ie.backdrop=="function"?ie.backdrop(Te):ie.backdrop,{invisible:!0})},container:ln,open:J},ownerState:Te,className:Dr(oe.root,P)}),[yn,Tn]=ta("paper",{ref:_e,className:oe.paper,elementType:q5,externalForwardedProps:Fe,shouldForwardComponentProp:!0,additionalProps:{elevation:F,style:zt?void 0:{opacity:0}},ownerState:Te});return Qn.jsx(wn,{...Mn,...!JW(wn)&&{slots:dn,slotProps:Ht,disableScrollLock:Xe},children:Qn.jsx(Ot,{...Ut,timeout:Xt,children:Qn.jsx(yn,{...Tn,children:D})})})});W5.propTypes={action:MI,anchorEl:P_(G.oneOfType([T_,G.func]),t=>{if(t.open&&(!t.anchorReference||t.anchorReference==="anchorEl")){const e=ES(t.anchorEl);if(e&&e.nodeType===1){const n=e.getBoundingClientRect();if(n.top===0&&n.left===0&&n.right===0&&n.bottom===0)return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join(`
`))}else return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.",`It should be an Element or PopoverVirtualElement instance but it's \`${e}\` instead.`].join(`
`))}return null}),anchorOrigin:G.shape({horizontal:G.oneOfType([G.oneOf(["center","left","right"]),G.number]).isRequired,vertical:G.oneOfType([G.oneOf(["bottom","center","top"]),G.number]).isRequired}),anchorPosition:G.shape({left:G.number.isRequired,top:G.number.isRequired}),anchorReference:G.oneOf(["anchorEl","anchorPosition","none"]),BackdropComponent:G.elementType,BackdropProps:G.object,children:G.node,classes:G.object,className:G.string,container:G.oneOfType([T_,G.func]),disableScrollLock:G.bool,elevation:T5,marginThreshold:G.number,onClose:G.func,open:G.bool.isRequired,PaperProps:G.shape({component:XN}),slotProps:G.shape({backdrop:G.oneOfType([G.func,G.object]),paper:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object]),transition:G.oneOfType([G.func,G.object])}),slots:G.shape({backdrop:G.elementType,paper:G.elementType,root:G.elementType,transition:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),transformOrigin:G.shape({horizontal:G.oneOfType([G.oneOf(["center","left","right"]),G.number]).isRequired,vertical:G.oneOfType([G.oneOf(["bottom","center","top"]),G.number]).isRequired}),TransitionComponent:G.elementType,transitionDuration:G.oneOfType([G.oneOf(["auto"]),G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})]),TransitionProps:G.object};function DY(t){return wo("MuiMenu",t)}io("MuiMenu",["root","paper","list"]);const RY={vertical:"top",horizontal:"right"},OY={vertical:"top",horizontal:"left"},IY=t=>{const{classes:e}=t;return Fo({root:["root"],paper:["paper"],list:["list"]},DY,e)},MY=lr(W5,{shouldForwardProp:t=>OI(t)||t==="classes",name:"MuiMenu",slot:"Root"})({}),PY=lr(q5,{name:"MuiMenu",slot:"Paper"})({maxHeight:"calc(100% - 96px)",WebkitOverflowScrolling:"touch"}),kY=lr(V5,{name:"MuiMenu",slot:"List"})({outline:0}),Sk=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiMenu"}),{autoFocus:c=!0,children:d,className:m,disableAutoFocusItem:s=!1,MenuListProps:T={},onClose:D,open:P,PaperProps:z={},PopoverClasses:F,transitionDuration:$="auto",TransitionProps:{onEntering:J,...X}={},variant:te="selectedMenu",slots:ie={},slotProps:we={},...Ie}=r,Re=qN(),Ne={...r,autoFocus:c,disableAutoFocusItem:s,MenuListProps:T,onEntering:J,PaperProps:z,transitionDuration:$,TransitionProps:X,variant:te},Xe=IY(Ne),be=c&&!s&&P,_e=ke.useRef(null),Te=(Xt,Fe)=>{_e.current&&_e.current.adjustStyleForScrollbar(Xt,{direction:Re?"rtl":"ltr"}),J&&J(Xt,Fe)},oe=Xt=>{Xt.key==="Tab"&&(Xt.preventDefault(),D&&D(Xt,"tabKeyDown"))};let Ee=-1;ke.Children.map(d,(Xt,Fe)=>{ke.isValidElement(Xt)&&(hx.isFragment(Xt)&&console.error(["MUI: The Menu component doesn't accept a Fragment as a child.","Consider providing an array instead."].join(`
`)),Xt.props.disabled||(te==="selectedMenu"&&Xt.props.selected||Ee===-1)&&(Ee=Fe))});const $e={slots:ie,slotProps:{list:T,transition:X,paper:z,...we}},ze=L5({elementType:ie.root,externalSlotProps:we.root,ownerState:Ne,className:[Xe.root,m]}),[zt,St]=ta("paper",{className:Xe.paper,elementType:PY,externalForwardedProps:$e,shouldForwardComponentProp:!0,ownerState:Ne}),[mt,Ft]=ta("list",{className:Dr(Xe.list,T.className),elementType:kY,shouldForwardComponentProp:!0,externalForwardedProps:$e,getSlotProps:Xt=>({...Xt,onKeyDown:Fe=>{var Ot;oe(Fe),(Ot=Xt.onKeyDown)==null||Ot.call(Xt,Fe)}}),ownerState:Ne}),rn=typeof $e.slotProps.transition=="function"?$e.slotProps.transition(Ne):$e.slotProps.transition;return Qn.jsx(MY,{onClose:D,anchorOrigin:{vertical:"bottom",horizontal:Re?"right":"left"},transformOrigin:Re?RY:OY,slots:{root:ie.root,paper:zt,backdrop:ie.backdrop,...ie.transition&&{transition:ie.transition}},slotProps:{root:ze,paper:St,backdrop:typeof we.backdrop=="function"?we.backdrop(Ne):we.backdrop,transition:{...rn,onEntering:(...Xt)=>{var Fe;Te(...Xt),(Fe=rn==null?void 0:rn.onEntering)==null||Fe.call(rn,...Xt)}}},open:P,ref:n,transitionDuration:$,ownerState:Ne,...Ie,classes:F,children:Qn.jsx(mt,{actions:_e,autoFocus:c&&(Ee===-1||s),autoFocusItem:be,variant:te,...Ft,children:d})})});Sk.propTypes={anchorEl:G.oneOfType([T_,G.func]),autoFocus:G.bool,children:G.node,classes:G.object,className:G.string,disableAutoFocusItem:G.bool,MenuListProps:G.object,onClose:G.func,open:G.bool.isRequired,PaperProps:G.object,PopoverClasses:G.object,slotProps:G.shape({backdrop:G.oneOfType([G.func,G.object]),list:G.oneOfType([G.func,G.object]),paper:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object]),transition:G.oneOfType([G.func,G.object])}),slots:G.shape({backdrop:G.elementType,list:G.elementType,paper:G.elementType,root:G.elementType,transition:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),transitionDuration:G.oneOfType([G.oneOf(["auto"]),G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})]),TransitionProps:G.object,variant:G.oneOf(["menu","selectedMenu"])};const NY=kA(Qn.jsx("path",{d:"M3 18h18v-2H3zm0-5h18v-2H3zm0-7v2h18V6z"}),"Menu"),Y5=l7({createStyledComponent:lr("div",{name:"MuiContainer",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[`maxWidth${Rr(String(n.maxWidth))}`],n.fixed&&e.fixed,n.disableGutters&&e.disableGutters]}}),useThemeProps:t=>Mo({props:t,name:"MuiContainer"})});Y5.propTypes={children:G.node,classes:G.object,component:G.elementType,disableGutters:G.bool,fixed:G.bool,maxWidth:G.oneOfType([G.oneOf(["xs","sm","md","lg","xl",!1]),G.string]),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};const LY=kA(Qn.jsx("path",{d:"M12 12c2.21 0 4-1.79 4-4s-1.79-4-4-4-4 1.79-4 4 1.79 4 4 4zm0 2c-2.67 0-8 1.34-8 4v2h16v-2c0-2.66-5.33-4-8-4z"}),"Person");function zY(t){return wo("MuiAvatar",t)}io("MuiAvatar",["root","colorDefault","circular","rounded","square","img","fallback"]);const BY=t=>{const{classes:e,variant:n,colorDefault:r}=t;return Fo({root:["root",n,r&&"colorDefault"],img:["img"],fallback:["fallback"]},zY,e)},FY=lr("div",{name:"MuiAvatar",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],n.colorDefault&&e.colorDefault]}})(zo(({theme:t})=>({position:"relative",display:"flex",alignItems:"center",justifyContent:"center",flexShrink:0,width:40,height:40,fontFamily:t.typography.fontFamily,fontSize:t.typography.pxToRem(20),lineHeight:1,borderRadius:"50%",overflow:"hidden",userSelect:"none",variants:[{props:{variant:"rounded"},style:{borderRadius:(t.vars||t).shape.borderRadius}},{props:{variant:"square"},style:{borderRadius:0}},{props:{colorDefault:!0},style:{color:(t.vars||t).palette.background.default,...t.vars?{backgroundColor:t.vars.palette.Avatar.defaultBg}:{backgroundColor:t.palette.grey[400],...t.applyStyles("dark",{backgroundColor:t.palette.grey[600]})}}}]}))),VY=lr("img",{name:"MuiAvatar",slot:"Img"})({width:"100%",height:"100%",textAlign:"center",objectFit:"cover",color:"transparent",textIndent:1e4}),UY=lr(LY,{name:"MuiAvatar",slot:"Fallback"})({width:"75%",height:"75%"});function jY({crossOrigin:t,referrerPolicy:e,src:n,srcSet:r}){const[c,d]=ke.useState(!1);return ke.useEffect(()=>{if(!n&&!r)return;d(!1);let m=!0;const s=new Image;return s.onload=()=>{m&&d("loaded")},s.onerror=()=>{m&&d("error")},s.crossOrigin=t,s.referrerPolicy=e,s.src=n,r&&(s.srcset=r),()=>{m=!1}},[t,e,n,r]),c}const Z5=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiAvatar"}),{alt:c,children:d,className:m,component:s="div",slots:T={},slotProps:D={},imgProps:P,sizes:z,src:F,srcSet:$,variant:J="circular",...X}=r;let te=null;const ie={...r,component:s,variant:J},we=jY({...P,...typeof D.img=="function"?D.img(ie):D.img,src:F,srcSet:$}),Ie=F||$,Re=Ie&&we!=="error";ie.colorDefault=!Re,delete ie.ownerState;const Ne=BY(ie),[Xe,be]=ta("root",{ref:n,className:Dr(Ne.root,m),elementType:FY,externalForwardedProps:{slots:T,slotProps:D,component:s,...X},ownerState:ie}),[_e,Te]=ta("img",{className:Ne.img,elementType:VY,externalForwardedProps:{slots:T,slotProps:{img:{...P,...D.img}}},additionalProps:{alt:c,src:F,srcSet:$,sizes:z},ownerState:ie}),[oe,Ee]=ta("fallback",{className:Ne.fallback,elementType:UY,externalForwardedProps:{slots:T,slotProps:D},shouldForwardComponentProp:!0,ownerState:ie});return Re?te=Qn.jsx(_e,{...Te}):d||d===0?te=d:Ie&&c?te=c[0]:te=Qn.jsx(oe,{...Ee}),Qn.jsx(Xe,{...be,children:te})});Z5.propTypes={alt:G.string,children:G.node,classes:G.object,className:G.string,component:G.elementType,imgProps:G.object,sizes:G.string,slotProps:G.shape({fallback:G.oneOfType([G.func,G.object]),img:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object])}),slots:G.shape({fallback:G.elementType,img:G.elementType,root:G.elementType}),src:G.string,srcSet:G.string,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),variant:G.oneOfType([G.oneOf(["circular","rounded","square"]),G.string])};function HY(t){return wo("MuiButton",t)}const qb=io("MuiButton",["root","text","textInherit","textPrimary","textSecondary","textSuccess","textError","textInfo","textWarning","outlined","outlinedInherit","outlinedPrimary","outlinedSecondary","outlinedSuccess","outlinedError","outlinedInfo","outlinedWarning","contained","containedInherit","containedPrimary","containedSecondary","containedSuccess","containedError","containedInfo","containedWarning","disableElevation","focusVisible","disabled","colorInherit","colorPrimary","colorSecondary","colorSuccess","colorError","colorInfo","colorWarning","textSizeSmall","textSizeMedium","textSizeLarge","outlinedSizeSmall","outlinedSizeMedium","outlinedSizeLarge","containedSizeSmall","containedSizeMedium","containedSizeLarge","sizeMedium","sizeSmall","sizeLarge","fullWidth","startIcon","endIcon","icon","iconSizeSmall","iconSizeMedium","iconSizeLarge","loading","loadingWrapper","loadingIconPlaceholder","loadingIndicator","loadingPositionCenter","loadingPositionStart","loadingPositionEnd"]),X5=ke.createContext({});X5.displayName="ButtonGroupContext";const Q5=ke.createContext(void 0);Q5.displayName="ButtonGroupButtonContext";const $Y=t=>{const{color:e,disableElevation:n,fullWidth:r,size:c,variant:d,loading:m,loadingPosition:s,classes:T}=t,D={root:["root",m&&"loading",d,`${d}${Rr(e)}`,`size${Rr(c)}`,`${d}Size${Rr(c)}`,`color${Rr(e)}`,n&&"disableElevation",r&&"fullWidth",m&&`loadingPosition${Rr(s)}`],startIcon:["icon","startIcon",`iconSize${Rr(c)}`],endIcon:["icon","endIcon",`iconSize${Rr(c)}`],loadingIndicator:["loadingIndicator"],loadingWrapper:["loadingWrapper"]},P=Fo(D,HY,T);return{...T,...P}},K5=[{props:{size:"small"},style:{"& > *:nth-of-type(1)":{fontSize:18}}},{props:{size:"medium"},style:{"& > *:nth-of-type(1)":{fontSize:20}}},{props:{size:"large"},style:{"& > *:nth-of-type(1)":{fontSize:22}}}],GY=lr(NA,{shouldForwardProp:t=>OI(t)||t==="classes",name:"MuiButton",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.variant],e[`${n.variant}${Rr(n.color)}`],e[`size${Rr(n.size)}`],e[`${n.variant}Size${Rr(n.size)}`],n.color==="inherit"&&e.colorInherit,n.disableElevation&&e.disableElevation,n.fullWidth&&e.fullWidth,n.loading&&e.loading]}})(zo(({theme:t})=>{const e=t.palette.mode==="light"?t.palette.grey[300]:t.palette.grey[800],n=t.palette.mode==="light"?t.palette.grey.A100:t.palette.grey[700];return{...t.typography.button,minWidth:64,padding:"6px 16px",border:0,borderRadius:(t.vars||t).shape.borderRadius,transition:t.transitions.create(["background-color","box-shadow","border-color","color"],{duration:t.transitions.duration.short}),"&:hover":{textDecoration:"none"},[`&.${qb.disabled}`]:{color:(t.vars||t).palette.action.disabled},variants:[{props:{variant:"contained"},style:{color:"var(--variant-containedColor)",backgroundColor:"var(--variant-containedBg)",boxShadow:(t.vars||t).shadows[2],"&:hover":{boxShadow:(t.vars||t).shadows[4],"@media (hover: none)":{boxShadow:(t.vars||t).shadows[2]}},"&:active":{boxShadow:(t.vars||t).shadows[8]},[`&.${qb.focusVisible}`]:{boxShadow:(t.vars||t).shadows[6]},[`&.${qb.disabled}`]:{color:(t.vars||t).palette.action.disabled,boxShadow:(t.vars||t).shadows[0],backgroundColor:(t.vars||t).palette.action.disabledBackground}}},{props:{variant:"outlined"},style:{padding:"5px 15px",border:"1px solid currentColor",borderColor:"var(--variant-outlinedBorder, currentColor)",backgroundColor:"var(--variant-outlinedBg)",color:"var(--variant-outlinedColor)",[`&.${qb.disabled}`]:{border:`1px solid ${(t.vars||t).palette.action.disabledBackground}`}}},{props:{variant:"text"},style:{padding:"6px 8px",color:"var(--variant-textColor)",backgroundColor:"var(--variant-textBg)"}},...Object.entries(t.palette).filter($w()).map(([r])=>({props:{color:r},style:{"--variant-textColor":(t.vars||t).palette[r].main,"--variant-outlinedColor":(t.vars||t).palette[r].main,"--variant-outlinedBorder":t.vars?`rgba(${t.vars.palette[r].mainChannel} / 0.5)`:Lc(t.palette[r].main,.5),"--variant-containedColor":(t.vars||t).palette[r].contrastText,"--variant-containedBg":(t.vars||t).palette[r].main,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":(t.vars||t).palette[r].dark,"--variant-textBg":t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc(t.palette[r].main,t.palette.action.hoverOpacity),"--variant-outlinedBorder":(t.vars||t).palette[r].main,"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette[r].mainChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc(t.palette[r].main,t.palette.action.hoverOpacity)}}}})),{props:{color:"inherit"},style:{color:"inherit",borderColor:"currentColor","--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedBg:e,"@media (hover: hover)":{"&:hover":{"--variant-containedBg":t.vars?t.vars.palette.Button.inheritContainedHoverBg:n,"--variant-textBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc(t.palette.text.primary,t.palette.action.hoverOpacity),"--variant-outlinedBg":t.vars?`rgba(${t.vars.palette.text.primaryChannel} / ${t.vars.palette.action.hoverOpacity})`:Lc(t.palette.text.primary,t.palette.action.hoverOpacity)}}}},{props:{size:"small",variant:"text"},style:{padding:"4px 5px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"text"},style:{padding:"8px 11px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"outlined"},style:{padding:"3px 9px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"outlined"},style:{padding:"7px 21px",fontSize:t.typography.pxToRem(15)}},{props:{size:"small",variant:"contained"},style:{padding:"4px 10px",fontSize:t.typography.pxToRem(13)}},{props:{size:"large",variant:"contained"},style:{padding:"8px 22px",fontSize:t.typography.pxToRem(15)}},{props:{disableElevation:!0},style:{boxShadow:"none","&:hover":{boxShadow:"none"},[`&.${qb.focusVisible}`]:{boxShadow:"none"},"&:active":{boxShadow:"none"},[`&.${qb.disabled}`]:{boxShadow:"none"}}},{props:{fullWidth:!0},style:{width:"100%"}},{props:{loadingPosition:"center"},style:{transition:t.transitions.create(["background-color","box-shadow","border-color"],{duration:t.transitions.duration.short}),[`&.${qb.loading}`]:{color:"transparent"}}}]}})),qY=lr("span",{name:"MuiButton",slot:"StartIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.startIcon,n.loading&&e.startIconLoadingStart,e[`iconSize${Rr(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:8,marginLeft:-4,variants:[{props:{size:"small"},style:{marginLeft:-2}},{props:{loadingPosition:"start",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"start",loading:!0,fullWidth:!0},style:{marginRight:-8}},...K5]})),WY=lr("span",{name:"MuiButton",slot:"EndIcon",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.endIcon,n.loading&&e.endIconLoadingEnd,e[`iconSize${Rr(n.size)}`]]}})(({theme:t})=>({display:"inherit",marginRight:-4,marginLeft:8,variants:[{props:{size:"small"},style:{marginRight:-2}},{props:{loadingPosition:"end",loading:!0},style:{transition:t.transitions.create(["opacity"],{duration:t.transitions.duration.short}),opacity:0}},{props:{loadingPosition:"end",loading:!0,fullWidth:!0},style:{marginLeft:-8}},...K5]})),YY=lr("span",{name:"MuiButton",slot:"LoadingIndicator"})(({theme:t})=>({display:"none",position:"absolute",visibility:"visible",variants:[{props:{loading:!0},style:{display:"flex"}},{props:{loadingPosition:"start"},style:{left:14}},{props:{loadingPosition:"start",size:"small"},style:{left:10}},{props:{variant:"text",loadingPosition:"start"},style:{left:6}},{props:{loadingPosition:"center"},style:{left:"50%",transform:"translate(-50%)",color:(t.vars||t).palette.action.disabled}},{props:{loadingPosition:"end"},style:{right:14}},{props:{loadingPosition:"end",size:"small"},style:{right:10}},{props:{variant:"text",loadingPosition:"end"},style:{right:6}},{props:{loadingPosition:"start",fullWidth:!0},style:{position:"relative",left:-10}},{props:{loadingPosition:"end",fullWidth:!0},style:{position:"relative",right:-10}}]})),xB=lr("span",{name:"MuiButton",slot:"LoadingIconPlaceholder"})({display:"inline-block",width:"1em",height:"1em"}),Ak=ke.forwardRef(function(e,n){const r=ke.useContext(X5),c=ke.useContext(Q5),d=iA(r,e),m=Mo({props:d,name:"MuiButton"}),{children:s,color:T="primary",component:D="button",className:P,disabled:z=!1,disableElevation:F=!1,disableFocusRipple:$=!1,endIcon:J,focusVisibleClassName:X,fullWidth:te=!1,id:ie,loading:we=null,loadingIndicator:Ie,loadingPosition:Re="center",size:Ne="medium",startIcon:Xe,type:be,variant:_e="text",...Te}=m,oe=ZN(ie),Ee=Ie??Qn.jsx(JN,{"aria-labelledby":oe,color:"inherit",size:16}),$e={...m,color:T,component:D,disabled:z,disableElevation:F,disableFocusRipple:$,fullWidth:te,loading:we,loadingIndicator:Ee,loadingPosition:Re,size:Ne,type:be,variant:_e},ze=$Y($e),zt=(Xe||we&&Re==="start")&&Qn.jsx(qY,{className:ze.startIcon,ownerState:$e,children:Xe||Qn.jsx(xB,{className:ze.loadingIconPlaceholder,ownerState:$e})}),St=(J||we&&Re==="end")&&Qn.jsx(WY,{className:ze.endIcon,ownerState:$e,children:J||Qn.jsx(xB,{className:ze.loadingIconPlaceholder,ownerState:$e})}),mt=c||"",Ft=typeof we=="boolean"?Qn.jsx("span",{className:ze.loadingWrapper,style:{display:"contents"},children:we&&Qn.jsx(YY,{className:ze.loadingIndicator,ownerState:$e,children:Ee})}):null;return Qn.jsxs(GY,{ownerState:$e,className:Dr(r.className,ze.root,P,mt),component:D,disabled:z||we,focusRipple:!$,focusVisibleClassName:Dr(ze.focusVisible,X),ref:n,type:be,id:we?oe:ie,...Te,classes:ze,children:[zt,Re!=="end"&&Ft,s,Re==="end"&&Ft,St]})});Ak.propTypes={children:G.node,classes:G.object,className:G.string,color:G.oneOfType([G.oneOf(["inherit","primary","secondary","success","error","info","warning"]),G.string]),component:G.elementType,disabled:G.bool,disableElevation:G.bool,disableFocusRipple:G.bool,disableRipple:G.bool,endIcon:G.node,focusVisibleClassName:G.string,fullWidth:G.bool,href:G.string,id:G.string,loading:G.bool,loadingIndicator:G.node,loadingPosition:G.oneOf(["center","end","start"]),size:G.oneOfType([G.oneOf(["small","medium","large"]),G.string]),startIcon:G.node,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),type:G.oneOfType([G.oneOf(["button","reset","submit"]),G.string]),variant:G.oneOfType([G.oneOf(["contained","outlined","text"]),G.string])};var qu="top",nf="bottom",rf="right",Wu="left",e2="auto",zA=[qu,nf,rf,Wu],qw="start",lA="end",ZY="clippingParents",J5="viewport",cS="popper",XY="reference",wB=zA.reduce(function(t,e){return t.concat([e+"-"+qw,e+"-"+lA])},[]),e4=[].concat(zA,[e2]).reduce(function(t,e){return t.concat([e,e+"-"+qw,e+"-"+lA])},[]),QY="beforeRead",KY="read",JY="afterRead",eZ="beforeMain",tZ="main",nZ="afterMain",iZ="beforeWrite",rZ="write",sZ="afterWrite",oZ=[QY,KY,JY,eZ,tZ,nZ,iZ,rZ,sZ];function Gm(t){return t?(t.nodeName||"").toLowerCase():null}function Zh(t){if(t==null)return window;if(t.toString()!=="[object Window]"){var e=t.ownerDocument;return e&&e.defaultView||window}return t}function gx(t){var e=Zh(t).Element;return t instanceof e||t instanceof Element}function Jd(t){var e=Zh(t).HTMLElement;return t instanceof e||t instanceof HTMLElement}function t2(t){if(typeof ShadowRoot>"u")return!1;var e=Zh(t).ShadowRoot;return t instanceof e||t instanceof ShadowRoot}function aZ(t){var e=t.state;Object.keys(e.elements).forEach(function(n){var r=e.styles[n]||{},c=e.attributes[n]||{},d=e.elements[n];!Jd(d)||!Gm(d)||(Object.assign(d.style,r),Object.keys(c).forEach(function(m){var s=c[m];s===!1?d.removeAttribute(m):d.setAttribute(m,s===!0?"":s)}))})}function lZ(t){var e=t.state,n={popper:{position:e.options.strategy,left:"0",top:"0",margin:"0"},arrow:{position:"absolute"},reference:{}};return Object.assign(e.elements.popper.style,n.popper),e.styles=n,e.elements.arrow&&Object.assign(e.elements.arrow.style,n.arrow),function(){Object.keys(e.elements).forEach(function(r){var c=e.elements[r],d=e.attributes[r]||{},m=Object.keys(e.styles.hasOwnProperty(r)?e.styles[r]:n[r]),s=m.reduce(function(T,D){return T[D]="",T},{});!Jd(c)||!Gm(c)||(Object.assign(c.style,s),Object.keys(d).forEach(function(T){c.removeAttribute(T)}))})}}const cZ={name:"applyStyles",enabled:!0,phase:"write",fn:aZ,effect:lZ,requires:["computeStyles"]};function Vm(t){return t.split("-")[0]}var lx=Math.max,yO=Math.min,Ww=Math.round;function Ck(){var t=navigator.userAgentData;return t!=null&&t.brands&&Array.isArray(t.brands)?t.brands.map(function(e){return e.brand+"/"+e.version}).join(" "):navigator.userAgent}function t4(){return!/^((?!chrome|android).)*safari/i.test(Ck())}function Yw(t,e,n){e===void 0&&(e=!1),n===void 0&&(n=!1);var r=t.getBoundingClientRect(),c=1,d=1;e&&Jd(t)&&(c=t.offsetWidth>0&&Ww(r.width)/t.offsetWidth||1,d=t.offsetHeight>0&&Ww(r.height)/t.offsetHeight||1);var m=gx(t)?Zh(t):window,s=m.visualViewport,T=!t4()&&n,D=(r.left+(T&&s?s.offsetLeft:0))/c,P=(r.top+(T&&s?s.offsetTop:0))/d,z=r.width/c,F=r.height/d;return{width:z,height:F,top:P,right:D+z,bottom:P+F,left:D,x:D,y:P}}function n2(t){var e=Yw(t),n=t.offsetWidth,r=t.offsetHeight;return Math.abs(e.width-n)<=1&&(n=e.width),Math.abs(e.height-r)<=1&&(r=e.height),{x:t.offsetLeft,y:t.offsetTop,width:n,height:r}}function n4(t,e){var n=e.getRootNode&&e.getRootNode();if(t.contains(e))return!0;if(n&&t2(n)){var r=e;do{if(r&&t.isSameNode(r))return!0;r=r.parentNode||r.host}while(r)}return!1}function E_(t){return Zh(t).getComputedStyle(t)}function uZ(t){return["table","td","th"].indexOf(Gm(t))>=0}function a0(t){return((gx(t)?t.ownerDocument:t.document)||window.document).documentElement}function kI(t){return Gm(t)==="html"?t:t.assignedSlot||t.parentNode||(t2(t)?t.host:null)||a0(t)}function TB(t){return!Jd(t)||E_(t).position==="fixed"?null:t.offsetParent}function hZ(t){var e=/firefox/i.test(Ck()),n=/Trident/i.test(Ck());if(n&&Jd(t)){var r=E_(t);if(r.position==="fixed")return null}var c=kI(t);for(t2(c)&&(c=c.host);Jd(c)&&["html","body"].indexOf(Gm(c))<0;){var d=E_(c);if(d.transform!=="none"||d.perspective!=="none"||d.contain==="paint"||["transform","perspective"].indexOf(d.willChange)!==-1||e&&d.willChange==="filter"||e&&d.filter&&d.filter!=="none")return c;c=c.parentNode}return null}function BA(t){for(var e=Zh(t),n=TB(t);n&&uZ(n)&&E_(n).position==="static";)n=TB(n);return n&&(Gm(n)==="html"||Gm(n)==="body"&&E_(n).position==="static")?e:n||hZ(t)||e}function i2(t){return["top","bottom"].indexOf(t)>=0?"x":"y"}function BS(t,e,n){return lx(t,yO(e,n))}function dZ(t,e,n){var r=BS(t,e,n);return r>n?n:r}function i4(){return{top:0,right:0,bottom:0,left:0}}function r4(t){return Object.assign({},i4(),t)}function s4(t,e){return e.reduce(function(n,r){return n[r]=t,n},{})}var fZ=function(e,n){return e=typeof e=="function"?e(Object.assign({},n.rects,{placement:n.placement})):e,r4(typeof e!="number"?e:s4(e,zA))};function pZ(t){var e,n=t.state,r=t.name,c=t.options,d=n.elements.arrow,m=n.modifiersData.popperOffsets,s=Vm(n.placement),T=i2(s),D=[Wu,rf].indexOf(s)>=0,P=D?"height":"width";if(!(!d||!m)){var z=fZ(c.padding,n),F=n2(d),$=T==="y"?qu:Wu,J=T==="y"?nf:rf,X=n.rects.reference[P]+n.rects.reference[T]-m[T]-n.rects.popper[P],te=m[T]-n.rects.reference[T],ie=BA(d),we=ie?T==="y"?ie.clientHeight||0:ie.clientWidth||0:0,Ie=X/2-te/2,Re=z[$],Ne=we-F[P]-z[J],Xe=we/2-F[P]/2+Ie,be=BS(Re,Xe,Ne),_e=T;n.modifiersData[r]=(e={},e[_e]=be,e.centerOffset=be-Xe,e)}}function mZ(t){var e=t.state,n=t.options,r=n.element,c=r===void 0?"[data-popper-arrow]":r;c!=null&&(typeof c=="string"&&(c=e.elements.popper.querySelector(c),!c)||n4(e.elements.popper,c)&&(e.elements.arrow=c))}const gZ={name:"arrow",enabled:!0,phase:"main",fn:pZ,effect:mZ,requires:["popperOffsets"],requiresIfExists:["preventOverflow"]};function Zw(t){return t.split("-")[1]}var _Z={top:"auto",right:"auto",bottom:"auto",left:"auto"};function yZ(t,e){var n=t.x,r=t.y,c=e.devicePixelRatio||1;return{x:Ww(n*c)/c||0,y:Ww(r*c)/c||0}}function EB(t){var e,n=t.popper,r=t.popperRect,c=t.placement,d=t.variation,m=t.offsets,s=t.position,T=t.gpuAcceleration,D=t.adaptive,P=t.roundOffsets,z=t.isFixed,F=m.x,$=F===void 0?0:F,J=m.y,X=J===void 0?0:J,te=typeof P=="function"?P({x:$,y:X}):{x:$,y:X};$=te.x,X=te.y;var ie=m.hasOwnProperty("x"),we=m.hasOwnProperty("y"),Ie=Wu,Re=qu,Ne=window;if(D){var Xe=BA(n),be="clientHeight",_e="clientWidth";if(Xe===Zh(n)&&(Xe=a0(n),E_(Xe).position!=="static"&&s==="absolute"&&(be="scrollHeight",_e="scrollWidth")),Xe=Xe,c===qu||(c===Wu||c===rf)&&d===lA){Re=nf;var Te=z&&Xe===Ne&&Ne.visualViewport?Ne.visualViewport.height:Xe[be];X-=Te-r.height,X*=T?1:-1}if(c===Wu||(c===qu||c===nf)&&d===lA){Ie=rf;var oe=z&&Xe===Ne&&Ne.visualViewport?Ne.visualViewport.width:Xe[_e];$-=oe-r.width,$*=T?1:-1}}var Ee=Object.assign({position:s},D&&_Z),$e=P===!0?yZ({x:$,y:X},Zh(n)):{x:$,y:X};if($=$e.x,X=$e.y,T){var ze;return Object.assign({},Ee,(ze={},ze[Re]=we?"0":"",ze[Ie]=ie?"0":"",ze.transform=(Ne.devicePixelRatio||1)<=1?"translate("+$+"px, "+X+"px)":"translate3d("+$+"px, "+X+"px, 0)",ze))}return Object.assign({},Ee,(e={},e[Re]=we?X+"px":"",e[Ie]=ie?$+"px":"",e.transform="",e))}function vZ(t){var e=t.state,n=t.options,r=n.gpuAcceleration,c=r===void 0?!0:r,d=n.adaptive,m=d===void 0?!0:d,s=n.roundOffsets,T=s===void 0?!0:s,D={placement:Vm(e.placement),variation:Zw(e.placement),popper:e.elements.popper,popperRect:e.rects.popper,gpuAcceleration:c,isFixed:e.options.strategy==="fixed"};e.modifiersData.popperOffsets!=null&&(e.styles.popper=Object.assign({},e.styles.popper,EB(Object.assign({},D,{offsets:e.modifiersData.popperOffsets,position:e.options.strategy,adaptive:m,roundOffsets:T})))),e.modifiersData.arrow!=null&&(e.styles.arrow=Object.assign({},e.styles.arrow,EB(Object.assign({},D,{offsets:e.modifiersData.arrow,position:"absolute",adaptive:!1,roundOffsets:T})))),e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-placement":e.placement})}const bZ={name:"computeStyles",enabled:!0,phase:"beforeWrite",fn:vZ,data:{}};var KD={passive:!0};function xZ(t){var e=t.state,n=t.instance,r=t.options,c=r.scroll,d=c===void 0?!0:c,m=r.resize,s=m===void 0?!0:m,T=Zh(e.elements.popper),D=[].concat(e.scrollParents.reference,e.scrollParents.popper);return d&&D.forEach(function(P){P.addEventListener("scroll",n.update,KD)}),s&&T.addEventListener("resize",n.update,KD),function(){d&&D.forEach(function(P){P.removeEventListener("scroll",n.update,KD)}),s&&T.removeEventListener("resize",n.update,KD)}}const wZ={name:"eventListeners",enabled:!0,phase:"write",fn:function(){},effect:xZ,data:{}};var TZ={left:"right",right:"left",bottom:"top",top:"bottom"};function BR(t){return t.replace(/left|right|bottom|top/g,function(e){return TZ[e]})}var EZ={start:"end",end:"start"};function SB(t){return t.replace(/start|end/g,function(e){return EZ[e]})}function r2(t){var e=Zh(t),n=e.pageXOffset,r=e.pageYOffset;return{scrollLeft:n,scrollTop:r}}function s2(t){return Yw(a0(t)).left+r2(t).scrollLeft}function SZ(t,e){var n=Zh(t),r=a0(t),c=n.visualViewport,d=r.clientWidth,m=r.clientHeight,s=0,T=0;if(c){d=c.width,m=c.height;var D=t4();(D||!D&&e==="fixed")&&(s=c.offsetLeft,T=c.offsetTop)}return{width:d,height:m,x:s+s2(t),y:T}}function AZ(t){var e,n=a0(t),r=r2(t),c=(e=t.ownerDocument)==null?void 0:e.body,d=lx(n.scrollWidth,n.clientWidth,c?c.scrollWidth:0,c?c.clientWidth:0),m=lx(n.scrollHeight,n.clientHeight,c?c.scrollHeight:0,c?c.clientHeight:0),s=-r.scrollLeft+s2(t),T=-r.scrollTop;return E_(c||n).direction==="rtl"&&(s+=lx(n.clientWidth,c?c.clientWidth:0)-d),{width:d,height:m,x:s,y:T}}function o2(t){var e=E_(t),n=e.overflow,r=e.overflowX,c=e.overflowY;return/auto|scroll|overlay|hidden/.test(n+c+r)}function o4(t){return["html","body","#document"].indexOf(Gm(t))>=0?t.ownerDocument.body:Jd(t)&&o2(t)?t:o4(kI(t))}function FS(t,e){var n;e===void 0&&(e=[]);var r=o4(t),c=r===((n=t.ownerDocument)==null?void 0:n.body),d=Zh(r),m=c?[d].concat(d.visualViewport||[],o2(r)?r:[]):r,s=e.concat(m);return c?s:s.concat(FS(kI(m)))}function Dk(t){return Object.assign({},t,{left:t.x,top:t.y,right:t.x+t.width,bottom:t.y+t.height})}function CZ(t,e){var n=Yw(t,!1,e==="fixed");return n.top=n.top+t.clientTop,n.left=n.left+t.clientLeft,n.bottom=n.top+t.clientHeight,n.right=n.left+t.clientWidth,n.width=t.clientWidth,n.height=t.clientHeight,n.x=n.left,n.y=n.top,n}function AB(t,e,n){return e===J5?Dk(SZ(t,n)):gx(e)?CZ(e,n):Dk(AZ(a0(t)))}function DZ(t){var e=FS(kI(t)),n=["absolute","fixed"].indexOf(E_(t).position)>=0,r=n&&Jd(t)?BA(t):t;return gx(r)?e.filter(function(c){return gx(c)&&n4(c,r)&&Gm(c)!=="body"}):[]}function RZ(t,e,n,r){var c=e==="clippingParents"?DZ(t):[].concat(e),d=[].concat(c,[n]),m=d[0],s=d.reduce(function(T,D){var P=AB(t,D,r);return T.top=lx(P.top,T.top),T.right=yO(P.right,T.right),T.bottom=yO(P.bottom,T.bottom),T.left=lx(P.left,T.left),T},AB(t,m,r));return s.width=s.right-s.left,s.height=s.bottom-s.top,s.x=s.left,s.y=s.top,s}function a4(t){var e=t.reference,n=t.element,r=t.placement,c=r?Vm(r):null,d=r?Zw(r):null,m=e.x+e.width/2-n.width/2,s=e.y+e.height/2-n.height/2,T;switch(c){case qu:T={x:m,y:e.y-n.height};break;case nf:T={x:m,y:e.y+e.height};break;case rf:T={x:e.x+e.width,y:s};break;case Wu:T={x:e.x-n.width,y:s};break;default:T={x:e.x,y:e.y}}var D=c?i2(c):null;if(D!=null){var P=D==="y"?"height":"width";switch(d){case qw:T[D]=T[D]-(e[P]/2-n[P]/2);break;case lA:T[D]=T[D]+(e[P]/2-n[P]/2);break}}return T}function cA(t,e){e===void 0&&(e={});var n=e,r=n.placement,c=r===void 0?t.placement:r,d=n.strategy,m=d===void 0?t.strategy:d,s=n.boundary,T=s===void 0?ZY:s,D=n.rootBoundary,P=D===void 0?J5:D,z=n.elementContext,F=z===void 0?cS:z,$=n.altBoundary,J=$===void 0?!1:$,X=n.padding,te=X===void 0?0:X,ie=r4(typeof te!="number"?te:s4(te,zA)),we=F===cS?XY:cS,Ie=t.rects.popper,Re=t.elements[J?we:F],Ne=RZ(gx(Re)?Re:Re.contextElement||a0(t.elements.popper),T,P,m),Xe=Yw(t.elements.reference),be=a4({reference:Xe,element:Ie,placement:c}),_e=Dk(Object.assign({},Ie,be)),Te=F===cS?_e:Xe,oe={top:Ne.top-Te.top+ie.top,bottom:Te.bottom-Ne.bottom+ie.bottom,left:Ne.left-Te.left+ie.left,right:Te.right-Ne.right+ie.right},Ee=t.modifiersData.offset;if(F===cS&&Ee){var $e=Ee[c];Object.keys(oe).forEach(function(ze){var zt=[rf,nf].indexOf(ze)>=0?1:-1,St=[qu,nf].indexOf(ze)>=0?"y":"x";oe[ze]+=$e[St]*zt})}return oe}function OZ(t,e){e===void 0&&(e={});var n=e,r=n.placement,c=n.boundary,d=n.rootBoundary,m=n.padding,s=n.flipVariations,T=n.allowedAutoPlacements,D=T===void 0?e4:T,P=Zw(r),z=P?s?wB:wB.filter(function(J){return Zw(J)===P}):zA,F=z.filter(function(J){return D.indexOf(J)>=0});F.length===0&&(F=z);var $=F.reduce(function(J,X){return J[X]=cA(t,{placement:X,boundary:c,rootBoundary:d,padding:m})[Vm(X)],J},{});return Object.keys($).sort(function(J,X){return $[J]-$[X]})}function IZ(t){if(Vm(t)===e2)return[];var e=BR(t);return[SB(t),e,SB(e)]}function MZ(t){var e=t.state,n=t.options,r=t.name;if(!e.modifiersData[r]._skip){for(var c=n.mainAxis,d=c===void 0?!0:c,m=n.altAxis,s=m===void 0?!0:m,T=n.fallbackPlacements,D=n.padding,P=n.boundary,z=n.rootBoundary,F=n.altBoundary,$=n.flipVariations,J=$===void 0?!0:$,X=n.allowedAutoPlacements,te=e.options.placement,ie=Vm(te),we=ie===te,Ie=T||(we||!J?[BR(te)]:IZ(te)),Re=[te].concat(Ie).reduce(function(wn,dn){return wn.concat(Vm(dn)===e2?OZ(e,{placement:dn,boundary:P,rootBoundary:z,padding:D,flipVariations:J,allowedAutoPlacements:X}):dn)},[]),Ne=e.rects.reference,Xe=e.rects.popper,be=new Map,_e=!0,Te=Re[0],oe=0;oe<Re.length;oe++){var Ee=Re[oe],$e=Vm(Ee),ze=Zw(Ee)===qw,zt=[qu,nf].indexOf($e)>=0,St=zt?"width":"height",mt=cA(e,{placement:Ee,boundary:P,rootBoundary:z,altBoundary:F,padding:D}),Ft=zt?ze?rf:Wu:ze?nf:qu;Ne[St]>Xe[St]&&(Ft=BR(Ft));var rn=BR(Ft),Xt=[];if(d&&Xt.push(mt[$e]<=0),s&&Xt.push(mt[Ft]<=0,mt[rn]<=0),Xt.every(function(wn){return wn})){Te=Ee,_e=!1;break}be.set(Ee,Xt)}if(_e)for(var Fe=J?3:1,Ot=function(dn){var Ht=Re.find(function(Mn){var yn=be.get(Mn);if(yn)return yn.slice(0,dn).every(function(Tn){return Tn})});if(Ht)return Te=Ht,"break"},Ut=Fe;Ut>0;Ut--){var ln=Ot(Ut);if(ln==="break")break}e.placement!==Te&&(e.modifiersData[r]._skip=!0,e.placement=Te,e.reset=!0)}}const PZ={name:"flip",enabled:!0,phase:"main",fn:MZ,requiresIfExists:["offset"],data:{_skip:!1}};function CB(t,e,n){return n===void 0&&(n={x:0,y:0}),{top:t.top-e.height-n.y,right:t.right-e.width+n.x,bottom:t.bottom-e.height+n.y,left:t.left-e.width-n.x}}function DB(t){return[qu,rf,nf,Wu].some(function(e){return t[e]>=0})}function kZ(t){var e=t.state,n=t.name,r=e.rects.reference,c=e.rects.popper,d=e.modifiersData.preventOverflow,m=cA(e,{elementContext:"reference"}),s=cA(e,{altBoundary:!0}),T=CB(m,r),D=CB(s,c,d),P=DB(T),z=DB(D);e.modifiersData[n]={referenceClippingOffsets:T,popperEscapeOffsets:D,isReferenceHidden:P,hasPopperEscaped:z},e.attributes.popper=Object.assign({},e.attributes.popper,{"data-popper-reference-hidden":P,"data-popper-escaped":z})}const NZ={name:"hide",enabled:!0,phase:"main",requiresIfExists:["preventOverflow"],fn:kZ};function LZ(t,e,n){var r=Vm(t),c=[Wu,qu].indexOf(r)>=0?-1:1,d=typeof n=="function"?n(Object.assign({},e,{placement:t})):n,m=d[0],s=d[1];return m=m||0,s=(s||0)*c,[Wu,rf].indexOf(r)>=0?{x:s,y:m}:{x:m,y:s}}function zZ(t){var e=t.state,n=t.options,r=t.name,c=n.offset,d=c===void 0?[0,0]:c,m=e4.reduce(function(P,z){return P[z]=LZ(z,e.rects,d),P},{}),s=m[e.placement],T=s.x,D=s.y;e.modifiersData.popperOffsets!=null&&(e.modifiersData.popperOffsets.x+=T,e.modifiersData.popperOffsets.y+=D),e.modifiersData[r]=m}const BZ={name:"offset",enabled:!0,phase:"main",requires:["popperOffsets"],fn:zZ};function FZ(t){var e=t.state,n=t.name;e.modifiersData[n]=a4({reference:e.rects.reference,element:e.rects.popper,placement:e.placement})}const VZ={name:"popperOffsets",enabled:!0,phase:"read",fn:FZ,data:{}};function UZ(t){return t==="x"?"y":"x"}function jZ(t){var e=t.state,n=t.options,r=t.name,c=n.mainAxis,d=c===void 0?!0:c,m=n.altAxis,s=m===void 0?!1:m,T=n.boundary,D=n.rootBoundary,P=n.altBoundary,z=n.padding,F=n.tether,$=F===void 0?!0:F,J=n.tetherOffset,X=J===void 0?0:J,te=cA(e,{boundary:T,rootBoundary:D,padding:z,altBoundary:P}),ie=Vm(e.placement),we=Zw(e.placement),Ie=!we,Re=i2(ie),Ne=UZ(Re),Xe=e.modifiersData.popperOffsets,be=e.rects.reference,_e=e.rects.popper,Te=typeof X=="function"?X(Object.assign({},e.rects,{placement:e.placement})):X,oe=typeof Te=="number"?{mainAxis:Te,altAxis:Te}:Object.assign({mainAxis:0,altAxis:0},Te),Ee=e.modifiersData.offset?e.modifiersData.offset[e.placement]:null,$e={x:0,y:0};if(Xe){if(d){var ze,zt=Re==="y"?qu:Wu,St=Re==="y"?nf:rf,mt=Re==="y"?"height":"width",Ft=Xe[Re],rn=Ft+te[zt],Xt=Ft-te[St],Fe=$?-_e[mt]/2:0,Ot=we===qw?be[mt]:_e[mt],Ut=we===qw?-_e[mt]:-be[mt],ln=e.elements.arrow,wn=$&&ln?n2(ln):{width:0,height:0},dn=e.modifiersData["arrow#persistent"]?e.modifiersData["arrow#persistent"].padding:i4(),Ht=dn[zt],Mn=dn[St],yn=BS(0,be[mt],wn[mt]),Tn=Ie?be[mt]/2-Fe-yn-Ht-oe.mainAxis:Ot-yn-Ht-oe.mainAxis,Cn=Ie?-be[mt]/2+Fe+yn+Mn+oe.mainAxis:Ut+yn+Mn+oe.mainAxis,Kn=e.elements.arrow&&BA(e.elements.arrow),Bt=Kn?Re==="y"?Kn.clientTop||0:Kn.clientLeft||0:0,ni=(ze=Ee==null?void 0:Ee[Re])!=null?ze:0,er=Ft+Tn-ni-Bt,_r=Ft+Cn-ni,Li=BS($?yO(rn,er):rn,Ft,$?lx(Xt,_r):Xt);Xe[Re]=Li,$e[Re]=Li-Ft}if(s){var jr,ss=Re==="x"?qu:Wu,Nr=Re==="x"?nf:rf,ti=Xe[Ne],dr=Ne==="y"?"height":"width",di=ti+te[ss],ks=ti-te[Nr],fs=[qu,Wu].indexOf(ie)!==-1,Uo=(jr=Ee==null?void 0:Ee[Ne])!=null?jr:0,Kr=fs?di:ti-be[dr]-_e[dr]-Uo+oe.altAxis,ir=fs?ti+be[dr]+_e[dr]-Uo-oe.altAxis:ks,Po=$&&fs?dZ(Kr,ti,ir):BS($?Kr:di,ti,$?ir:ks);Xe[Ne]=Po,$e[Ne]=Po-ti}e.modifiersData[r]=$e}}const HZ={name:"preventOverflow",enabled:!0,phase:"main",fn:jZ,requiresIfExists:["offset"]};function $Z(t){return{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}}function GZ(t){return t===Zh(t)||!Jd(t)?r2(t):$Z(t)}function qZ(t){var e=t.getBoundingClientRect(),n=Ww(e.width)/t.offsetWidth||1,r=Ww(e.height)/t.offsetHeight||1;return n!==1||r!==1}function WZ(t,e,n){n===void 0&&(n=!1);var r=Jd(e),c=Jd(e)&&qZ(e),d=a0(e),m=Yw(t,c,n),s={scrollLeft:0,scrollTop:0},T={x:0,y:0};return(r||!r&&!n)&&((Gm(e)!=="body"||o2(d))&&(s=GZ(e)),Jd(e)?(T=Yw(e,!0),T.x+=e.clientLeft,T.y+=e.clientTop):d&&(T.x=s2(d))),{x:m.left+s.scrollLeft-T.x,y:m.top+s.scrollTop-T.y,width:m.width,height:m.height}}function YZ(t){var e=new Map,n=new Set,r=[];t.forEach(function(d){e.set(d.name,d)});function c(d){n.add(d.name);var m=[].concat(d.requires||[],d.requiresIfExists||[]);m.forEach(function(s){if(!n.has(s)){var T=e.get(s);T&&c(T)}}),r.push(d)}return t.forEach(function(d){n.has(d.name)||c(d)}),r}function ZZ(t){var e=YZ(t);return oZ.reduce(function(n,r){return n.concat(e.filter(function(c){return c.phase===r}))},[])}function XZ(t){var e;return function(){return e||(e=new Promise(function(n){Promise.resolve().then(function(){e=void 0,n(t())})})),e}}function QZ(t){var e=t.reduce(function(n,r){var c=n[r.name];return n[r.name]=c?Object.assign({},c,r,{options:Object.assign({},c.options,r.options),data:Object.assign({},c.data,r.data)}):r,n},{});return Object.keys(e).map(function(n){return e[n]})}var RB={placement:"bottom",modifiers:[],strategy:"absolute"};function OB(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return!e.some(function(r){return!(r&&typeof r.getBoundingClientRect=="function")})}function KZ(t){t===void 0&&(t={});var e=t,n=e.defaultModifiers,r=n===void 0?[]:n,c=e.defaultOptions,d=c===void 0?RB:c;return function(s,T,D){D===void 0&&(D=d);var P={placement:"bottom",orderedModifiers:[],options:Object.assign({},RB,d),modifiersData:{},elements:{reference:s,popper:T},attributes:{},styles:{}},z=[],F=!1,$={state:P,setOptions:function(ie){var we=typeof ie=="function"?ie(P.options):ie;X(),P.options=Object.assign({},d,P.options,we),P.scrollParents={reference:gx(s)?FS(s):s.contextElement?FS(s.contextElement):[],popper:FS(T)};var Ie=ZZ(QZ([].concat(r,P.options.modifiers)));return P.orderedModifiers=Ie.filter(function(Re){return Re.enabled}),J(),$.update()},forceUpdate:function(){if(!F){var ie=P.elements,we=ie.reference,Ie=ie.popper;if(OB(we,Ie)){P.rects={reference:WZ(we,BA(Ie),P.options.strategy==="fixed"),popper:n2(Ie)},P.reset=!1,P.placement=P.options.placement,P.orderedModifiers.forEach(function(oe){return P.modifiersData[oe.name]=Object.assign({},oe.data)});for(var Re=0;Re<P.orderedModifiers.length;Re++){if(P.reset===!0){P.reset=!1,Re=-1;continue}var Ne=P.orderedModifiers[Re],Xe=Ne.fn,be=Ne.options,_e=be===void 0?{}:be,Te=Ne.name;typeof Xe=="function"&&(P=Xe({state:P,options:_e,name:Te,instance:$})||P)}}}},update:XZ(function(){return new Promise(function(te){$.forceUpdate(),te(P)})}),destroy:function(){X(),F=!0}};if(!OB(s,T))return $;$.setOptions(D).then(function(te){!F&&D.onFirstUpdate&&D.onFirstUpdate(te)});function J(){P.orderedModifiers.forEach(function(te){var ie=te.name,we=te.options,Ie=we===void 0?{}:we,Re=te.effect;if(typeof Re=="function"){var Ne=Re({state:P,name:ie,instance:$,options:Ie}),Xe=function(){};z.push(Ne||Xe)}})}function X(){z.forEach(function(te){return te()}),z=[]}return $}}var JZ=[wZ,VZ,bZ,cZ,BZ,PZ,HZ,gZ,NZ],eX=KZ({defaultModifiers:JZ});function tX(t){return wo("MuiPopper",t)}io("MuiPopper",["root"]);function nX(t,e){if(e==="ltr")return t;switch(t){case"bottom-end":return"bottom-start";case"bottom-start":return"bottom-end";case"top-end":return"top-start";case"top-start":return"top-end";default:return t}}function vO(t){return typeof t=="function"?t():t}function NI(t){return t.nodeType!==void 0}function iX(t){return!NI(t)}const rX=t=>{const{classes:e}=t;return Fo({root:["root"]},tX,e)},sX={},oX=ke.forwardRef(function(e,n){const{anchorEl:r,children:c,direction:d,disablePortal:m,modifiers:s,open:T,placement:D,popperOptions:P,popperRef:z,slotProps:F={},slots:$={},TransitionProps:J,ownerState:X,...te}=e,ie=ke.useRef(null),we=xu(ie,n),Ie=ke.useRef(null),Re=xu(Ie,z),Ne=ke.useRef(Re);px(()=>{Ne.current=Re},[Re]),ke.useImperativeHandle(z,()=>Ie.current,[]);const Xe=nX(D,d),[be,_e]=ke.useState(Xe),[Te,oe]=ke.useState(vO(r));ke.useEffect(()=>{Ie.current&&Ie.current.forceUpdate()}),ke.useEffect(()=>{r&&oe(vO(r))},[r]),px(()=>{if(!Te||!T)return;const St=rn=>{_e(rn.placement)};if(Te&&NI(Te)&&Te.nodeType===1){const rn=Te.getBoundingClientRect();rn.top===0&&rn.left===0&&rn.right===0&&rn.bottom===0&&console.warn(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join(`
`))}let mt=[{name:"preventOverflow",options:{altBoundary:m}},{name:"flip",options:{altBoundary:m}},{name:"onUpdate",enabled:!0,phase:"afterWrite",fn:({state:rn})=>{St(rn)}}];s!=null&&(mt=mt.concat(s)),P&&P.modifiers!=null&&(mt=mt.concat(P.modifiers));const Ft=eX(Te,ie.current,{placement:Xe,...P,modifiers:mt});return Ne.current(Ft),()=>{Ft.destroy(),Ne.current(null)}},[Te,m,s,T,P,Xe]);const Ee={placement:be};J!==null&&(Ee.TransitionProps=J);const $e=rX(e),ze=$.root??"div",zt=L5({elementType:ze,externalSlotProps:F.root,externalForwardedProps:te,additionalProps:{role:"tooltip",ref:we},ownerState:e,className:$e.root});return Qn.jsx(ze,{...zt,children:typeof c=="function"?c(Ee):c})}),l4=ke.forwardRef(function(e,n){const{anchorEl:r,children:c,container:d,direction:m="ltr",disablePortal:s=!1,keepMounted:T=!1,modifiers:D,open:P,placement:z="bottom",popperOptions:F=sX,popperRef:$,style:J,transition:X=!1,slotProps:te={},slots:ie={},...we}=e,[Ie,Re]=ke.useState(!0),Ne=()=>{Re(!1)},Xe=()=>{Re(!0)};if(!T&&!P&&(!X||Ie))return null;let be;if(d)be=d;else if(r){const oe=vO(r);be=oe&&NI(oe)?tf(oe).body:tf(null).body}const _e=!P&&T&&(!X||Ie)?"none":void 0,Te=X?{in:P,onEnter:Ne,onExited:Xe}:void 0;return Qn.jsx(aA,{disablePortal:s,container:be,children:Qn.jsx(oX,{anchorEl:r,direction:m,disablePortal:s,modifiers:D,ref:n,open:X?!Ie:P,placement:z,popperOptions:F,popperRef:$,slotProps:te,slots:ie,...we,style:{position:"fixed",top:0,left:0,display:_e,...J},TransitionProps:Te,children:c})})});l4.propTypes={anchorEl:P_(G.oneOfType([T_,G.object,G.func]),t=>{if(t.open){const e=vO(t.anchorEl);if(e&&NI(e)&&e.nodeType===1){const n=e.getBoundingClientRect();if(n.top===0&&n.left===0&&n.right===0&&n.bottom===0)return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.","The anchor element should be part of the document layout.","Make sure the element is present in the document or that it's not display none."].join(`
`))}else if(!e||typeof e.getBoundingClientRect!="function"||iX(e)&&e.contextElement!=null&&e.contextElement.nodeType!==1)return new Error(["MUI: The `anchorEl` prop provided to the component is invalid.","It should be an HTML element instance or a virtualElement ","(https://popper.js.org/docs/v2/virtual-elements/)."].join(`
`))}return null}),children:G.oneOfType([G.node,G.func]),container:G.oneOfType([T_,G.func]),direction:G.oneOf(["ltr","rtl"]),disablePortal:G.bool,keepMounted:G.bool,modifiers:G.arrayOf(G.shape({data:G.object,effect:G.func,enabled:G.bool,fn:G.func,name:G.any,options:G.object,phase:G.oneOf(["afterMain","afterRead","afterWrite","beforeMain","beforeRead","beforeWrite","main","read","write"]),requires:G.arrayOf(G.string),requiresIfExists:G.arrayOf(G.string)})),open:G.bool.isRequired,placement:G.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:G.shape({modifiers:G.array,onFirstUpdate:G.func,placement:G.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),strategy:G.oneOf(["absolute","fixed"])}),popperRef:MI,slotProps:G.shape({root:G.oneOfType([G.func,G.object])}),slots:G.shape({root:G.elementType}),transition:G.bool};const aX=lr(l4,{name:"MuiPopper",slot:"Root"})({}),a2=ke.forwardRef(function(e,n){const r=qN(),c=Mo({props:e,name:"MuiPopper"}),{anchorEl:d,component:m,components:s,componentsProps:T,container:D,disablePortal:P,keepMounted:z,modifiers:F,open:$,placement:J,popperOptions:X,popperRef:te,transition:ie,slots:we,slotProps:Ie,...Re}=c,Ne=(we==null?void 0:we.root)??(s==null?void 0:s.Root),Xe={anchorEl:d,container:D,disablePortal:P,keepMounted:z,modifiers:F,open:$,placement:J,popperOptions:X,popperRef:te,transition:ie,...Re};return Qn.jsx(aX,{as:m,direction:r?"rtl":"ltr",slots:{root:Ne},slotProps:Ie??T,...Xe,ref:n})});a2.propTypes={anchorEl:G.oneOfType([T_,G.object,G.func]),children:G.oneOfType([G.node,G.func]),component:G.elementType,components:G.shape({Root:G.elementType}),componentsProps:G.shape({root:G.oneOfType([G.func,G.object])}),container:G.oneOfType([T_,G.func]),disablePortal:G.bool,keepMounted:G.bool,modifiers:G.arrayOf(G.shape({data:G.object,effect:G.func,enabled:G.bool,fn:G.func,name:G.any,options:G.object,phase:G.oneOf(["afterMain","afterRead","afterWrite","beforeMain","beforeRead","beforeWrite","main","read","write"]),requires:G.arrayOf(G.string),requiresIfExists:G.arrayOf(G.string)})),open:G.bool.isRequired,placement:G.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),popperOptions:G.shape({modifiers:G.array,onFirstUpdate:G.func,placement:G.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),strategy:G.oneOf(["absolute","fixed"])}),popperRef:MI,slotProps:G.shape({root:G.oneOfType([G.func,G.object])}),slots:G.shape({root:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),transition:G.bool};function lX(t){return wo("MuiTooltip",t)}const Jo=io("MuiTooltip",["popper","popperInteractive","popperArrow","popperClose","tooltip","tooltipArrow","touch","tooltipPlacementLeft","tooltipPlacementRight","tooltipPlacementTop","tooltipPlacementBottom","arrow"]);function cX(t){return Math.round(t*1e5)/1e5}const uX=t=>{const{classes:e,disableInteractive:n,arrow:r,touch:c,placement:d}=t,m={popper:["popper",!n&&"popperInteractive",r&&"popperArrow"],tooltip:["tooltip",r&&"tooltipArrow",c&&"touch",`tooltipPlacement${Rr(d.split("-")[0])}`],arrow:["arrow"]};return Fo(m,lX,e)},hX=lr(a2,{name:"MuiTooltip",slot:"Popper",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.popper,!n.disableInteractive&&e.popperInteractive,n.arrow&&e.popperArrow,!n.open&&e.popperClose]}})(zo(({theme:t})=>({zIndex:(t.vars||t).zIndex.tooltip,pointerEvents:"none",variants:[{props:({ownerState:e})=>!e.disableInteractive,style:{pointerEvents:"auto"}},{props:({open:e})=>!e,style:{pointerEvents:"none"}},{props:({ownerState:e})=>e.arrow,style:{[`&[data-popper-placement*="bottom"] .${Jo.arrow}`]:{top:0,marginTop:"-0.71em","&::before":{transformOrigin:"0 100%"}},[`&[data-popper-placement*="top"] .${Jo.arrow}`]:{bottom:0,marginBottom:"-0.71em","&::before":{transformOrigin:"100% 0"}},[`&[data-popper-placement*="right"] .${Jo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"100% 100%"}},[`&[data-popper-placement*="left"] .${Jo.arrow}`]:{height:"1em",width:"0.71em","&::before":{transformOrigin:"0 0"}}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Jo.arrow}`]:{left:0,marginLeft:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="right"] .${Jo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Jo.arrow}`]:{right:0,marginRight:"-0.71em"}}},{props:({ownerState:e})=>e.arrow&&!!e.isRtl,style:{[`&[data-popper-placement*="left"] .${Jo.arrow}`]:{left:0,marginLeft:"-0.71em"}}}]}))),dX=lr("div",{name:"MuiTooltip",slot:"Tooltip",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.tooltip,n.touch&&e.touch,n.arrow&&e.tooltipArrow,e[`tooltipPlacement${Rr(n.placement.split("-")[0])}`]]}})(zo(({theme:t})=>({backgroundColor:t.vars?t.vars.palette.Tooltip.bg:Lc(t.palette.grey[700],.92),borderRadius:(t.vars||t).shape.borderRadius,color:(t.vars||t).palette.common.white,fontFamily:t.typography.fontFamily,padding:"4px 8px",fontSize:t.typography.pxToRem(11),maxWidth:300,margin:2,wordWrap:"break-word",fontWeight:t.typography.fontWeightMedium,[`.${Jo.popper}[data-popper-placement*="left"] &`]:{transformOrigin:"right center"},[`.${Jo.popper}[data-popper-placement*="right"] &`]:{transformOrigin:"left center"},[`.${Jo.popper}[data-popper-placement*="top"] &`]:{transformOrigin:"center bottom",marginBottom:"14px"},[`.${Jo.popper}[data-popper-placement*="bottom"] &`]:{transformOrigin:"center top",marginTop:"14px"},variants:[{props:({ownerState:e})=>e.arrow,style:{position:"relative",margin:0}},{props:({ownerState:e})=>e.touch,style:{padding:"8px 16px",fontSize:t.typography.pxToRem(14),lineHeight:`${cX(16/14)}em`,fontWeight:t.typography.fontWeightRegular}},{props:({ownerState:e})=>!e.isRtl,style:{[`.${Jo.popper}[data-popper-placement*="left"] &`]:{marginRight:"14px"},[`.${Jo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"14px"}}},{props:({ownerState:e})=>!e.isRtl&&e.touch,style:{[`.${Jo.popper}[data-popper-placement*="left"] &`]:{marginRight:"24px"},[`.${Jo.popper}[data-popper-placement*="right"] &`]:{marginLeft:"24px"}}},{props:({ownerState:e})=>!!e.isRtl,style:{[`.${Jo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"14px"},[`.${Jo.popper}[data-popper-placement*="right"] &`]:{marginRight:"14px"}}},{props:({ownerState:e})=>!!e.isRtl&&e.touch,style:{[`.${Jo.popper}[data-popper-placement*="left"] &`]:{marginLeft:"24px"},[`.${Jo.popper}[data-popper-placement*="right"] &`]:{marginRight:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Jo.popper}[data-popper-placement*="top"] &`]:{marginBottom:"24px"}}},{props:({ownerState:e})=>e.touch,style:{[`.${Jo.popper}[data-popper-placement*="bottom"] &`]:{marginTop:"24px"}}}]}))),fX=lr("span",{name:"MuiTooltip",slot:"Arrow"})(zo(({theme:t})=>({overflow:"hidden",position:"absolute",width:"1em",height:"0.71em",boxSizing:"border-box",color:t.vars?t.vars.palette.Tooltip.bg:Lc(t.palette.grey[700],.9),"&::before":{content:'""',margin:"auto",display:"block",width:"100%",height:"100%",backgroundColor:"currentColor",transform:"rotate(45deg)"}})));let JD=!1;const IB=new PI;let uS={x:0,y:0};function eR(t,e){return(n,...r)=>{e&&e(n,...r),t(n,...r)}}const c4=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiTooltip"}),{arrow:c=!1,children:d,classes:m,components:s={},componentsProps:T={},describeChild:D=!1,disableFocusListener:P=!1,disableHoverListener:z=!1,disableInteractive:F=!1,disableTouchListener:$=!1,enterDelay:J=100,enterNextDelay:X=0,enterTouchDelay:te=700,followCursor:ie=!1,id:we,leaveDelay:Ie=0,leaveTouchDelay:Re=1500,onClose:Ne,onOpen:Xe,open:be,placement:_e="bottom",PopperComponent:Te,PopperProps:oe={},slotProps:Ee={},slots:$e={},title:ze,TransitionComponent:zt,TransitionProps:St,...mt}=r,Ft=ke.isValidElement(d)?d:Qn.jsx("span",{children:d}),rn=PA(),Xt=qN(),[Fe,Ot]=ke.useState(),[Ut,ln]=ke.useState(null),wn=ke.useRef(!1),dn=F||ie,Ht=rx(),Mn=rx(),yn=rx(),Tn=rx(),[Cn,Kn]=A5({controlled:be,default:!1,name:"Tooltip",state:"open"});let Bt=Cn;{const{current:_i}=ke.useRef(be!==void 0);ke.useEffect(()=>{Fe&&Fe.disabled&&!_i&&ze!==""&&Fe.tagName.toLowerCase()==="button"&&console.warn(["MUI: You are providing a disabled `button` child to the Tooltip component.","A disabled element does not fire events.","Tooltip needs to listen to the child element's events to display the title.","","Add a simple wrapper element, such as a `span`."].join(`
`))},[ze,Fe,_i])}const ni=ZN(we),er=ke.useRef(),_r=Fv(()=>{er.current!==void 0&&(document.body.style.WebkitUserSelect=er.current,er.current=void 0),Tn.clear()});ke.useEffect(()=>_r,[_r]);const Li=_i=>{IB.clear(),JD=!0,Kn(!0),Xe&&!Bt&&Xe(_i)},jr=Fv(_i=>{IB.start(800+Ie,()=>{JD=!1}),Kn(!1),Ne&&Bt&&Ne(_i),Ht.start(rn.transitions.duration.shortest,()=>{wn.current=!1})}),ss=_i=>{wn.current&&_i.type!=="touchstart"||(Fe&&Fe.removeAttribute("title"),Mn.clear(),yn.clear(),J||JD&&X?Mn.start(JD?X:J,()=>{Li(_i)}):Li(_i))},Nr=_i=>{Mn.clear(),yn.start(Ie,()=>{jr(_i)})},[,ti]=ke.useState(!1),dr=_i=>{fO(_i.target)||(ti(!1),Nr(_i))},di=_i=>{Fe||Ot(_i.currentTarget),fO(_i.target)&&(ti(!0),ss(_i))},ks=_i=>{wn.current=!0;const Ls=Ft.props;Ls.onTouchStart&&Ls.onTouchStart(_i)},fs=_i=>{ks(_i),yn.clear(),Ht.clear(),_r(),er.current=document.body.style.WebkitUserSelect,document.body.style.WebkitUserSelect="none",Tn.start(te,()=>{document.body.style.WebkitUserSelect=er.current,ss(_i)})},Uo=_i=>{Ft.props.onTouchEnd&&Ft.props.onTouchEnd(_i),_r(),yn.start(Re,()=>{jr(_i)})};ke.useEffect(()=>{if(!Bt)return;function _i(Ls){Ls.key==="Escape"&&jr(Ls)}return document.addEventListener("keydown",_i),()=>{document.removeEventListener("keydown",_i)}},[jr,Bt]);const Kr=xu(LA(Ft),Ot,n);!ze&&ze!==0&&(Bt=!1);const ir=ke.useRef(),Po=_i=>{const Ls=Ft.props;Ls.onMouseMove&&Ls.onMouseMove(_i),uS={x:_i.clientX,y:_i.clientY},ir.current&&ir.current.update()},ro={},jo=typeof ze=="string";D?(ro.title=!Bt&&jo&&!z?ze:null,ro["aria-describedby"]=Bt?ni:null):(ro["aria-label"]=jo?ze:null,ro["aria-labelledby"]=Bt&&!jo?ni:null);const Or={...ro,...mt,...Ft.props,className:Dr(mt.className,Ft.props.className),onTouchStart:ks,ref:Kr,...ie?{onMouseMove:Po}:{}};Or["data-mui-internal-clone-element"]=!0,ke.useEffect(()=>{Fe&&!Fe.getAttribute("data-mui-internal-clone-element")&&console.error(["MUI: The `children` component of the Tooltip is not forwarding its props correctly.","Please make sure that props are spread on the same element that the ref is applied to."].join(`
`))},[Fe]);const ps={};$||(Or.onTouchStart=fs,Or.onTouchEnd=Uo),z||(Or.onMouseOver=eR(ss,Or.onMouseOver),Or.onMouseLeave=eR(Nr,Or.onMouseLeave),dn||(ps.onMouseOver=ss,ps.onMouseLeave=Nr)),P||(Or.onFocus=eR(di,Or.onFocus),Or.onBlur=eR(dr,Or.onBlur),dn||(ps.onFocus=di,ps.onBlur=dr)),Ft.props.title&&console.error(["MUI: You have provided a `title` prop to the child of <Tooltip />.",`Remove this title prop \`${Ft.props.title}\` or the Tooltip component.`].join(`
`));const Ns={...r,isRtl:Xt,arrow:c,disableInteractive:dn,placement:_e,PopperComponentProp:Te,touch:wn.current},Hr=typeof Ee.popper=="function"?Ee.popper(Ns):Ee.popper,Xs=ke.useMemo(()=>{var Ls,bi;let _i=[{name:"arrow",enabled:!!Ut,options:{element:Ut,padding:4}}];return(Ls=oe.popperOptions)!=null&&Ls.modifiers&&(_i=_i.concat(oe.popperOptions.modifiers)),(bi=Hr==null?void 0:Hr.popperOptions)!=null&&bi.modifiers&&(_i=_i.concat(Hr.popperOptions.modifiers)),{...oe.popperOptions,...Hr==null?void 0:Hr.popperOptions,modifiers:_i}},[Ut,oe.popperOptions,Hr==null?void 0:Hr.popperOptions]),ho=uX(Ns),Ge=typeof Ee.transition=="function"?Ee.transition(Ns):Ee.transition,xt={slots:{popper:s.Popper,transition:s.Transition??zt,tooltip:s.Tooltip,arrow:s.Arrow,...$e},slotProps:{arrow:Ee.arrow??T.arrow,popper:{...oe,...Hr??T.popper},tooltip:Ee.tooltip??T.tooltip,transition:{...St,...Ge??T.transition}}},[Pn,jn]=ta("popper",{elementType:hX,externalForwardedProps:xt,ownerState:Ns,className:Dr(ho.popper,oe==null?void 0:oe.className)}),[Wn,zi]=ta("transition",{elementType:oA,externalForwardedProps:xt,ownerState:Ns}),[Ri,Ii]=ta("tooltip",{elementType:dX,className:ho.tooltip,externalForwardedProps:xt,ownerState:Ns}),[Lt,$r]=ta("arrow",{elementType:fX,className:ho.arrow,externalForwardedProps:xt,ownerState:Ns,ref:ln});return Qn.jsxs(ke.Fragment,{children:[ke.cloneElement(Ft,Or),Qn.jsx(Pn,{as:Te??a2,placement:_e,anchorEl:ie?{getBoundingClientRect:()=>({top:uS.y,left:uS.x,right:uS.x,bottom:uS.y,width:0,height:0})}:Fe,popperRef:ir,open:Fe?Bt:!1,id:ni,transition:!0,...ps,...jn,popperOptions:Xs,children:({TransitionProps:_i})=>Qn.jsx(Wn,{timeout:rn.transitions.duration.shorter,..._i,...zi,children:Qn.jsxs(Ri,{...Ii,children:[ze,c?Qn.jsx(Lt,{...$r}):null]})})})]})});c4.propTypes={arrow:G.bool,children:fT.isRequired,classes:G.object,className:G.string,components:G.shape({Arrow:G.elementType,Popper:G.elementType,Tooltip:G.elementType,Transition:G.elementType}),componentsProps:G.shape({arrow:G.object,popper:G.object,tooltip:G.object,transition:G.object}),describeChild:G.bool,disableFocusListener:G.bool,disableHoverListener:G.bool,disableInteractive:G.bool,disableTouchListener:G.bool,enterDelay:G.number,enterNextDelay:G.number,enterTouchDelay:G.number,followCursor:G.bool,id:G.string,leaveDelay:G.number,leaveTouchDelay:G.number,onClose:G.func,onOpen:G.func,open:G.bool,placement:G.oneOf(["auto-end","auto-start","auto","bottom-end","bottom-start","bottom","left-end","left-start","left","right-end","right-start","right","top-end","top-start","top"]),PopperComponent:G.elementType,PopperProps:G.object,slotProps:G.shape({arrow:G.oneOfType([G.func,G.object]),popper:G.oneOfType([G.func,G.object]),tooltip:G.oneOfType([G.func,G.object]),transition:G.oneOfType([G.func,G.object])}),slots:G.shape({arrow:G.elementType,popper:G.elementType,tooltip:G.elementType,transition:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),title:G.node,TransitionComponent:G.elementType,TransitionProps:G.object};const MB=io("MuiDivider",["root","absolute","fullWidth","inset","middle","flexItem","light","vertical","withChildren","withChildrenVertical","textAlignRight","textAlignLeft","wrapper","wrapperVertical"]),PB=io("MuiListItemIcon",["root","alignItemsFlexStart"]),kB=io("MuiListItemText",["root","multiline","dense","inset","primary","secondary"]);function pX(t){return wo("MuiMenuItem",t)}const hS=io("MuiMenuItem",["root","focusVisible","dense","disabled","divider","gutters","selected"]),mX=(t,e)=>{const{ownerState:n}=t;return[e.root,n.dense&&e.dense,n.divider&&e.divider,!n.disableGutters&&e.gutters]},gX=t=>{const{disabled:e,dense:n,divider:r,disableGutters:c,selected:d,classes:m}=t,T=Fo({root:["root",n&&"dense",e&&"disabled",!c&&"gutters",r&&"divider",d&&"selected"]},pX,m);return{...m,...T}},_X=lr(NA,{shouldForwardProp:t=>OI(t)||t==="classes",name:"MuiMenuItem",slot:"Root",overridesResolver:mX})(zo(({theme:t})=>({...t.typography.body1,display:"flex",justifyContent:"flex-start",alignItems:"center",position:"relative",textDecoration:"none",minHeight:48,paddingTop:6,paddingBottom:6,boxSizing:"border-box",whiteSpace:"nowrap","&:hover":{textDecoration:"none",backgroundColor:(t.vars||t).palette.action.hover,"@media (hover: none)":{backgroundColor:"transparent"}},[`&.${hS.selected}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Lc(t.palette.primary.main,t.palette.action.selectedOpacity),[`&.${hS.focusVisible}`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.focusOpacity}))`:Lc(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.focusOpacity)}},[`&.${hS.selected}:hover`]:{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / calc(${t.vars.palette.action.selectedOpacity} + ${t.vars.palette.action.hoverOpacity}))`:Lc(t.palette.primary.main,t.palette.action.selectedOpacity+t.palette.action.hoverOpacity),"@media (hover: none)":{backgroundColor:t.vars?`rgba(${t.vars.palette.primary.mainChannel} / ${t.vars.palette.action.selectedOpacity})`:Lc(t.palette.primary.main,t.palette.action.selectedOpacity)}},[`&.${hS.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${hS.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`& + .${MB.root}`]:{marginTop:t.spacing(1),marginBottom:t.spacing(1)},[`& + .${MB.inset}`]:{marginLeft:52},[`& .${kB.root}`]:{marginTop:0,marginBottom:0},[`& .${kB.inset}`]:{paddingLeft:36},[`& .${PB.root}`]:{minWidth:36},variants:[{props:({ownerState:e})=>!e.disableGutters,style:{paddingLeft:16,paddingRight:16}},{props:({ownerState:e})=>e.divider,style:{borderBottom:`1px solid ${(t.vars||t).palette.divider}`,backgroundClip:"padding-box"}},{props:({ownerState:e})=>!e.dense,style:{[t.breakpoints.up("sm")]:{minHeight:"auto"}}},{props:({ownerState:e})=>e.dense,style:{minHeight:32,paddingTop:4,paddingBottom:4,...t.typography.body2,[`& .${PB.root} svg`]:{fontSize:"1.25rem"}}}]}))),Rk=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiMenuItem"}),{autoFocus:c=!1,component:d="li",dense:m=!1,divider:s=!1,disableGutters:T=!1,focusVisibleClassName:D,role:P="menuitem",tabIndex:z,className:F,...$}=r,J=ke.useContext(gO),X=ke.useMemo(()=>({dense:m||J.dense||!1,disableGutters:T}),[J.dense,m,T]),te=ke.useRef(null);px(()=>{c&&(te.current?te.current.focus():console.error("MUI: Unable to set focus to a MenuItem whose component has not been rendered."))},[c]);const ie={...r,dense:X.dense,divider:s,disableGutters:T},we=gX(r),Ie=xu(te,n);let Re;return r.disabled||(Re=z!==void 0?z:-1),Qn.jsx(gO.Provider,{value:X,children:Qn.jsx(_X,{ref:Ie,role:P,tabIndex:Re,component:d,focusVisibleClassName:Dr(we.focusVisible,D),className:Dr(we.root,F),...$,ownerState:ie,classes:we})})});Rk.propTypes={autoFocus:G.bool,children:G.node,classes:G.object,className:G.string,component:G.elementType,dense:G.bool,disabled:G.bool,disableGutters:G.bool,divider:G.bool,focusVisibleClassName:G.string,role:G.string,selected:G.bool,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),tabIndex:G.number};const NB=kA([Qn.jsx("path",{d:"M18 11c.7 0 1.37.1 2 .29V9l-8-6-8 6v12h7.68c-.43-.91-.68-1.92-.68-3 0-3.87 3.13-7 7-7"},"0"),Qn.jsx("path",{d:"M18 13c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5m3 5.5h-2.5V21h-1v-2.5H15v-1h2.5V15h1v2.5H21z"},"1")],"AddHome");var dS={},LB;function yX(){if(LB)return dS;LB=1,Object.defineProperty(dS,"__esModule",{value:!0}),dS.parse=m,dS.serialize=D;const t=/^[\u0021-\u003A\u003C\u003E-\u007E]+$/,e=/^[\u0021-\u003A\u003C-\u007E]*$/,n=/^([.]?[a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)([.][a-z0-9]([a-z0-9-]{0,61}[a-z0-9])?)*$/i,r=/^[\u0020-\u003A\u003D-\u007E]*$/,c=Object.prototype.toString,d=(()=>{const F=function(){};return F.prototype=Object.create(null),F})();function m(F,$){const J=new d,X=F.length;if(X<2)return J;const te=($==null?void 0:$.decode)||P;let ie=0;do{const we=F.indexOf("=",ie);if(we===-1)break;const Ie=F.indexOf(";",ie),Re=Ie===-1?X:Ie;if(we>Re){ie=F.lastIndexOf(";",we-1)+1;continue}const Ne=s(F,ie,we),Xe=T(F,we,Ne),be=F.slice(Ne,Xe);if(J[be]===void 0){let _e=s(F,we+1,Re),Te=T(F,Re,_e);const oe=te(F.slice(_e,Te));J[be]=oe}ie=Re+1}while(ie<X);return J}function s(F,$,J){do{const X=F.charCodeAt($);if(X!==32&&X!==9)return $}while(++$<J);return J}function T(F,$,J){for(;$>J;){const X=F.charCodeAt(--$);if(X!==32&&X!==9)return $+1}return J}function D(F,$,J){const X=(J==null?void 0:J.encode)||encodeURIComponent;if(!t.test(F))throw new TypeError(`argument name is invalid: ${F}`);const te=X($);if(!e.test(te))throw new TypeError(`argument val is invalid: ${$}`);let ie=F+"="+te;if(!J)return ie;if(J.maxAge!==void 0){if(!Number.isInteger(J.maxAge))throw new TypeError(`option maxAge is invalid: ${J.maxAge}`);ie+="; Max-Age="+J.maxAge}if(J.domain){if(!n.test(J.domain))throw new TypeError(`option domain is invalid: ${J.domain}`);ie+="; Domain="+J.domain}if(J.path){if(!r.test(J.path))throw new TypeError(`option path is invalid: ${J.path}`);ie+="; Path="+J.path}if(J.expires){if(!z(J.expires)||!Number.isFinite(J.expires.valueOf()))throw new TypeError(`option expires is invalid: ${J.expires}`);ie+="; Expires="+J.expires.toUTCString()}if(J.httpOnly&&(ie+="; HttpOnly"),J.secure&&(ie+="; Secure"),J.partitioned&&(ie+="; Partitioned"),J.priority)switch(typeof J.priority=="string"?J.priority.toLowerCase():void 0){case"low":ie+="; Priority=Low";break;case"medium":ie+="; Priority=Medium";break;case"high":ie+="; Priority=High";break;default:throw new TypeError(`option priority is invalid: ${J.priority}`)}if(J.sameSite)switch(typeof J.sameSite=="string"?J.sameSite.toLowerCase():J.sameSite){case!0:case"strict":ie+="; SameSite=Strict";break;case"lax":ie+="; SameSite=Lax";break;case"none":ie+="; SameSite=None";break;default:throw new TypeError(`option sameSite is invalid: ${J.sameSite}`)}return ie}function P(F){if(F.indexOf("%")===-1)return F;try{return decodeURIComponent(F)}catch{return F}}function z(F){return c.call(F)==="[object Date]"}return dS}yX();var zB="popstate";function vX(t={}){function e(r,c){let{pathname:d,search:m,hash:s}=r.location;return Ok("",{pathname:d,search:m,hash:s},c.state&&c.state.usr||null,c.state&&c.state.key||"default")}function n(r,c){return typeof c=="string"?c:uA(c)}return xX(e,n,null,t)}function Lo(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}function qm(t,e){if(!t){typeof console<"u"&&console.warn(e);try{throw new Error(e)}catch{}}}function bX(){return Math.random().toString(36).substring(2,10)}function BB(t,e){return{usr:t.state,key:t.key,idx:e}}function Ok(t,e,n=null,r){return{pathname:typeof t=="string"?t:t.pathname,search:"",hash:"",...typeof e=="string"?pT(e):e,state:n,key:e&&e.key||r||bX()}}function uA({pathname:t="/",search:e="",hash:n=""}){return e&&e!=="?"&&(t+=e.charAt(0)==="?"?e:"?"+e),n&&n!=="#"&&(t+=n.charAt(0)==="#"?n:"#"+n),t}function pT(t){let e={};if(t){let n=t.indexOf("#");n>=0&&(e.hash=t.substring(n),t=t.substring(0,n));let r=t.indexOf("?");r>=0&&(e.search=t.substring(r),t=t.substring(0,r)),t&&(e.pathname=t)}return e}function xX(t,e,n,r={}){let{window:c=document.defaultView,v5Compat:d=!1}=r,m=c.history,s="POP",T=null,D=P();D==null&&(D=0,m.replaceState({...m.state,idx:D},""));function P(){return(m.state||{idx:null}).idx}function z(){s="POP";let te=P(),ie=te==null?null:te-D;D=te,T&&T({action:s,location:X.location,delta:ie})}function F(te,ie){s="PUSH";let we=Ok(X.location,te,ie);D=P()+1;let Ie=BB(we,D),Re=X.createHref(we);try{m.pushState(Ie,"",Re)}catch(Ne){if(Ne instanceof DOMException&&Ne.name==="DataCloneError")throw Ne;c.location.assign(Re)}d&&T&&T({action:s,location:X.location,delta:1})}function $(te,ie){s="REPLACE";let we=Ok(X.location,te,ie);D=P();let Ie=BB(we,D),Re=X.createHref(we);m.replaceState(Ie,"",Re),d&&T&&T({action:s,location:X.location,delta:0})}function J(te){return wX(te)}let X={get action(){return s},get location(){return t(c,m)},listen(te){if(T)throw new Error("A history only accepts one active listener");return c.addEventListener(zB,z),T=te,()=>{c.removeEventListener(zB,z),T=null}},createHref(te){return e(c,te)},createURL:J,encodeLocation(te){let ie=J(te);return{pathname:ie.pathname,search:ie.search,hash:ie.hash}},push:F,replace:$,go(te){return m.go(te)}};return X}function wX(t,e=!1){let n="http://localhost";typeof window<"u"&&(n=window.location.origin!=="null"?window.location.origin:window.location.href),Lo(n,"No window.location.(origin|href) available to create URL");let r=typeof t=="string"?t:uA(t);return r=r.replace(/ $/,"%20"),!e&&r.startsWith("//")&&(r=n+r),new URL(r,n)}function u4(t,e,n="/"){return TX(t,e,n,!1)}function TX(t,e,n,r){let c=typeof e=="string"?pT(e):e,d=S_(c.pathname||"/",n);if(d==null)return null;let m=h4(t);EX(m);let s=null;for(let T=0;s==null&&T<m.length;++T){let D=NX(d);s=PX(m[T],D,r)}return s}function h4(t,e=[],n=[],r=""){let c=(d,m,s)=>{let T={relativePath:s===void 0?d.path||"":s,caseSensitive:d.caseSensitive===!0,childrenIndex:m,route:d};T.relativePath.startsWith("/")&&(Lo(T.relativePath.startsWith(r),`Absolute route path "${T.relativePath}" nested under path "${r}" is not valid. An absolute child route path must start with the combined path of all its parent routes.`),T.relativePath=T.relativePath.slice(r.length));let D=b_([r,T.relativePath]),P=n.concat(T);d.children&&d.children.length>0&&(Lo(d.index!==!0,`Index routes must not have child routes. Please remove all child routes from route path "${D}".`),h4(d.children,e,P,D)),!(d.path==null&&!d.index)&&e.push({path:D,score:IX(D,d.index),routesMeta:P})};return t.forEach((d,m)=>{var s;if(d.path===""||!((s=d.path)!=null&&s.includes("?")))c(d,m);else for(let T of d4(d.path))c(d,m,T)}),e}function d4(t){let e=t.split("/");if(e.length===0)return[];let[n,...r]=e,c=n.endsWith("?"),d=n.replace(/\?$/,"");if(r.length===0)return c?[d,""]:[d];let m=d4(r.join("/")),s=[];return s.push(...m.map(T=>T===""?d:[d,T].join("/"))),c&&s.push(...m),s.map(T=>t.startsWith("/")&&T===""?"/":T)}function EX(t){t.sort((e,n)=>e.score!==n.score?n.score-e.score:MX(e.routesMeta.map(r=>r.childrenIndex),n.routesMeta.map(r=>r.childrenIndex)))}var SX=/^:[\w-]+$/,AX=3,CX=2,DX=1,RX=10,OX=-2,FB=t=>t==="*";function IX(t,e){let n=t.split("/"),r=n.length;return n.some(FB)&&(r+=OX),e&&(r+=CX),n.filter(c=>!FB(c)).reduce((c,d)=>c+(SX.test(d)?AX:d===""?DX:RX),r)}function MX(t,e){return t.length===e.length&&t.slice(0,-1).every((r,c)=>r===e[c])?t[t.length-1]-e[e.length-1]:0}function PX(t,e,n=!1){let{routesMeta:r}=t,c={},d="/",m=[];for(let s=0;s<r.length;++s){let T=r[s],D=s===r.length-1,P=d==="/"?e:e.slice(d.length)||"/",z=bO({path:T.relativePath,caseSensitive:T.caseSensitive,end:D},P),F=T.route;if(!z&&D&&n&&!r[r.length-1].route.index&&(z=bO({path:T.relativePath,caseSensitive:T.caseSensitive,end:!1},P)),!z)return null;Object.assign(c,z.params),m.push({params:c,pathname:b_([d,z.pathname]),pathnameBase:FX(b_([d,z.pathnameBase])),route:F}),z.pathnameBase!=="/"&&(d=b_([d,z.pathnameBase]))}return m}function bO(t,e){typeof t=="string"&&(t={path:t,caseSensitive:!1,end:!0});let[n,r]=kX(t.path,t.caseSensitive,t.end),c=e.match(n);if(!c)return null;let d=c[0],m=d.replace(/(.)\/+$/,"$1"),s=c.slice(1);return{params:r.reduce((D,{paramName:P,isOptional:z},F)=>{if(P==="*"){let J=s[F]||"";m=d.slice(0,d.length-J.length).replace(/(.)\/+$/,"$1")}const $=s[F];return z&&!$?D[P]=void 0:D[P]=($||"").replace(/%2F/g,"/"),D},{}),pathname:d,pathnameBase:m,pattern:t}}function kX(t,e=!1,n=!0){qm(t==="*"||!t.endsWith("*")||t.endsWith("/*"),`Route path "${t}" will be treated as if it were "${t.replace(/\*$/,"/*")}" because the \`*\` character must always follow a \`/\` in the pattern. To get rid of this warning, please change the route path to "${t.replace(/\*$/,"/*")}".`);let r=[],c="^"+t.replace(/\/*\*?$/,"").replace(/^\/*/,"/").replace(/[\\.*+^${}|()[\]]/g,"\\$&").replace(/\/:([\w-]+)(\?)?/g,(m,s,T)=>(r.push({paramName:s,isOptional:T!=null}),T?"/?([^\\/]+)?":"/([^\\/]+)"));return t.endsWith("*")?(r.push({paramName:"*"}),c+=t==="*"||t==="/*"?"(.*)$":"(?:\\/(.+)|\\/*)$"):n?c+="\\/*$":t!==""&&t!=="/"&&(c+="(?:(?=\\/|$))"),[new RegExp(c,e?void 0:"i"),r]}function NX(t){try{return t.split("/").map(e=>decodeURIComponent(e).replace(/\//g,"%2F")).join("/")}catch(e){return qm(!1,`The URL path "${t}" could not be decoded because it is a malformed URL segment. This is probably due to a bad percent encoding (${e}).`),t}}function S_(t,e){if(e==="/")return t;if(!t.toLowerCase().startsWith(e.toLowerCase()))return null;let n=e.endsWith("/")?e.length-1:e.length,r=t.charAt(n);return r&&r!=="/"?null:t.slice(n)||"/"}function LX(t,e="/"){let{pathname:n,search:r="",hash:c=""}=typeof t=="string"?pT(t):t;return{pathname:n?n.startsWith("/")?n:zX(n,e):e,search:VX(r),hash:UX(c)}}function zX(t,e){let n=e.replace(/\/+$/,"").split("/");return t.split("/").forEach(c=>{c===".."?n.length>1&&n.pop():c!=="."&&n.push(c)}),n.length>1?n.join("/"):"/"}function vP(t,e,n,r){return`Cannot include a '${t}' character in a manually specified \`to.${e}\` field [${JSON.stringify(r)}].  Please separate it out to the \`to.${n}\` field. Alternatively you may provide the full path as a string in <Link to="..."> and the router will parse it for you.`}function BX(t){return t.filter((e,n)=>n===0||e.route.path&&e.route.path.length>0)}function f4(t){let e=BX(t);return e.map((n,r)=>r===e.length-1?n.pathname:n.pathnameBase)}function p4(t,e,n,r=!1){let c;typeof t=="string"?c=pT(t):(c={...t},Lo(!c.pathname||!c.pathname.includes("?"),vP("?","pathname","search",c)),Lo(!c.pathname||!c.pathname.includes("#"),vP("#","pathname","hash",c)),Lo(!c.search||!c.search.includes("#"),vP("#","search","hash",c)));let d=t===""||c.pathname==="",m=d?"/":c.pathname,s;if(m==null)s=n;else{let z=e.length-1;if(!r&&m.startsWith("..")){let F=m.split("/");for(;F[0]==="..";)F.shift(),z-=1;c.pathname=F.join("/")}s=z>=0?e[z]:"/"}let T=LX(c,s),D=m&&m!=="/"&&m.endsWith("/"),P=(d||m===".")&&n.endsWith("/");return!T.pathname.endsWith("/")&&(D||P)&&(T.pathname+="/"),T}var b_=t=>t.join("/").replace(/\/\/+/g,"/"),FX=t=>t.replace(/\/+$/,"").replace(/^\/*/,"/"),VX=t=>!t||t==="?"?"":t.startsWith("?")?t:"?"+t,UX=t=>!t||t==="#"?"":t.startsWith("#")?t:"#"+t;function jX(t){return t!=null&&typeof t.status=="number"&&typeof t.statusText=="string"&&typeof t.internal=="boolean"&&"data"in t}var m4=["POST","PUT","PATCH","DELETE"];new Set(m4);var HX=["GET",...m4];new Set(HX);var mT=ke.createContext(null);mT.displayName="DataRouter";var LI=ke.createContext(null);LI.displayName="DataRouterState";var g4=ke.createContext({isTransitioning:!1});g4.displayName="ViewTransition";var $X=ke.createContext(new Map);$X.displayName="Fetchers";var GX=ke.createContext(null);GX.displayName="Await";var Zm=ke.createContext(null);Zm.displayName="Navigation";var FA=ke.createContext(null);FA.displayName="Location";var k_=ke.createContext({outlet:null,matches:[],isDataRoute:!1});k_.displayName="Route";var l2=ke.createContext(null);l2.displayName="RouteError";function qX(t,{relative:e}={}){Lo(VA(),"useHref() may be used only in the context of a <Router> component.");let{basename:n,navigator:r}=ke.useContext(Zm),{hash:c,pathname:d,search:m}=UA(t,{relative:e}),s=d;return n!=="/"&&(s=d==="/"?n:b_([n,d])),r.createHref({pathname:s,search:m,hash:c})}function VA(){return ke.useContext(FA)!=null}function Cx(){return Lo(VA(),"useLocation() may be used only in the context of a <Router> component."),ke.useContext(FA).location}var _4="You should call navigate() in a React.useEffect(), not when your component is first rendered.";function y4(t){ke.useContext(Zm).static||ke.useLayoutEffect(t)}function Xm(){let{isDataRoute:t}=ke.useContext(k_);return t?sQ():WX()}function WX(){Lo(VA(),"useNavigate() may be used only in the context of a <Router> component.");let t=ke.useContext(mT),{basename:e,navigator:n}=ke.useContext(Zm),{matches:r}=ke.useContext(k_),{pathname:c}=Cx(),d=JSON.stringify(f4(r)),m=ke.useRef(!1);return y4(()=>{m.current=!0}),ke.useCallback((T,D={})=>{if(qm(m.current,_4),!m.current)return;if(typeof T=="number"){n.go(T);return}let P=p4(T,JSON.parse(d),c,D.relative==="path");t==null&&e!=="/"&&(P.pathname=P.pathname==="/"?e:b_([e,P.pathname])),(D.replace?n.replace:n.push)(P,D.state,D)},[e,n,d,c,t])}ke.createContext(null);function UA(t,{relative:e}={}){let{matches:n}=ke.useContext(k_),{pathname:r}=Cx(),c=JSON.stringify(f4(n));return ke.useMemo(()=>p4(t,JSON.parse(c),r,e==="path"),[t,c,r,e])}function YX(t,e){return v4(t,e)}function v4(t,e,n,r){var ie;Lo(VA(),"useRoutes() may be used only in the context of a <Router> component.");let{navigator:c}=ke.useContext(Zm),{matches:d}=ke.useContext(k_),m=d[d.length-1],s=m?m.params:{},T=m?m.pathname:"/",D=m?m.pathnameBase:"/",P=m&&m.route;{let we=P&&P.path||"";b4(T,!P||we.endsWith("*")||we.endsWith("*?"),`You rendered descendant <Routes> (or called \`useRoutes()\`) at "${T}" (under <Route path="${we}">) but the parent route path has no trailing "*". This means if you navigate deeper, the parent won't match anymore and therefore the child routes will never render.

Please change the parent <Route path="${we}"> to <Route path="${we==="/"?"*":`${we}/*`}">.`)}let z=Cx(),F;if(e){let we=typeof e=="string"?pT(e):e;Lo(D==="/"||((ie=we.pathname)==null?void 0:ie.startsWith(D)),`When overriding the location using \`<Routes location>\` or \`useRoutes(routes, location)\`, the location pathname must begin with the portion of the URL pathname that was matched by all parent routes. The current pathname base is "${D}" but pathname "${we.pathname}" was given in the \`location\` prop.`),F=we}else F=z;let $=F.pathname||"/",J=$;if(D!=="/"){let we=D.replace(/^\//,"").split("/");J="/"+$.replace(/^\//,"").split("/").slice(we.length).join("/")}let X=u4(t,{pathname:J});qm(P||X!=null,`No routes matched location "${F.pathname}${F.search}${F.hash}" `),qm(X==null||X[X.length-1].route.element!==void 0||X[X.length-1].route.Component!==void 0||X[X.length-1].route.lazy!==void 0,`Matched leaf route at location "${F.pathname}${F.search}${F.hash}" does not have an element or Component. This means it will render an <Outlet /> with a null value by default resulting in an "empty" page.`);let te=JX(X&&X.map(we=>Object.assign({},we,{params:Object.assign({},s,we.params),pathname:b_([D,c.encodeLocation?c.encodeLocation(we.pathname).pathname:we.pathname]),pathnameBase:we.pathnameBase==="/"?D:b_([D,c.encodeLocation?c.encodeLocation(we.pathnameBase).pathname:we.pathnameBase])})),d,n,r);return e&&te?ke.createElement(FA.Provider,{value:{location:{pathname:"/",search:"",hash:"",state:null,key:"default",...F},navigationType:"POP"}},te):te}function ZX(){let t=rQ(),e=jX(t)?`${t.status} ${t.statusText}`:t instanceof Error?t.message:JSON.stringify(t),n=t instanceof Error?t.stack:null,r="rgba(200,200,200, 0.5)",c={padding:"0.5rem",backgroundColor:r},d={padding:"2px 4px",backgroundColor:r},m=null;return console.error("Error handled by React Router default ErrorBoundary:",t),m=ke.createElement(ke.Fragment,null,ke.createElement("p",null,"💿 Hey developer 👋"),ke.createElement("p",null,"You can provide a way better UX than this when your app throws errors by providing your own ",ke.createElement("code",{style:d},"ErrorBoundary")," or"," ",ke.createElement("code",{style:d},"errorElement")," prop on your route.")),ke.createElement(ke.Fragment,null,ke.createElement("h2",null,"Unexpected Application Error!"),ke.createElement("h3",{style:{fontStyle:"italic"}},e),n?ke.createElement("pre",{style:c},n):null,m)}var XX=ke.createElement(ZX,null),QX=class extends ke.Component{constructor(t){super(t),this.state={location:t.location,revalidation:t.revalidation,error:t.error}}static getDerivedStateFromError(t){return{error:t}}static getDerivedStateFromProps(t,e){return e.location!==t.location||e.revalidation!=="idle"&&t.revalidation==="idle"?{error:t.error,location:t.location,revalidation:t.revalidation}:{error:t.error!==void 0?t.error:e.error,location:e.location,revalidation:t.revalidation||e.revalidation}}componentDidCatch(t,e){console.error("React Router caught the following error during render",t,e)}render(){return this.state.error!==void 0?ke.createElement(k_.Provider,{value:this.props.routeContext},ke.createElement(l2.Provider,{value:this.state.error,children:this.props.component})):this.props.children}};function KX({routeContext:t,match:e,children:n}){let r=ke.useContext(mT);return r&&r.static&&r.staticContext&&(e.route.errorElement||e.route.ErrorBoundary)&&(r.staticContext._deepestRenderedBoundaryId=e.route.id),ke.createElement(k_.Provider,{value:t},n)}function JX(t,e=[],n=null,r=null){if(t==null){if(!n)return null;if(n.errors)t=n.matches;else if(e.length===0&&!n.initialized&&n.matches.length>0)t=n.matches;else return null}let c=t,d=n==null?void 0:n.errors;if(d!=null){let T=c.findIndex(D=>D.route.id&&(d==null?void 0:d[D.route.id])!==void 0);Lo(T>=0,`Could not find a matching route for errors on route IDs: ${Object.keys(d).join(",")}`),c=c.slice(0,Math.min(c.length,T+1))}let m=!1,s=-1;if(n)for(let T=0;T<c.length;T++){let D=c[T];if((D.route.HydrateFallback||D.route.hydrateFallbackElement)&&(s=T),D.route.id){let{loaderData:P,errors:z}=n,F=D.route.loader&&!P.hasOwnProperty(D.route.id)&&(!z||z[D.route.id]===void 0);if(D.route.lazy||F){m=!0,s>=0?c=c.slice(0,s+1):c=[c[0]];break}}}return c.reduceRight((T,D,P)=>{let z,F=!1,$=null,J=null;n&&(z=d&&D.route.id?d[D.route.id]:void 0,$=D.route.errorElement||XX,m&&(s<0&&P===0?(b4("route-fallback",!1,"No `HydrateFallback` element provided to render during initial hydration"),F=!0,J=null):s===P&&(F=!0,J=D.route.hydrateFallbackElement||null)));let X=e.concat(c.slice(0,P+1)),te=()=>{let ie;return z?ie=$:F?ie=J:D.route.Component?ie=ke.createElement(D.route.Component,null):D.route.element?ie=D.route.element:ie=T,ke.createElement(KX,{match:D,routeContext:{outlet:T,matches:X,isDataRoute:n!=null},children:ie})};return n&&(D.route.ErrorBoundary||D.route.errorElement||P===0)?ke.createElement(QX,{location:n.location,revalidation:n.revalidation,component:$,error:z,children:te(),routeContext:{outlet:null,matches:X,isDataRoute:!0}}):te()},null)}function c2(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function eQ(t){let e=ke.useContext(mT);return Lo(e,c2(t)),e}function tQ(t){let e=ke.useContext(LI);return Lo(e,c2(t)),e}function nQ(t){let e=ke.useContext(k_);return Lo(e,c2(t)),e}function u2(t){let e=nQ(t),n=e.matches[e.matches.length-1];return Lo(n.route.id,`${t} can only be used on routes that contain a unique "id"`),n.route.id}function iQ(){return u2("useRouteId")}function rQ(){var r;let t=ke.useContext(l2),e=tQ("useRouteError"),n=u2("useRouteError");return t!==void 0?t:(r=e.errors)==null?void 0:r[n]}function sQ(){let{router:t}=eQ("useNavigate"),e=u2("useNavigate"),n=ke.useRef(!1);return y4(()=>{n.current=!0}),ke.useCallback(async(c,d={})=>{qm(n.current,_4),n.current&&(typeof c=="number"?t.navigate(c):await t.navigate(c,{fromRouteId:e,...d}))},[t,e])}var VB={};function b4(t,e,n){!e&&!VB[t]&&(VB[t]=!0,qm(!1,n))}ke.memo(oQ);function oQ({routes:t,future:e,state:n}){return v4(t,void 0,n,e)}function f_(t){Lo(!1,"A <Route> is only ever to be used as the child of <Routes> element, never rendered directly. Please wrap your <Route> in a <Routes>.")}function aQ({basename:t="/",children:e=null,location:n,navigationType:r="POP",navigator:c,static:d=!1}){Lo(!VA(),"You cannot render a <Router> inside another <Router>. You should never have more than one in your app.");let m=t.replace(/^\/*/,"/"),s=ke.useMemo(()=>({basename:m,navigator:c,static:d,future:{}}),[m,c,d]);typeof n=="string"&&(n=pT(n));let{pathname:T="/",search:D="",hash:P="",state:z=null,key:F="default"}=n,$=ke.useMemo(()=>{let J=S_(T,m);return J==null?null:{location:{pathname:J,search:D,hash:P,state:z,key:F},navigationType:r}},[m,T,D,P,z,F,r]);return qm($!=null,`<Router basename="${m}"> is not able to match the URL "${T}${D}${P}" because it does not start with the basename, so the <Router> won't render anything.`),$==null?null:ke.createElement(Zm.Provider,{value:s},ke.createElement(FA.Provider,{children:e,value:$}))}function lQ({children:t,location:e}){return YX(Ik(t),e)}function Ik(t,e=[]){let n=[];return ke.Children.forEach(t,(r,c)=>{if(!ke.isValidElement(r))return;let d=[...e,c];if(r.type===ke.Fragment){n.push.apply(n,Ik(r.props.children,d));return}Lo(r.type===f_,`[${typeof r.type=="string"?r.type:r.type.name}] is not a <Route> component. All component children of <Routes> must be a <Route> or <React.Fragment>`),Lo(!r.props.index||!r.props.children,"An index route cannot have child routes.");let m={id:r.props.id||d.join("-"),caseSensitive:r.props.caseSensitive,element:r.props.element,Component:r.props.Component,index:r.props.index,path:r.props.path,loader:r.props.loader,action:r.props.action,hydrateFallbackElement:r.props.hydrateFallbackElement,HydrateFallback:r.props.HydrateFallback,errorElement:r.props.errorElement,ErrorBoundary:r.props.ErrorBoundary,hasErrorBoundary:r.props.hasErrorBoundary===!0||r.props.ErrorBoundary!=null||r.props.errorElement!=null,shouldRevalidate:r.props.shouldRevalidate,handle:r.props.handle,lazy:r.props.lazy};r.props.children&&(m.children=Ik(r.props.children,d)),n.push(m)}),n}var FR="get",VR="application/x-www-form-urlencoded";function zI(t){return t!=null&&typeof t.tagName=="string"}function cQ(t){return zI(t)&&t.tagName.toLowerCase()==="button"}function uQ(t){return zI(t)&&t.tagName.toLowerCase()==="form"}function hQ(t){return zI(t)&&t.tagName.toLowerCase()==="input"}function dQ(t){return!!(t.metaKey||t.altKey||t.ctrlKey||t.shiftKey)}function fQ(t,e){return t.button===0&&(!e||e==="_self")&&!dQ(t)}var tR=null;function pQ(){if(tR===null)try{new FormData(document.createElement("form"),0),tR=!1}catch{tR=!0}return tR}var mQ=new Set(["application/x-www-form-urlencoded","multipart/form-data","text/plain"]);function bP(t){return t!=null&&!mQ.has(t)?(qm(!1,`"${t}" is not a valid \`encType\` for \`<Form>\`/\`<fetcher.Form>\` and will default to "${VR}"`),null):t}function gQ(t,e){let n,r,c,d,m;if(uQ(t)){let s=t.getAttribute("action");r=s?S_(s,e):null,n=t.getAttribute("method")||FR,c=bP(t.getAttribute("enctype"))||VR,d=new FormData(t)}else if(cQ(t)||hQ(t)&&(t.type==="submit"||t.type==="image")){let s=t.form;if(s==null)throw new Error('Cannot submit a <button> or <input type="submit"> without a <form>');let T=t.getAttribute("formaction")||s.getAttribute("action");if(r=T?S_(T,e):null,n=t.getAttribute("formmethod")||s.getAttribute("method")||FR,c=bP(t.getAttribute("formenctype"))||bP(s.getAttribute("enctype"))||VR,d=new FormData(s,t),!pQ()){let{name:D,type:P,value:z}=t;if(P==="image"){let F=D?`${D}.`:"";d.append(`${F}x`,"0"),d.append(`${F}y`,"0")}else D&&d.append(D,z)}}else{if(zI(t))throw new Error('Cannot submit element that is not <form>, <button>, or <input type="submit|image">');n=FR,r=null,c=VR,m=t}return d&&c==="text/plain"&&(m=d,d=void 0),{action:r,method:n.toLowerCase(),encType:c,formData:d,body:m}}function h2(t,e){if(t===!1||t===null||typeof t>"u")throw new Error(e)}async function _Q(t,e){if(t.id in e)return e[t.id];try{let n=await import(t.module);return e[t.id]=n,n}catch(n){return console.error(`Error loading route module \`${t.module}\`, reloading page...`),console.error(n),window.__reactRouterContext&&window.__reactRouterContext.isSpaMode,window.location.reload(),new Promise(()=>{})}}function yQ(t){return t==null?!1:t.href==null?t.rel==="preload"&&typeof t.imageSrcSet=="string"&&typeof t.imageSizes=="string":typeof t.rel=="string"&&typeof t.href=="string"}async function vQ(t,e,n){let r=await Promise.all(t.map(async c=>{let d=e.routes[c.route.id];if(d){let m=await _Q(d,n);return m.links?m.links():[]}return[]}));return TQ(r.flat(1).filter(yQ).filter(c=>c.rel==="stylesheet"||c.rel==="preload").map(c=>c.rel==="stylesheet"?{...c,rel:"prefetch",as:"style"}:{...c,rel:"prefetch"}))}function UB(t,e,n,r,c,d){let m=(T,D)=>n[D]?T.route.id!==n[D].route.id:!0,s=(T,D)=>{var P;return n[D].pathname!==T.pathname||((P=n[D].route.path)==null?void 0:P.endsWith("*"))&&n[D].params["*"]!==T.params["*"]};return d==="assets"?e.filter((T,D)=>m(T,D)||s(T,D)):d==="data"?e.filter((T,D)=>{var z;let P=r.routes[T.route.id];if(!P||!P.hasLoader)return!1;if(m(T,D)||s(T,D))return!0;if(T.route.shouldRevalidate){let F=T.route.shouldRevalidate({currentUrl:new URL(c.pathname+c.search+c.hash,window.origin),currentParams:((z=n[0])==null?void 0:z.params)||{},nextUrl:new URL(t,window.origin),nextParams:T.params,defaultShouldRevalidate:!0});if(typeof F=="boolean")return F}return!0}):[]}function bQ(t,e,{includeHydrateFallback:n}={}){return xQ(t.map(r=>{let c=e.routes[r.route.id];if(!c)return[];let d=[c.module];return c.clientActionModule&&(d=d.concat(c.clientActionModule)),c.clientLoaderModule&&(d=d.concat(c.clientLoaderModule)),n&&c.hydrateFallbackModule&&(d=d.concat(c.hydrateFallbackModule)),c.imports&&(d=d.concat(c.imports)),d}).flat(1))}function xQ(t){return[...new Set(t)]}function wQ(t){let e={},n=Object.keys(t).sort();for(let r of n)e[r]=t[r];return e}function TQ(t,e){let n=new Set;return new Set(e),t.reduce((r,c)=>{let d=JSON.stringify(wQ(c));return n.has(d)||(n.add(d),r.push({key:d,link:c})),r},[])}Object.getOwnPropertyNames(Object.prototype).sort().join("\0");var EQ=new Set([100,101,204,205]);function SQ(t,e){let n=typeof t=="string"?new URL(t,typeof window>"u"?"server://singlefetch/":window.location.origin):t;return n.pathname==="/"?n.pathname="_root.data":e&&S_(n.pathname,e)==="/"?n.pathname=`${e.replace(/\/$/,"")}/_root.data`:n.pathname=`${n.pathname.replace(/\/$/,"")}.data`,n}function x4(){let t=ke.useContext(mT);return h2(t,"You must render this element inside a <DataRouterContext.Provider> element"),t}function AQ(){let t=ke.useContext(LI);return h2(t,"You must render this element inside a <DataRouterStateContext.Provider> element"),t}var d2=ke.createContext(void 0);d2.displayName="FrameworkContext";function w4(){let t=ke.useContext(d2);return h2(t,"You must render this element inside a <HydratedRouter> element"),t}function CQ(t,e){let n=ke.useContext(d2),[r,c]=ke.useState(!1),[d,m]=ke.useState(!1),{onFocus:s,onBlur:T,onMouseEnter:D,onMouseLeave:P,onTouchStart:z}=e,F=ke.useRef(null);ke.useEffect(()=>{if(t==="render"&&m(!0),t==="viewport"){let X=ie=>{ie.forEach(we=>{m(we.isIntersecting)})},te=new IntersectionObserver(X,{threshold:.5});return F.current&&te.observe(F.current),()=>{te.disconnect()}}},[t]),ke.useEffect(()=>{if(r){let X=setTimeout(()=>{m(!0)},100);return()=>{clearTimeout(X)}}},[r]);let $=()=>{c(!0)},J=()=>{c(!1),m(!1)};return n?t!=="intent"?[d,F,{}]:[d,F,{onFocus:fS(s,$),onBlur:fS(T,J),onMouseEnter:fS(D,$),onMouseLeave:fS(P,J),onTouchStart:fS(z,$)}]:[!1,F,{}]}function fS(t,e){return n=>{t&&t(n),n.defaultPrevented||e(n)}}function DQ({page:t,...e}){let{router:n}=x4(),r=ke.useMemo(()=>u4(n.routes,t,n.basename),[n.routes,t,n.basename]);return r?ke.createElement(OQ,{page:t,matches:r,...e}):null}function RQ(t){let{manifest:e,routeModules:n}=w4(),[r,c]=ke.useState([]);return ke.useEffect(()=>{let d=!1;return vQ(t,e,n).then(m=>{d||c(m)}),()=>{d=!0}},[t,e,n]),r}function OQ({page:t,matches:e,...n}){let r=Cx(),{manifest:c,routeModules:d}=w4(),{basename:m}=x4(),{loaderData:s,matches:T}=AQ(),D=ke.useMemo(()=>UB(t,e,T,c,r,"data"),[t,e,T,c,r]),P=ke.useMemo(()=>UB(t,e,T,c,r,"assets"),[t,e,T,c,r]),z=ke.useMemo(()=>{if(t===r.pathname+r.search+r.hash)return[];let J=new Set,X=!1;if(e.forEach(ie=>{var Ie;let we=c.routes[ie.route.id];!we||!we.hasLoader||(!D.some(Re=>Re.route.id===ie.route.id)&&ie.route.id in s&&((Ie=d[ie.route.id])!=null&&Ie.shouldRevalidate)||we.hasClientLoader?X=!0:J.add(ie.route.id))}),J.size===0)return[];let te=SQ(t,m);return X&&J.size>0&&te.searchParams.set("_routes",e.filter(ie=>J.has(ie.route.id)).map(ie=>ie.route.id).join(",")),[te.pathname+te.search]},[m,s,r,c,D,e,t,d]),F=ke.useMemo(()=>bQ(P,c),[P,c]),$=RQ(P);return ke.createElement(ke.Fragment,null,z.map(J=>ke.createElement("link",{key:J,rel:"prefetch",as:"fetch",href:J,...n})),F.map(J=>ke.createElement("link",{key:J,rel:"modulepreload",href:J,...n})),$.map(({key:J,link:X})=>ke.createElement("link",{key:J,...X})))}function IQ(...t){return e=>{t.forEach(n=>{typeof n=="function"?n(e):n!=null&&(n.current=e)})}}var T4=typeof window<"u"&&typeof window.document<"u"&&typeof window.document.createElement<"u";try{T4&&(window.__reactRouterVersion="7.6.2")}catch{}function MQ({basename:t,children:e,window:n}){let r=ke.useRef();r.current==null&&(r.current=vX({window:n,v5Compat:!0}));let c=r.current,[d,m]=ke.useState({action:c.action,location:c.location}),s=ke.useCallback(T=>{ke.startTransition(()=>m(T))},[m]);return ke.useLayoutEffect(()=>c.listen(s),[c,s]),ke.createElement(aQ,{basename:t,children:e,location:d.location,navigationType:d.action,navigator:c})}var E4=/^(?:[a-z][a-z0-9+.-]*:|\/\/)/i,S4=ke.forwardRef(function({onClick:e,discover:n="render",prefetch:r="none",relative:c,reloadDocument:d,replace:m,state:s,target:T,to:D,preventScrollReset:P,viewTransition:z,...F},$){let{basename:J}=ke.useContext(Zm),X=typeof D=="string"&&E4.test(D),te,ie=!1;if(typeof D=="string"&&X&&(te=D,T4))try{let Te=new URL(window.location.href),oe=D.startsWith("//")?new URL(Te.protocol+D):new URL(D),Ee=S_(oe.pathname,J);oe.origin===Te.origin&&Ee!=null?D=Ee+oe.search+oe.hash:ie=!0}catch{qm(!1,`<Link to="${D}"> contains an invalid URL which will probably break when clicked - please update to a valid URL path.`)}let we=qX(D,{relative:c}),[Ie,Re,Ne]=CQ(r,F),Xe=LQ(D,{replace:m,state:s,target:T,preventScrollReset:P,relative:c,viewTransition:z});function be(Te){e&&e(Te),Te.defaultPrevented||Xe(Te)}let _e=ke.createElement("a",{...F,...Ne,href:te||we,onClick:ie||d?e:be,ref:IQ($,Re),target:T,"data-discover":!X&&n==="render"?"true":void 0});return Ie&&!X?ke.createElement(ke.Fragment,null,_e,ke.createElement(DQ,{page:we})):_e});S4.displayName="Link";var PQ=ke.forwardRef(function({"aria-current":e="page",caseSensitive:n=!1,className:r="",end:c=!1,style:d,to:m,viewTransition:s,children:T,...D},P){let z=UA(m,{relative:D.relative}),F=Cx(),$=ke.useContext(LI),{navigator:J,basename:X}=ke.useContext(Zm),te=$!=null&&UQ(z)&&s===!0,ie=J.encodeLocation?J.encodeLocation(z).pathname:z.pathname,we=F.pathname,Ie=$&&$.navigation&&$.navigation.location?$.navigation.location.pathname:null;n||(we=we.toLowerCase(),Ie=Ie?Ie.toLowerCase():null,ie=ie.toLowerCase()),Ie&&X&&(Ie=S_(Ie,X)||Ie);const Re=ie!=="/"&&ie.endsWith("/")?ie.length-1:ie.length;let Ne=we===ie||!c&&we.startsWith(ie)&&we.charAt(Re)==="/",Xe=Ie!=null&&(Ie===ie||!c&&Ie.startsWith(ie)&&Ie.charAt(ie.length)==="/"),be={isActive:Ne,isPending:Xe,isTransitioning:te},_e=Ne?e:void 0,Te;typeof r=="function"?Te=r(be):Te=[r,Ne?"active":null,Xe?"pending":null,te?"transitioning":null].filter(Boolean).join(" ");let oe=typeof d=="function"?d(be):d;return ke.createElement(S4,{...D,"aria-current":_e,className:Te,ref:P,style:oe,to:m,viewTransition:s},typeof T=="function"?T(be):T)});PQ.displayName="NavLink";var kQ=ke.forwardRef(({discover:t="render",fetcherKey:e,navigate:n,reloadDocument:r,replace:c,state:d,method:m=FR,action:s,onSubmit:T,relative:D,preventScrollReset:P,viewTransition:z,...F},$)=>{let J=FQ(),X=VQ(s,{relative:D}),te=m.toLowerCase()==="get"?"get":"post",ie=typeof s=="string"&&E4.test(s),we=Ie=>{if(T&&T(Ie),Ie.defaultPrevented)return;Ie.preventDefault();let Re=Ie.nativeEvent.submitter,Ne=(Re==null?void 0:Re.getAttribute("formmethod"))||m;J(Re||Ie.currentTarget,{fetcherKey:e,method:Ne,navigate:n,replace:c,state:d,relative:D,preventScrollReset:P,viewTransition:z})};return ke.createElement("form",{ref:$,method:te,action:X,onSubmit:r?T:we,...F,"data-discover":!ie&&t==="render"?"true":void 0})});kQ.displayName="Form";function NQ(t){return`${t} must be used within a data router.  See https://reactrouter.com/en/main/routers/picking-a-router.`}function A4(t){let e=ke.useContext(mT);return Lo(e,NQ(t)),e}function LQ(t,{target:e,replace:n,state:r,preventScrollReset:c,relative:d,viewTransition:m}={}){let s=Xm(),T=Cx(),D=UA(t,{relative:d});return ke.useCallback(P=>{if(fQ(P,e)){P.preventDefault();let z=n!==void 0?n:uA(T)===uA(D);s(t,{replace:z,state:r,preventScrollReset:c,relative:d,viewTransition:m})}},[T,s,D,n,r,e,t,c,d,m])}var zQ=0,BQ=()=>`__${String(++zQ)}__`;function FQ(){let{router:t}=A4("useSubmit"),{basename:e}=ke.useContext(Zm),n=iQ();return ke.useCallback(async(r,c={})=>{let{action:d,method:m,encType:s,formData:T,body:D}=gQ(r,e);if(c.navigate===!1){let P=c.fetcherKey||BQ();await t.fetch(P,n,c.action||d,{preventScrollReset:c.preventScrollReset,formData:T,body:D,formMethod:c.method||m,formEncType:c.encType||s,flushSync:c.flushSync})}else await t.navigate(c.action||d,{preventScrollReset:c.preventScrollReset,formData:T,body:D,formMethod:c.method||m,formEncType:c.encType||s,replace:c.replace,state:c.state,fromRouteId:n,flushSync:c.flushSync,viewTransition:c.viewTransition})},[t,e,n])}function VQ(t,{relative:e}={}){let{basename:n}=ke.useContext(Zm),r=ke.useContext(k_);Lo(r,"useFormAction must be used inside a RouteContext");let[c]=r.matches.slice(-1),d={...UA(t||".",{relative:e})},m=Cx();if(t==null){d.search=m.search;let s=new URLSearchParams(d.search),T=s.getAll("index");if(T.some(P=>P==="")){s.delete("index"),T.filter(z=>z).forEach(z=>s.append("index",z));let P=s.toString();d.search=P?`?${P}`:""}}return(!t||t===".")&&c.route.index&&(d.search=d.search?d.search.replace(/^\?/,"?index&"):"?index"),n!=="/"&&(d.pathname=d.pathname==="/"?n:b_([n,d.pathname])),uA(d)}function UQ(t,e={}){let n=ke.useContext(g4);Lo(n!=null,"`useViewTransitionState` must be used within `react-router-dom`'s `RouterProvider`.  Did you accidentally import `RouterProvider` from `react-router`?");let{basename:r}=A4("useViewTransitionState"),c=UA(t,{relative:e.relative});if(!n.isTransitioning)return!1;let d=S_(n.currentLocation.pathname,r)||n.currentLocation.pathname,m=S_(n.nextLocation.pathname,r)||n.nextLocation.pathname;return bO(c.pathname,m)!=null||bO(c.pathname,d)!=null}[...EQ];const jQ=()=>{};var jB={};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C4=function(t){const e=[];let n=0;for(let r=0;r<t.length;r++){let c=t.charCodeAt(r);c<128?e[n++]=c:c<2048?(e[n++]=c>>6|192,e[n++]=c&63|128):(c&64512)===55296&&r+1<t.length&&(t.charCodeAt(r+1)&64512)===56320?(c=65536+((c&1023)<<10)+(t.charCodeAt(++r)&1023),e[n++]=c>>18|240,e[n++]=c>>12&63|128,e[n++]=c>>6&63|128,e[n++]=c&63|128):(e[n++]=c>>12|224,e[n++]=c>>6&63|128,e[n++]=c&63|128)}return e},HQ=function(t){const e=[];let n=0,r=0;for(;n<t.length;){const c=t[n++];if(c<128)e[r++]=String.fromCharCode(c);else if(c>191&&c<224){const d=t[n++];e[r++]=String.fromCharCode((c&31)<<6|d&63)}else if(c>239&&c<365){const d=t[n++],m=t[n++],s=t[n++],T=((c&7)<<18|(d&63)<<12|(m&63)<<6|s&63)-65536;e[r++]=String.fromCharCode(55296+(T>>10)),e[r++]=String.fromCharCode(56320+(T&1023))}else{const d=t[n++],m=t[n++];e[r++]=String.fromCharCode((c&15)<<12|(d&63)<<6|m&63)}}return e.join("")},D4={byteToCharMap_:null,charToByteMap_:null,byteToCharMapWebSafe_:null,charToByteMapWebSafe_:null,ENCODED_VALS_BASE:"ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",get ENCODED_VALS(){return this.ENCODED_VALS_BASE+"+/="},get ENCODED_VALS_WEBSAFE(){return this.ENCODED_VALS_BASE+"-_."},HAS_NATIVE_SUPPORT:typeof atob=="function",encodeByteArray(t,e){if(!Array.isArray(t))throw Error("encodeByteArray takes an array as a parameter");this.init_();const n=e?this.byteToCharMapWebSafe_:this.byteToCharMap_,r=[];for(let c=0;c<t.length;c+=3){const d=t[c],m=c+1<t.length,s=m?t[c+1]:0,T=c+2<t.length,D=T?t[c+2]:0,P=d>>2,z=(d&3)<<4|s>>4;let F=(s&15)<<2|D>>6,$=D&63;T||($=64,m||(F=64)),r.push(n[P],n[z],n[F],n[$])}return r.join("")},encodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?btoa(t):this.encodeByteArray(C4(t),e)},decodeString(t,e){return this.HAS_NATIVE_SUPPORT&&!e?atob(t):HQ(this.decodeStringToByteArray(t,e))},decodeStringToByteArray(t,e){this.init_();const n=e?this.charToByteMapWebSafe_:this.charToByteMap_,r=[];for(let c=0;c<t.length;){const d=n[t.charAt(c++)],s=c<t.length?n[t.charAt(c)]:0;++c;const D=c<t.length?n[t.charAt(c)]:64;++c;const z=c<t.length?n[t.charAt(c)]:64;if(++c,d==null||s==null||D==null||z==null)throw new $Q;const F=d<<2|s>>4;if(r.push(F),D!==64){const $=s<<4&240|D>>2;if(r.push($),z!==64){const J=D<<6&192|z;r.push(J)}}}return r},init_(){if(!this.byteToCharMap_){this.byteToCharMap_={},this.charToByteMap_={},this.byteToCharMapWebSafe_={},this.charToByteMapWebSafe_={};for(let t=0;t<this.ENCODED_VALS.length;t++)this.byteToCharMap_[t]=this.ENCODED_VALS.charAt(t),this.charToByteMap_[this.byteToCharMap_[t]]=t,this.byteToCharMapWebSafe_[t]=this.ENCODED_VALS_WEBSAFE.charAt(t),this.charToByteMapWebSafe_[this.byteToCharMapWebSafe_[t]]=t,t>=this.ENCODED_VALS_BASE.length&&(this.charToByteMap_[this.ENCODED_VALS_WEBSAFE.charAt(t)]=t,this.charToByteMapWebSafe_[this.ENCODED_VALS.charAt(t)]=t)}}};class $Q extends Error{constructor(){super(...arguments),this.name="DecodeBase64StringError"}}const GQ=function(t){const e=C4(t);return D4.encodeByteArray(e,!0)},xO=function(t){return GQ(t).replace(/\./g,"")},R4=function(t){try{return D4.decodeString(t,!0)}catch(e){console.error("base64Decode failed: ",e)}return null};/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function qQ(){if(typeof self<"u")return self;if(typeof window<"u")return window;if(typeof global<"u")return global;throw new Error("Unable to locate global object.")}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const WQ=()=>qQ().__FIREBASE_DEFAULTS__,YQ=()=>{if(typeof process>"u"||typeof jB>"u")return;const t=jB.__FIREBASE_DEFAULTS__;if(t)return JSON.parse(t)},ZQ=()=>{if(typeof document>"u")return;let t;try{t=document.cookie.match(/__FIREBASE_DEFAULTS__=([^;]+)/)}catch{return}const e=t&&R4(t[1]);return e&&JSON.parse(e)},BI=()=>{try{return jQ()||WQ()||YQ()||ZQ()}catch(t){console.info(`Unable to get __FIREBASE_DEFAULTS__ due to: ${t}`);return}},O4=t=>{var e,n;return(n=(e=BI())===null||e===void 0?void 0:e.emulatorHosts)===null||n===void 0?void 0:n[t]},XQ=t=>{const e=O4(t);if(!e)return;const n=e.lastIndexOf(":");if(n<=0||n+1===e.length)throw new Error(`Invalid host ${e} with no separate hostname and port!`);const r=parseInt(e.substring(n+1),10);return e[0]==="["?[e.substring(1,n-1),r]:[e.substring(0,n),r]},I4=()=>{var t;return(t=BI())===null||t===void 0?void 0:t.config},M4=t=>{var e;return(e=BI())===null||e===void 0?void 0:e[`_${t}`]};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QQ{constructor(){this.reject=()=>{},this.resolve=()=>{},this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}wrapCallback(e){return(n,r)=>{n?this.reject(n):this.resolve(r),typeof e=="function"&&(this.promise.catch(()=>{}),e.length===1?e(n):e(n,r))}}}/**
 * @license
 * Copyright 2025 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gT(t){return t.endsWith(".cloudworkstations.dev")}async function P4(t){return(await fetch(t,{credentials:"include"})).ok}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function KQ(t,e){if(t.uid)throw new Error('The "uid" field is no longer supported by mockUserToken. Please use "sub" instead for Firebase Auth User ID.');const n={alg:"none",type:"JWT"},r=e||"demo-project",c=t.iat||0,d=t.sub||t.user_id;if(!d)throw new Error("mockUserToken must contain 'sub' or 'user_id' field!");const m=Object.assign({iss:`https://securetoken.google.com/${r}`,aud:r,iat:c,exp:c+3600,auth_time:c,sub:d,user_id:d,firebase:{sign_in_provider:"custom",identities:{}}},t);return[xO(JSON.stringify(n)),xO(JSON.stringify(m)),""].join(".")}const VS={};function JQ(){const t={prod:[],emulator:[]};for(const e of Object.keys(VS))VS[e]?t.emulator.push(e):t.prod.push(e);return t}function eK(t){let e=document.getElementById(t),n=!1;return e||(e=document.createElement("div"),e.setAttribute("id",t),n=!0),{created:n,element:e}}let HB=!1;function k4(t,e){if(typeof window>"u"||typeof document>"u"||!gT(window.location.host)||VS[t]===e||VS[t]||HB)return;VS[t]=e;function n(F){return`__firebase__banner__${F}`}const r="__firebase__banner",d=JQ().prod.length>0;function m(){const F=document.getElementById(r);F&&F.remove()}function s(F){F.style.display="flex",F.style.background="#7faaf0",F.style.position="fixed",F.style.bottom="5px",F.style.left="5px",F.style.padding=".5em",F.style.borderRadius="5px",F.style.alignItems="center"}function T(F,$){F.setAttribute("width","24"),F.setAttribute("id",$),F.setAttribute("height","24"),F.setAttribute("viewBox","0 0 24 24"),F.setAttribute("fill","none"),F.style.marginLeft="-6px"}function D(){const F=document.createElement("span");return F.style.cursor="pointer",F.style.marginLeft="16px",F.style.fontSize="24px",F.innerHTML=" &times;",F.onclick=()=>{HB=!0,m()},F}function P(F,$){F.setAttribute("id",$),F.innerText="Learn more",F.href="https://firebase.google.com/docs/studio/preview-apps#preview-backend",F.setAttribute("target","__blank"),F.style.paddingLeft="5px",F.style.textDecoration="underline"}function z(){const F=eK(r),$=n("text"),J=document.getElementById($)||document.createElement("span"),X=n("learnmore"),te=document.getElementById(X)||document.createElement("a"),ie=n("preprendIcon"),we=document.getElementById(ie)||document.createElementNS("http://www.w3.org/2000/svg","svg");if(F.created){const Ie=F.element;s(Ie),P(te,X);const Re=D();T(we,ie),Ie.append(we,J,te,Re),document.body.appendChild(Ie)}d?(J.innerText="Preview backend disconnected.",we.innerHTML=`<g clip-path="url(#clip0_6013_33858)">
<path d="M4.8 17.6L12 5.6L19.2 17.6H4.8ZM6.91667 16.4H17.0833L12 7.93333L6.91667 16.4ZM12 15.6C12.1667 15.6 12.3056 15.5444 12.4167 15.4333C12.5389 15.3111 12.6 15.1667 12.6 15C12.6 14.8333 12.5389 14.6944 12.4167 14.5833C12.3056 14.4611 12.1667 14.4 12 14.4C11.8333 14.4 11.6889 14.4611 11.5667 14.5833C11.4556 14.6944 11.4 14.8333 11.4 15C11.4 15.1667 11.4556 15.3111 11.5667 15.4333C11.6889 15.5444 11.8333 15.6 12 15.6ZM11.4 13.6H12.6V10.4H11.4V13.6Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6013_33858">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`):(we.innerHTML=`<g clip-path="url(#clip0_6083_34804)">
<path d="M11.4 15.2H12.6V11.2H11.4V15.2ZM12 10C12.1667 10 12.3056 9.94444 12.4167 9.83333C12.5389 9.71111 12.6 9.56667 12.6 9.4C12.6 9.23333 12.5389 9.09444 12.4167 8.98333C12.3056 8.86111 12.1667 8.8 12 8.8C11.8333 8.8 11.6889 8.86111 11.5667 8.98333C11.4556 9.09444 11.4 9.23333 11.4 9.4C11.4 9.56667 11.4556 9.71111 11.5667 9.83333C11.6889 9.94444 11.8333 10 12 10ZM12 18.4C11.1222 18.4 10.2944 18.2333 9.51667 17.9C8.73889 17.5667 8.05556 17.1111 7.46667 16.5333C6.88889 15.9444 6.43333 15.2611 6.1 14.4833C5.76667 13.7056 5.6 12.8778 5.6 12C5.6 11.1111 5.76667 10.2833 6.1 9.51667C6.43333 8.73889 6.88889 8.06111 7.46667 7.48333C8.05556 6.89444 8.73889 6.43333 9.51667 6.1C10.2944 5.76667 11.1222 5.6 12 5.6C12.8889 5.6 13.7167 5.76667 14.4833 6.1C15.2611 6.43333 15.9389 6.89444 16.5167 7.48333C17.1056 8.06111 17.5667 8.73889 17.9 9.51667C18.2333 10.2833 18.4 11.1111 18.4 12C18.4 12.8778 18.2333 13.7056 17.9 14.4833C17.5667 15.2611 17.1056 15.9444 16.5167 16.5333C15.9389 17.1111 15.2611 17.5667 14.4833 17.9C13.7167 18.2333 12.8889 18.4 12 18.4ZM12 17.2C13.4444 17.2 14.6722 16.6944 15.6833 15.6833C16.6944 14.6722 17.2 13.4444 17.2 12C17.2 10.5556 16.6944 9.32778 15.6833 8.31667C14.6722 7.30555 13.4444 6.8 12 6.8C10.5556 6.8 9.32778 7.30555 8.31667 8.31667C7.30556 9.32778 6.8 10.5556 6.8 12C6.8 13.4444 7.30556 14.6722 8.31667 15.6833C9.32778 16.6944 10.5556 17.2 12 17.2Z" fill="#212121"/>
</g>
<defs>
<clipPath id="clip0_6083_34804">
<rect width="24" height="24" fill="white"/>
</clipPath>
</defs>`,J.innerText="Preview backend running in this workspace."),J.setAttribute("id",$)}document.readyState==="loading"?window.addEventListener("DOMContentLoaded",z):z()}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jc(){return typeof navigator<"u"&&typeof navigator.userAgent=="string"?navigator.userAgent:""}function tK(){return typeof window<"u"&&!!(window.cordova||window.phonegap||window.PhoneGap)&&/ios|iphone|ipod|ipad|android|blackberry|iemobile/i.test(jc())}function nK(){var t;const e=(t=BI())===null||t===void 0?void 0:t.forceEnvironment;if(e==="node")return!0;if(e==="browser")return!1;try{return Object.prototype.toString.call(global.process)==="[object process]"}catch{return!1}}function iK(){return typeof navigator<"u"&&navigator.userAgent==="Cloudflare-Workers"}function rK(){const t=typeof chrome=="object"?chrome.runtime:typeof browser=="object"?browser.runtime:void 0;return typeof t=="object"&&t.id!==void 0}function sK(){return typeof navigator=="object"&&navigator.product==="ReactNative"}function oK(){const t=jc();return t.indexOf("MSIE ")>=0||t.indexOf("Trident/")>=0}function aK(){return!nK()&&!!navigator.userAgent&&navigator.userAgent.includes("Safari")&&!navigator.userAgent.includes("Chrome")}function lK(){try{return typeof indexedDB=="object"}catch{return!1}}function cK(){return new Promise((t,e)=>{try{let n=!0;const r="validate-browser-context-for-indexeddb-analytics-module",c=self.indexedDB.open(r);c.onsuccess=()=>{c.result.close(),n||self.indexedDB.deleteDatabase(r),t(!0)},c.onupgradeneeded=()=>{n=!1},c.onerror=()=>{var d;e(((d=c.error)===null||d===void 0?void 0:d.message)||"")}}catch(n){e(n)}})}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const uK="FirebaseError";class N_ extends Error{constructor(e,n,r){super(n),this.code=e,this.customData=r,this.name=uK,Object.setPrototypeOf(this,N_.prototype),Error.captureStackTrace&&Error.captureStackTrace(this,jA.prototype.create)}}class jA{constructor(e,n,r){this.service=e,this.serviceName=n,this.errors=r}create(e,...n){const r=n[0]||{},c=`${this.service}/${e}`,d=this.errors[e],m=d?hK(d,r):"Error",s=`${this.serviceName}: ${m} (${c}).`;return new N_(c,s,r)}}function hK(t,e){return t.replace(dK,(n,r)=>{const c=e[r];return c!=null?String(c):`<${r}?>`})}const dK=/\{\$([^}]+)}/g;function fK(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}function A_(t,e){if(t===e)return!0;const n=Object.keys(t),r=Object.keys(e);for(const c of n){if(!r.includes(c))return!1;const d=t[c],m=e[c];if($B(d)&&$B(m)){if(!A_(d,m))return!1}else if(d!==m)return!1}for(const c of r)if(!n.includes(c))return!1;return!0}function $B(t){return t!==null&&typeof t=="object"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function HA(t){const e=[];for(const[n,r]of Object.entries(t))Array.isArray(r)?r.forEach(c=>{e.push(encodeURIComponent(n)+"="+encodeURIComponent(c))}):e.push(encodeURIComponent(n)+"="+encodeURIComponent(r));return e.length?"&"+e.join("&"):""}function SS(t){const e={};return t.replace(/^\?/,"").split("&").forEach(r=>{if(r){const[c,d]=r.split("=");e[decodeURIComponent(c)]=decodeURIComponent(d)}}),e}function AS(t){const e=t.indexOf("?");if(!e)return"";const n=t.indexOf("#",e);return t.substring(e,n>0?n:void 0)}function pK(t,e){const n=new mK(t,e);return n.subscribe.bind(n)}class mK{constructor(e,n){this.observers=[],this.unsubscribes=[],this.observerCount=0,this.task=Promise.resolve(),this.finalized=!1,this.onNoObservers=n,this.task.then(()=>{e(this)}).catch(r=>{this.error(r)})}next(e){this.forEachObserver(n=>{n.next(e)})}error(e){this.forEachObserver(n=>{n.error(e)}),this.close(e)}complete(){this.forEachObserver(e=>{e.complete()}),this.close()}subscribe(e,n,r){let c;if(e===void 0&&n===void 0&&r===void 0)throw new Error("Missing Observer.");gK(e,["next","error","complete"])?c=e:c={next:e,error:n,complete:r},c.next===void 0&&(c.next=xP),c.error===void 0&&(c.error=xP),c.complete===void 0&&(c.complete=xP);const d=this.unsubscribeOne.bind(this,this.observers.length);return this.finalized&&this.task.then(()=>{try{this.finalError?c.error(this.finalError):c.complete()}catch{}}),this.observers.push(c),d}unsubscribeOne(e){this.observers===void 0||this.observers[e]===void 0||(delete this.observers[e],this.observerCount-=1,this.observerCount===0&&this.onNoObservers!==void 0&&this.onNoObservers(this))}forEachObserver(e){if(!this.finalized)for(let n=0;n<this.observers.length;n++)this.sendOne(n,e)}sendOne(e,n){this.task.then(()=>{if(this.observers!==void 0&&this.observers[e]!==void 0)try{n(this.observers[e])}catch(r){typeof console<"u"&&console.error&&console.error(r)}})}close(e){this.finalized||(this.finalized=!0,e!==void 0&&(this.finalError=e),this.task.then(()=>{this.observers=void 0,this.onNoObservers=void 0}))}}function gK(t,e){if(typeof t!="object"||t===null)return!1;for(const n of e)if(n in t&&typeof t[n]=="function")return!0;return!1}function xP(){}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Va(t){return t&&t._delegate?t._delegate:t}class _x{constructor(e,n,r){this.name=e,this.instanceFactory=n,this.type=r,this.multipleInstances=!1,this.serviceProps={},this.instantiationMode="LAZY",this.onInstanceCreated=null}setInstantiationMode(e){return this.instantiationMode=e,this}setMultipleInstances(e){return this.multipleInstances=e,this}setServiceProps(e){return this.serviceProps=e,this}setInstanceCreatedCallback(e){return this.onInstanceCreated=e,this}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Kb="[DEFAULT]";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _K{constructor(e,n){this.name=e,this.container=n,this.component=null,this.instances=new Map,this.instancesDeferred=new Map,this.instancesOptions=new Map,this.onInitCallbacks=new Map}get(e){const n=this.normalizeInstanceIdentifier(e);if(!this.instancesDeferred.has(n)){const r=new QQ;if(this.instancesDeferred.set(n,r),this.isInitialized(n)||this.shouldAutoInitialize())try{const c=this.getOrInitializeService({instanceIdentifier:n});c&&r.resolve(c)}catch{}}return this.instancesDeferred.get(n).promise}getImmediate(e){var n;const r=this.normalizeInstanceIdentifier(e==null?void 0:e.identifier),c=(n=e==null?void 0:e.optional)!==null&&n!==void 0?n:!1;if(this.isInitialized(r)||this.shouldAutoInitialize())try{return this.getOrInitializeService({instanceIdentifier:r})}catch(d){if(c)return null;throw d}else{if(c)return null;throw Error(`Service ${this.name} is not available`)}}getComponent(){return this.component}setComponent(e){if(e.name!==this.name)throw Error(`Mismatching Component ${e.name} for Provider ${this.name}.`);if(this.component)throw Error(`Component for ${this.name} has already been provided`);if(this.component=e,!!this.shouldAutoInitialize()){if(vK(e))try{this.getOrInitializeService({instanceIdentifier:Kb})}catch{}for(const[n,r]of this.instancesDeferred.entries()){const c=this.normalizeInstanceIdentifier(n);try{const d=this.getOrInitializeService({instanceIdentifier:c});r.resolve(d)}catch{}}}}clearInstance(e=Kb){this.instancesDeferred.delete(e),this.instancesOptions.delete(e),this.instances.delete(e)}async delete(){const e=Array.from(this.instances.values());await Promise.all([...e.filter(n=>"INTERNAL"in n).map(n=>n.INTERNAL.delete()),...e.filter(n=>"_delete"in n).map(n=>n._delete())])}isComponentSet(){return this.component!=null}isInitialized(e=Kb){return this.instances.has(e)}getOptions(e=Kb){return this.instancesOptions.get(e)||{}}initialize(e={}){const{options:n={}}=e,r=this.normalizeInstanceIdentifier(e.instanceIdentifier);if(this.isInitialized(r))throw Error(`${this.name}(${r}) has already been initialized`);if(!this.isComponentSet())throw Error(`Component ${this.name} has not been registered yet`);const c=this.getOrInitializeService({instanceIdentifier:r,options:n});for(const[d,m]of this.instancesDeferred.entries()){const s=this.normalizeInstanceIdentifier(d);r===s&&m.resolve(c)}return c}onInit(e,n){var r;const c=this.normalizeInstanceIdentifier(n),d=(r=this.onInitCallbacks.get(c))!==null&&r!==void 0?r:new Set;d.add(e),this.onInitCallbacks.set(c,d);const m=this.instances.get(c);return m&&e(m,c),()=>{d.delete(e)}}invokeOnInitCallbacks(e,n){const r=this.onInitCallbacks.get(n);if(r)for(const c of r)try{c(e,n)}catch{}}getOrInitializeService({instanceIdentifier:e,options:n={}}){let r=this.instances.get(e);if(!r&&this.component&&(r=this.component.instanceFactory(this.container,{instanceIdentifier:yK(e),options:n}),this.instances.set(e,r),this.instancesOptions.set(e,n),this.invokeOnInitCallbacks(r,e),this.component.onInstanceCreated))try{this.component.onInstanceCreated(this.container,e,r)}catch{}return r||null}normalizeInstanceIdentifier(e=Kb){return this.component?this.component.multipleInstances?e:Kb:e}shouldAutoInitialize(){return!!this.component&&this.component.instantiationMode!=="EXPLICIT"}}function yK(t){return t===Kb?void 0:t}function vK(t){return t.instantiationMode==="EAGER"}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bK{constructor(e){this.name=e,this.providers=new Map}addComponent(e){const n=this.getProvider(e.name);if(n.isComponentSet())throw new Error(`Component ${e.name} has already been registered with ${this.name}`);n.setComponent(e)}addOrOverwriteComponent(e){this.getProvider(e.name).isComponentSet()&&this.providers.delete(e.name),this.addComponent(e)}getProvider(e){if(this.providers.has(e))return this.providers.get(e);const n=new _K(e,this);return this.providers.set(e,n),n}getProviders(){return Array.from(this.providers.values())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var Xr;(function(t){t[t.DEBUG=0]="DEBUG",t[t.VERBOSE=1]="VERBOSE",t[t.INFO=2]="INFO",t[t.WARN=3]="WARN",t[t.ERROR=4]="ERROR",t[t.SILENT=5]="SILENT"})(Xr||(Xr={}));const xK={debug:Xr.DEBUG,verbose:Xr.VERBOSE,info:Xr.INFO,warn:Xr.WARN,error:Xr.ERROR,silent:Xr.SILENT},wK=Xr.INFO,TK={[Xr.DEBUG]:"log",[Xr.VERBOSE]:"log",[Xr.INFO]:"info",[Xr.WARN]:"warn",[Xr.ERROR]:"error"},EK=(t,e,...n)=>{if(e<t.logLevel)return;const r=new Date().toISOString(),c=TK[e];if(c)console[c](`[${r}]  ${t.name}:`,...n);else throw new Error(`Attempted to log a message with an invalid logType (value: ${e})`)};class f2{constructor(e){this.name=e,this._logLevel=wK,this._logHandler=EK,this._userLogHandler=null}get logLevel(){return this._logLevel}set logLevel(e){if(!(e in Xr))throw new TypeError(`Invalid value "${e}" assigned to \`logLevel\``);this._logLevel=e}setLogLevel(e){this._logLevel=typeof e=="string"?xK[e]:e}get logHandler(){return this._logHandler}set logHandler(e){if(typeof e!="function")throw new TypeError("Value assigned to `logHandler` must be a function");this._logHandler=e}get userLogHandler(){return this._userLogHandler}set userLogHandler(e){this._userLogHandler=e}debug(...e){this._userLogHandler&&this._userLogHandler(this,Xr.DEBUG,...e),this._logHandler(this,Xr.DEBUG,...e)}log(...e){this._userLogHandler&&this._userLogHandler(this,Xr.VERBOSE,...e),this._logHandler(this,Xr.VERBOSE,...e)}info(...e){this._userLogHandler&&this._userLogHandler(this,Xr.INFO,...e),this._logHandler(this,Xr.INFO,...e)}warn(...e){this._userLogHandler&&this._userLogHandler(this,Xr.WARN,...e),this._logHandler(this,Xr.WARN,...e)}error(...e){this._userLogHandler&&this._userLogHandler(this,Xr.ERROR,...e),this._logHandler(this,Xr.ERROR,...e)}}const SK=(t,e)=>e.some(n=>t instanceof n);let GB,qB;function AK(){return GB||(GB=[IDBDatabase,IDBObjectStore,IDBIndex,IDBCursor,IDBTransaction])}function CK(){return qB||(qB=[IDBCursor.prototype.advance,IDBCursor.prototype.continue,IDBCursor.prototype.continuePrimaryKey])}const N4=new WeakMap,Mk=new WeakMap,L4=new WeakMap,wP=new WeakMap,p2=new WeakMap;function DK(t){const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("success",d),t.removeEventListener("error",m)},d=()=>{n(Vv(t.result)),c()},m=()=>{r(t.error),c()};t.addEventListener("success",d),t.addEventListener("error",m)});return e.then(n=>{n instanceof IDBCursor&&N4.set(n,t)}).catch(()=>{}),p2.set(e,t),e}function RK(t){if(Mk.has(t))return;const e=new Promise((n,r)=>{const c=()=>{t.removeEventListener("complete",d),t.removeEventListener("error",m),t.removeEventListener("abort",m)},d=()=>{n(),c()},m=()=>{r(t.error||new DOMException("AbortError","AbortError")),c()};t.addEventListener("complete",d),t.addEventListener("error",m),t.addEventListener("abort",m)});Mk.set(t,e)}let Pk={get(t,e,n){if(t instanceof IDBTransaction){if(e==="done")return Mk.get(t);if(e==="objectStoreNames")return t.objectStoreNames||L4.get(t);if(e==="store")return n.objectStoreNames[1]?void 0:n.objectStore(n.objectStoreNames[0])}return Vv(t[e])},set(t,e,n){return t[e]=n,!0},has(t,e){return t instanceof IDBTransaction&&(e==="done"||e==="store")?!0:e in t}};function OK(t){Pk=t(Pk)}function IK(t){return t===IDBDatabase.prototype.transaction&&!("objectStoreNames"in IDBTransaction.prototype)?function(e,...n){const r=t.call(TP(this),e,...n);return L4.set(r,e.sort?e.sort():[e]),Vv(r)}:CK().includes(t)?function(...e){return t.apply(TP(this),e),Vv(N4.get(this))}:function(...e){return Vv(t.apply(TP(this),e))}}function MK(t){return typeof t=="function"?IK(t):(t instanceof IDBTransaction&&RK(t),SK(t,AK())?new Proxy(t,Pk):t)}function Vv(t){if(t instanceof IDBRequest)return DK(t);if(wP.has(t))return wP.get(t);const e=MK(t);return e!==t&&(wP.set(t,e),p2.set(e,t)),e}const TP=t=>p2.get(t);function PK(t,e,{blocked:n,upgrade:r,blocking:c,terminated:d}={}){const m=indexedDB.open(t,e),s=Vv(m);return r&&m.addEventListener("upgradeneeded",T=>{r(Vv(m.result),T.oldVersion,T.newVersion,Vv(m.transaction),T)}),n&&m.addEventListener("blocked",T=>n(T.oldVersion,T.newVersion,T)),s.then(T=>{d&&T.addEventListener("close",()=>d()),c&&T.addEventListener("versionchange",D=>c(D.oldVersion,D.newVersion,D))}).catch(()=>{}),s}const kK=["get","getKey","getAll","getAllKeys","count"],NK=["put","add","delete","clear"],EP=new Map;function WB(t,e){if(!(t instanceof IDBDatabase&&!(e in t)&&typeof e=="string"))return;if(EP.get(e))return EP.get(e);const n=e.replace(/FromIndex$/,""),r=e!==n,c=NK.includes(n);if(!(n in(r?IDBIndex:IDBObjectStore).prototype)||!(c||kK.includes(n)))return;const d=async function(m,...s){const T=this.transaction(m,c?"readwrite":"readonly");let D=T.store;return r&&(D=D.index(s.shift())),(await Promise.all([D[n](...s),c&&T.done]))[0]};return EP.set(e,d),d}OK(t=>({...t,get:(e,n,r)=>WB(e,n)||t.get(e,n,r),has:(e,n)=>!!WB(e,n)||t.has(e,n)}));/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class LK{constructor(e){this.container=e}getPlatformInfoString(){return this.container.getProviders().map(n=>{if(zK(n)){const r=n.getImmediate();return`${r.library}/${r.version}`}else return null}).filter(n=>n).join(" ")}}function zK(t){const e=t.getComponent();return(e==null?void 0:e.type)==="VERSION"}const kk="@firebase/app",YB="0.13.1";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const C_=new f2("@firebase/app"),BK="@firebase/app-compat",FK="@firebase/analytics-compat",VK="@firebase/analytics",UK="@firebase/app-check-compat",jK="@firebase/app-check",HK="@firebase/auth",$K="@firebase/auth-compat",GK="@firebase/database",qK="@firebase/data-connect",WK="@firebase/database-compat",YK="@firebase/functions",ZK="@firebase/functions-compat",XK="@firebase/installations",QK="@firebase/installations-compat",KK="@firebase/messaging",JK="@firebase/messaging-compat",eJ="@firebase/performance",tJ="@firebase/performance-compat",nJ="@firebase/remote-config",iJ="@firebase/remote-config-compat",rJ="@firebase/storage",sJ="@firebase/storage-compat",oJ="@firebase/firestore",aJ="@firebase/ai",lJ="@firebase/firestore-compat",cJ="firebase",uJ="11.9.0";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Nk="[DEFAULT]",hJ={[kk]:"fire-core",[BK]:"fire-core-compat",[VK]:"fire-analytics",[FK]:"fire-analytics-compat",[jK]:"fire-app-check",[UK]:"fire-app-check-compat",[HK]:"fire-auth",[$K]:"fire-auth-compat",[GK]:"fire-rtdb",[qK]:"fire-data-connect",[WK]:"fire-rtdb-compat",[YK]:"fire-fn",[ZK]:"fire-fn-compat",[XK]:"fire-iid",[QK]:"fire-iid-compat",[KK]:"fire-fcm",[JK]:"fire-fcm-compat",[eJ]:"fire-perf",[tJ]:"fire-perf-compat",[nJ]:"fire-rc",[iJ]:"fire-rc-compat",[rJ]:"fire-gcs",[sJ]:"fire-gcs-compat",[oJ]:"fire-fst",[lJ]:"fire-fst-compat",[aJ]:"fire-vertex","fire-js":"fire-js",[cJ]:"fire-js-all"};/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const wO=new Map,dJ=new Map,Lk=new Map;function ZB(t,e){try{t.container.addComponent(e)}catch(n){C_.debug(`Component ${e.name} failed to register with FirebaseApp ${t.name}`,n)}}function Xw(t){const e=t.name;if(Lk.has(e))return C_.debug(`There were multiple attempts to register component ${e}.`),!1;Lk.set(e,t);for(const n of wO.values())ZB(n,t);for(const n of dJ.values())ZB(n,t);return!0}function m2(t,e){const n=t.container.getProvider("heartbeat").getImmediate({optional:!0});return n&&n.triggerHeartbeat(),t.container.getProvider(e)}function Qd(t){return t==null?!1:t.settings!==void 0}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fJ={"no-app":"No Firebase App '{$appName}' has been created - call initializeApp() first","bad-app-name":"Illegal App name: '{$appName}'","duplicate-app":"Firebase App named '{$appName}' already exists with different options or config","app-deleted":"Firebase App named '{$appName}' already deleted","server-app-deleted":"Firebase Server App has been deleted","no-options":"Need to provide options, when not being deployed to hosting via source.","invalid-app-argument":"firebase.{$appName}() takes either no argument or a Firebase App instance.","invalid-log-argument":"First argument to `onLog` must be null or a function.","idb-open":"Error thrown when opening IndexedDB. Original error: {$originalErrorMessage}.","idb-get":"Error thrown when reading from IndexedDB. Original error: {$originalErrorMessage}.","idb-set":"Error thrown when writing to IndexedDB. Original error: {$originalErrorMessage}.","idb-delete":"Error thrown when deleting from IndexedDB. Original error: {$originalErrorMessage}.","finalization-registry-not-supported":"FirebaseServerApp deleteOnDeref field defined but the JS runtime does not support FinalizationRegistry.","invalid-server-app-environment":"FirebaseServerApp is not for use in browser environments."},Uv=new jA("app","Firebase",fJ);/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class pJ{constructor(e,n,r){this._isDeleted=!1,this._options=Object.assign({},e),this._config=Object.assign({},n),this._name=n.name,this._automaticDataCollectionEnabled=n.automaticDataCollectionEnabled,this._container=r,this.container.addComponent(new _x("app",()=>this,"PUBLIC"))}get automaticDataCollectionEnabled(){return this.checkDestroyed(),this._automaticDataCollectionEnabled}set automaticDataCollectionEnabled(e){this.checkDestroyed(),this._automaticDataCollectionEnabled=e}get name(){return this.checkDestroyed(),this._name}get options(){return this.checkDestroyed(),this._options}get config(){return this.checkDestroyed(),this._config}get container(){return this._container}get isDeleted(){return this._isDeleted}set isDeleted(e){this._isDeleted=e}checkDestroyed(){if(this.isDeleted)throw Uv.create("app-deleted",{appName:this._name})}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const _T=uJ;function z4(t,e={}){let n=t;typeof e!="object"&&(e={name:e});const r=Object.assign({name:Nk,automaticDataCollectionEnabled:!0},e),c=r.name;if(typeof c!="string"||!c)throw Uv.create("bad-app-name",{appName:String(c)});if(n||(n=I4()),!n)throw Uv.create("no-options");const d=wO.get(c);if(d){if(A_(n,d.options)&&A_(r,d.config))return d;throw Uv.create("duplicate-app",{appName:c})}const m=new bK(c);for(const T of Lk.values())m.addComponent(T);const s=new pJ(n,r,m);return wO.set(c,s),s}function B4(t=Nk){const e=wO.get(t);if(!e&&t===Nk&&I4())return z4();if(!e)throw Uv.create("no-app",{appName:t});return e}function jv(t,e,n){var r;let c=(r=hJ[t])!==null&&r!==void 0?r:t;n&&(c+=`-${n}`);const d=c.match(/\s|\//),m=e.match(/\s|\//);if(d||m){const s=[`Unable to register library "${c}" with version "${e}":`];d&&s.push(`library name "${c}" contains illegal characters (whitespace or "/")`),d&&m&&s.push("and"),m&&s.push(`version name "${e}" contains illegal characters (whitespace or "/")`),C_.warn(s.join(" "));return}Xw(new _x(`${c}-version`,()=>({library:c,version:e}),"VERSION"))}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mJ="firebase-heartbeat-database",gJ=1,hA="firebase-heartbeat-store";let SP=null;function F4(){return SP||(SP=PK(mJ,gJ,{upgrade:(t,e)=>{switch(e){case 0:try{t.createObjectStore(hA)}catch(n){console.warn(n)}}}}).catch(t=>{throw Uv.create("idb-open",{originalErrorMessage:t.message})})),SP}async function _J(t){try{const n=(await F4()).transaction(hA),r=await n.objectStore(hA).get(V4(t));return await n.done,r}catch(e){if(e instanceof N_)C_.warn(e.message);else{const n=Uv.create("idb-get",{originalErrorMessage:e==null?void 0:e.message});C_.warn(n.message)}}}async function XB(t,e){try{const r=(await F4()).transaction(hA,"readwrite");await r.objectStore(hA).put(e,V4(t)),await r.done}catch(n){if(n instanceof N_)C_.warn(n.message);else{const r=Uv.create("idb-set",{originalErrorMessage:n==null?void 0:n.message});C_.warn(r.message)}}}function V4(t){return`${t.name}!${t.options.appId}`}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const yJ=1024,vJ=30;class bJ{constructor(e){this.container=e,this._heartbeatsCache=null;const n=this.container.getProvider("app").getImmediate();this._storage=new wJ(n),this._heartbeatsCachePromise=this._storage.read().then(r=>(this._heartbeatsCache=r,r))}async triggerHeartbeat(){var e,n;try{const c=this.container.getProvider("platform-logger").getImmediate().getPlatformInfoString(),d=QB();if(((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null&&(this._heartbeatsCache=await this._heartbeatsCachePromise,((n=this._heartbeatsCache)===null||n===void 0?void 0:n.heartbeats)==null)||this._heartbeatsCache.lastSentHeartbeatDate===d||this._heartbeatsCache.heartbeats.some(m=>m.date===d))return;if(this._heartbeatsCache.heartbeats.push({date:d,agent:c}),this._heartbeatsCache.heartbeats.length>vJ){const m=TJ(this._heartbeatsCache.heartbeats);this._heartbeatsCache.heartbeats.splice(m,1)}return this._storage.overwrite(this._heartbeatsCache)}catch(r){C_.warn(r)}}async getHeartbeatsHeader(){var e;try{if(this._heartbeatsCache===null&&await this._heartbeatsCachePromise,((e=this._heartbeatsCache)===null||e===void 0?void 0:e.heartbeats)==null||this._heartbeatsCache.heartbeats.length===0)return"";const n=QB(),{heartbeatsToSend:r,unsentEntries:c}=xJ(this._heartbeatsCache.heartbeats),d=xO(JSON.stringify({version:2,heartbeats:r}));return this._heartbeatsCache.lastSentHeartbeatDate=n,c.length>0?(this._heartbeatsCache.heartbeats=c,await this._storage.overwrite(this._heartbeatsCache)):(this._heartbeatsCache.heartbeats=[],this._storage.overwrite(this._heartbeatsCache)),d}catch(n){return C_.warn(n),""}}}function QB(){return new Date().toISOString().substring(0,10)}function xJ(t,e=yJ){const n=[];let r=t.slice();for(const c of t){const d=n.find(m=>m.agent===c.agent);if(d){if(d.dates.push(c.date),KB(n)>e){d.dates.pop();break}}else if(n.push({agent:c.agent,dates:[c.date]}),KB(n)>e){n.pop();break}r=r.slice(1)}return{heartbeatsToSend:n,unsentEntries:r}}class wJ{constructor(e){this.app=e,this._canUseIndexedDBPromise=this.runIndexedDBEnvironmentCheck()}async runIndexedDBEnvironmentCheck(){return lK()?cK().then(()=>!0).catch(()=>!1):!1}async read(){if(await this._canUseIndexedDBPromise){const n=await _J(this.app);return n!=null&&n.heartbeats?n:{heartbeats:[]}}else return{heartbeats:[]}}async overwrite(e){var n;if(await this._canUseIndexedDBPromise){const c=await this.read();return XB(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:c.lastSentHeartbeatDate,heartbeats:e.heartbeats})}else return}async add(e){var n;if(await this._canUseIndexedDBPromise){const c=await this.read();return XB(this.app,{lastSentHeartbeatDate:(n=e.lastSentHeartbeatDate)!==null&&n!==void 0?n:c.lastSentHeartbeatDate,heartbeats:[...c.heartbeats,...e.heartbeats]})}else return}}function KB(t){return xO(JSON.stringify({version:2,heartbeats:t})).length}function TJ(t){if(t.length===0)return-1;let e=0,n=t[0].date;for(let r=1;r<t.length;r++)t[r].date<n&&(n=t[r].date,e=r);return e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function EJ(t){Xw(new _x("platform-logger",e=>new LK(e),"PRIVATE")),Xw(new _x("heartbeat",e=>new bJ(e),"PRIVATE")),jv(kk,YB,t),jv(kk,YB,"esm2017"),jv("fire-js","")}EJ("");function g2(t,e){var n={};for(var r in t)Object.prototype.hasOwnProperty.call(t,r)&&e.indexOf(r)<0&&(n[r]=t[r]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var c=0,r=Object.getOwnPropertySymbols(t);c<r.length;c++)e.indexOf(r[c])<0&&Object.prototype.propertyIsEnumerable.call(t,r[c])&&(n[r[c]]=t[r[c]]);return n}function U4(){return{"dependent-sdk-initialized-before-auth":"Another Firebase SDK was initialized and is trying to use Auth before Auth is initialized. Please be sure to call `initializeAuth` or `getAuth` before starting any other Firebase SDK."}}const SJ=U4,j4=new jA("auth","Firebase",U4());/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const TO=new f2("@firebase/auth");function AJ(t,...e){TO.logLevel<=Xr.WARN&&TO.warn(`Auth (${_T}): ${t}`,...e)}function UR(t,...e){TO.logLevel<=Xr.ERROR&&TO.error(`Auth (${_T}): ${t}`,...e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _p(t,...e){throw _2(t,...e)}function Um(t,...e){return _2(t,...e)}function H4(t,e,n){const r=Object.assign(Object.assign({},SJ()),{[e]:n});return new jA("auth","Firebase",r).create(e,{appName:t.name})}function x_(t){return H4(t,"operation-not-supported-in-this-environment","Operations that alter the current user are not supported in conjunction with FirebaseServerApp")}function _2(t,...e){if(typeof t!="string"){const n=e[0],r=[...e.slice(1)];return r[0]&&(r[0].appName=t.name),t._errorFactory.create(n,...r)}return j4.create(t,...e)}function Yi(t,e,...n){if(!t)throw _2(e,...n)}function __(t){const e="INTERNAL ASSERTION FAILED: "+t;throw UR(e),new Error(e)}function D_(t,e){t||__(e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function zk(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.href)||""}function CJ(){return JB()==="http:"||JB()==="https:"}function JB(){var t;return typeof self<"u"&&((t=self.location)===null||t===void 0?void 0:t.protocol)||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function DJ(){return typeof navigator<"u"&&navigator&&"onLine"in navigator&&typeof navigator.onLine=="boolean"&&(CJ()||rK()||"connection"in navigator)?navigator.onLine:!0}function RJ(){if(typeof navigator>"u")return null;const t=navigator;return t.languages&&t.languages[0]||t.language||null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $A{constructor(e,n){this.shortDelay=e,this.longDelay=n,D_(n>e,"Short delay should be less than long delay!"),this.isMobile=tK()||sK()}get(){return DJ()?this.isMobile?this.longDelay:this.shortDelay:Math.min(5e3,this.shortDelay)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function y2(t,e){D_(t.emulator,"Emulator should always be set here");const{url:n}=t.emulator;return e?`${n}${e.startsWith("/")?e.slice(1):e}`:n}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $4{static initialize(e,n,r){this.fetchImpl=e,n&&(this.headersImpl=n),r&&(this.responseImpl=r)}static fetch(){if(this.fetchImpl)return this.fetchImpl;if(typeof self<"u"&&"fetch"in self)return self.fetch;if(typeof globalThis<"u"&&globalThis.fetch)return globalThis.fetch;if(typeof fetch<"u")return fetch;__("Could not find fetch implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static headers(){if(this.headersImpl)return this.headersImpl;if(typeof self<"u"&&"Headers"in self)return self.Headers;if(typeof globalThis<"u"&&globalThis.Headers)return globalThis.Headers;if(typeof Headers<"u")return Headers;__("Could not find Headers implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}static response(){if(this.responseImpl)return this.responseImpl;if(typeof self<"u"&&"Response"in self)return self.Response;if(typeof globalThis<"u"&&globalThis.Response)return globalThis.Response;if(typeof Response<"u")return Response;__("Could not find Response implementation, make sure you call FetchProvider.initialize() with an appropriate polyfill")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const OJ={CREDENTIAL_MISMATCH:"custom-token-mismatch",MISSING_CUSTOM_TOKEN:"internal-error",INVALID_IDENTIFIER:"invalid-email",MISSING_CONTINUE_URI:"internal-error",INVALID_PASSWORD:"wrong-password",MISSING_PASSWORD:"missing-password",INVALID_LOGIN_CREDENTIALS:"invalid-credential",EMAIL_EXISTS:"email-already-in-use",PASSWORD_LOGIN_DISABLED:"operation-not-allowed",INVALID_IDP_RESPONSE:"invalid-credential",INVALID_PENDING_TOKEN:"invalid-credential",FEDERATED_USER_ID_ALREADY_LINKED:"credential-already-in-use",MISSING_REQ_TYPE:"internal-error",EMAIL_NOT_FOUND:"user-not-found",RESET_PASSWORD_EXCEED_LIMIT:"too-many-requests",EXPIRED_OOB_CODE:"expired-action-code",INVALID_OOB_CODE:"invalid-action-code",MISSING_OOB_CODE:"internal-error",CREDENTIAL_TOO_OLD_LOGIN_AGAIN:"requires-recent-login",INVALID_ID_TOKEN:"invalid-user-token",TOKEN_EXPIRED:"user-token-expired",USER_NOT_FOUND:"user-token-expired",TOO_MANY_ATTEMPTS_TRY_LATER:"too-many-requests",PASSWORD_DOES_NOT_MEET_REQUIREMENTS:"password-does-not-meet-requirements",INVALID_CODE:"invalid-verification-code",INVALID_SESSION_INFO:"invalid-verification-id",INVALID_TEMPORARY_PROOF:"invalid-credential",MISSING_SESSION_INFO:"missing-verification-id",SESSION_EXPIRED:"code-expired",MISSING_ANDROID_PACKAGE_NAME:"missing-android-pkg-name",UNAUTHORIZED_DOMAIN:"unauthorized-continue-uri",INVALID_OAUTH_CLIENT_ID:"invalid-oauth-client-id",ADMIN_ONLY_OPERATION:"admin-restricted-operation",INVALID_MFA_PENDING_CREDENTIAL:"invalid-multi-factor-session",MFA_ENROLLMENT_NOT_FOUND:"multi-factor-info-not-found",MISSING_MFA_ENROLLMENT_ID:"missing-multi-factor-info",MISSING_MFA_PENDING_CREDENTIAL:"missing-multi-factor-session",SECOND_FACTOR_EXISTS:"second-factor-already-in-use",SECOND_FACTOR_LIMIT_EXCEEDED:"maximum-second-factor-count-exceeded",BLOCKING_FUNCTION_ERROR_RESPONSE:"internal-error",RECAPTCHA_NOT_ENABLED:"recaptcha-not-enabled",MISSING_RECAPTCHA_TOKEN:"missing-recaptcha-token",INVALID_RECAPTCHA_TOKEN:"invalid-recaptcha-token",INVALID_RECAPTCHA_ACTION:"invalid-recaptcha-action",MISSING_CLIENT_TYPE:"missing-client-type",MISSING_RECAPTCHA_VERSION:"missing-recaptcha-version",INVALID_RECAPTCHA_VERSION:"invalid-recaptcha-version",INVALID_REQ_TYPE:"invalid-req-type"};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const IJ=["/v1/accounts:signInWithCustomToken","/v1/accounts:signInWithEmailLink","/v1/accounts:signInWithIdp","/v1/accounts:signInWithPassword","/v1/accounts:signInWithPhoneNumber","/v1/token"],MJ=new $A(3e4,6e4);function l0(t,e){return t.tenantId&&!e.tenantId?Object.assign(Object.assign({},e),{tenantId:t.tenantId}):e}async function L_(t,e,n,r,c={}){return G4(t,c,async()=>{let d={},m={};r&&(e==="GET"?m=r:d={body:JSON.stringify(r)});const s=HA(Object.assign({key:t.config.apiKey},m)).slice(1),T=await t._getAdditionalHeaders();T["Content-Type"]="application/json",t.languageCode&&(T["X-Firebase-Locale"]=t.languageCode);const D=Object.assign({method:e,headers:T},d);return iK()||(D.referrerPolicy="no-referrer"),t.emulatorConfig&&gT(t.emulatorConfig.host)&&(D.credentials="include"),$4.fetch()(await q4(t,t.config.apiHost,n,s),D)})}async function G4(t,e,n){t._canInitEmulator=!1;const r=Object.assign(Object.assign({},OJ),e);try{const c=new kJ(t),d=await Promise.race([n(),c.promise]);c.clearNetworkTimeout();const m=await d.json();if("needConfirmation"in m)throw nR(t,"account-exists-with-different-credential",m);if(d.ok&&!("errorMessage"in m))return m;{const s=d.ok?m.errorMessage:m.error.message,[T,D]=s.split(" : ");if(T==="FEDERATED_USER_ID_ALREADY_LINKED")throw nR(t,"credential-already-in-use",m);if(T==="EMAIL_EXISTS")throw nR(t,"email-already-in-use",m);if(T==="USER_DISABLED")throw nR(t,"user-disabled",m);const P=r[T]||T.toLowerCase().replace(/[_\s]+/g,"-");if(D)throw H4(t,P,D);_p(t,P)}}catch(c){if(c instanceof N_)throw c;_p(t,"network-request-failed",{message:String(c)})}}async function GA(t,e,n,r,c={}){const d=await L_(t,e,n,r,c);return"mfaPendingCredential"in d&&_p(t,"multi-factor-auth-required",{_serverResponse:d}),d}async function q4(t,e,n,r){const c=`${e}${n}?${r}`,d=t,m=d.config.emulator?y2(t.config,c):`${t.config.apiScheme}://${c}`;return IJ.includes(n)&&(await d._persistenceManagerAvailable,d._getPersistenceType()==="COOKIE")?d._getPersistence()._getFinalTarget(m).toString():m}function PJ(t){switch(t){case"ENFORCE":return"ENFORCE";case"AUDIT":return"AUDIT";case"OFF":return"OFF";default:return"ENFORCEMENT_STATE_UNSPECIFIED"}}class kJ{clearNetworkTimeout(){clearTimeout(this.timer)}constructor(e){this.auth=e,this.timer=null,this.promise=new Promise((n,r)=>{this.timer=setTimeout(()=>r(Um(this.auth,"network-request-failed")),MJ.get())})}}function nR(t,e,n){const r={appName:t.name};n.email&&(r.email=n.email),n.phoneNumber&&(r.phoneNumber=n.phoneNumber);const c=Um(t,e,r);return c.customData._tokenResponse=n,c}function e3(t){return t!==void 0&&t.enterprise!==void 0}class NJ{constructor(e){if(this.siteKey="",this.recaptchaEnforcementState=[],e.recaptchaKey===void 0)throw new Error("recaptchaKey undefined");this.siteKey=e.recaptchaKey.split("/")[3],this.recaptchaEnforcementState=e.recaptchaEnforcementState}getProviderEnforcementState(e){if(!this.recaptchaEnforcementState||this.recaptchaEnforcementState.length===0)return null;for(const n of this.recaptchaEnforcementState)if(n.provider&&n.provider===e)return PJ(n.enforcementState);return null}isProviderEnabled(e){return this.getProviderEnforcementState(e)==="ENFORCE"||this.getProviderEnforcementState(e)==="AUDIT"}isAnyProviderEnabled(){return this.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")||this.isProviderEnabled("PHONE_PROVIDER")}}async function LJ(t,e){return L_(t,"GET","/v2/recaptchaConfig",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function zJ(t,e){return L_(t,"POST","/v1/accounts:delete",e)}async function EO(t,e){return L_(t,"POST","/v1/accounts:lookup",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function US(t){if(t)try{const e=new Date(Number(t));if(!isNaN(e.getTime()))return e.toUTCString()}catch{}}async function BJ(t,e=!1){const n=Va(t),r=await n.getIdToken(e),c=v2(r);Yi(c&&c.exp&&c.auth_time&&c.iat,n.auth,"internal-error");const d=typeof c.firebase=="object"?c.firebase:void 0,m=d==null?void 0:d.sign_in_provider;return{claims:c,token:r,authTime:US(AP(c.auth_time)),issuedAtTime:US(AP(c.iat)),expirationTime:US(AP(c.exp)),signInProvider:m||null,signInSecondFactor:(d==null?void 0:d.sign_in_second_factor)||null}}function AP(t){return Number(t)*1e3}function v2(t){const[e,n,r]=t.split(".");if(e===void 0||n===void 0||r===void 0)return UR("JWT malformed, contained fewer than 3 sections"),null;try{const c=R4(n);return c?JSON.parse(c):(UR("Failed to decode base64 JWT payload"),null)}catch(c){return UR("Caught error parsing JWT payload as JSON",c==null?void 0:c.toString()),null}}function t3(t){const e=v2(t);return Yi(e,"internal-error"),Yi(typeof e.exp<"u","internal-error"),Yi(typeof e.iat<"u","internal-error"),Number(e.exp)-Number(e.iat)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Qw(t,e,n=!1){if(n)return e;try{return await e}catch(r){throw r instanceof N_&&FJ(r)&&t.auth.currentUser===t&&await t.auth.signOut(),r}}function FJ({code:t}){return t==="auth/user-disabled"||t==="auth/user-token-expired"}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VJ{constructor(e){this.user=e,this.isRunning=!1,this.timerId=null,this.errorBackoff=3e4}_start(){this.isRunning||(this.isRunning=!0,this.schedule())}_stop(){this.isRunning&&(this.isRunning=!1,this.timerId!==null&&clearTimeout(this.timerId))}getInterval(e){var n;if(e){const r=this.errorBackoff;return this.errorBackoff=Math.min(this.errorBackoff*2,96e4),r}else{this.errorBackoff=3e4;const c=((n=this.user.stsTokenManager.expirationTime)!==null&&n!==void 0?n:0)-Date.now()-3e5;return Math.max(0,c)}}schedule(e=!1){if(!this.isRunning)return;const n=this.getInterval(e);this.timerId=setTimeout(async()=>{await this.iteration()},n)}async iteration(){try{await this.user.getIdToken(!0)}catch(e){(e==null?void 0:e.code)==="auth/network-request-failed"&&this.schedule(!0);return}this.schedule()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bk{constructor(e,n){this.createdAt=e,this.lastLoginAt=n,this._initializeTime()}_initializeTime(){this.lastSignInTime=US(this.lastLoginAt),this.creationTime=US(this.createdAt)}_copy(e){this.createdAt=e.createdAt,this.lastLoginAt=e.lastLoginAt,this._initializeTime()}toJSON(){return{createdAt:this.createdAt,lastLoginAt:this.lastLoginAt}}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function SO(t){var e;const n=t.auth,r=await t.getIdToken(),c=await Qw(t,EO(n,{idToken:r}));Yi(c==null?void 0:c.users.length,n,"internal-error");const d=c.users[0];t._notifyReloadListener(d);const m=!((e=d.providerUserInfo)===null||e===void 0)&&e.length?W4(d.providerUserInfo):[],s=jJ(t.providerData,m),T=t.isAnonymous,D=!(t.email&&d.passwordHash)&&!(s!=null&&s.length),P=T?D:!1,z={uid:d.localId,displayName:d.displayName||null,photoURL:d.photoUrl||null,email:d.email||null,emailVerified:d.emailVerified||!1,phoneNumber:d.phoneNumber||null,tenantId:d.tenantId||null,providerData:s,metadata:new Bk(d.createdAt,d.lastLoginAt),isAnonymous:P};Object.assign(t,z)}async function UJ(t){const e=Va(t);await SO(e),await e.auth._persistUserIfCurrent(e),e.auth._notifyListenersIfCurrent(e)}function jJ(t,e){return[...t.filter(r=>!e.some(c=>c.providerId===r.providerId)),...e]}function W4(t){return t.map(e=>{var{providerId:n}=e,r=g2(e,["providerId"]);return{providerId:n,uid:r.rawId||"",displayName:r.displayName||null,email:r.email||null,phoneNumber:r.phoneNumber||null,photoURL:r.photoUrl||null}})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function HJ(t,e){const n=await G4(t,{},async()=>{const r=HA({grant_type:"refresh_token",refresh_token:e}).slice(1),{tokenApiHost:c,apiKey:d}=t.config,m=await q4(t,c,"/v1/token",`key=${d}`),s=await t._getAdditionalHeaders();s["Content-Type"]="application/x-www-form-urlencoded";const T={method:"POST",headers:s,body:r};return t.emulatorConfig&&gT(t.emulatorConfig.host)&&(T.credentials="include"),$4.fetch()(m,T)});return{accessToken:n.access_token,expiresIn:n.expires_in,refreshToken:n.refresh_token}}async function $J(t,e){return L_(t,"POST","/v2/accounts:revokeToken",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pw{constructor(){this.refreshToken=null,this.accessToken=null,this.expirationTime=null}get isExpired(){return!this.expirationTime||Date.now()>this.expirationTime-3e4}updateFromServerResponse(e){Yi(e.idToken,"internal-error"),Yi(typeof e.idToken<"u","internal-error"),Yi(typeof e.refreshToken<"u","internal-error");const n="expiresIn"in e&&typeof e.expiresIn<"u"?Number(e.expiresIn):t3(e.idToken);this.updateTokensAndExpiration(e.idToken,e.refreshToken,n)}updateFromIdToken(e){Yi(e.length!==0,"internal-error");const n=t3(e);this.updateTokensAndExpiration(e,null,n)}async getToken(e,n=!1){return!n&&this.accessToken&&!this.isExpired?this.accessToken:(Yi(this.refreshToken,e,"user-token-expired"),this.refreshToken?(await this.refresh(e,this.refreshToken),this.accessToken):null)}clearRefreshToken(){this.refreshToken=null}async refresh(e,n){const{accessToken:r,refreshToken:c,expiresIn:d}=await HJ(e,n);this.updateTokensAndExpiration(r,c,Number(d))}updateTokensAndExpiration(e,n,r){this.refreshToken=n||null,this.accessToken=e||null,this.expirationTime=Date.now()+r*1e3}static fromJSON(e,n){const{refreshToken:r,accessToken:c,expirationTime:d}=n,m=new Pw;return r&&(Yi(typeof r=="string","internal-error",{appName:e}),m.refreshToken=r),c&&(Yi(typeof c=="string","internal-error",{appName:e}),m.accessToken=c),d&&(Yi(typeof d=="number","internal-error",{appName:e}),m.expirationTime=d),m}toJSON(){return{refreshToken:this.refreshToken,accessToken:this.accessToken,expirationTime:this.expirationTime}}_assign(e){this.accessToken=e.accessToken,this.refreshToken=e.refreshToken,this.expirationTime=e.expirationTime}_clone(){return Object.assign(new Pw,this.toJSON())}_performRefresh(){return __("not implemented")}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Cv(t,e){Yi(typeof t=="string"||typeof t>"u","internal-error",{appName:e})}class pp{constructor(e){var{uid:n,auth:r,stsTokenManager:c}=e,d=g2(e,["uid","auth","stsTokenManager"]);this.providerId="firebase",this.proactiveRefresh=new VJ(this),this.reloadUserInfo=null,this.reloadListener=null,this.uid=n,this.auth=r,this.stsTokenManager=c,this.accessToken=c.accessToken,this.displayName=d.displayName||null,this.email=d.email||null,this.emailVerified=d.emailVerified||!1,this.phoneNumber=d.phoneNumber||null,this.photoURL=d.photoURL||null,this.isAnonymous=d.isAnonymous||!1,this.tenantId=d.tenantId||null,this.providerData=d.providerData?[...d.providerData]:[],this.metadata=new Bk(d.createdAt||void 0,d.lastLoginAt||void 0)}async getIdToken(e){const n=await Qw(this,this.stsTokenManager.getToken(this.auth,e));return Yi(n,this.auth,"internal-error"),this.accessToken!==n&&(this.accessToken=n,await this.auth._persistUserIfCurrent(this),this.auth._notifyListenersIfCurrent(this)),n}getIdTokenResult(e){return BJ(this,e)}reload(){return UJ(this)}_assign(e){this!==e&&(Yi(this.uid===e.uid,this.auth,"internal-error"),this.displayName=e.displayName,this.photoURL=e.photoURL,this.email=e.email,this.emailVerified=e.emailVerified,this.phoneNumber=e.phoneNumber,this.isAnonymous=e.isAnonymous,this.tenantId=e.tenantId,this.providerData=e.providerData.map(n=>Object.assign({},n)),this.metadata._copy(e.metadata),this.stsTokenManager._assign(e.stsTokenManager))}_clone(e){const n=new pp(Object.assign(Object.assign({},this),{auth:e,stsTokenManager:this.stsTokenManager._clone()}));return n.metadata._copy(this.metadata),n}_onReload(e){Yi(!this.reloadListener,this.auth,"internal-error"),this.reloadListener=e,this.reloadUserInfo&&(this._notifyReloadListener(this.reloadUserInfo),this.reloadUserInfo=null)}_notifyReloadListener(e){this.reloadListener?this.reloadListener(e):this.reloadUserInfo=e}_startProactiveRefresh(){this.proactiveRefresh._start()}_stopProactiveRefresh(){this.proactiveRefresh._stop()}async _updateTokensIfNecessary(e,n=!1){let r=!1;e.idToken&&e.idToken!==this.stsTokenManager.accessToken&&(this.stsTokenManager.updateFromServerResponse(e),r=!0),n&&await SO(this),await this.auth._persistUserIfCurrent(this),r&&this.auth._notifyListenersIfCurrent(this)}async delete(){if(Qd(this.auth.app))return Promise.reject(x_(this.auth));const e=await this.getIdToken();return await Qw(this,zJ(this.auth,{idToken:e})),this.stsTokenManager.clearRefreshToken(),this.auth.signOut()}toJSON(){return Object.assign(Object.assign({uid:this.uid,email:this.email||void 0,emailVerified:this.emailVerified,displayName:this.displayName||void 0,isAnonymous:this.isAnonymous,photoURL:this.photoURL||void 0,phoneNumber:this.phoneNumber||void 0,tenantId:this.tenantId||void 0,providerData:this.providerData.map(e=>Object.assign({},e)),stsTokenManager:this.stsTokenManager.toJSON(),_redirectEventId:this._redirectEventId},this.metadata.toJSON()),{apiKey:this.auth.config.apiKey,appName:this.auth.name})}get refreshToken(){return this.stsTokenManager.refreshToken||""}static _fromJSON(e,n){var r,c,d,m,s,T,D,P;const z=(r=n.displayName)!==null&&r!==void 0?r:void 0,F=(c=n.email)!==null&&c!==void 0?c:void 0,$=(d=n.phoneNumber)!==null&&d!==void 0?d:void 0,J=(m=n.photoURL)!==null&&m!==void 0?m:void 0,X=(s=n.tenantId)!==null&&s!==void 0?s:void 0,te=(T=n._redirectEventId)!==null&&T!==void 0?T:void 0,ie=(D=n.createdAt)!==null&&D!==void 0?D:void 0,we=(P=n.lastLoginAt)!==null&&P!==void 0?P:void 0,{uid:Ie,emailVerified:Re,isAnonymous:Ne,providerData:Xe,stsTokenManager:be}=n;Yi(Ie&&be,e,"internal-error");const _e=Pw.fromJSON(this.name,be);Yi(typeof Ie=="string",e,"internal-error"),Cv(z,e.name),Cv(F,e.name),Yi(typeof Re=="boolean",e,"internal-error"),Yi(typeof Ne=="boolean",e,"internal-error"),Cv($,e.name),Cv(J,e.name),Cv(X,e.name),Cv(te,e.name),Cv(ie,e.name),Cv(we,e.name);const Te=new pp({uid:Ie,auth:e,email:F,emailVerified:Re,displayName:z,isAnonymous:Ne,photoURL:J,phoneNumber:$,tenantId:X,stsTokenManager:_e,createdAt:ie,lastLoginAt:we});return Xe&&Array.isArray(Xe)&&(Te.providerData=Xe.map(oe=>Object.assign({},oe))),te&&(Te._redirectEventId=te),Te}static async _fromIdTokenResponse(e,n,r=!1){const c=new Pw;c.updateFromServerResponse(n);const d=new pp({uid:n.localId,auth:e,stsTokenManager:c,isAnonymous:r});return await SO(d),d}static async _fromGetAccountInfoResponse(e,n,r){const c=n.users[0];Yi(c.localId!==void 0,"internal-error");const d=c.providerUserInfo!==void 0?W4(c.providerUserInfo):[],m=!(c.email&&c.passwordHash)&&!(d!=null&&d.length),s=new Pw;s.updateFromIdToken(r);const T=new pp({uid:c.localId,auth:e,stsTokenManager:s,isAnonymous:m}),D={uid:c.localId,displayName:c.displayName||null,photoURL:c.photoUrl||null,email:c.email||null,emailVerified:c.emailVerified||!1,phoneNumber:c.phoneNumber||null,tenantId:c.tenantId||null,providerData:d,metadata:new Bk(c.createdAt,c.lastLoginAt),isAnonymous:!(c.email&&c.passwordHash)&&!(d!=null&&d.length)};return Object.assign(T,D),T}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const n3=new Map;function y_(t){D_(t instanceof Function,"Expected a class definition");let e=n3.get(t);return e?(D_(e instanceof t,"Instance stored in cache mismatched with class"),e):(e=new t,n3.set(t,e),e)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Y4{constructor(){this.type="NONE",this.storage={}}async _isAvailable(){return!0}async _set(e,n){this.storage[e]=n}async _get(e){const n=this.storage[e];return n===void 0?null:n}async _remove(e){delete this.storage[e]}_addListener(e,n){}_removeListener(e,n){}}Y4.type="NONE";const i3=Y4;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jR(t,e,n){return`firebase:${t}:${e}:${n}`}class kw{constructor(e,n,r){this.persistence=e,this.auth=n,this.userKey=r;const{config:c,name:d}=this.auth;this.fullUserKey=jR(this.userKey,c.apiKey,d),this.fullPersistenceKey=jR("persistence",c.apiKey,d),this.boundEventHandler=n._onStorageEvent.bind(n),this.persistence._addListener(this.fullUserKey,this.boundEventHandler)}setCurrentUser(e){return this.persistence._set(this.fullUserKey,e.toJSON())}async getCurrentUser(){const e=await this.persistence._get(this.fullUserKey);if(!e)return null;if(typeof e=="string"){const n=await EO(this.auth,{idToken:e}).catch(()=>{});return n?pp._fromGetAccountInfoResponse(this.auth,n,e):null}return pp._fromJSON(this.auth,e)}removeCurrentUser(){return this.persistence._remove(this.fullUserKey)}savePersistenceForRedirect(){return this.persistence._set(this.fullPersistenceKey,this.persistence.type)}async setPersistence(e){if(this.persistence===e)return;const n=await this.getCurrentUser();if(await this.removeCurrentUser(),this.persistence=e,n)return this.setCurrentUser(n)}delete(){this.persistence._removeListener(this.fullUserKey,this.boundEventHandler)}static async create(e,n,r="authUser"){if(!n.length)return new kw(y_(i3),e,r);const c=(await Promise.all(n.map(async D=>{if(await D._isAvailable())return D}))).filter(D=>D);let d=c[0]||y_(i3);const m=jR(r,e.config.apiKey,e.name);let s=null;for(const D of n)try{const P=await D._get(m);if(P){let z;if(typeof P=="string"){const F=await EO(e,{idToken:P}).catch(()=>{});if(!F)break;z=await pp._fromGetAccountInfoResponse(e,F,P)}else z=pp._fromJSON(e,P);D!==d&&(s=z),d=D;break}}catch{}const T=c.filter(D=>D._shouldAllowMigration);return!d._shouldAllowMigration||!T.length?new kw(d,e,r):(d=T[0],s&&await d._set(m,s.toJSON()),await Promise.all(n.map(async D=>{if(D!==d)try{await D._remove(m)}catch{}})),new kw(d,e,r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function r3(t){const e=t.toLowerCase();if(e.includes("opera/")||e.includes("opr/")||e.includes("opios/"))return"Opera";if(K4(e))return"IEMobile";if(e.includes("msie")||e.includes("trident/"))return"IE";if(e.includes("edge/"))return"Edge";if(Z4(e))return"Firefox";if(e.includes("silk/"))return"Silk";if(ej(e))return"Blackberry";if(tj(e))return"Webos";if(X4(e))return"Safari";if((e.includes("chrome/")||Q4(e))&&!e.includes("edge/"))return"Chrome";if(J4(e))return"Android";{const n=/([a-zA-Z\d\.]+)\/[a-zA-Z\d\.]*$/,r=t.match(n);if((r==null?void 0:r.length)===2)return r[1]}return"Other"}function Z4(t=jc()){return/firefox\//i.test(t)}function X4(t=jc()){const e=t.toLowerCase();return e.includes("safari/")&&!e.includes("chrome/")&&!e.includes("crios/")&&!e.includes("android")}function Q4(t=jc()){return/crios\//i.test(t)}function K4(t=jc()){return/iemobile/i.test(t)}function J4(t=jc()){return/android/i.test(t)}function ej(t=jc()){return/blackberry/i.test(t)}function tj(t=jc()){return/webos/i.test(t)}function b2(t=jc()){return/iphone|ipad|ipod/i.test(t)||/macintosh/i.test(t)&&/mobile/i.test(t)}function GJ(t=jc()){var e;return b2(t)&&!!(!((e=window.navigator)===null||e===void 0)&&e.standalone)}function qJ(){return oK()&&document.documentMode===10}function nj(t=jc()){return b2(t)||J4(t)||tj(t)||ej(t)||/windows phone/i.test(t)||K4(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function ij(t,e=[]){let n;switch(t){case"Browser":n=r3(jc());break;case"Worker":n=`${r3(jc())}-${t}`;break;default:n=t}const r=e.length?e.join(","):"FirebaseCore-web";return`${n}/JsCore/${_T}/${r}`}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class WJ{constructor(e){this.auth=e,this.queue=[]}pushCallback(e,n){const r=d=>new Promise((m,s)=>{try{const T=e(d);m(T)}catch(T){s(T)}});r.onAbort=n,this.queue.push(r);const c=this.queue.length-1;return()=>{this.queue[c]=()=>Promise.resolve()}}async runMiddleware(e){if(this.auth.currentUser===e)return;const n=[];try{for(const r of this.queue)await r(e),r.onAbort&&n.push(r.onAbort)}catch(r){n.reverse();for(const c of n)try{c()}catch{}throw this.auth._errorFactory.create("login-blocked",{originalMessage:r==null?void 0:r.message})}}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function YJ(t,e={}){return L_(t,"GET","/v2/passwordPolicy",l0(t,e))}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ZJ=6;class XJ{constructor(e){var n,r,c,d;const m=e.customStrengthOptions;this.customStrengthOptions={},this.customStrengthOptions.minPasswordLength=(n=m.minPasswordLength)!==null&&n!==void 0?n:ZJ,m.maxPasswordLength&&(this.customStrengthOptions.maxPasswordLength=m.maxPasswordLength),m.containsLowercaseCharacter!==void 0&&(this.customStrengthOptions.containsLowercaseLetter=m.containsLowercaseCharacter),m.containsUppercaseCharacter!==void 0&&(this.customStrengthOptions.containsUppercaseLetter=m.containsUppercaseCharacter),m.containsNumericCharacter!==void 0&&(this.customStrengthOptions.containsNumericCharacter=m.containsNumericCharacter),m.containsNonAlphanumericCharacter!==void 0&&(this.customStrengthOptions.containsNonAlphanumericCharacter=m.containsNonAlphanumericCharacter),this.enforcementState=e.enforcementState,this.enforcementState==="ENFORCEMENT_STATE_UNSPECIFIED"&&(this.enforcementState="OFF"),this.allowedNonAlphanumericCharacters=(c=(r=e.allowedNonAlphanumericCharacters)===null||r===void 0?void 0:r.join(""))!==null&&c!==void 0?c:"",this.forceUpgradeOnSignin=(d=e.forceUpgradeOnSignin)!==null&&d!==void 0?d:!1,this.schemaVersion=e.schemaVersion}validatePassword(e){var n,r,c,d,m,s;const T={isValid:!0,passwordPolicy:this};return this.validatePasswordLengthOptions(e,T),this.validatePasswordCharacterOptions(e,T),T.isValid&&(T.isValid=(n=T.meetsMinPasswordLength)!==null&&n!==void 0?n:!0),T.isValid&&(T.isValid=(r=T.meetsMaxPasswordLength)!==null&&r!==void 0?r:!0),T.isValid&&(T.isValid=(c=T.containsLowercaseLetter)!==null&&c!==void 0?c:!0),T.isValid&&(T.isValid=(d=T.containsUppercaseLetter)!==null&&d!==void 0?d:!0),T.isValid&&(T.isValid=(m=T.containsNumericCharacter)!==null&&m!==void 0?m:!0),T.isValid&&(T.isValid=(s=T.containsNonAlphanumericCharacter)!==null&&s!==void 0?s:!0),T}validatePasswordLengthOptions(e,n){const r=this.customStrengthOptions.minPasswordLength,c=this.customStrengthOptions.maxPasswordLength;r&&(n.meetsMinPasswordLength=e.length>=r),c&&(n.meetsMaxPasswordLength=e.length<=c)}validatePasswordCharacterOptions(e,n){this.updatePasswordCharacterOptionsStatuses(n,!1,!1,!1,!1);let r;for(let c=0;c<e.length;c++)r=e.charAt(c),this.updatePasswordCharacterOptionsStatuses(n,r>="a"&&r<="z",r>="A"&&r<="Z",r>="0"&&r<="9",this.allowedNonAlphanumericCharacters.includes(r))}updatePasswordCharacterOptionsStatuses(e,n,r,c,d){this.customStrengthOptions.containsLowercaseLetter&&(e.containsLowercaseLetter||(e.containsLowercaseLetter=n)),this.customStrengthOptions.containsUppercaseLetter&&(e.containsUppercaseLetter||(e.containsUppercaseLetter=r)),this.customStrengthOptions.containsNumericCharacter&&(e.containsNumericCharacter||(e.containsNumericCharacter=c)),this.customStrengthOptions.containsNonAlphanumericCharacter&&(e.containsNonAlphanumericCharacter||(e.containsNonAlphanumericCharacter=d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class QJ{constructor(e,n,r,c){this.app=e,this.heartbeatServiceProvider=n,this.appCheckServiceProvider=r,this.config=c,this.currentUser=null,this.emulatorConfig=null,this.operations=Promise.resolve(),this.authStateSubscription=new s3(this),this.idTokenSubscription=new s3(this),this.beforeStateQueue=new WJ(this),this.redirectUser=null,this.isProactiveRefreshEnabled=!1,this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION=1,this._canInitEmulator=!0,this._isInitialized=!1,this._deleted=!1,this._initializationPromise=null,this._popupRedirectResolver=null,this._errorFactory=j4,this._agentRecaptchaConfig=null,this._tenantRecaptchaConfigs={},this._projectPasswordPolicy=null,this._tenantPasswordPolicies={},this._resolvePersistenceManagerAvailable=void 0,this.lastNotifiedUid=void 0,this.languageCode=null,this.tenantId=null,this.settings={appVerificationDisabledForTesting:!1},this.frameworks=[],this.name=e.name,this.clientVersion=c.sdkClientVersion,this._persistenceManagerAvailable=new Promise(d=>this._resolvePersistenceManagerAvailable=d)}_initializeWithPersistence(e,n){return n&&(this._popupRedirectResolver=y_(n)),this._initializationPromise=this.queue(async()=>{var r,c,d;if(!this._deleted&&(this.persistenceManager=await kw.create(this,e),(r=this._resolvePersistenceManagerAvailable)===null||r===void 0||r.call(this),!this._deleted)){if(!((c=this._popupRedirectResolver)===null||c===void 0)&&c._shouldInitProactively)try{await this._popupRedirectResolver._initialize(this)}catch{}await this.initializeCurrentUser(n),this.lastNotifiedUid=((d=this.currentUser)===null||d===void 0?void 0:d.uid)||null,!this._deleted&&(this._isInitialized=!0)}}),this._initializationPromise}async _onStorageEvent(){if(this._deleted)return;const e=await this.assertedPersistence.getCurrentUser();if(!(!this.currentUser&&!e)){if(this.currentUser&&e&&this.currentUser.uid===e.uid){this._currentUser._assign(e),await this.currentUser.getIdToken();return}await this._updateCurrentUser(e,!0)}}async initializeCurrentUserFromIdToken(e){try{const n=await EO(this,{idToken:e}),r=await pp._fromGetAccountInfoResponse(this,n,e);await this.directlySetCurrentUser(r)}catch(n){console.warn("FirebaseServerApp could not login user with provided authIdToken: ",n),await this.directlySetCurrentUser(null)}}async initializeCurrentUser(e){var n;if(Qd(this.app)){const m=this.app.settings.authIdToken;return m?new Promise(s=>{setTimeout(()=>this.initializeCurrentUserFromIdToken(m).then(s,s))}):this.directlySetCurrentUser(null)}const r=await this.assertedPersistence.getCurrentUser();let c=r,d=!1;if(e&&this.config.authDomain){await this.getOrInitRedirectPersistenceManager();const m=(n=this.redirectUser)===null||n===void 0?void 0:n._redirectEventId,s=c==null?void 0:c._redirectEventId,T=await this.tryRedirectSignIn(e);(!m||m===s)&&(T!=null&&T.user)&&(c=T.user,d=!0)}if(!c)return this.directlySetCurrentUser(null);if(!c._redirectEventId){if(d)try{await this.beforeStateQueue.runMiddleware(c)}catch(m){c=r,this._popupRedirectResolver._overrideRedirectResult(this,()=>Promise.reject(m))}return c?this.reloadAndSetCurrentUserOrClear(c):this.directlySetCurrentUser(null)}return Yi(this._popupRedirectResolver,this,"argument-error"),await this.getOrInitRedirectPersistenceManager(),this.redirectUser&&this.redirectUser._redirectEventId===c._redirectEventId?this.directlySetCurrentUser(c):this.reloadAndSetCurrentUserOrClear(c)}async tryRedirectSignIn(e){let n=null;try{n=await this._popupRedirectResolver._completeRedirectFn(this,e,!0)}catch{await this._setRedirectUser(null)}return n}async reloadAndSetCurrentUserOrClear(e){try{await SO(e)}catch(n){if((n==null?void 0:n.code)!=="auth/network-request-failed")return this.directlySetCurrentUser(null)}return this.directlySetCurrentUser(e)}useDeviceLanguage(){this.languageCode=RJ()}async _delete(){this._deleted=!0}async updateCurrentUser(e){if(Qd(this.app))return Promise.reject(x_(this));const n=e?Va(e):null;return n&&Yi(n.auth.config.apiKey===this.config.apiKey,this,"invalid-user-token"),this._updateCurrentUser(n&&n._clone(this))}async _updateCurrentUser(e,n=!1){if(!this._deleted)return e&&Yi(this.tenantId===e.tenantId,this,"tenant-id-mismatch"),n||await this.beforeStateQueue.runMiddleware(e),this.queue(async()=>{await this.directlySetCurrentUser(e),this.notifyAuthListeners()})}async signOut(){return Qd(this.app)?Promise.reject(x_(this)):(await this.beforeStateQueue.runMiddleware(null),(this.redirectPersistenceManager||this._popupRedirectResolver)&&await this._setRedirectUser(null),this._updateCurrentUser(null,!0))}setPersistence(e){return Qd(this.app)?Promise.reject(x_(this)):this.queue(async()=>{await this.assertedPersistence.setPersistence(y_(e))})}_getRecaptchaConfig(){return this.tenantId==null?this._agentRecaptchaConfig:this._tenantRecaptchaConfigs[this.tenantId]}async validatePassword(e){this._getPasswordPolicyInternal()||await this._updatePasswordPolicy();const n=this._getPasswordPolicyInternal();return n.schemaVersion!==this.EXPECTED_PASSWORD_POLICY_SCHEMA_VERSION?Promise.reject(this._errorFactory.create("unsupported-password-policy-schema-version",{})):n.validatePassword(e)}_getPasswordPolicyInternal(){return this.tenantId===null?this._projectPasswordPolicy:this._tenantPasswordPolicies[this.tenantId]}async _updatePasswordPolicy(){const e=await YJ(this),n=new XJ(e);this.tenantId===null?this._projectPasswordPolicy=n:this._tenantPasswordPolicies[this.tenantId]=n}_getPersistenceType(){return this.assertedPersistence.persistence.type}_getPersistence(){return this.assertedPersistence.persistence}_updateErrorMap(e){this._errorFactory=new jA("auth","Firebase",e())}onAuthStateChanged(e,n,r){return this.registerStateListener(this.authStateSubscription,e,n,r)}beforeAuthStateChanged(e,n){return this.beforeStateQueue.pushCallback(e,n)}onIdTokenChanged(e,n,r){return this.registerStateListener(this.idTokenSubscription,e,n,r)}authStateReady(){return new Promise((e,n)=>{if(this.currentUser)e();else{const r=this.onAuthStateChanged(()=>{r(),e()},n)}})}async revokeAccessToken(e){if(this.currentUser){const n=await this.currentUser.getIdToken(),r={providerId:"apple.com",tokenType:"ACCESS_TOKEN",token:e,idToken:n};this.tenantId!=null&&(r.tenantId=this.tenantId),await $J(this,r)}}toJSON(){var e;return{apiKey:this.config.apiKey,authDomain:this.config.authDomain,appName:this.name,currentUser:(e=this._currentUser)===null||e===void 0?void 0:e.toJSON()}}async _setRedirectUser(e,n){const r=await this.getOrInitRedirectPersistenceManager(n);return e===null?r.removeCurrentUser():r.setCurrentUser(e)}async getOrInitRedirectPersistenceManager(e){if(!this.redirectPersistenceManager){const n=e&&y_(e)||this._popupRedirectResolver;Yi(n,this,"argument-error"),this.redirectPersistenceManager=await kw.create(this,[y_(n._redirectPersistence)],"redirectUser"),this.redirectUser=await this.redirectPersistenceManager.getCurrentUser()}return this.redirectPersistenceManager}async _redirectUserForId(e){var n,r;return this._isInitialized&&await this.queue(async()=>{}),((n=this._currentUser)===null||n===void 0?void 0:n._redirectEventId)===e?this._currentUser:((r=this.redirectUser)===null||r===void 0?void 0:r._redirectEventId)===e?this.redirectUser:null}async _persistUserIfCurrent(e){if(e===this.currentUser)return this.queue(async()=>this.directlySetCurrentUser(e))}_notifyListenersIfCurrent(e){e===this.currentUser&&this.notifyAuthListeners()}_key(){return`${this.config.authDomain}:${this.config.apiKey}:${this.name}`}_startProactiveRefresh(){this.isProactiveRefreshEnabled=!0,this.currentUser&&this._currentUser._startProactiveRefresh()}_stopProactiveRefresh(){this.isProactiveRefreshEnabled=!1,this.currentUser&&this._currentUser._stopProactiveRefresh()}get _currentUser(){return this.currentUser}notifyAuthListeners(){var e,n;if(!this._isInitialized)return;this.idTokenSubscription.next(this.currentUser);const r=(n=(e=this.currentUser)===null||e===void 0?void 0:e.uid)!==null&&n!==void 0?n:null;this.lastNotifiedUid!==r&&(this.lastNotifiedUid=r,this.authStateSubscription.next(this.currentUser))}registerStateListener(e,n,r,c){if(this._deleted)return()=>{};const d=typeof n=="function"?n:n.next.bind(n);let m=!1;const s=this._isInitialized?Promise.resolve():this._initializationPromise;if(Yi(s,this,"internal-error"),s.then(()=>{m||d(this.currentUser)}),typeof n=="function"){const T=e.addObserver(n,r,c);return()=>{m=!0,T()}}else{const T=e.addObserver(n);return()=>{m=!0,T()}}}async directlySetCurrentUser(e){this.currentUser&&this.currentUser!==e&&this._currentUser._stopProactiveRefresh(),e&&this.isProactiveRefreshEnabled&&e._startProactiveRefresh(),this.currentUser=e,e?await this.assertedPersistence.setCurrentUser(e):await this.assertedPersistence.removeCurrentUser()}queue(e){return this.operations=this.operations.then(e,e),this.operations}get assertedPersistence(){return Yi(this.persistenceManager,this,"internal-error"),this.persistenceManager}_logFramework(e){!e||this.frameworks.includes(e)||(this.frameworks.push(e),this.frameworks.sort(),this.clientVersion=ij(this.config.clientPlatform,this._getFrameworks()))}_getFrameworks(){return this.frameworks}async _getAdditionalHeaders(){var e;const n={"X-Client-Version":this.clientVersion};this.app.options.appId&&(n["X-Firebase-gmpid"]=this.app.options.appId);const r=await((e=this.heartbeatServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getHeartbeatsHeader());r&&(n["X-Firebase-Client"]=r);const c=await this._getAppCheckToken();return c&&(n["X-Firebase-AppCheck"]=c),n}async _getAppCheckToken(){var e;if(Qd(this.app)&&this.app.settings.appCheckToken)return this.app.settings.appCheckToken;const n=await((e=this.appCheckServiceProvider.getImmediate({optional:!0}))===null||e===void 0?void 0:e.getToken());return n!=null&&n.error&&AJ(`Error while retrieving App Check token: ${n.error}`),n==null?void 0:n.token}}function Dx(t){return Va(t)}class s3{constructor(e){this.auth=e,this.observer=null,this.addObserver=pK(n=>this.observer=n)}get next(){return Yi(this.observer,this.auth,"internal-error"),this.observer.next.bind(this.observer)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let FI={async loadJS(){throw new Error("Unable to load external scripts")},recaptchaV2Script:"",recaptchaEnterpriseScript:"",gapiScript:""};function KJ(t){FI=t}function rj(t){return FI.loadJS(t)}function JJ(){return FI.recaptchaEnterpriseScript}function eee(){return FI.gapiScript}function tee(t){return`__${t}${Math.floor(Math.random()*1e6)}`}class nee{constructor(){this.enterprise=new iee}ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}class iee{ready(e){e()}execute(e,n){return Promise.resolve("token")}render(e,n){return""}}const ree="recaptcha-enterprise",sj="NO_RECAPTCHA";class see{constructor(e){this.type=ree,this.auth=Dx(e)}async verify(e="verify",n=!1){async function r(d){if(!n){if(d.tenantId==null&&d._agentRecaptchaConfig!=null)return d._agentRecaptchaConfig.siteKey;if(d.tenantId!=null&&d._tenantRecaptchaConfigs[d.tenantId]!==void 0)return d._tenantRecaptchaConfigs[d.tenantId].siteKey}return new Promise(async(m,s)=>{LJ(d,{clientType:"CLIENT_TYPE_WEB",version:"RECAPTCHA_ENTERPRISE"}).then(T=>{if(T.recaptchaKey===void 0)s(new Error("recaptcha Enterprise site key undefined"));else{const D=new NJ(T);return d.tenantId==null?d._agentRecaptchaConfig=D:d._tenantRecaptchaConfigs[d.tenantId]=D,m(D.siteKey)}}).catch(T=>{s(T)})})}function c(d,m,s){const T=window.grecaptcha;e3(T)?T.enterprise.ready(()=>{T.enterprise.execute(d,{action:e}).then(D=>{m(D)}).catch(()=>{m(sj)})}):s(Error("No reCAPTCHA enterprise script loaded."))}return this.auth.settings.appVerificationDisabledForTesting?new nee().execute("siteKey",{action:"verify"}):new Promise((d,m)=>{r(this.auth).then(s=>{if(!n&&e3(window.grecaptcha))c(s,d,m);else{if(typeof window>"u"){m(new Error("RecaptchaVerifier is only supported in browser"));return}let T=JJ();T.length!==0&&(T+=s),rj(T).then(()=>{c(s,d,m)}).catch(D=>{m(D)})}}).catch(s=>{m(s)})})}}async function o3(t,e,n,r=!1,c=!1){const d=new see(t);let m;if(c)m=sj;else try{m=await d.verify(n)}catch{m=await d.verify(n,!0)}const s=Object.assign({},e);if(n==="mfaSmsEnrollment"||n==="mfaSmsSignIn"){if("phoneEnrollmentInfo"in s){const T=s.phoneEnrollmentInfo.phoneNumber,D=s.phoneEnrollmentInfo.recaptchaToken;Object.assign(s,{phoneEnrollmentInfo:{phoneNumber:T,recaptchaToken:D,captchaResponse:m,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}else if("phoneSignInInfo"in s){const T=s.phoneSignInInfo.recaptchaToken;Object.assign(s,{phoneSignInInfo:{recaptchaToken:T,captchaResponse:m,clientType:"CLIENT_TYPE_WEB",recaptchaVersion:"RECAPTCHA_ENTERPRISE"}})}return s}return r?Object.assign(s,{captchaResp:m}):Object.assign(s,{captchaResponse:m}),Object.assign(s,{clientType:"CLIENT_TYPE_WEB"}),Object.assign(s,{recaptchaVersion:"RECAPTCHA_ENTERPRISE"}),s}async function Fk(t,e,n,r,c){var d;if(!((d=t._getRecaptchaConfig())===null||d===void 0)&&d.isProviderEnabled("EMAIL_PASSWORD_PROVIDER")){const m=await o3(t,e,n,n==="getOobCode");return r(t,m)}else return r(t,e).catch(async m=>{if(m.code==="auth/missing-recaptcha-token"){console.log(`${n} is protected by reCAPTCHA Enterprise for this project. Automatically triggering the reCAPTCHA flow and restarting the flow.`);const s=await o3(t,e,n,n==="getOobCode");return r(t,s)}else return Promise.reject(m)})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function oee(t,e){const n=m2(t,"auth");if(n.isInitialized()){const c=n.getImmediate(),d=n.getOptions();if(A_(d,e??{}))return c;_p(c,"already-initialized")}return n.initialize({options:e})}function aee(t,e){const n=(e==null?void 0:e.persistence)||[],r=(Array.isArray(n)?n:[n]).map(y_);e!=null&&e.errorMap&&t._updateErrorMap(e.errorMap),t._initializeWithPersistence(r,e==null?void 0:e.popupRedirectResolver)}function lee(t,e,n){const r=Dx(t);Yi(/^https?:\/\//.test(e),r,"invalid-emulator-scheme");const c=!1,d=oj(e),{host:m,port:s}=cee(e),T=s===null?"":`:${s}`,D={url:`${d}//${m}${T}/`},P=Object.freeze({host:m,port:s,protocol:d.replace(":",""),options:Object.freeze({disableWarnings:c})});if(!r._canInitEmulator){Yi(r.config.emulator&&r.emulatorConfig,r,"emulator-config-failed"),Yi(A_(D,r.config.emulator)&&A_(P,r.emulatorConfig),r,"emulator-config-failed");return}r.config.emulator=D,r.emulatorConfig=P,r.settings.appVerificationDisabledForTesting=!0,gT(m)?(P4(`${d}//${m}${T}`),k4("Auth",!0)):uee()}function oj(t){const e=t.indexOf(":");return e<0?"":t.substr(0,e+1)}function cee(t){const e=oj(t),n=/(\/\/)?([^?#/]+)/.exec(t.substr(e.length));if(!n)return{host:"",port:null};const r=n[2].split("@").pop()||"",c=/^(\[[^\]]+\])(:|$)/.exec(r);if(c){const d=c[1];return{host:d,port:a3(r.substr(d.length+1))}}else{const[d,m]=r.split(":");return{host:d,port:a3(m)}}}function a3(t){if(!t)return null;const e=Number(t);return isNaN(e)?null:e}function uee(){function t(){const e=document.createElement("p"),n=e.style;e.innerText="Running in emulator mode. Do not use with production credentials.",n.position="fixed",n.width="100%",n.backgroundColor="#ffffff",n.border=".1em solid #000000",n.color="#b50000",n.bottom="0px",n.left="0px",n.margin="0px",n.zIndex="10000",n.textAlign="center",e.classList.add("firebase-emulator-warning"),document.body.appendChild(e)}typeof console<"u"&&typeof console.info=="function"&&console.info("WARNING: You are using the Auth Emulator, which is intended for local testing only.  Do not use with production credentials."),typeof window<"u"&&typeof document<"u"&&(document.readyState==="loading"?window.addEventListener("DOMContentLoaded",t):t())}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x2{constructor(e,n){this.providerId=e,this.signInMethod=n}toJSON(){return __("not implemented")}_getIdTokenResponse(e){return __("not implemented")}_linkToIdToken(e,n){return __("not implemented")}_getReauthenticationResolver(e){return __("not implemented")}}async function hee(t,e){return L_(t,"POST","/v1/accounts:signUp",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function dee(t,e){return GA(t,"POST","/v1/accounts:signInWithPassword",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function fee(t,e){return GA(t,"POST","/v1/accounts:signInWithEmailLink",l0(t,e))}async function pee(t,e){return GA(t,"POST","/v1/accounts:signInWithEmailLink",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class dA extends x2{constructor(e,n,r,c=null){super("password",r),this._email=e,this._password=n,this._tenantId=c}static _fromEmailAndPassword(e,n){return new dA(e,n,"password")}static _fromEmailAndCode(e,n,r=null){return new dA(e,n,"emailLink",r)}toJSON(){return{email:this._email,password:this._password,signInMethod:this.signInMethod,tenantId:this._tenantId}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e;if(n!=null&&n.email&&(n!=null&&n.password)){if(n.signInMethod==="password")return this._fromEmailAndPassword(n.email,n.password);if(n.signInMethod==="emailLink")return this._fromEmailAndCode(n.email,n.password,n.tenantId)}return null}async _getIdTokenResponse(e){switch(this.signInMethod){case"password":const n={returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fk(e,n,"signInWithPassword",dee);case"emailLink":return fee(e,{email:this._email,oobCode:this._password});default:_p(e,"internal-error")}}async _linkToIdToken(e,n){switch(this.signInMethod){case"password":const r={idToken:n,returnSecureToken:!0,email:this._email,password:this._password,clientType:"CLIENT_TYPE_WEB"};return Fk(e,r,"signUpPassword",hee);case"emailLink":return pee(e,{idToken:n,email:this._email,oobCode:this._password});default:_p(e,"internal-error")}}_getReauthenticationResolver(e){return this._getIdTokenResponse(e)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Nw(t,e){return GA(t,"POST","/v1/accounts:signInWithIdp",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const mee="http://localhost";class yx extends x2{constructor(){super(...arguments),this.pendingToken=null}static _fromParams(e){const n=new yx(e.providerId,e.signInMethod);return e.idToken||e.accessToken?(e.idToken&&(n.idToken=e.idToken),e.accessToken&&(n.accessToken=e.accessToken),e.nonce&&!e.pendingToken&&(n.nonce=e.nonce),e.pendingToken&&(n.pendingToken=e.pendingToken)):e.oauthToken&&e.oauthTokenSecret?(n.accessToken=e.oauthToken,n.secret=e.oauthTokenSecret):_p("argument-error"),n}toJSON(){return{idToken:this.idToken,accessToken:this.accessToken,secret:this.secret,nonce:this.nonce,pendingToken:this.pendingToken,providerId:this.providerId,signInMethod:this.signInMethod}}static fromJSON(e){const n=typeof e=="string"?JSON.parse(e):e,{providerId:r,signInMethod:c}=n,d=g2(n,["providerId","signInMethod"]);if(!r||!c)return null;const m=new yx(r,c);return m.idToken=d.idToken||void 0,m.accessToken=d.accessToken||void 0,m.secret=d.secret,m.nonce=d.nonce,m.pendingToken=d.pendingToken||null,m}_getIdTokenResponse(e){const n=this.buildRequest();return Nw(e,n)}_linkToIdToken(e,n){const r=this.buildRequest();return r.idToken=n,Nw(e,r)}_getReauthenticationResolver(e){const n=this.buildRequest();return n.autoCreate=!1,Nw(e,n)}buildRequest(){const e={requestUri:mee,returnSecureToken:!0};if(this.pendingToken)e.pendingToken=this.pendingToken;else{const n={};this.idToken&&(n.id_token=this.idToken),this.accessToken&&(n.access_token=this.accessToken),this.secret&&(n.oauth_token_secret=this.secret),n.providerId=this.providerId,this.nonce&&!this.pendingToken&&(n.nonce=this.nonce),e.postBody=HA(n)}return e}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function gee(t){switch(t){case"recoverEmail":return"RECOVER_EMAIL";case"resetPassword":return"PASSWORD_RESET";case"signIn":return"EMAIL_SIGNIN";case"verifyEmail":return"VERIFY_EMAIL";case"verifyAndChangeEmail":return"VERIFY_AND_CHANGE_EMAIL";case"revertSecondFactorAddition":return"REVERT_SECOND_FACTOR_ADDITION";default:return null}}function _ee(t){const e=SS(AS(t)).link,n=e?SS(AS(e)).deep_link_id:null,r=SS(AS(t)).deep_link_id;return(r?SS(AS(r)).link:null)||r||n||e||t}class w2{constructor(e){var n,r,c,d,m,s;const T=SS(AS(e)),D=(n=T.apiKey)!==null&&n!==void 0?n:null,P=(r=T.oobCode)!==null&&r!==void 0?r:null,z=gee((c=T.mode)!==null&&c!==void 0?c:null);Yi(D&&P&&z,"argument-error"),this.apiKey=D,this.operation=z,this.code=P,this.continueUrl=(d=T.continueUrl)!==null&&d!==void 0?d:null,this.languageCode=(m=T.lang)!==null&&m!==void 0?m:null,this.tenantId=(s=T.tenantId)!==null&&s!==void 0?s:null}static parseLink(e){const n=_ee(e);try{return new w2(n)}catch{return null}}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yT{constructor(){this.providerId=yT.PROVIDER_ID}static credential(e,n){return dA._fromEmailAndPassword(e,n)}static credentialWithLink(e,n){const r=w2.parseLink(n);return Yi(r,"argument-error"),dA._fromEmailAndCode(e,r.code,r.tenantId)}}yT.PROVIDER_ID="password";yT.EMAIL_PASSWORD_SIGN_IN_METHOD="password";yT.EMAIL_LINK_SIGN_IN_METHOD="emailLink";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class aj{constructor(e){this.providerId=e,this.defaultLanguageCode=null,this.customParameters={}}setDefaultLanguage(e){this.defaultLanguageCode=e}setCustomParameters(e){return this.customParameters=e,this}getCustomParameters(){return this.customParameters}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class qA extends aj{constructor(){super(...arguments),this.scopes=[]}addScope(e){return this.scopes.includes(e)||this.scopes.push(e),this}getScopes(){return[...this.scopes]}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rv extends qA{constructor(){super("facebook.com")}static credential(e){return yx._fromParams({providerId:Rv.PROVIDER_ID,signInMethod:Rv.FACEBOOK_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Rv.credentialFromTaggedObject(e)}static credentialFromError(e){return Rv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Rv.credential(e.oauthAccessToken)}catch{return null}}}Rv.FACEBOOK_SIGN_IN_METHOD="facebook.com";Rv.PROVIDER_ID="facebook.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ov extends qA{constructor(){super("google.com"),this.addScope("profile")}static credential(e,n){return yx._fromParams({providerId:Ov.PROVIDER_ID,signInMethod:Ov.GOOGLE_SIGN_IN_METHOD,idToken:e,accessToken:n})}static credentialFromResult(e){return Ov.credentialFromTaggedObject(e)}static credentialFromError(e){return Ov.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthIdToken:n,oauthAccessToken:r}=e;if(!n&&!r)return null;try{return Ov.credential(n,r)}catch{return null}}}Ov.GOOGLE_SIGN_IN_METHOD="google.com";Ov.PROVIDER_ID="google.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Iv extends qA{constructor(){super("github.com")}static credential(e){return yx._fromParams({providerId:Iv.PROVIDER_ID,signInMethod:Iv.GITHUB_SIGN_IN_METHOD,accessToken:e})}static credentialFromResult(e){return Iv.credentialFromTaggedObject(e)}static credentialFromError(e){return Iv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e||!("oauthAccessToken"in e)||!e.oauthAccessToken)return null;try{return Iv.credential(e.oauthAccessToken)}catch{return null}}}Iv.GITHUB_SIGN_IN_METHOD="github.com";Iv.PROVIDER_ID="github.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Mv extends qA{constructor(){super("twitter.com")}static credential(e,n){return yx._fromParams({providerId:Mv.PROVIDER_ID,signInMethod:Mv.TWITTER_SIGN_IN_METHOD,oauthToken:e,oauthTokenSecret:n})}static credentialFromResult(e){return Mv.credentialFromTaggedObject(e)}static credentialFromError(e){return Mv.credentialFromTaggedObject(e.customData||{})}static credentialFromTaggedObject({_tokenResponse:e}){if(!e)return null;const{oauthAccessToken:n,oauthTokenSecret:r}=e;if(!n||!r)return null;try{return Mv.credential(n,r)}catch{return null}}}Mv.TWITTER_SIGN_IN_METHOD="twitter.com";Mv.PROVIDER_ID="twitter.com";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function yee(t,e){return GA(t,"POST","/v1/accounts:signUp",l0(t,e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vx{constructor(e){this.user=e.user,this.providerId=e.providerId,this._tokenResponse=e._tokenResponse,this.operationType=e.operationType}static async _fromIdTokenResponse(e,n,r,c=!1){const d=await pp._fromIdTokenResponse(e,r,c),m=l3(r);return new vx({user:d,providerId:m,_tokenResponse:r,operationType:n})}static async _forOperation(e,n,r){await e._updateTokensIfNecessary(r,!0);const c=l3(r);return new vx({user:e,providerId:c,_tokenResponse:r,operationType:n})}}function l3(t){return t.providerId?t.providerId:"phoneNumber"in t?"phone":null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class AO extends N_{constructor(e,n,r,c){var d;super(n.code,n.message),this.operationType=r,this.user=c,Object.setPrototypeOf(this,AO.prototype),this.customData={appName:e.name,tenantId:(d=e.tenantId)!==null&&d!==void 0?d:void 0,_serverResponse:n.customData._serverResponse,operationType:r}}static _fromErrorAndOperation(e,n,r,c){return new AO(e,n,r,c)}}function lj(t,e,n,r){return(e==="reauthenticate"?n._getReauthenticationResolver(t):n._getIdTokenResponse(t)).catch(d=>{throw d.code==="auth/multi-factor-auth-required"?AO._fromErrorAndOperation(t,d,e,r):d})}async function vee(t,e,n=!1){const r=await Qw(t,e._linkToIdToken(t.auth,await t.getIdToken()),n);return vx._forOperation(t,"link",r)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bee(t,e,n=!1){const{auth:r}=t;if(Qd(r.app))return Promise.reject(x_(r));const c="reauthenticate";try{const d=await Qw(t,lj(r,c,e,t),n);Yi(d.idToken,r,"internal-error");const m=v2(d.idToken);Yi(m,r,"internal-error");const{sub:s}=m;return Yi(t.uid===s,r,"user-mismatch"),vx._forOperation(t,c,d)}catch(d){throw(d==null?void 0:d.code)==="auth/user-not-found"&&_p(r,"user-mismatch"),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function cj(t,e,n=!1){if(Qd(t.app))return Promise.reject(x_(t));const r="signIn",c=await lj(t,r,e),d=await vx._fromIdTokenResponse(t,r,c);return n||await t._updateCurrentUser(d.user),d}async function xee(t,e){return cj(Dx(t),e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function uj(t){const e=Dx(t);e._getPasswordPolicyInternal()&&await e._updatePasswordPolicy()}async function wee(t,e,n){if(Qd(t.app))return Promise.reject(x_(t));const r=Dx(t),m=await Fk(r,{returnSecureToken:!0,email:e,password:n,clientType:"CLIENT_TYPE_WEB"},"signUpPassword",yee).catch(T=>{throw T.code==="auth/password-does-not-meet-requirements"&&uj(t),T}),s=await vx._fromIdTokenResponse(r,"signIn",m);return await r._updateCurrentUser(s.user),s}function Tee(t,e,n){return Qd(t.app)?Promise.reject(x_(t)):xee(Va(t),yT.credential(e,n)).catch(async r=>{throw r.code==="auth/password-does-not-meet-requirements"&&uj(t),r})}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function Eee(t,e){return L_(t,"POST","/v1/accounts:update",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function c3(t,{displayName:e,photoURL:n}){if(e===void 0&&n===void 0)return;const r=Va(t),d={idToken:await r.getIdToken(),displayName:e,photoUrl:n,returnSecureToken:!0},m=await Qw(r,Eee(r.auth,d));r.displayName=m.displayName||null,r.photoURL=m.photoUrl||null;const s=r.providerData.find(({providerId:T})=>T==="password");s&&(s.displayName=r.displayName,s.photoURL=r.photoURL),await r._updateTokensIfNecessary(m)}function See(t,e,n,r){return Va(t).onIdTokenChanged(e,n,r)}function Aee(t,e,n){return Va(t).beforeAuthStateChanged(e,n)}function Cee(t,e,n,r){return Va(t).onAuthStateChanged(e,n,r)}function Dee(t){return Va(t).signOut()}const CO="__sak";/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class hj{constructor(e,n){this.storageRetriever=e,this.type=n}_isAvailable(){try{return this.storage?(this.storage.setItem(CO,"1"),this.storage.removeItem(CO),Promise.resolve(!0)):Promise.resolve(!1)}catch{return Promise.resolve(!1)}}_set(e,n){return this.storage.setItem(e,JSON.stringify(n)),Promise.resolve()}_get(e){const n=this.storage.getItem(e);return Promise.resolve(n?JSON.parse(n):null)}_remove(e){return this.storage.removeItem(e),Promise.resolve()}get storage(){return this.storageRetriever()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ree=1e3,Oee=10;class dj extends hj{constructor(){super(()=>window.localStorage,"LOCAL"),this.boundEventHandler=(e,n)=>this.onStorageEvent(e,n),this.listeners={},this.localCache={},this.pollTimer=null,this.fallbackToPolling=nj(),this._shouldAllowMigration=!0}forAllChangedKeys(e){for(const n of Object.keys(this.listeners)){const r=this.storage.getItem(n),c=this.localCache[n];r!==c&&e(n,c,r)}}onStorageEvent(e,n=!1){if(!e.key){this.forAllChangedKeys((m,s,T)=>{this.notifyListeners(m,T)});return}const r=e.key;n?this.detachListener():this.stopPolling();const c=()=>{const m=this.storage.getItem(r);!n&&this.localCache[r]===m||this.notifyListeners(r,m)},d=this.storage.getItem(r);qJ()&&d!==e.newValue&&e.newValue!==e.oldValue?setTimeout(c,Oee):c()}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n&&JSON.parse(n))}startPolling(){this.stopPolling(),this.pollTimer=setInterval(()=>{this.forAllChangedKeys((e,n,r)=>{this.onStorageEvent(new StorageEvent("storage",{key:e,oldValue:n,newValue:r}),!0)})},Ree)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}attachListener(){window.addEventListener("storage",this.boundEventHandler)}detachListener(){window.removeEventListener("storage",this.boundEventHandler)}_addListener(e,n){Object.keys(this.listeners).length===0&&(this.fallbackToPolling?this.startPolling():this.attachListener()),this.listeners[e]||(this.listeners[e]=new Set,this.localCache[e]=this.storage.getItem(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&(this.detachListener(),this.stopPolling())}async _set(e,n){await super._set(e,n),this.localCache[e]=JSON.stringify(n)}async _get(e){const n=await super._get(e);return this.localCache[e]=JSON.stringify(n),n}async _remove(e){await super._remove(e),delete this.localCache[e]}}dj.type="LOCAL";const Iee=dj;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class fj extends hj{constructor(){super(()=>window.sessionStorage,"SESSION")}_addListener(e,n){}_removeListener(e,n){}}fj.type="SESSION";const pj=fj;/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Mee(t){return Promise.all(t.map(async e=>{try{return{fulfilled:!0,value:await e}}catch(n){return{fulfilled:!1,reason:n}}}))}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class VI{constructor(e){this.eventTarget=e,this.handlersMap={},this.boundEventHandler=this.handleEvent.bind(this)}static _getInstance(e){const n=this.receivers.find(c=>c.isListeningto(e));if(n)return n;const r=new VI(e);return this.receivers.push(r),r}isListeningto(e){return this.eventTarget===e}async handleEvent(e){const n=e,{eventId:r,eventType:c,data:d}=n.data,m=this.handlersMap[c];if(!(m!=null&&m.size))return;n.ports[0].postMessage({status:"ack",eventId:r,eventType:c});const s=Array.from(m).map(async D=>D(n.origin,d)),T=await Mee(s);n.ports[0].postMessage({status:"done",eventId:r,eventType:c,response:T})}_subscribe(e,n){Object.keys(this.handlersMap).length===0&&this.eventTarget.addEventListener("message",this.boundEventHandler),this.handlersMap[e]||(this.handlersMap[e]=new Set),this.handlersMap[e].add(n)}_unsubscribe(e,n){this.handlersMap[e]&&n&&this.handlersMap[e].delete(n),(!n||this.handlersMap[e].size===0)&&delete this.handlersMap[e],Object.keys(this.handlersMap).length===0&&this.eventTarget.removeEventListener("message",this.boundEventHandler)}}VI.receivers=[];/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function T2(t="",e=10){let n="";for(let r=0;r<e;r++)n+=Math.floor(Math.random()*10);return t+n}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pee{constructor(e){this.target=e,this.handlers=new Set}removeMessageHandler(e){e.messageChannel&&(e.messageChannel.port1.removeEventListener("message",e.onMessage),e.messageChannel.port1.close()),this.handlers.delete(e)}async _send(e,n,r=50){const c=typeof MessageChannel<"u"?new MessageChannel:null;if(!c)throw new Error("connection_unavailable");let d,m;return new Promise((s,T)=>{const D=T2("",20);c.port1.start();const P=setTimeout(()=>{T(new Error("unsupported_event"))},r);m={messageChannel:c,onMessage(z){const F=z;if(F.data.eventId===D)switch(F.data.status){case"ack":clearTimeout(P),d=setTimeout(()=>{T(new Error("timeout"))},3e3);break;case"done":clearTimeout(d),s(F.data.response);break;default:clearTimeout(P),clearTimeout(d),T(new Error("invalid_response"));break}}},this.handlers.add(m),c.port1.addEventListener("message",m.onMessage),this.target.postMessage({eventType:e,eventId:D,data:n},[c.port2])}).finally(()=>{m&&this.removeMessageHandler(m)})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function jm(){return window}function kee(t){jm().location.href=t}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function mj(){return typeof jm().WorkerGlobalScope<"u"&&typeof jm().importScripts=="function"}async function Nee(){if(!(navigator!=null&&navigator.serviceWorker))return null;try{return(await navigator.serviceWorker.ready).active}catch{return null}}function Lee(){var t;return((t=navigator==null?void 0:navigator.serviceWorker)===null||t===void 0?void 0:t.controller)||null}function zee(){return mj()?self:null}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const gj="firebaseLocalStorageDb",Bee=1,DO="firebaseLocalStorage",_j="fbase_key";class WA{constructor(e){this.request=e}toPromise(){return new Promise((e,n)=>{this.request.addEventListener("success",()=>{e(this.request.result)}),this.request.addEventListener("error",()=>{n(this.request.error)})})}}function UI(t,e){return t.transaction([DO],e?"readwrite":"readonly").objectStore(DO)}function Fee(){const t=indexedDB.deleteDatabase(gj);return new WA(t).toPromise()}function Vk(){const t=indexedDB.open(gj,Bee);return new Promise((e,n)=>{t.addEventListener("error",()=>{n(t.error)}),t.addEventListener("upgradeneeded",()=>{const r=t.result;try{r.createObjectStore(DO,{keyPath:_j})}catch(c){n(c)}}),t.addEventListener("success",async()=>{const r=t.result;r.objectStoreNames.contains(DO)?e(r):(r.close(),await Fee(),e(await Vk()))})})}async function u3(t,e,n){const r=UI(t,!0).put({[_j]:e,value:n});return new WA(r).toPromise()}async function Vee(t,e){const n=UI(t,!1).get(e),r=await new WA(n).toPromise();return r===void 0?null:r.value}function h3(t,e){const n=UI(t,!0).delete(e);return new WA(n).toPromise()}const Uee=800,jee=3;class yj{constructor(){this.type="LOCAL",this._shouldAllowMigration=!0,this.listeners={},this.localCache={},this.pollTimer=null,this.pendingWrites=0,this.receiver=null,this.sender=null,this.serviceWorkerReceiverAvailable=!1,this.activeServiceWorker=null,this._workerInitializationPromise=this.initializeServiceWorkerMessaging().then(()=>{},()=>{})}async _openDb(){return this.db?this.db:(this.db=await Vk(),this.db)}async _withRetries(e){let n=0;for(;;)try{const r=await this._openDb();return await e(r)}catch(r){if(n++>jee)throw r;this.db&&(this.db.close(),this.db=void 0)}}async initializeServiceWorkerMessaging(){return mj()?this.initializeReceiver():this.initializeSender()}async initializeReceiver(){this.receiver=VI._getInstance(zee()),this.receiver._subscribe("keyChanged",async(e,n)=>({keyProcessed:(await this._poll()).includes(n.key)})),this.receiver._subscribe("ping",async(e,n)=>["keyChanged"])}async initializeSender(){var e,n;if(this.activeServiceWorker=await Nee(),!this.activeServiceWorker)return;this.sender=new Pee(this.activeServiceWorker);const r=await this.sender._send("ping",{},800);r&&!((e=r[0])===null||e===void 0)&&e.fulfilled&&!((n=r[0])===null||n===void 0)&&n.value.includes("keyChanged")&&(this.serviceWorkerReceiverAvailable=!0)}async notifyServiceWorker(e){if(!(!this.sender||!this.activeServiceWorker||Lee()!==this.activeServiceWorker))try{await this.sender._send("keyChanged",{key:e},this.serviceWorkerReceiverAvailable?800:50)}catch{}}async _isAvailable(){try{if(!indexedDB)return!1;const e=await Vk();return await u3(e,CO,"1"),await h3(e,CO),!0}catch{}return!1}async _withPendingWrite(e){this.pendingWrites++;try{await e()}finally{this.pendingWrites--}}async _set(e,n){return this._withPendingWrite(async()=>(await this._withRetries(r=>u3(r,e,n)),this.localCache[e]=n,this.notifyServiceWorker(e)))}async _get(e){const n=await this._withRetries(r=>Vee(r,e));return this.localCache[e]=n,n}async _remove(e){return this._withPendingWrite(async()=>(await this._withRetries(n=>h3(n,e)),delete this.localCache[e],this.notifyServiceWorker(e)))}async _poll(){const e=await this._withRetries(c=>{const d=UI(c,!1).getAll();return new WA(d).toPromise()});if(!e)return[];if(this.pendingWrites!==0)return[];const n=[],r=new Set;if(e.length!==0)for(const{fbase_key:c,value:d}of e)r.add(c),JSON.stringify(this.localCache[c])!==JSON.stringify(d)&&(this.notifyListeners(c,d),n.push(c));for(const c of Object.keys(this.localCache))this.localCache[c]&&!r.has(c)&&(this.notifyListeners(c,null),n.push(c));return n}notifyListeners(e,n){this.localCache[e]=n;const r=this.listeners[e];if(r)for(const c of Array.from(r))c(n)}startPolling(){this.stopPolling(),this.pollTimer=setInterval(async()=>this._poll(),Uee)}stopPolling(){this.pollTimer&&(clearInterval(this.pollTimer),this.pollTimer=null)}_addListener(e,n){Object.keys(this.listeners).length===0&&this.startPolling(),this.listeners[e]||(this.listeners[e]=new Set,this._get(e)),this.listeners[e].add(n)}_removeListener(e,n){this.listeners[e]&&(this.listeners[e].delete(n),this.listeners[e].size===0&&delete this.listeners[e]),Object.keys(this.listeners).length===0&&this.stopPolling()}}yj.type="LOCAL";const Hee=yj;new $A(3e4,6e4);/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function $ee(t,e){return e?y_(e):(Yi(t._popupRedirectResolver,t,"argument-error"),t._popupRedirectResolver)}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class E2 extends x2{constructor(e){super("custom","custom"),this.params=e}_getIdTokenResponse(e){return Nw(e,this._buildIdpRequest())}_linkToIdToken(e,n){return Nw(e,this._buildIdpRequest(n))}_getReauthenticationResolver(e){return Nw(e,this._buildIdpRequest())}_buildIdpRequest(e){const n={requestUri:this.params.requestUri,sessionId:this.params.sessionId,postBody:this.params.postBody,tenantId:this.params.tenantId,pendingToken:this.params.pendingToken,returnSecureToken:!0,returnIdpCredential:!0};return e&&(n.idToken=e),n}}function Gee(t){return cj(t.auth,new E2(t),t.bypassAuthState)}function qee(t){const{auth:e,user:n}=t;return Yi(n,e,"internal-error"),bee(n,new E2(t),t.bypassAuthState)}async function Wee(t){const{auth:e,user:n}=t;return Yi(n,e,"internal-error"),vee(n,new E2(t),t.bypassAuthState)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vj{constructor(e,n,r,c,d=!1){this.auth=e,this.resolver=r,this.user=c,this.bypassAuthState=d,this.pendingPromise=null,this.eventManager=null,this.filter=Array.isArray(n)?n:[n]}execute(){return new Promise(async(e,n)=>{this.pendingPromise={resolve:e,reject:n};try{this.eventManager=await this.resolver._initialize(this.auth),await this.onExecution(),this.eventManager.registerConsumer(this)}catch(r){this.reject(r)}})}async onAuthEvent(e){const{urlResponse:n,sessionId:r,postBody:c,tenantId:d,error:m,type:s}=e;if(m){this.reject(m);return}const T={auth:this.auth,requestUri:n,sessionId:r,tenantId:d||void 0,postBody:c||void 0,user:this.user,bypassAuthState:this.bypassAuthState};try{this.resolve(await this.getIdpTask(s)(T))}catch(D){this.reject(D)}}onError(e){this.reject(e)}getIdpTask(e){switch(e){case"signInViaPopup":case"signInViaRedirect":return Gee;case"linkViaPopup":case"linkViaRedirect":return Wee;case"reauthViaPopup":case"reauthViaRedirect":return qee;default:_p(this.auth,"internal-error")}}resolve(e){D_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.resolve(e),this.unregisterAndCleanUp()}reject(e){D_(this.pendingPromise,"Pending promise was never set"),this.pendingPromise.reject(e),this.unregisterAndCleanUp()}unregisterAndCleanUp(){this.eventManager&&this.eventManager.unregisterConsumer(this),this.pendingPromise=null,this.cleanUp()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Yee=new $A(2e3,1e4);class Dw extends vj{constructor(e,n,r,c,d){super(e,n,c,d),this.provider=r,this.authWindow=null,this.pollId=null,Dw.currentPopupAction&&Dw.currentPopupAction.cancel(),Dw.currentPopupAction=this}async executeNotNull(){const e=await this.execute();return Yi(e,this.auth,"internal-error"),e}async onExecution(){D_(this.filter.length===1,"Popup operations only handle one event");const e=T2();this.authWindow=await this.resolver._openPopup(this.auth,this.provider,this.filter[0],e),this.authWindow.associatedEvent=e,this.resolver._originValidation(this.auth).catch(n=>{this.reject(n)}),this.resolver._isIframeWebStorageSupported(this.auth,n=>{n||this.reject(Um(this.auth,"web-storage-unsupported"))}),this.pollUserCancellation()}get eventId(){var e;return((e=this.authWindow)===null||e===void 0?void 0:e.associatedEvent)||null}cancel(){this.reject(Um(this.auth,"cancelled-popup-request"))}cleanUp(){this.authWindow&&this.authWindow.close(),this.pollId&&window.clearTimeout(this.pollId),this.authWindow=null,this.pollId=null,Dw.currentPopupAction=null}pollUserCancellation(){const e=()=>{var n,r;if(!((r=(n=this.authWindow)===null||n===void 0?void 0:n.window)===null||r===void 0)&&r.closed){this.pollId=window.setTimeout(()=>{this.pollId=null,this.reject(Um(this.auth,"popup-closed-by-user"))},8e3);return}this.pollId=window.setTimeout(e,Yee.get())};e()}}Dw.currentPopupAction=null;/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Zee="pendingRedirect",HR=new Map;class Xee extends vj{constructor(e,n,r=!1){super(e,["signInViaRedirect","linkViaRedirect","reauthViaRedirect","unknown"],n,void 0,r),this.eventId=null}async execute(){let e=HR.get(this.auth._key());if(!e){try{const r=await Qee(this.resolver,this.auth)?await super.execute():null;e=()=>Promise.resolve(r)}catch(n){e=()=>Promise.reject(n)}HR.set(this.auth._key(),e)}return this.bypassAuthState||HR.set(this.auth._key(),()=>Promise.resolve(null)),e()}async onAuthEvent(e){if(e.type==="signInViaRedirect")return super.onAuthEvent(e);if(e.type==="unknown"){this.resolve(null);return}if(e.eventId){const n=await this.auth._redirectUserForId(e.eventId);if(n)return this.user=n,super.onAuthEvent(e);this.resolve(null)}}async onExecution(){}cleanUp(){}}async function Qee(t,e){const n=ete(e),r=Jee(t);if(!await r._isAvailable())return!1;const c=await r._get(n)==="true";return await r._remove(n),c}function Kee(t,e){HR.set(t._key(),e)}function Jee(t){return y_(t._redirectPersistence)}function ete(t){return jR(Zee,t.config.apiKey,t.name)}async function tte(t,e,n=!1){if(Qd(t.app))return Promise.reject(x_(t));const r=Dx(t),c=$ee(r,e),m=await new Xee(r,c,n).execute();return m&&!n&&(delete m.user._redirectEventId,await r._persistUserIfCurrent(m.user),await r._setRedirectUser(null,e)),m}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const nte=10*60*1e3;class ite{constructor(e){this.auth=e,this.cachedEventUids=new Set,this.consumers=new Set,this.queuedRedirectEvent=null,this.hasHandledPotentialRedirect=!1,this.lastProcessedEventTime=Date.now()}registerConsumer(e){this.consumers.add(e),this.queuedRedirectEvent&&this.isEventForConsumer(this.queuedRedirectEvent,e)&&(this.sendToConsumer(this.queuedRedirectEvent,e),this.saveEventToCache(this.queuedRedirectEvent),this.queuedRedirectEvent=null)}unregisterConsumer(e){this.consumers.delete(e)}onEvent(e){if(this.hasEventBeenHandled(e))return!1;let n=!1;return this.consumers.forEach(r=>{this.isEventForConsumer(e,r)&&(n=!0,this.sendToConsumer(e,r),this.saveEventToCache(e))}),this.hasHandledPotentialRedirect||!rte(e)||(this.hasHandledPotentialRedirect=!0,n||(this.queuedRedirectEvent=e,n=!0)),n}sendToConsumer(e,n){var r;if(e.error&&!bj(e)){const c=((r=e.error.code)===null||r===void 0?void 0:r.split("auth/")[1])||"internal-error";n.onError(Um(this.auth,c))}else n.onAuthEvent(e)}isEventForConsumer(e,n){const r=n.eventId===null||!!e.eventId&&e.eventId===n.eventId;return n.filter.includes(e.type)&&r}hasEventBeenHandled(e){return Date.now()-this.lastProcessedEventTime>=nte&&this.cachedEventUids.clear(),this.cachedEventUids.has(d3(e))}saveEventToCache(e){this.cachedEventUids.add(d3(e)),this.lastProcessedEventTime=Date.now()}}function d3(t){return[t.type,t.eventId,t.sessionId,t.tenantId].filter(e=>e).join("-")}function bj({type:t,error:e}){return t==="unknown"&&(e==null?void 0:e.code)==="auth/no-auth-event"}function rte(t){switch(t.type){case"signInViaRedirect":case"linkViaRedirect":case"reauthViaRedirect":return!0;case"unknown":return bj(t);default:return!1}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function ste(t,e={}){return L_(t,"GET","/v1/projects",e)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ote=/^\d{1,3}\.\d{1,3}\.\d{1,3}\.\d{1,3}$/,ate=/^https?/;async function lte(t){if(t.config.emulator)return;const{authorizedDomains:e}=await ste(t);for(const n of e)try{if(cte(n))return}catch{}_p(t,"unauthorized-domain")}function cte(t){const e=zk(),{protocol:n,hostname:r}=new URL(e);if(t.startsWith("chrome-extension://")){const m=new URL(t);return m.hostname===""&&r===""?n==="chrome-extension:"&&t.replace("chrome-extension://","")===e.replace("chrome-extension://",""):n==="chrome-extension:"&&m.hostname===r}if(!ate.test(n))return!1;if(ote.test(t))return r===t;const c=t.replace(/\./g,"\\.");return new RegExp("^(.+\\."+c+"|"+c+")$","i").test(r)}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const ute=new $A(3e4,6e4);function f3(){const t=jm().___jsl;if(t!=null&&t.H){for(const e of Object.keys(t.H))if(t.H[e].r=t.H[e].r||[],t.H[e].L=t.H[e].L||[],t.H[e].r=[...t.H[e].L],t.CP)for(let n=0;n<t.CP.length;n++)t.CP[n]=null}}function hte(t){return new Promise((e,n)=>{var r,c,d;function m(){f3(),gapi.load("gapi.iframes",{callback:()=>{e(gapi.iframes.getContext())},ontimeout:()=>{f3(),n(Um(t,"network-request-failed"))},timeout:ute.get()})}if(!((c=(r=jm().gapi)===null||r===void 0?void 0:r.iframes)===null||c===void 0)&&c.Iframe)e(gapi.iframes.getContext());else if(!((d=jm().gapi)===null||d===void 0)&&d.load)m();else{const s=tee("iframefcb");return jm()[s]=()=>{gapi.load?m():n(Um(t,"network-request-failed"))},rj(`${eee()}?onload=${s}`).catch(T=>n(T))}}).catch(e=>{throw $R=null,e})}let $R=null;function dte(t){return $R=$R||hte(t),$R}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fte=new $A(5e3,15e3),pte="__/auth/iframe",mte="emulator/auth/iframe",gte={style:{position:"absolute",top:"-100px",width:"1px",height:"1px"},"aria-hidden":"true",tabindex:"-1"},_te=new Map([["identitytoolkit.googleapis.com","p"],["staging-identitytoolkit.sandbox.googleapis.com","s"],["test-identitytoolkit.sandbox.googleapis.com","t"]]);function yte(t){const e=t.config;Yi(e.authDomain,t,"auth-domain-config-required");const n=e.emulator?y2(e,mte):`https://${t.config.authDomain}/${pte}`,r={apiKey:e.apiKey,appName:t.name,v:_T},c=_te.get(t.config.apiHost);c&&(r.eid=c);const d=t._getFrameworks();return d.length&&(r.fw=d.join(",")),`${n}?${HA(r).slice(1)}`}async function vte(t){const e=await dte(t),n=jm().gapi;return Yi(n,t,"internal-error"),e.open({where:document.body,url:yte(t),messageHandlersFilter:n.iframes.CROSS_ORIGIN_IFRAMES_FILTER,attributes:gte,dontclear:!0},r=>new Promise(async(c,d)=>{await r.restyle({setHideOnLeave:!1});const m=Um(t,"network-request-failed"),s=jm().setTimeout(()=>{d(m)},fte.get());function T(){jm().clearTimeout(s),c(r)}r.ping(T).then(T,()=>{d(m)})}))}/**
 * @license
 * Copyright 2020 Google LLC.
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bte={location:"yes",resizable:"yes",statusbar:"yes",toolbar:"no"},xte=500,wte=600,Tte="_blank",Ete="http://localhost";class p3{constructor(e){this.window=e,this.associatedEvent=null}close(){if(this.window)try{this.window.close()}catch{}}}function Ste(t,e,n,r=xte,c=wte){const d=Math.max((window.screen.availHeight-c)/2,0).toString(),m=Math.max((window.screen.availWidth-r)/2,0).toString();let s="";const T=Object.assign(Object.assign({},bte),{width:r.toString(),height:c.toString(),top:d,left:m}),D=jc().toLowerCase();n&&(s=Q4(D)?Tte:n),Z4(D)&&(e=e||Ete,T.scrollbars="yes");const P=Object.entries(T).reduce((F,[$,J])=>`${F}${$}=${J},`,"");if(GJ(D)&&s!=="_self")return Ate(e||"",s),new p3(null);const z=window.open(e||"",s,P);Yi(z,t,"popup-blocked");try{z.focus()}catch{}return new p3(z)}function Ate(t,e){const n=document.createElement("a");n.href=t,n.target=e;const r=document.createEvent("MouseEvent");r.initMouseEvent("click",!0,!0,window,1,0,0,0,0,!1,!1,!1,!1,1,null),n.dispatchEvent(r)}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Cte="__/auth/handler",Dte="emulator/auth/handler",Rte=encodeURIComponent("fac");async function m3(t,e,n,r,c,d){Yi(t.config.authDomain,t,"auth-domain-config-required"),Yi(t.config.apiKey,t,"invalid-api-key");const m={apiKey:t.config.apiKey,appName:t.name,authType:n,redirectUrl:r,v:_T,eventId:c};if(e instanceof aj){e.setDefaultLanguage(t.languageCode),m.providerId=e.providerId||"",fK(e.getCustomParameters())||(m.customParameters=JSON.stringify(e.getCustomParameters()));for(const[P,z]of Object.entries({}))m[P]=z}if(e instanceof qA){const P=e.getScopes().filter(z=>z!=="");P.length>0&&(m.scopes=P.join(","))}t.tenantId&&(m.tid=t.tenantId);const s=m;for(const P of Object.keys(s))s[P]===void 0&&delete s[P];const T=await t._getAppCheckToken(),D=T?`#${Rte}=${encodeURIComponent(T)}`:"";return`${Ote(t)}?${HA(s).slice(1)}${D}`}function Ote({config:t}){return t.emulator?y2(t,Dte):`https://${t.authDomain}/${Cte}`}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const CP="webStorageSupport";class Ite{constructor(){this.eventManagers={},this.iframes={},this.originValidationPromises={},this._redirectPersistence=pj,this._completeRedirectFn=tte,this._overrideRedirectResult=Kee}async _openPopup(e,n,r,c){var d;D_((d=this.eventManagers[e._key()])===null||d===void 0?void 0:d.manager,"_initialize() not called before _openPopup()");const m=await m3(e,n,r,zk(),c);return Ste(e,m,T2())}async _openRedirect(e,n,r,c){await this._originValidation(e);const d=await m3(e,n,r,zk(),c);return kee(d),new Promise(()=>{})}_initialize(e){const n=e._key();if(this.eventManagers[n]){const{manager:c,promise:d}=this.eventManagers[n];return c?Promise.resolve(c):(D_(d,"If manager is not set, promise should be"),d)}const r=this.initAndGetManager(e);return this.eventManagers[n]={promise:r},r.catch(()=>{delete this.eventManagers[n]}),r}async initAndGetManager(e){const n=await vte(e),r=new ite(e);return n.register("authEvent",c=>(Yi(c==null?void 0:c.authEvent,e,"invalid-auth-event"),{status:r.onEvent(c.authEvent)?"ACK":"ERROR"}),gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER),this.eventManagers[e._key()]={manager:r},this.iframes[e._key()]=n,r}_isIframeWebStorageSupported(e,n){this.iframes[e._key()].send(CP,{type:CP},c=>{var d;const m=(d=c==null?void 0:c[0])===null||d===void 0?void 0:d[CP];m!==void 0&&n(!!m),_p(e,"internal-error")},gapi.iframes.CROSS_ORIGIN_IFRAMES_FILTER)}_originValidation(e){const n=e._key();return this.originValidationPromises[n]||(this.originValidationPromises[n]=lte(e)),this.originValidationPromises[n]}get _shouldInitProactively(){return nj()||X4()||b2()}}const Mte=Ite;var g3="@firebase/auth",_3="1.10.7";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pte{constructor(e){this.auth=e,this.internalListeners=new Map}getUid(){var e;return this.assertAuthConfigured(),((e=this.auth.currentUser)===null||e===void 0?void 0:e.uid)||null}async getToken(e){return this.assertAuthConfigured(),await this.auth._initializationPromise,this.auth.currentUser?{accessToken:await this.auth.currentUser.getIdToken(e)}:null}addAuthTokenListener(e){if(this.assertAuthConfigured(),this.internalListeners.has(e))return;const n=this.auth.onIdTokenChanged(r=>{e((r==null?void 0:r.stsTokenManager.accessToken)||null)});this.internalListeners.set(e,n),this.updateProactiveRefresh()}removeAuthTokenListener(e){this.assertAuthConfigured();const n=this.internalListeners.get(e);n&&(this.internalListeners.delete(e),n(),this.updateProactiveRefresh())}assertAuthConfigured(){Yi(this.auth._initializationPromise,"dependent-sdk-initialized-before-auth")}updateProactiveRefresh(){this.internalListeners.size>0?this.auth._startProactiveRefresh():this.auth._stopProactiveRefresh()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function kte(t){switch(t){case"Node":return"node";case"ReactNative":return"rn";case"Worker":return"webworker";case"Cordova":return"cordova";case"WebExtension":return"web-extension";default:return}}function Nte(t){Xw(new _x("auth",(e,{options:n})=>{const r=e.getProvider("app").getImmediate(),c=e.getProvider("heartbeat"),d=e.getProvider("app-check-internal"),{apiKey:m,authDomain:s}=r.options;Yi(m&&!m.includes(":"),"invalid-api-key",{appName:r.name});const T={apiKey:m,authDomain:s,clientPlatform:t,apiHost:"identitytoolkit.googleapis.com",tokenApiHost:"securetoken.googleapis.com",apiScheme:"https",sdkClientVersion:ij(t)},D=new QJ(r,c,d,T);return aee(D,n),D},"PUBLIC").setInstantiationMode("EXPLICIT").setInstanceCreatedCallback((e,n,r)=>{e.getProvider("auth-internal").initialize()})),Xw(new _x("auth-internal",e=>{const n=Dx(e.getProvider("auth").getImmediate());return(r=>new Pte(r))(n)},"PRIVATE").setInstantiationMode("EXPLICIT")),jv(g3,_3,kte(t)),jv(g3,_3,"esm2017")}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Lte=5*60,zte=M4("authIdTokenMaxAge")||Lte;let y3=null;const Bte=t=>async e=>{const n=e&&await e.getIdTokenResult(),r=n&&(new Date().getTime()-Date.parse(n.issuedAtTime))/1e3;if(r&&r>zte)return;const c=n==null?void 0:n.token;y3!==c&&(y3=c,await fetch(t,{method:c?"POST":"DELETE",headers:c?{Authorization:`Bearer ${c}`}:{}}))};function Fte(t=B4()){const e=m2(t,"auth");if(e.isInitialized())return e.getImmediate();const n=oee(t,{popupRedirectResolver:Mte,persistence:[Hee,Iee,pj]}),r=M4("authTokenSyncURL");if(r&&typeof isSecureContext=="boolean"&&isSecureContext){const d=new URL(r,location.origin);if(location.origin===d.origin){const m=Bte(d.toString());Aee(n,m,()=>m(n.currentUser)),See(n,s=>m(s))}}const c=O4("auth");return c&&lee(n,`http://${c}`),n}function Vte(){var t,e;return(e=(t=document.getElementsByTagName("head"))===null||t===void 0?void 0:t[0])!==null&&e!==void 0?e:document}KJ({loadJS(t){return new Promise((e,n)=>{const r=document.createElement("script");r.setAttribute("src",t),r.onload=e,r.onerror=c=>{const d=Um("internal-error");d.customData=c,n(d)},r.type="text/javascript",r.charset="UTF-8",Vte().appendChild(r)})},gapiScript:"https://apis.google.com/js/api.js",recaptchaV2Script:"https://www.google.com/recaptcha/api.js",recaptchaEnterpriseScript:"https://www.google.com/recaptcha/enterprise.js?render="});Nte("Browser");var Ute="firebase",jte="11.9.1";/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */jv(Ute,jte,"app");var v3=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var Hv,xj;(function(){var t;/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/function e(be,_e){function Te(){}Te.prototype=_e.prototype,be.D=_e.prototype,be.prototype=new Te,be.prototype.constructor=be,be.C=function(oe,Ee,$e){for(var ze=Array(arguments.length-2),zt=2;zt<arguments.length;zt++)ze[zt-2]=arguments[zt];return _e.prototype[Ee].apply(oe,ze)}}function n(){this.blockSize=-1}function r(){this.blockSize=-1,this.blockSize=64,this.g=Array(4),this.B=Array(this.blockSize),this.o=this.h=0,this.s()}e(r,n),r.prototype.s=function(){this.g[0]=1732584193,this.g[1]=4023233417,this.g[2]=2562383102,this.g[3]=271733878,this.o=this.h=0};function c(be,_e,Te){Te||(Te=0);var oe=Array(16);if(typeof _e=="string")for(var Ee=0;16>Ee;++Ee)oe[Ee]=_e.charCodeAt(Te++)|_e.charCodeAt(Te++)<<8|_e.charCodeAt(Te++)<<16|_e.charCodeAt(Te++)<<24;else for(Ee=0;16>Ee;++Ee)oe[Ee]=_e[Te++]|_e[Te++]<<8|_e[Te++]<<16|_e[Te++]<<24;_e=be.g[0],Te=be.g[1],Ee=be.g[2];var $e=be.g[3],ze=_e+($e^Te&(Ee^$e))+oe[0]+3614090360&4294967295;_e=Te+(ze<<7&4294967295|ze>>>25),ze=$e+(Ee^_e&(Te^Ee))+oe[1]+3905402710&4294967295,$e=_e+(ze<<12&4294967295|ze>>>20),ze=Ee+(Te^$e&(_e^Te))+oe[2]+606105819&4294967295,Ee=$e+(ze<<17&4294967295|ze>>>15),ze=Te+(_e^Ee&($e^_e))+oe[3]+3250441966&4294967295,Te=Ee+(ze<<22&4294967295|ze>>>10),ze=_e+($e^Te&(Ee^$e))+oe[4]+4118548399&4294967295,_e=Te+(ze<<7&4294967295|ze>>>25),ze=$e+(Ee^_e&(Te^Ee))+oe[5]+1200080426&4294967295,$e=_e+(ze<<12&4294967295|ze>>>20),ze=Ee+(Te^$e&(_e^Te))+oe[6]+2821735955&4294967295,Ee=$e+(ze<<17&4294967295|ze>>>15),ze=Te+(_e^Ee&($e^_e))+oe[7]+4249261313&4294967295,Te=Ee+(ze<<22&4294967295|ze>>>10),ze=_e+($e^Te&(Ee^$e))+oe[8]+1770035416&4294967295,_e=Te+(ze<<7&4294967295|ze>>>25),ze=$e+(Ee^_e&(Te^Ee))+oe[9]+2336552879&4294967295,$e=_e+(ze<<12&4294967295|ze>>>20),ze=Ee+(Te^$e&(_e^Te))+oe[10]+4294925233&4294967295,Ee=$e+(ze<<17&4294967295|ze>>>15),ze=Te+(_e^Ee&($e^_e))+oe[11]+2304563134&4294967295,Te=Ee+(ze<<22&4294967295|ze>>>10),ze=_e+($e^Te&(Ee^$e))+oe[12]+1804603682&4294967295,_e=Te+(ze<<7&4294967295|ze>>>25),ze=$e+(Ee^_e&(Te^Ee))+oe[13]+4254626195&4294967295,$e=_e+(ze<<12&4294967295|ze>>>20),ze=Ee+(Te^$e&(_e^Te))+oe[14]+2792965006&4294967295,Ee=$e+(ze<<17&4294967295|ze>>>15),ze=Te+(_e^Ee&($e^_e))+oe[15]+1236535329&4294967295,Te=Ee+(ze<<22&4294967295|ze>>>10),ze=_e+(Ee^$e&(Te^Ee))+oe[1]+4129170786&4294967295,_e=Te+(ze<<5&4294967295|ze>>>27),ze=$e+(Te^Ee&(_e^Te))+oe[6]+3225465664&4294967295,$e=_e+(ze<<9&4294967295|ze>>>23),ze=Ee+(_e^Te&($e^_e))+oe[11]+643717713&4294967295,Ee=$e+(ze<<14&4294967295|ze>>>18),ze=Te+($e^_e&(Ee^$e))+oe[0]+3921069994&4294967295,Te=Ee+(ze<<20&4294967295|ze>>>12),ze=_e+(Ee^$e&(Te^Ee))+oe[5]+3593408605&4294967295,_e=Te+(ze<<5&4294967295|ze>>>27),ze=$e+(Te^Ee&(_e^Te))+oe[10]+38016083&4294967295,$e=_e+(ze<<9&4294967295|ze>>>23),ze=Ee+(_e^Te&($e^_e))+oe[15]+3634488961&4294967295,Ee=$e+(ze<<14&4294967295|ze>>>18),ze=Te+($e^_e&(Ee^$e))+oe[4]+3889429448&4294967295,Te=Ee+(ze<<20&4294967295|ze>>>12),ze=_e+(Ee^$e&(Te^Ee))+oe[9]+568446438&4294967295,_e=Te+(ze<<5&4294967295|ze>>>27),ze=$e+(Te^Ee&(_e^Te))+oe[14]+3275163606&4294967295,$e=_e+(ze<<9&4294967295|ze>>>23),ze=Ee+(_e^Te&($e^_e))+oe[3]+4107603335&4294967295,Ee=$e+(ze<<14&4294967295|ze>>>18),ze=Te+($e^_e&(Ee^$e))+oe[8]+1163531501&4294967295,Te=Ee+(ze<<20&4294967295|ze>>>12),ze=_e+(Ee^$e&(Te^Ee))+oe[13]+2850285829&4294967295,_e=Te+(ze<<5&4294967295|ze>>>27),ze=$e+(Te^Ee&(_e^Te))+oe[2]+4243563512&4294967295,$e=_e+(ze<<9&4294967295|ze>>>23),ze=Ee+(_e^Te&($e^_e))+oe[7]+1735328473&4294967295,Ee=$e+(ze<<14&4294967295|ze>>>18),ze=Te+($e^_e&(Ee^$e))+oe[12]+2368359562&4294967295,Te=Ee+(ze<<20&4294967295|ze>>>12),ze=_e+(Te^Ee^$e)+oe[5]+4294588738&4294967295,_e=Te+(ze<<4&4294967295|ze>>>28),ze=$e+(_e^Te^Ee)+oe[8]+2272392833&4294967295,$e=_e+(ze<<11&4294967295|ze>>>21),ze=Ee+($e^_e^Te)+oe[11]+1839030562&4294967295,Ee=$e+(ze<<16&4294967295|ze>>>16),ze=Te+(Ee^$e^_e)+oe[14]+4259657740&4294967295,Te=Ee+(ze<<23&4294967295|ze>>>9),ze=_e+(Te^Ee^$e)+oe[1]+2763975236&4294967295,_e=Te+(ze<<4&4294967295|ze>>>28),ze=$e+(_e^Te^Ee)+oe[4]+1272893353&4294967295,$e=_e+(ze<<11&4294967295|ze>>>21),ze=Ee+($e^_e^Te)+oe[7]+4139469664&4294967295,Ee=$e+(ze<<16&4294967295|ze>>>16),ze=Te+(Ee^$e^_e)+oe[10]+3200236656&4294967295,Te=Ee+(ze<<23&4294967295|ze>>>9),ze=_e+(Te^Ee^$e)+oe[13]+681279174&4294967295,_e=Te+(ze<<4&4294967295|ze>>>28),ze=$e+(_e^Te^Ee)+oe[0]+3936430074&4294967295,$e=_e+(ze<<11&4294967295|ze>>>21),ze=Ee+($e^_e^Te)+oe[3]+3572445317&4294967295,Ee=$e+(ze<<16&4294967295|ze>>>16),ze=Te+(Ee^$e^_e)+oe[6]+76029189&4294967295,Te=Ee+(ze<<23&4294967295|ze>>>9),ze=_e+(Te^Ee^$e)+oe[9]+3654602809&4294967295,_e=Te+(ze<<4&4294967295|ze>>>28),ze=$e+(_e^Te^Ee)+oe[12]+3873151461&4294967295,$e=_e+(ze<<11&4294967295|ze>>>21),ze=Ee+($e^_e^Te)+oe[15]+530742520&4294967295,Ee=$e+(ze<<16&4294967295|ze>>>16),ze=Te+(Ee^$e^_e)+oe[2]+3299628645&4294967295,Te=Ee+(ze<<23&4294967295|ze>>>9),ze=_e+(Ee^(Te|~$e))+oe[0]+4096336452&4294967295,_e=Te+(ze<<6&4294967295|ze>>>26),ze=$e+(Te^(_e|~Ee))+oe[7]+1126891415&4294967295,$e=_e+(ze<<10&4294967295|ze>>>22),ze=Ee+(_e^($e|~Te))+oe[14]+2878612391&4294967295,Ee=$e+(ze<<15&4294967295|ze>>>17),ze=Te+($e^(Ee|~_e))+oe[5]+4237533241&4294967295,Te=Ee+(ze<<21&4294967295|ze>>>11),ze=_e+(Ee^(Te|~$e))+oe[12]+1700485571&4294967295,_e=Te+(ze<<6&4294967295|ze>>>26),ze=$e+(Te^(_e|~Ee))+oe[3]+2399980690&4294967295,$e=_e+(ze<<10&4294967295|ze>>>22),ze=Ee+(_e^($e|~Te))+oe[10]+4293915773&4294967295,Ee=$e+(ze<<15&4294967295|ze>>>17),ze=Te+($e^(Ee|~_e))+oe[1]+2240044497&4294967295,Te=Ee+(ze<<21&4294967295|ze>>>11),ze=_e+(Ee^(Te|~$e))+oe[8]+1873313359&4294967295,_e=Te+(ze<<6&4294967295|ze>>>26),ze=$e+(Te^(_e|~Ee))+oe[15]+4264355552&4294967295,$e=_e+(ze<<10&4294967295|ze>>>22),ze=Ee+(_e^($e|~Te))+oe[6]+2734768916&4294967295,Ee=$e+(ze<<15&4294967295|ze>>>17),ze=Te+($e^(Ee|~_e))+oe[13]+1309151649&4294967295,Te=Ee+(ze<<21&4294967295|ze>>>11),ze=_e+(Ee^(Te|~$e))+oe[4]+4149444226&4294967295,_e=Te+(ze<<6&4294967295|ze>>>26),ze=$e+(Te^(_e|~Ee))+oe[11]+3174756917&4294967295,$e=_e+(ze<<10&4294967295|ze>>>22),ze=Ee+(_e^($e|~Te))+oe[2]+718787259&4294967295,Ee=$e+(ze<<15&4294967295|ze>>>17),ze=Te+($e^(Ee|~_e))+oe[9]+3951481745&4294967295,be.g[0]=be.g[0]+_e&4294967295,be.g[1]=be.g[1]+(Ee+(ze<<21&4294967295|ze>>>11))&4294967295,be.g[2]=be.g[2]+Ee&4294967295,be.g[3]=be.g[3]+$e&4294967295}r.prototype.u=function(be,_e){_e===void 0&&(_e=be.length);for(var Te=_e-this.blockSize,oe=this.B,Ee=this.h,$e=0;$e<_e;){if(Ee==0)for(;$e<=Te;)c(this,be,$e),$e+=this.blockSize;if(typeof be=="string"){for(;$e<_e;)if(oe[Ee++]=be.charCodeAt($e++),Ee==this.blockSize){c(this,oe),Ee=0;break}}else for(;$e<_e;)if(oe[Ee++]=be[$e++],Ee==this.blockSize){c(this,oe),Ee=0;break}}this.h=Ee,this.o+=_e},r.prototype.v=function(){var be=Array((56>this.h?this.blockSize:2*this.blockSize)-this.h);be[0]=128;for(var _e=1;_e<be.length-8;++_e)be[_e]=0;var Te=8*this.o;for(_e=be.length-8;_e<be.length;++_e)be[_e]=Te&255,Te/=256;for(this.u(be),be=Array(16),_e=Te=0;4>_e;++_e)for(var oe=0;32>oe;oe+=8)be[Te++]=this.g[_e]>>>oe&255;return be};function d(be,_e){var Te=s;return Object.prototype.hasOwnProperty.call(Te,be)?Te[be]:Te[be]=_e(be)}function m(be,_e){this.h=_e;for(var Te=[],oe=!0,Ee=be.length-1;0<=Ee;Ee--){var $e=be[Ee]|0;oe&&$e==_e||(Te[Ee]=$e,oe=!1)}this.g=Te}var s={};function T(be){return-128<=be&&128>be?d(be,function(_e){return new m([_e|0],0>_e?-1:0)}):new m([be|0],0>be?-1:0)}function D(be){if(isNaN(be)||!isFinite(be))return z;if(0>be)return te(D(-be));for(var _e=[],Te=1,oe=0;be>=Te;oe++)_e[oe]=be/Te|0,Te*=4294967296;return new m(_e,0)}function P(be,_e){if(be.length==0)throw Error("number format error: empty string");if(_e=_e||10,2>_e||36<_e)throw Error("radix out of range: "+_e);if(be.charAt(0)=="-")return te(P(be.substring(1),_e));if(0<=be.indexOf("-"))throw Error('number format error: interior "-" character');for(var Te=D(Math.pow(_e,8)),oe=z,Ee=0;Ee<be.length;Ee+=8){var $e=Math.min(8,be.length-Ee),ze=parseInt(be.substring(Ee,Ee+$e),_e);8>$e?($e=D(Math.pow(_e,$e)),oe=oe.j($e).add(D(ze))):(oe=oe.j(Te),oe=oe.add(D(ze)))}return oe}var z=T(0),F=T(1),$=T(16777216);t=m.prototype,t.m=function(){if(X(this))return-te(this).m();for(var be=0,_e=1,Te=0;Te<this.g.length;Te++){var oe=this.i(Te);be+=(0<=oe?oe:4294967296+oe)*_e,_e*=4294967296}return be},t.toString=function(be){if(be=be||10,2>be||36<be)throw Error("radix out of range: "+be);if(J(this))return"0";if(X(this))return"-"+te(this).toString(be);for(var _e=D(Math.pow(be,6)),Te=this,oe="";;){var Ee=Re(Te,_e).g;Te=ie(Te,Ee.j(_e));var $e=((0<Te.g.length?Te.g[0]:Te.h)>>>0).toString(be);if(Te=Ee,J(Te))return $e+oe;for(;6>$e.length;)$e="0"+$e;oe=$e+oe}},t.i=function(be){return 0>be?0:be<this.g.length?this.g[be]:this.h};function J(be){if(be.h!=0)return!1;for(var _e=0;_e<be.g.length;_e++)if(be.g[_e]!=0)return!1;return!0}function X(be){return be.h==-1}t.l=function(be){return be=ie(this,be),X(be)?-1:J(be)?0:1};function te(be){for(var _e=be.g.length,Te=[],oe=0;oe<_e;oe++)Te[oe]=~be.g[oe];return new m(Te,~be.h).add(F)}t.abs=function(){return X(this)?te(this):this},t.add=function(be){for(var _e=Math.max(this.g.length,be.g.length),Te=[],oe=0,Ee=0;Ee<=_e;Ee++){var $e=oe+(this.i(Ee)&65535)+(be.i(Ee)&65535),ze=($e>>>16)+(this.i(Ee)>>>16)+(be.i(Ee)>>>16);oe=ze>>>16,$e&=65535,ze&=65535,Te[Ee]=ze<<16|$e}return new m(Te,Te[Te.length-1]&-2147483648?-1:0)};function ie(be,_e){return be.add(te(_e))}t.j=function(be){if(J(this)||J(be))return z;if(X(this))return X(be)?te(this).j(te(be)):te(te(this).j(be));if(X(be))return te(this.j(te(be)));if(0>this.l($)&&0>be.l($))return D(this.m()*be.m());for(var _e=this.g.length+be.g.length,Te=[],oe=0;oe<2*_e;oe++)Te[oe]=0;for(oe=0;oe<this.g.length;oe++)for(var Ee=0;Ee<be.g.length;Ee++){var $e=this.i(oe)>>>16,ze=this.i(oe)&65535,zt=be.i(Ee)>>>16,St=be.i(Ee)&65535;Te[2*oe+2*Ee]+=ze*St,we(Te,2*oe+2*Ee),Te[2*oe+2*Ee+1]+=$e*St,we(Te,2*oe+2*Ee+1),Te[2*oe+2*Ee+1]+=ze*zt,we(Te,2*oe+2*Ee+1),Te[2*oe+2*Ee+2]+=$e*zt,we(Te,2*oe+2*Ee+2)}for(oe=0;oe<_e;oe++)Te[oe]=Te[2*oe+1]<<16|Te[2*oe];for(oe=_e;oe<2*_e;oe++)Te[oe]=0;return new m(Te,0)};function we(be,_e){for(;(be[_e]&65535)!=be[_e];)be[_e+1]+=be[_e]>>>16,be[_e]&=65535,_e++}function Ie(be,_e){this.g=be,this.h=_e}function Re(be,_e){if(J(_e))throw Error("division by zero");if(J(be))return new Ie(z,z);if(X(be))return _e=Re(te(be),_e),new Ie(te(_e.g),te(_e.h));if(X(_e))return _e=Re(be,te(_e)),new Ie(te(_e.g),_e.h);if(30<be.g.length){if(X(be)||X(_e))throw Error("slowDivide_ only works with positive integers.");for(var Te=F,oe=_e;0>=oe.l(be);)Te=Ne(Te),oe=Ne(oe);var Ee=Xe(Te,1),$e=Xe(oe,1);for(oe=Xe(oe,2),Te=Xe(Te,2);!J(oe);){var ze=$e.add(oe);0>=ze.l(be)&&(Ee=Ee.add(Te),$e=ze),oe=Xe(oe,1),Te=Xe(Te,1)}return _e=ie(be,Ee.j(_e)),new Ie(Ee,_e)}for(Ee=z;0<=be.l(_e);){for(Te=Math.max(1,Math.floor(be.m()/_e.m())),oe=Math.ceil(Math.log(Te)/Math.LN2),oe=48>=oe?1:Math.pow(2,oe-48),$e=D(Te),ze=$e.j(_e);X(ze)||0<ze.l(be);)Te-=oe,$e=D(Te),ze=$e.j(_e);J($e)&&($e=F),Ee=Ee.add($e),be=ie(be,ze)}return new Ie(Ee,be)}t.A=function(be){return Re(this,be).h},t.and=function(be){for(var _e=Math.max(this.g.length,be.g.length),Te=[],oe=0;oe<_e;oe++)Te[oe]=this.i(oe)&be.i(oe);return new m(Te,this.h&be.h)},t.or=function(be){for(var _e=Math.max(this.g.length,be.g.length),Te=[],oe=0;oe<_e;oe++)Te[oe]=this.i(oe)|be.i(oe);return new m(Te,this.h|be.h)},t.xor=function(be){for(var _e=Math.max(this.g.length,be.g.length),Te=[],oe=0;oe<_e;oe++)Te[oe]=this.i(oe)^be.i(oe);return new m(Te,this.h^be.h)};function Ne(be){for(var _e=be.g.length+1,Te=[],oe=0;oe<_e;oe++)Te[oe]=be.i(oe)<<1|be.i(oe-1)>>>31;return new m(Te,be.h)}function Xe(be,_e){var Te=_e>>5;_e%=32;for(var oe=be.g.length-Te,Ee=[],$e=0;$e<oe;$e++)Ee[$e]=0<_e?be.i($e+Te)>>>_e|be.i($e+Te+1)<<32-_e:be.i($e+Te);return new m(Ee,be.h)}r.prototype.digest=r.prototype.v,r.prototype.reset=r.prototype.s,r.prototype.update=r.prototype.u,xj=r,m.prototype.add=m.prototype.add,m.prototype.multiply=m.prototype.j,m.prototype.modulo=m.prototype.A,m.prototype.compare=m.prototype.l,m.prototype.toNumber=m.prototype.m,m.prototype.toString=m.prototype.toString,m.prototype.getBits=m.prototype.i,m.fromNumber=D,m.fromString=P,Hv=m}).apply(typeof v3<"u"?v3:typeof self<"u"?self:typeof window<"u"?window:{});var iR=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};/** @license
Copyright The Closure Library Authors.
SPDX-License-Identifier: Apache-2.0
*/var wj,CS,Tj,GR,Uk,Ej,Sj,Aj;(function(){var t,e=typeof Object.defineProperties=="function"?Object.defineProperty:function(V,le,xe){return V==Array.prototype||V==Object.prototype||(V[le]=xe.value),V};function n(V){V=[typeof globalThis=="object"&&globalThis,V,typeof window=="object"&&window,typeof self=="object"&&self,typeof iR=="object"&&iR];for(var le=0;le<V.length;++le){var xe=V[le];if(xe&&xe.Math==Math)return xe}throw Error("Cannot find global object")}var r=n(this);function c(V,le){if(le)e:{var xe=r;V=V.split(".");for(var Ke=0;Ke<V.length-1;Ke++){var Vt=V[Ke];if(!(Vt in xe))break e;xe=xe[Vt]}V=V[V.length-1],Ke=xe[V],le=le(Ke),le!=Ke&&le!=null&&e(xe,V,{configurable:!0,writable:!0,value:le})}}function d(V,le){V instanceof String&&(V+="");var xe=0,Ke=!1,Vt={next:function(){if(!Ke&&xe<V.length){var $t=xe++;return{value:le($t,V[$t]),done:!1}}return Ke=!0,{done:!0,value:void 0}}};return Vt[Symbol.iterator]=function(){return Vt},Vt}c("Array.prototype.values",function(V){return V||function(){return d(this,function(le,xe){return xe})}});/** @license

 Copyright The Closure Library Authors.
 SPDX-License-Identifier: Apache-2.0
*/var m=m||{},s=this||self;function T(V){var le=typeof V;return le=le!="object"?le:V?Array.isArray(V)?"array":le:"null",le=="array"||le=="object"&&typeof V.length=="number"}function D(V){var le=typeof V;return le=="object"&&V!=null||le=="function"}function P(V,le,xe){return V.call.apply(V.bind,arguments)}function z(V,le,xe){if(!V)throw Error();if(2<arguments.length){var Ke=Array.prototype.slice.call(arguments,2);return function(){var Vt=Array.prototype.slice.call(arguments);return Array.prototype.unshift.apply(Vt,Ke),V.apply(le,Vt)}}return function(){return V.apply(le,arguments)}}function F(V,le,xe){return F=Function.prototype.bind&&Function.prototype.bind.toString().indexOf("native code")!=-1?P:z,F.apply(null,arguments)}function $(V,le){var xe=Array.prototype.slice.call(arguments,1);return function(){var Ke=xe.slice();return Ke.push.apply(Ke,arguments),V.apply(this,Ke)}}function J(V,le){function xe(){}xe.prototype=le.prototype,V.aa=le.prototype,V.prototype=new xe,V.prototype.constructor=V,V.Qb=function(Ke,Vt,$t){for(var Ln=Array(arguments.length-2),Hi=2;Hi<arguments.length;Hi++)Ln[Hi-2]=arguments[Hi];return le.prototype[Vt].apply(Ke,Ln)}}function X(V){const le=V.length;if(0<le){const xe=Array(le);for(let Ke=0;Ke<le;Ke++)xe[Ke]=V[Ke];return xe}return[]}function te(V,le){for(let xe=1;xe<arguments.length;xe++){const Ke=arguments[xe];if(T(Ke)){const Vt=V.length||0,$t=Ke.length||0;V.length=Vt+$t;for(let Ln=0;Ln<$t;Ln++)V[Vt+Ln]=Ke[Ln]}else V.push(Ke)}}class ie{constructor(le,xe){this.i=le,this.j=xe,this.h=0,this.g=null}get(){let le;return 0<this.h?(this.h--,le=this.g,this.g=le.next,le.next=null):le=this.i(),le}}function we(V){return/^[\s\xa0]*$/.test(V)}function Ie(){var V=s.navigator;return V&&(V=V.userAgent)?V:""}function Re(V){return Re[" "](V),V}Re[" "]=function(){};var Ne=Ie().indexOf("Gecko")!=-1&&!(Ie().toLowerCase().indexOf("webkit")!=-1&&Ie().indexOf("Edge")==-1)&&!(Ie().indexOf("Trident")!=-1||Ie().indexOf("MSIE")!=-1)&&Ie().indexOf("Edge")==-1;function Xe(V,le,xe){for(const Ke in V)le.call(xe,V[Ke],Ke,V)}function be(V,le){for(const xe in V)le.call(void 0,V[xe],xe,V)}function _e(V){const le={};for(const xe in V)le[xe]=V[xe];return le}const Te="constructor hasOwnProperty isPrototypeOf propertyIsEnumerable toLocaleString toString valueOf".split(" ");function oe(V,le){let xe,Ke;for(let Vt=1;Vt<arguments.length;Vt++){Ke=arguments[Vt];for(xe in Ke)V[xe]=Ke[xe];for(let $t=0;$t<Te.length;$t++)xe=Te[$t],Object.prototype.hasOwnProperty.call(Ke,xe)&&(V[xe]=Ke[xe])}}function Ee(V){var le=1;V=V.split(":");const xe=[];for(;0<le&&V.length;)xe.push(V.shift()),le--;return V.length&&xe.push(V.join(":")),xe}function $e(V){s.setTimeout(()=>{throw V},0)}function ze(){var V=Xt;let le=null;return V.g&&(le=V.g,V.g=V.g.next,V.g||(V.h=null),le.next=null),le}class zt{constructor(){this.h=this.g=null}add(le,xe){const Ke=St.get();Ke.set(le,xe),this.h?this.h.next=Ke:this.g=Ke,this.h=Ke}}var St=new ie(()=>new mt,V=>V.reset());class mt{constructor(){this.next=this.g=this.h=null}set(le,xe){this.h=le,this.g=xe,this.next=null}reset(){this.next=this.g=this.h=null}}let Ft,rn=!1,Xt=new zt,Fe=()=>{const V=s.Promise.resolve(void 0);Ft=()=>{V.then(Ot)}};var Ot=()=>{for(var V;V=ze();){try{V.h.call(V.g)}catch(xe){$e(xe)}var le=St;le.j(V),100>le.h&&(le.h++,V.next=le.g,le.g=V)}rn=!1};function Ut(){this.s=this.s,this.C=this.C}Ut.prototype.s=!1,Ut.prototype.ma=function(){this.s||(this.s=!0,this.N())},Ut.prototype.N=function(){if(this.C)for(;this.C.length;)this.C.shift()()};function ln(V,le){this.type=V,this.g=this.target=le,this.defaultPrevented=!1}ln.prototype.h=function(){this.defaultPrevented=!0};var wn=function(){if(!s.addEventListener||!Object.defineProperty)return!1;var V=!1,le=Object.defineProperty({},"passive",{get:function(){V=!0}});try{const xe=()=>{};s.addEventListener("test",xe,le),s.removeEventListener("test",xe,le)}catch{}return V}();function dn(V,le){if(ln.call(this,V?V.type:""),this.relatedTarget=this.g=this.target=null,this.button=this.screenY=this.screenX=this.clientY=this.clientX=0,this.key="",this.metaKey=this.shiftKey=this.altKey=this.ctrlKey=!1,this.state=null,this.pointerId=0,this.pointerType="",this.i=null,V){var xe=this.type=V.type,Ke=V.changedTouches&&V.changedTouches.length?V.changedTouches[0]:null;if(this.target=V.target||V.srcElement,this.g=le,le=V.relatedTarget){if(Ne){e:{try{Re(le.nodeName);var Vt=!0;break e}catch{}Vt=!1}Vt||(le=null)}}else xe=="mouseover"?le=V.fromElement:xe=="mouseout"&&(le=V.toElement);this.relatedTarget=le,Ke?(this.clientX=Ke.clientX!==void 0?Ke.clientX:Ke.pageX,this.clientY=Ke.clientY!==void 0?Ke.clientY:Ke.pageY,this.screenX=Ke.screenX||0,this.screenY=Ke.screenY||0):(this.clientX=V.clientX!==void 0?V.clientX:V.pageX,this.clientY=V.clientY!==void 0?V.clientY:V.pageY,this.screenX=V.screenX||0,this.screenY=V.screenY||0),this.button=V.button,this.key=V.key||"",this.ctrlKey=V.ctrlKey,this.altKey=V.altKey,this.shiftKey=V.shiftKey,this.metaKey=V.metaKey,this.pointerId=V.pointerId||0,this.pointerType=typeof V.pointerType=="string"?V.pointerType:Ht[V.pointerType]||"",this.state=V.state,this.i=V,V.defaultPrevented&&dn.aa.h.call(this)}}J(dn,ln);var Ht={2:"touch",3:"pen",4:"mouse"};dn.prototype.h=function(){dn.aa.h.call(this);var V=this.i;V.preventDefault?V.preventDefault():V.returnValue=!1};var Mn="closure_listenable_"+(1e6*Math.random()|0),yn=0;function Tn(V,le,xe,Ke,Vt){this.listener=V,this.proxy=null,this.src=le,this.type=xe,this.capture=!!Ke,this.ha=Vt,this.key=++yn,this.da=this.fa=!1}function Cn(V){V.da=!0,V.listener=null,V.proxy=null,V.src=null,V.ha=null}function Kn(V){this.src=V,this.g={},this.h=0}Kn.prototype.add=function(V,le,xe,Ke,Vt){var $t=V.toString();V=this.g[$t],V||(V=this.g[$t]=[],this.h++);var Ln=ni(V,le,Ke,Vt);return-1<Ln?(le=V[Ln],xe||(le.fa=!1)):(le=new Tn(le,this.src,$t,!!Ke,Vt),le.fa=xe,V.push(le)),le};function Bt(V,le){var xe=le.type;if(xe in V.g){var Ke=V.g[xe],Vt=Array.prototype.indexOf.call(Ke,le,void 0),$t;($t=0<=Vt)&&Array.prototype.splice.call(Ke,Vt,1),$t&&(Cn(le),V.g[xe].length==0&&(delete V.g[xe],V.h--))}}function ni(V,le,xe,Ke){for(var Vt=0;Vt<V.length;++Vt){var $t=V[Vt];if(!$t.da&&$t.listener==le&&$t.capture==!!xe&&$t.ha==Ke)return Vt}return-1}var er="closure_lm_"+(1e6*Math.random()|0),_r={};function Li(V,le,xe,Ke,Vt){if(Array.isArray(le)){for(var $t=0;$t<le.length;$t++)Li(V,le[$t],xe,Ke,Vt);return null}return xe=Uo(xe),V&&V[Mn]?V.K(le,xe,D(Ke)?!!Ke.capture:!1,Vt):jr(V,le,xe,!1,Ke,Vt)}function jr(V,le,xe,Ke,Vt,$t){if(!le)throw Error("Invalid event type");var Ln=D(Vt)?!!Vt.capture:!!Vt,Hi=ks(V);if(Hi||(V[er]=Hi=new Kn(V)),xe=Hi.add(le,xe,Ke,Ln,$t),xe.proxy)return xe;if(Ke=ss(),xe.proxy=Ke,Ke.src=V,Ke.listener=xe,V.addEventListener)wn||(Vt=Ln),Vt===void 0&&(Vt=!1),V.addEventListener(le.toString(),Ke,Vt);else if(V.attachEvent)V.attachEvent(dr(le.toString()),Ke);else if(V.addListener&&V.removeListener)V.addListener(Ke);else throw Error("addEventListener and attachEvent are unavailable.");return xe}function ss(){function V(xe){return le.call(V.src,V.listener,xe)}const le=di;return V}function Nr(V,le,xe,Ke,Vt){if(Array.isArray(le))for(var $t=0;$t<le.length;$t++)Nr(V,le[$t],xe,Ke,Vt);else Ke=D(Ke)?!!Ke.capture:!!Ke,xe=Uo(xe),V&&V[Mn]?(V=V.i,le=String(le).toString(),le in V.g&&($t=V.g[le],xe=ni($t,xe,Ke,Vt),-1<xe&&(Cn($t[xe]),Array.prototype.splice.call($t,xe,1),$t.length==0&&(delete V.g[le],V.h--)))):V&&(V=ks(V))&&(le=V.g[le.toString()],V=-1,le&&(V=ni(le,xe,Ke,Vt)),(xe=-1<V?le[V]:null)&&ti(xe))}function ti(V){if(typeof V!="number"&&V&&!V.da){var le=V.src;if(le&&le[Mn])Bt(le.i,V);else{var xe=V.type,Ke=V.proxy;le.removeEventListener?le.removeEventListener(xe,Ke,V.capture):le.detachEvent?le.detachEvent(dr(xe),Ke):le.addListener&&le.removeListener&&le.removeListener(Ke),(xe=ks(le))?(Bt(xe,V),xe.h==0&&(xe.src=null,le[er]=null)):Cn(V)}}}function dr(V){return V in _r?_r[V]:_r[V]="on"+V}function di(V,le){if(V.da)V=!0;else{le=new dn(le,this);var xe=V.listener,Ke=V.ha||V.src;V.fa&&ti(V),V=xe.call(Ke,le)}return V}function ks(V){return V=V[er],V instanceof Kn?V:null}var fs="__closure_events_fn_"+(1e9*Math.random()>>>0);function Uo(V){return typeof V=="function"?V:(V[fs]||(V[fs]=function(le){return V.handleEvent(le)}),V[fs])}function Kr(){Ut.call(this),this.i=new Kn(this),this.M=this,this.F=null}J(Kr,Ut),Kr.prototype[Mn]=!0,Kr.prototype.removeEventListener=function(V,le,xe,Ke){Nr(this,V,le,xe,Ke)};function ir(V,le){var xe,Ke=V.F;if(Ke)for(xe=[];Ke;Ke=Ke.F)xe.push(Ke);if(V=V.M,Ke=le.type||le,typeof le=="string")le=new ln(le,V);else if(le instanceof ln)le.target=le.target||V;else{var Vt=le;le=new ln(Ke,V),oe(le,Vt)}if(Vt=!0,xe)for(var $t=xe.length-1;0<=$t;$t--){var Ln=le.g=xe[$t];Vt=Po(Ln,Ke,!0,le)&&Vt}if(Ln=le.g=V,Vt=Po(Ln,Ke,!0,le)&&Vt,Vt=Po(Ln,Ke,!1,le)&&Vt,xe)for($t=0;$t<xe.length;$t++)Ln=le.g=xe[$t],Vt=Po(Ln,Ke,!1,le)&&Vt}Kr.prototype.N=function(){if(Kr.aa.N.call(this),this.i){var V=this.i,le;for(le in V.g){for(var xe=V.g[le],Ke=0;Ke<xe.length;Ke++)Cn(xe[Ke]);delete V.g[le],V.h--}}this.F=null},Kr.prototype.K=function(V,le,xe,Ke){return this.i.add(String(V),le,!1,xe,Ke)},Kr.prototype.L=function(V,le,xe,Ke){return this.i.add(String(V),le,!0,xe,Ke)};function Po(V,le,xe,Ke){if(le=V.i.g[String(le)],!le)return!0;le=le.concat();for(var Vt=!0,$t=0;$t<le.length;++$t){var Ln=le[$t];if(Ln&&!Ln.da&&Ln.capture==xe){var Hi=Ln.listener,Ss=Ln.ha||Ln.src;Ln.fa&&Bt(V.i,Ln),Vt=Hi.call(Ss,Ke)!==!1&&Vt}}return Vt&&!Ke.defaultPrevented}function ro(V,le,xe){if(typeof V=="function")xe&&(V=F(V,xe));else if(V&&typeof V.handleEvent=="function")V=F(V.handleEvent,V);else throw Error("Invalid listener argument");return 2147483647<Number(le)?-1:s.setTimeout(V,le||0)}function jo(V){V.g=ro(()=>{V.g=null,V.i&&(V.i=!1,jo(V))},V.l);const le=V.h;V.h=null,V.m.apply(null,le)}class Or extends Ut{constructor(le,xe){super(),this.m=le,this.l=xe,this.h=null,this.i=!1,this.g=null}j(le){this.h=arguments,this.g?this.i=!0:jo(this)}N(){super.N(),this.g&&(s.clearTimeout(this.g),this.g=null,this.i=!1,this.h=null)}}function ps(V){Ut.call(this),this.h=V,this.g={}}J(ps,Ut);var Ns=[];function Hr(V){Xe(V.g,function(le,xe){this.g.hasOwnProperty(xe)&&ti(le)},V),V.g={}}ps.prototype.N=function(){ps.aa.N.call(this),Hr(this)},ps.prototype.handleEvent=function(){throw Error("EventHandler.handleEvent not implemented")};var Xs=s.JSON.stringify,ho=s.JSON.parse,Ge=class{stringify(V){return s.JSON.stringify(V,void 0)}parse(V){return s.JSON.parse(V,void 0)}};function xt(){}xt.prototype.h=null;function Pn(V){return V.h||(V.h=V.i())}function jn(){}var Wn={OPEN:"a",kb:"b",Ja:"c",wb:"d"};function zi(){ln.call(this,"d")}J(zi,ln);function Ri(){ln.call(this,"c")}J(Ri,ln);var Ii={},Lt=null;function $r(){return Lt=Lt||new Kr}Ii.La="serverreachability";function _i(V){ln.call(this,Ii.La,V)}J(_i,ln);function Ls(V){const le=$r();ir(le,new _i(le))}Ii.STAT_EVENT="statevent";function bi(V,le){ln.call(this,Ii.STAT_EVENT,V),this.stat=le}J(bi,ln);function gt(V){const le=$r();ir(le,new bi(le,V))}Ii.Ma="timingevent";function fe(V,le){ln.call(this,Ii.Ma,V),this.size=le}J(fe,ln);function ve(V,le){if(typeof V!="function")throw Error("Fn must not be null and must be a function");return s.setTimeout(function(){V()},le)}function Be(){this.g=!0}Be.prototype.xa=function(){this.g=!1};function tt(V,le,xe,Ke,Vt,$t){V.info(function(){if(V.g)if($t)for(var Ln="",Hi=$t.split("&"),Ss=0;Ss<Hi.length;Ss++){var kn=Hi[Ss].split("=");if(1<kn.length){var an=kn[0];kn=kn[1];var Jr=an.split("_");Ln=2<=Jr.length&&Jr[1]=="type"?Ln+(an+"="+kn+"&"):Ln+(an+"=redacted&")}}else Ln=null;else Ln=$t;return"XMLHTTP REQ ("+Ke+") [attempt "+Vt+"]: "+le+`
`+xe+`
`+Ln})}function He(V,le,xe,Ke,Vt,$t,Ln){V.info(function(){return"XMLHTTP RESP ("+Ke+") [ attempt "+Vt+"]: "+le+`
`+xe+`
`+$t+" "+Ln})}function at(V,le,xe,Ke){V.info(function(){return"XMLHTTP TEXT ("+le+"): "+Ze(V,xe)+(Ke?" "+Ke:"")})}function bt(V,le){V.info(function(){return"TIMEOUT: "+le})}Be.prototype.info=function(){};function Ze(V,le){if(!V.g)return le;if(!le)return null;try{var xe=JSON.parse(le);if(xe){for(V=0;V<xe.length;V++)if(Array.isArray(xe[V])){var Ke=xe[V];if(!(2>Ke.length)){var Vt=Ke[1];if(Array.isArray(Vt)&&!(1>Vt.length)){var $t=Vt[0];if($t!="noop"&&$t!="stop"&&$t!="close")for(var Ln=1;Ln<Vt.length;Ln++)Vt[Ln]=""}}}}return Xs(xe)}catch{return le}}var vt={NO_ERROR:0,gb:1,tb:2,sb:3,nb:4,rb:5,ub:6,Ia:7,TIMEOUT:8,xb:9},It={lb:"complete",Hb:"success",Ja:"error",Ia:"abort",zb:"ready",Ab:"readystatechange",TIMEOUT:"timeout",vb:"incrementaldata",yb:"progress",ob:"downloadprogress",Pb:"uploadprogress"},Et;function Kt(){}J(Kt,xt),Kt.prototype.g=function(){return new XMLHttpRequest},Kt.prototype.i=function(){return{}},Et=new Kt;function _n(V,le,xe,Ke){this.j=V,this.i=le,this.l=xe,this.R=Ke||1,this.U=new ps(this),this.I=45e3,this.H=null,this.o=!1,this.m=this.A=this.v=this.L=this.F=this.S=this.B=null,this.D=[],this.g=null,this.C=0,this.s=this.u=null,this.X=-1,this.J=!1,this.O=0,this.M=null,this.W=this.K=this.T=this.P=!1,this.h=new Sn}function Sn(){this.i=null,this.g="",this.h=!1}var Gn={},Vn={};function Jn(V,le,xe){V.L=1,V.v=na(Ha(le)),V.m=xe,V.P=!0,oi(V,null)}function oi(V,le){V.F=Date.now(),tr(V),V.A=Ha(V.v);var xe=V.A,Ke=V.R;Array.isArray(Ke)||(Ke=[String(Ke)]),Qm(xe.i,"t",Ke),V.C=0,xe=V.j.J,V.h=new Sn,V.g=Jh(V.j,xe?le:null,!V.m),0<V.O&&(V.M=new Or(F(V.Y,V,V.g),V.O)),le=V.U,xe=V.g,Ke=V.ca;var Vt="readystatechange";Array.isArray(Vt)||(Vt&&(Ns[0]=Vt.toString()),Vt=Ns);for(var $t=0;$t<Vt.length;$t++){var Ln=Li(xe,Vt[$t],Ke||le.handleEvent,!1,le.h||le);if(!Ln)break;le.g[Ln.key]=Ln}le=V.H?_e(V.H):{},V.m?(V.u||(V.u="POST"),le["Content-Type"]="application/x-www-form-urlencoded",V.g.ea(V.A,V.u,V.m,le)):(V.u="GET",V.g.ea(V.A,V.u,null,le)),Ls(),tt(V.i,V.u,V.A,V.l,V.R,V.m)}_n.prototype.ca=function(V){V=V.target;const le=this.M;le&&Wa(V)==3?le.j():this.Y(V)},_n.prototype.Y=function(V){try{if(V==this.g)e:{const Jr=Wa(this.g);var le=this.g.Ba();const Hn=this.g.Z();if(!(3>Jr)&&(Jr!=3||this.g&&(this.h.h||this.g.oa()||Yc(this.g)))){this.J||Jr!=4||le==7||(le==8||0>=Hn?Ls(3):Ls(2)),Ai(this);var xe=this.g.Z();this.X=xe;t:if(ii(this)){var Ke=Yc(this.g);V="";var Vt=Ke.length,$t=Wa(this.g)==4;if(!this.h.i){if(typeof TextDecoder>"u"){fr(this),Ei(this);var Ln="";break t}this.h.i=new s.TextDecoder}for(le=0;le<Vt;le++)this.h.h=!0,V+=this.h.i.decode(Ke[le],{stream:!($t&&le==Vt-1)});Ke.length=0,this.h.g+=V,this.C=0,Ln=this.h.g}else Ln=this.g.oa();if(this.o=xe==200,He(this.i,this.u,this.A,this.l,this.R,Jr,xe),this.o){if(this.T&&!this.K){t:{if(this.g){var Hi,Ss=this.g;if((Hi=Ss.g?Ss.g.getResponseHeader("X-HTTP-Initial-Response"):null)&&!we(Hi)){var kn=Hi;break t}}kn=null}if(xe=kn)at(this.i,this.l,xe,"Initial handshake response via X-HTTP-Initial-Response"),this.K=!0,xr(this,xe);else{this.o=!1,this.s=3,gt(12),fr(this),Ei(this);break e}}if(this.P){xe=!0;let Ki;for(;!this.J&&this.C<Ln.length;)if(Ki=Xi(this,Ln),Ki==Vn){Jr==4&&(this.s=4,gt(14),xe=!1),at(this.i,this.l,null,"[Incomplete Response]");break}else if(Ki==Gn){this.s=4,gt(15),at(this.i,this.l,Ln,"[Invalid Chunk]"),xe=!1;break}else at(this.i,this.l,Ki,null),xr(this,Ki);if(ii(this)&&this.C!=0&&(this.h.g=this.h.g.slice(this.C),this.C=0),Jr!=4||Ln.length!=0||this.h.h||(this.s=1,gt(16),xe=!1),this.o=this.o&&xe,!xe)at(this.i,this.l,Ln,"[Invalid Chunked Response]"),fr(this),Ei(this);else if(0<Ln.length&&!this.W){this.W=!0;var an=this.j;an.g==this&&an.ba&&!an.M&&(an.j.info("Great, no buffering proxy detected. Bytes received: "+Ln.length),Il(an),an.M=!0,gt(11))}}else at(this.i,this.l,Ln,null),xr(this,Ln);Jr==4&&fr(this),this.o&&!this.J&&(Jr==4?gi(this.j,this):(this.o=!1,tr(this)))}else ra(this.g),xe==400&&0<Ln.indexOf("Unknown SID")?(this.s=3,gt(12)):(this.s=0,gt(13)),fr(this),Ei(this)}}}catch{}finally{}};function ii(V){return V.g?V.u=="GET"&&V.L!=2&&V.j.Ca:!1}function Xi(V,le){var xe=V.C,Ke=le.indexOf(`
`,xe);return Ke==-1?Vn:(xe=Number(le.substring(xe,Ke)),isNaN(xe)?Gn:(Ke+=1,Ke+xe>le.length?Vn:(le=le.slice(Ke,Ke+xe),V.C=Ke+xe,le)))}_n.prototype.cancel=function(){this.J=!0,fr(this)};function tr(V){V.S=Date.now()+V.I,cr(V,V.I)}function cr(V,le){if(V.B!=null)throw Error("WatchDog timer not null");V.B=ve(F(V.ba,V),le)}function Ai(V){V.B&&(s.clearTimeout(V.B),V.B=null)}_n.prototype.ba=function(){this.B=null;const V=Date.now();0<=V-this.S?(bt(this.i,this.A),this.L!=2&&(Ls(),gt(17)),fr(this),this.s=2,Ei(this)):cr(this,this.S-V)};function Ei(V){V.j.G==0||V.J||gi(V.j,V)}function fr(V){Ai(V);var le=V.M;le&&typeof le.ma=="function"&&le.ma(),V.M=null,Hr(V.U),V.g&&(le=V.g,V.g=null,le.abort(),le.ma())}function xr(V,le){try{var xe=V.j;if(xe.G!=0&&(xe.g==V||Ua(xe.h,V))){if(!V.K&&Ua(xe.h,V)&&xe.G==3){try{var Ke=xe.Da.g.parse(le)}catch{Ke=null}if(Array.isArray(Ke)&&Ke.length==3){var Vt=Ke;if(Vt[0]==0){e:if(!xe.u){if(xe.g)if(xe.g.F+3e3<V.F)xn(xe),Mi(xe);else break e;$o(xe),gt(18)}}else xe.za=Vt[1],0<xe.za-xe.T&&37500>Vt[2]&&xe.F&&xe.v==0&&!xe.C&&(xe.C=ve(F(xe.Za,xe),6e3));if(1>=zs(xe.h)&&xe.ca){try{xe.ca()}catch{}xe.ca=void 0}}else Fs(xe,11)}else if((V.K||xe.g==V)&&xn(xe),!we(le))for(Vt=xe.Da.g.parse(le),le=0;le<Vt.length;le++){let kn=Vt[le];if(xe.T=kn[0],kn=kn[1],xe.G==2)if(kn[0]=="c"){xe.K=kn[1],xe.ia=kn[2];const an=kn[3];an!=null&&(xe.la=an,xe.j.info("VER="+xe.la));const Jr=kn[4];Jr!=null&&(xe.Aa=Jr,xe.j.info("SVER="+xe.Aa));const Hn=kn[5];Hn!=null&&typeof Hn=="number"&&0<Hn&&(Ke=1.5*Hn,xe.L=Ke,xe.j.info("backChannelRequestTimeoutMs_="+Ke)),Ke=xe;const Ki=V.g;if(Ki){const xa=Ki.g?Ki.g.getResponseHeader("X-Client-Wire-Protocol"):null;if(xa){var $t=Ke.h;$t.g||xa.indexOf("spdy")==-1&&xa.indexOf("quic")==-1&&xa.indexOf("h2")==-1||($t.j=$t.l,$t.g=new Set,$t.h&&(Ws($t,$t.h),$t.h=null))}if(Ke.D){const Un=Ki.g?Ki.g.getResponseHeader("X-HTTP-Session-Id"):null;Un&&(Ke.ya=Un,Mr(Ke.I,Ke.D,Un))}}xe.G=3,xe.l&&xe.l.ua(),xe.ba&&(xe.R=Date.now()-V.F,xe.j.info("Handshake RTT: "+xe.R+"ms")),Ke=xe;var Ln=V;if(Ke.qa=fi(Ke,Ke.J?Ke.ia:null,Ke.W),Ln.K){ja(Ke.h,Ln);var Hi=Ln,Ss=Ke.L;Ss&&(Hi.I=Ss),Hi.B&&(Ai(Hi),tr(Hi)),Ke.g=Ln}else ic(Ke);0<xe.i.length&&Tu(xe)}else kn[0]!="stop"&&kn[0]!="close"||Fs(xe,7);else xe.G==3&&(kn[0]=="stop"||kn[0]=="close"?kn[0]=="stop"?Fs(xe,7):Zc(xe):kn[0]!="noop"&&xe.l&&xe.l.ta(kn),xe.v=0)}}Ls(4)}catch{}}var Ir=class{constructor(V,le){this.g=V,this.map=le}};function qs(V){this.l=V||10,s.PerformanceNavigationTiming?(V=s.performance.getEntriesByType("navigation"),V=0<V.length&&(V[0].nextHopProtocol=="hq"||V[0].nextHopProtocol=="h2")):V=!!(s.chrome&&s.chrome.loadTimes&&s.chrome.loadTimes()&&s.chrome.loadTimes().wasFetchedViaSpdy),this.j=V?this.l:1,this.g=null,1<this.j&&(this.g=new Set),this.h=null,this.i=[]}function os(V){return V.h?!0:V.g?V.g.size>=V.j:!1}function zs(V){return V.h?1:V.g?V.g.size:0}function Ua(V,le){return V.h?V.h==le:V.g?V.g.has(le):!1}function Ws(V,le){V.g?V.g.add(le):V.h=le}function ja(V,le){V.h&&V.h==le?V.h=null:V.g&&V.g.has(le)&&V.g.delete(le)}qs.prototype.cancel=function(){if(this.i=wu(this),this.h)this.h.cancel(),this.h=null;else if(this.g&&this.g.size!==0){for(const V of this.g.values())V.cancel();this.g.clear()}};function wu(V){if(V.h!=null)return V.i.concat(V.h.D);if(V.g!=null&&V.g.size!==0){let le=V.i;for(const xe of V.g.values())le=le.concat(xe.D);return le}return X(V.i)}function Zu(V){if(V.V&&typeof V.V=="function")return V.V();if(typeof Map<"u"&&V instanceof Map||typeof Set<"u"&&V instanceof Set)return Array.from(V.values());if(typeof V=="string")return V.split("");if(T(V)){for(var le=[],xe=V.length,Ke=0;Ke<xe;Ke++)le.push(V[Ke]);return le}le=[],xe=0;for(Ke in V)le[xe++]=V[Ke];return le}function Hc(V){if(V.na&&typeof V.na=="function")return V.na();if(!V.V||typeof V.V!="function"){if(typeof Map<"u"&&V instanceof Map)return Array.from(V.keys());if(!(typeof Set<"u"&&V instanceof Set)){if(T(V)||typeof V=="string"){var le=[];V=V.length;for(var xe=0;xe<V;xe++)le.push(xe);return le}le=[],xe=0;for(const Ke in V)le[xe++]=Ke;return le}}}function Jl(V,le){if(V.forEach&&typeof V.forEach=="function")V.forEach(le,void 0);else if(T(V)||typeof V=="string")Array.prototype.forEach.call(V,le,void 0);else for(var xe=Hc(V),Ke=Zu(V),Vt=Ke.length,$t=0;$t<Vt;$t++)le.call(void 0,Ke[$t],xe&&xe[$t],V)}var Xu=RegExp("^(?:([^:/?#.]+):)?(?://(?:([^\\\\/?#]*)@)?([^\\\\/?#]*?)(?::([0-9]+))?(?=[\\\\/?#]|$))?([^?#]+)?(?:\\?([^#]*))?(?:#([\\s\\S]*))?$");function Qu(V,le){if(V){V=V.split("&");for(var xe=0;xe<V.length;xe++){var Ke=V[xe].indexOf("="),Vt=null;if(0<=Ke){var $t=V[xe].substring(0,Ke);Vt=V[xe].substring(Ke+1)}else $t=V[xe];le($t,Vt?decodeURIComponent(Vt.replace(/\+/g," ")):"")}}}function Dl(V){if(this.g=this.o=this.j="",this.s=null,this.m=this.l="",this.h=!1,V instanceof Dl){this.h=V.h,Ho(this,V.j),this.o=V.o,this.g=V.g,To(this,V.s),this.l=V.l;var le=V.i,xe=new Bs;xe.i=le.i,le.g&&(xe.g=new Map(le.g),xe.h=le.h),ya(this,xe),this.m=V.m}else V&&(le=String(V).match(Xu))?(this.h=!1,Ho(this,le[1]||"",!0),this.o=$a(le[2]||""),this.g=$a(le[3]||"",!0),To(this,le[4]),this.l=$a(le[5]||"",!0),ya(this,le[6]||"",!0),this.m=$a(le[7]||"")):(this.h=!1,this.i=new Bs(null,this.h))}Dl.prototype.toString=function(){var V=[],le=this.j;le&&V.push(ec(le,$c,!0),":");var xe=this.g;return(xe||le=="file")&&(V.push("//"),(le=this.o)&&V.push(ec(le,$c,!0),"@"),V.push(encodeURIComponent(String(xe)).replace(/%25([0-9a-fA-F]{2})/g,"%$1")),xe=this.s,xe!=null&&V.push(":",String(xe))),(xe=this.l)&&(this.g&&xe.charAt(0)!="/"&&V.push("/"),V.push(ec(xe,xe.charAt(0)=="/"?Xh:Rl,!0))),(xe=this.i.toString())&&V.push("?",xe),(xe=this.m)&&V.push("#",ec(xe,xp)),V.join("")};function Ha(V){return new Dl(V)}function Ho(V,le,xe){V.j=xe?$a(le,!0):le,V.j&&(V.j=V.j.replace(/:$/,""))}function To(V,le){if(le){if(le=Number(le),isNaN(le)||0>le)throw Error("Bad port number "+le);V.s=le}else V.s=null}function ya(V,le,xe){le instanceof Bs?(V.i=le,Gc(V.i,V.h)):(xe||(le=ec(le,bp)),V.i=new Bs(le,V.h))}function Mr(V,le,xe){V.i.set(le,xe)}function na(V){return Mr(V,"zx",Math.floor(2147483648*Math.random()).toString(36)+Math.abs(Math.floor(2147483648*Math.random())^Date.now()).toString(36)),V}function $a(V,le){return V?le?decodeURI(V.replace(/%25/g,"%2525")):decodeURIComponent(V):""}function ec(V,le,xe){return typeof V=="string"?(V=encodeURI(V).replace(le,ll),xe&&(V=V.replace(/%25([0-9a-fA-F]{2})/g,"%$1")),V):null}function ll(V){return V=V.charCodeAt(0),"%"+(V>>4&15).toString(16)+(V&15).toString(16)}var $c=/[#\/\?@]/g,Rl=/[#\?:]/g,Xh=/[#\?]/g,bp=/[#\?@]/g,xp=/#/g;function Bs(V,le){this.h=this.g=null,this.i=V||null,this.j=!!le}function ia(V){V.g||(V.g=new Map,V.h=0,V.i&&Qu(V.i,function(le,xe){V.add(decodeURIComponent(le.replace(/\+/g," ")),xe)}))}t=Bs.prototype,t.add=function(V,le){ia(this),this.i=null,V=Ju(this,V);var xe=this.g.get(V);return xe||this.g.set(V,xe=[]),xe.push(le),this.h+=1,this};function Qh(V,le){ia(V),le=Ju(V,le),V.g.has(le)&&(V.i=null,V.h-=V.g.get(le).length,V.g.delete(le))}function Ku(V,le){return ia(V),le=Ju(V,le),V.g.has(le)}t.forEach=function(V,le){ia(this),this.g.forEach(function(xe,Ke){xe.forEach(function(Vt){V.call(le,Vt,Ke,this)},this)},this)},t.na=function(){ia(this);const V=Array.from(this.g.values()),le=Array.from(this.g.keys()),xe=[];for(let Ke=0;Ke<le.length;Ke++){const Vt=V[Ke];for(let $t=0;$t<Vt.length;$t++)xe.push(le[Ke])}return xe},t.V=function(V){ia(this);let le=[];if(typeof V=="string")Ku(this,V)&&(le=le.concat(this.g.get(Ju(this,V))));else{V=Array.from(this.g.values());for(let xe=0;xe<V.length;xe++)le=le.concat(V[xe])}return le},t.set=function(V,le){return ia(this),this.i=null,V=Ju(this,V),Ku(this,V)&&(this.h-=this.g.get(V).length),this.g.set(V,[le]),this.h+=1,this},t.get=function(V,le){return V?(V=this.V(V),0<V.length?String(V[0]):le):le};function Qm(V,le,xe){Qh(V,le),0<xe.length&&(V.i=null,V.g.set(Ju(V,le),X(xe)),V.h+=xe.length)}t.toString=function(){if(this.i)return this.i;if(!this.g)return"";const V=[],le=Array.from(this.g.keys());for(var xe=0;xe<le.length;xe++){var Ke=le[xe];const $t=encodeURIComponent(String(Ke)),Ln=this.V(Ke);for(Ke=0;Ke<Ln.length;Ke++){var Vt=$t;Ln[Ke]!==""&&(Vt+="="+encodeURIComponent(String(Ln[Ke]))),V.push(Vt)}}return this.i=V.join("&")};function Ju(V,le){return le=String(le),V.j&&(le=le.toLowerCase()),le}function Gc(V,le){le&&!V.j&&(ia(V),V.i=null,V.g.forEach(function(xe,Ke){var Vt=Ke.toLowerCase();Ke!=Vt&&(Qh(this,Ke),Qm(this,Vt,xe))},V)),V.j=le}function Si(V,le){const xe=new Be;if(s.Image){const Ke=new Image;Ke.onload=$(va,xe,"TestLoadImage: loaded",!0,le,Ke),Ke.onerror=$(va,xe,"TestLoadImage: error",!1,le,Ke),Ke.onabort=$(va,xe,"TestLoadImage: abort",!1,le,Ke),Ke.ontimeout=$(va,xe,"TestLoadImage: timeout",!1,le,Ke),s.setTimeout(function(){Ke.ontimeout&&Ke.ontimeout()},1e4),Ke.src=V}else le(!1)}function uf(V,le){const xe=new Be,Ke=new AbortController,Vt=setTimeout(()=>{Ke.abort(),va(xe,"TestPingServer: timeout",!1,le)},1e4);fetch(V,{signal:Ke.signal}).then($t=>{clearTimeout(Vt),$t.ok?va(xe,"TestPingServer: ok",!0,le):va(xe,"TestPingServer: server error",!1,le)}).catch(()=>{clearTimeout(Vt),va(xe,"TestPingServer: error",!1,le)})}function va(V,le,xe,Ke,Vt){try{Vt&&(Vt.onload=null,Vt.onerror=null,Vt.onabort=null,Vt.ontimeout=null),Ke(xe)}catch{}}function qc(){this.g=new Ge}function B_(V,le,xe){const Ke=xe||"";try{Jl(V,function(Vt,$t){let Ln=Vt;D(Vt)&&(Ln=Xs(Vt)),le.push(Ke+$t+"="+encodeURIComponent(Ln))})}catch(Vt){throw le.push(Ke+"type="+encodeURIComponent("_badmap")),Vt}}function Ol(V){this.l=V.Ub||null,this.j=V.eb||!1}J(Ol,xt),Ol.prototype.g=function(){return new Ga(this.l,this.j)},Ol.prototype.i=function(V){return function(){return V}}({});function Ga(V,le){Kr.call(this),this.D=V,this.o=le,this.m=void 0,this.status=this.readyState=0,this.responseType=this.responseText=this.response=this.statusText="",this.onreadystatechange=null,this.u=new Headers,this.h=null,this.B="GET",this.A="",this.g=!1,this.v=this.j=this.l=null}J(Ga,Kr),t=Ga.prototype,t.open=function(V,le){if(this.readyState!=0)throw this.abort(),Error("Error reopening a connection");this.B=V,this.A=le,this.readyState=1,eh(this)},t.send=function(V){if(this.readyState!=1)throw this.abort(),Error("need to call open() first. ");this.g=!0;const le={headers:this.u,method:this.B,credentials:this.m,cache:void 0};V&&(le.body=V),(this.D||s).fetch(new Request(this.A,le)).then(this.Sa.bind(this),this.ga.bind(this))},t.abort=function(){this.response=this.responseText="",this.u=new Headers,this.status=0,this.j&&this.j.cancel("Request was aborted.").catch(()=>{}),1<=this.readyState&&this.g&&this.readyState!=4&&(this.g=!1,so(this)),this.readyState=0},t.Sa=function(V){if(this.g&&(this.l=V,this.h||(this.status=this.l.status,this.statusText=this.l.statusText,this.h=V.headers,this.readyState=2,eh(this)),this.g&&(this.readyState=3,eh(this),this.g)))if(this.responseType==="arraybuffer")V.arrayBuffer().then(this.Qa.bind(this),this.ga.bind(this));else if(typeof s.ReadableStream<"u"&&"body"in V){if(this.j=V.body.getReader(),this.o){if(this.responseType)throw Error('responseType must be empty for "streamBinaryChunks" mode responses.');this.response=[]}else this.response=this.responseText="",this.v=new TextDecoder;tc(this)}else V.text().then(this.Ra.bind(this),this.ga.bind(this))};function tc(V){V.j.read().then(V.Pa.bind(V)).catch(V.ga.bind(V))}t.Pa=function(V){if(this.g){if(this.o&&V.value)this.response.push(V.value);else if(!this.o){var le=V.value?V.value:new Uint8Array(0);(le=this.v.decode(le,{stream:!V.done}))&&(this.response=this.responseText+=le)}V.done?so(this):eh(this),this.readyState==3&&tc(this)}},t.Ra=function(V){this.g&&(this.response=this.responseText=V,so(this))},t.Qa=function(V){this.g&&(this.response=V,so(this))},t.ga=function(){this.g&&so(this)};function so(V){V.readyState=4,V.l=null,V.j=null,V.v=null,eh(V)}t.setRequestHeader=function(V,le){this.u.append(V,le)},t.getResponseHeader=function(V){return this.h&&this.h.get(V.toLowerCase())||""},t.getAllResponseHeaders=function(){if(!this.h)return"";const V=[],le=this.h.entries();for(var xe=le.next();!xe.done;)xe=xe.value,V.push(xe[0]+": "+xe[1]),xe=le.next();return V.join(`\r
`)};function eh(V){V.onreadystatechange&&V.onreadystatechange.call(V)}Object.defineProperty(Ga.prototype,"withCredentials",{get:function(){return this.m==="include"},set:function(V){this.m=V?"include":"same-origin"}});function nc(V){let le="";return Xe(V,function(xe,Ke){le+=Ke,le+=":",le+=xe,le+=`\r
`}),le}function hf(V,le,xe){e:{for(Ke in xe){var Ke=!1;break e}Ke=!0}Ke||(xe=nc(xe),typeof V=="string"?xe!=null&&encodeURIComponent(String(xe)):Mr(V,le,xe))}function Gr(V){Kr.call(this),this.headers=new Map,this.o=V||null,this.h=!1,this.v=this.g=null,this.D="",this.m=0,this.l="",this.j=this.B=this.u=this.A=!1,this.I=null,this.H="",this.J=!1}J(Gr,Kr);var wp=/^https?$/i,Tp=["POST","PUT"];t=Gr.prototype,t.Ha=function(V){this.J=V},t.ea=function(V,le,xe,Ke){if(this.g)throw Error("[goog.net.XhrIo] Object is active with another request="+this.D+"; newUri="+V);le=le?le.toUpperCase():"GET",this.D=V,this.l="",this.m=0,this.A=!1,this.h=!0,this.g=this.o?this.o.g():Et.g(),this.v=this.o?Pn(this.o):Pn(Et),this.g.onreadystatechange=F(this.Ea,this);try{this.B=!0,this.g.open(le,String(V),!0),this.B=!1}catch($t){qa(this,$t);return}if(V=xe||"",xe=new Map(this.headers),Ke)if(Object.getPrototypeOf(Ke)===Object.prototype)for(var Vt in Ke)xe.set(Vt,Ke[Vt]);else if(typeof Ke.keys=="function"&&typeof Ke.get=="function")for(const $t of Ke.keys())xe.set($t,Ke.get($t));else throw Error("Unknown input type for opt_headers: "+String(Ke));Ke=Array.from(xe.keys()).find($t=>$t.toLowerCase()=="content-type"),Vt=s.FormData&&V instanceof s.FormData,!(0<=Array.prototype.indexOf.call(Tp,le,void 0))||Ke||Vt||xe.set("Content-Type","application/x-www-form-urlencoded;charset=utf-8");for(const[$t,Ln]of xe)this.g.setRequestHeader($t,Ln);this.H&&(this.g.responseType=this.H),"withCredentials"in this.g&&this.g.withCredentials!==this.J&&(this.g.withCredentials=this.J);try{nh(this),this.u=!0,this.g.send(V),this.u=!1}catch($t){qa(this,$t)}};function qa(V,le){V.h=!1,V.g&&(V.j=!0,V.g.abort(),V.j=!1),V.l=le,V.m=5,Kh(V),th(V)}function Kh(V){V.A||(V.A=!0,ir(V,"complete"),ir(V,"error"))}t.abort=function(V){this.g&&this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1,this.m=V||7,ir(this,"complete"),ir(this,"abort"),th(this))},t.N=function(){this.g&&(this.h&&(this.h=!1,this.j=!0,this.g.abort(),this.j=!1),th(this,!0)),Gr.aa.N.call(this)},t.Ea=function(){this.s||(this.B||this.u||this.j?Wc(this):this.bb())},t.bb=function(){Wc(this)};function Wc(V){if(V.h&&typeof m<"u"&&(!V.v[1]||Wa(V)!=4||V.Z()!=2)){if(V.u&&Wa(V)==4)ro(V.Ea,0,V);else if(ir(V,"readystatechange"),Wa(V)==4){V.h=!1;try{const Ln=V.Z();e:switch(Ln){case 200:case 201:case 202:case 204:case 206:case 304:case 1223:var le=!0;break e;default:le=!1}var xe;if(!(xe=le)){var Ke;if(Ke=Ln===0){var Vt=String(V.D).match(Xu)[1]||null;!Vt&&s.self&&s.self.location&&(Vt=s.self.location.protocol.slice(0,-1)),Ke=!wp.test(Vt?Vt.toLowerCase():"")}xe=Ke}if(xe)ir(V,"complete"),ir(V,"success");else{V.m=6;try{var $t=2<Wa(V)?V.g.statusText:""}catch{$t=""}V.l=$t+" ["+V.Z()+"]",Kh(V)}}finally{th(V)}}}}function th(V,le){if(V.g){nh(V);const xe=V.g,Ke=V.v[0]?()=>{}:null;V.g=null,V.v=null,le||ir(V,"ready");try{xe.onreadystatechange=Ke}catch{}}}function nh(V){V.I&&(s.clearTimeout(V.I),V.I=null)}t.isActive=function(){return!!this.g};function Wa(V){return V.g?V.g.readyState:0}t.Z=function(){try{return 2<Wa(this)?this.g.status:-1}catch{return-1}},t.oa=function(){try{return this.g?this.g.responseText:""}catch{return""}},t.Oa=function(V){if(this.g){var le=this.g.responseText;return V&&le.indexOf(V)==0&&(le=le.substring(V.length)),ho(le)}};function Yc(V){try{if(!V.g)return null;if("response"in V.g)return V.g.response;switch(V.H){case"":case"text":return V.g.responseText;case"arraybuffer":if("mozResponseArrayBuffer"in V.g)return V.g.mozResponseArrayBuffer}return null}catch{return null}}function ra(V){const le={};V=(V.g&&2<=Wa(V)&&V.g.getAllResponseHeaders()||"").split(`\r
`);for(let Ke=0;Ke<V.length;Ke++){if(we(V[Ke]))continue;var xe=Ee(V[Ke]);const Vt=xe[0];if(xe=xe[1],typeof xe!="string")continue;xe=xe.trim();const $t=le[Vt]||[];le[Vt]=$t,$t.push(xe)}be(le,function(Ke){return Ke.join(", ")})}t.Ba=function(){return this.m},t.Ka=function(){return typeof this.l=="string"?this.l:String(this.l)};function ih(V,le,xe){return xe&&xe.internalChannelParams&&xe.internalChannelParams[V]||le}function rh(V){this.Aa=0,this.i=[],this.j=new Be,this.ia=this.qa=this.I=this.W=this.g=this.ya=this.D=this.H=this.m=this.S=this.o=null,this.Ya=this.U=0,this.Va=ih("failFast",!1,V),this.F=this.C=this.u=this.s=this.l=null,this.X=!0,this.za=this.T=-1,this.Y=this.v=this.B=0,this.Ta=ih("baseRetryDelayMs",5e3,V),this.cb=ih("retryDelaySeedMs",1e4,V),this.Wa=ih("forwardChannelMaxRetries",2,V),this.wa=ih("forwardChannelRequestTimeoutMs",2e4,V),this.pa=V&&V.xmlHttpFactory||void 0,this.Xa=V&&V.Tb||void 0,this.Ca=V&&V.useFetchStreams||!1,this.L=void 0,this.J=V&&V.supportsCrossDomainXhr||!1,this.K="",this.h=new qs(V&&V.concurrentRequestLimit),this.Da=new qc,this.P=V&&V.fastHandshake||!1,this.O=V&&V.encodeInitMessageHeaders||!1,this.P&&this.O&&(this.O=!1),this.Ua=V&&V.Rb||!1,V&&V.xa&&this.j.xa(),V&&V.forceLongPolling&&(this.X=!1),this.ba=!this.P&&this.X&&V&&V.detectBufferingProxy||!1,this.ja=void 0,V&&V.longPollingTimeout&&0<V.longPollingTimeout&&(this.ja=V.longPollingTimeout),this.ca=void 0,this.R=0,this.M=!1,this.ka=this.A=null}t=rh.prototype,t.la=8,t.G=1,t.connect=function(V,le,xe,Ke){gt(0),this.W=V,this.H=le||{},xe&&Ke!==void 0&&(this.H.OSID=xe,this.H.OAID=Ke),this.F=this.X,this.I=fi(this,null,this.W),Tu(this)};function Zc(V){if(cl(V),V.G==3){var le=V.U++,xe=Ha(V.I);if(Mr(xe,"SID",V.K),Mr(xe,"RID",le),Mr(xe,"TYPE","terminate"),Xc(V,xe),le=new _n(V,V.j,le),le.L=2,le.v=na(Ha(xe)),xe=!1,s.navigator&&s.navigator.sendBeacon)try{xe=s.navigator.sendBeacon(le.v.toString(),"")}catch{}!xe&&s.Image&&(new Image().src=le.v,xe=!0),xe||(le.g=Jh(le.j,null),le.g.ea(le.v)),le.F=Date.now(),tr(le)}ul(V)}function Mi(V){V.g&&(Il(V),V.g.cancel(),V.g=null)}function cl(V){Mi(V),V.u&&(s.clearTimeout(V.u),V.u=null),xn(V),V.h.cancel(),V.s&&(typeof V.s=="number"&&s.clearTimeout(V.s),V.s=null)}function Tu(V){if(!os(V.h)&&!V.s){V.s=!0;var le=V.Ga;Ft||Fe(),rn||(Ft(),rn=!0),Xt.add(le,V),V.B=0}}function Ep(V,le){return zs(V.h)>=V.h.j-(V.s?1:0)?!1:V.s?(V.i=le.D.concat(V.i),!0):V.G==1||V.G==2||V.B>=(V.Va?0:V.Wa)?!1:(V.s=ve(F(V.Ga,V,le),Di(V,V.B)),V.B++,!0)}t.Ga=function(V){if(this.s)if(this.s=null,this.G==1){if(!V){this.U=Math.floor(1e5*Math.random()),V=this.U++;const Vt=new _n(this,this.j,V);let $t=this.o;if(this.S&&($t?($t=_e($t),oe($t,this.S)):$t=this.S),this.m!==null||this.O||(Vt.H=$t,$t=null),this.P)e:{for(var le=0,xe=0;xe<this.i.length;xe++){t:{var Ke=this.i[xe];if("__data__"in Ke.map&&(Ke=Ke.map.__data__,typeof Ke=="string")){Ke=Ke.length;break t}Ke=void 0}if(Ke===void 0)break;if(le+=Ke,4096<le){le=xe;break e}if(le===4096||xe===this.i.length-1){le=xe+1;break e}}le=1e3}else le=1e3;le=sh(this,Vt,le),xe=Ha(this.I),Mr(xe,"RID",V),Mr(xe,"CVER",22),this.D&&Mr(xe,"X-HTTP-Session-Id",this.D),Xc(this,xe),$t&&(this.O?le="headers="+encodeURIComponent(String(nc($t)))+"&"+le:this.m&&hf(xe,this.m,$t)),Ws(this.h,Vt),this.Ua&&Mr(xe,"TYPE","init"),this.P?(Mr(xe,"$req",le),Mr(xe,"SID","null"),Vt.T=!0,Jn(Vt,xe,null)):Jn(Vt,xe,le),this.G=2}}else this.G==3&&(V?$n(this,V):this.i.length==0||os(this.h)||$n(this))};function $n(V,le){var xe;le?xe=le.l:xe=V.U++;const Ke=Ha(V.I);Mr(Ke,"SID",V.K),Mr(Ke,"RID",xe),Mr(Ke,"AID",V.T),Xc(V,Ke),V.m&&V.o&&hf(Ke,V.m,V.o),xe=new _n(V,V.j,xe,V.B+1),V.m===null&&(xe.H=V.o),le&&(V.i=le.D.concat(V.i)),le=sh(V,xe,1e3),xe.I=Math.round(.5*V.wa)+Math.round(.5*V.wa*Math.random()),Ws(V.h,xe),Jn(xe,Ke,le)}function Xc(V,le){V.H&&Xe(V.H,function(xe,Ke){Mr(le,Ke,xe)}),V.l&&Jl({},function(xe,Ke){Mr(le,Ke,xe)})}function sh(V,le,xe){xe=Math.min(V.i.length,xe);var Ke=V.l?F(V.l.Na,V.l,V):null;e:{var Vt=V.i;let $t=-1;for(;;){const Ln=["count="+xe];$t==-1?0<xe?($t=Vt[0].g,Ln.push("ofs="+$t)):$t=0:Ln.push("ofs="+$t);let Hi=!0;for(let Ss=0;Ss<xe;Ss++){let kn=Vt[Ss].g;const an=Vt[Ss].map;if(kn-=$t,0>kn)$t=Math.max(0,Vt[Ss].g-100),Hi=!1;else try{B_(an,Ln,"req"+kn+"_")}catch{Ke&&Ke(an)}}if(Hi){Ke=Ln.join("&");break e}}}return V=V.i.splice(0,xe),le.D=V,Ke}function ic(V){if(!V.g&&!V.u){V.Y=1;var le=V.Fa;Ft||Fe(),rn||(Ft(),rn=!0),Xt.add(le,V),V.v=0}}function $o(V){return V.g||V.u||3<=V.v?!1:(V.Y++,V.u=ve(F(V.Fa,V),Di(V,V.v)),V.v++,!0)}t.Fa=function(){if(this.u=null,Ya(this),this.ba&&!(this.M||this.g==null||0>=this.R)){var V=2*this.R;this.j.info("BP detection timer enabled: "+V),this.A=ve(F(this.ab,this),V)}},t.ab=function(){this.A&&(this.A=null,this.j.info("BP detection timeout reached."),this.j.info("Buffering proxy detected and switch to long-polling!"),this.F=!1,this.M=!0,gt(10),Mi(this),Ya(this))};function Il(V){V.A!=null&&(s.clearTimeout(V.A),V.A=null)}function Ya(V){V.g=new _n(V,V.j,"rpc",V.Y),V.m===null&&(V.g.H=V.o),V.g.O=0;var le=Ha(V.qa);Mr(le,"RID","rpc"),Mr(le,"SID",V.K),Mr(le,"AID",V.T),Mr(le,"CI",V.F?"0":"1"),!V.F&&V.ja&&Mr(le,"TO",V.ja),Mr(le,"TYPE","xmlhttp"),Xc(V,le),V.m&&V.o&&hf(le,V.m,V.o),V.L&&(V.g.I=V.L);var xe=V.g;V=V.ia,xe.L=1,xe.v=na(Ha(le)),xe.m=null,xe.P=!0,oi(xe,V)}t.Za=function(){this.C!=null&&(this.C=null,Mi(this),$o(this),gt(19))};function xn(V){V.C!=null&&(s.clearTimeout(V.C),V.C=null)}function gi(V,le){var xe=null;if(V.g==le){xn(V),Il(V),V.g=null;var Ke=2}else if(Ua(V.h,le))xe=le.D,ja(V.h,le),Ke=1;else return;if(V.G!=0){if(le.o)if(Ke==1){xe=le.m?le.m.length:0,le=Date.now()-le.F;var Vt=V.B;Ke=$r(),ir(Ke,new fe(Ke,xe)),Tu(V)}else ic(V);else if(Vt=le.s,Vt==3||Vt==0&&0<le.X||!(Ke==1&&Ep(V,le)||Ke==2&&$o(V)))switch(xe&&0<xe.length&&(le=V.h,le.i=le.i.concat(xe)),Vt){case 1:Fs(V,5);break;case 4:Fs(V,10);break;case 3:Fs(V,6);break;default:Fs(V,2)}}}function Di(V,le){let xe=V.Ta+Math.floor(Math.random()*V.cb);return V.isActive()||(xe*=2),xe*le}function Fs(V,le){if(V.j.info("Error code "+le),le==2){var xe=F(V.fb,V),Ke=V.Xa;const Vt=!Ke;Ke=new Dl(Ke||"//www.google.com/images/cleardot.gif"),s.location&&s.location.protocol=="http"||Ho(Ke,"https"),na(Ke),Vt?Si(Ke.toString(),xe):uf(Ke.toString(),xe)}else gt(2);V.G=0,V.l&&V.l.sa(le),ul(V),cl(V)}t.fb=function(V){V?(this.j.info("Successfully pinged google.com"),gt(2)):(this.j.info("Failed to ping google.com"),gt(1))};function ul(V){if(V.G=0,V.ka=[],V.l){const le=wu(V.h);(le.length!=0||V.i.length!=0)&&(te(V.ka,le),te(V.ka,V.i),V.h.i.length=0,X(V.i),V.i.length=0),V.l.ra()}}function fi(V,le,xe){var Ke=xe instanceof Dl?Ha(xe):new Dl(xe);if(Ke.g!="")le&&(Ke.g=le+"."+Ke.g),To(Ke,Ke.s);else{var Vt=s.location;Ke=Vt.protocol,le=le?le+"."+Vt.hostname:Vt.hostname,Vt=+Vt.port;var $t=new Dl(null);Ke&&Ho($t,Ke),le&&($t.g=le),Vt&&To($t,Vt),xe&&($t.l=xe),Ke=$t}return xe=V.D,le=V.ya,xe&&le&&Mr(Ke,xe,le),Mr(Ke,"VER",V.la),Xc(V,Ke),Ke}function Jh(V,le,xe){if(le&&!V.J)throw Error("Can't create secondary domain capable XhrIo object.");return le=V.Ca&&!V.pa?new Gr(new Ol({eb:xe})):new Gr(V.pa),le.Ha(V.J),le}t.isActive=function(){return!!this.l&&this.l.isActive(this)};function Qc(){}t=Qc.prototype,t.ua=function(){},t.ta=function(){},t.sa=function(){},t.ra=function(){},t.isActive=function(){return!0},t.Na=function(){};function ba(){}ba.prototype.g=function(V,le){return new Wr(V,le)};function Wr(V,le){Kr.call(this),this.g=new rh(le),this.l=V,this.h=le&&le.messageUrlParams||null,V=le&&le.messageHeaders||null,le&&le.clientProtocolHeaderRequired&&(V?V["X-Client-Protocol"]="webchannel":V={"X-Client-Protocol":"webchannel"}),this.g.o=V,V=le&&le.initMessageHeaders||null,le&&le.messageContentType&&(V?V["X-WebChannel-Content-Type"]=le.messageContentType:V={"X-WebChannel-Content-Type":le.messageContentType}),le&&le.va&&(V?V["X-WebChannel-Client-Profile"]=le.va:V={"X-WebChannel-Client-Profile":le.va}),this.g.S=V,(V=le&&le.Sb)&&!we(V)&&(this.g.m=V),this.v=le&&le.supportsCrossDomainXhr||!1,this.u=le&&le.sendRawJson||!1,(le=le&&le.httpSessionIdParam)&&!we(le)&&(this.g.D=le,V=this.h,V!==null&&le in V&&(V=this.h,le in V&&delete V[le])),this.j=new Za(this)}J(Wr,Kr),Wr.prototype.m=function(){this.g.l=this.j,this.v&&(this.g.J=!0),this.g.connect(this.l,this.h||void 0)},Wr.prototype.close=function(){Zc(this.g)},Wr.prototype.o=function(V){var le=this.g;if(typeof V=="string"){var xe={};xe.__data__=V,V=xe}else this.u&&(xe={},xe.__data__=Xs(V),V=xe);le.i.push(new Ir(le.Ya++,V)),le.G==3&&Tu(le)},Wr.prototype.N=function(){this.g.l=null,delete this.j,Zc(this.g),delete this.g,Wr.aa.N.call(this)};function ys(V){zi.call(this),V.__headers__&&(this.headers=V.__headers__,this.statusCode=V.__status__,delete V.__headers__,delete V.__status__);var le=V.__sm__;if(le){e:{for(const xe in le){V=xe;break e}V=void 0}(this.i=V)&&(V=this.i,le=le!==null&&V in le?le[V]:void 0),this.data=le}else this.data=V}J(ys,zi);function Km(){Ri.call(this),this.status=1}J(Km,Ri);function Za(V){this.g=V}J(Za,Qc),Za.prototype.ua=function(){ir(this.g,"a")},Za.prototype.ta=function(V){ir(this.g,new ys(V))},Za.prototype.sa=function(V){ir(this.g,new Km)},Za.prototype.ra=function(){ir(this.g,"b")},ba.prototype.createWebChannel=ba.prototype.g,Wr.prototype.send=Wr.prototype.o,Wr.prototype.open=Wr.prototype.m,Wr.prototype.close=Wr.prototype.close,Aj=function(){return new ba},Sj=function(){return $r()},Ej=Ii,Uk={mb:0,pb:1,qb:2,Jb:3,Ob:4,Lb:5,Mb:6,Kb:7,Ib:8,Nb:9,PROXY:10,NOPROXY:11,Gb:12,Cb:13,Db:14,Bb:15,Eb:16,Fb:17,ib:18,hb:19,jb:20},vt.NO_ERROR=0,vt.TIMEOUT=8,vt.HTTP_ERROR=6,GR=vt,It.COMPLETE="complete",Tj=It,jn.EventType=Wn,Wn.OPEN="a",Wn.CLOSE="b",Wn.ERROR="c",Wn.MESSAGE="d",Kr.prototype.listen=Kr.prototype.K,CS=jn,Gr.prototype.listenOnce=Gr.prototype.L,Gr.prototype.getLastError=Gr.prototype.Ka,Gr.prototype.getLastErrorCode=Gr.prototype.Ba,Gr.prototype.getStatus=Gr.prototype.Z,Gr.prototype.getResponseJson=Gr.prototype.Oa,Gr.prototype.getResponseText=Gr.prototype.oa,Gr.prototype.send=Gr.prototype.ea,Gr.prototype.setWithCredentials=Gr.prototype.Ha,wj=Gr}).apply(typeof iR<"u"?iR:typeof self<"u"?self:typeof window<"u"?window:{});const b3="@firebase/firestore",x3="4.7.17";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class kc{constructor(e){this.uid=e}isAuthenticated(){return this.uid!=null}toKey(){return this.isAuthenticated()?"uid:"+this.uid:"anonymous-user"}isEqual(e){return e.uid===this.uid}}kc.UNAUTHENTICATED=new kc(null),kc.GOOGLE_CREDENTIALS=new kc("google-credentials-uid"),kc.FIRST_PARTY=new kc("first-party-uid"),kc.MOCK_USER=new kc("mock-user");/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let vT="11.9.0";/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const bx=new f2("@firebase/firestore");function ww(){return bx.logLevel}function ui(t,...e){if(bx.logLevel<=Xr.DEBUG){const n=e.map(S2);bx.debug(`Firestore (${vT}): ${t}`,...n)}}function R_(t,...e){if(bx.logLevel<=Xr.ERROR){const n=e.map(S2);bx.error(`Firestore (${vT}): ${t}`,...n)}}function Kw(t,...e){if(bx.logLevel<=Xr.WARN){const n=e.map(S2);bx.warn(`Firestore (${vT}): ${t}`,...n)}}function S2(t){if(typeof t=="string")return t;try{/**
* @license
* Copyright 2020 Google LLC
*
* Licensed under the Apache License, Version 2.0 (the "License");
* you may not use this file except in compliance with the License.
* You may obtain a copy of the License at
*
*   http://www.apache.org/licenses/LICENSE-2.0
*
* Unless required by applicable law or agreed to in writing, software
* distributed under the License is distributed on an "AS IS" BASIS,
* WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
* See the License for the specific language governing permissions and
* limitations under the License.
*/return function(n){return JSON.stringify(n)}(t)}catch{return t}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zi(t,e,n){let r="Unexpected state";typeof e=="string"?r=e:n=e,Cj(t,r,n)}function Cj(t,e,n){let r=`FIRESTORE (${vT}) INTERNAL ASSERTION FAILED: ${e} (ID: ${t.toString(16)})`;if(n!==void 0)try{r+=" CONTEXT: "+JSON.stringify(n)}catch{r+=" CONTEXT: "+n}throw R_(r),new Error(r)}function Ps(t,e,n,r){let c="Unexpected state";typeof n=="string"?c=n:r=n,t||Cj(e,c,r)}function ar(t,e){return t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const In={OK:"ok",CANCELLED:"cancelled",UNKNOWN:"unknown",INVALID_ARGUMENT:"invalid-argument",DEADLINE_EXCEEDED:"deadline-exceeded",NOT_FOUND:"not-found",ALREADY_EXISTS:"already-exists",PERMISSION_DENIED:"permission-denied",UNAUTHENTICATED:"unauthenticated",RESOURCE_EXHAUSTED:"resource-exhausted",FAILED_PRECONDITION:"failed-precondition",ABORTED:"aborted",OUT_OF_RANGE:"out-of-range",UNIMPLEMENTED:"unimplemented",INTERNAL:"internal",UNAVAILABLE:"unavailable",DATA_LOSS:"data-loss"};class pi extends N_{constructor(e,n){super(e,n),this.code=e,this.message=n,this.toString=()=>`${this.name}: [code=${this.code}]: ${this.message}`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $v{constructor(){this.promise=new Promise((e,n)=>{this.resolve=e,this.reject=n})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dj{constructor(e,n){this.user=n,this.type="OAuth",this.headers=new Map,this.headers.set("Authorization",`Bearer ${e}`)}}class Hte{getToken(){return Promise.resolve(null)}invalidateToken(){}start(e,n){e.enqueueRetryable(()=>n(kc.UNAUTHENTICATED))}shutdown(){}}class $te{constructor(e){this.token=e,this.changeListener=null}getToken(){return Promise.resolve(this.token)}invalidateToken(){}start(e,n){this.changeListener=n,e.enqueueRetryable(()=>n(this.token.user))}shutdown(){this.changeListener=null}}class Gte{constructor(e){this.t=e,this.currentUser=kc.UNAUTHENTICATED,this.i=0,this.forceRefresh=!1,this.auth=null}start(e,n){Ps(this.o===void 0,42304);let r=this.i;const c=T=>this.i!==r?(r=this.i,n(T)):Promise.resolve();let d=new $v;this.o=()=>{this.i++,this.currentUser=this.u(),d.resolve(),d=new $v,e.enqueueRetryable(()=>c(this.currentUser))};const m=()=>{const T=d;e.enqueueRetryable(async()=>{await T.promise,await c(this.currentUser)})},s=T=>{ui("FirebaseAuthCredentialsProvider","Auth detected"),this.auth=T,this.o&&(this.auth.addAuthTokenListener(this.o),m())};this.t.onInit(T=>s(T)),setTimeout(()=>{if(!this.auth){const T=this.t.getImmediate({optional:!0});T?s(T):(ui("FirebaseAuthCredentialsProvider","Auth not yet detected"),d.resolve(),d=new $v)}},0),m()}getToken(){const e=this.i,n=this.forceRefresh;return this.forceRefresh=!1,this.auth?this.auth.getToken(n).then(r=>this.i!==e?(ui("FirebaseAuthCredentialsProvider","getToken aborted due to token change."),this.getToken()):r?(Ps(typeof r.accessToken=="string",31837,{l:r}),new Dj(r.accessToken,this.currentUser)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.auth&&this.o&&this.auth.removeAuthTokenListener(this.o),this.o=void 0}u(){const e=this.auth&&this.auth.getUid();return Ps(e===null||typeof e=="string",2055,{h:e}),new kc(e)}}class qte{constructor(e,n,r){this.P=e,this.T=n,this.I=r,this.type="FirstParty",this.user=kc.FIRST_PARTY,this.A=new Map}R(){return this.I?this.I():null}get headers(){this.A.set("X-Goog-AuthUser",this.P);const e=this.R();return e&&this.A.set("Authorization",e),this.T&&this.A.set("X-Goog-Iam-Authorization-Token",this.T),this.A}}class Wte{constructor(e,n,r){this.P=e,this.T=n,this.I=r}getToken(){return Promise.resolve(new qte(this.P,this.T,this.I))}start(e,n){e.enqueueRetryable(()=>n(kc.FIRST_PARTY))}shutdown(){}invalidateToken(){}}class w3{constructor(e){this.value=e,this.type="AppCheck",this.headers=new Map,e&&e.length>0&&this.headers.set("x-firebase-appcheck",this.value)}}class Yte{constructor(e,n){this.V=n,this.forceRefresh=!1,this.appCheck=null,this.m=null,this.p=null,Qd(e)&&e.settings.appCheckToken&&(this.p=e.settings.appCheckToken)}start(e,n){Ps(this.o===void 0,3512);const r=d=>{d.error!=null&&ui("FirebaseAppCheckTokenProvider",`Error getting App Check token; using placeholder token instead. Error: ${d.error.message}`);const m=d.token!==this.m;return this.m=d.token,ui("FirebaseAppCheckTokenProvider",`Received ${m?"new":"existing"} token.`),m?n(d.token):Promise.resolve()};this.o=d=>{e.enqueueRetryable(()=>r(d))};const c=d=>{ui("FirebaseAppCheckTokenProvider","AppCheck detected"),this.appCheck=d,this.o&&this.appCheck.addTokenListener(this.o)};this.V.onInit(d=>c(d)),setTimeout(()=>{if(!this.appCheck){const d=this.V.getImmediate({optional:!0});d?c(d):ui("FirebaseAppCheckTokenProvider","AppCheck not yet detected")}},0)}getToken(){if(this.p)return Promise.resolve(new w3(this.p));const e=this.forceRefresh;return this.forceRefresh=!1,this.appCheck?this.appCheck.getToken(e).then(n=>n?(Ps(typeof n.token=="string",44558,{tokenResult:n}),this.m=n.token,new w3(n.token)):null):Promise.resolve(null)}invalidateToken(){this.forceRefresh=!0}shutdown(){this.appCheck&&this.o&&this.appCheck.removeTokenListener(this.o),this.o=void 0}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Zte(t){const e=typeof self<"u"&&(self.crypto||self.msCrypto),n=new Uint8Array(t);if(e&&typeof e.getRandomValues=="function")e.getRandomValues(n);else for(let r=0;r<t;r++)n[r]=Math.floor(256*Math.random());return n}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Rj(){return new TextEncoder}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Oj{static newId(){const e="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789",n=62*Math.floor(4.129032258064516);let r="";for(;r.length<20;){const c=Zte(40);for(let d=0;d<c.length;++d)r.length<20&&c[d]<n&&(r+=e.charAt(c[d]%62))}return r}}function Fr(t,e){return t<e?-1:t>e?1:0}function jk(t,e){let n=0;for(;n<t.length&&n<e.length;){const r=t.codePointAt(n),c=e.codePointAt(n);if(r!==c){if(r<128&&c<128)return Fr(r,c);{const d=Rj(),m=Xte(d.encode(T3(t,n)),d.encode(T3(e,n)));return m!==0?m:Fr(r,c)}}n+=r>65535?2:1}return Fr(t.length,e.length)}function T3(t,e){return t.codePointAt(e)>65535?t.substring(e,e+2):t.substring(e,e+1)}function Xte(t,e){for(let n=0;n<t.length&&n<e.length;++n)if(t[n]!==e[n])return Fr(t[n],e[n]);return Fr(t.length,e.length)}function Jw(t,e,n){return t.length===e.length&&t.every((r,c)=>n(r,e[c]))}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const E3=-62135596800,S3=1e6;class xo{static now(){return xo.fromMillis(Date.now())}static fromDate(e){return xo.fromMillis(e.getTime())}static fromMillis(e){const n=Math.floor(e/1e3),r=Math.floor((e-1e3*n)*S3);return new xo(n,r)}constructor(e,n){if(this.seconds=e,this.nanoseconds=n,n<0)throw new pi(In.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(n>=1e9)throw new pi(In.INVALID_ARGUMENT,"Timestamp nanoseconds out of range: "+n);if(e<E3)throw new pi(In.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e);if(e>=253402300800)throw new pi(In.INVALID_ARGUMENT,"Timestamp seconds out of range: "+e)}toDate(){return new Date(this.toMillis())}toMillis(){return 1e3*this.seconds+this.nanoseconds/S3}_compareTo(e){return this.seconds===e.seconds?Fr(this.nanoseconds,e.nanoseconds):Fr(this.seconds,e.seconds)}isEqual(e){return e.seconds===this.seconds&&e.nanoseconds===this.nanoseconds}toString(){return"Timestamp(seconds="+this.seconds+", nanoseconds="+this.nanoseconds+")"}toJSON(){return{seconds:this.seconds,nanoseconds:this.nanoseconds}}valueOf(){const e=this.seconds-E3;return String(e).padStart(12,"0")+"."+String(this.nanoseconds).padStart(9,"0")}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class or{static fromTimestamp(e){return new or(e)}static min(){return new or(new xo(0,0))}static max(){return new or(new xo(253402300799,999999999))}constructor(e){this.timestamp=e}compareTo(e){return this.timestamp._compareTo(e.timestamp)}isEqual(e){return this.timestamp.isEqual(e.timestamp)}toMicroseconds(){return 1e6*this.timestamp.seconds+this.timestamp.nanoseconds/1e3}toString(){return"SnapshotVersion("+this.timestamp.toString()+")"}toTimestamp(){return this.timestamp}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A3="__name__";class Pm{constructor(e,n,r){n===void 0?n=0:n>e.length&&Zi(637,{offset:n,range:e.length}),r===void 0?r=e.length-n:r>e.length-n&&Zi(1746,{length:r,range:e.length-n}),this.segments=e,this.offset=n,this.len=r}get length(){return this.len}isEqual(e){return Pm.comparator(this,e)===0}child(e){const n=this.segments.slice(this.offset,this.limit());return e instanceof Pm?e.forEach(r=>{n.push(r)}):n.push(e),this.construct(n)}limit(){return this.offset+this.length}popFirst(e){return e=e===void 0?1:e,this.construct(this.segments,this.offset+e,this.length-e)}popLast(){return this.construct(this.segments,this.offset,this.length-1)}firstSegment(){return this.segments[this.offset]}lastSegment(){return this.get(this.length-1)}get(e){return this.segments[this.offset+e]}isEmpty(){return this.length===0}isPrefixOf(e){if(e.length<this.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}isImmediateParentOf(e){if(this.length+1!==e.length)return!1;for(let n=0;n<this.length;n++)if(this.get(n)!==e.get(n))return!1;return!0}forEach(e){for(let n=this.offset,r=this.limit();n<r;n++)e(this.segments[n])}toArray(){return this.segments.slice(this.offset,this.limit())}static comparator(e,n){const r=Math.min(e.length,n.length);for(let c=0;c<r;c++){const d=Pm.compareSegments(e.get(c),n.get(c));if(d!==0)return d}return Fr(e.length,n.length)}static compareSegments(e,n){const r=Pm.isNumericId(e),c=Pm.isNumericId(n);return r&&!c?-1:!r&&c?1:r&&c?Pm.extractNumericId(e).compare(Pm.extractNumericId(n)):jk(e,n)}static isNumericId(e){return e.startsWith("__id")&&e.endsWith("__")}static extractNumericId(e){return Hv.fromString(e.substring(4,e.length-2))}}class bo extends Pm{construct(e,n,r){return new bo(e,n,r)}canonicalString(){return this.toArray().join("/")}toString(){return this.canonicalString()}toUriEncodedString(){return this.toArray().map(encodeURIComponent).join("/")}static fromString(...e){const n=[];for(const r of e){if(r.indexOf("//")>=0)throw new pi(In.INVALID_ARGUMENT,`Invalid segment (${r}). Paths must not contain // in them.`);n.push(...r.split("/").filter(c=>c.length>0))}return new bo(n)}static emptyPath(){return new bo([])}}const Qte=/^[_a-zA-Z][_a-zA-Z0-9]*$/;class Ql extends Pm{construct(e,n,r){return new Ql(e,n,r)}static isValidIdentifier(e){return Qte.test(e)}canonicalString(){return this.toArray().map(e=>(e=e.replace(/\\/g,"\\\\").replace(/`/g,"\\`"),Ql.isValidIdentifier(e)||(e="`"+e+"`"),e)).join(".")}toString(){return this.canonicalString()}isKeyField(){return this.length===1&&this.get(0)===A3}static keyField(){return new Ql([A3])}static fromServerFormat(e){const n=[];let r="",c=0;const d=()=>{if(r.length===0)throw new pi(In.INVALID_ARGUMENT,`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`);n.push(r),r=""};let m=!1;for(;c<e.length;){const s=e[c];if(s==="\\"){if(c+1===e.length)throw new pi(In.INVALID_ARGUMENT,"Path has trailing escape character: "+e);const T=e[c+1];if(T!=="\\"&&T!=="."&&T!=="`")throw new pi(In.INVALID_ARGUMENT,"Path has invalid escape sequence: "+e);r+=T,c+=2}else s==="`"?(m=!m,c++):s!=="."||m?(r+=s,c++):(d(),c++)}if(d(),m)throw new pi(In.INVALID_ARGUMENT,"Unterminated ` in path: "+e);return new Ql(n)}static emptyPath(){return new Ql([])}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Ni{constructor(e){this.path=e}static fromPath(e){return new Ni(bo.fromString(e))}static fromName(e){return new Ni(bo.fromString(e).popFirst(5))}static empty(){return new Ni(bo.emptyPath())}get collectionGroup(){return this.path.popLast().lastSegment()}hasCollectionId(e){return this.path.length>=2&&this.path.get(this.path.length-2)===e}getCollectionGroup(){return this.path.get(this.path.length-2)}getCollectionPath(){return this.path.popLast()}isEqual(e){return e!==null&&bo.comparator(this.path,e.path)===0}toString(){return this.path.toString()}static comparator(e,n){return bo.comparator(e.path,n.path)}static isDocumentKey(e){return e.length%2==0}static fromSegments(e){return new Ni(new bo(e.slice()))}}/**
 * @license
 * Copyright 2021 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const fA=-1;function Kte(t,e){const n=t.toTimestamp().seconds,r=t.toTimestamp().nanoseconds+1,c=or.fromTimestamp(r===1e9?new xo(n+1,0):new xo(n,r));return new Xv(c,Ni.empty(),e)}function Jte(t){return new Xv(t.readTime,t.key,fA)}class Xv{constructor(e,n,r){this.readTime=e,this.documentKey=n,this.largestBatchId=r}static min(){return new Xv(or.min(),Ni.empty(),fA)}static max(){return new Xv(or.max(),Ni.empty(),fA)}}function ene(t,e){let n=t.readTime.compareTo(e.readTime);return n!==0?n:(n=Ni.comparator(t.documentKey,e.documentKey),n!==0?n:Fr(t.largestBatchId,e.largestBatchId))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tne="The current tab is not in the required state to perform this operation. It might be necessary to refresh the browser tab.";class nne{constructor(){this.onCommittedListeners=[]}addOnCommittedListener(e){this.onCommittedListeners.push(e)}raiseOnCommittedEvent(){this.onCommittedListeners.forEach(e=>e())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */async function bT(t){if(t.code!==In.FAILED_PRECONDITION||t.message!==tne)throw t;ui("LocalStore","Unexpectedly lost primary lease")}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Dn{constructor(e){this.nextCallback=null,this.catchCallback=null,this.result=void 0,this.error=void 0,this.isDone=!1,this.callbackAttached=!1,e(n=>{this.isDone=!0,this.result=n,this.nextCallback&&this.nextCallback(n)},n=>{this.isDone=!0,this.error=n,this.catchCallback&&this.catchCallback(n)})}catch(e){return this.next(void 0,e)}next(e,n){return this.callbackAttached&&Zi(59440),this.callbackAttached=!0,this.isDone?this.error?this.wrapFailure(n,this.error):this.wrapSuccess(e,this.result):new Dn((r,c)=>{this.nextCallback=d=>{this.wrapSuccess(e,d).next(r,c)},this.catchCallback=d=>{this.wrapFailure(n,d).next(r,c)}})}toPromise(){return new Promise((e,n)=>{this.next(e,n)})}wrapUserFunction(e){try{const n=e();return n instanceof Dn?n:Dn.resolve(n)}catch(n){return Dn.reject(n)}}wrapSuccess(e,n){return e?this.wrapUserFunction(()=>e(n)):Dn.resolve(n)}wrapFailure(e,n){return e?this.wrapUserFunction(()=>e(n)):Dn.reject(n)}static resolve(e){return new Dn((n,r)=>{n(e)})}static reject(e){return new Dn((n,r)=>{r(e)})}static waitFor(e){return new Dn((n,r)=>{let c=0,d=0,m=!1;e.forEach(s=>{++c,s.next(()=>{++d,m&&d===c&&n()},T=>r(T))}),m=!0,d===c&&n()})}static or(e){let n=Dn.resolve(!1);for(const r of e)n=n.next(c=>c?Dn.resolve(c):r());return n}static forEach(e,n){const r=[];return e.forEach((c,d)=>{r.push(n.call(this,c,d))}),this.waitFor(r)}static mapArray(e,n){return new Dn((r,c)=>{const d=e.length,m=new Array(d);let s=0;for(let T=0;T<d;T++){const D=T;n(e[D]).next(P=>{m[D]=P,++s,s===d&&r(m)},P=>c(P))}})}static doWhile(e,n){return new Dn((r,c)=>{const d=()=>{e()===!0?n().next(()=>{d()},c):r()};d()})}}function ine(t){const e=t.match(/Android ([\d.]+)/i),n=e?e[1].split(".").slice(0,2).join("."):"-1";return Number(n)}function xT(t){return t.name==="IndexedDbTransactionError"}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class jI{constructor(e,n){this.previousValue=e,n&&(n.sequenceNumberHandler=r=>this.ue(r),this.ce=r=>n.writeSequenceNumber(r))}ue(e){return this.previousValue=Math.max(e,this.previousValue),this.previousValue}next(){const e=++this.previousValue;return this.ce&&this.ce(e),e}}jI.le=-1;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const A2=-1;function HI(t){return t==null}function RO(t){return t===0&&1/t==-1/0}function rne(t){return typeof t=="number"&&Number.isInteger(t)&&!RO(t)&&t<=Number.MAX_SAFE_INTEGER&&t>=Number.MIN_SAFE_INTEGER}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ij="";function sne(t){let e="";for(let n=0;n<t.length;n++)e.length>0&&(e=C3(e)),e=one(t.get(n),e);return C3(e)}function one(t,e){let n=e;const r=t.length;for(let c=0;c<r;c++){const d=t.charAt(c);switch(d){case"\0":n+="";break;case Ij:n+="";break;default:n+=d}}return n}function C3(t){return t+Ij+""}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function D3(t){let e=0;for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e++;return e}function c0(t,e){for(const n in t)Object.prototype.hasOwnProperty.call(t,n)&&e(n,t[n])}function Mj(t){for(const e in t)if(Object.prototype.hasOwnProperty.call(t,e))return!1;return!0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Bo{constructor(e,n){this.comparator=e,this.root=n||Yl.EMPTY}insert(e,n){return new Bo(this.comparator,this.root.insert(e,n,this.comparator).copy(null,null,Yl.BLACK,null,null))}remove(e){return new Bo(this.comparator,this.root.remove(e,this.comparator).copy(null,null,Yl.BLACK,null,null))}get(e){let n=this.root;for(;!n.isEmpty();){const r=this.comparator(e,n.key);if(r===0)return n.value;r<0?n=n.left:r>0&&(n=n.right)}return null}indexOf(e){let n=0,r=this.root;for(;!r.isEmpty();){const c=this.comparator(e,r.key);if(c===0)return n+r.left.size;c<0?r=r.left:(n+=r.left.size+1,r=r.right)}return-1}isEmpty(){return this.root.isEmpty()}get size(){return this.root.size}minKey(){return this.root.minKey()}maxKey(){return this.root.maxKey()}inorderTraversal(e){return this.root.inorderTraversal(e)}forEach(e){this.inorderTraversal((n,r)=>(e(n,r),!1))}toString(){const e=[];return this.inorderTraversal((n,r)=>(e.push(`${n}:${r}`),!1)),`{${e.join(", ")}}`}reverseTraversal(e){return this.root.reverseTraversal(e)}getIterator(){return new rR(this.root,null,this.comparator,!1)}getIteratorFrom(e){return new rR(this.root,e,this.comparator,!1)}getReverseIterator(){return new rR(this.root,null,this.comparator,!0)}getReverseIteratorFrom(e){return new rR(this.root,e,this.comparator,!0)}}class rR{constructor(e,n,r,c){this.isReverse=c,this.nodeStack=[];let d=1;for(;!e.isEmpty();)if(d=n?r(e.key,n):1,n&&c&&(d*=-1),d<0)e=this.isReverse?e.left:e.right;else{if(d===0){this.nodeStack.push(e);break}this.nodeStack.push(e),e=this.isReverse?e.right:e.left}}getNext(){let e=this.nodeStack.pop();const n={key:e.key,value:e.value};if(this.isReverse)for(e=e.left;!e.isEmpty();)this.nodeStack.push(e),e=e.right;else for(e=e.right;!e.isEmpty();)this.nodeStack.push(e),e=e.left;return n}hasNext(){return this.nodeStack.length>0}peek(){if(this.nodeStack.length===0)return null;const e=this.nodeStack[this.nodeStack.length-1];return{key:e.key,value:e.value}}}class Yl{constructor(e,n,r,c,d){this.key=e,this.value=n,this.color=r??Yl.RED,this.left=c??Yl.EMPTY,this.right=d??Yl.EMPTY,this.size=this.left.size+1+this.right.size}copy(e,n,r,c,d){return new Yl(e??this.key,n??this.value,r??this.color,c??this.left,d??this.right)}isEmpty(){return!1}inorderTraversal(e){return this.left.inorderTraversal(e)||e(this.key,this.value)||this.right.inorderTraversal(e)}reverseTraversal(e){return this.right.reverseTraversal(e)||e(this.key,this.value)||this.left.reverseTraversal(e)}min(){return this.left.isEmpty()?this:this.left.min()}minKey(){return this.min().key}maxKey(){return this.right.isEmpty()?this.key:this.right.maxKey()}insert(e,n,r){let c=this;const d=r(e,c.key);return c=d<0?c.copy(null,null,null,c.left.insert(e,n,r),null):d===0?c.copy(null,n,null,null,null):c.copy(null,null,null,null,c.right.insert(e,n,r)),c.fixUp()}removeMin(){if(this.left.isEmpty())return Yl.EMPTY;let e=this;return e.left.isRed()||e.left.left.isRed()||(e=e.moveRedLeft()),e=e.copy(null,null,null,e.left.removeMin(),null),e.fixUp()}remove(e,n){let r,c=this;if(n(e,c.key)<0)c.left.isEmpty()||c.left.isRed()||c.left.left.isRed()||(c=c.moveRedLeft()),c=c.copy(null,null,null,c.left.remove(e,n),null);else{if(c.left.isRed()&&(c=c.rotateRight()),c.right.isEmpty()||c.right.isRed()||c.right.left.isRed()||(c=c.moveRedRight()),n(e,c.key)===0){if(c.right.isEmpty())return Yl.EMPTY;r=c.right.min(),c=c.copy(r.key,r.value,null,null,c.right.removeMin())}c=c.copy(null,null,null,null,c.right.remove(e,n))}return c.fixUp()}isRed(){return this.color}fixUp(){let e=this;return e.right.isRed()&&!e.left.isRed()&&(e=e.rotateLeft()),e.left.isRed()&&e.left.left.isRed()&&(e=e.rotateRight()),e.left.isRed()&&e.right.isRed()&&(e=e.colorFlip()),e}moveRedLeft(){let e=this.colorFlip();return e.right.left.isRed()&&(e=e.copy(null,null,null,null,e.right.rotateRight()),e=e.rotateLeft(),e=e.colorFlip()),e}moveRedRight(){let e=this.colorFlip();return e.left.left.isRed()&&(e=e.rotateRight(),e=e.colorFlip()),e}rotateLeft(){const e=this.copy(null,null,Yl.RED,null,this.right.left);return this.right.copy(null,null,this.color,e,null)}rotateRight(){const e=this.copy(null,null,Yl.RED,this.left.right,null);return this.left.copy(null,null,this.color,null,e)}colorFlip(){const e=this.left.copy(null,null,!this.left.color,null,null),n=this.right.copy(null,null,!this.right.color,null,null);return this.copy(null,null,!this.color,e,n)}checkMaxDepth(){const e=this.check();return Math.pow(2,e)<=this.size+1}check(){if(this.isRed()&&this.left.isRed())throw Zi(43730,{key:this.key,value:this.value});if(this.right.isRed())throw Zi(14113,{key:this.key,value:this.value});const e=this.left.check();if(e!==this.right.check())throw Zi(27949);return e+(this.isRed()?0:1)}}Yl.EMPTY=null,Yl.RED=!0,Yl.BLACK=!1;Yl.EMPTY=new class{constructor(){this.size=0}get key(){throw Zi(57766)}get value(){throw Zi(16141)}get color(){throw Zi(16727)}get left(){throw Zi(29726)}get right(){throw Zi(36894)}copy(e,n,r,c,d){return this}insert(e,n,r){return new Yl(e,n)}remove(e,n){return this}isEmpty(){return!0}inorderTraversal(e){return!1}reverseTraversal(e){return!1}minKey(){return null}maxKey(){return null}isRed(){return!1}checkMaxDepth(){return!0}check(){return 0}};/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class al{constructor(e){this.comparator=e,this.data=new Bo(this.comparator)}has(e){return this.data.get(e)!==null}first(){return this.data.minKey()}last(){return this.data.maxKey()}get size(){return this.data.size}indexOf(e){return this.data.indexOf(e)}forEach(e){this.data.inorderTraversal((n,r)=>(e(n),!1))}forEachInRange(e,n){const r=this.data.getIteratorFrom(e[0]);for(;r.hasNext();){const c=r.getNext();if(this.comparator(c.key,e[1])>=0)return;n(c.key)}}forEachWhile(e,n){let r;for(r=n!==void 0?this.data.getIteratorFrom(n):this.data.getIterator();r.hasNext();)if(!e(r.getNext().key))return}firstAfterOrEqual(e){const n=this.data.getIteratorFrom(e);return n.hasNext()?n.getNext().key:null}getIterator(){return new R3(this.data.getIterator())}getIteratorFrom(e){return new R3(this.data.getIteratorFrom(e))}add(e){return this.copy(this.data.remove(e).insert(e,!0))}delete(e){return this.has(e)?this.copy(this.data.remove(e)):this}isEmpty(){return this.data.isEmpty()}unionWith(e){let n=this;return n.size<e.size&&(n=e,e=this),e.forEach(r=>{n=n.add(r)}),n}isEqual(e){if(!(e instanceof al)||this.size!==e.size)return!1;const n=this.data.getIterator(),r=e.data.getIterator();for(;n.hasNext();){const c=n.getNext().key,d=r.getNext().key;if(this.comparator(c,d)!==0)return!1}return!0}toArray(){const e=[];return this.forEach(n=>{e.push(n)}),e}toString(){const e=[];return this.forEach(n=>e.push(n)),"SortedSet("+e.toString()+")"}copy(e){const n=new al(this.comparator);return n.data=e,n}}class R3{constructor(e){this.iter=e}getNext(){return this.iter.getNext().key}hasNext(){return this.iter.hasNext()}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Gh{constructor(e){this.fields=e,e.sort(Ql.comparator)}static empty(){return new Gh([])}unionWith(e){let n=new al(Ql.comparator);for(const r of this.fields)n=n.add(r);for(const r of e)n=n.add(r);return new Gh(n.toArray())}covers(e){for(const n of this.fields)if(n.isPrefixOf(e))return!0;return!1}isEqual(e){return Jw(this.fields,e.fields,(n,r)=>n.isEqual(r))}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pj extends Error{constructor(){super(...arguments),this.name="Base64DecodeError"}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Kl{constructor(e){this.binaryString=e}static fromBase64String(e){const n=function(c){try{return atob(c)}catch(d){throw typeof DOMException<"u"&&d instanceof DOMException?new Pj("Invalid base64 string: "+d):d}}(e);return new Kl(n)}static fromUint8Array(e){const n=function(c){let d="";for(let m=0;m<c.length;++m)d+=String.fromCharCode(c[m]);return d}(e);return new Kl(n)}[Symbol.iterator](){let e=0;return{next:()=>e<this.binaryString.length?{value:this.binaryString.charCodeAt(e++),done:!1}:{value:void 0,done:!0}}}toBase64(){return function(n){return btoa(n)}(this.binaryString)}toUint8Array(){return function(n){const r=new Uint8Array(n.length);for(let c=0;c<n.length;c++)r[c]=n.charCodeAt(c);return r}(this.binaryString)}approximateByteSize(){return 2*this.binaryString.length}compareTo(e){return Fr(this.binaryString,e.binaryString)}isEqual(e){return this.binaryString===e.binaryString}}Kl.EMPTY_BYTE_STRING=new Kl("");const ane=new RegExp(/^\d{4}-\d\d-\d\dT\d\d:\d\d:\d\d(?:\.(\d+))?Z$/);function Qv(t){if(Ps(!!t,39018),typeof t=="string"){let e=0;const n=ane.exec(t);if(Ps(!!n,46558,{timestamp:t}),n[1]){let c=n[1];c=(c+"000000000").substr(0,9),e=Number(c)}const r=new Date(t);return{seconds:Math.floor(r.getTime()/1e3),nanos:e}}return{seconds:ma(t.seconds),nanos:ma(t.nanos)}}function ma(t){return typeof t=="number"?t:typeof t=="string"?Number(t):0}function Kv(t){return typeof t=="string"?Kl.fromBase64String(t):Kl.fromUint8Array(t)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const kj="server_timestamp",Nj="__type__",Lj="__previous_value__",zj="__local_write_time__";function C2(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Nj])===null||n===void 0?void 0:n.stringValue)===kj}function $I(t){const e=t.mapValue.fields[Lj];return C2(e)?$I(e):e}function pA(t){const e=Qv(t.mapValue.fields[zj].timestampValue);return new xo(e.seconds,e.nanos)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lne{constructor(e,n,r,c,d,m,s,T,D,P){this.databaseId=e,this.appId=n,this.persistenceKey=r,this.host=c,this.ssl=d,this.forceLongPolling=m,this.autoDetectLongPolling=s,this.longPollingOptions=T,this.useFetchStreams=D,this.isUsingEmulator=P}}const OO="(default)";class mA{constructor(e,n){this.projectId=e,this.database=n||OO}static empty(){return new mA("","")}get isDefaultDatabase(){return this.database===OO}isEqual(e){return e instanceof mA&&e.projectId===this.projectId&&e.database===this.database}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Bj="__type__",cne="__max__",sR={mapValue:{}},Fj="__vector__",IO="value";function Jv(t){return"nullValue"in t?0:"booleanValue"in t?1:"integerValue"in t||"doubleValue"in t?2:"timestampValue"in t?3:"stringValue"in t?5:"bytesValue"in t?6:"referenceValue"in t?7:"geoPointValue"in t?8:"arrayValue"in t?9:"mapValue"in t?C2(t)?4:hne(t)?9007199254740991:une(t)?10:11:Zi(28295,{value:t})}function Wm(t,e){if(t===e)return!0;const n=Jv(t);if(n!==Jv(e))return!1;switch(n){case 0:case 9007199254740991:return!0;case 1:return t.booleanValue===e.booleanValue;case 4:return pA(t).isEqual(pA(e));case 3:return function(c,d){if(typeof c.timestampValue=="string"&&typeof d.timestampValue=="string"&&c.timestampValue.length===d.timestampValue.length)return c.timestampValue===d.timestampValue;const m=Qv(c.timestampValue),s=Qv(d.timestampValue);return m.seconds===s.seconds&&m.nanos===s.nanos}(t,e);case 5:return t.stringValue===e.stringValue;case 6:return function(c,d){return Kv(c.bytesValue).isEqual(Kv(d.bytesValue))}(t,e);case 7:return t.referenceValue===e.referenceValue;case 8:return function(c,d){return ma(c.geoPointValue.latitude)===ma(d.geoPointValue.latitude)&&ma(c.geoPointValue.longitude)===ma(d.geoPointValue.longitude)}(t,e);case 2:return function(c,d){if("integerValue"in c&&"integerValue"in d)return ma(c.integerValue)===ma(d.integerValue);if("doubleValue"in c&&"doubleValue"in d){const m=ma(c.doubleValue),s=ma(d.doubleValue);return m===s?RO(m)===RO(s):isNaN(m)&&isNaN(s)}return!1}(t,e);case 9:return Jw(t.arrayValue.values||[],e.arrayValue.values||[],Wm);case 10:case 11:return function(c,d){const m=c.mapValue.fields||{},s=d.mapValue.fields||{};if(D3(m)!==D3(s))return!1;for(const T in m)if(m.hasOwnProperty(T)&&(s[T]===void 0||!Wm(m[T],s[T])))return!1;return!0}(t,e);default:return Zi(52216,{left:t})}}function gA(t,e){return(t.values||[]).find(n=>Wm(n,e))!==void 0}function eT(t,e){if(t===e)return 0;const n=Jv(t),r=Jv(e);if(n!==r)return Fr(n,r);switch(n){case 0:case 9007199254740991:return 0;case 1:return Fr(t.booleanValue,e.booleanValue);case 2:return function(d,m){const s=ma(d.integerValue||d.doubleValue),T=ma(m.integerValue||m.doubleValue);return s<T?-1:s>T?1:s===T?0:isNaN(s)?isNaN(T)?0:-1:1}(t,e);case 3:return O3(t.timestampValue,e.timestampValue);case 4:return O3(pA(t),pA(e));case 5:return jk(t.stringValue,e.stringValue);case 6:return function(d,m){const s=Kv(d),T=Kv(m);return s.compareTo(T)}(t.bytesValue,e.bytesValue);case 7:return function(d,m){const s=d.split("/"),T=m.split("/");for(let D=0;D<s.length&&D<T.length;D++){const P=Fr(s[D],T[D]);if(P!==0)return P}return Fr(s.length,T.length)}(t.referenceValue,e.referenceValue);case 8:return function(d,m){const s=Fr(ma(d.latitude),ma(m.latitude));return s!==0?s:Fr(ma(d.longitude),ma(m.longitude))}(t.geoPointValue,e.geoPointValue);case 9:return I3(t.arrayValue,e.arrayValue);case 10:return function(d,m){var s,T,D,P;const z=d.fields||{},F=m.fields||{},$=(s=z[IO])===null||s===void 0?void 0:s.arrayValue,J=(T=F[IO])===null||T===void 0?void 0:T.arrayValue,X=Fr(((D=$==null?void 0:$.values)===null||D===void 0?void 0:D.length)||0,((P=J==null?void 0:J.values)===null||P===void 0?void 0:P.length)||0);return X!==0?X:I3($,J)}(t.mapValue,e.mapValue);case 11:return function(d,m){if(d===sR.mapValue&&m===sR.mapValue)return 0;if(d===sR.mapValue)return 1;if(m===sR.mapValue)return-1;const s=d.fields||{},T=Object.keys(s),D=m.fields||{},P=Object.keys(D);T.sort(),P.sort();for(let z=0;z<T.length&&z<P.length;++z){const F=jk(T[z],P[z]);if(F!==0)return F;const $=eT(s[T[z]],D[P[z]]);if($!==0)return $}return Fr(T.length,P.length)}(t.mapValue,e.mapValue);default:throw Zi(23264,{Pe:n})}}function O3(t,e){if(typeof t=="string"&&typeof e=="string"&&t.length===e.length)return Fr(t,e);const n=Qv(t),r=Qv(e),c=Fr(n.seconds,r.seconds);return c!==0?c:Fr(n.nanos,r.nanos)}function I3(t,e){const n=t.values||[],r=e.values||[];for(let c=0;c<n.length&&c<r.length;++c){const d=eT(n[c],r[c]);if(d)return d}return Fr(n.length,r.length)}function tT(t){return Hk(t)}function Hk(t){return"nullValue"in t?"null":"booleanValue"in t?""+t.booleanValue:"integerValue"in t?""+t.integerValue:"doubleValue"in t?""+t.doubleValue:"timestampValue"in t?function(n){const r=Qv(n);return`time(${r.seconds},${r.nanos})`}(t.timestampValue):"stringValue"in t?t.stringValue:"bytesValue"in t?function(n){return Kv(n).toBase64()}(t.bytesValue):"referenceValue"in t?function(n){return Ni.fromName(n).toString()}(t.referenceValue):"geoPointValue"in t?function(n){return`geo(${n.latitude},${n.longitude})`}(t.geoPointValue):"arrayValue"in t?function(n){let r="[",c=!0;for(const d of n.values||[])c?c=!1:r+=",",r+=Hk(d);return r+"]"}(t.arrayValue):"mapValue"in t?function(n){const r=Object.keys(n.fields||{}).sort();let c="{",d=!0;for(const m of r)d?d=!1:c+=",",c+=`${m}:${Hk(n.fields[m])}`;return c+"}"}(t.mapValue):Zi(61005,{value:t})}function qR(t){switch(Jv(t)){case 0:case 1:return 4;case 2:return 8;case 3:case 8:return 16;case 4:const e=$I(t);return e?16+qR(e):16;case 5:return 2*t.stringValue.length;case 6:return Kv(t.bytesValue).approximateByteSize();case 7:return t.referenceValue.length;case 9:return function(r){return(r.values||[]).reduce((c,d)=>c+qR(d),0)}(t.arrayValue);case 10:case 11:return function(r){let c=0;return c0(r.fields,(d,m)=>{c+=d.length+qR(m)}),c}(t.mapValue);default:throw Zi(13486,{value:t})}}function M3(t,e){return{referenceValue:`projects/${t.projectId}/databases/${t.database}/documents/${e.path.canonicalString()}`}}function $k(t){return!!t&&"integerValue"in t}function D2(t){return!!t&&"arrayValue"in t}function P3(t){return!!t&&"nullValue"in t}function k3(t){return!!t&&"doubleValue"in t&&isNaN(Number(t.doubleValue))}function WR(t){return!!t&&"mapValue"in t}function une(t){var e,n;return((n=(((e=t==null?void 0:t.mapValue)===null||e===void 0?void 0:e.fields)||{})[Bj])===null||n===void 0?void 0:n.stringValue)===Fj}function jS(t){if(t.geoPointValue)return{geoPointValue:Object.assign({},t.geoPointValue)};if(t.timestampValue&&typeof t.timestampValue=="object")return{timestampValue:Object.assign({},t.timestampValue)};if(t.mapValue){const e={mapValue:{fields:{}}};return c0(t.mapValue.fields,(n,r)=>e.mapValue.fields[n]=jS(r)),e}if(t.arrayValue){const e={arrayValue:{values:[]}};for(let n=0;n<(t.arrayValue.values||[]).length;++n)e.arrayValue.values[n]=jS(t.arrayValue.values[n]);return e}return Object.assign({},t)}function hne(t){return(((t.mapValue||{}).fields||{}).__type__||{}).stringValue===cne}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ju{constructor(e){this.value=e}static empty(){return new ju({mapValue:{}})}field(e){if(e.isEmpty())return this.value;{let n=this.value;for(let r=0;r<e.length-1;++r)if(n=(n.mapValue.fields||{})[e.get(r)],!WR(n))return null;return n=(n.mapValue.fields||{})[e.lastSegment()],n||null}}set(e,n){this.getFieldsMap(e.popLast())[e.lastSegment()]=jS(n)}setAll(e){let n=Ql.emptyPath(),r={},c=[];e.forEach((m,s)=>{if(!n.isImmediateParentOf(s)){const T=this.getFieldsMap(n);this.applyChanges(T,r,c),r={},c=[],n=s.popLast()}m?r[s.lastSegment()]=jS(m):c.push(s.lastSegment())});const d=this.getFieldsMap(n);this.applyChanges(d,r,c)}delete(e){const n=this.field(e.popLast());WR(n)&&n.mapValue.fields&&delete n.mapValue.fields[e.lastSegment()]}isEqual(e){return Wm(this.value,e.value)}getFieldsMap(e){let n=this.value;n.mapValue.fields||(n.mapValue={fields:{}});for(let r=0;r<e.length;++r){let c=n.mapValue.fields[e.get(r)];WR(c)&&c.mapValue.fields||(c={mapValue:{fields:{}}},n.mapValue.fields[e.get(r)]=c),n=c}return n.mapValue.fields}applyChanges(e,n,r){c0(n,(c,d)=>e[c]=d);for(const c of r)delete e[c]}clone(){return new ju(jS(this.value))}}function Vj(t){const e=[];return c0(t.fields,(n,r)=>{const c=new Ql([n]);if(WR(r)){const d=Vj(r.mapValue).fields;if(d.length===0)e.push(c);else for(const m of d)e.push(c.child(m))}else e.push(c)}),new Gh(e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Nc{constructor(e,n,r,c,d,m,s){this.key=e,this.documentType=n,this.version=r,this.readTime=c,this.createTime=d,this.data=m,this.documentState=s}static newInvalidDocument(e){return new Nc(e,0,or.min(),or.min(),or.min(),ju.empty(),0)}static newFoundDocument(e,n,r,c){return new Nc(e,1,n,or.min(),r,c,0)}static newNoDocument(e,n){return new Nc(e,2,n,or.min(),or.min(),ju.empty(),0)}static newUnknownDocument(e,n){return new Nc(e,3,n,or.min(),or.min(),ju.empty(),2)}convertToFoundDocument(e,n){return!this.createTime.isEqual(or.min())||this.documentType!==2&&this.documentType!==0||(this.createTime=e),this.version=e,this.documentType=1,this.data=n,this.documentState=0,this}convertToNoDocument(e){return this.version=e,this.documentType=2,this.data=ju.empty(),this.documentState=0,this}convertToUnknownDocument(e){return this.version=e,this.documentType=3,this.data=ju.empty(),this.documentState=2,this}setHasCommittedMutations(){return this.documentState=2,this}setHasLocalMutations(){return this.documentState=1,this.version=or.min(),this}setReadTime(e){return this.readTime=e,this}get hasLocalMutations(){return this.documentState===1}get hasCommittedMutations(){return this.documentState===2}get hasPendingWrites(){return this.hasLocalMutations||this.hasCommittedMutations}isValidDocument(){return this.documentType!==0}isFoundDocument(){return this.documentType===1}isNoDocument(){return this.documentType===2}isUnknownDocument(){return this.documentType===3}isEqual(e){return e instanceof Nc&&this.key.isEqual(e.key)&&this.version.isEqual(e.version)&&this.documentType===e.documentType&&this.documentState===e.documentState&&this.data.isEqual(e.data)}mutableCopy(){return new Nc(this.key,this.documentType,this.version,this.readTime,this.createTime,this.data.clone(),this.documentState)}toString(){return`Document(${this.key}, ${this.version}, ${JSON.stringify(this.data.value)}, {createTime: ${this.createTime}}), {documentType: ${this.documentType}}), {documentState: ${this.documentState}})`}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class MO{constructor(e,n){this.position=e,this.inclusive=n}}function N3(t,e,n){let r=0;for(let c=0;c<t.position.length;c++){const d=e[c],m=t.position[c];if(d.field.isKeyField()?r=Ni.comparator(Ni.fromName(m.referenceValue),n.key):r=eT(m,n.data.field(d.field)),d.dir==="desc"&&(r*=-1),r!==0)break}return r}function L3(t,e){if(t===null)return e===null;if(e===null||t.inclusive!==e.inclusive||t.position.length!==e.position.length)return!1;for(let n=0;n<t.position.length;n++)if(!Wm(t.position[n],e.position[n]))return!1;return!0}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class PO{constructor(e,n="asc"){this.field=e,this.dir=n}}function dne(t,e){return t.dir===e.dir&&t.field.isEqual(e.field)}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Uj{}class Ba extends Uj{constructor(e,n,r){super(),this.field=e,this.op=n,this.value=r}static create(e,n,r){return e.isKeyField()?n==="in"||n==="not-in"?this.createKeyFieldInFilter(e,n,r):new pne(e,n,r):n==="array-contains"?new _ne(e,r):n==="in"?new yne(e,r):n==="not-in"?new vne(e,r):n==="array-contains-any"?new bne(e,r):new Ba(e,n,r)}static createKeyFieldInFilter(e,n,r){return n==="in"?new mne(e,r):new gne(e,r)}matches(e){const n=e.data.field(this.field);return this.op==="!="?n!==null&&n.nullValue===void 0&&this.matchesComparison(eT(n,this.value)):n!==null&&Jv(this.value)===Jv(n)&&this.matchesComparison(eT(n,this.value))}matchesComparison(e){switch(this.op){case"<":return e<0;case"<=":return e<=0;case"==":return e===0;case"!=":return e!==0;case">":return e>0;case">=":return e>=0;default:return Zi(47266,{operator:this.op})}}isInequality(){return["<","<=",">",">=","!=","not-in"].indexOf(this.op)>=0}getFlattenedFilters(){return[this]}getFilters(){return[this]}}class yp extends Uj{constructor(e,n){super(),this.filters=e,this.op=n,this.Te=null}static create(e,n){return new yp(e,n)}matches(e){return jj(this)?this.filters.find(n=>!n.matches(e))===void 0:this.filters.find(n=>n.matches(e))!==void 0}getFlattenedFilters(){return this.Te!==null||(this.Te=this.filters.reduce((e,n)=>e.concat(n.getFlattenedFilters()),[])),this.Te}getFilters(){return Object.assign([],this.filters)}}function jj(t){return t.op==="and"}function Hj(t){return fne(t)&&jj(t)}function fne(t){for(const e of t.filters)if(e instanceof yp)return!1;return!0}function Gk(t){if(t instanceof Ba)return t.field.canonicalString()+t.op.toString()+tT(t.value);if(Hj(t))return t.filters.map(e=>Gk(e)).join(",");{const e=t.filters.map(n=>Gk(n)).join(",");return`${t.op}(${e})`}}function $j(t,e){return t instanceof Ba?function(r,c){return c instanceof Ba&&r.op===c.op&&r.field.isEqual(c.field)&&Wm(r.value,c.value)}(t,e):t instanceof yp?function(r,c){return c instanceof yp&&r.op===c.op&&r.filters.length===c.filters.length?r.filters.reduce((d,m,s)=>d&&$j(m,c.filters[s]),!0):!1}(t,e):void Zi(19439)}function Gj(t){return t instanceof Ba?function(n){return`${n.field.canonicalString()} ${n.op} ${tT(n.value)}`}(t):t instanceof yp?function(n){return n.op.toString()+" {"+n.getFilters().map(Gj).join(" ,")+"}"}(t):"Filter"}class pne extends Ba{constructor(e,n,r){super(e,n,r),this.key=Ni.fromName(r.referenceValue)}matches(e){const n=Ni.comparator(e.key,this.key);return this.matchesComparison(n)}}class mne extends Ba{constructor(e,n){super(e,"in",n),this.keys=qj("in",n)}matches(e){return this.keys.some(n=>n.isEqual(e.key))}}class gne extends Ba{constructor(e,n){super(e,"not-in",n),this.keys=qj("not-in",n)}matches(e){return!this.keys.some(n=>n.isEqual(e.key))}}function qj(t,e){var n;return(((n=e.arrayValue)===null||n===void 0?void 0:n.values)||[]).map(r=>Ni.fromName(r.referenceValue))}class _ne extends Ba{constructor(e,n){super(e,"array-contains",n)}matches(e){const n=e.data.field(this.field);return D2(n)&&gA(n.arrayValue,this.value)}}class yne extends Ba{constructor(e,n){super(e,"in",n)}matches(e){const n=e.data.field(this.field);return n!==null&&gA(this.value.arrayValue,n)}}class vne extends Ba{constructor(e,n){super(e,"not-in",n)}matches(e){if(gA(this.value.arrayValue,{nullValue:"NULL_VALUE"}))return!1;const n=e.data.field(this.field);return n!==null&&n.nullValue===void 0&&!gA(this.value.arrayValue,n)}}class bne extends Ba{constructor(e,n){super(e,"array-contains-any",n)}matches(e){const n=e.data.field(this.field);return!(!D2(n)||!n.arrayValue.values)&&n.arrayValue.values.some(r=>gA(this.value.arrayValue,r))}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xne{constructor(e,n=null,r=[],c=[],d=null,m=null,s=null){this.path=e,this.collectionGroup=n,this.orderBy=r,this.filters=c,this.limit=d,this.startAt=m,this.endAt=s,this.Ie=null}}function z3(t,e=null,n=[],r=[],c=null,d=null,m=null){return new xne(t,e,n,r,c,d,m)}function R2(t){const e=ar(t);if(e.Ie===null){let n=e.path.canonicalString();e.collectionGroup!==null&&(n+="|cg:"+e.collectionGroup),n+="|f:",n+=e.filters.map(r=>Gk(r)).join(","),n+="|ob:",n+=e.orderBy.map(r=>function(d){return d.field.canonicalString()+d.dir}(r)).join(","),HI(e.limit)||(n+="|l:",n+=e.limit),e.startAt&&(n+="|lb:",n+=e.startAt.inclusive?"b:":"a:",n+=e.startAt.position.map(r=>tT(r)).join(",")),e.endAt&&(n+="|ub:",n+=e.endAt.inclusive?"a:":"b:",n+=e.endAt.position.map(r=>tT(r)).join(",")),e.Ie=n}return e.Ie}function O2(t,e){if(t.limit!==e.limit||t.orderBy.length!==e.orderBy.length)return!1;for(let n=0;n<t.orderBy.length;n++)if(!dne(t.orderBy[n],e.orderBy[n]))return!1;if(t.filters.length!==e.filters.length)return!1;for(let n=0;n<t.filters.length;n++)if(!$j(t.filters[n],e.filters[n]))return!1;return t.collectionGroup===e.collectionGroup&&!!t.path.isEqual(e.path)&&!!L3(t.startAt,e.startAt)&&L3(t.endAt,e.endAt)}function qk(t){return Ni.isDocumentKey(t.path)&&t.collectionGroup===null&&t.filters.length===0}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YA{constructor(e,n=null,r=[],c=[],d=null,m="F",s=null,T=null){this.path=e,this.collectionGroup=n,this.explicitOrderBy=r,this.filters=c,this.limit=d,this.limitType=m,this.startAt=s,this.endAt=T,this.Ee=null,this.de=null,this.Ae=null,this.startAt,this.endAt}}function wne(t,e,n,r,c,d,m,s){return new YA(t,e,n,r,c,d,m,s)}function GI(t){return new YA(t)}function B3(t){return t.filters.length===0&&t.limit===null&&t.startAt==null&&t.endAt==null&&(t.explicitOrderBy.length===0||t.explicitOrderBy.length===1&&t.explicitOrderBy[0].field.isKeyField())}function Wj(t){return t.collectionGroup!==null}function HS(t){const e=ar(t);if(e.Ee===null){e.Ee=[];const n=new Set;for(const d of e.explicitOrderBy)e.Ee.push(d),n.add(d.field.canonicalString());const r=e.explicitOrderBy.length>0?e.explicitOrderBy[e.explicitOrderBy.length-1].dir:"asc";(function(m){let s=new al(Ql.comparator);return m.filters.forEach(T=>{T.getFlattenedFilters().forEach(D=>{D.isInequality()&&(s=s.add(D.field))})}),s})(e).forEach(d=>{n.has(d.canonicalString())||d.isKeyField()||e.Ee.push(new PO(d,r))}),n.has(Ql.keyField().canonicalString())||e.Ee.push(new PO(Ql.keyField(),r))}return e.Ee}function Hm(t){const e=ar(t);return e.de||(e.de=Tne(e,HS(t))),e.de}function Tne(t,e){if(t.limitType==="F")return z3(t.path,t.collectionGroup,e,t.filters,t.limit,t.startAt,t.endAt);{e=e.map(c=>{const d=c.dir==="desc"?"asc":"desc";return new PO(c.field,d)});const n=t.endAt?new MO(t.endAt.position,t.endAt.inclusive):null,r=t.startAt?new MO(t.startAt.position,t.startAt.inclusive):null;return z3(t.path,t.collectionGroup,e,t.filters,t.limit,n,r)}}function Wk(t,e){const n=t.filters.concat([e]);return new YA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),n,t.limit,t.limitType,t.startAt,t.endAt)}function Yk(t,e,n){return new YA(t.path,t.collectionGroup,t.explicitOrderBy.slice(),t.filters.slice(),e,n,t.startAt,t.endAt)}function qI(t,e){return O2(Hm(t),Hm(e))&&t.limitType===e.limitType}function Yj(t){return`${R2(Hm(t))}|lt:${t.limitType}`}function Tw(t){return`Query(target=${function(n){let r=n.path.canonicalString();return n.collectionGroup!==null&&(r+=" collectionGroup="+n.collectionGroup),n.filters.length>0&&(r+=`, filters: [${n.filters.map(c=>Gj(c)).join(", ")}]`),HI(n.limit)||(r+=", limit: "+n.limit),n.orderBy.length>0&&(r+=`, orderBy: [${n.orderBy.map(c=>function(m){return`${m.field.canonicalString()} (${m.dir})`}(c)).join(", ")}]`),n.startAt&&(r+=", startAt: ",r+=n.startAt.inclusive?"b:":"a:",r+=n.startAt.position.map(c=>tT(c)).join(",")),n.endAt&&(r+=", endAt: ",r+=n.endAt.inclusive?"a:":"b:",r+=n.endAt.position.map(c=>tT(c)).join(",")),`Target(${r})`}(Hm(t))}; limitType=${t.limitType})`}function WI(t,e){return e.isFoundDocument()&&function(r,c){const d=c.key.path;return r.collectionGroup!==null?c.key.hasCollectionId(r.collectionGroup)&&r.path.isPrefixOf(d):Ni.isDocumentKey(r.path)?r.path.isEqual(d):r.path.isImmediateParentOf(d)}(t,e)&&function(r,c){for(const d of HS(r))if(!d.field.isKeyField()&&c.data.field(d.field)===null)return!1;return!0}(t,e)&&function(r,c){for(const d of r.filters)if(!d.matches(c))return!1;return!0}(t,e)&&function(r,c){return!(r.startAt&&!function(m,s,T){const D=N3(m,s,T);return m.inclusive?D<=0:D<0}(r.startAt,HS(r),c)||r.endAt&&!function(m,s,T){const D=N3(m,s,T);return m.inclusive?D>=0:D>0}(r.endAt,HS(r),c))}(t,e)}function Ene(t){return t.collectionGroup||(t.path.length%2==1?t.path.lastSegment():t.path.get(t.path.length-2))}function Zj(t){return(e,n)=>{let r=!1;for(const c of HS(t)){const d=Sne(c,e,n);if(d!==0)return d;r=r||c.field.isKeyField()}return 0}}function Sne(t,e,n){const r=t.field.isKeyField()?Ni.comparator(e.key,n.key):function(d,m,s){const T=m.data.field(d),D=s.data.field(d);return T!==null&&D!==null?eT(T,D):Zi(42886)}(t.field,e,n);switch(t.dir){case"asc":return r;case"desc":return-1*r;default:return Zi(19790,{direction:t.dir})}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rx{constructor(e,n){this.mapKeyFn=e,this.equalsFn=n,this.inner={},this.innerSize=0}get(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r!==void 0){for(const[c,d]of r)if(this.equalsFn(c,e))return d}}has(e){return this.get(e)!==void 0}set(e,n){const r=this.mapKeyFn(e),c=this.inner[r];if(c===void 0)return this.inner[r]=[[e,n]],void this.innerSize++;for(let d=0;d<c.length;d++)if(this.equalsFn(c[d][0],e))return void(c[d]=[e,n]);c.push([e,n]),this.innerSize++}delete(e){const n=this.mapKeyFn(e),r=this.inner[n];if(r===void 0)return!1;for(let c=0;c<r.length;c++)if(this.equalsFn(r[c][0],e))return r.length===1?delete this.inner[n]:r.splice(c,1),this.innerSize--,!0;return!1}forEach(e){c0(this.inner,(n,r)=>{for(const[c,d]of r)e(c,d)})}isEmpty(){return Mj(this.inner)}size(){return this.innerSize}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ane=new Bo(Ni.comparator);function O_(){return Ane}const Xj=new Bo(Ni.comparator);function DS(...t){let e=Xj;for(const n of t)e=e.insert(n.key,n);return e}function Qj(t){let e=Xj;return t.forEach((n,r)=>e=e.insert(n,r.overlayedDocument)),e}function sx(){return $S()}function Kj(){return $S()}function $S(){return new Rx(t=>t.toString(),(t,e)=>t.isEqual(e))}const Cne=new Bo(Ni.comparator),Dne=new al(Ni.comparator);function Qr(...t){let e=Dne;for(const n of t)e=e.add(n);return e}const Rne=new al(Fr);function One(){return Rne}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function I2(t,e){if(t.useProto3Json){if(isNaN(e))return{doubleValue:"NaN"};if(e===1/0)return{doubleValue:"Infinity"};if(e===-1/0)return{doubleValue:"-Infinity"}}return{doubleValue:RO(e)?"-0":e}}function Jj(t){return{integerValue:""+t}}function Ine(t,e){return rne(e)?Jj(e):I2(t,e)}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class YI{constructor(){this._=void 0}}function Mne(t,e,n){return t instanceof kO?function(c,d){const m={fields:{[Nj]:{stringValue:kj},[zj]:{timestampValue:{seconds:c.seconds,nanos:c.nanoseconds}}}};return d&&C2(d)&&(d=$I(d)),d&&(m.fields[Lj]=d),{mapValue:m}}(n,e):t instanceof nT?t6(t,e):t instanceof iT?n6(t,e):function(c,d){const m=e6(c,d),s=F3(m)+F3(c.Re);return $k(m)&&$k(c.Re)?Jj(s):I2(c.serializer,s)}(t,e)}function Pne(t,e,n){return t instanceof nT?t6(t,e):t instanceof iT?n6(t,e):n}function e6(t,e){return t instanceof NO?function(r){return $k(r)||function(d){return!!d&&"doubleValue"in d}(r)}(e)?e:{integerValue:0}:null}class kO extends YI{}class nT extends YI{constructor(e){super(),this.elements=e}}function t6(t,e){const n=i6(e);for(const r of t.elements)n.some(c=>Wm(c,r))||n.push(r);return{arrayValue:{values:n}}}class iT extends YI{constructor(e){super(),this.elements=e}}function n6(t,e){let n=i6(e);for(const r of t.elements)n=n.filter(c=>!Wm(c,r));return{arrayValue:{values:n}}}class NO extends YI{constructor(e,n){super(),this.serializer=e,this.Re=n}}function F3(t){return ma(t.integerValue||t.doubleValue)}function i6(t){return D2(t)&&t.arrayValue.values?t.arrayValue.values.slice():[]}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class r6{constructor(e,n){this.field=e,this.transform=n}}function kne(t,e){return t.field.isEqual(e.field)&&function(r,c){return r instanceof nT&&c instanceof nT||r instanceof iT&&c instanceof iT?Jw(r.elements,c.elements,Wm):r instanceof NO&&c instanceof NO?Wm(r.Re,c.Re):r instanceof kO&&c instanceof kO}(t.transform,e.transform)}class Nne{constructor(e,n){this.version=e,this.transformResults=n}}class mp{constructor(e,n){this.updateTime=e,this.exists=n}static none(){return new mp}static exists(e){return new mp(void 0,e)}static updateTime(e){return new mp(e)}get isNone(){return this.updateTime===void 0&&this.exists===void 0}isEqual(e){return this.exists===e.exists&&(this.updateTime?!!e.updateTime&&this.updateTime.isEqual(e.updateTime):!e.updateTime)}}function YR(t,e){return t.updateTime!==void 0?e.isFoundDocument()&&e.version.isEqual(t.updateTime):t.exists===void 0||t.exists===e.isFoundDocument()}class ZI{}function s6(t,e){if(!t.hasLocalMutations||e&&e.fields.length===0)return null;if(e===null)return t.isNoDocument()?new M2(t.key,mp.none()):new ZA(t.key,t.data,mp.none());{const n=t.data,r=ju.empty();let c=new al(Ql.comparator);for(let d of e.fields)if(!c.has(d)){let m=n.field(d);m===null&&d.length>1&&(d=d.popLast(),m=n.field(d)),m===null?r.delete(d):r.set(d,m),c=c.add(d)}return new u0(t.key,r,new Gh(c.toArray()),mp.none())}}function Lne(t,e,n){t instanceof ZA?function(c,d,m){const s=c.value.clone(),T=U3(c.fieldTransforms,d,m.transformResults);s.setAll(T),d.convertToFoundDocument(m.version,s).setHasCommittedMutations()}(t,e,n):t instanceof u0?function(c,d,m){if(!YR(c.precondition,d))return void d.convertToUnknownDocument(m.version);const s=U3(c.fieldTransforms,d,m.transformResults),T=d.data;T.setAll(o6(c)),T.setAll(s),d.convertToFoundDocument(m.version,T).setHasCommittedMutations()}(t,e,n):function(c,d,m){d.convertToNoDocument(m.version).setHasCommittedMutations()}(0,e,n)}function GS(t,e,n,r){return t instanceof ZA?function(d,m,s,T){if(!YR(d.precondition,m))return s;const D=d.value.clone(),P=j3(d.fieldTransforms,T,m);return D.setAll(P),m.convertToFoundDocument(m.version,D).setHasLocalMutations(),null}(t,e,n,r):t instanceof u0?function(d,m,s,T){if(!YR(d.precondition,m))return s;const D=j3(d.fieldTransforms,T,m),P=m.data;return P.setAll(o6(d)),P.setAll(D),m.convertToFoundDocument(m.version,P).setHasLocalMutations(),s===null?null:s.unionWith(d.fieldMask.fields).unionWith(d.fieldTransforms.map(z=>z.field))}(t,e,n,r):function(d,m,s){return YR(d.precondition,m)?(m.convertToNoDocument(m.version).setHasLocalMutations(),null):s}(t,e,n)}function zne(t,e){let n=null;for(const r of t.fieldTransforms){const c=e.data.field(r.field),d=e6(r.transform,c||null);d!=null&&(n===null&&(n=ju.empty()),n.set(r.field,d))}return n||null}function V3(t,e){return t.type===e.type&&!!t.key.isEqual(e.key)&&!!t.precondition.isEqual(e.precondition)&&!!function(r,c){return r===void 0&&c===void 0||!(!r||!c)&&Jw(r,c,(d,m)=>kne(d,m))}(t.fieldTransforms,e.fieldTransforms)&&(t.type===0?t.value.isEqual(e.value):t.type!==1||t.data.isEqual(e.data)&&t.fieldMask.isEqual(e.fieldMask))}class ZA extends ZI{constructor(e,n,r,c=[]){super(),this.key=e,this.value=n,this.precondition=r,this.fieldTransforms=c,this.type=0}getFieldMask(){return null}}class u0 extends ZI{constructor(e,n,r,c,d=[]){super(),this.key=e,this.data=n,this.fieldMask=r,this.precondition=c,this.fieldTransforms=d,this.type=1}getFieldMask(){return this.fieldMask}}function o6(t){const e=new Map;return t.fieldMask.fields.forEach(n=>{if(!n.isEmpty()){const r=t.data.field(n);e.set(n,r)}}),e}function U3(t,e,n){const r=new Map;Ps(t.length===n.length,32656,{Ve:n.length,me:t.length});for(let c=0;c<n.length;c++){const d=t[c],m=d.transform,s=e.data.field(d.field);r.set(d.field,Pne(m,s,n[c]))}return r}function j3(t,e,n){const r=new Map;for(const c of t){const d=c.transform,m=n.data.field(c.field);r.set(c.field,Mne(d,m,e))}return r}class M2 extends ZI{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=2,this.fieldTransforms=[]}getFieldMask(){return null}}class Bne extends ZI{constructor(e,n){super(),this.key=e,this.precondition=n,this.type=3,this.fieldTransforms=[]}getFieldMask(){return null}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Fne{constructor(e,n,r,c){this.batchId=e,this.localWriteTime=n,this.baseMutations=r,this.mutations=c}applyToRemoteDocument(e,n){const r=n.mutationResults;for(let c=0;c<this.mutations.length;c++){const d=this.mutations[c];d.key.isEqual(e.key)&&Lne(d,e,r[c])}}applyToLocalView(e,n){for(const r of this.baseMutations)r.key.isEqual(e.key)&&(n=GS(r,e,n,this.localWriteTime));for(const r of this.mutations)r.key.isEqual(e.key)&&(n=GS(r,e,n,this.localWriteTime));return n}applyToLocalDocumentSet(e,n){const r=Kj();return this.mutations.forEach(c=>{const d=e.get(c.key),m=d.overlayedDocument;let s=this.applyToLocalView(m,d.mutatedFields);s=n.has(c.key)?null:s;const T=s6(m,s);T!==null&&r.set(c.key,T),m.isValidDocument()||m.convertToNoDocument(or.min())}),r}keys(){return this.mutations.reduce((e,n)=>e.add(n.key),Qr())}isEqual(e){return this.batchId===e.batchId&&Jw(this.mutations,e.mutations,(n,r)=>V3(n,r))&&Jw(this.baseMutations,e.baseMutations,(n,r)=>V3(n,r))}}class P2{constructor(e,n,r,c){this.batch=e,this.commitVersion=n,this.mutationResults=r,this.docVersions=c}static from(e,n,r){Ps(e.mutations.length===r.length,58842,{fe:e.mutations.length,ge:r.length});let c=function(){return Cne}();const d=e.mutations;for(let m=0;m<d.length;m++)c=c.insert(d[m].key,r[m].version);return new P2(e,n,r,c)}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vne{constructor(e,n){this.largestBatchId=e,this.mutation=n}getKey(){return this.mutation.key}isEqual(e){return e!==null&&this.mutation===e.mutation}toString(){return`Overlay{
      largestBatchId: ${this.largestBatchId},
      mutation: ${this.mutation.toString()}
    }`}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Une{constructor(e,n){this.count=e,this.unchangedNames=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */var La,ds;function jne(t){switch(t){case In.OK:return Zi(64938);case In.CANCELLED:case In.UNKNOWN:case In.DEADLINE_EXCEEDED:case In.RESOURCE_EXHAUSTED:case In.INTERNAL:case In.UNAVAILABLE:case In.UNAUTHENTICATED:return!1;case In.INVALID_ARGUMENT:case In.NOT_FOUND:case In.ALREADY_EXISTS:case In.PERMISSION_DENIED:case In.FAILED_PRECONDITION:case In.ABORTED:case In.OUT_OF_RANGE:case In.UNIMPLEMENTED:case In.DATA_LOSS:return!0;default:return Zi(15467,{code:t})}}function a6(t){if(t===void 0)return R_("GRPC error has no .code"),In.UNKNOWN;switch(t){case La.OK:return In.OK;case La.CANCELLED:return In.CANCELLED;case La.UNKNOWN:return In.UNKNOWN;case La.DEADLINE_EXCEEDED:return In.DEADLINE_EXCEEDED;case La.RESOURCE_EXHAUSTED:return In.RESOURCE_EXHAUSTED;case La.INTERNAL:return In.INTERNAL;case La.UNAVAILABLE:return In.UNAVAILABLE;case La.UNAUTHENTICATED:return In.UNAUTHENTICATED;case La.INVALID_ARGUMENT:return In.INVALID_ARGUMENT;case La.NOT_FOUND:return In.NOT_FOUND;case La.ALREADY_EXISTS:return In.ALREADY_EXISTS;case La.PERMISSION_DENIED:return In.PERMISSION_DENIED;case La.FAILED_PRECONDITION:return In.FAILED_PRECONDITION;case La.ABORTED:return In.ABORTED;case La.OUT_OF_RANGE:return In.OUT_OF_RANGE;case La.UNIMPLEMENTED:return In.UNIMPLEMENTED;case La.DATA_LOSS:return In.DATA_LOSS;default:return Zi(39323,{code:t})}}(ds=La||(La={}))[ds.OK=0]="OK",ds[ds.CANCELLED=1]="CANCELLED",ds[ds.UNKNOWN=2]="UNKNOWN",ds[ds.INVALID_ARGUMENT=3]="INVALID_ARGUMENT",ds[ds.DEADLINE_EXCEEDED=4]="DEADLINE_EXCEEDED",ds[ds.NOT_FOUND=5]="NOT_FOUND",ds[ds.ALREADY_EXISTS=6]="ALREADY_EXISTS",ds[ds.PERMISSION_DENIED=7]="PERMISSION_DENIED",ds[ds.UNAUTHENTICATED=16]="UNAUTHENTICATED",ds[ds.RESOURCE_EXHAUSTED=8]="RESOURCE_EXHAUSTED",ds[ds.FAILED_PRECONDITION=9]="FAILED_PRECONDITION",ds[ds.ABORTED=10]="ABORTED",ds[ds.OUT_OF_RANGE=11]="OUT_OF_RANGE",ds[ds.UNIMPLEMENTED=12]="UNIMPLEMENTED",ds[ds.INTERNAL=13]="INTERNAL",ds[ds.UNAVAILABLE=14]="UNAVAILABLE",ds[ds.DATA_LOSS=15]="DATA_LOSS";/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Hne=new Hv([4294967295,4294967295],0);function H3(t){const e=Rj().encode(t),n=new xj;return n.update(e),new Uint8Array(n.digest())}function $3(t){const e=new DataView(t.buffer),n=e.getUint32(0,!0),r=e.getUint32(4,!0),c=e.getUint32(8,!0),d=e.getUint32(12,!0);return[new Hv([n,r],0),new Hv([c,d],0)]}class k2{constructor(e,n,r){if(this.bitmap=e,this.padding=n,this.hashCount=r,n<0||n>=8)throw new RS(`Invalid padding: ${n}`);if(r<0)throw new RS(`Invalid hash count: ${r}`);if(e.length>0&&this.hashCount===0)throw new RS(`Invalid hash count: ${r}`);if(e.length===0&&n!==0)throw new RS(`Invalid padding when bitmap length is 0: ${n}`);this.pe=8*e.length-n,this.ye=Hv.fromNumber(this.pe)}we(e,n,r){let c=e.add(n.multiply(Hv.fromNumber(r)));return c.compare(Hne)===1&&(c=new Hv([c.getBits(0),c.getBits(1)],0)),c.modulo(this.ye).toNumber()}be(e){return!!(this.bitmap[Math.floor(e/8)]&1<<e%8)}mightContain(e){if(this.pe===0)return!1;const n=H3(e),[r,c]=$3(n);for(let d=0;d<this.hashCount;d++){const m=this.we(r,c,d);if(!this.be(m))return!1}return!0}static create(e,n,r){const c=e%8==0?0:8-e%8,d=new Uint8Array(Math.ceil(e/8)),m=new k2(d,c,n);return r.forEach(s=>m.insert(s)),m}insert(e){if(this.pe===0)return;const n=H3(e),[r,c]=$3(n);for(let d=0;d<this.hashCount;d++){const m=this.we(r,c,d);this.Se(m)}}Se(e){const n=Math.floor(e/8),r=e%8;this.bitmap[n]|=1<<r}}class RS extends Error{constructor(){super(...arguments),this.name="BloomFilterError"}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class XI{constructor(e,n,r,c,d){this.snapshotVersion=e,this.targetChanges=n,this.targetMismatches=r,this.documentUpdates=c,this.resolvedLimboDocuments=d}static createSynthesizedRemoteEventForCurrentChange(e,n,r){const c=new Map;return c.set(e,XA.createSynthesizedTargetChangeForCurrentChange(e,n,r)),new XI(or.min(),c,new Bo(Fr),O_(),Qr())}}class XA{constructor(e,n,r,c,d){this.resumeToken=e,this.current=n,this.addedDocuments=r,this.modifiedDocuments=c,this.removedDocuments=d}static createSynthesizedTargetChangeForCurrentChange(e,n,r){return new XA(r,n,Qr(),Qr(),Qr())}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class ZR{constructor(e,n,r,c){this.De=e,this.removedTargetIds=n,this.key=r,this.ve=c}}class l6{constructor(e,n){this.targetId=e,this.Ce=n}}class c6{constructor(e,n,r=Kl.EMPTY_BYTE_STRING,c=null){this.state=e,this.targetIds=n,this.resumeToken=r,this.cause=c}}class G3{constructor(){this.Fe=0,this.Me=q3(),this.xe=Kl.EMPTY_BYTE_STRING,this.Oe=!1,this.Ne=!0}get current(){return this.Oe}get resumeToken(){return this.xe}get Be(){return this.Fe!==0}get Le(){return this.Ne}ke(e){e.approximateByteSize()>0&&(this.Ne=!0,this.xe=e)}qe(){let e=Qr(),n=Qr(),r=Qr();return this.Me.forEach((c,d)=>{switch(d){case 0:e=e.add(c);break;case 2:n=n.add(c);break;case 1:r=r.add(c);break;default:Zi(38017,{changeType:d})}}),new XA(this.xe,this.Oe,e,n,r)}Qe(){this.Ne=!1,this.Me=q3()}$e(e,n){this.Ne=!0,this.Me=this.Me.insert(e,n)}Ue(e){this.Ne=!0,this.Me=this.Me.remove(e)}Ke(){this.Fe+=1}We(){this.Fe-=1,Ps(this.Fe>=0,3241,{Fe:this.Fe})}Ge(){this.Ne=!0,this.Oe=!0}}class $ne{constructor(e){this.ze=e,this.je=new Map,this.He=O_(),this.Je=oR(),this.Ye=oR(),this.Ze=new Bo(Fr)}Xe(e){for(const n of e.De)e.ve&&e.ve.isFoundDocument()?this.et(n,e.ve):this.tt(n,e.key,e.ve);for(const n of e.removedTargetIds)this.tt(n,e.key,e.ve)}nt(e){this.forEachTarget(e,n=>{const r=this.rt(n);switch(e.state){case 0:this.it(n)&&r.ke(e.resumeToken);break;case 1:r.We(),r.Be||r.Qe(),r.ke(e.resumeToken);break;case 2:r.We(),r.Be||this.removeTarget(n);break;case 3:this.it(n)&&(r.Ge(),r.ke(e.resumeToken));break;case 4:this.it(n)&&(this.st(n),r.ke(e.resumeToken));break;default:Zi(56790,{state:e.state})}})}forEachTarget(e,n){e.targetIds.length>0?e.targetIds.forEach(n):this.je.forEach((r,c)=>{this.it(c)&&n(c)})}ot(e){const n=e.targetId,r=e.Ce.count,c=this._t(n);if(c){const d=c.target;if(qk(d))if(r===0){const m=new Ni(d.path);this.tt(n,m,Nc.newNoDocument(m,or.min()))}else Ps(r===1,20013,{expectedCount:r});else{const m=this.ut(n);if(m!==r){const s=this.ct(e),T=s?this.lt(s,e,m):1;if(T!==0){this.st(n);const D=T===2?"TargetPurposeExistenceFilterMismatchBloom":"TargetPurposeExistenceFilterMismatch";this.Ze=this.Ze.insert(n,D)}}}}}ct(e){const n=e.Ce.unchangedNames;if(!n||!n.bits)return null;const{bits:{bitmap:r="",padding:c=0},hashCount:d=0}=n;let m,s;try{m=Kv(r).toUint8Array()}catch(T){if(T instanceof Pj)return Kw("Decoding the base64 bloom filter in existence filter failed ("+T.message+"); ignoring the bloom filter and falling back to full re-query."),null;throw T}try{s=new k2(m,c,d)}catch(T){return Kw(T instanceof RS?"BloomFilter error: ":"Applying bloom filter failed: ",T),null}return s.pe===0?null:s}lt(e,n,r){return n.Ce.count===r-this.Tt(e,n.targetId)?0:2}Tt(e,n){const r=this.ze.getRemoteKeysForTarget(n);let c=0;return r.forEach(d=>{const m=this.ze.Pt(),s=`projects/${m.projectId}/databases/${m.database}/documents/${d.path.canonicalString()}`;e.mightContain(s)||(this.tt(n,d,null),c++)}),c}It(e){const n=new Map;this.je.forEach((d,m)=>{const s=this._t(m);if(s){if(d.current&&qk(s.target)){const T=new Ni(s.target.path);this.Et(T).has(m)||this.dt(m,T)||this.tt(m,T,Nc.newNoDocument(T,e))}d.Le&&(n.set(m,d.qe()),d.Qe())}});let r=Qr();this.Ye.forEach((d,m)=>{let s=!0;m.forEachWhile(T=>{const D=this._t(T);return!D||D.purpose==="TargetPurposeLimboResolution"||(s=!1,!1)}),s&&(r=r.add(d))}),this.He.forEach((d,m)=>m.setReadTime(e));const c=new XI(e,n,this.Ze,this.He,r);return this.He=O_(),this.Je=oR(),this.Ye=oR(),this.Ze=new Bo(Fr),c}et(e,n){if(!this.it(e))return;const r=this.dt(e,n.key)?2:0;this.rt(e).$e(n.key,r),this.He=this.He.insert(n.key,n),this.Je=this.Je.insert(n.key,this.Et(n.key).add(e)),this.Ye=this.Ye.insert(n.key,this.At(n.key).add(e))}tt(e,n,r){if(!this.it(e))return;const c=this.rt(e);this.dt(e,n)?c.$e(n,1):c.Ue(n),this.Ye=this.Ye.insert(n,this.At(n).delete(e)),this.Ye=this.Ye.insert(n,this.At(n).add(e)),r&&(this.He=this.He.insert(n,r))}removeTarget(e){this.je.delete(e)}ut(e){const n=this.rt(e).qe();return this.ze.getRemoteKeysForTarget(e).size+n.addedDocuments.size-n.removedDocuments.size}Ke(e){this.rt(e).Ke()}rt(e){let n=this.je.get(e);return n||(n=new G3,this.je.set(e,n)),n}At(e){let n=this.Ye.get(e);return n||(n=new al(Fr),this.Ye=this.Ye.insert(e,n)),n}Et(e){let n=this.Je.get(e);return n||(n=new al(Fr),this.Je=this.Je.insert(e,n)),n}it(e){const n=this._t(e)!==null;return n||ui("WatchChangeAggregator","Detected inactive target",e),n}_t(e){const n=this.je.get(e);return n&&n.Be?null:this.ze.Rt(e)}st(e){this.je.set(e,new G3),this.ze.getRemoteKeysForTarget(e).forEach(n=>{this.tt(e,n,null)})}dt(e,n){return this.ze.getRemoteKeysForTarget(e).has(n)}}function oR(){return new Bo(Ni.comparator)}function q3(){return new Bo(Ni.comparator)}const Gne={asc:"ASCENDING",desc:"DESCENDING"},qne={"<":"LESS_THAN","<=":"LESS_THAN_OR_EQUAL",">":"GREATER_THAN",">=":"GREATER_THAN_OR_EQUAL","==":"EQUAL","!=":"NOT_EQUAL","array-contains":"ARRAY_CONTAINS",in:"IN","not-in":"NOT_IN","array-contains-any":"ARRAY_CONTAINS_ANY"},Wne={and:"AND",or:"OR"};class Yne{constructor(e,n){this.databaseId=e,this.useProto3Json=n}}function Zk(t,e){return t.useProto3Json||HI(e)?e:{value:e}}function LO(t,e){return t.useProto3Json?`${new Date(1e3*e.seconds).toISOString().replace(/\.\d*/,"").replace("Z","")}.${("000000000"+e.nanoseconds).slice(-9)}Z`:{seconds:""+e.seconds,nanos:e.nanoseconds}}function u6(t,e){return t.useProto3Json?e.toBase64():e.toUint8Array()}function Zne(t,e){return LO(t,e.toTimestamp())}function $m(t){return Ps(!!t,49232),or.fromTimestamp(function(n){const r=Qv(n);return new xo(r.seconds,r.nanos)}(t))}function N2(t,e){return Xk(t,e).canonicalString()}function Xk(t,e){const n=function(c){return new bo(["projects",c.projectId,"databases",c.database])}(t).child("documents");return e===void 0?n:n.child(e)}function h6(t){const e=bo.fromString(t);return Ps(g6(e),10190,{key:e.toString()}),e}function Qk(t,e){return N2(t.databaseId,e.path)}function DP(t,e){const n=h6(e);if(n.get(1)!==t.databaseId.projectId)throw new pi(In.INVALID_ARGUMENT,"Tried to deserialize key from different project: "+n.get(1)+" vs "+t.databaseId.projectId);if(n.get(3)!==t.databaseId.database)throw new pi(In.INVALID_ARGUMENT,"Tried to deserialize key from different database: "+n.get(3)+" vs "+t.databaseId.database);return new Ni(f6(n))}function d6(t,e){return N2(t.databaseId,e)}function Xne(t){const e=h6(t);return e.length===4?bo.emptyPath():f6(e)}function Kk(t){return new bo(["projects",t.databaseId.projectId,"databases",t.databaseId.database]).canonicalString()}function f6(t){return Ps(t.length>4&&t.get(4)==="documents",29091,{key:t.toString()}),t.popFirst(5)}function W3(t,e,n){return{name:Qk(t,e),fields:n.value.mapValue.fields}}function Qne(t,e){let n;if("targetChange"in e){e.targetChange;const r=function(D){return D==="NO_CHANGE"?0:D==="ADD"?1:D==="REMOVE"?2:D==="CURRENT"?3:D==="RESET"?4:Zi(39313,{state:D})}(e.targetChange.targetChangeType||"NO_CHANGE"),c=e.targetChange.targetIds||[],d=function(D,P){return D.useProto3Json?(Ps(P===void 0||typeof P=="string",58123),Kl.fromBase64String(P||"")):(Ps(P===void 0||P instanceof Buffer||P instanceof Uint8Array,16193),Kl.fromUint8Array(P||new Uint8Array))}(t,e.targetChange.resumeToken),m=e.targetChange.cause,s=m&&function(D){const P=D.code===void 0?In.UNKNOWN:a6(D.code);return new pi(P,D.message||"")}(m);n=new c6(r,c,d,s||null)}else if("documentChange"in e){e.documentChange;const r=e.documentChange;r.document,r.document.name,r.document.updateTime;const c=DP(t,r.document.name),d=$m(r.document.updateTime),m=r.document.createTime?$m(r.document.createTime):or.min(),s=new ju({mapValue:{fields:r.document.fields}}),T=Nc.newFoundDocument(c,d,m,s),D=r.targetIds||[],P=r.removedTargetIds||[];n=new ZR(D,P,T.key,T)}else if("documentDelete"in e){e.documentDelete;const r=e.documentDelete;r.document;const c=DP(t,r.document),d=r.readTime?$m(r.readTime):or.min(),m=Nc.newNoDocument(c,d),s=r.removedTargetIds||[];n=new ZR([],s,m.key,m)}else if("documentRemove"in e){e.documentRemove;const r=e.documentRemove;r.document;const c=DP(t,r.document),d=r.removedTargetIds||[];n=new ZR([],d,c,null)}else{if(!("filter"in e))return Zi(11601,{Vt:e});{e.filter;const r=e.filter;r.targetId;const{count:c=0,unchangedNames:d}=r,m=new Une(c,d),s=r.targetId;n=new l6(s,m)}}return n}function Kne(t,e){let n;if(e instanceof ZA)n={update:W3(t,e.key,e.value)};else if(e instanceof M2)n={delete:Qk(t,e.key)};else if(e instanceof u0)n={update:W3(t,e.key,e.data),updateMask:aie(e.fieldMask)};else{if(!(e instanceof Bne))return Zi(16599,{ft:e.type});n={verify:Qk(t,e.key)}}return e.fieldTransforms.length>0&&(n.updateTransforms=e.fieldTransforms.map(r=>function(d,m){const s=m.transform;if(s instanceof kO)return{fieldPath:m.field.canonicalString(),setToServerValue:"REQUEST_TIME"};if(s instanceof nT)return{fieldPath:m.field.canonicalString(),appendMissingElements:{values:s.elements}};if(s instanceof iT)return{fieldPath:m.field.canonicalString(),removeAllFromArray:{values:s.elements}};if(s instanceof NO)return{fieldPath:m.field.canonicalString(),increment:s.Re};throw Zi(20930,{transform:m.transform})}(0,r))),e.precondition.isNone||(n.currentDocument=function(c,d){return d.updateTime!==void 0?{updateTime:Zne(c,d.updateTime)}:d.exists!==void 0?{exists:d.exists}:Zi(27497)}(t,e.precondition)),n}function Jne(t,e){return t&&t.length>0?(Ps(e!==void 0,14353),t.map(n=>function(c,d){let m=c.updateTime?$m(c.updateTime):$m(d);return m.isEqual(or.min())&&(m=$m(d)),new Nne(m,c.transformResults||[])}(n,e))):[]}function eie(t,e){return{documents:[d6(t,e.path)]}}function tie(t,e){const n={structuredQuery:{}},r=e.path;let c;e.collectionGroup!==null?(c=r,n.structuredQuery.from=[{collectionId:e.collectionGroup,allDescendants:!0}]):(c=r.popLast(),n.structuredQuery.from=[{collectionId:r.lastSegment()}]),n.parent=d6(t,c);const d=function(D){if(D.length!==0)return m6(yp.create(D,"and"))}(e.filters);d&&(n.structuredQuery.where=d);const m=function(D){if(D.length!==0)return D.map(P=>function(F){return{field:Ew(F.field),direction:rie(F.dir)}}(P))}(e.orderBy);m&&(n.structuredQuery.orderBy=m);const s=Zk(t,e.limit);return s!==null&&(n.structuredQuery.limit=s),e.startAt&&(n.structuredQuery.startAt=function(D){return{before:D.inclusive,values:D.position}}(e.startAt)),e.endAt&&(n.structuredQuery.endAt=function(D){return{before:!D.inclusive,values:D.position}}(e.endAt)),{gt:n,parent:c}}function nie(t){let e=Xne(t.parent);const n=t.structuredQuery,r=n.from?n.from.length:0;let c=null;if(r>0){Ps(r===1,65062);const P=n.from[0];P.allDescendants?c=P.collectionId:e=e.child(P.collectionId)}let d=[];n.where&&(d=function(z){const F=p6(z);return F instanceof yp&&Hj(F)?F.getFilters():[F]}(n.where));let m=[];n.orderBy&&(m=function(z){return z.map(F=>function(J){return new PO(Sw(J.field),function(te){switch(te){case"ASCENDING":return"asc";case"DESCENDING":return"desc";default:return}}(J.direction))}(F))}(n.orderBy));let s=null;n.limit&&(s=function(z){let F;return F=typeof z=="object"?z.value:z,HI(F)?null:F}(n.limit));let T=null;n.startAt&&(T=function(z){const F=!!z.before,$=z.values||[];return new MO($,F)}(n.startAt));let D=null;return n.endAt&&(D=function(z){const F=!z.before,$=z.values||[];return new MO($,F)}(n.endAt)),wne(e,c,m,d,s,"F",T,D)}function iie(t,e){const n=function(c){switch(c){case"TargetPurposeListen":return null;case"TargetPurposeExistenceFilterMismatch":return"existence-filter-mismatch";case"TargetPurposeExistenceFilterMismatchBloom":return"existence-filter-mismatch-bloom";case"TargetPurposeLimboResolution":return"limbo-document";default:return Zi(28987,{purpose:c})}}(e.purpose);return n==null?null:{"goog-listen-tags":n}}function p6(t){return t.unaryFilter!==void 0?function(n){switch(n.unaryFilter.op){case"IS_NAN":const r=Sw(n.unaryFilter.field);return Ba.create(r,"==",{doubleValue:NaN});case"IS_NULL":const c=Sw(n.unaryFilter.field);return Ba.create(c,"==",{nullValue:"NULL_VALUE"});case"IS_NOT_NAN":const d=Sw(n.unaryFilter.field);return Ba.create(d,"!=",{doubleValue:NaN});case"IS_NOT_NULL":const m=Sw(n.unaryFilter.field);return Ba.create(m,"!=",{nullValue:"NULL_VALUE"});case"OPERATOR_UNSPECIFIED":return Zi(61313);default:return Zi(60726)}}(t):t.fieldFilter!==void 0?function(n){return Ba.create(Sw(n.fieldFilter.field),function(c){switch(c){case"EQUAL":return"==";case"NOT_EQUAL":return"!=";case"GREATER_THAN":return">";case"GREATER_THAN_OR_EQUAL":return">=";case"LESS_THAN":return"<";case"LESS_THAN_OR_EQUAL":return"<=";case"ARRAY_CONTAINS":return"array-contains";case"IN":return"in";case"NOT_IN":return"not-in";case"ARRAY_CONTAINS_ANY":return"array-contains-any";case"OPERATOR_UNSPECIFIED":return Zi(58110);default:return Zi(50506)}}(n.fieldFilter.op),n.fieldFilter.value)}(t):t.compositeFilter!==void 0?function(n){return yp.create(n.compositeFilter.filters.map(r=>p6(r)),function(c){switch(c){case"AND":return"and";case"OR":return"or";default:return Zi(1026)}}(n.compositeFilter.op))}(t):Zi(30097,{filter:t})}function rie(t){return Gne[t]}function sie(t){return qne[t]}function oie(t){return Wne[t]}function Ew(t){return{fieldPath:t.canonicalString()}}function Sw(t){return Ql.fromServerFormat(t.fieldPath)}function m6(t){return t instanceof Ba?function(n){if(n.op==="=="){if(k3(n.value))return{unaryFilter:{field:Ew(n.field),op:"IS_NAN"}};if(P3(n.value))return{unaryFilter:{field:Ew(n.field),op:"IS_NULL"}}}else if(n.op==="!="){if(k3(n.value))return{unaryFilter:{field:Ew(n.field),op:"IS_NOT_NAN"}};if(P3(n.value))return{unaryFilter:{field:Ew(n.field),op:"IS_NOT_NULL"}}}return{fieldFilter:{field:Ew(n.field),op:sie(n.op),value:n.value}}}(t):t instanceof yp?function(n){const r=n.getFilters().map(c=>m6(c));return r.length===1?r[0]:{compositeFilter:{op:oie(n.op),filters:r}}}(t):Zi(54877,{filter:t})}function aie(t){const e=[];return t.fields.forEach(n=>e.push(n.canonicalString())),{fieldPaths:e}}function g6(t){return t.length>=4&&t.get(0)==="projects"&&t.get(2)==="databases"}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Pv{constructor(e,n,r,c,d=or.min(),m=or.min(),s=Kl.EMPTY_BYTE_STRING,T=null){this.target=e,this.targetId=n,this.purpose=r,this.sequenceNumber=c,this.snapshotVersion=d,this.lastLimboFreeSnapshotVersion=m,this.resumeToken=s,this.expectedCount=T}withSequenceNumber(e){return new Pv(this.target,this.targetId,this.purpose,e,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,this.expectedCount)}withResumeToken(e,n){return new Pv(this.target,this.targetId,this.purpose,this.sequenceNumber,n,this.lastLimboFreeSnapshotVersion,e,null)}withExpectedCount(e){return new Pv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,this.lastLimboFreeSnapshotVersion,this.resumeToken,e)}withLastLimboFreeSnapshotVersion(e){return new Pv(this.target,this.targetId,this.purpose,this.sequenceNumber,this.snapshotVersion,e,this.resumeToken,this.expectedCount)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lie{constructor(e){this.wt=e}}function cie(t){const e=nie({parent:t.parent,structuredQuery:t.structuredQuery});return t.limitType==="LAST"?Yk(e,e.limit,"L"):e}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class uie{constructor(){this.Cn=new hie}addToCollectionParentIndex(e,n){return this.Cn.add(n),Dn.resolve()}getCollectionParents(e,n){return Dn.resolve(this.Cn.getEntries(n))}addFieldIndex(e,n){return Dn.resolve()}deleteFieldIndex(e,n){return Dn.resolve()}deleteAllFieldIndexes(e){return Dn.resolve()}createTargetIndexes(e,n){return Dn.resolve()}getDocumentsMatchingTarget(e,n){return Dn.resolve(null)}getIndexType(e,n){return Dn.resolve(0)}getFieldIndexes(e,n){return Dn.resolve([])}getNextCollectionGroupToUpdate(e){return Dn.resolve(null)}getMinOffset(e,n){return Dn.resolve(Xv.min())}getMinOffsetFromCollectionGroup(e,n){return Dn.resolve(Xv.min())}updateCollectionGroup(e,n,r){return Dn.resolve()}updateIndexEntries(e,n){return Dn.resolve()}}class hie{constructor(){this.index={}}add(e){const n=e.lastSegment(),r=e.popLast(),c=this.index[n]||new al(bo.comparator),d=!c.has(r);return this.index[n]=c.add(r),d}has(e){const n=e.lastSegment(),r=e.popLast(),c=this.index[n];return c&&c.has(r)}getEntries(e){return(this.index[e]||new al(bo.comparator)).toArray()}}/**
 * @license
 * Copyright 2018 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Y3={didRun:!1,sequenceNumbersCollected:0,targetsRemoved:0,documentsRemoved:0},_6=41943040;class Uu{static withCacheSize(e){return new Uu(e,Uu.DEFAULT_COLLECTION_PERCENTILE,Uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT)}constructor(e,n,r){this.cacheSizeCollectionThreshold=e,this.percentileToCollect=n,this.maximumSequenceNumbersToCollect=r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */Uu.DEFAULT_COLLECTION_PERCENTILE=10,Uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT=1e3,Uu.DEFAULT=new Uu(_6,Uu.DEFAULT_COLLECTION_PERCENTILE,Uu.DEFAULT_MAX_SEQUENCE_NUMBERS_TO_COLLECT),Uu.DISABLED=new Uu(-1,0,0);/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class rT{constructor(e){this.ur=e}next(){return this.ur+=2,this.ur}static cr(){return new rT(0)}static lr(){return new rT(-1)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Z3="LruGarbageCollector",die=1048576;function X3([t,e],[n,r]){const c=Fr(t,n);return c===0?Fr(e,r):c}class fie{constructor(e){this.Er=e,this.buffer=new al(X3),this.dr=0}Ar(){return++this.dr}Rr(e){const n=[e,this.Ar()];if(this.buffer.size<this.Er)this.buffer=this.buffer.add(n);else{const r=this.buffer.last();X3(n,r)<0&&(this.buffer=this.buffer.delete(r).add(n))}}get maxValue(){return this.buffer.last()[0]}}class pie{constructor(e,n,r){this.garbageCollector=e,this.asyncQueue=n,this.localStore=r,this.Vr=null}start(){this.garbageCollector.params.cacheSizeCollectionThreshold!==-1&&this.mr(6e4)}stop(){this.Vr&&(this.Vr.cancel(),this.Vr=null)}get started(){return this.Vr!==null}mr(e){ui(Z3,`Garbage collection scheduled in ${e}ms`),this.Vr=this.asyncQueue.enqueueAfterDelay("lru_garbage_collection",e,async()=>{this.Vr=null;try{await this.localStore.collectGarbage(this.garbageCollector)}catch(n){xT(n)?ui(Z3,"Ignoring IndexedDB error during garbage collection: ",n):await bT(n)}await this.mr(3e5)})}}class mie{constructor(e,n){this.gr=e,this.params=n}calculateTargetCount(e,n){return this.gr.pr(e).next(r=>Math.floor(n/100*r))}nthSequenceNumber(e,n){if(n===0)return Dn.resolve(jI.le);const r=new fie(n);return this.gr.forEachTarget(e,c=>r.Rr(c.sequenceNumber)).next(()=>this.gr.yr(e,c=>r.Rr(c))).next(()=>r.maxValue)}removeTargets(e,n,r){return this.gr.removeTargets(e,n,r)}removeOrphanedDocuments(e,n){return this.gr.removeOrphanedDocuments(e,n)}collect(e,n){return this.params.cacheSizeCollectionThreshold===-1?(ui("LruGarbageCollector","Garbage collection skipped; disabled"),Dn.resolve(Y3)):this.getCacheSize(e).next(r=>r<this.params.cacheSizeCollectionThreshold?(ui("LruGarbageCollector",`Garbage collection skipped; Cache size ${r} is lower than threshold ${this.params.cacheSizeCollectionThreshold}`),Y3):this.wr(e,n))}getCacheSize(e){return this.gr.getCacheSize(e)}wr(e,n){let r,c,d,m,s,T,D;const P=Date.now();return this.calculateTargetCount(e,this.params.percentileToCollect).next(z=>(z>this.params.maximumSequenceNumbersToCollect?(ui("LruGarbageCollector",`Capping sequence numbers to collect down to the maximum of ${this.params.maximumSequenceNumbersToCollect} from ${z}`),c=this.params.maximumSequenceNumbersToCollect):c=z,m=Date.now(),this.nthSequenceNumber(e,c))).next(z=>(r=z,s=Date.now(),this.removeTargets(e,r,n))).next(z=>(d=z,T=Date.now(),this.removeOrphanedDocuments(e,r))).next(z=>(D=Date.now(),ww()<=Xr.DEBUG&&ui("LruGarbageCollector",`LRU Garbage Collection
	Counted targets in ${m-P}ms
	Determined least recently used ${c} in `+(s-m)+`ms
	Removed ${d} targets in `+(T-s)+`ms
	Removed ${z} documents in `+(D-T)+`ms
Total Duration: ${D-P}ms`),Dn.resolve({didRun:!0,sequenceNumbersCollected:c,targetsRemoved:d,documentsRemoved:z})))}}function gie(t,e){return new mie(t,e)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class _ie{constructor(){this.changes=new Rx(e=>e.toString(),(e,n)=>e.isEqual(n)),this.changesApplied=!1}addEntry(e){this.assertNotApplied(),this.changes.set(e.key,e)}removeEntry(e,n){this.assertNotApplied(),this.changes.set(e,Nc.newInvalidDocument(e).setReadTime(n))}getEntry(e,n){this.assertNotApplied();const r=this.changes.get(n);return r!==void 0?Dn.resolve(r):this.getFromCache(e,n)}getEntries(e,n){return this.getAllFromCache(e,n)}apply(e){return this.assertNotApplied(),this.changesApplied=!0,this.applyChanges(e)}assertNotApplied(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class yie{constructor(e,n){this.overlayedDocument=e,this.mutatedFields=n}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class vie{constructor(e,n,r,c){this.remoteDocumentCache=e,this.mutationQueue=n,this.documentOverlayCache=r,this.indexManager=c}getDocument(e,n){let r=null;return this.documentOverlayCache.getOverlay(e,n).next(c=>(r=c,this.remoteDocumentCache.getEntry(e,n))).next(c=>(r!==null&&GS(r.mutation,c,Gh.empty(),xo.now()),c))}getDocuments(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.getLocalViewOfDocuments(e,r,Qr()).next(()=>r))}getLocalViewOfDocuments(e,n,r=Qr()){const c=sx();return this.populateOverlays(e,c,n).next(()=>this.computeViews(e,n,c,r).next(d=>{let m=DS();return d.forEach((s,T)=>{m=m.insert(s,T.overlayedDocument)}),m}))}getOverlayedDocuments(e,n){const r=sx();return this.populateOverlays(e,r,n).next(()=>this.computeViews(e,n,r,Qr()))}populateOverlays(e,n,r){const c=[];return r.forEach(d=>{n.has(d)||c.push(d)}),this.documentOverlayCache.getOverlays(e,c).next(d=>{d.forEach((m,s)=>{n.set(m,s)})})}computeViews(e,n,r,c){let d=O_();const m=$S(),s=function(){return $S()}();return n.forEach((T,D)=>{const P=r.get(D.key);c.has(D.key)&&(P===void 0||P.mutation instanceof u0)?d=d.insert(D.key,D):P!==void 0?(m.set(D.key,P.mutation.getFieldMask()),GS(P.mutation,D,P.mutation.getFieldMask(),xo.now())):m.set(D.key,Gh.empty())}),this.recalculateAndSaveOverlays(e,d).next(T=>(T.forEach((D,P)=>m.set(D,P)),n.forEach((D,P)=>{var z;return s.set(D,new yie(P,(z=m.get(D))!==null&&z!==void 0?z:null))}),s))}recalculateAndSaveOverlays(e,n){const r=$S();let c=new Bo((m,s)=>m-s),d=Qr();return this.mutationQueue.getAllMutationBatchesAffectingDocumentKeys(e,n).next(m=>{for(const s of m)s.keys().forEach(T=>{const D=n.get(T);if(D===null)return;let P=r.get(T)||Gh.empty();P=s.applyToLocalView(D,P),r.set(T,P);const z=(c.get(s.batchId)||Qr()).add(T);c=c.insert(s.batchId,z)})}).next(()=>{const m=[],s=c.getReverseIterator();for(;s.hasNext();){const T=s.getNext(),D=T.key,P=T.value,z=Kj();P.forEach(F=>{if(!d.has(F)){const $=s6(n.get(F),r.get(F));$!==null&&z.set(F,$),d=d.add(F)}}),m.push(this.documentOverlayCache.saveOverlays(e,D,z))}return Dn.waitFor(m)}).next(()=>r)}recalculateAndSaveOverlaysForDocumentKeys(e,n){return this.remoteDocumentCache.getEntries(e,n).next(r=>this.recalculateAndSaveOverlays(e,r))}getDocumentsMatchingQuery(e,n,r,c){return function(m){return Ni.isDocumentKey(m.path)&&m.collectionGroup===null&&m.filters.length===0}(n)?this.getDocumentsMatchingDocumentQuery(e,n.path):Wj(n)?this.getDocumentsMatchingCollectionGroupQuery(e,n,r,c):this.getDocumentsMatchingCollectionQuery(e,n,r,c)}getNextDocuments(e,n,r,c){return this.remoteDocumentCache.getAllFromCollectionGroup(e,n,r,c).next(d=>{const m=c-d.size>0?this.documentOverlayCache.getOverlaysForCollectionGroup(e,n,r.largestBatchId,c-d.size):Dn.resolve(sx());let s=fA,T=d;return m.next(D=>Dn.forEach(D,(P,z)=>(s<z.largestBatchId&&(s=z.largestBatchId),d.get(P)?Dn.resolve():this.remoteDocumentCache.getEntry(e,P).next(F=>{T=T.insert(P,F)}))).next(()=>this.populateOverlays(e,D,d)).next(()=>this.computeViews(e,T,D,Qr())).next(P=>({batchId:s,changes:Qj(P)})))})}getDocumentsMatchingDocumentQuery(e,n){return this.getDocument(e,new Ni(n)).next(r=>{let c=DS();return r.isFoundDocument()&&(c=c.insert(r.key,r)),c})}getDocumentsMatchingCollectionGroupQuery(e,n,r,c){const d=n.collectionGroup;let m=DS();return this.indexManager.getCollectionParents(e,d).next(s=>Dn.forEach(s,T=>{const D=function(z,F){return new YA(F,null,z.explicitOrderBy.slice(),z.filters.slice(),z.limit,z.limitType,z.startAt,z.endAt)}(n,T.child(d));return this.getDocumentsMatchingCollectionQuery(e,D,r,c).next(P=>{P.forEach((z,F)=>{m=m.insert(z,F)})})}).next(()=>m))}getDocumentsMatchingCollectionQuery(e,n,r,c){let d;return this.documentOverlayCache.getOverlaysForCollection(e,n.path,r.largestBatchId).next(m=>(d=m,this.remoteDocumentCache.getDocumentsMatchingQuery(e,n,r,d,c))).next(m=>{d.forEach((T,D)=>{const P=D.getKey();m.get(P)===null&&(m=m.insert(P,Nc.newInvalidDocument(P)))});let s=DS();return m.forEach((T,D)=>{const P=d.get(T);P!==void 0&&GS(P.mutation,D,Gh.empty(),xo.now()),WI(n,D)&&(s=s.insert(T,D))}),s})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class bie{constructor(e){this.serializer=e,this.kr=new Map,this.qr=new Map}getBundleMetadata(e,n){return Dn.resolve(this.kr.get(n))}saveBundleMetadata(e,n){return this.kr.set(n.id,function(c){return{id:c.id,version:c.version,createTime:$m(c.createTime)}}(n)),Dn.resolve()}getNamedQuery(e,n){return Dn.resolve(this.qr.get(n))}saveNamedQuery(e,n){return this.qr.set(n.name,function(c){return{name:c.name,query:cie(c.bundledQuery),readTime:$m(c.readTime)}}(n)),Dn.resolve()}}/**
 * @license
 * Copyright 2022 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class xie{constructor(){this.overlays=new Bo(Ni.comparator),this.Qr=new Map}getOverlay(e,n){return Dn.resolve(this.overlays.get(n))}getOverlays(e,n){const r=sx();return Dn.forEach(n,c=>this.getOverlay(e,c).next(d=>{d!==null&&r.set(c,d)})).next(()=>r)}saveOverlays(e,n,r){return r.forEach((c,d)=>{this.St(e,n,d)}),Dn.resolve()}removeOverlaysForBatchId(e,n,r){const c=this.Qr.get(r);return c!==void 0&&(c.forEach(d=>this.overlays=this.overlays.remove(d)),this.Qr.delete(r)),Dn.resolve()}getOverlaysForCollection(e,n,r){const c=sx(),d=n.length+1,m=new Ni(n.child("")),s=this.overlays.getIteratorFrom(m);for(;s.hasNext();){const T=s.getNext().value,D=T.getKey();if(!n.isPrefixOf(D.path))break;D.path.length===d&&T.largestBatchId>r&&c.set(T.getKey(),T)}return Dn.resolve(c)}getOverlaysForCollectionGroup(e,n,r,c){let d=new Bo((D,P)=>D-P);const m=this.overlays.getIterator();for(;m.hasNext();){const D=m.getNext().value;if(D.getKey().getCollectionGroup()===n&&D.largestBatchId>r){let P=d.get(D.largestBatchId);P===null&&(P=sx(),d=d.insert(D.largestBatchId,P)),P.set(D.getKey(),D)}}const s=sx(),T=d.getIterator();for(;T.hasNext()&&(T.getNext().value.forEach((D,P)=>s.set(D,P)),!(s.size()>=c)););return Dn.resolve(s)}St(e,n,r){const c=this.overlays.get(r.key);if(c!==null){const m=this.Qr.get(c.largestBatchId).delete(r.key);this.Qr.set(c.largestBatchId,m)}this.overlays=this.overlays.insert(r.key,new Vne(n,r));let d=this.Qr.get(n);d===void 0&&(d=Qr(),this.Qr.set(n,d)),this.Qr.set(n,d.add(r.key))}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class wie{constructor(){this.sessionToken=Kl.EMPTY_BYTE_STRING}getSessionToken(e){return Dn.resolve(this.sessionToken)}setSessionToken(e,n){return this.sessionToken=n,Dn.resolve()}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class L2{constructor(){this.$r=new al(Al.Ur),this.Kr=new al(Al.Wr)}isEmpty(){return this.$r.isEmpty()}addReference(e,n){const r=new Al(e,n);this.$r=this.$r.add(r),this.Kr=this.Kr.add(r)}Gr(e,n){e.forEach(r=>this.addReference(r,n))}removeReference(e,n){this.zr(new Al(e,n))}jr(e,n){e.forEach(r=>this.removeReference(r,n))}Hr(e){const n=new Ni(new bo([])),r=new Al(n,e),c=new Al(n,e+1),d=[];return this.Kr.forEachInRange([r,c],m=>{this.zr(m),d.push(m.key)}),d}Jr(){this.$r.forEach(e=>this.zr(e))}zr(e){this.$r=this.$r.delete(e),this.Kr=this.Kr.delete(e)}Yr(e){const n=new Ni(new bo([])),r=new Al(n,e),c=new Al(n,e+1);let d=Qr();return this.Kr.forEachInRange([r,c],m=>{d=d.add(m.key)}),d}containsKey(e){const n=new Al(e,0),r=this.$r.firstAfterOrEqual(n);return r!==null&&e.isEqual(r.key)}}class Al{constructor(e,n){this.key=e,this.Zr=n}static Ur(e,n){return Ni.comparator(e.key,n.key)||Fr(e.Zr,n.Zr)}static Wr(e,n){return Fr(e.Zr,n.Zr)||Ni.comparator(e.key,n.key)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Tie{constructor(e,n){this.indexManager=e,this.referenceDelegate=n,this.mutationQueue=[],this.nr=1,this.Xr=new al(Al.Ur)}checkEmpty(e){return Dn.resolve(this.mutationQueue.length===0)}addMutationBatch(e,n,r,c){const d=this.nr;this.nr++,this.mutationQueue.length>0&&this.mutationQueue[this.mutationQueue.length-1];const m=new Fne(d,n,r,c);this.mutationQueue.push(m);for(const s of c)this.Xr=this.Xr.add(new Al(s.key,d)),this.indexManager.addToCollectionParentIndex(e,s.key.path.popLast());return Dn.resolve(m)}lookupMutationBatch(e,n){return Dn.resolve(this.ei(n))}getNextMutationBatchAfterBatchId(e,n){const r=n+1,c=this.ti(r),d=c<0?0:c;return Dn.resolve(this.mutationQueue.length>d?this.mutationQueue[d]:null)}getHighestUnacknowledgedBatchId(){return Dn.resolve(this.mutationQueue.length===0?A2:this.nr-1)}getAllMutationBatches(e){return Dn.resolve(this.mutationQueue.slice())}getAllMutationBatchesAffectingDocumentKey(e,n){const r=new Al(n,0),c=new Al(n,Number.POSITIVE_INFINITY),d=[];return this.Xr.forEachInRange([r,c],m=>{const s=this.ei(m.Zr);d.push(s)}),Dn.resolve(d)}getAllMutationBatchesAffectingDocumentKeys(e,n){let r=new al(Fr);return n.forEach(c=>{const d=new Al(c,0),m=new Al(c,Number.POSITIVE_INFINITY);this.Xr.forEachInRange([d,m],s=>{r=r.add(s.Zr)})}),Dn.resolve(this.ni(r))}getAllMutationBatchesAffectingQuery(e,n){const r=n.path,c=r.length+1;let d=r;Ni.isDocumentKey(d)||(d=d.child(""));const m=new Al(new Ni(d),0);let s=new al(Fr);return this.Xr.forEachWhile(T=>{const D=T.key.path;return!!r.isPrefixOf(D)&&(D.length===c&&(s=s.add(T.Zr)),!0)},m),Dn.resolve(this.ni(s))}ni(e){const n=[];return e.forEach(r=>{const c=this.ei(r);c!==null&&n.push(c)}),n}removeMutationBatch(e,n){Ps(this.ri(n.batchId,"removed")===0,55003),this.mutationQueue.shift();let r=this.Xr;return Dn.forEach(n.mutations,c=>{const d=new Al(c.key,n.batchId);return r=r.delete(d),this.referenceDelegate.markPotentiallyOrphaned(e,c.key)}).next(()=>{this.Xr=r})}sr(e){}containsKey(e,n){const r=new Al(n,0),c=this.Xr.firstAfterOrEqual(r);return Dn.resolve(n.isEqual(c&&c.key))}performConsistencyCheck(e){return this.mutationQueue.length,Dn.resolve()}ri(e,n){return this.ti(e)}ti(e){return this.mutationQueue.length===0?0:e-this.mutationQueue[0].batchId}ei(e){const n=this.ti(e);return n<0||n>=this.mutationQueue.length?null:this.mutationQueue[n]}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Eie{constructor(e){this.ii=e,this.docs=function(){return new Bo(Ni.comparator)}(),this.size=0}setIndexManager(e){this.indexManager=e}addEntry(e,n){const r=n.key,c=this.docs.get(r),d=c?c.size:0,m=this.ii(n);return this.docs=this.docs.insert(r,{document:n.mutableCopy(),size:m}),this.size+=m-d,this.indexManager.addToCollectionParentIndex(e,r.path.popLast())}removeEntry(e){const n=this.docs.get(e);n&&(this.docs=this.docs.remove(e),this.size-=n.size)}getEntry(e,n){const r=this.docs.get(n);return Dn.resolve(r?r.document.mutableCopy():Nc.newInvalidDocument(n))}getEntries(e,n){let r=O_();return n.forEach(c=>{const d=this.docs.get(c);r=r.insert(c,d?d.document.mutableCopy():Nc.newInvalidDocument(c))}),Dn.resolve(r)}getDocumentsMatchingQuery(e,n,r,c){let d=O_();const m=n.path,s=new Ni(m.child("__id-9223372036854775808__")),T=this.docs.getIteratorFrom(s);for(;T.hasNext();){const{key:D,value:{document:P}}=T.getNext();if(!m.isPrefixOf(D.path))break;D.path.length>m.length+1||ene(Jte(P),r)<=0||(c.has(P.key)||WI(n,P))&&(d=d.insert(P.key,P.mutableCopy()))}return Dn.resolve(d)}getAllFromCollectionGroup(e,n,r,c){Zi(9500)}si(e,n){return Dn.forEach(this.docs,r=>n(r))}newChangeBuffer(e){return new Sie(this)}getSize(e){return Dn.resolve(this.size)}}class Sie extends _ie{constructor(e){super(),this.Br=e}applyChanges(e){const n=[];return this.changes.forEach((r,c)=>{c.isValidDocument()?n.push(this.Br.addEntry(e,c)):this.Br.removeEntry(r)}),Dn.waitFor(n)}getFromCache(e,n){return this.Br.getEntry(e,n)}getAllFromCache(e,n){return this.Br.getEntries(e,n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Aie{constructor(e){this.persistence=e,this.oi=new Rx(n=>R2(n),O2),this.lastRemoteSnapshotVersion=or.min(),this.highestTargetId=0,this._i=0,this.ai=new L2,this.targetCount=0,this.ui=rT.cr()}forEachTarget(e,n){return this.oi.forEach((r,c)=>n(c)),Dn.resolve()}getLastRemoteSnapshotVersion(e){return Dn.resolve(this.lastRemoteSnapshotVersion)}getHighestSequenceNumber(e){return Dn.resolve(this._i)}allocateTargetId(e){return this.highestTargetId=this.ui.next(),Dn.resolve(this.highestTargetId)}setTargetsMetadata(e,n,r){return r&&(this.lastRemoteSnapshotVersion=r),n>this._i&&(this._i=n),Dn.resolve()}Tr(e){this.oi.set(e.target,e);const n=e.targetId;n>this.highestTargetId&&(this.ui=new rT(n),this.highestTargetId=n),e.sequenceNumber>this._i&&(this._i=e.sequenceNumber)}addTargetData(e,n){return this.Tr(n),this.targetCount+=1,Dn.resolve()}updateTargetData(e,n){return this.Tr(n),Dn.resolve()}removeTargetData(e,n){return this.oi.delete(n.target),this.ai.Hr(n.targetId),this.targetCount-=1,Dn.resolve()}removeTargets(e,n,r){let c=0;const d=[];return this.oi.forEach((m,s)=>{s.sequenceNumber<=n&&r.get(s.targetId)===null&&(this.oi.delete(m),d.push(this.removeMatchingKeysForTargetId(e,s.targetId)),c++)}),Dn.waitFor(d).next(()=>c)}getTargetCount(e){return Dn.resolve(this.targetCount)}getTargetData(e,n){const r=this.oi.get(n)||null;return Dn.resolve(r)}addMatchingKeys(e,n,r){return this.ai.Gr(n,r),Dn.resolve()}removeMatchingKeys(e,n,r){this.ai.jr(n,r);const c=this.persistence.referenceDelegate,d=[];return c&&n.forEach(m=>{d.push(c.markPotentiallyOrphaned(e,m))}),Dn.waitFor(d)}removeMatchingKeysForTargetId(e,n){return this.ai.Hr(n),Dn.resolve()}getMatchingKeysForTargetId(e,n){const r=this.ai.Yr(n);return Dn.resolve(r)}containsKey(e,n){return Dn.resolve(this.ai.containsKey(n))}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class y6{constructor(e,n){this.ci={},this.overlays={},this.li=new jI(0),this.hi=!1,this.hi=!0,this.Pi=new wie,this.referenceDelegate=e(this),this.Ti=new Aie(this),this.indexManager=new uie,this.remoteDocumentCache=function(c){return new Eie(c)}(r=>this.referenceDelegate.Ii(r)),this.serializer=new lie(n),this.Ei=new bie(this.serializer)}start(){return Promise.resolve()}shutdown(){return this.hi=!1,Promise.resolve()}get started(){return this.hi}setDatabaseDeletedListener(){}setNetworkEnabled(){}getIndexManager(e){return this.indexManager}getDocumentOverlayCache(e){let n=this.overlays[e.toKey()];return n||(n=new xie,this.overlays[e.toKey()]=n),n}getMutationQueue(e,n){let r=this.ci[e.toKey()];return r||(r=new Tie(n,this.referenceDelegate),this.ci[e.toKey()]=r),r}getGlobalsCache(){return this.Pi}getTargetCache(){return this.Ti}getRemoteDocumentCache(){return this.remoteDocumentCache}getBundleCache(){return this.Ei}runTransaction(e,n,r){ui("MemoryPersistence","Starting transaction:",e);const c=new Cie(this.li.next());return this.referenceDelegate.di(),r(c).next(d=>this.referenceDelegate.Ai(c).next(()=>d)).toPromise().then(d=>(c.raiseOnCommittedEvent(),d))}Ri(e,n){return Dn.or(Object.values(this.ci).map(r=>()=>r.containsKey(e,n)))}}class Cie extends nne{constructor(e){super(),this.currentSequenceNumber=e}}class z2{constructor(e){this.persistence=e,this.Vi=new L2,this.mi=null}static fi(e){return new z2(e)}get gi(){if(this.mi)return this.mi;throw Zi(60996)}addReference(e,n,r){return this.Vi.addReference(r,n),this.gi.delete(r.toString()),Dn.resolve()}removeReference(e,n,r){return this.Vi.removeReference(r,n),this.gi.add(r.toString()),Dn.resolve()}markPotentiallyOrphaned(e,n){return this.gi.add(n.toString()),Dn.resolve()}removeTarget(e,n){this.Vi.Hr(n.targetId).forEach(c=>this.gi.add(c.toString()));const r=this.persistence.getTargetCache();return r.getMatchingKeysForTargetId(e,n.targetId).next(c=>{c.forEach(d=>this.gi.add(d.toString()))}).next(()=>r.removeTargetData(e,n))}di(){this.mi=new Set}Ai(e){const n=this.persistence.getRemoteDocumentCache().newChangeBuffer();return Dn.forEach(this.gi,r=>{const c=Ni.fromPath(r);return this.pi(e,c).next(d=>{d||n.removeEntry(c,or.min())})}).next(()=>(this.mi=null,n.apply(e)))}updateLimboDocument(e,n){return this.pi(e,n).next(r=>{r?this.gi.delete(n.toString()):this.gi.add(n.toString())})}Ii(e){return 0}pi(e,n){return Dn.or([()=>Dn.resolve(this.Vi.containsKey(n)),()=>this.persistence.getTargetCache().containsKey(e,n),()=>this.persistence.Ri(e,n)])}}class zO{constructor(e,n){this.persistence=e,this.yi=new Rx(r=>sne(r.path),(r,c)=>r.isEqual(c)),this.garbageCollector=gie(this,n)}static fi(e,n){return new zO(e,n)}di(){}Ai(e){return Dn.resolve()}forEachTarget(e,n){return this.persistence.getTargetCache().forEachTarget(e,n)}pr(e){const n=this.br(e);return this.persistence.getTargetCache().getTargetCount(e).next(r=>n.next(c=>r+c))}br(e){let n=0;return this.yr(e,r=>{n++}).next(()=>n)}yr(e,n){return Dn.forEach(this.yi,(r,c)=>this.Dr(e,r,c).next(d=>d?Dn.resolve():n(c)))}removeTargets(e,n,r){return this.persistence.getTargetCache().removeTargets(e,n,r)}removeOrphanedDocuments(e,n){let r=0;const c=this.persistence.getRemoteDocumentCache(),d=c.newChangeBuffer();return c.si(e,m=>this.Dr(e,m,n).next(s=>{s||(r++,d.removeEntry(m,or.min()))})).next(()=>d.apply(e)).next(()=>r)}markPotentiallyOrphaned(e,n){return this.yi.set(n,e.currentSequenceNumber),Dn.resolve()}removeTarget(e,n){const r=n.withSequenceNumber(e.currentSequenceNumber);return this.persistence.getTargetCache().updateTargetData(e,r)}addReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),Dn.resolve()}removeReference(e,n,r){return this.yi.set(r,e.currentSequenceNumber),Dn.resolve()}updateLimboDocument(e,n){return this.yi.set(n,e.currentSequenceNumber),Dn.resolve()}Ii(e){let n=e.key.toString().length;return e.isFoundDocument()&&(n+=qR(e.data.value)),n}Dr(e,n,r){return Dn.or([()=>this.persistence.Ri(e,n),()=>this.persistence.getTargetCache().containsKey(e,n),()=>{const c=this.yi.get(n);return Dn.resolve(c!==void 0&&c>r)}])}getCacheSize(e){return this.persistence.getRemoteDocumentCache().getSize(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class B2{constructor(e,n,r,c){this.targetId=e,this.fromCache=n,this.ds=r,this.As=c}static Rs(e,n){let r=Qr(),c=Qr();for(const d of n.docChanges)switch(d.type){case 0:r=r.add(d.doc.key);break;case 1:c=c.add(d.doc.key)}return new B2(e,n.fromCache,r,c)}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Die{constructor(){this._documentReadCount=0}get documentReadCount(){return this._documentReadCount}incrementDocumentReadCount(e){this._documentReadCount+=e}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Rie{constructor(){this.Vs=!1,this.fs=!1,this.gs=100,this.ps=function(){return aK()?8:ine(jc())>0?6:4}()}initialize(e,n){this.ys=e,this.indexManager=n,this.Vs=!0}getDocumentsMatchingQuery(e,n,r,c){const d={result:null};return this.ws(e,n).next(m=>{d.result=m}).next(()=>{if(!d.result)return this.bs(e,n,c,r).next(m=>{d.result=m})}).next(()=>{if(d.result)return;const m=new Die;return this.Ss(e,n,m).next(s=>{if(d.result=s,this.fs)return this.Ds(e,n,m,s.size)})}).next(()=>d.result)}Ds(e,n,r,c){return r.documentReadCount<this.gs?(ww()<=Xr.DEBUG&&ui("QueryEngine","SDK will not create cache indexes for query:",Tw(n),"since it only creates cache indexes for collection contains","more than or equal to",this.gs,"documents"),Dn.resolve()):(ww()<=Xr.DEBUG&&ui("QueryEngine","Query:",Tw(n),"scans",r.documentReadCount,"local documents and returns",c,"documents as results."),r.documentReadCount>this.ps*c?(ww()<=Xr.DEBUG&&ui("QueryEngine","The SDK decides to create cache indexes for query:",Tw(n),"as using cache indexes may help improve performance."),this.indexManager.createTargetIndexes(e,Hm(n))):Dn.resolve())}ws(e,n){if(B3(n))return Dn.resolve(null);let r=Hm(n);return this.indexManager.getIndexType(e,r).next(c=>c===0?null:(n.limit!==null&&c===1&&(n=Yk(n,null,"F"),r=Hm(n)),this.indexManager.getDocumentsMatchingTarget(e,r).next(d=>{const m=Qr(...d);return this.ys.getDocuments(e,m).next(s=>this.indexManager.getMinOffset(e,r).next(T=>{const D=this.vs(n,s);return this.Cs(n,D,m,T.readTime)?this.ws(e,Yk(n,null,"F")):this.Fs(e,D,n,T)}))})))}bs(e,n,r,c){return B3(n)||c.isEqual(or.min())?Dn.resolve(null):this.ys.getDocuments(e,r).next(d=>{const m=this.vs(n,d);return this.Cs(n,m,r,c)?Dn.resolve(null):(ww()<=Xr.DEBUG&&ui("QueryEngine","Re-using previous result from %s to execute query: %s",c.toString(),Tw(n)),this.Fs(e,m,n,Kte(c,fA)).next(s=>s))})}vs(e,n){let r=new al(Zj(e));return n.forEach((c,d)=>{WI(e,d)&&(r=r.add(d))}),r}Cs(e,n,r,c){if(e.limit===null)return!1;if(r.size!==n.size)return!0;const d=e.limitType==="F"?n.last():n.first();return!!d&&(d.hasPendingWrites||d.version.compareTo(c)>0)}Ss(e,n,r){return ww()<=Xr.DEBUG&&ui("QueryEngine","Using full collection scan to execute query:",Tw(n)),this.ys.getDocumentsMatchingQuery(e,n,Xv.min(),r)}Fs(e,n,r,c){return this.ys.getDocumentsMatchingQuery(e,r,c).next(d=>(n.forEach(m=>{d=d.insert(m.key,m)}),d))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const F2="LocalStore",Oie=3e8;class Iie{constructor(e,n,r,c){this.persistence=e,this.Ms=n,this.serializer=c,this.xs=new Bo(Fr),this.Os=new Rx(d=>R2(d),O2),this.Ns=new Map,this.Bs=e.getRemoteDocumentCache(),this.Ti=e.getTargetCache(),this.Ei=e.getBundleCache(),this.Ls(r)}Ls(e){this.documentOverlayCache=this.persistence.getDocumentOverlayCache(e),this.indexManager=this.persistence.getIndexManager(e),this.mutationQueue=this.persistence.getMutationQueue(e,this.indexManager),this.localDocuments=new vie(this.Bs,this.mutationQueue,this.documentOverlayCache,this.indexManager),this.Bs.setIndexManager(this.indexManager),this.Ms.initialize(this.localDocuments,this.indexManager)}collectGarbage(e){return this.persistence.runTransaction("Collect garbage","readwrite-primary",n=>e.collect(n,this.xs))}}function Mie(t,e,n,r){return new Iie(t,e,n,r)}async function v6(t,e){const n=ar(t);return await n.persistence.runTransaction("Handle user change","readonly",r=>{let c;return n.mutationQueue.getAllMutationBatches(r).next(d=>(c=d,n.Ls(e),n.mutationQueue.getAllMutationBatches(r))).next(d=>{const m=[],s=[];let T=Qr();for(const D of c){m.push(D.batchId);for(const P of D.mutations)T=T.add(P.key)}for(const D of d){s.push(D.batchId);for(const P of D.mutations)T=T.add(P.key)}return n.localDocuments.getDocuments(r,T).next(D=>({ks:D,removedBatchIds:m,addedBatchIds:s}))})})}function Pie(t,e){const n=ar(t);return n.persistence.runTransaction("Acknowledge batch","readwrite-primary",r=>{const c=e.batch.keys(),d=n.Bs.newChangeBuffer({trackRemovals:!0});return function(s,T,D,P){const z=D.batch,F=z.keys();let $=Dn.resolve();return F.forEach(J=>{$=$.next(()=>P.getEntry(T,J)).next(X=>{const te=D.docVersions.get(J);Ps(te!==null,48541),X.version.compareTo(te)<0&&(z.applyToRemoteDocument(X,D),X.isValidDocument()&&(X.setReadTime(D.commitVersion),P.addEntry(X)))})}),$.next(()=>s.mutationQueue.removeMutationBatch(T,z))}(n,r,e,d).next(()=>d.apply(r)).next(()=>n.mutationQueue.performConsistencyCheck(r)).next(()=>n.documentOverlayCache.removeOverlaysForBatchId(r,c,e.batch.batchId)).next(()=>n.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(r,function(s){let T=Qr();for(let D=0;D<s.mutationResults.length;++D)s.mutationResults[D].transformResults.length>0&&(T=T.add(s.batch.mutations[D].key));return T}(e))).next(()=>n.localDocuments.getDocuments(r,c))})}function b6(t){const e=ar(t);return e.persistence.runTransaction("Get last remote snapshot version","readonly",n=>e.Ti.getLastRemoteSnapshotVersion(n))}function kie(t,e){const n=ar(t),r=e.snapshotVersion;let c=n.xs;return n.persistence.runTransaction("Apply remote event","readwrite-primary",d=>{const m=n.Bs.newChangeBuffer({trackRemovals:!0});c=n.xs;const s=[];e.targetChanges.forEach((P,z)=>{const F=c.get(z);if(!F)return;s.push(n.Ti.removeMatchingKeys(d,P.removedDocuments,z).next(()=>n.Ti.addMatchingKeys(d,P.addedDocuments,z)));let $=F.withSequenceNumber(d.currentSequenceNumber);e.targetMismatches.get(z)!==null?$=$.withResumeToken(Kl.EMPTY_BYTE_STRING,or.min()).withLastLimboFreeSnapshotVersion(or.min()):P.resumeToken.approximateByteSize()>0&&($=$.withResumeToken(P.resumeToken,r)),c=c.insert(z,$),function(X,te,ie){return X.resumeToken.approximateByteSize()===0||te.snapshotVersion.toMicroseconds()-X.snapshotVersion.toMicroseconds()>=Oie?!0:ie.addedDocuments.size+ie.modifiedDocuments.size+ie.removedDocuments.size>0}(F,$,P)&&s.push(n.Ti.updateTargetData(d,$))});let T=O_(),D=Qr();if(e.documentUpdates.forEach(P=>{e.resolvedLimboDocuments.has(P)&&s.push(n.persistence.referenceDelegate.updateLimboDocument(d,P))}),s.push(Nie(d,m,e.documentUpdates).next(P=>{T=P.qs,D=P.Qs})),!r.isEqual(or.min())){const P=n.Ti.getLastRemoteSnapshotVersion(d).next(z=>n.Ti.setTargetsMetadata(d,d.currentSequenceNumber,r));s.push(P)}return Dn.waitFor(s).next(()=>m.apply(d)).next(()=>n.localDocuments.getLocalViewOfDocuments(d,T,D)).next(()=>T)}).then(d=>(n.xs=c,d))}function Nie(t,e,n){let r=Qr(),c=Qr();return n.forEach(d=>r=r.add(d)),e.getEntries(t,r).next(d=>{let m=O_();return n.forEach((s,T)=>{const D=d.get(s);T.isFoundDocument()!==D.isFoundDocument()&&(c=c.add(s)),T.isNoDocument()&&T.version.isEqual(or.min())?(e.removeEntry(s,T.readTime),m=m.insert(s,T)):!D.isValidDocument()||T.version.compareTo(D.version)>0||T.version.compareTo(D.version)===0&&D.hasPendingWrites?(e.addEntry(T),m=m.insert(s,T)):ui(F2,"Ignoring outdated watch update for ",s,". Current version:",D.version," Watch version:",T.version)}),{qs:m,Qs:c}})}function Lie(t,e){const n=ar(t);return n.persistence.runTransaction("Get next mutation batch","readonly",r=>(e===void 0&&(e=A2),n.mutationQueue.getNextMutationBatchAfterBatchId(r,e)))}function zie(t,e){const n=ar(t);return n.persistence.runTransaction("Allocate target","readwrite",r=>{let c;return n.Ti.getTargetData(r,e).next(d=>d?(c=d,Dn.resolve(c)):n.Ti.allocateTargetId(r).next(m=>(c=new Pv(e,m,"TargetPurposeListen",r.currentSequenceNumber),n.Ti.addTargetData(r,c).next(()=>c))))}).then(r=>{const c=n.xs.get(r.targetId);return(c===null||r.snapshotVersion.compareTo(c.snapshotVersion)>0)&&(n.xs=n.xs.insert(r.targetId,r),n.Os.set(e,r.targetId)),r})}async function Jk(t,e,n){const r=ar(t),c=r.xs.get(e),d=n?"readwrite":"readwrite-primary";try{n||await r.persistence.runTransaction("Release target",d,m=>r.persistence.referenceDelegate.removeTarget(m,c))}catch(m){if(!xT(m))throw m;ui(F2,`Failed to update sequence numbers for target ${e}: ${m}`)}r.xs=r.xs.remove(e),r.Os.delete(c.target)}function Q3(t,e,n){const r=ar(t);let c=or.min(),d=Qr();return r.persistence.runTransaction("Execute query","readwrite",m=>function(T,D,P){const z=ar(T),F=z.Os.get(P);return F!==void 0?Dn.resolve(z.xs.get(F)):z.Ti.getTargetData(D,P)}(r,m,Hm(e)).next(s=>{if(s)return c=s.lastLimboFreeSnapshotVersion,r.Ti.getMatchingKeysForTargetId(m,s.targetId).next(T=>{d=T})}).next(()=>r.Ms.getDocumentsMatchingQuery(m,e,n?c:or.min(),n?d:Qr())).next(s=>(Bie(r,Ene(e),s),{documents:s,$s:d})))}function Bie(t,e,n){let r=t.Ns.get(e)||or.min();n.forEach((c,d)=>{d.readTime.compareTo(r)>0&&(r=d.readTime)}),t.Ns.set(e,r)}class K3{constructor(){this.activeTargetIds=One()}js(e){this.activeTargetIds=this.activeTargetIds.add(e)}Hs(e){this.activeTargetIds=this.activeTargetIds.delete(e)}zs(){const e={activeTargetIds:this.activeTargetIds.toArray(),updateTimeMs:Date.now()};return JSON.stringify(e)}}class Fie{constructor(){this.xo=new K3,this.Oo={},this.onlineStateHandler=null,this.sequenceNumberHandler=null}addPendingMutation(e){}updateMutationState(e,n,r){}addLocalQueryTarget(e,n=!0){return n&&this.xo.js(e),this.Oo[e]||"not-current"}updateQueryState(e,n,r){this.Oo[e]=n}removeLocalQueryTarget(e){this.xo.Hs(e)}isLocalQueryTarget(e){return this.xo.activeTargetIds.has(e)}clearQueryState(e){delete this.Oo[e]}getAllActiveQueryTargets(){return this.xo.activeTargetIds}isActiveQueryTarget(e){return this.xo.activeTargetIds.has(e)}start(){return this.xo=new K3,Promise.resolve()}handleUserChange(e,n,r){}setOnlineState(e){}shutdown(){}writeSequenceNumber(e){}notifyBundleLoaded(e){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Vie{No(e){}shutdown(){}}/**
 * @license
 * Copyright 2019 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const J3="ConnectivityMonitor";class eF{constructor(){this.Bo=()=>this.Lo(),this.ko=()=>this.qo(),this.Qo=[],this.$o()}No(e){this.Qo.push(e)}shutdown(){window.removeEventListener("online",this.Bo),window.removeEventListener("offline",this.ko)}$o(){window.addEventListener("online",this.Bo),window.addEventListener("offline",this.ko)}Lo(){ui(J3,"Network connectivity changed: AVAILABLE");for(const e of this.Qo)e(0)}qo(){ui(J3,"Network connectivity changed: UNAVAILABLE");for(const e of this.Qo)e(1)}static C(){return typeof window<"u"&&window.addEventListener!==void 0&&window.removeEventListener!==void 0}}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */let aR=null;function eN(){return aR===null?aR=function(){return 268435456+Math.round(2147483648*Math.random())}():aR++,"0x"+aR.toString(16)}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const RP="RestConnection",Uie={BatchGetDocuments:"batchGet",Commit:"commit",RunQuery:"runQuery",RunAggregationQuery:"runAggregationQuery"};class jie{get Uo(){return!1}constructor(e){this.databaseInfo=e,this.databaseId=e.databaseId;const n=e.ssl?"https":"http",r=encodeURIComponent(this.databaseId.projectId),c=encodeURIComponent(this.databaseId.database);this.Ko=n+"://"+e.host,this.Wo=`projects/${r}/databases/${c}`,this.Go=this.databaseId.database===OO?`project_id=${r}`:`project_id=${r}&database_id=${c}`}zo(e,n,r,c,d){const m=eN(),s=this.jo(e,n.toUriEncodedString());ui(RP,`Sending RPC '${e}' ${m}:`,s,r);const T={"google-cloud-resource-prefix":this.Wo,"x-goog-request-params":this.Go};this.Ho(T,c,d);const{host:D}=new URL(s),P=gT(D);return this.Jo(e,s,T,r,P).then(z=>(ui(RP,`Received RPC '${e}' ${m}: `,z),z),z=>{throw Kw(RP,`RPC '${e}' ${m} failed with error: `,z,"url: ",s,"request:",r),z})}Yo(e,n,r,c,d,m){return this.zo(e,n,r,c,d)}Ho(e,n,r){e["X-Goog-Api-Client"]=function(){return"gl-js/ fire/"+vT}(),e["Content-Type"]="text/plain",this.databaseInfo.appId&&(e["X-Firebase-GMPID"]=this.databaseInfo.appId),n&&n.headers.forEach((c,d)=>e[d]=c),r&&r.headers.forEach((c,d)=>e[d]=c)}jo(e,n){const r=Uie[e];return`${this.Ko}/v1/${n}:${r}`}terminate(){}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Hie{constructor(e){this.Zo=e.Zo,this.Xo=e.Xo}e_(e){this.t_=e}n_(e){this.r_=e}i_(e){this.s_=e}onMessage(e){this.o_=e}close(){this.Xo()}send(e){this.Zo(e)}__(){this.t_()}a_(){this.r_()}u_(e){this.s_(e)}c_(e){this.o_(e)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ic="WebChannelConnection";class $ie extends jie{constructor(e){super(e),this.l_=[],this.forceLongPolling=e.forceLongPolling,this.autoDetectLongPolling=e.autoDetectLongPolling,this.useFetchStreams=e.useFetchStreams,this.longPollingOptions=e.longPollingOptions}Jo(e,n,r,c,d){const m=eN();return new Promise((s,T)=>{const D=new wj;D.setWithCredentials(!0),D.listenOnce(Tj.COMPLETE,()=>{try{switch(D.getLastErrorCode()){case GR.NO_ERROR:const z=D.getResponseJson();ui(Ic,`XHR for RPC '${e}' ${m} received:`,JSON.stringify(z)),s(z);break;case GR.TIMEOUT:ui(Ic,`RPC '${e}' ${m} timed out`),T(new pi(In.DEADLINE_EXCEEDED,"Request time out"));break;case GR.HTTP_ERROR:const F=D.getStatus();if(ui(Ic,`RPC '${e}' ${m} failed with status:`,F,"response text:",D.getResponseText()),F>0){let $=D.getResponseJson();Array.isArray($)&&($=$[0]);const J=$==null?void 0:$.error;if(J&&J.status&&J.message){const X=function(ie){const we=ie.toLowerCase().replace(/_/g,"-");return Object.values(In).indexOf(we)>=0?we:In.UNKNOWN}(J.status);T(new pi(X,J.message))}else T(new pi(In.UNKNOWN,"Server responded with status "+D.getStatus()))}else T(new pi(In.UNAVAILABLE,"Connection failed."));break;default:Zi(9055,{h_:e,streamId:m,P_:D.getLastErrorCode(),T_:D.getLastError()})}}finally{ui(Ic,`RPC '${e}' ${m} completed.`)}});const P=JSON.stringify(c);ui(Ic,`RPC '${e}' ${m} sending request:`,c),D.send(n,"POST",P,r,15)})}I_(e,n,r){const c=eN(),d=[this.Ko,"/","google.firestore.v1.Firestore","/",e,"/channel"],m=Aj(),s=Sj(),T={httpSessionIdParam:"gsessionid",initMessageHeaders:{},messageUrlParams:{database:`projects/${this.databaseId.projectId}/databases/${this.databaseId.database}`},sendRawJson:!0,supportsCrossDomainXhr:!0,internalChannelParams:{forwardChannelRequestTimeoutMs:6e5},forceLongPolling:this.forceLongPolling,detectBufferingProxy:this.autoDetectLongPolling},D=this.longPollingOptions.timeoutSeconds;D!==void 0&&(T.longPollingTimeout=Math.round(1e3*D)),this.useFetchStreams&&(T.useFetchStreams=!0),this.Ho(T.initMessageHeaders,n,r),T.encodeInitMessageHeaders=!0;const P=d.join("");ui(Ic,`Creating RPC '${e}' stream ${c}: ${P}`,T);const z=m.createWebChannel(P,T);this.E_(z);let F=!1,$=!1;const J=new Hie({Zo:te=>{$?ui(Ic,`Not sending because RPC '${e}' stream ${c} is closed:`,te):(F||(ui(Ic,`Opening RPC '${e}' stream ${c} transport.`),z.open(),F=!0),ui(Ic,`RPC '${e}' stream ${c} sending:`,te),z.send(te))},Xo:()=>z.close()}),X=(te,ie,we)=>{te.listen(ie,Ie=>{try{we(Ie)}catch(Re){setTimeout(()=>{throw Re},0)}})};return X(z,CS.EventType.OPEN,()=>{$||(ui(Ic,`RPC '${e}' stream ${c} transport opened.`),J.__())}),X(z,CS.EventType.CLOSE,()=>{$||($=!0,ui(Ic,`RPC '${e}' stream ${c} transport closed`),J.u_(),this.d_(z))}),X(z,CS.EventType.ERROR,te=>{$||($=!0,Kw(Ic,`RPC '${e}' stream ${c} transport errored. Name:`,te.name,"Message:",te.message),J.u_(new pi(In.UNAVAILABLE,"The operation could not be completed")))}),X(z,CS.EventType.MESSAGE,te=>{var ie;if(!$){const we=te.data[0];Ps(!!we,16349);const Ie=we,Re=(Ie==null?void 0:Ie.error)||((ie=Ie[0])===null||ie===void 0?void 0:ie.error);if(Re){ui(Ic,`RPC '${e}' stream ${c} received error:`,Re);const Ne=Re.status;let Xe=function(Te){const oe=La[Te];if(oe!==void 0)return a6(oe)}(Ne),be=Re.message;Xe===void 0&&(Xe=In.INTERNAL,be="Unknown error status: "+Ne+" with message "+Re.message),$=!0,J.u_(new pi(Xe,be)),z.close()}else ui(Ic,`RPC '${e}' stream ${c} received:`,we),J.c_(we)}}),X(s,Ej.STAT_EVENT,te=>{te.stat===Uk.PROXY?ui(Ic,`RPC '${e}' stream ${c} detected buffering proxy`):te.stat===Uk.NOPROXY&&ui(Ic,`RPC '${e}' stream ${c} detected no buffering proxy`)}),setTimeout(()=>{J.a_()},0),J}terminate(){this.l_.forEach(e=>e.close()),this.l_=[]}E_(e){this.l_.push(e)}d_(e){this.l_=this.l_.filter(n=>n===e)}}function OP(){return typeof document<"u"?document:null}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function QI(t){return new Yne(t,!0)}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class x6{constructor(e,n,r=1e3,c=1.5,d=6e4){this.xi=e,this.timerId=n,this.A_=r,this.R_=c,this.V_=d,this.m_=0,this.f_=null,this.g_=Date.now(),this.reset()}reset(){this.m_=0}p_(){this.m_=this.V_}y_(e){this.cancel();const n=Math.floor(this.m_+this.w_()),r=Math.max(0,Date.now()-this.g_),c=Math.max(0,n-r);c>0&&ui("ExponentialBackoff",`Backing off for ${c} ms (base delay: ${this.m_} ms, delay with jitter: ${n} ms, last attempt: ${r} ms ago)`),this.f_=this.xi.enqueueAfterDelay(this.timerId,c,()=>(this.g_=Date.now(),e())),this.m_*=this.R_,this.m_<this.A_&&(this.m_=this.A_),this.m_>this.V_&&(this.m_=this.V_)}b_(){this.f_!==null&&(this.f_.skipDelay(),this.f_=null)}cancel(){this.f_!==null&&(this.f_.cancel(),this.f_=null)}w_(){return(Math.random()-.5)*this.m_}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const tF="PersistentStream";class w6{constructor(e,n,r,c,d,m,s,T){this.xi=e,this.S_=r,this.D_=c,this.connection=d,this.authCredentialsProvider=m,this.appCheckCredentialsProvider=s,this.listener=T,this.state=0,this.v_=0,this.C_=null,this.F_=null,this.stream=null,this.M_=0,this.x_=new x6(e,n)}O_(){return this.state===1||this.state===5||this.N_()}N_(){return this.state===2||this.state===3}start(){this.M_=0,this.state!==4?this.auth():this.B_()}async stop(){this.O_()&&await this.close(0)}L_(){this.state=0,this.x_.reset()}k_(){this.N_()&&this.C_===null&&(this.C_=this.xi.enqueueAfterDelay(this.S_,6e4,()=>this.q_()))}Q_(e){this.U_(),this.stream.send(e)}async q_(){if(this.N_())return this.close(0)}U_(){this.C_&&(this.C_.cancel(),this.C_=null)}K_(){this.F_&&(this.F_.cancel(),this.F_=null)}async close(e,n){this.U_(),this.K_(),this.x_.cancel(),this.v_++,e!==4?this.x_.reset():n&&n.code===In.RESOURCE_EXHAUSTED?(R_(n.toString()),R_("Using maximum backoff delay to prevent overloading the backend."),this.x_.p_()):n&&n.code===In.UNAUTHENTICATED&&this.state!==3&&(this.authCredentialsProvider.invalidateToken(),this.appCheckCredentialsProvider.invalidateToken()),this.stream!==null&&(this.W_(),this.stream.close(),this.stream=null),this.state=e,await this.listener.i_(n)}W_(){}auth(){this.state=1;const e=this.G_(this.v_),n=this.v_;Promise.all([this.authCredentialsProvider.getToken(),this.appCheckCredentialsProvider.getToken()]).then(([r,c])=>{this.v_===n&&this.z_(r,c)},r=>{e(()=>{const c=new pi(In.UNKNOWN,"Fetching auth token failed: "+r.message);return this.j_(c)})})}z_(e,n){const r=this.G_(this.v_);this.stream=this.H_(e,n),this.stream.e_(()=>{r(()=>this.listener.e_())}),this.stream.n_(()=>{r(()=>(this.state=2,this.F_=this.xi.enqueueAfterDelay(this.D_,1e4,()=>(this.N_()&&(this.state=3),Promise.resolve())),this.listener.n_()))}),this.stream.i_(c=>{r(()=>this.j_(c))}),this.stream.onMessage(c=>{r(()=>++this.M_==1?this.J_(c):this.onNext(c))})}B_(){this.state=5,this.x_.y_(async()=>{this.state=0,this.start()})}j_(e){return ui(tF,`close with error: ${e}`),this.stream=null,this.close(4,e)}G_(e){return n=>{this.xi.enqueueAndForget(()=>this.v_===e?n():(ui(tF,"stream callback skipped by getCloseGuardedDispatcher."),Promise.resolve()))}}}class Gie extends w6{constructor(e,n,r,c,d,m){super(e,"listen_stream_connection_backoff","listen_stream_idle","health_check_timeout",n,r,c,m),this.serializer=d}H_(e,n){return this.connection.I_("Listen",e,n)}J_(e){return this.onNext(e)}onNext(e){this.x_.reset();const n=Qne(this.serializer,e),r=function(d){if(!("targetChange"in d))return or.min();const m=d.targetChange;return m.targetIds&&m.targetIds.length?or.min():m.readTime?$m(m.readTime):or.min()}(e);return this.listener.Y_(n,r)}Z_(e){const n={};n.database=Kk(this.serializer),n.addTarget=function(d,m){let s;const T=m.target;if(s=qk(T)?{documents:eie(d,T)}:{query:tie(d,T).gt},s.targetId=m.targetId,m.resumeToken.approximateByteSize()>0){s.resumeToken=u6(d,m.resumeToken);const D=Zk(d,m.expectedCount);D!==null&&(s.expectedCount=D)}else if(m.snapshotVersion.compareTo(or.min())>0){s.readTime=LO(d,m.snapshotVersion.toTimestamp());const D=Zk(d,m.expectedCount);D!==null&&(s.expectedCount=D)}return s}(this.serializer,e);const r=iie(this.serializer,e);r&&(n.labels=r),this.Q_(n)}X_(e){const n={};n.database=Kk(this.serializer),n.removeTarget=e,this.Q_(n)}}class qie extends w6{constructor(e,n,r,c,d,m){super(e,"write_stream_connection_backoff","write_stream_idle","health_check_timeout",n,r,c,m),this.serializer=d}get ea(){return this.M_>0}start(){this.lastStreamToken=void 0,super.start()}W_(){this.ea&&this.ta([])}H_(e,n){return this.connection.I_("Write",e,n)}J_(e){return Ps(!!e.streamToken,31322),this.lastStreamToken=e.streamToken,Ps(!e.writeResults||e.writeResults.length===0,55816),this.listener.na()}onNext(e){Ps(!!e.streamToken,12678),this.lastStreamToken=e.streamToken,this.x_.reset();const n=Jne(e.writeResults,e.commitTime),r=$m(e.commitTime);return this.listener.ra(r,n)}ia(){const e={};e.database=Kk(this.serializer),this.Q_(e)}ta(e){const n={streamToken:this.lastStreamToken,writes:e.map(r=>Kne(this.serializer,r))};this.Q_(n)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Wie{}class Yie extends Wie{constructor(e,n,r,c){super(),this.authCredentials=e,this.appCheckCredentials=n,this.connection=r,this.serializer=c,this.sa=!1}oa(){if(this.sa)throw new pi(In.FAILED_PRECONDITION,"The client has already been terminated.")}zo(e,n,r,c){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([d,m])=>this.connection.zo(e,Xk(n,r),c,d,m)).catch(d=>{throw d.name==="FirebaseError"?(d.code===In.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),d):new pi(In.UNKNOWN,d.toString())})}Yo(e,n,r,c,d){return this.oa(),Promise.all([this.authCredentials.getToken(),this.appCheckCredentials.getToken()]).then(([m,s])=>this.connection.Yo(e,Xk(n,r),c,m,s,d)).catch(m=>{throw m.name==="FirebaseError"?(m.code===In.UNAUTHENTICATED&&(this.authCredentials.invalidateToken(),this.appCheckCredentials.invalidateToken()),m):new pi(In.UNKNOWN,m.toString())})}terminate(){this.sa=!0,this.connection.terminate()}}class Zie{constructor(e,n){this.asyncQueue=e,this.onlineStateHandler=n,this.state="Unknown",this._a=0,this.aa=null,this.ua=!0}ca(){this._a===0&&(this.la("Unknown"),this.aa=this.asyncQueue.enqueueAfterDelay("online_state_timeout",1e4,()=>(this.aa=null,this.ha("Backend didn't respond within 10 seconds."),this.la("Offline"),Promise.resolve())))}Pa(e){this.state==="Online"?this.la("Unknown"):(this._a++,this._a>=1&&(this.Ta(),this.ha(`Connection failed 1 times. Most recent error: ${e.toString()}`),this.la("Offline")))}set(e){this.Ta(),this._a=0,e==="Online"&&(this.ua=!1),this.la(e)}la(e){e!==this.state&&(this.state=e,this.onlineStateHandler(e))}ha(e){const n=`Could not reach Cloud Firestore backend. ${e}
This typically indicates that your device does not have a healthy Internet connection at the moment. The client will operate in offline mode until it is able to successfully connect to the backend.`;this.ua?(R_(n),this.ua=!1):ui("OnlineStateTracker",n)}Ta(){this.aa!==null&&(this.aa.cancel(),this.aa=null)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const xx="RemoteStore";class Xie{constructor(e,n,r,c,d){this.localStore=e,this.datastore=n,this.asyncQueue=r,this.remoteSyncer={},this.Ia=[],this.Ea=new Map,this.da=new Set,this.Aa=[],this.Ra=d,this.Ra.No(m=>{r.enqueueAndForget(async()=>{Ox(this)&&(ui(xx,"Restarting streams for network reachability change."),await async function(T){const D=ar(T);D.da.add(4),await KA(D),D.Va.set("Unknown"),D.da.delete(4),await QA(D)}(this))})}),this.Va=new Zie(r,c)}}async function QA(t){if(Ox(t))for(const e of t.Aa)await e(!0)}async function KA(t){for(const e of t.Aa)await e(!1)}function T6(t,e){const n=ar(t);n.Ea.has(e.targetId)||(n.Ea.set(e.targetId,e),H2(n)?j2(n):wT(n).N_()&&U2(n,e))}function V2(t,e){const n=ar(t),r=wT(n);n.Ea.delete(e),r.N_()&&E6(n,e),n.Ea.size===0&&(r.N_()?r.k_():Ox(n)&&n.Va.set("Unknown"))}function U2(t,e){if(t.ma.Ke(e.targetId),e.resumeToken.approximateByteSize()>0||e.snapshotVersion.compareTo(or.min())>0){const n=t.remoteSyncer.getRemoteKeysForTarget(e.targetId).size;e=e.withExpectedCount(n)}wT(t).Z_(e)}function E6(t,e){t.ma.Ke(e),wT(t).X_(e)}function j2(t){t.ma=new $ne({getRemoteKeysForTarget:e=>t.remoteSyncer.getRemoteKeysForTarget(e),Rt:e=>t.Ea.get(e)||null,Pt:()=>t.datastore.serializer.databaseId}),wT(t).start(),t.Va.ca()}function H2(t){return Ox(t)&&!wT(t).O_()&&t.Ea.size>0}function Ox(t){return ar(t).da.size===0}function S6(t){t.ma=void 0}async function Qie(t){t.Va.set("Online")}async function Kie(t){t.Ea.forEach((e,n)=>{U2(t,e)})}async function Jie(t,e){S6(t),H2(t)?(t.Va.Pa(e),j2(t)):t.Va.set("Unknown")}async function ere(t,e,n){if(t.Va.set("Online"),e instanceof c6&&e.state===2&&e.cause)try{await async function(c,d){const m=d.cause;for(const s of d.targetIds)c.Ea.has(s)&&(await c.remoteSyncer.rejectListen(s,m),c.Ea.delete(s),c.ma.removeTarget(s))}(t,e)}catch(r){ui(xx,"Failed to remove targets %s: %s ",e.targetIds.join(","),r),await BO(t,r)}else if(e instanceof ZR?t.ma.Xe(e):e instanceof l6?t.ma.ot(e):t.ma.nt(e),!n.isEqual(or.min()))try{const r=await b6(t.localStore);n.compareTo(r)>=0&&await function(d,m){const s=d.ma.It(m);return s.targetChanges.forEach((T,D)=>{if(T.resumeToken.approximateByteSize()>0){const P=d.Ea.get(D);P&&d.Ea.set(D,P.withResumeToken(T.resumeToken,m))}}),s.targetMismatches.forEach((T,D)=>{const P=d.Ea.get(T);if(!P)return;d.Ea.set(T,P.withResumeToken(Kl.EMPTY_BYTE_STRING,P.snapshotVersion)),E6(d,T);const z=new Pv(P.target,T,D,P.sequenceNumber);U2(d,z)}),d.remoteSyncer.applyRemoteEvent(s)}(t,n)}catch(r){ui(xx,"Failed to raise snapshot:",r),await BO(t,r)}}async function BO(t,e,n){if(!xT(e))throw e;t.da.add(1),await KA(t),t.Va.set("Offline"),n||(n=()=>b6(t.localStore)),t.asyncQueue.enqueueRetryable(async()=>{ui(xx,"Retrying IndexedDB access"),await n(),t.da.delete(1),await QA(t)})}function A6(t,e){return e().catch(n=>BO(t,n,e))}async function KI(t){const e=ar(t),n=e0(e);let r=e.Ia.length>0?e.Ia[e.Ia.length-1].batchId:A2;for(;tre(e);)try{const c=await Lie(e.localStore,r);if(c===null){e.Ia.length===0&&n.k_();break}r=c.batchId,nre(e,c)}catch(c){await BO(e,c)}C6(e)&&D6(e)}function tre(t){return Ox(t)&&t.Ia.length<10}function nre(t,e){t.Ia.push(e);const n=e0(t);n.N_()&&n.ea&&n.ta(e.mutations)}function C6(t){return Ox(t)&&!e0(t).O_()&&t.Ia.length>0}function D6(t){e0(t).start()}async function ire(t){e0(t).ia()}async function rre(t){const e=e0(t);for(const n of t.Ia)e.ta(n.mutations)}async function sre(t,e,n){const r=t.Ia.shift(),c=P2.from(r,e,n);await A6(t,()=>t.remoteSyncer.applySuccessfulWrite(c)),await KI(t)}async function ore(t,e){e&&e0(t).ea&&await async function(r,c){if(function(m){return jne(m)&&m!==In.ABORTED}(c.code)){const d=r.Ia.shift();e0(r).L_(),await A6(r,()=>r.remoteSyncer.rejectFailedWrite(d.batchId,c)),await KI(r)}}(t,e),C6(t)&&D6(t)}async function nF(t,e){const n=ar(t);n.asyncQueue.verifyOperationInProgress(),ui(xx,"RemoteStore received new credentials");const r=Ox(n);n.da.add(3),await KA(n),r&&n.Va.set("Unknown"),await n.remoteSyncer.handleCredentialChange(e),n.da.delete(3),await QA(n)}async function are(t,e){const n=ar(t);e?(n.da.delete(2),await QA(n)):e||(n.da.add(2),await KA(n),n.Va.set("Unknown"))}function wT(t){return t.fa||(t.fa=function(n,r,c){const d=ar(n);return d.oa(),new Gie(r,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}(t.datastore,t.asyncQueue,{e_:Qie.bind(null,t),n_:Kie.bind(null,t),i_:Jie.bind(null,t),Y_:ere.bind(null,t)}),t.Aa.push(async e=>{e?(t.fa.L_(),H2(t)?j2(t):t.Va.set("Unknown")):(await t.fa.stop(),S6(t))})),t.fa}function e0(t){return t.ga||(t.ga=function(n,r,c){const d=ar(n);return d.oa(),new qie(r,d.connection,d.authCredentials,d.appCheckCredentials,d.serializer,c)}(t.datastore,t.asyncQueue,{e_:()=>Promise.resolve(),n_:ire.bind(null,t),i_:ore.bind(null,t),na:rre.bind(null,t),ra:sre.bind(null,t)}),t.Aa.push(async e=>{e?(t.ga.L_(),await KI(t)):(await t.ga.stop(),t.Ia.length>0&&(ui(xx,`Stopping write stream with ${t.Ia.length} pending writes`),t.Ia=[]))})),t.ga}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class $2{constructor(e,n,r,c,d){this.asyncQueue=e,this.timerId=n,this.targetTimeMs=r,this.op=c,this.removalCallback=d,this.deferred=new $v,this.then=this.deferred.promise.then.bind(this.deferred.promise),this.deferred.promise.catch(m=>{})}get promise(){return this.deferred.promise}static createAndSchedule(e,n,r,c,d){const m=Date.now()+r,s=new $2(e,n,m,c,d);return s.start(r),s}start(e){this.timerHandle=setTimeout(()=>this.handleDelayElapsed(),e)}skipDelay(){return this.handleDelayElapsed()}cancel(e){this.timerHandle!==null&&(this.clearTimeout(),this.deferred.reject(new pi(In.CANCELLED,"Operation cancelled"+(e?": "+e:""))))}handleDelayElapsed(){this.asyncQueue.enqueueAndForget(()=>this.timerHandle!==null?(this.clearTimeout(),this.op().then(e=>this.deferred.resolve(e))):Promise.resolve())}clearTimeout(){this.timerHandle!==null&&(this.removalCallback(this),clearTimeout(this.timerHandle),this.timerHandle=null)}}function G2(t,e){if(R_("AsyncQueue",`${e}: ${t}`),xT(t))return new pi(In.UNAVAILABLE,`${e}: ${t}`);throw t}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Lw{static emptySet(e){return new Lw(e.comparator)}constructor(e){this.comparator=e?(n,r)=>e(n,r)||Ni.comparator(n.key,r.key):(n,r)=>Ni.comparator(n.key,r.key),this.keyedMap=DS(),this.sortedSet=new Bo(this.comparator)}has(e){return this.keyedMap.get(e)!=null}get(e){return this.keyedMap.get(e)}first(){return this.sortedSet.minKey()}last(){return this.sortedSet.maxKey()}isEmpty(){return this.sortedSet.isEmpty()}indexOf(e){const n=this.keyedMap.get(e);return n?this.sortedSet.indexOf(n):-1}get size(){return this.sortedSet.size}forEach(e){this.sortedSet.inorderTraversal((n,r)=>(e(n),!1))}add(e){const n=this.delete(e.key);return n.copy(n.keyedMap.insert(e.key,e),n.sortedSet.insert(e,null))}delete(e){const n=this.get(e);return n?this.copy(this.keyedMap.remove(e),this.sortedSet.remove(n)):this}isEqual(e){if(!(e instanceof Lw)||this.size!==e.size)return!1;const n=this.sortedSet.getIterator(),r=e.sortedSet.getIterator();for(;n.hasNext();){const c=n.getNext().key,d=r.getNext().key;if(!c.isEqual(d))return!1}return!0}toString(){const e=[];return this.forEach(n=>{e.push(n.toString())}),e.length===0?"DocumentSet ()":`DocumentSet (
  `+e.join(`  
`)+`
)`}copy(e,n){const r=new Lw;return r.comparator=this.comparator,r.keyedMap=e,r.sortedSet=n,r}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class iF{constructor(){this.pa=new Bo(Ni.comparator)}track(e){const n=e.doc.key,r=this.pa.get(n);r?e.type!==0&&r.type===3?this.pa=this.pa.insert(n,e):e.type===3&&r.type!==1?this.pa=this.pa.insert(n,{type:r.type,doc:e.doc}):e.type===2&&r.type===2?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):e.type===2&&r.type===0?this.pa=this.pa.insert(n,{type:0,doc:e.doc}):e.type===1&&r.type===0?this.pa=this.pa.remove(n):e.type===1&&r.type===2?this.pa=this.pa.insert(n,{type:1,doc:r.doc}):e.type===0&&r.type===1?this.pa=this.pa.insert(n,{type:2,doc:e.doc}):Zi(63341,{Vt:e,ya:r}):this.pa=this.pa.insert(n,e)}wa(){const e=[];return this.pa.inorderTraversal((n,r)=>{e.push(r)}),e}}class sT{constructor(e,n,r,c,d,m,s,T,D){this.query=e,this.docs=n,this.oldDocs=r,this.docChanges=c,this.mutatedKeys=d,this.fromCache=m,this.syncStateChanged=s,this.excludesMetadataChanges=T,this.hasCachedResults=D}static fromInitialDocuments(e,n,r,c,d){const m=[];return n.forEach(s=>{m.push({type:0,doc:s})}),new sT(e,n,Lw.emptySet(n),m,r,c,!0,!1,d)}get hasPendingWrites(){return!this.mutatedKeys.isEmpty()}isEqual(e){if(!(this.fromCache===e.fromCache&&this.hasCachedResults===e.hasCachedResults&&this.syncStateChanged===e.syncStateChanged&&this.mutatedKeys.isEqual(e.mutatedKeys)&&qI(this.query,e.query)&&this.docs.isEqual(e.docs)&&this.oldDocs.isEqual(e.oldDocs)))return!1;const n=this.docChanges,r=e.docChanges;if(n.length!==r.length)return!1;for(let c=0;c<n.length;c++)if(n[c].type!==r[c].type||!n[c].doc.isEqual(r[c].doc))return!1;return!0}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class lre{constructor(){this.ba=void 0,this.Sa=[]}Da(){return this.Sa.some(e=>e.va())}}class cre{constructor(){this.queries=rF(),this.onlineState="Unknown",this.Ca=new Set}terminate(){(function(n,r){const c=ar(n),d=c.queries;c.queries=rF(),d.forEach((m,s)=>{for(const T of s.Sa)T.onError(r)})})(this,new pi(In.ABORTED,"Firestore shutting down"))}}function rF(){return new Rx(t=>Yj(t),qI)}async function R6(t,e){const n=ar(t);let r=3;const c=e.query;let d=n.queries.get(c);d?!d.Da()&&e.va()&&(r=2):(d=new lre,r=e.va()?0:1);try{switch(r){case 0:d.ba=await n.onListen(c,!0);break;case 1:d.ba=await n.onListen(c,!1);break;case 2:await n.onFirstRemoteStoreListen(c)}}catch(m){const s=G2(m,`Initialization of query '${Tw(e.query)}' failed`);return void e.onError(s)}n.queries.set(c,d),d.Sa.push(e),e.Fa(n.onlineState),d.ba&&e.Ma(d.ba)&&q2(n)}async function O6(t,e){const n=ar(t),r=e.query;let c=3;const d=n.queries.get(r);if(d){const m=d.Sa.indexOf(e);m>=0&&(d.Sa.splice(m,1),d.Sa.length===0?c=e.va()?0:1:!d.Da()&&e.va()&&(c=2))}switch(c){case 0:return n.queries.delete(r),n.onUnlisten(r,!0);case 1:return n.queries.delete(r),n.onUnlisten(r,!1);case 2:return n.onLastRemoteStoreUnlisten(r);default:return}}function ure(t,e){const n=ar(t);let r=!1;for(const c of e){const d=c.query,m=n.queries.get(d);if(m){for(const s of m.Sa)s.Ma(c)&&(r=!0);m.ba=c}}r&&q2(n)}function hre(t,e,n){const r=ar(t),c=r.queries.get(e);if(c)for(const d of c.Sa)d.onError(n);r.queries.delete(e)}function q2(t){t.Ca.forEach(e=>{e.next()})}var tN,sF;(sF=tN||(tN={})).xa="default",sF.Cache="cache";class I6{constructor(e,n,r){this.query=e,this.Oa=n,this.Na=!1,this.Ba=null,this.onlineState="Unknown",this.options=r||{}}Ma(e){if(!this.options.includeMetadataChanges){const r=[];for(const c of e.docChanges)c.type!==3&&r.push(c);e=new sT(e.query,e.docs,e.oldDocs,r,e.mutatedKeys,e.fromCache,e.syncStateChanged,!0,e.hasCachedResults)}let n=!1;return this.Na?this.La(e)&&(this.Oa.next(e),n=!0):this.ka(e,this.onlineState)&&(this.qa(e),n=!0),this.Ba=e,n}onError(e){this.Oa.error(e)}Fa(e){this.onlineState=e;let n=!1;return this.Ba&&!this.Na&&this.ka(this.Ba,e)&&(this.qa(this.Ba),n=!0),n}ka(e,n){if(!e.fromCache||!this.va())return!0;const r=n!=="Offline";return(!this.options.Qa||!r)&&(!e.docs.isEmpty()||e.hasCachedResults||n==="Offline")}La(e){if(e.docChanges.length>0)return!0;const n=this.Ba&&this.Ba.hasPendingWrites!==e.hasPendingWrites;return!(!e.syncStateChanged&&!n)&&this.options.includeMetadataChanges===!0}qa(e){e=sT.fromInitialDocuments(e.query,e.docs,e.mutatedKeys,e.fromCache,e.hasCachedResults),this.Na=!0,this.Oa.next(e)}va(){return this.options.source!==tN.Cache}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class M6{constructor(e){this.key=e}}class P6{constructor(e){this.key=e}}class dre{constructor(e,n){this.query=e,this.Ha=n,this.Ja=null,this.hasCachedResults=!1,this.current=!1,this.Ya=Qr(),this.mutatedKeys=Qr(),this.Za=Zj(e),this.Xa=new Lw(this.Za)}get eu(){return this.Ha}tu(e,n){const r=n?n.nu:new iF,c=n?n.Xa:this.Xa;let d=n?n.mutatedKeys:this.mutatedKeys,m=c,s=!1;const T=this.query.limitType==="F"&&c.size===this.query.limit?c.last():null,D=this.query.limitType==="L"&&c.size===this.query.limit?c.first():null;if(e.inorderTraversal((P,z)=>{const F=c.get(P),$=WI(this.query,z)?z:null,J=!!F&&this.mutatedKeys.has(F.key),X=!!$&&($.hasLocalMutations||this.mutatedKeys.has($.key)&&$.hasCommittedMutations);let te=!1;F&&$?F.data.isEqual($.data)?J!==X&&(r.track({type:3,doc:$}),te=!0):this.ru(F,$)||(r.track({type:2,doc:$}),te=!0,(T&&this.Za($,T)>0||D&&this.Za($,D)<0)&&(s=!0)):!F&&$?(r.track({type:0,doc:$}),te=!0):F&&!$&&(r.track({type:1,doc:F}),te=!0,(T||D)&&(s=!0)),te&&($?(m=m.add($),d=X?d.add(P):d.delete(P)):(m=m.delete(P),d=d.delete(P)))}),this.query.limit!==null)for(;m.size>this.query.limit;){const P=this.query.limitType==="F"?m.last():m.first();m=m.delete(P.key),d=d.delete(P.key),r.track({type:1,doc:P})}return{Xa:m,nu:r,Cs:s,mutatedKeys:d}}ru(e,n){return e.hasLocalMutations&&n.hasCommittedMutations&&!n.hasLocalMutations}applyChanges(e,n,r,c){const d=this.Xa;this.Xa=e.Xa,this.mutatedKeys=e.mutatedKeys;const m=e.nu.wa();m.sort((P,z)=>function($,J){const X=te=>{switch(te){case 0:return 1;case 2:case 3:return 2;case 1:return 0;default:return Zi(20277,{Vt:te})}};return X($)-X(J)}(P.type,z.type)||this.Za(P.doc,z.doc)),this.iu(r),c=c!=null&&c;const s=n&&!c?this.su():[],T=this.Ya.size===0&&this.current&&!c?1:0,D=T!==this.Ja;return this.Ja=T,m.length!==0||D?{snapshot:new sT(this.query,e.Xa,d,m,e.mutatedKeys,T===0,D,!1,!!r&&r.resumeToken.approximateByteSize()>0),ou:s}:{ou:s}}Fa(e){return this.current&&e==="Offline"?(this.current=!1,this.applyChanges({Xa:this.Xa,nu:new iF,mutatedKeys:this.mutatedKeys,Cs:!1},!1)):{ou:[]}}_u(e){return!this.Ha.has(e)&&!!this.Xa.has(e)&&!this.Xa.get(e).hasLocalMutations}iu(e){e&&(e.addedDocuments.forEach(n=>this.Ha=this.Ha.add(n)),e.modifiedDocuments.forEach(n=>{}),e.removedDocuments.forEach(n=>this.Ha=this.Ha.delete(n)),this.current=e.current)}su(){if(!this.current)return[];const e=this.Ya;this.Ya=Qr(),this.Xa.forEach(r=>{this._u(r.key)&&(this.Ya=this.Ya.add(r.key))});const n=[];return e.forEach(r=>{this.Ya.has(r)||n.push(new P6(r))}),this.Ya.forEach(r=>{e.has(r)||n.push(new M6(r))}),n}au(e){this.Ha=e.$s,this.Ya=Qr();const n=this.tu(e.documents);return this.applyChanges(n,!0)}uu(){return sT.fromInitialDocuments(this.query,this.Xa,this.mutatedKeys,this.Ja===0,this.hasCachedResults)}}const W2="SyncEngine";class fre{constructor(e,n,r){this.query=e,this.targetId=n,this.view=r}}class pre{constructor(e){this.key=e,this.cu=!1}}class mre{constructor(e,n,r,c,d,m){this.localStore=e,this.remoteStore=n,this.eventManager=r,this.sharedClientState=c,this.currentUser=d,this.maxConcurrentLimboResolutions=m,this.lu={},this.hu=new Rx(s=>Yj(s),qI),this.Pu=new Map,this.Tu=new Set,this.Iu=new Bo(Ni.comparator),this.Eu=new Map,this.du=new L2,this.Au={},this.Ru=new Map,this.Vu=rT.lr(),this.onlineState="Unknown",this.mu=void 0}get isPrimaryClient(){return this.mu===!0}}async function gre(t,e,n=!0){const r=F6(t);let c;const d=r.hu.get(e);return d?(r.sharedClientState.addLocalQueryTarget(d.targetId),c=d.view.uu()):c=await k6(r,e,n,!0),c}async function _re(t,e){const n=F6(t);await k6(n,e,!0,!1)}async function k6(t,e,n,r){const c=await zie(t.localStore,Hm(e)),d=c.targetId,m=t.sharedClientState.addLocalQueryTarget(d,n);let s;return r&&(s=await yre(t,e,d,m==="current",c.resumeToken)),t.isPrimaryClient&&n&&T6(t.remoteStore,c),s}async function yre(t,e,n,r,c){t.fu=(z,F,$)=>async function(X,te,ie,we){let Ie=te.view.tu(ie);Ie.Cs&&(Ie=await Q3(X.localStore,te.query,!1).then(({documents:be})=>te.view.tu(be,Ie)));const Re=we&&we.targetChanges.get(te.targetId),Ne=we&&we.targetMismatches.get(te.targetId)!=null,Xe=te.view.applyChanges(Ie,X.isPrimaryClient,Re,Ne);return aF(X,te.targetId,Xe.ou),Xe.snapshot}(t,z,F,$);const d=await Q3(t.localStore,e,!0),m=new dre(e,d.$s),s=m.tu(d.documents),T=XA.createSynthesizedTargetChangeForCurrentChange(n,r&&t.onlineState!=="Offline",c),D=m.applyChanges(s,t.isPrimaryClient,T);aF(t,n,D.ou);const P=new fre(e,n,m);return t.hu.set(e,P),t.Pu.has(n)?t.Pu.get(n).push(e):t.Pu.set(n,[e]),D.snapshot}async function vre(t,e,n){const r=ar(t),c=r.hu.get(e),d=r.Pu.get(c.targetId);if(d.length>1)return r.Pu.set(c.targetId,d.filter(m=>!qI(m,e))),void r.hu.delete(e);r.isPrimaryClient?(r.sharedClientState.removeLocalQueryTarget(c.targetId),r.sharedClientState.isActiveQueryTarget(c.targetId)||await Jk(r.localStore,c.targetId,!1).then(()=>{r.sharedClientState.clearQueryState(c.targetId),n&&V2(r.remoteStore,c.targetId),nN(r,c.targetId)}).catch(bT)):(nN(r,c.targetId),await Jk(r.localStore,c.targetId,!0))}async function bre(t,e){const n=ar(t),r=n.hu.get(e),c=n.Pu.get(r.targetId);n.isPrimaryClient&&c.length===1&&(n.sharedClientState.removeLocalQueryTarget(r.targetId),V2(n.remoteStore,r.targetId))}async function xre(t,e,n){const r=Dre(t);try{const c=await function(m,s){const T=ar(m),D=xo.now(),P=s.reduce(($,J)=>$.add(J.key),Qr());let z,F;return T.persistence.runTransaction("Locally write mutations","readwrite",$=>{let J=O_(),X=Qr();return T.Bs.getEntries($,P).next(te=>{J=te,J.forEach((ie,we)=>{we.isValidDocument()||(X=X.add(ie))})}).next(()=>T.localDocuments.getOverlayedDocuments($,J)).next(te=>{z=te;const ie=[];for(const we of s){const Ie=zne(we,z.get(we.key).overlayedDocument);Ie!=null&&ie.push(new u0(we.key,Ie,Vj(Ie.value.mapValue),mp.exists(!0)))}return T.mutationQueue.addMutationBatch($,D,ie,s)}).next(te=>{F=te;const ie=te.applyToLocalDocumentSet(z,X);return T.documentOverlayCache.saveOverlays($,te.batchId,ie)})}).then(()=>({batchId:F.batchId,changes:Qj(z)}))}(r.localStore,e);r.sharedClientState.addPendingMutation(c.batchId),function(m,s,T){let D=m.Au[m.currentUser.toKey()];D||(D=new Bo(Fr)),D=D.insert(s,T),m.Au[m.currentUser.toKey()]=D}(r,c.batchId,n),await JA(r,c.changes),await KI(r.remoteStore)}catch(c){const d=G2(c,"Failed to persist write");n.reject(d)}}async function N6(t,e){const n=ar(t);try{const r=await kie(n.localStore,e);e.targetChanges.forEach((c,d)=>{const m=n.Eu.get(d);m&&(Ps(c.addedDocuments.size+c.modifiedDocuments.size+c.removedDocuments.size<=1,22616),c.addedDocuments.size>0?m.cu=!0:c.modifiedDocuments.size>0?Ps(m.cu,14607):c.removedDocuments.size>0&&(Ps(m.cu,42227),m.cu=!1))}),await JA(n,r,e)}catch(r){await bT(r)}}function oF(t,e,n){const r=ar(t);if(r.isPrimaryClient&&n===0||!r.isPrimaryClient&&n===1){const c=[];r.hu.forEach((d,m)=>{const s=m.view.Fa(e);s.snapshot&&c.push(s.snapshot)}),function(m,s){const T=ar(m);T.onlineState=s;let D=!1;T.queries.forEach((P,z)=>{for(const F of z.Sa)F.Fa(s)&&(D=!0)}),D&&q2(T)}(r.eventManager,e),c.length&&r.lu.Y_(c),r.onlineState=e,r.isPrimaryClient&&r.sharedClientState.setOnlineState(e)}}async function wre(t,e,n){const r=ar(t);r.sharedClientState.updateQueryState(e,"rejected",n);const c=r.Eu.get(e),d=c&&c.key;if(d){let m=new Bo(Ni.comparator);m=m.insert(d,Nc.newNoDocument(d,or.min()));const s=Qr().add(d),T=new XI(or.min(),new Map,new Bo(Fr),m,s);await N6(r,T),r.Iu=r.Iu.remove(d),r.Eu.delete(e),Y2(r)}else await Jk(r.localStore,e,!1).then(()=>nN(r,e,n)).catch(bT)}async function Tre(t,e){const n=ar(t),r=e.batch.batchId;try{const c=await Pie(n.localStore,e);z6(n,r,null),L6(n,r),n.sharedClientState.updateMutationState(r,"acknowledged"),await JA(n,c)}catch(c){await bT(c)}}async function Ere(t,e,n){const r=ar(t);try{const c=await function(m,s){const T=ar(m);return T.persistence.runTransaction("Reject batch","readwrite-primary",D=>{let P;return T.mutationQueue.lookupMutationBatch(D,s).next(z=>(Ps(z!==null,37113),P=z.keys(),T.mutationQueue.removeMutationBatch(D,z))).next(()=>T.mutationQueue.performConsistencyCheck(D)).next(()=>T.documentOverlayCache.removeOverlaysForBatchId(D,P,s)).next(()=>T.localDocuments.recalculateAndSaveOverlaysForDocumentKeys(D,P)).next(()=>T.localDocuments.getDocuments(D,P))})}(r.localStore,e);z6(r,e,n),L6(r,e),r.sharedClientState.updateMutationState(e,"rejected",n),await JA(r,c)}catch(c){await bT(c)}}function L6(t,e){(t.Ru.get(e)||[]).forEach(n=>{n.resolve()}),t.Ru.delete(e)}function z6(t,e,n){const r=ar(t);let c=r.Au[r.currentUser.toKey()];if(c){const d=c.get(e);d&&(n?d.reject(n):d.resolve(),c=c.remove(e)),r.Au[r.currentUser.toKey()]=c}}function nN(t,e,n=null){t.sharedClientState.removeLocalQueryTarget(e);for(const r of t.Pu.get(e))t.hu.delete(r),n&&t.lu.gu(r,n);t.Pu.delete(e),t.isPrimaryClient&&t.du.Hr(e).forEach(r=>{t.du.containsKey(r)||B6(t,r)})}function B6(t,e){t.Tu.delete(e.path.canonicalString());const n=t.Iu.get(e);n!==null&&(V2(t.remoteStore,n),t.Iu=t.Iu.remove(e),t.Eu.delete(n),Y2(t))}function aF(t,e,n){for(const r of n)r instanceof M6?(t.du.addReference(r.key,e),Sre(t,r)):r instanceof P6?(ui(W2,"Document no longer in limbo: "+r.key),t.du.removeReference(r.key,e),t.du.containsKey(r.key)||B6(t,r.key)):Zi(19791,{pu:r})}function Sre(t,e){const n=e.key,r=n.path.canonicalString();t.Iu.get(n)||t.Tu.has(r)||(ui(W2,"New document in limbo: "+n),t.Tu.add(r),Y2(t))}function Y2(t){for(;t.Tu.size>0&&t.Iu.size<t.maxConcurrentLimboResolutions;){const e=t.Tu.values().next().value;t.Tu.delete(e);const n=new Ni(bo.fromString(e)),r=t.Vu.next();t.Eu.set(r,new pre(n)),t.Iu=t.Iu.insert(n,r),T6(t.remoteStore,new Pv(Hm(GI(n.path)),r,"TargetPurposeLimboResolution",jI.le))}}async function JA(t,e,n){const r=ar(t),c=[],d=[],m=[];r.hu.isEmpty()||(r.hu.forEach((s,T)=>{m.push(r.fu(T,e,n).then(D=>{var P;if((D||n)&&r.isPrimaryClient){const z=D?!D.fromCache:(P=n==null?void 0:n.targetChanges.get(T.targetId))===null||P===void 0?void 0:P.current;r.sharedClientState.updateQueryState(T.targetId,z?"current":"not-current")}if(D){c.push(D);const z=B2.Rs(T.targetId,D);d.push(z)}}))}),await Promise.all(m),r.lu.Y_(c),await async function(T,D){const P=ar(T);try{await P.persistence.runTransaction("notifyLocalViewChanges","readwrite",z=>Dn.forEach(D,F=>Dn.forEach(F.ds,$=>P.persistence.referenceDelegate.addReference(z,F.targetId,$)).next(()=>Dn.forEach(F.As,$=>P.persistence.referenceDelegate.removeReference(z,F.targetId,$)))))}catch(z){if(!xT(z))throw z;ui(F2,"Failed to update sequence numbers: "+z)}for(const z of D){const F=z.targetId;if(!z.fromCache){const $=P.xs.get(F),J=$.snapshotVersion,X=$.withLastLimboFreeSnapshotVersion(J);P.xs=P.xs.insert(F,X)}}}(r.localStore,d))}async function Are(t,e){const n=ar(t);if(!n.currentUser.isEqual(e)){ui(W2,"User change. New user:",e.toKey());const r=await v6(n.localStore,e);n.currentUser=e,function(d,m){d.Ru.forEach(s=>{s.forEach(T=>{T.reject(new pi(In.CANCELLED,m))})}),d.Ru.clear()}(n,"'waitForPendingWrites' promise is rejected due to a user change."),n.sharedClientState.handleUserChange(e,r.removedBatchIds,r.addedBatchIds),await JA(n,r.ks)}}function Cre(t,e){const n=ar(t),r=n.Eu.get(e);if(r&&r.cu)return Qr().add(r.key);{let c=Qr();const d=n.Pu.get(e);if(!d)return c;for(const m of d){const s=n.hu.get(m);c=c.unionWith(s.view.eu)}return c}}function F6(t){const e=ar(t);return e.remoteStore.remoteSyncer.applyRemoteEvent=N6.bind(null,e),e.remoteStore.remoteSyncer.getRemoteKeysForTarget=Cre.bind(null,e),e.remoteStore.remoteSyncer.rejectListen=wre.bind(null,e),e.lu.Y_=ure.bind(null,e.eventManager),e.lu.gu=hre.bind(null,e.eventManager),e}function Dre(t){const e=ar(t);return e.remoteStore.remoteSyncer.applySuccessfulWrite=Tre.bind(null,e),e.remoteStore.remoteSyncer.rejectFailedWrite=Ere.bind(null,e),e}class FO{constructor(){this.kind="memory",this.synchronizeTabs=!1}async initialize(e){this.serializer=QI(e.databaseInfo.databaseId),this.sharedClientState=this.bu(e),this.persistence=this.Su(e),await this.persistence.start(),this.localStore=this.Du(e),this.gcScheduler=this.vu(e,this.localStore),this.indexBackfillerScheduler=this.Cu(e,this.localStore)}vu(e,n){return null}Cu(e,n){return null}Du(e){return Mie(this.persistence,new Rie,e.initialUser,this.serializer)}Su(e){return new y6(z2.fi,this.serializer)}bu(e){return new Fie}async terminate(){var e,n;(e=this.gcScheduler)===null||e===void 0||e.stop(),(n=this.indexBackfillerScheduler)===null||n===void 0||n.stop(),this.sharedClientState.shutdown(),await this.persistence.shutdown()}}FO.provider={build:()=>new FO};class Rre extends FO{constructor(e){super(),this.cacheSizeBytes=e}vu(e,n){Ps(this.persistence.referenceDelegate instanceof zO,46915);const r=this.persistence.referenceDelegate.garbageCollector;return new pie(r,e.asyncQueue,n)}Su(e){const n=this.cacheSizeBytes!==void 0?Uu.withCacheSize(this.cacheSizeBytes):Uu.DEFAULT;return new y6(r=>zO.fi(r,n),this.serializer)}}class iN{async initialize(e,n){this.localStore||(this.localStore=e.localStore,this.sharedClientState=e.sharedClientState,this.datastore=this.createDatastore(n),this.remoteStore=this.createRemoteStore(n),this.eventManager=this.createEventManager(n),this.syncEngine=this.createSyncEngine(n,!e.synchronizeTabs),this.sharedClientState.onlineStateHandler=r=>oF(this.syncEngine,r,1),this.remoteStore.remoteSyncer.handleCredentialChange=Are.bind(null,this.syncEngine),await are(this.remoteStore,this.syncEngine.isPrimaryClient))}createEventManager(e){return function(){return new cre}()}createDatastore(e){const n=QI(e.databaseInfo.databaseId),r=function(d){return new $ie(d)}(e.databaseInfo);return function(d,m,s,T){return new Yie(d,m,s,T)}(e.authCredentials,e.appCheckCredentials,r,n)}createRemoteStore(e){return function(r,c,d,m,s){return new Xie(r,c,d,m,s)}(this.localStore,this.datastore,e.asyncQueue,n=>oF(this.syncEngine,n,0),function(){return eF.C()?new eF:new Vie}())}createSyncEngine(e,n){return function(c,d,m,s,T,D,P){const z=new mre(c,d,m,s,T,D);return P&&(z.mu=!0),z}(this.localStore,this.remoteStore,this.eventManager,this.sharedClientState,e.initialUser,e.maxConcurrentLimboResolutions,n)}async terminate(){var e,n;await async function(c){const d=ar(c);ui(xx,"RemoteStore shutting down."),d.da.add(5),await KA(d),d.Ra.shutdown(),d.Va.set("Unknown")}(this.remoteStore),(e=this.datastore)===null||e===void 0||e.terminate(),(n=this.eventManager)===null||n===void 0||n.terminate()}}iN.provider={build:()=>new iN};/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 *//**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class V6{constructor(e){this.observer=e,this.muted=!1}next(e){this.muted||this.observer.next&&this.Mu(this.observer.next,e)}error(e){this.muted||(this.observer.error?this.Mu(this.observer.error,e):R_("Uncaught Error in snapshot listener:",e.toString()))}xu(){this.muted=!0}Mu(e,n){setTimeout(()=>{this.muted||e(n)},0)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const t0="FirestoreClient";class Ore{constructor(e,n,r,c,d){this.authCredentials=e,this.appCheckCredentials=n,this.asyncQueue=r,this.databaseInfo=c,this.user=kc.UNAUTHENTICATED,this.clientId=Oj.newId(),this.authCredentialListener=()=>Promise.resolve(),this.appCheckCredentialListener=()=>Promise.resolve(),this._uninitializedComponentsProvider=d,this.authCredentials.start(r,async m=>{ui(t0,"Received user=",m.uid),await this.authCredentialListener(m),this.user=m}),this.appCheckCredentials.start(r,m=>(ui(t0,"Received new app check token=",m),this.appCheckCredentialListener(m,this.user)))}get configuration(){return{asyncQueue:this.asyncQueue,databaseInfo:this.databaseInfo,clientId:this.clientId,authCredentials:this.authCredentials,appCheckCredentials:this.appCheckCredentials,initialUser:this.user,maxConcurrentLimboResolutions:100}}setCredentialChangeListener(e){this.authCredentialListener=e}setAppCheckTokenChangeListener(e){this.appCheckCredentialListener=e}terminate(){this.asyncQueue.enterRestrictedMode();const e=new $v;return this.asyncQueue.enqueueAndForgetEvenWhileRestricted(async()=>{try{this._onlineComponents&&await this._onlineComponents.terminate(),this._offlineComponents&&await this._offlineComponents.terminate(),this.authCredentials.shutdown(),this.appCheckCredentials.shutdown(),e.resolve()}catch(n){const r=G2(n,"Failed to shutdown persistence");e.reject(r)}}),e.promise}}async function IP(t,e){t.asyncQueue.verifyOperationInProgress(),ui(t0,"Initializing OfflineComponentProvider");const n=t.configuration;await e.initialize(n);let r=n.initialUser;t.setCredentialChangeListener(async c=>{r.isEqual(c)||(await v6(e.localStore,c),r=c)}),e.persistence.setDatabaseDeletedListener(()=>t.terminate()),t._offlineComponents=e}async function lF(t,e){t.asyncQueue.verifyOperationInProgress();const n=await U6(t);ui(t0,"Initializing OnlineComponentProvider"),await e.initialize(n,t.configuration),t.setCredentialChangeListener(r=>nF(e.remoteStore,r)),t.setAppCheckTokenChangeListener((r,c)=>nF(e.remoteStore,c)),t._onlineComponents=e}async function U6(t){if(!t._offlineComponents)if(t._uninitializedComponentsProvider){ui(t0,"Using user provided OfflineComponentProvider");try{await IP(t,t._uninitializedComponentsProvider._offline)}catch(e){const n=e;if(!function(c){return c.name==="FirebaseError"?c.code===In.FAILED_PRECONDITION||c.code===In.UNIMPLEMENTED:!(typeof DOMException<"u"&&c instanceof DOMException)||c.code===22||c.code===20||c.code===11}(n))throw n;Kw("Error using user provided cache. Falling back to memory cache: "+n),await IP(t,new FO)}}else ui(t0,"Using default OfflineComponentProvider"),await IP(t,new Rre(void 0));return t._offlineComponents}async function Z2(t){return t._onlineComponents||(t._uninitializedComponentsProvider?(ui(t0,"Using user provided OnlineComponentProvider"),await lF(t,t._uninitializedComponentsProvider._online)):(ui(t0,"Using default OnlineComponentProvider"),await lF(t,new iN))),t._onlineComponents}function Ire(t){return U6(t).then(e=>e.persistence)}function Mre(t){return Z2(t).then(e=>e.remoteStore)}function Pre(t){return Z2(t).then(e=>e.syncEngine)}async function rN(t){const e=await Z2(t),n=e.eventManager;return n.onListen=gre.bind(null,e.syncEngine),n.onUnlisten=vre.bind(null,e.syncEngine),n.onFirstRemoteStoreListen=_re.bind(null,e.syncEngine),n.onLastRemoteStoreUnlisten=bre.bind(null,e.syncEngine),n}function kre(t){return t.asyncQueue.enqueue(async()=>{const e=await Ire(t),n=await Mre(t);return e.setNetworkEnabled(!0),function(c){const d=ar(c);return d.da.delete(0),QA(d)}(n)})}function Nre(t,e,n={}){const r=new $v;return t.asyncQueue.enqueueAndForget(async()=>function(d,m,s,T,D){const P=new V6({next:F=>{P.xu(),m.enqueueAndForget(()=>O6(d,z));const $=F.docs.has(s);!$&&F.fromCache?D.reject(new pi(In.UNAVAILABLE,"Failed to get document because the client is offline.")):$&&F.fromCache&&T&&T.source==="server"?D.reject(new pi(In.UNAVAILABLE,'Failed to get document from server. (However, this document does exist in the local cache. Run again without setting source to "server" to retrieve the cached document.)')):D.resolve(F)},error:F=>D.reject(F)}),z=new I6(GI(s.path),P,{includeMetadataChanges:!0,Qa:!0});return R6(d,z)}(await rN(t),t.asyncQueue,e,n,r)),r.promise}/**
 * @license
 * Copyright 2023 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function j6(t){const e={};return t.timeoutSeconds!==void 0&&(e.timeoutSeconds=t.timeoutSeconds),e}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const cF=new Map;/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function H6(t,e,n){if(!n)throw new pi(In.INVALID_ARGUMENT,`Function ${t}() cannot be called with an empty ${e}.`)}function Lre(t,e,n,r){if(e===!0&&r===!0)throw new pi(In.INVALID_ARGUMENT,`${t} and ${n} cannot be used together.`)}function uF(t){if(!Ni.isDocumentKey(t))throw new pi(In.INVALID_ARGUMENT,`Invalid document reference. Document references must have an even number of segments, but ${t} has ${t.length}.`)}function hF(t){if(Ni.isDocumentKey(t))throw new pi(In.INVALID_ARGUMENT,`Invalid collection reference. Collection references must have an odd number of segments, but ${t} has ${t.length}.`)}function JI(t){if(t===void 0)return"undefined";if(t===null)return"null";if(typeof t=="string")return t.length>20&&(t=`${t.substring(0,20)}...`),JSON.stringify(t);if(typeof t=="number"||typeof t=="boolean")return""+t;if(typeof t=="object"){if(t instanceof Array)return"an array";{const e=function(r){return r.constructor?r.constructor.name:null}(t);return e?`a custom ${e} object`:"an object"}}return typeof t=="function"?"a function":Zi(12329,{type:typeof t})}function ef(t,e){if("_delegate"in t&&(t=t._delegate),!(t instanceof e)){if(e.name===t.constructor.name)throw new pi(In.INVALID_ARGUMENT,"Type does not match the expected instance. Did you pass a reference from a different Firestore SDK?");{const n=JI(t);throw new pi(In.INVALID_ARGUMENT,`Expected type '${e.name}', but it was: ${n}`)}}return t}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const $6="firestore.googleapis.com",dF=!0;class fF{constructor(e){var n,r;if(e.host===void 0){if(e.ssl!==void 0)throw new pi(In.INVALID_ARGUMENT,"Can't provide ssl option if host option is not set");this.host=$6,this.ssl=dF}else this.host=e.host,this.ssl=(n=e.ssl)!==null&&n!==void 0?n:dF;if(this.isUsingEmulator=e.emulatorOptions!==void 0,this.credentials=e.credentials,this.ignoreUndefinedProperties=!!e.ignoreUndefinedProperties,this.localCache=e.localCache,e.cacheSizeBytes===void 0)this.cacheSizeBytes=_6;else{if(e.cacheSizeBytes!==-1&&e.cacheSizeBytes<die)throw new pi(In.INVALID_ARGUMENT,"cacheSizeBytes must be at least 1048576");this.cacheSizeBytes=e.cacheSizeBytes}Lre("experimentalForceLongPolling",e.experimentalForceLongPolling,"experimentalAutoDetectLongPolling",e.experimentalAutoDetectLongPolling),this.experimentalForceLongPolling=!!e.experimentalForceLongPolling,this.experimentalForceLongPolling?this.experimentalAutoDetectLongPolling=!1:e.experimentalAutoDetectLongPolling===void 0?this.experimentalAutoDetectLongPolling=!0:this.experimentalAutoDetectLongPolling=!!e.experimentalAutoDetectLongPolling,this.experimentalLongPollingOptions=j6((r=e.experimentalLongPollingOptions)!==null&&r!==void 0?r:{}),function(d){if(d.timeoutSeconds!==void 0){if(isNaN(d.timeoutSeconds))throw new pi(In.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (must not be NaN)`);if(d.timeoutSeconds<5)throw new pi(In.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (minimum allowed value is 5)`);if(d.timeoutSeconds>30)throw new pi(In.INVALID_ARGUMENT,`invalid long polling timeout: ${d.timeoutSeconds} (maximum allowed value is 30)`)}}(this.experimentalLongPollingOptions),this.useFetchStreams=!!e.useFetchStreams}isEqual(e){return this.host===e.host&&this.ssl===e.ssl&&this.credentials===e.credentials&&this.cacheSizeBytes===e.cacheSizeBytes&&this.experimentalForceLongPolling===e.experimentalForceLongPolling&&this.experimentalAutoDetectLongPolling===e.experimentalAutoDetectLongPolling&&function(r,c){return r.timeoutSeconds===c.timeoutSeconds}(this.experimentalLongPollingOptions,e.experimentalLongPollingOptions)&&this.ignoreUndefinedProperties===e.ignoreUndefinedProperties&&this.useFetchStreams===e.useFetchStreams}}class eM{constructor(e,n,r,c){this._authCredentials=e,this._appCheckCredentials=n,this._databaseId=r,this._app=c,this.type="firestore-lite",this._persistenceKey="(lite)",this._settings=new fF({}),this._settingsFrozen=!1,this._emulatorOptions={},this._terminateTask="notTerminated"}get app(){if(!this._app)throw new pi(In.FAILED_PRECONDITION,"Firestore was not initialized using the Firebase SDK. 'app' is not available");return this._app}get _initialized(){return this._settingsFrozen}get _terminated(){return this._terminateTask!=="notTerminated"}_setSettings(e){if(this._settingsFrozen)throw new pi(In.FAILED_PRECONDITION,"Firestore has already been started and its settings can no longer be changed. You can only modify settings before calling any other methods on a Firestore object.");this._settings=new fF(e),this._emulatorOptions=e.emulatorOptions||{},e.credentials!==void 0&&(this._authCredentials=function(r){if(!r)return new Hte;switch(r.type){case"firstParty":return new Wte(r.sessionIndex||"0",r.iamToken||null,r.authTokenFactory||null);case"provider":return r.client;default:throw new pi(In.INVALID_ARGUMENT,"makeAuthCredentialsProvider failed due to invalid credential type")}}(e.credentials))}_getSettings(){return this._settings}_getEmulatorOptions(){return this._emulatorOptions}_freezeSettings(){return this._settingsFrozen=!0,this._settings}_delete(){return this._terminateTask==="notTerminated"&&(this._terminateTask=this._terminate()),this._terminateTask}async _restart(){this._terminateTask==="notTerminated"?await this._terminate():this._terminateTask="notTerminated"}toJSON(){return{app:this._app,databaseId:this._databaseId,settings:this._settings}}_terminate(){return function(n){const r=cF.get(n);r&&(ui("ComponentProvider","Removing Datastore"),cF.delete(n),r.terminate())}(this),Promise.resolve()}}function zre(t,e,n,r={}){var c;t=ef(t,eM);const d=gT(e),m=t._getSettings(),s=Object.assign(Object.assign({},m),{emulatorOptions:t._getEmulatorOptions()}),T=`${e}:${n}`;d&&(P4(`https://${T}`),k4("Firestore",!0)),m.host!==$6&&m.host!==T&&Kw("Host has been set in both settings() and connectFirestoreEmulator(), emulator host will be used.");const D=Object.assign(Object.assign({},m),{host:T,ssl:d,emulatorOptions:r});if(!A_(D,s)&&(t._setSettings(D),r.mockUserToken)){let P,z;if(typeof r.mockUserToken=="string")P=r.mockUserToken,z=kc.MOCK_USER;else{P=KQ(r.mockUserToken,(c=t._app)===null||c===void 0?void 0:c.options.projectId);const F=r.mockUserToken.sub||r.mockUserToken.user_id;if(!F)throw new pi(In.INVALID_ARGUMENT,"mockUserToken must contain 'sub' or 'user_id' field!");z=new kc(F)}t._authCredentials=new $te(new Dj(P,z))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class TT{constructor(e,n,r){this.converter=n,this._query=r,this.type="query",this.firestore=e}withConverter(e){return new TT(this.firestore,e,this._query)}}class Vc{constructor(e,n,r){this.converter=n,this._key=r,this.type="document",this.firestore=e}get _path(){return this._key.path}get id(){return this._key.path.lastSegment()}get path(){return this._key.path.canonicalString()}get parent(){return new Gv(this.firestore,this.converter,this._key.path.popLast())}withConverter(e){return new Vc(this.firestore,e,this._key)}}class Gv extends TT{constructor(e,n,r){super(e,n,GI(r)),this._path=r,this.type="collection"}get id(){return this._query.path.lastSegment()}get path(){return this._query.path.canonicalString()}get parent(){const e=this._path.popLast();return e.isEmpty()?null:new Vc(this.firestore,null,new Ni(e))}withConverter(e){return new Gv(this.firestore,e,this._path)}}function sN(t,e,...n){if(t=Va(t),H6("collection","path",e),t instanceof eM){const r=bo.fromString(e,...n);return hF(r),new Gv(t,null,r)}{if(!(t instanceof Vc||t instanceof Gv))throw new pi(In.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(bo.fromString(e,...n));return hF(r),new Gv(t.firestore,null,r)}}function Hh(t,e,...n){if(t=Va(t),arguments.length===1&&(e=Oj.newId()),H6("doc","path",e),t instanceof eM){const r=bo.fromString(e,...n);return uF(r),new Vc(t,null,new Ni(r))}{if(!(t instanceof Vc||t instanceof Gv))throw new pi(In.INVALID_ARGUMENT,"Expected first argument to collection() to be a CollectionReference, a DocumentReference or FirebaseFirestore");const r=t._path.child(bo.fromString(e,...n));return uF(r),new Vc(t.firestore,t instanceof Gv?t.converter:null,new Ni(r))}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const pF="AsyncQueue";class mF{constructor(e=Promise.resolve()){this.Ju=[],this.Yu=!1,this.Zu=[],this.Xu=null,this.ec=!1,this.tc=!1,this.nc=[],this.x_=new x6(this,"async_queue_retry"),this.rc=()=>{const r=OP();r&&ui(pF,"Visibility state changed to "+r.visibilityState),this.x_.b_()},this.sc=e;const n=OP();n&&typeof n.addEventListener=="function"&&n.addEventListener("visibilitychange",this.rc)}get isShuttingDown(){return this.Yu}enqueueAndForget(e){this.enqueue(e)}enqueueAndForgetEvenWhileRestricted(e){this.oc(),this._c(e)}enterRestrictedMode(e){if(!this.Yu){this.Yu=!0,this.tc=e||!1;const n=OP();n&&typeof n.removeEventListener=="function"&&n.removeEventListener("visibilitychange",this.rc)}}enqueue(e){if(this.oc(),this.Yu)return new Promise(()=>{});const n=new $v;return this._c(()=>this.Yu&&this.tc?Promise.resolve():(e().then(n.resolve,n.reject),n.promise)).then(()=>n.promise)}enqueueRetryable(e){this.enqueueAndForget(()=>(this.Ju.push(e),this.ac()))}async ac(){if(this.Ju.length!==0){try{await this.Ju[0](),this.Ju.shift(),this.x_.reset()}catch(e){if(!xT(e))throw e;ui(pF,"Operation failed with retryable error: "+e)}this.Ju.length>0&&this.x_.y_(()=>this.ac())}}_c(e){const n=this.sc.then(()=>(this.ec=!0,e().catch(r=>{throw this.Xu=r,this.ec=!1,R_("INTERNAL UNHANDLED ERROR: ",gF(r)),r}).then(r=>(this.ec=!1,r))));return this.sc=n,n}enqueueAfterDelay(e,n,r){this.oc(),this.nc.indexOf(e)>-1&&(n=0);const c=$2.createAndSchedule(this,e,n,r,d=>this.uc(d));return this.Zu.push(c),c}oc(){this.Xu&&Zi(47125,{cc:gF(this.Xu)})}verifyOperationInProgress(){}async lc(){let e;do e=this.sc,await e;while(e!==this.sc)}hc(e){for(const n of this.Zu)if(n.timerId===e)return!0;return!1}Pc(e){return this.lc().then(()=>{this.Zu.sort((n,r)=>n.targetTimeMs-r.targetTimeMs);for(const n of this.Zu)if(n.skipDelay(),e!=="all"&&n.timerId===e)break;return this.lc()})}Tc(e){this.nc.push(e)}uc(e){const n=this.Zu.indexOf(e);this.Zu.splice(n,1)}}function gF(t){let e=t.message||"";return t.stack&&(e=t.stack.includes(t.message)?t.stack:t.message+`
`+t.stack),e}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function _F(t){return function(n,r){if(typeof n!="object"||n===null)return!1;const c=n;for(const d of r)if(d in c&&typeof c[d]=="function")return!0;return!1}(t,["next","error","complete"])}class n0 extends eM{constructor(e,n,r,c){super(e,n,r,c),this.type="firestore",this._queue=new mF,this._persistenceKey=(c==null?void 0:c.name)||"[DEFAULT]"}async _terminate(){if(this._firestoreClient){const e=this._firestoreClient.terminate();this._queue=new mF(e),this._firestoreClient=void 0,await e}}}function Bre(t,e){const n=typeof t=="object"?t:B4(),r=typeof t=="string"?t:OO,c=m2(n,"firestore").getImmediate({identifier:r});if(!c._initialized){const d=XQ("firestore");d&&zre(c,...d)}return c}function tM(t){if(t._terminated)throw new pi(In.FAILED_PRECONDITION,"The client has already been terminated.");return t._firestoreClient||Fre(t),t._firestoreClient}function Fre(t){var e,n,r;const c=t._freezeSettings(),d=function(s,T,D,P){return new lne(s,T,D,P.host,P.ssl,P.experimentalForceLongPolling,P.experimentalAutoDetectLongPolling,j6(P.experimentalLongPollingOptions),P.useFetchStreams,P.isUsingEmulator)}(t._databaseId,((e=t._app)===null||e===void 0?void 0:e.options.appId)||"",t._persistenceKey,c);t._componentsProvider||!((n=c.localCache)===null||n===void 0)&&n._offlineComponentProvider&&(!((r=c.localCache)===null||r===void 0)&&r._onlineComponentProvider)&&(t._componentsProvider={_offline:c.localCache._offlineComponentProvider,_online:c.localCache._onlineComponentProvider}),t._firestoreClient=new Ore(t._authCredentials,t._appCheckCredentials,t._queue,d,t._componentsProvider&&function(s){const T=s==null?void 0:s._online.build();return{_offline:s==null?void 0:s._offline.build(T),_online:T}}(t._componentsProvider))}function Vre(t){return kre(tM(t=ef(t,n0)))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class oT{constructor(e){this._byteString=e}static fromBase64String(e){try{return new oT(Kl.fromBase64String(e))}catch(n){throw new pi(In.INVALID_ARGUMENT,"Failed to construct data from Base64 string: "+n)}}static fromUint8Array(e){return new oT(Kl.fromUint8Array(e))}toBase64(){return this._byteString.toBase64()}toUint8Array(){return this._byteString.toUint8Array()}toString(){return"Bytes(base64: "+this.toBase64()+")"}isEqual(e){return this._byteString.isEqual(e._byteString)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class nM{constructor(...e){for(let n=0;n<e.length;++n)if(e[n].length===0)throw new pi(In.INVALID_ARGUMENT,"Invalid field name at argument $(i + 1). Field names must not be empty.");this._internalPath=new Ql(e)}isEqual(e){return this._internalPath.isEqual(e._internalPath)}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class eC{constructor(e){this._methodName=e}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class X2{constructor(e,n){if(!isFinite(e)||e<-90||e>90)throw new pi(In.INVALID_ARGUMENT,"Latitude must be a number between -90 and 90, but was: "+e);if(!isFinite(n)||n<-180||n>180)throw new pi(In.INVALID_ARGUMENT,"Longitude must be a number between -180 and 180, but was: "+n);this._lat=e,this._long=n}get latitude(){return this._lat}get longitude(){return this._long}isEqual(e){return this._lat===e._lat&&this._long===e._long}toJSON(){return{latitude:this._lat,longitude:this._long}}_compareTo(e){return Fr(this._lat,e._lat)||Fr(this._long,e._long)}}/**
 * @license
 * Copyright 2024 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q2{constructor(e){this._values=(e||[]).map(n=>n)}toArray(){return this._values.map(e=>e)}isEqual(e){return function(r,c){if(r.length!==c.length)return!1;for(let d=0;d<r.length;++d)if(r[d]!==c[d])return!1;return!0}(this._values,e._values)}}/**
 * @license
 * Copyright 2017 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */const Ure=/^__.*__$/;class jre{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return this.fieldMask!==null?new u0(e,this.data,this.fieldMask,n,this.fieldTransforms):new ZA(e,this.data,n,this.fieldTransforms)}}class G6{constructor(e,n,r){this.data=e,this.fieldMask=n,this.fieldTransforms=r}toMutation(e,n){return new u0(e,this.data,this.fieldMask,n,this.fieldTransforms)}}function q6(t){switch(t){case 0:case 2:case 1:return!0;case 3:case 4:return!1;default:throw Zi(40011,{Ic:t})}}class iM{constructor(e,n,r,c,d,m){this.settings=e,this.databaseId=n,this.serializer=r,this.ignoreUndefinedProperties=c,d===void 0&&this.Ec(),this.fieldTransforms=d||[],this.fieldMask=m||[]}get path(){return this.settings.path}get Ic(){return this.settings.Ic}dc(e){return new iM(Object.assign(Object.assign({},this.settings),e),this.databaseId,this.serializer,this.ignoreUndefinedProperties,this.fieldTransforms,this.fieldMask)}Ac(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),c=this.dc({path:r,Rc:!1});return c.Vc(e),c}mc(e){var n;const r=(n=this.path)===null||n===void 0?void 0:n.child(e),c=this.dc({path:r,Rc:!1});return c.Ec(),c}fc(e){return this.dc({path:void 0,Rc:!0})}gc(e){return VO(e,this.settings.methodName,this.settings.yc||!1,this.path,this.settings.wc)}contains(e){return this.fieldMask.find(n=>e.isPrefixOf(n))!==void 0||this.fieldTransforms.find(n=>e.isPrefixOf(n.field))!==void 0}Ec(){if(this.path)for(let e=0;e<this.path.length;e++)this.Vc(this.path.get(e))}Vc(e){if(e.length===0)throw this.gc("Document fields must not be empty");if(q6(this.Ic)&&Ure.test(e))throw this.gc('Document fields cannot begin and end with "__"')}}class Hre{constructor(e,n,r){this.databaseId=e,this.ignoreUndefinedProperties=n,this.serializer=r||QI(e)}bc(e,n,r,c=!1){return new iM({Ic:e,methodName:n,wc:r,path:Ql.emptyPath(),Rc:!1,yc:c},this.databaseId,this.serializer,this.ignoreUndefinedProperties)}}function K2(t){const e=t._freezeSettings(),n=QI(t._databaseId);return new Hre(t._databaseId,!!e.ignoreUndefinedProperties,n)}function $re(t,e,n,r,c,d={}){const m=t.bc(d.merge||d.mergeFields?2:0,e,n,c);tL("Data must be an object, but it was:",m,r);const s=Y6(r,m);let T,D;if(d.merge)T=new Gh(m.fieldMask),D=m.fieldTransforms;else if(d.mergeFields){const P=[];for(const z of d.mergeFields){const F=oN(e,z,n);if(!m.contains(F))throw new pi(In.INVALID_ARGUMENT,`Field '${F}' is specified in your field mask but missing from your input data.`);X6(P,F)||P.push(F)}T=new Gh(P),D=m.fieldTransforms.filter(z=>T.covers(z.field))}else T=null,D=m.fieldTransforms;return new jre(new ju(s),T,D)}class rM extends eC{_toFieldTransform(e){if(e.Ic!==2)throw e.Ic===1?e.gc(`${this._methodName}() can only appear at the top level of your update data`):e.gc(`${this._methodName}() cannot be used with set() unless you pass {merge:true}`);return e.fieldMask.push(e.path),null}isEqual(e){return e instanceof rM}}function W6(t,e,n){return new iM({Ic:3,wc:e.settings.wc,methodName:t._methodName,Rc:n},e.databaseId,e.serializer,e.ignoreUndefinedProperties)}class J2 extends eC{constructor(e,n){super(e),this.Sc=n}_toFieldTransform(e){const n=W6(this,e,!0),r=this.Sc.map(d=>Ix(d,n)),c=new nT(r);return new r6(e.path,c)}isEqual(e){return e instanceof J2&&A_(this.Sc,e.Sc)}}class eL extends eC{constructor(e,n){super(e),this.Sc=n}_toFieldTransform(e){const n=W6(this,e,!0),r=this.Sc.map(d=>Ix(d,n)),c=new iT(r);return new r6(e.path,c)}isEqual(e){return e instanceof eL&&A_(this.Sc,e.Sc)}}function Gre(t,e,n,r){const c=t.bc(1,e,n);tL("Data must be an object, but it was:",c,r);const d=[],m=ju.empty();c0(r,(T,D)=>{const P=nL(e,T,n);D=Va(D);const z=c.mc(P);if(D instanceof rM)d.push(P);else{const F=Ix(D,z);F!=null&&(d.push(P),m.set(P,F))}});const s=new Gh(d);return new G6(m,s,c.fieldTransforms)}function qre(t,e,n,r,c,d){const m=t.bc(1,e,n),s=[oN(e,r,n)],T=[c];if(d.length%2!=0)throw new pi(In.INVALID_ARGUMENT,`Function ${e}() needs to be called with an even number of arguments that alternate between field names and values.`);for(let F=0;F<d.length;F+=2)s.push(oN(e,d[F])),T.push(d[F+1]);const D=[],P=ju.empty();for(let F=s.length-1;F>=0;--F)if(!X6(D,s[F])){const $=s[F];let J=T[F];J=Va(J);const X=m.mc($);if(J instanceof rM)D.push($);else{const te=Ix(J,X);te!=null&&(D.push($),P.set($,te))}}const z=new Gh(D);return new G6(P,z,m.fieldTransforms)}function Wre(t,e,n,r=!1){return Ix(n,t.bc(r?4:3,e))}function Ix(t,e){if(Z6(t=Va(t)))return tL("Unsupported field value:",e,t),Y6(t,e);if(t instanceof eC)return function(r,c){if(!q6(c.Ic))throw c.gc(`${r._methodName}() can only be used with update() and set()`);if(!c.path)throw c.gc(`${r._methodName}() is not currently supported inside arrays`);const d=r._toFieldTransform(c);d&&c.fieldTransforms.push(d)}(t,e),null;if(t===void 0&&e.ignoreUndefinedProperties)return null;if(e.path&&e.fieldMask.push(e.path),t instanceof Array){if(e.settings.Rc&&e.Ic!==4)throw e.gc("Nested arrays are not supported");return function(r,c){const d=[];let m=0;for(const s of r){let T=Ix(s,c.fc(m));T==null&&(T={nullValue:"NULL_VALUE"}),d.push(T),m++}return{arrayValue:{values:d}}}(t,e)}return function(r,c){if((r=Va(r))===null)return{nullValue:"NULL_VALUE"};if(typeof r=="number")return Ine(c.serializer,r);if(typeof r=="boolean")return{booleanValue:r};if(typeof r=="string")return{stringValue:r};if(r instanceof Date){const d=xo.fromDate(r);return{timestampValue:LO(c.serializer,d)}}if(r instanceof xo){const d=new xo(r.seconds,1e3*Math.floor(r.nanoseconds/1e3));return{timestampValue:LO(c.serializer,d)}}if(r instanceof X2)return{geoPointValue:{latitude:r.latitude,longitude:r.longitude}};if(r instanceof oT)return{bytesValue:u6(c.serializer,r._byteString)};if(r instanceof Vc){const d=c.databaseId,m=r.firestore._databaseId;if(!m.isEqual(d))throw c.gc(`Document reference is for database ${m.projectId}/${m.database} but should be for database ${d.projectId}/${d.database}`);return{referenceValue:N2(r.firestore._databaseId||c.databaseId,r._key.path)}}if(r instanceof Q2)return function(m,s){return{mapValue:{fields:{[Bj]:{stringValue:Fj},[IO]:{arrayValue:{values:m.toArray().map(D=>{if(typeof D!="number")throw s.gc("VectorValues must only contain numeric values.");return I2(s.serializer,D)})}}}}}}(r,c);throw c.gc(`Unsupported field value: ${JI(r)}`)}(t,e)}function Y6(t,e){const n={};return Mj(t)?e.path&&e.path.length>0&&e.fieldMask.push(e.path):c0(t,(r,c)=>{const d=Ix(c,e.Ac(r));d!=null&&(n[r]=d)}),{mapValue:{fields:n}}}function Z6(t){return!(typeof t!="object"||t===null||t instanceof Array||t instanceof Date||t instanceof xo||t instanceof X2||t instanceof oT||t instanceof Vc||t instanceof eC||t instanceof Q2)}function tL(t,e,n){if(!Z6(n)||!function(c){return typeof c=="object"&&c!==null&&(Object.getPrototypeOf(c)===Object.prototype||Object.getPrototypeOf(c)===null)}(n)){const r=JI(n);throw r==="an object"?e.gc(t+" a custom object"):e.gc(t+" "+r)}}function oN(t,e,n){if((e=Va(e))instanceof nM)return e._internalPath;if(typeof e=="string")return nL(t,e);throw VO("Field path arguments must be of type string or ",t,!1,void 0,n)}const Yre=new RegExp("[~\\*/\\[\\]]");function nL(t,e,n){if(e.search(Yre)>=0)throw VO(`Invalid field path (${e}). Paths must not contain '~', '*', '/', '[', or ']'`,t,!1,void 0,n);try{return new nM(...e.split("."))._internalPath}catch{throw VO(`Invalid field path (${e}). Paths must not be empty, begin with '.', end with '.', or contain '..'`,t,!1,void 0,n)}}function VO(t,e,n,r,c){const d=r&&!r.isEmpty(),m=c!==void 0;let s=`Function ${e}() called with invalid data`;n&&(s+=" (via `toFirestore()`)"),s+=". ";let T="";return(d||m)&&(T+=" (found",d&&(T+=` in field ${r}`),m&&(T+=` in document ${c}`),T+=")"),new pi(In.INVALID_ARGUMENT,s+t+T)}function X6(t,e){return t.some(n=>n.isEqual(e))}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class Q6{constructor(e,n,r,c,d){this._firestore=e,this._userDataWriter=n,this._key=r,this._document=c,this._converter=d}get id(){return this._key.path.lastSegment()}get ref(){return new Vc(this._firestore,this._converter,this._key)}exists(){return this._document!==null}data(){if(this._document){if(this._converter){const e=new Zre(this._firestore,this._userDataWriter,this._key,this._document,null);return this._converter.fromFirestore(e)}return this._userDataWriter.convertValue(this._document.data.value)}}get(e){if(this._document){const n=this._document.data.field(iL("DocumentSnapshot.get",e));if(n!==null)return this._userDataWriter.convertValue(n)}}}class Zre extends Q6{data(){return super.data()}}function iL(t,e){return typeof e=="string"?nL(t,e):e instanceof nM?e._internalPath:e._delegate._internalPath}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Xre(t){if(t.limitType==="L"&&t.explicitOrderBy.length===0)throw new pi(In.UNIMPLEMENTED,"limitToLast() queries require specifying at least one orderBy() clause")}class rL{}class Qre extends rL{}function aN(t,e,...n){let r=[];e instanceof rL&&r.push(e),r=r.concat(n),function(d){const m=d.filter(T=>T instanceof sL).length,s=d.filter(T=>T instanceof sM).length;if(m>1||m>0&&s>0)throw new pi(In.INVALID_ARGUMENT,"InvalidQuery. When using composite filters, you cannot use more than one filter at the top level. Consider nesting the multiple filters within an `and(...)` statement. For example: change `query(query, where(...), or(...))` to `query(query, and(where(...), or(...)))`.")}(r);for(const c of r)t=c._apply(t);return t}class sM extends Qre{constructor(e,n,r){super(),this._field=e,this._op=n,this._value=r,this.type="where"}static _create(e,n,r){return new sM(e,n,r)}_apply(e){const n=this._parse(e);return K6(e._query,n),new TT(e.firestore,e.converter,Wk(e._query,n))}_parse(e){const n=K2(e.firestore);return function(d,m,s,T,D,P,z){let F;if(D.isKeyField()){if(P==="array-contains"||P==="array-contains-any")throw new pi(In.INVALID_ARGUMENT,`Invalid Query. You can't perform '${P}' queries on documentId().`);if(P==="in"||P==="not-in"){vF(z,P);const J=[];for(const X of z)J.push(yF(T,d,X));F={arrayValue:{values:J}}}else F=yF(T,d,z)}else P!=="in"&&P!=="not-in"&&P!=="array-contains-any"||vF(z,P),F=Wre(s,m,z,P==="in"||P==="not-in");return Ba.create(D,P,F)}(e._query,"where",n,e.firestore._databaseId,this._field,this._op,this._value)}}function XR(t,e,n){const r=e,c=iL("where",t);return sM._create(c,r,n)}class sL extends rL{constructor(e,n){super(),this.type=e,this._queryConstraints=n}static _create(e,n){return new sL(e,n)}_parse(e){const n=this._queryConstraints.map(r=>r._parse(e)).filter(r=>r.getFilters().length>0);return n.length===1?n[0]:yp.create(n,this._getOperator())}_apply(e){const n=this._parse(e);return n.getFilters().length===0?e:(function(c,d){let m=c;const s=d.getFlattenedFilters();for(const T of s)K6(m,T),m=Wk(m,T)}(e._query,n),new TT(e.firestore,e.converter,Wk(e._query,n)))}_getQueryConstraints(){return this._queryConstraints}_getOperator(){return this.type==="and"?"and":"or"}}function yF(t,e,n){if(typeof(n=Va(n))=="string"){if(n==="")throw new pi(In.INVALID_ARGUMENT,"Invalid query. When querying with documentId(), you must provide a valid document ID, but it was an empty string.");if(!Wj(e)&&n.indexOf("/")!==-1)throw new pi(In.INVALID_ARGUMENT,`Invalid query. When querying a collection by documentId(), you must provide a plain document ID, but '${n}' contains a '/' character.`);const r=e.path.child(bo.fromString(n));if(!Ni.isDocumentKey(r))throw new pi(In.INVALID_ARGUMENT,`Invalid query. When querying a collection group by documentId(), the value provided must result in a valid document path, but '${r}' is not because it has an odd number of segments (${r.length}).`);return M3(t,new Ni(r))}if(n instanceof Vc)return M3(t,n._key);throw new pi(In.INVALID_ARGUMENT,`Invalid query. When querying with documentId(), you must provide a valid string or a DocumentReference, but it was: ${JI(n)}.`)}function vF(t,e){if(!Array.isArray(t)||t.length===0)throw new pi(In.INVALID_ARGUMENT,`Invalid Query. A non-empty array is required for '${e.toString()}' filters.`)}function K6(t,e){const n=function(c,d){for(const m of c)for(const s of m.getFlattenedFilters())if(d.indexOf(s.op)>=0)return s.op;return null}(t.filters,function(c){switch(c){case"!=":return["!=","not-in"];case"array-contains-any":case"in":return["not-in"];case"not-in":return["array-contains-any","in","not-in","!="];default:return[]}}(e.op));if(n!==null)throw n===e.op?new pi(In.INVALID_ARGUMENT,`Invalid query. You cannot use more than one '${e.op.toString()}' filter.`):new pi(In.INVALID_ARGUMENT,`Invalid query. You cannot use '${e.op.toString()}' filters with '${n.toString()}' filters.`)}class Kre{convertValue(e,n="none"){switch(Jv(e)){case 0:return null;case 1:return e.booleanValue;case 2:return ma(e.integerValue||e.doubleValue);case 3:return this.convertTimestamp(e.timestampValue);case 4:return this.convertServerTimestamp(e,n);case 5:return e.stringValue;case 6:return this.convertBytes(Kv(e.bytesValue));case 7:return this.convertReference(e.referenceValue);case 8:return this.convertGeoPoint(e.geoPointValue);case 9:return this.convertArray(e.arrayValue,n);case 11:return this.convertObject(e.mapValue,n);case 10:return this.convertVectorValue(e.mapValue);default:throw Zi(62114,{value:e})}}convertObject(e,n){return this.convertObjectMap(e.fields,n)}convertObjectMap(e,n="none"){const r={};return c0(e,(c,d)=>{r[c]=this.convertValue(d,n)}),r}convertVectorValue(e){var n,r,c;const d=(c=(r=(n=e.fields)===null||n===void 0?void 0:n[IO].arrayValue)===null||r===void 0?void 0:r.values)===null||c===void 0?void 0:c.map(m=>ma(m.doubleValue));return new Q2(d)}convertGeoPoint(e){return new X2(ma(e.latitude),ma(e.longitude))}convertArray(e,n){return(e.values||[]).map(r=>this.convertValue(r,n))}convertServerTimestamp(e,n){switch(n){case"previous":const r=$I(e);return r==null?null:this.convertValue(r,n);case"estimate":return this.convertTimestamp(pA(e));default:return null}}convertTimestamp(e){const n=Qv(e);return new xo(n.seconds,n.nanos)}convertDocumentKey(e,n){const r=bo.fromString(e);Ps(g6(r),9688,{name:e});const c=new mA(r.get(1),r.get(3)),d=new Ni(r.popFirst(5));return c.isEqual(n)||R_(`Document ${d} contains a document reference within a different database (${c.projectId}/${c.database}) which is not supported. It will be treated as a reference in the current database (${n.projectId}/${n.database}) instead.`),d}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function Jre(t,e,n){let r;return r=t?n&&(n.merge||n.mergeFields)?t.toFirestore(e,n):t.toFirestore(e):e,r}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */class OS{constructor(e,n){this.hasPendingWrites=e,this.fromCache=n}isEqual(e){return this.hasPendingWrites===e.hasPendingWrites&&this.fromCache===e.fromCache}}class J6 extends Q6{constructor(e,n,r,c,d,m){super(e,n,r,c,m),this._firestore=e,this._firestoreImpl=e,this.metadata=d}exists(){return super.exists()}data(e={}){if(this._document){if(this._converter){const n=new QR(this._firestore,this._userDataWriter,this._key,this._document,this.metadata,null);return this._converter.fromFirestore(n,e)}return this._userDataWriter.convertValue(this._document.data.value,e.serverTimestamps)}}get(e,n={}){if(this._document){const r=this._document.data.field(iL("DocumentSnapshot.get",e));if(r!==null)return this._userDataWriter.convertValue(r,n.serverTimestamps)}}}class QR extends J6{data(e={}){return super.data(e)}}class ese{constructor(e,n,r,c){this._firestore=e,this._userDataWriter=n,this._snapshot=c,this.metadata=new OS(c.hasPendingWrites,c.fromCache),this.query=r}get docs(){const e=[];return this.forEach(n=>e.push(n)),e}get size(){return this._snapshot.docs.size}get empty(){return this.size===0}forEach(e,n){this._snapshot.docs.forEach(r=>{e.call(n,new QR(this._firestore,this._userDataWriter,r.key,r,new OS(this._snapshot.mutatedKeys.has(r.key),this._snapshot.fromCache),this.query.converter))})}docChanges(e={}){const n=!!e.includeMetadataChanges;if(n&&this._snapshot.excludesMetadataChanges)throw new pi(In.INVALID_ARGUMENT,"To include metadata changes with your document changes, you must also pass { includeMetadataChanges:true } to onSnapshot().");return this._cachedChanges&&this._cachedChangesIncludeMetadataChanges===n||(this._cachedChanges=function(c,d){if(c._snapshot.oldDocs.isEmpty()){let m=0;return c._snapshot.docChanges.map(s=>{const T=new QR(c._firestore,c._userDataWriter,s.doc.key,s.doc,new OS(c._snapshot.mutatedKeys.has(s.doc.key),c._snapshot.fromCache),c.query.converter);return s.doc,{type:"added",doc:T,oldIndex:-1,newIndex:m++}})}{let m=c._snapshot.oldDocs;return c._snapshot.docChanges.filter(s=>d||s.type!==3).map(s=>{const T=new QR(c._firestore,c._userDataWriter,s.doc.key,s.doc,new OS(c._snapshot.mutatedKeys.has(s.doc.key),c._snapshot.fromCache),c.query.converter);let D=-1,P=-1;return s.type!==0&&(D=m.indexOf(s.doc.key),m=m.delete(s.doc.key)),s.type!==1&&(m=m.add(s.doc),P=m.indexOf(s.doc.key)),{type:tse(s.type),doc:T,oldIndex:D,newIndex:P}})}}(this,n),this._cachedChangesIncludeMetadataChanges=n),this._cachedChanges}}function tse(t){switch(t){case 0:return"added";case 2:case 3:return"modified";case 1:return"removed";default:return Zi(61501,{type:t})}}/**
 * @license
 * Copyright 2020 Google LLC
 *
 * Licensed under the Apache License, Version 2.0 (the "License");
 * you may not use this file except in compliance with the License.
 * You may obtain a copy of the License at
 *
 *   http://www.apache.org/licenses/LICENSE-2.0
 *
 * Unless required by applicable law or agreed to in writing, software
 * distributed under the License is distributed on an "AS IS" BASIS,
 * WITHOUT WARRANTIES OR CONDITIONS OF ANY KIND, either express or implied.
 * See the License for the specific language governing permissions and
 * limitations under the License.
 */function UO(t){t=ef(t,Vc);const e=ef(t.firestore,n0);return Nre(tM(e),t._key).then(n=>n8(e,t,n))}class e8 extends Kre{constructor(e){super(),this.firestore=e}convertBytes(e){return new oT(e)}convertReference(e){const n=this.convertDocumentKey(e,this.firestore._databaseId);return new Vc(this.firestore,null,n)}}function zw(t,e,n){t=ef(t,Vc);const r=ef(t.firestore,n0),c=Jre(t.converter,e,n);return oL(r,[$re(K2(r),"setDoc",t._key,c,t.converter!==null,n).toMutation(t._key,mp.none())])}function lR(t,e,n,...r){t=ef(t,Vc);const c=ef(t.firestore,n0),d=K2(c);let m;return m=typeof(e=Va(e))=="string"||e instanceof nM?qre(d,"updateDoc",t._key,e,n,r):Gre(d,"updateDoc",t._key,e),oL(c,[m.toMutation(t._key,mp.exists(!0))])}function t8(t){return oL(ef(t.firestore,n0),[new M2(t._key,mp.none())])}function lN(t,...e){var n,r,c;t=Va(t);let d={includeMetadataChanges:!1,source:"default"},m=0;typeof e[m]!="object"||_F(e[m])||(d=e[m],m++);const s={includeMetadataChanges:d.includeMetadataChanges,source:d.source};if(_F(e[m])){const z=e[m];e[m]=(n=z.next)===null||n===void 0?void 0:n.bind(z),e[m+1]=(r=z.error)===null||r===void 0?void 0:r.bind(z),e[m+2]=(c=z.complete)===null||c===void 0?void 0:c.bind(z)}let T,D,P;if(t instanceof Vc)D=ef(t.firestore,n0),P=GI(t._key.path),T={next:z=>{e[m]&&e[m](n8(D,t,z))},error:e[m+1],complete:e[m+2]};else{const z=ef(t,TT);D=ef(z.firestore,n0),P=z._query;const F=new e8(D);T={next:$=>{e[m]&&e[m](new ese(D,F,z,$))},error:e[m+1],complete:e[m+2]},Xre(t._query)}return function(F,$,J,X){const te=new V6(X),ie=new I6($,te,J);return F.asyncQueue.enqueueAndForget(async()=>R6(await rN(F),ie)),()=>{te.xu(),F.asyncQueue.enqueueAndForget(async()=>O6(await rN(F),ie))}}(tM(D),P,s,T)}function oL(t,e){return function(r,c){const d=new $v;return r.asyncQueue.enqueueAndForget(async()=>xre(await Pre(r),c,d)),d.promise}(tM(t),e)}function n8(t,e,n){const r=n.docs.get(e._key),c=new e8(t);return new J6(t,c,e._key,r,new OS(n.hasPendingWrites,n.fromCache),e.converter)}function bF(...t){return new J2("arrayUnion",t)}function nse(...t){return new eL("arrayRemove",t)}(function(e,n=!0){(function(c){vT=c})(_T),Xw(new _x("firestore",(r,{instanceIdentifier:c,options:d})=>{const m=r.getProvider("app").getImmediate(),s=new n0(new Gte(r.getProvider("auth-internal")),new Yte(m,r.getProvider("app-check-internal")),function(D,P){if(!Object.prototype.hasOwnProperty.apply(D.options,["projectId"]))throw new pi(In.INVALID_ARGUMENT,'"projectId" not provided in firebase.initializeApp.');return new mA(D.options.projectId,P)}(m,c),m);return d=Object.assign({useFetchStreams:n},d),s._setSettings(d),s},"PUBLIC").setMultipleInstances(!0)),jv(b3,x3,e),jv(b3,x3,"esm2017")})();const i8={apiKey:"AIzaSyApCBJSGIqCqjeOWNLjZHM7hy8L-F1_kdE",authDomain:"sprint8-f7949.firebaseapp.com",projectId:"sprint8-f7949",storageBucket:"sprint8-f7949.firebasestorage.app",messagingSenderId:"303033318964",appId:"1:303033318964:web:55d237e6eb93e0d8df9461"},xF=!0,ise=()=>["apiKey","authDomain","projectId","storageBucket","messagingSenderId","appId"].every(e=>{const n=i8[e];return n&&n.trim()!==""}),r8=z4(i8),Aw=Fte(r8),Xl=Bre(r8);ise()&&Vre(Xl).catch(()=>{});class rse{async updateUserProfile(e,n){try{const r=Aw.currentUser;if(!r||r.uid!==e)throw new Error("Usuario no autenticado o UID no coincide");n.displayName!==void 0&&await c3(r,{displayName:n.displayName});const c=Hh(Xl,"users",e),d=await UO(c);if(!d.exists())throw new Error("Perfil d'usuari no trobat a Firestore");const m=d.data(),s={...m,...n,uid:e,email:m.email};return await zw(c,s,{merge:!0}),s}catch(r){const c=r;throw new Error(c.message||"Error actualitzant el perfil")}}async registerUser(e,n,r,c,d){try{const s=(await wee(Aw,e,n)).user;await c3(s,{displayName:r});const T={uid:s.uid,email:s.email,displayName:r,postalCode:c,listOption:d,createdAt:new Date};try{await zw(Hh(Xl,"users",s.uid),T)}catch{}return T}catch(m){const s=m;throw new Error(this.getErrorMessage(s.code||"unknown"))}}async loginUser(e,n){try{const c=(await Tee(Aw,e,n)).user;try{const m=await this.getDocumentWithRetry("users",c.uid);if(m&&m.exists())return m.data()}catch{}return{uid:c.uid,email:c.email,displayName:c.displayName||"Usuari",postalCode:"08001",listOption:"new-list",createdAt:new Date}}catch(r){if(this.isNetworkError(r))throw new Error("Error de connexió. Comprova la teva connexió a internet i torna-ho a intentar.");const c=r;throw new Error(this.getErrorMessage(c.code||"unknown"))}}async logoutUser(){try{await Dee(Aw)}catch{throw new Error("Error en tancar sessió")}}async getCurrentUserProfile(){try{const e=Aw.currentUser;if(!e)return null;try{const n=await this.getDocumentWithRetry("users",e.uid);if(n&&n.exists())return n.data()}catch{}return{uid:e.uid,email:e.email,displayName:e.displayName||"Usuari",postalCode:"08001",listOption:"new-list",createdAt:new Date}}catch{return null}}async getDocumentWithRetry(e,n,r=2){for(let c=0;c<r;c++)try{const d=Hh(Xl,e,n);return await UO(d)}catch(d){if(c===r-1)throw d;await new Promise(m=>setTimeout(m,1e3*(c+1)))}}isNetworkError(e){var c,d,m,s;const n=["unavailable","deadline-exceeded","failed-precondition","network-request-failed"],r=e;return!!(r!=null&&r.code&&n.includes(r.code)||(c=r==null?void 0:r.message)!=null&&c.includes("offline")||(d=r==null?void 0:r.message)!=null&&d.includes("network")||(m=r==null?void 0:r.message)!=null&&m.includes("Failed to get document because the client is offline")||(s=r==null?void 0:r.message)!=null&&s.includes("400"))}getErrorMessage(e){switch(e){case"auth/email-already-in-use":return"Aquest email ja està en ús";case"auth/weak-password":return"La contrasenya és massa feble";case"auth/invalid-email":return"Email no vàlid";case"auth/user-not-found":return"Usuari no trobat";case"auth/wrong-password":return"Contrasenya incorrecta";case"auth/network-request-failed":return"Error de connexió. Comprova la teva connexió a internet";default:return"Error d'autenticació"}}}const pS=new rse,s8=ke.createContext(void 0),sse=({children:t})=>{const[e,n]=ke.useState(null),[r,c]=ke.useState(null),[d,m]=ke.useState(!0);ke.useEffect(()=>Cee(Aw,async $=>{if(n($),$)try{const J=await pS.getCurrentUserProfile();c(J)}catch{c({uid:$.uid,email:$.email||"",displayName:$.displayName||"Usuari",postalCode:"08001",listOption:"new-list",createdAt:new Date})}else c(null);m(!1)}),[]);const z={currentUser:e,userProfile:r,loading:d,login:async(F,$)=>{const J=await pS.loginUser(F,$);return c(J),J},register:async(F,$,J,X,te)=>{const ie=await pS.registerUser(F,$,J,X,te);return c(ie),ie},logout:async()=>{await pS.logoutUser(),c(null)},updateProfile:async F=>{if(!e||!r)throw new Error("No hi ha usuari autenticat");const $=await pS.updateUserProfile(e.uid,F);c($)}};return de.jsxDEV(s8.Provider,{value:z,children:!d&&t},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/contexts/AuthContext.tsx",lineNumber:160,columnNumber:5},void 0)},lf=()=>{const t=ke.useContext(s8);if(t===void 0)throw new Error("useAuth must be used within an AuthProvider");return t},wF=["Calendari","Gràfics","Mapa","Pendents","Llistes"],ose=["Perfil","Tancar sessió"];function ase(){var X,te;const t=Xm(),{currentUser:e,userProfile:n,logout:r}=lf(),c=ie=>{z(),ie==="Pendents"&&t("/pendents"),ie==="Gràfics"&&t("/grafics"),ie==="Mapa"&&t("/mapa"),ie==="Calendari"&&t("/calendari"),ie==="Llistes"&&t("/lists")},[d,m]=ke.useState(null),[s,T]=ke.useState(null),D=ie=>{m(ie.currentTarget)},P=ie=>{T(ie.currentTarget)},z=()=>{m(null)},F=()=>{T(null)},$=async ie=>{if(F(),ie==="Perfil")t("/profile");else if(ie==="Tancar sessió")try{await r(),t("/")}catch{}},J=()=>{t("/")};return de.jsxDEV(E5,{className:"navbar",position:"fixed",sx:{fontFamily:'"Sour Gummy", sans-serif',"& .MuiTypography-root":{fontFamily:'"Sour Gummy", sans-serif'},"& .MuiButton-root":{fontFamily:'"Sour Gummy", sans-serif'}},children:de.jsxDEV(Y5,{maxWidth:"xl",children:de.jsxDEV(S5,{disableGutters:!0,children:[de.jsxDEV(NB,{onClick:J,sx:{display:{xs:"none",md:"flex"},mr:1,transform:"scale(1.5)",cursor:"pointer","&:hover":{opacity:.8}}},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:102,columnNumber:11},this),de.jsxDEV(uo,{className:"logo",variant:"h6",noWrap:!0,component:"a",onClick:J,sx:{display:{xs:"none",md:"flex"},cursor:"pointer",textDecoration:"none","&:hover":{opacity:.8}},children:"Inprocode"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:114,columnNumber:11},this),de.jsxDEV(zR,{sx:{flexGrow:1,display:{xs:"flex",md:"none"}},children:[de.jsxDEV(Tk,{size:"large",onClick:D,color:"inherit",children:de.jsxDEV(NY,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:140,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:135,columnNumber:13},this),de.jsxDEV(Sk,{id:"menu-appbar",anchorEl:d,anchorOrigin:{vertical:"bottom",horizontal:"left"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"left"},open:!!d,onClose:z,sx:{display:{xs:"block",md:"none"}},children:wF.map(ie=>de.jsxDEV(Rk,{onClick:()=>c(ie),children:de.jsxDEV(uo,{sx:{textAlign:"center"},children:ie},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:160,columnNumber:19},this)},ie,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:159,columnNumber:17},this))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:142,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:132,columnNumber:11},this),de.jsxDEV(NB,{onClick:J,sx:{display:{xs:"flex",md:"none"},mr:1,cursor:"pointer","&:hover":{opacity:.8}}},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:165,columnNumber:11},this),de.jsxDEV(uo,{className:"logo",variant:"h5",noWrap:!0,component:"a",onClick:J,sx:{display:{xs:"flex",md:"none"},flexGrow:1,cursor:"pointer",textDecoration:"none","&:hover":{opacity:.8}},children:"Inprocode"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:176,columnNumber:11},this),de.jsxDEV(zR,{sx:{flexGrow:1,display:{xs:"none",md:"flex"}},children:wF.map(ie=>de.jsxDEV(Ak,{className:"navbar-menu",onClick:()=>c(ie),sx:{my:2,color:"white",display:"block",mx:2},children:ie},ie,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:196,columnNumber:15},this))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:194,columnNumber:11},this),de.jsxDEV(zR,{sx:{flexGrow:0},children:e?de.jsxDEV(de.Fragment,{children:[de.jsxDEV(c4,{title:"Configuració d'usuari",children:de.jsxDEV(Tk,{onClick:P,sx:{p:0},children:de.jsxDEV(Z5,{alt:(n==null?void 0:n.displayName)||"Usuari",sx:{width:32,height:32,fontSize:14,fontWeight:"bold",backgroundColor:"#1976d2"},children:((te=(X=n==null?void 0:n.displayName)==null?void 0:X.charAt(0))==null?void 0:te.toUpperCase())||"U"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:212,columnNumber:21},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:211,columnNumber:19},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:210,columnNumber:17},this),de.jsxDEV(Sk,{sx:{mt:"45px"},id:"menu-appbar",anchorEl:s,anchorOrigin:{vertical:"top",horizontal:"right"},keepMounted:!0,transformOrigin:{vertical:"top",horizontal:"right"},open:!!s,onClose:F,children:[de.jsxDEV("div",{style:{padding:"12px 16px",borderBottom:"1px solid #eee"},children:[de.jsxDEV(uo,{variant:"subtitle2",sx:{fontWeight:"bold",color:"#333"},children:n==null?void 0:n.displayName},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:244,columnNumber:21},this),de.jsxDEV(uo,{variant:"caption",sx:{color:"#666",fontSize:"12px"},children:n==null?void 0:n.email},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:247,columnNumber:21},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:250,columnNumber:21},this),de.jsxDEV(uo,{variant:"caption",sx:{color:"#666",fontSize:"12px"},children:["📍 ",n==null?void 0:n.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:251,columnNumber:21},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:243,columnNumber:19},this),ose.map(ie=>de.jsxDEV(Rk,{onClick:()=>$(ie),children:de.jsxDEV(uo,{sx:{textAlign:"center"},children:ie==="Perfil"?"👤 Perfil":"🚪 Tancar sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:259,columnNumber:23},this)},ie,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:258,columnNumber:21},this))]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:226,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:209,columnNumber:15},this):de.jsxDEV(Ak,{onClick:()=>t("/register"),sx:{color:"white",textTransform:"none",fontFamily:'"Sour Gummy", sans-serif',fontSize:"16px",fontWeight:500,"&:hover":{backgroundColor:"rgba(255, 255, 255, 0.1)"}},children:"Inicia sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:268,columnNumber:15},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:206,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:101,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:100,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/Navbar.tsx",lineNumber:87,columnNumber:5},this)}const o8=ke.createContext(void 0),lse=({children:t})=>{const{currentUser:e,userProfile:n}=lf(),[r,c]=ke.useState(null),[d,m]=ke.useState([]),[s,T]=ke.useState(!1),D=()=>Math.random().toString(36).substr(2,9).toUpperCase();ke.useEffect(()=>{if(!e||!n){m([]),c(null),localStorage.removeItem("selectedListId");return}let Ne=null;const Xe=async()=>{try{const _e=aN(sN(Xl,"shoppingLists"),XR("members","array-contains",n.email));Ne=lN(_e,Te=>{const oe=[];Te.forEach($e=>{var St;const ze=$e.data(),zt={id:$e.id,name:ze.name,postalCode:ze.postalCode,createdBy:ze.createdBy,createdAt:((St=ze.createdAt)==null?void 0:St.toDate())||new Date,items:ze.items||[],members:ze.members||[],isActive:ze.isActive??!0};oe.push(zt)}),m(oe);const Ee=localStorage.getItem("selectedListId");c($e=>{if($e)return oe.find(zt=>zt.id===$e.id)||null;if(Ee){const ze=oe.find(zt=>zt.id===Ee);if(ze)return ze}return $e})},()=>{be()})}catch{be()}},be=()=>{try{const _e=localStorage.getItem("shoppingLists"),oe=(_e?JSON.parse(_e):[]).filter($e=>$e.members.includes(n.email)||$e.createdBy===n.email);m(oe);const Ee=localStorage.getItem("selectedListId");if(Ee){const $e=oe.find(ze=>ze.id===Ee);$e&&c($e)}}catch{m([])}};return Xe(),()=>{Ne&&Ne()}},[e,n]);const P=Ne=>{try{const Xe=localStorage.getItem("shoppingLists"),be=Xe?JSON.parse(Xe):[];Ne.forEach(_e=>{const Te=be.findIndex(oe=>oe.id===_e.id);Te>=0?be[Te]=_e:be.push(_e)}),localStorage.setItem("shoppingLists",JSON.stringify(be))}catch{}},Re={currentList:r,userLists:d,isLoading:s,createNewList:async(Ne,Xe)=>{if(!e||!n)throw new Error("User not authenticated");T(!0);try{const be=D(),_e={name:Ne.trim(),postalCode:Xe.trim(),createdBy:n.email,createdAt:xo.now(),items:[],members:[n.email],isActive:!0};await zw(Hh(Xl,"shoppingLists",be),_e);const Te={id:be,..._e,createdAt:new Date};return c(Te),localStorage.setItem("selectedListId",be),be}catch(be){try{const _e={id:D(),name:Ne.trim(),postalCode:Xe.trim(),createdBy:n.email,createdAt:new Date,items:[],members:[n.email],isActive:!0},Te=[...d,_e];return m(Te),c(_e),P([_e]),localStorage.setItem("selectedListId",_e.id),_e.id}catch{throw be}}finally{T(!1)}},joinList:async Ne=>{if(!e||!n)throw new Error("User not authenticated");T(!0);try{const Xe=Hh(Xl,"shoppingLists",Ne),be=await UO(Xe);if(!be.exists())try{const Te=localStorage.getItem("shoppingLists"),Ee=(Te?JSON.parse(Te):[]).find(ze=>ze.id===Ne);if(!Ee)return!1;if(Ee.members.includes(n.email))return!0;Ee.members.push(n.email);const $e=[...d,Ee];return m($e),P([Ee]),!0}catch{return!1}const _e=be.data();return _e.members&&_e.members.includes(n.email)||await lR(Xe,{members:bF(n.email)}),!0}catch{return!1}finally{T(!1)}},switchToList:Ne=>{if(!Ne){c(null),localStorage.removeItem("selectedListId");return}const Xe=d.find(be=>be.id===Ne);Xe&&(c(Xe),localStorage.setItem("selectedListId",Ne))},addItemToCurrentList:Ne=>{if(!r||!n)return;const Xe={...Ne,id:Date.now().toString(),addedBy:n.email,addedAt:new Date},be={...r,items:[...r.items,Xe]};c(be);const _e=d.map(oe=>oe.id===r.id?be:oe);m(_e),(async()=>{try{const oe=Hh(Xl,"shoppingLists",r.id);await lR(oe,{items:bF(Xe)})}catch{P([be])}})()},toggleItemInCurrentList:Ne=>{if(!r)return;const Xe=r.items.find(Ee=>Ee.id===Ne);if(!Xe)return;const be={...Xe,done:!Xe.done},_e={...r,items:r.items.map(Ee=>Ee.id===Ne?be:Ee)};c(_e);const Te=d.map(Ee=>Ee.id===r.id?_e:Ee);m(Te),(async()=>{try{const Ee=Hh(Xl,"shoppingLists",r.id),$e=await UO(Ee);if($e.exists()){const St=($e.data().items||[]).map(mt=>mt.id===Ne?be:mt);await lR(Ee,{items:St})}}catch{P([_e])}})()},deleteItemFromCurrentList:Ne=>{if(!r)return;const Xe={...r,items:r.items.filter(_e=>_e.id!==Ne)};c(Xe);const be=d.map(_e=>_e.id===r.id?Xe:_e);m(be),P([Xe])},updateCurrentList:Ne=>{if(!r)return;const Xe={...r,...Ne};c(Xe);const be=d.map(_e=>_e.id===r.id?Xe:_e);m(be),P([Xe])},leaveList:async Ne=>{if(!n)return;try{if(xF){const be=Hh(Xl,"shoppingLists",Ne);await lR(be,{members:nse(n.email)})}}catch{}const Xe=d.filter(be=>be.id!==Ne);m(Xe),(r==null?void 0:r.id)===Ne&&(c(null),localStorage.removeItem("selectedListId"));try{const be=localStorage.getItem("shoppingLists"),_e=be?JSON.parse(be):[],Te=_e.findIndex(oe=>oe.id===Ne);Te>=0&&(_e[Te].members=_e[Te].members.filter(oe=>oe!==n.email),localStorage.setItem("shoppingLists",JSON.stringify(_e)))}catch{}},deleteList:async Ne=>{if(!n)throw new Error("No hi ha usuari autenticat");const Xe=d.find(be=>be.id===Ne);if(!Xe)throw new Error("Llista no trobada");if(Xe.createdBy!==n.email)throw new Error("Només el creador pot eliminar la llista");T(!0);try{if(xF){const _e=Hh(Xl,"shoppingLists",Ne);await t8(_e)}const be=d.filter(_e=>_e.id!==Ne);m(be),(r==null?void 0:r.id)===Ne&&(c(null),localStorage.removeItem("selectedListId"));try{const _e=localStorage.getItem("shoppingLists"),oe=(_e?JSON.parse(_e):[]).filter(Ee=>Ee.id!==Ne);localStorage.setItem("shoppingLists",JSON.stringify(oe))}catch{}return!0}finally{T(!1)}},generateListId:D};return de.jsxDEV(o8.Provider,{value:Re,children:t},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/contexts/ShoppingListContext.tsx",lineNumber:578,columnNumber:5},void 0)},cf=()=>{const t=ke.useContext(o8);if(!t)throw new Error("useShoppingList must be used within a ShoppingListProvider");return t},a8=ke.createContext(void 0),cse=({children:t})=>{const{currentUser:e,userProfile:n}=lf(),[r,c]=ke.useState([]),[d,m]=ke.useState([]),[s]=ke.useState(!1);ke.useEffect(()=>{if(!e||!n){c([]),m([]);return}const $=aN(sN(Xl,"calendarEvents"),XR("createdBy","==",n.email)),J=lN($,ie=>{const we=[];ie.forEach(Ie=>{const Re=Ie.data();we.push({id:Ie.id,title:Re.title,date:Re.date,type:Re.type,listId:Re.listId,listName:Re.listName,itemId:Re.itemId,itemName:Re.itemName,backgroundColor:Re.backgroundColor,borderColor:Re.borderColor})}),c(we)}),X=aN(sN(Xl,"reminders"),XR("createdBy","==",n.email),XR("isActive","==",!0)),te=lN(X,ie=>{const we=[];ie.forEach(Ie=>{var Ne,Xe,be;const Re=Ie.data();we.push({id:Ie.id,listId:Re.listId,itemName:Re.itemName,originalPurchaseDate:((Ne=Re.originalPurchaseDate)==null?void 0:Ne.toDate())||new Date,reminderDate:((Xe=Re.reminderDate)==null?void 0:Xe.toDate())||new Date,intervalWeeks:Re.intervalWeeks,isActive:Re.isActive,createdBy:Re.createdBy,createdAt:((be=Re.createdAt)==null?void 0:be.toDate())||new Date,supermarket:Re.supermarket})}),m(we)});return()=>{J(),te()}},[e,n]);const F={events:r,reminders:d,isLoading:s,addProductAddedEvent:async($,J,X,te,ie)=>{if(!n)return;const we={title:`➕ ${te} afegit a ${J}`,date:ie.toISOString().split("T")[0],type:"product_added",listId:$,listName:J,itemId:X,itemName:te,backgroundColor:"#e3f2fd",borderColor:"#2196f3",createdBy:n.email,createdAt:xo.now()};try{await zw(Hh(Xl,"calendarEvents",`${$}-${X}-added-${Date.now()}`),we)}catch{}},markPurchaseCompleted:async($,J,X,te,ie)=>{if(!n)return;const we={title:`✅ ${te} comprat de ${J}`,date:ie.toISOString().split("T")[0],type:"purchase_completed",listId:$,listName:J,itemId:X,itemName:te,backgroundColor:"#e8f5e8",borderColor:"#4caf50",createdBy:n.email,createdAt:xo.now()};try{await zw(Hh(Xl,"calendarEvents",`${$}-${X}-purchased-${Date.now()}`),we)}catch{}},createReminder:async($,J,X,te=new Date,ie)=>{if(!n)return;const we=new Date(te);we.setDate(we.getDate()+X*7);const Ie={listId:$,itemName:J,originalPurchaseDate:xo.fromDate(te),reminderDate:xo.fromDate(we),intervalWeeks:X,isActive:!0,createdBy:n.email,createdAt:xo.now(),...ie&&{supermarket:ie}};try{await zw(Hh(Xl,"reminders",`reminder-${Date.now()}`),Ie)}catch{}},deleteReminder:async $=>{try{await t8(Hh(Xl,"reminders",$))}catch{}}};return de.jsxDEV(a8.Provider,{value:F,children:t},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/contexts/CalendarContext.tsx",lineNumber:205,columnNumber:5},void 0)},oM=()=>{const t=ke.useContext(a8);if(!t)throw new Error("useCalendar s'ha d'usar dins de CalendarProvider");return t};var cR={};class use{constructor(){ki(this,"isDev",!0);ki(this,"geoapifyKey","39d0df2e99a042f98ac2abfd808e9dd7")}getEnvKey(){if(typeof process<"u"&&(cR!=null&&cR.VITE_GEOAPIFY_API_KEY))return cR.VITE_GEOAPIFY_API_KEY}async getAllNearbySupermarkets(e){var n;if(console.log("🔧 Configuració:",{isDev:this.isDev,hasGeoapifyKey:!!this.geoapifyKey,keyLength:((n=this.geoapifyKey)==null?void 0:n.length)||0,postalCode:e}),this.geoapifyKey){console.log("🔍 Usant Geoapify directament...");try{const r=await this.getFromGeoapifyDirect(e);return console.log("✅ Resultat final:",r.length,"supermercats"),r}catch(r){return console.error("❌ Error amb Geoapify:",r),[]}}return console.warn("❌ No hi ha clau API de Geoapify configurada"),[]}async getFromGeoapifyDirect(e){if(!this.geoapifyKey)return console.warn("❌ VITE_GEOAPIFY_API_KEY no està configurada"),[];try{console.log("🌍 Obtenint coordenades per codi postal:",e);const n=await this.getCoordinatesFromPostalCode(e);if(!n)return console.warn("⚠️ No s'han pogut obtenir coordenades per:",e),[];console.log("📍 Coordenades obtingudes:",n);const r=await this.fetchSupermarketsFromGeoapify(n,e);return console.log("🏪 Supermercats trobats:",r.length),r}catch(n){return console.error("❌ Error cridant Geoapify:",n),[]}}async getCoordinatesFromPostalCode(e){var n;try{const r=`https://api.geoapify.com/v1/geocode/search?text=${encodeURIComponent(e)}&format=geojson&apiKey=${this.geoapifyKey}&filter=countrycode:es&type=postcode`;console.log("🌍 Cridant geocoding URL:",r.replace(this.geoapifyKey,"API_KEY_HIDDEN"));const c=await fetch(r);if(console.log("📡 Resposta geocoding:",c.status,c.statusText),!c.ok){const m=await c.text();throw console.error("❌ Error geocoding response:",m),new Error(`Error geocoding: ${c.status} - ${m}`)}const d=await c.json();if(console.log("📍 Dades geocoding:",d),d.features&&d.features.length>0){const m=(n=d.features[0].geometry)==null?void 0:n.coordinates;if(m){const[s,T]=m;return console.log("✅ Coordenades trobades:",{lng:s,lat:T}),[s,T]}}return console.warn("⚠️ No s'han trobat coordenades per al codi postal"),null}catch(r){return console.error("❌ Error obtenint coordenades:",r),null}}async fetchSupermarketsFromGeoapify(e,n){var T,D;const r=[],[c,d]=e,m=["commercial.supermarket","commercial.food","commercial.marketplace"];console.log("🔍 Cercant supermercats per categories:",m);for(let P=0;P<m.length;P++){const z=m[P];try{const F=`https://api.geoapify.com/v2/places?categories=${z}&filter=circle:${c},${d},2000&bias=proximity:${c},${d}&limit=20&apiKey=${this.geoapifyKey}`;console.log(`📡 Cridant categoria ${P+1}/${m.length}: ${z}`);const $=await fetch(F);if(!$.ok){console.warn(`⚠️ Error HTTP ${$.status} per categoria ${z}`);continue}const J=await $.json();if(console.log(`✅ Resposta categoria ${z}:`,((T=J.features)==null?void 0:T.length)||0,"resultats"),J.features){for(const X of J.features)if((D=X.geometry)!=null&&D.coordinates&&X.properties){const[te,ie]=X.geometry.coordinates,we=X.properties.name||"Supermercat",Ie=X.properties.formatted||X.properties.address_line1||"Adreça no disponible",Re=this.calculateDistance(d,c,ie,te),Ne={id:`geoapify_${te}_${ie}`,name:we,address:Ie,coordinates:{lat:ie,lng:te},distance:Math.round(Re),chain:this.extractChainFromName(we),postalCode:n,source:"geoapify"};r.push(Ne)}}}catch(F){console.error(`❌ Error en categoria ${z}:`,F)}}console.log("🏪 Total supermercats abans de netejar duplicats:",r.length);const s=this.removeDuplicates(r);return console.log("✨ Supermercats finals després de netejar:",s.length),s.sort((P,z)=>(P.distance||0)-(z.distance||0))}calculateDistance(e,n,r,c){const m=e*Math.PI/180,s=r*Math.PI/180,T=(r-e)*Math.PI/180,D=(c-n)*Math.PI/180,P=Math.sin(T/2)*Math.sin(T/2)+Math.cos(m)*Math.cos(s)*Math.sin(D/2)*Math.sin(D/2);return 6371e3*(2*Math.atan2(Math.sqrt(P),Math.sqrt(1-P)))}extractChainFromName(e){const n=["Mercadona","Carrefour","Dia","Lidl","Aldi","Eroski","Condis","Caprabo","El Corte Inglés"];for(const r of n)if(e.toLowerCase().includes(r.toLowerCase()))return r;return"Altres"}removeDuplicates(e){const n=new Map;return e.forEach(r=>{const c=`${Math.round(r.coordinates.lat*1e3)}_${Math.round(r.coordinates.lng*1e3)}`;(!n.has(c)||n.get(c).name.length<r.name.length)&&n.set(c,r)}),Array.from(n.values())}async getSupermarketsByCoordinates(e,n,r=2e3){try{if(this.geoapifyKey)return await this.fetchSupermarketsFromGeoapify([e,n],"coordenades");const c=await fetch(`/api/supermarkets/nearby?lng=${e}&lat=${n}&maxDistance=${r}`);if(c.ok)return(await c.json()).data.map(m=>this.convertMongoToFrontend(m));throw new Error(`Error obtaining supermarkets nearby: ${c.status}`)}catch(c){return console.error("Error obtaining supermarkets nearby:",c),[]}}async refreshSupermarketsCache(e){try{if(this.geoapifyKey)return await this.getFromGeoapifyDirect(e);const n=await fetch(`/api/supermarkets/postal/${e}?forceRefresh=true`);if(n.ok)return(await n.json()).data.map(c=>this.convertMongoToFrontend(c));throw new Error("Error actualitzant cache")}catch(n){return console.error("Error actualitzant cache:",n),[]}}async updateSupermarketRating(e,n){try{return(await fetch(`/api/supermarkets/${e}/rating`,{method:"PUT",headers:{"Content-Type":"application/json"},body:JSON.stringify({rating:n})})).ok}catch(r){return console.error("Error actualitzant rating:",r),!1}}async recordSupermarketVisit(e){try{return(await fetch(`/api/supermarkets/${e}/visit`,{method:"POST",headers:{"Content-Type":"application/json"}})).ok}catch(n){return console.error("Error registrant visita:",n),!1}}async addManualSupermarket(e){try{const n=await fetch("/api/supermarkets",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify(e)});if(n.ok){const r=await n.json();return this.convertMongoToFrontend(r)}return null}catch(n){return console.error("Error afegint supermercat:",n),null}}async searchSupermarkets(e,n){try{const r=new URL("/api/supermarkets/search",window.location.origin);r.searchParams.append("q",e),n&&r.searchParams.append("postalCode",n);const c=await fetch(r.toString());return c.ok?(await c.json()).data.map(m=>this.convertMongoToFrontend(m)):[]}catch(r){return console.error("Error cercant supermercats:",r),[]}}async getSupermarketStats(){try{const e=await fetch("/api/supermarkets/stats");return e.ok?(await e.json()).data:{totalSupermarkets:0,chainDistribution:[]}}catch(e){return console.error("Error obtaining statistics:",e),{totalSupermarkets:0,chainDistribution:[]}}}getSupermarketsByChain(e,n){return n==="Tots"?e:e.filter(r=>r.chain===n)}convertMongoToFrontend(e){const n=e.location,r=e.coordinates;let c=0,d=0;return n!=null&&n.coordinates?[d,c]=n.coordinates:r&&(c=r.lat,d=r.lng),{id:e._id||e.id||"unknown",_id:e._id,name:e.name,address:e.address,coordinates:{lat:c,lng:d},distance:e.distance,rating:e.rating,chain:e.chain||"Altres",postalCode:e.postalCode,source:e.source,lastUpdated:e.lastUpdated?new Date(e.lastUpdated):void 0}}}const l8=new use,c8=({postalCode:t,selectedSupermarket:e,onSupermarketSelect:n,placeholder:r="🏪 Seleccionar supermercat (opcional)",disabled:c=!1})=>{const[d,m]=ke.useState([]),[s,T]=ke.useState(!1),[D,P]=ke.useState(!1);ke.useEffect(()=>{(async()=>{if(!t){m([]);return}P(!0);try{const X=await l8.getAllNearbySupermarkets(t);m(X)}catch{m([])}finally{P(!1)}})()},[t]);const z=J=>{n(J),T(!1)},F=()=>{c||T(!s)},$=()=>e?`🏪 ${e.name}`:D?"⏳ Carregant supermercats...":d.length>0?r:"🚫 No hi ha supermercats disponibles";return de.jsxDEV("div",{className:"supermarket-selector",style:{position:"relative",display:"block"},children:[de.jsxDEV("button",{type:"button",className:"supermarket-toggle-button",onClick:F,disabled:c,style:{padding:"10px",border:"1px solid #ccc",background:"white",cursor:c?"not-allowed":"pointer",opacity:c?.6:1,width:"100%",textAlign:"left",display:"flex",justifyContent:"space-between",alignItems:"center"},children:[de.jsxDEV("span",{children:$()},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:89,columnNumber:9},void 0),de.jsxDEV("span",{className:"dropdown-arrow",children:"▼"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:90,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:71,columnNumber:7},void 0),s&&!c&&de.jsxDEV("div",{className:"supermarket-dropdown",style:{position:"absolute",top:"100%",left:0,right:0,border:"1px solid #ccc",background:"white",maxHeight:"200px",overflow:"auto",zIndex:1e3,boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:D?de.jsxDEV("div",{className:"supermarket-item loading",style:{padding:"10px"},children:"Carregant supermercats..."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:110,columnNumber:13},void 0):de.jsxDEV(de.Fragment,{children:[de.jsxDEV("div",{className:"supermarket-item clear-selection",onMouseDown:J=>{J.preventDefault(),J.stopPropagation(),z(null)},style:{padding:"10px",cursor:"pointer",borderBottom:"1px solid #eee",userSelect:"none",backgroundColor:"#f8f9fa"},children:de.jsxDEV("span",{children:"🚫 Sense supermercat específic"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:130,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:115,columnNumber:15},void 0),d.map(J=>de.jsxDEV("div",{className:"supermarket-item",onMouseDown:X=>{X.preventDefault(),z(J)},style:{padding:"10px",cursor:"pointer",borderBottom:"1px solid #eee",userSelect:"none"},children:de.jsxDEV("div",{className:"supermarket-info",children:[de.jsxDEV("div",{className:"supermarket-name",children:["🏪 ",J.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:148,columnNumber:21},void 0),de.jsxDEV("div",{className:"supermarket-details",children:[J.chain&&de.jsxDEV("span",{className:"chain",children:["(",J.chain,")"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:152,columnNumber:45},void 0),J.distance&&de.jsxDEV("span",{className:"distance",children:[" • ",Math.round(J.distance),"m"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:153,columnNumber:48},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:151,columnNumber:21},void 0),de.jsxDEV("div",{className:"supermarket-address",children:["📍 ",J.address]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:155,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:147,columnNumber:19},void 0)},J.id,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:133,columnNumber:17},void 0))]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:114,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/SupermarketSelector.tsx",lineNumber:70,columnNumber:5},void 0)},hse=({handleAddItem:t})=>{const{currentList:e}=cf(),{addProductAddedEvent:n}=oM(),[r,c]=ke.useState(""),[d,m]=ke.useState(null),s=P=>{if(P.preventDefault(),!r.trim())return;const z={done:!1,task:r.trim(),...d&&{supermarket:{id:d.id,name:d.name,chain:d.chain}}};if(t(z),e){const F=Date.now().toString();n(e.id,e.name,F,r.trim(),new Date)}c(""),m(null)},T=P=>{c(P.target.value)},D=P=>{m(P)};return e?de.jsxDEV("div",{className:"form-container",children:de.jsxDEV("form",{className:"todo-form",onSubmit:s,children:[de.jsxDEV("div",{className:"input-container",children:de.jsxDEV("input",{type:"text",className:"to-do-input",value:r,placeholder:"Escriu el nom del producte...",onChange:T},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:74,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:73,columnNumber:9},void 0),de.jsxDEV(c8,{postalCode:e==null?void 0:e.postalCode,selectedSupermarket:d,onSupermarketSelect:D,placeholder:"🏪 Seleccionar supermercat"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:84,columnNumber:9},void 0),de.jsxDEV("button",{type:"submit",className:"add-button",disabled:!r.trim(),children:"➕"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:91,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:72,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:71,columnNumber:5},void 0):de.jsxDEV("div",{className:"form-container",children:de.jsxDEV("div",{className:"no-list-message",children:"Selecciona una llista per afegir productes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:63,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/FormTask.tsx",lineNumber:62,columnNumber:7},void 0)},aL=kA(Qn.jsx("path",{d:"M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6zm2.46-7.12 1.41-1.41L12 12.59l2.12-2.12 1.41 1.41L13.41 14l2.12 2.12-1.41 1.41L12 15.41l-2.12 2.12-1.41-1.41L10.59 14zM15.5 4l-1-1h-5l-1 1H5v2h14V4z"}),"DeleteForever"),TF=({onChange:t,data:e,onDelete:n})=>{const{id:r,task:c,done:d,supermarket:m}=e,s=T=>{T.preventDefault(),T.stopPropagation(),n&&n(r)};return de.jsxDEV("label",{className:"task-item",children:[de.jsxDEV("input",{className:"task-checkbox",name:r,type:"checkbox",checked:d,onChange:t},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:25,columnNumber:7},void 0),de.jsxDEV("div",{className:"task-content",children:[de.jsxDEV("span",{className:"task-text",children:[d&&de.jsxDEV("span",{className:"completed-indicator",children:"✅ "},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:34,columnNumber:20},void 0),c]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:33,columnNumber:9},void 0),m&&de.jsxDEV("div",{className:"supermarket-info-mini",children:de.jsxDEV("span",{className:"supermarket-name-mini",children:["🏪 ",m.name,m.chain&&de.jsxDEV("span",{className:"chain-info",children:[" (",m.chain,")"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:41,columnNumber:37},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:39,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:38,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:32,columnNumber:7},void 0),n&&!d&&de.jsxDEV("button",{className:"delete-item-btn",onClick:s,title:"Eliminar producte",children:de.jsxDEV(aL,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:52,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:47,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Check.tsx",lineNumber:24,columnNumber:5},void 0)},dse=()=>{const{currentList:t,toggleItemInCurrentList:e,deleteItemFromCurrentList:n}=cf(),{markPurchaseCompleted:r}=oM(),[c,d]=ke.useState(!1);if(!t)return de.jsxDEV("div",{className:"todo-list",children:de.jsxDEV("p",{children:"No hi ha cap llista seleccionada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:14,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:13,columnNumber:7},void 0);const m=$=>{const{name:J}=$.target,X=t==null?void 0:t.items.find(te=>te.id===J);X&&!X.done&&t&&r(t.id,t.name,X.id,X.task,new Date),e(J)},s=$=>{window.confirm("Estàs segur que vols eliminar aquest producte?")&&n($)},T=t.items.filter($=>!$.done),D=t.items.filter($=>$.done),P=c?D:D.slice(0,3),z=T.map($=>de.jsxDEV(TF,{data:$,onChange:m,onDelete:s},$.id,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:51,columnNumber:5},void 0)),F=P.map($=>de.jsxDEV(TF,{data:$,onChange:m},$.id,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:60,columnNumber:5},void 0));return de.jsxDEV("div",{className:"todo-list",children:[z,D.length>0&&de.jsxDEV(de.Fragment,{children:D.length>0&&de.jsxDEV("div",{className:"completed-section",children:[de.jsxDEV("h4",{className:"completed-header",children:"Productes comprats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:78,columnNumber:15},void 0),F,D.length>3&&!c&&de.jsxDEV("button",{className:"load-more-btn",onClick:()=>d(!0),children:["Carrega més (",D.length-3," més)"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:83,columnNumber:17},void 0),c&&D.length>3&&de.jsxDEV("button",{className:"load-more-btn",onClick:()=>d(!1),children:"Mostra menys"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:93,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:77,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:75,columnNumber:9},void 0),t.items.length===0&&de.jsxDEV("p",{className:"no-items-message",children:"No cal comprar res"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:106,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/TaskList.tsx",lineNumber:69,columnNumber:5},void 0)},u8=()=>{const{currentList:t,addItemToCurrentList:e}=cf(),n=Xm(),r=c=>{e(c)};return t?de.jsxDEV("div",{className:"todo-container",children:[de.jsxDEV("h2",{children:["📝 ",t.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:30,columnNumber:7},void 0),de.jsxDEV("div",{className:"list-details",children:[de.jsxDEV("div",{className:"list-location",children:["📍 Zona: ",t.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:32,columnNumber:9},void 0),de.jsxDEV("div",{className:"list-members",children:["👥 ",t.members.length," membre",t.members.length!==1?"s":""]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:35,columnNumber:9},void 0),de.jsxDEV("div",{className:"list-stats",children:["📊 ",t.items.length," productes • ",t.items.filter(c=>c.done).length," comprats"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:38,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:31,columnNumber:7},void 0),de.jsxDEV(hse,{handleAddItem:r},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:42,columnNumber:7},void 0),de.jsxDEV(dse,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:43,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:29,columnNumber:5},void 0):de.jsxDEV("div",{className:"todo-container",children:de.jsxDEV("div",{className:"no-list-selected",children:[de.jsxDEV("h3",{children:"No hi ha cap llista seleccionada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:20,columnNumber:11},void 0),de.jsxDEV("p",{children:"Selecciona una llista per començar a afegir productes."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:21,columnNumber:11},void 0),de.jsxDEV("button",{className:"action-button",onClick:()=>n("/lists"),children:"Selecciona una llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:22,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:19,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/todolist/Container.tsx",lineNumber:18,columnNumber:7},void 0)};function fse(t){return wo("MuiCollapse",t)}io("MuiCollapse",["root","horizontal","vertical","entered","hidden","wrapper","wrapperInner"]);const pse=t=>{const{orientation:e,classes:n}=t,r={root:["root",`${e}`],entered:["entered"],hidden:["hidden"],wrapper:["wrapper",`${e}`],wrapperInner:["wrapperInner",`${e}`]};return Fo(r,fse,n)},mse=lr("div",{name:"MuiCollapse",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[e.root,e[n.orientation],n.state==="entered"&&e.entered,n.state==="exited"&&!n.in&&n.collapsedSize==="0px"&&e.hidden]}})(zo(({theme:t})=>({height:0,overflow:"hidden",transition:t.transitions.create("height"),variants:[{props:{orientation:"horizontal"},style:{height:"auto",width:0,transition:t.transitions.create("width")}},{props:{state:"entered"},style:{height:"auto",overflow:"visible"}},{props:{state:"entered",orientation:"horizontal"},style:{width:"auto"}},{props:({ownerState:e})=>e.state==="exited"&&!e.in&&e.collapsedSize==="0px",style:{visibility:"hidden"}}]}))),gse=lr("div",{name:"MuiCollapse",slot:"Wrapper"})({display:"flex",width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),_se=lr("div",{name:"MuiCollapse",slot:"WrapperInner"})({width:"100%",variants:[{props:{orientation:"horizontal"},style:{width:"auto",height:"100%"}}]}),jO=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiCollapse"}),{addEndListener:c,children:d,className:m,collapsedSize:s="0px",component:T,easing:D,in:P,onEnter:z,onEntered:F,onEntering:$,onExit:J,onExited:X,onExiting:te,orientation:ie="vertical",style:we,timeout:Ie=m5.standard,TransitionComponent:Re=vp,...Ne}=r,Xe={...r,orientation:ie,collapsedSize:s},be=pse(Xe),_e=PA(),Te=rx(),oe=ke.useRef(null),Ee=ke.useRef(),$e=typeof s=="number"?`${s}px`:s,ze=ie==="horizontal",zt=ze?"width":"height",St=ke.useRef(null),mt=xu(n,St),Ft=Ht=>Mn=>{if(Ht){const yn=St.current;Mn===void 0?Ht(yn):Ht(yn,Mn)}},rn=()=>oe.current?oe.current[ze?"clientWidth":"clientHeight"]:0,Xt=Ft((Ht,Mn)=>{oe.current&&ze&&(oe.current.style.position="absolute"),Ht.style[zt]=$e,z&&z(Ht,Mn)}),Fe=Ft((Ht,Mn)=>{const yn=rn();oe.current&&ze&&(oe.current.style.position="");const{duration:Tn,easing:Cn}=Gw({style:we,timeout:Ie,easing:D},{mode:"enter"});if(Ie==="auto"){const Kn=_e.transitions.getAutoHeightDuration(yn);Ht.style.transitionDuration=`${Kn}ms`,Ee.current=Kn}else Ht.style.transitionDuration=typeof Tn=="string"?Tn:`${Tn}ms`;Ht.style[zt]=`${yn}px`,Ht.style.transitionTimingFunction=Cn,$&&$(Ht,Mn)}),Ot=Ft((Ht,Mn)=>{Ht.style[zt]="auto",F&&F(Ht,Mn)}),Ut=Ft(Ht=>{Ht.style[zt]=`${rn()}px`,J&&J(Ht)}),ln=Ft(X),wn=Ft(Ht=>{const Mn=rn(),{duration:yn,easing:Tn}=Gw({style:we,timeout:Ie,easing:D},{mode:"exit"});if(Ie==="auto"){const Cn=_e.transitions.getAutoHeightDuration(Mn);Ht.style.transitionDuration=`${Cn}ms`,Ee.current=Cn}else Ht.style.transitionDuration=typeof yn=="string"?yn:`${yn}ms`;Ht.style[zt]=$e,Ht.style.transitionTimingFunction=Tn,te&&te(Ht)}),dn=Ht=>{Ie==="auto"&&Te.start(Ee.current||0,Ht),c&&c(St.current,Ht)};return Qn.jsx(Re,{in:P,onEnter:Xt,onEntered:Ot,onEntering:Fe,onExit:Ut,onExited:ln,onExiting:wn,addEndListener:dn,nodeRef:St,timeout:Ie==="auto"?null:Ie,...Ne,children:(Ht,{ownerState:Mn,...yn})=>Qn.jsx(mse,{as:T,className:Dr(be.root,m,{entered:be.entered,exited:!P&&$e==="0px"&&be.hidden}[Ht]),style:{[ze?"minWidth":"minHeight"]:$e,...we},ref:mt,ownerState:{...Xe,state:Ht},...yn,children:Qn.jsx(gse,{ownerState:{...Xe,state:Ht},className:be.wrapper,ref:oe,children:Qn.jsx(_se,{ownerState:{...Xe,state:Ht},className:be.wrapperInner,children:d})})})})});jO.propTypes={addEndListener:G.func,children:G.node,classes:G.object,className:G.string,collapsedSize:G.oneOfType([G.number,G.string]),component:XN,easing:G.oneOfType([G.shape({enter:G.string,exit:G.string}),G.string]),in:G.bool,onEnter:G.func,onEntered:G.func,onEntering:G.func,onExit:G.func,onExited:G.func,onExiting:G.func,orientation:G.oneOf(["horizontal","vertical"]),style:G.object,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),timeout:G.oneOfType([G.oneOf(["auto"]),G.number,G.shape({appear:G.number,enter:G.number,exit:G.number})])};jO&&(jO.muiSupportAuto=!0);const lL=ke.createContext({});lL.displayName="AccordionContext";function yse(t){return wo("MuiAccordion",t)}const uR=io("MuiAccordion",["root","heading","rounded","expanded","disabled","gutters","region"]),vse=t=>{const{classes:e,square:n,expanded:r,disabled:c,disableGutters:d}=t;return Fo({root:["root",!n&&"rounded",r&&"expanded",c&&"disabled",!d&&"gutters"],heading:["heading"],region:["region"]},yse,e)},bse=lr(II,{name:"MuiAccordion",slot:"Root",overridesResolver:(t,e)=>{const{ownerState:n}=t;return[{[`& .${uR.region}`]:e.region},e.root,!n.square&&e.rounded,!n.disableGutters&&e.gutters]}})(zo(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{position:"relative",transition:t.transitions.create(["margin"],e),overflowAnchor:"none","&::before":{position:"absolute",left:0,top:-1,right:0,height:1,content:'""',opacity:1,backgroundColor:(t.vars||t).palette.divider,transition:t.transitions.create(["opacity","background-color"],e)},"&:first-of-type":{"&::before":{display:"none"}},[`&.${uR.expanded}`]:{"&::before":{opacity:0},"&:first-of-type":{marginTop:0},"&:last-of-type":{marginBottom:0},"& + &":{"&::before":{display:"none"}}},[`&.${uR.disabled}`]:{backgroundColor:(t.vars||t).palette.action.disabledBackground}}}),zo(({theme:t})=>({variants:[{props:e=>!e.square,style:{borderRadius:0,"&:first-of-type":{borderTopLeftRadius:(t.vars||t).shape.borderRadius,borderTopRightRadius:(t.vars||t).shape.borderRadius},"&:last-of-type":{borderBottomLeftRadius:(t.vars||t).shape.borderRadius,borderBottomRightRadius:(t.vars||t).shape.borderRadius,"@supports (-ms-ime-align: auto)":{borderBottomLeftRadius:0,borderBottomRightRadius:0}}}},{props:e=>!e.disableGutters,style:{[`&.${uR.expanded}`]:{margin:"16px 0"}}}]}))),xse=lr("h3",{name:"MuiAccordion",slot:"Heading"})({all:"unset"}),Dm=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiAccordion"}),{children:c,className:d,defaultExpanded:m=!1,disabled:s=!1,disableGutters:T=!1,expanded:D,onChange:P,square:z=!1,slots:F={},slotProps:$={},TransitionComponent:J,TransitionProps:X,...te}=r,[ie,we]=A5({controlled:D,default:m,name:"Accordion",state:"expanded"}),Ie=ke.useCallback(rn=>{we(!ie),P&&P(rn,!ie)},[ie,P,we]),[Re,...Ne]=ke.Children.toArray(c),Xe=ke.useMemo(()=>({expanded:ie,disabled:s,disableGutters:T,toggle:Ie}),[ie,s,T,Ie]),be={...r,square:z,disabled:s,disableGutters:T,expanded:ie},_e=vse(be),Te={transition:J,...F},oe={transition:X,...$},Ee={slots:Te,slotProps:oe},[$e,ze]=ta("root",{elementType:bse,externalForwardedProps:{...Ee,...te},className:Dr(_e.root,d),shouldForwardComponentProp:!0,ownerState:be,ref:n,additionalProps:{square:z}}),[zt,St]=ta("heading",{elementType:xse,externalForwardedProps:Ee,className:_e.heading,ownerState:be}),[mt,Ft]=ta("transition",{elementType:jO,externalForwardedProps:Ee,ownerState:be});return Qn.jsxs($e,{...ze,children:[Qn.jsx(zt,{...St,children:Qn.jsx(lL.Provider,{value:Xe,children:Re})}),Qn.jsx(mt,{in:ie,timeout:"auto",...Ft,children:Qn.jsx("div",{"aria-labelledby":Re.props.id,id:Re.props["aria-controls"],role:"region",className:_e.region,children:Ne})})]})});Dm.propTypes={children:P_(G.node.isRequired,t=>{const e=ke.Children.toArray(t.children)[0];return hx.isFragment(e)?new Error("MUI: The Accordion doesn't accept a Fragment as a child. Consider providing an array instead."):ke.isValidElement(e)?null:new Error("MUI: Expected the first child of Accordion to be a valid element.")}),classes:G.object,className:G.string,defaultExpanded:G.bool,disabled:G.bool,disableGutters:G.bool,expanded:G.bool,onChange:G.func,slotProps:G.shape({heading:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object]),transition:G.oneOfType([G.func,G.object])}),slots:G.shape({heading:G.elementType,root:G.elementType,transition:G.elementType}),square:G.bool,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object]),TransitionComponent:G.elementType,TransitionProps:G.object};function wse(t){return wo("MuiAccordionSummary",t)}const Rw=io("MuiAccordionSummary",["root","expanded","focusVisible","disabled","gutters","contentGutters","content","expandIconWrapper"]),Tse=t=>{const{classes:e,expanded:n,disabled:r,disableGutters:c}=t;return Fo({root:["root",n&&"expanded",r&&"disabled",!c&&"gutters"],focusVisible:["focusVisible"],content:["content",n&&"expanded",!c&&"contentGutters"],expandIconWrapper:["expandIconWrapper",n&&"expanded"]},wse,e)},Ese=lr(NA,{name:"MuiAccordionSummary",slot:"Root"})(zo(({theme:t})=>{const e={duration:t.transitions.duration.shortest};return{display:"flex",width:"100%",minHeight:48,padding:t.spacing(0,2),transition:t.transitions.create(["min-height","background-color"],e),[`&.${Rw.focusVisible}`]:{backgroundColor:(t.vars||t).palette.action.focus},[`&.${Rw.disabled}`]:{opacity:(t.vars||t).palette.action.disabledOpacity},[`&:hover:not(.${Rw.disabled})`]:{cursor:"pointer"},variants:[{props:n=>!n.disableGutters,style:{[`&.${Rw.expanded}`]:{minHeight:64}}}]}})),Sse=lr("span",{name:"MuiAccordionSummary",slot:"Content"})(zo(({theme:t})=>({display:"flex",textAlign:"start",flexGrow:1,margin:"12px 0",variants:[{props:e=>!e.disableGutters,style:{transition:t.transitions.create(["margin"],{duration:t.transitions.duration.shortest}),[`&.${Rw.expanded}`]:{margin:"20px 0"}}}]}))),Ase=lr("span",{name:"MuiAccordionSummary",slot:"ExpandIconWrapper"})(zo(({theme:t})=>({display:"flex",color:(t.vars||t).palette.action.active,transform:"rotate(0deg)",transition:t.transitions.create("transform",{duration:t.transitions.duration.shortest}),[`&.${Rw.expanded}`]:{transform:"rotate(180deg)"}}))),Rm=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiAccordionSummary"}),{children:c,className:d,expandIcon:m,focusVisibleClassName:s,onClick:T,slots:D,slotProps:P,...z}=r,{disabled:F=!1,disableGutters:$,expanded:J,toggle:X}=ke.useContext(lL),te=oe=>{X&&X(oe),T&&T(oe)},ie={...r,expanded:J,disabled:F,disableGutters:$},we=Tse(ie),Ie={slots:D,slotProps:P},[Re,Ne]=ta("root",{ref:n,shouldForwardComponentProp:!0,className:Dr(we.root,d),elementType:Ese,externalForwardedProps:{...Ie,...z},ownerState:ie,additionalProps:{focusRipple:!1,disableRipple:!0,disabled:F,"aria-expanded":J,focusVisibleClassName:Dr(we.focusVisible,s)},getSlotProps:oe=>({...oe,onClick:Ee=>{var $e;($e=oe.onClick)==null||$e.call(oe,Ee),te(Ee)}})}),[Xe,be]=ta("content",{className:we.content,elementType:Sse,externalForwardedProps:Ie,ownerState:ie}),[_e,Te]=ta("expandIconWrapper",{className:we.expandIconWrapper,elementType:Ase,externalForwardedProps:Ie,ownerState:ie});return Qn.jsxs(Re,{...Ne,children:[Qn.jsx(Xe,{...be,children:c}),m&&Qn.jsx(_e,{...Te,children:m})]})});Rm.propTypes={children:G.node,classes:G.object,className:G.string,expandIcon:G.node,focusVisibleClassName:G.string,onClick:G.func,slotProps:G.shape({content:G.oneOfType([G.func,G.object]),expandIconWrapper:G.oneOfType([G.func,G.object]),root:G.oneOfType([G.func,G.object])}),slots:G.shape({content:G.elementType,expandIconWrapper:G.elementType,root:G.elementType}),sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};function Cse(t){return wo("MuiAccordionDetails",t)}io("MuiAccordionDetails",["root"]);const Dse=t=>{const{classes:e}=t;return Fo({root:["root"]},Cse,e)},Rse=lr("div",{name:"MuiAccordionDetails",slot:"Root"})(zo(({theme:t})=>({padding:t.spacing(1,2,2)}))),Om=ke.forwardRef(function(e,n){const r=Mo({props:e,name:"MuiAccordionDetails"}),{className:c,...d}=r,m=r,s=Dse(m);return Qn.jsx(Rse,{className:Dr(s.root,c),ref:n,ownerState:m,...d})});Om.propTypes={children:G.node,classes:G.object,className:G.string,sx:G.oneOfType([G.arrayOf(G.oneOfType([G.func,G.object,G.bool])),G.func,G.object])};const h_=kA(Qn.jsx("path",{d:"m7 10 5 5 5-5z"}),"ArrowDropDown");function h8(){return de.jsxDEV("div",{className:"faqs-accordeon",children:[de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:12,columnNumber:23},this),"aria-controls":"panel1-content",id:"panel1-header",children:de.jsxDEV(uo,{component:"span",children:"Com creo una llista nova?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:16,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:11,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`Vés a l'apartat "Llistes": allà trobaràs les opcions "Crea una nova llista" o "Uneix-te a una llista". Fes click a "Crea una nova llista" i dona-li un nom i, sobretot: un codi postal!`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:19,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:18,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:10,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:29,columnNumber:23},this),"aria-controls":"panel2-content",id:"panel2-header",children:de.jsxDEV(uo,{component:"span",children:"Puc compartir la llista amb altres usuaris?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:33,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:28,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:"Sí! Quan hagis creat la llista, veuràs que té un ID al costat del nom. Comparteix aquest ID amb les persones que vulguis compartir la llista."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:38,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:37,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:27,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:48,columnNumber:23},this),"aria-controls":"panel3-content",id:"panel3-header",children:de.jsxDEV(uo,{component:"span",children:"Com m'uneixo a una llista ja existent?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:52,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:47,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`Vés a l'apartat "Llistes". Allà escull la opció "Unir-se a una llista". Escriu l'ID aportat pel teu contacte, i ja ets dins! Pots afegir i treure productes i marcar-los com a comprats.`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:57,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:56,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:46,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:67,columnNumber:23},this),"aria-controls":"panel4-content",id:"panel4-header",children:de.jsxDEV(uo,{component:"span",children:"Com s'afegeixen els productes a una llista?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:71,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:66,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:"Un cop tinguis la llista seleccionada (important! sense seleccionar cap llista no pots accedir-hi), podras escriure el producte que vulguis. Després, selecciona el supermercat que desitgis (o cap supermercat!) i fes click al botó ➕ . Veuràs com s'afegeix el producte a la teva llista."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:76,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:75,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:65,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:88,columnNumber:23},this),"aria-controls":"panel5-content",id:"panel5-header",children:de.jsxDEV(uo,{component:"span",children:"Com marco una compra que ja he fet?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:92,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:87,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`Vés a l'apartat "Pendents". Si no tens una llista seleccionada, selecciona-la de les diferents llistes. Un cop seleccionada, t'apareixeran els diferents productes introduïts. Si ja l'has comprat, fes click al recuadre del producte. Veuràs que passa als "Productes comprats". Si t'has equivocat, simplement torna fer click!`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:97,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:96,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:86,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:110,columnNumber:23},this),"aria-controls":"panel6-content",id:"panel6-header",children:de.jsxDEV(uo,{component:"span",children:"I si el que vull comprar no està a un supermercat de la llista o és un altre tipus de botiga?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:114,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:109,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`Cap problema! Pots no especificar cap supermercat. A l'hora d'afegir productes, selecciona la opció "Sense supermercat específic"`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:120,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:119,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:108,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:129,columnNumber:23},this),"aria-controls":"panel7-content",id:"panel7-header",children:de.jsxDEV(uo,{component:"span",children:"Com puc veure el mapa dels supermercats?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:133,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:128,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`Vés a l'apartat "Mapa". Allà, espera uns segons: veuràs el teu barri amb els supermercats disponibles! Observaràs també que els supermercats estan marcats de dues maneres: 🏪 per als supermercats disponibles al teu barri però sense cap producte assignat, i 🛒 per als supermercats on sí tinguis productes assignats. Així és més fàcil marcar la teva ruta! També pots fer la llista seleccionant primer un supermercat i afegint els productes que vulguis comprar en aquest supermercat concret.`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:138,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:137,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:127,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:153,columnNumber:23},this),"aria-controls":"panel8-content",id:"panel8-header",children:de.jsxDEV(uo,{component:"span",children:"Com funcionen els recordatoris per comprar productes?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:157,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:152,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:`La majoria de nuclis familiars compren de manera recurrent els mateixos productes (un cop al mes s'acaba el paper de vàter), o tenen habits que repeteixen de manera setmanal o mensual (les clàssiques pizzes per sopar el dissabte). Per no estar constantment afegint productes repetits, es pot programar que cada cert temps (setmanal, quinzenal, mensual o bimensual) els productes s'afegeixin de forma automàtica. Per a poder fer-ho, vés a l'apartat "Calendari".`},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:162,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:161,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:151,columnNumber:7},this),de.jsxDEV(Dm,{children:[de.jsxDEV(Rm,{expandIcon:de.jsxDEV(h_,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:177,columnNumber:23},this),"aria-controls":"panel9-content",id:"panel9-header",children:de.jsxDEV(uo,{component:"span",children:"Què mostren els gràfics?"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:181,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:176,columnNumber:9},this),de.jsxDEV(Om,{children:de.jsxDEV(uo,{children:"Els gràfics mostren qui ha afegit els usuaris i qui els ha comprat. Pot ser una eina per a regular i revisar la feina que fa cadascú a casa, o per a equilibrar l'aportació econòmica de cadascú. No ha de ser una eina per a discutir, si no per a organitzar-se de forma equitativa."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:184,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:183,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:175,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FAQs.tsx",lineNumber:9,columnNumber:5},this)}function Ose(){const{currentUser:t,userProfile:e}=lf(),n=Xm();return de.jsxDEV(de.Fragment,{children:[t?de.jsxDEV(de.Fragment,{children:[de.jsxDEV("div",{className:"user-info",children:de.jsxDEV("h2",{children:["Benvingut/da, ",e==null?void 0:e.displayName,"!"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:34,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:33,columnNumber:11},this),de.jsxDEV(u8,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:36,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:31,columnNumber:9},this):de.jsxDEV(de.Fragment,{children:[de.jsxDEV("section",{className:"inicia-section",children:de.jsxDEV("button",{className:"inicia-button",onClick:()=>n("/register"),children:"Comença aquí - Registra't"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:16,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:15,columnNumber:11},this),de.jsxDEV("div",{className:"welcome-message",children:[de.jsxDEV("h2",{children:"Benvingut/da a Inprocode Shopping"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:25,columnNumber:13},this),de.jsxDEV("p",{children:"La teva aplicació per gestionar llistes de compra compartides"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:26,columnNumber:13},this),de.jsxDEV("p",{children:"Registra't per començar a crear i compartir les teves llistes!"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:27,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:24,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:14,columnNumber:9},this),de.jsxDEV(h8,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:39,columnNumber:7},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/HomePage.tsx",lineNumber:11,columnNumber:5},this)}const d8=({onListCreated:t,onCancel:e})=>{const{createNewList:n,isLoading:r}=cf(),[c,d]=ke.useState(""),[m,s]=ke.useState(""),[T,D]=ke.useState(""),P=async z=>{if(z.preventDefault(),!c.trim()){D("El nom de la llista és obligatori");return}if(!m.trim()){D("El codi postal és obligatori");return}if(!/^[0-5][0-9]{4}$/.test(m.trim())){D("El codi postal ha de tenir 5 dígits (ex: 08001)");return}try{D("");const $=await n(c.trim(),m.trim());t($)}catch{D("Error creant la llista")}};return de.jsxDEV("div",{className:"create-list-form",children:[de.jsxDEV("div",{className:"form-header",children:[de.jsxDEV("h3",{children:"Crear Nova Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:47,columnNumber:9},void 0),de.jsxDEV("button",{type:"button",onClick:e,className:"close-btn",disabled:r,children:"✕"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:48,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:46,columnNumber:7},void 0),de.jsxDEV("form",{onSubmit:P,className:"list-form",children:[de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"listName",children:"Nom de la llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:60,columnNumber:11},void 0),de.jsxDEV("input",{type:"text",id:"listName",value:c,onChange:z=>d(z.target.value),placeholder:"Ex: Compra setmanal, Festa d'aniversari...",disabled:r,maxLength:50},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:61,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:59,columnNumber:9},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"postalCode",children:"Codi postal"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:73,columnNumber:11},void 0),de.jsxDEV("input",{type:"text",id:"postalCode",value:m,onChange:z=>s(z.target.value),placeholder:"Ex: 08001",disabled:r,maxLength:5},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:74,columnNumber:11},void 0),de.jsxDEV("small",{className:"form-help",children:"Els supermercats es buscaran basant-se en aquest codi postal"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:83,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:72,columnNumber:9},void 0),T&&de.jsxDEV("div",{className:"error-message",children:T},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:89,columnNumber:11},void 0),de.jsxDEV("div",{className:"form-actions",children:[de.jsxDEV("button",{type:"button",onClick:e,className:"btn-secondary",disabled:r,children:"Cancel·lar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:95,columnNumber:11},void 0),de.jsxDEV("button",{type:"submit",className:"btn-primary",disabled:r,children:r?"Creant...":"Crear Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:103,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:94,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:58,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/CreateListForm.tsx",lineNumber:45,columnNumber:5},void 0)},wx=({pageTitle:t,pageIcon:e,description:n,actionButtonText:r="📝 Crear o Unir-se a una Llista",showCreateJoinButtons:c=!0})=>{const d=Xm(),{userLists:m,switchToList:s}=cf(),{currentUser:T}=lf();return T?de.jsxDEV("div",{className:"page-container",children:[de.jsxDEV("div",{className:"page-header",children:de.jsxDEV("h1",{children:[e," ",t]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:46,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:45,columnNumber:7},void 0),de.jsxDEV("div",{className:"no-list-selected",children:[de.jsxDEV("h3",{children:"No hi ha cap llista seleccionada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:49,columnNumber:9},void 0),de.jsxDEV("p",{children:n},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:50,columnNumber:9},void 0),m.length>0?de.jsxDEV("div",{className:"available-lists",children:[de.jsxDEV("h4",{children:"Llistes disponibles:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:54,columnNumber:13},void 0),de.jsxDEV("div",{className:"lists-grid",children:m.map(D=>de.jsxDEV("div",{className:"list-card",onClick:()=>s(D.id),children:[de.jsxDEV("h5",{children:["📋 ",D.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:62,columnNumber:19},void 0),de.jsxDEV("p",{children:["📍 ",D.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:63,columnNumber:19},void 0),de.jsxDEV("p",{children:["👥 ",D.members.length," membre",D.members.length!==1?"s":""]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:64,columnNumber:19},void 0),de.jsxDEV("p",{children:["📊 ",D.items.length," productes"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:65,columnNumber:19},void 0),de.jsxDEV("span",{className:"click-hint",children:"Click per seleccionar →"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:66,columnNumber:19},void 0)]},D.id,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:57,columnNumber:17},void 0))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:55,columnNumber:13},void 0),de.jsxDEV("p",{className:"selection-help",children:"💡 Fes click en una llista per seleccionar-la i començar a treballar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:70,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:53,columnNumber:11},void 0):de.jsxDEV("div",{className:"no-lists",children:[de.jsxDEV("div",{className:"empty-icon",children:"📝"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:76,columnNumber:13},void 0),de.jsxDEV("h3",{children:"No tens cap llista creada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:77,columnNumber:13},void 0),de.jsxDEV("p",{children:"Crea la teva primera llista o uneix-te a una existent per començar."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:78,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:75,columnNumber:11},void 0),c&&de.jsxDEV("div",{className:"action-buttons",children:de.jsxDEV("button",{onClick:()=>d("/lists"),className:"create-list-button",children:r},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:84,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:83,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:48,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:44,columnNumber:5},void 0):de.jsxDEV("div",{className:"page-container",children:[de.jsxDEV("div",{className:"page-header",children:de.jsxDEV("h1",{children:[e," ",t]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:30,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:29,columnNumber:9},void 0),de.jsxDEV("div",{className:"not-authenticated",children:[de.jsxDEV("h3",{children:"Inicia sessió per accedir a aquesta pàgina"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:33,columnNumber:11},void 0),de.jsxDEV("p",{children:"Necessites estar autenticat per gestionar les teves llistes."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:34,columnNumber:11},void 0),de.jsxDEV("button",{onClick:()=>d("/register"),className:"login-button",children:"🔑 Iniciar Sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:35,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:32,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/NoListSelected.tsx",lineNumber:28,columnNumber:7},void 0)};function Ise(){const{currentUser:t,userProfile:e}=lf(),{currentList:n,switchToList:r,leaveList:c,deleteList:d}=cf(),{createReminder:m}=oM(),[s,T]=ke.useState(!1),[D,P]=ke.useState(!1),[z,F]=ke.useState({itemName:"",intervalWeeks:2}),[$,J]=ke.useState(null),X=()=>{T(!1)},te=async()=>{!z.itemName||!n||(await m(n.id,z.itemName,z.intervalWeeks,new Date,$?{id:$.id,name:$.name,chain:$.chain}:void 0),P(!1),F({itemName:"",intervalWeeks:2}),J(null))},ie=async()=>{!n||!e||confirm(`Estàs segur que vols eliminar la llista "${n.name}"?

Això eliminarà tots els productes i no es podrà desfer.`)&&await d(n.id)},we=async()=>{!n||!e||confirm(`Estàs segur que vols sortir de la llista "${n.name}"?`)&&await c(n.id)};return t?s?de.jsxDEV("div",{className:"pendents-page",children:de.jsxDEV(d8,{onListCreated:X,onCancel:()=>T(!1)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:93,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:92,columnNumber:7},this):n?de.jsxDEV("div",{className:"pendents-page",children:[de.jsxDEV("div",{className:"active-list-header",children:[de.jsxDEV("div",{className:"list-info",children:[de.jsxDEV("h3",{children:["📝 ",n.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:117,columnNumber:11},this),de.jsxDEV("p",{children:["📍 ",n.postalCode," • ID: ",n.id]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:118,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:116,columnNumber:9},this),de.jsxDEV("div",{className:"list-actions",children:[de.jsxDEV("button",{className:"btn-reminder",onClick:()=>{F({itemName:"",intervalWeeks:2}),J(null),P(!0)},children:"⏰ Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:121,columnNumber:11},this),de.jsxDEV("button",{className:"btn-secondary change-list-btn",onClick:()=>r(""),children:"Canviar Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:131,columnNumber:11},this),de.jsxDEV("button",{className:`btn-danger ${n.createdBy===(e==null?void 0:e.email)?"delete-list-btn":"leave-list-btn"}`,onClick:n.createdBy===(e==null?void 0:e.email)?ie:we,title:n.createdBy===(e==null?void 0:e.email)?"Eliminar llista (només el creador)":"Sortir de la llista",children:[de.jsxDEV(aL,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:142,columnNumber:13},this),n.createdBy===(e==null?void 0:e.email)?"Esborrar Llista":"Sortir de la Llista"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:137,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:120,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:115,columnNumber:7},this),de.jsxDEV(u8,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:147,columnNumber:7},this),D&&de.jsxDEV("div",{className:"modal-overlay",children:de.jsxDEV("div",{className:"modal-content",children:[de.jsxDEV("h3",{children:"⏰ Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:153,columnNumber:13},this),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{children:"Nom del producte:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:156,columnNumber:15},this),de.jsxDEV("input",{type:"text",value:z.itemName,onChange:Ie=>F(Re=>({...Re,itemName:Ie.target.value})),placeholder:"Ex: Llet, Pà, Fruita..."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:157,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:155,columnNumber:13},this),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{children:"Recordar cada:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:166,columnNumber:15},this),de.jsxDEV("select",{value:z.intervalWeeks,onChange:Ie=>F(Re=>({...Re,intervalWeeks:parseInt(Ie.target.value)})),children:[de.jsxDEV("option",{value:1,children:"1 setmana"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:171,columnNumber:17},this),de.jsxDEV("option",{value:2,children:"2 setmanes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:172,columnNumber:17},this),de.jsxDEV("option",{value:4,children:"1 mes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:173,columnNumber:17},this),de.jsxDEV("option",{value:8,children:"2 mesos"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:174,columnNumber:17},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:167,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:165,columnNumber:13},this),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{children:"Supermercat (opcional):"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:179,columnNumber:15},this),de.jsxDEV(c8,{postalCode:n==null?void 0:n.postalCode,selectedSupermarket:$,onSupermarketSelect:J,placeholder:"🏪 Seleccionar supermercat per al recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:180,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:178,columnNumber:13},this),de.jsxDEV("div",{className:"modal-actions",children:[de.jsxDEV("button",{className:"btn-secondary",onClick:()=>P(!1),children:"Cancel·lar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:189,columnNumber:15},this),de.jsxDEV("button",{className:"btn-primary",onClick:te,children:"Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:195,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:188,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:152,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:151,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:114,columnNumber:5},this):de.jsxDEV(wx,{pageTitle:"Llista de Pendents",pageIcon:"📝",description:"Selecciona una llista per començar a afegir productes i marcar-los com a comprats quan vagis de compres."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:104,columnNumber:7},this):de.jsxDEV(wx,{pageTitle:"Llista de Pendents",pageIcon:"📝",description:"Inicia sessió per gestionar les teves llistes de compra i marcar productes com a comprats.",showCreateJoinButtons:!1},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/Pendents.tsx",lineNumber:80,columnNumber:7},this)}const Mse=()=>{const{currentUser:t,userProfile:e,logout:n,updateProfile:r}=lf(),{userLists:c,currentList:d,switchToList:m,deleteList:s}=cf(),T=Xm(),[D,P]=ke.useState(!1),[z,F]=ke.useState({displayName:"",postalCode:"",listOption:"new-list"}),[$,J]=ke.useState(""),[X,te]=ke.useState(!1),[ie,we]=ke.useState(null),[Ie,Re]=ke.useState("");ke.useEffect(()=>{e&&F({displayName:e.displayName,postalCode:e.postalCode,listOption:e.listOption})},[e]);const Ne=async()=>{try{await n(),T("/")}catch{}},Xe=()=>{P(!0),J("")},be=()=>{P(!1),J(""),e&&F({displayName:e.displayName,postalCode:e.postalCode,listOption:e.listOption})},_e=async()=>{if(!z.displayName.trim()){J("El nom és obligatori");return}if(!z.postalCode.trim()){J("El codi postal és obligatori");return}if(!/^[0-5][0-9]{4}$/.test(z.postalCode.trim())){J("El codi postal ha de tenir 5 dígits (ex: 08001)");return}te(!0),J("");try{await r({displayName:z.displayName.trim(),postalCode:z.postalCode.trim(),listOption:z.listOption}),P(!1)}catch{J("Error actualitzant el perfil")}finally{te(!1)}},Te=async(St,mt)=>{if(confirm(`Estàs segur que vols eliminar la llista "${mt}"?

Això eliminarà tots els productes i no es podrà desfer.`)){we(St),Re("");try{await s(St)}catch{}finally{we(null)}}},oe=c.flatMap(St=>St.items),Ee=oe.filter(St=>!St.done),$e=oe.filter(St=>St.done),ze=St=>{m(St),T("/pendents")},zt=St=>new Date(St).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"});return!t||!e?de.jsxDEV("div",{className:"user-page-loading",children:de.jsxDEV("h2",{children:"Carregant dades de l'usuari..."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:137,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:136,columnNumber:7},void 0):de.jsxDEV("div",{className:"user-page",children:[de.jsxDEV("div",{className:"user-page-header",children:[de.jsxDEV("h1",{children:"Perfil de l'usuari"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:145,columnNumber:9},void 0),de.jsxDEV("button",{className:"logout-button",onClick:Ne,children:"Tancar sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:146,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:144,columnNumber:7},void 0),de.jsxDEV("section",{className:"user-info-section",children:[de.jsxDEV("div",{className:"section-header",children:[de.jsxDEV("h2",{children:"📋 Informació Personal"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:154,columnNumber:11},void 0),!D&&de.jsxDEV("button",{className:"edit-button",onClick:Xe,children:"✏️ Editar Perfil"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:156,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:153,columnNumber:9},void 0),D?de.jsxDEV("div",{className:"edit-profile-form",children:[$&&de.jsxDEV("div",{className:"error-message",children:["❌ ",$]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:183,columnNumber:15},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"displayName",children:de.jsxDEV("strong",{children:"Nom:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:190,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:189,columnNumber:15},void 0),de.jsxDEV("input",{type:"text",id:"displayName",value:z.displayName,onChange:St=>F({...z,displayName:St.target.value}),placeholder:"El teu nom",disabled:X},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:192,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:188,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"email",children:de.jsxDEV("strong",{children:"Email:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:204,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:203,columnNumber:15},void 0),de.jsxDEV("input",{type:"email",id:"email",value:e.email,disabled:!0,title:"L'email no es pot modificar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:206,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:202,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"postalCode",children:de.jsxDEV("strong",{children:"Codi Postal:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:217,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:216,columnNumber:15},void 0),de.jsxDEV("input",{type:"text",id:"postalCode",value:z.postalCode,onChange:St=>F({...z,postalCode:St.target.value}),placeholder:"08001",disabled:X,maxLength:5},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:219,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:215,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"listOption",children:de.jsxDEV("strong",{children:"Opció de llista per defecte:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:232,columnNumber:17},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:231,columnNumber:15},void 0),de.jsxDEV("select",{id:"listOption",value:z.listOption,onChange:St=>F({...z,listOption:St.target.value}),disabled:X,children:[de.jsxDEV("option",{value:"new-list",children:"Nova llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:240,columnNumber:17},void 0),de.jsxDEV("option",{value:"add-to-list",children:"Afegir a llista existent"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:241,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:234,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:230,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-actions",children:[de.jsxDEV("button",{className:"save-button",onClick:_e,disabled:X,children:X?"⏳ Guardant...":"💾 Guardar Canvis"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:246,columnNumber:15},void 0),de.jsxDEV("button",{className:"cancel-button",onClick:be,disabled:X,children:"❌ Cancel·lar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:253,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:245,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:181,columnNumber:11},void 0):de.jsxDEV("div",{className:"user-details",children:[de.jsxDEV("div",{className:"user-detail",children:[de.jsxDEV("strong",{children:"Nom:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:165,columnNumber:15},void 0)," ",e.displayName]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:164,columnNumber:13},void 0),de.jsxDEV("div",{className:"user-detail",children:[de.jsxDEV("strong",{children:"Email:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:168,columnNumber:15},void 0)," ",e.email]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:167,columnNumber:13},void 0),de.jsxDEV("div",{className:"user-detail",children:[de.jsxDEV("strong",{children:"Codi Postal:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:171,columnNumber:15},void 0)," 📍 ",e.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:170,columnNumber:13},void 0),de.jsxDEV("div",{className:"user-detail",children:[de.jsxDEV("strong",{children:"Opció de llista:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:174,columnNumber:15},void 0)," ",e.listOption==="new-list"?"Nova llista":"Afegir a llista existent"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:173,columnNumber:13},void 0),de.jsxDEV("div",{className:"user-detail",children:[de.jsxDEV("strong",{children:"Registrat el:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:177,columnNumber:15},void 0)," ",zt(e.createdAt)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:176,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:163,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:152,columnNumber:7},void 0),de.jsxDEV("section",{className:"shopping-stats",children:[de.jsxDEV("h2",{children:"📊 Estadístiques de Compra"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:267,columnNumber:9},void 0),de.jsxDEV("div",{className:"stats-grid",children:[de.jsxDEV("div",{className:"stat-card pending",children:[de.jsxDEV("h3",{children:"Productes Pendents"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:270,columnNumber:13},void 0),de.jsxDEV("span",{className:"stat-number",children:Ee.length},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:271,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:269,columnNumber:11},void 0),de.jsxDEV("div",{className:"stat-card completed",children:[de.jsxDEV("h3",{children:"Productes Comprats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:274,columnNumber:13},void 0),de.jsxDEV("span",{className:"stat-number",children:$e.length},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:275,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:273,columnNumber:11},void 0),de.jsxDEV("div",{className:"stat-card total",children:[de.jsxDEV("h3",{children:"Total Llistes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:278,columnNumber:13},void 0),de.jsxDEV("span",{className:"stat-number",children:c.length},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:279,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:277,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:268,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:266,columnNumber:7},void 0),de.jsxDEV("section",{className:"pending-products",children:[de.jsxDEV("div",{className:"section-header",children:de.jsxDEV("h2",{children:"🛒 Les Meves Llistes de Compra"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:287,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:286,columnNumber:9},void 0),Ie&&de.jsxDEV("div",{className:"error-message",children:["❌ ",Ie]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:291,columnNumber:11},void 0),c.length===0?de.jsxDEV("div",{className:"empty-state",children:[de.jsxDEV("p",{children:"No tens cap llista de compra creada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:298,columnNumber:13},void 0),de.jsxDEV("button",{onClick:()=>T("/lists"),className:"go-shopping-button",children:"Crear o unir-se a una llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:299,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:297,columnNumber:11},void 0):de.jsxDEV("div",{className:"lists-overview",children:c.map(St=>{const mt=St.items.filter(Xt=>!Xt.done),Ft=St.items.filter(Xt=>Xt.done),rn=mt.slice(0,2);return de.jsxDEV("div",{className:`list-overview-card ${(d==null?void 0:d.id)===St.id?"active-list":""} ${ie===St.id?"deleting":""}`,children:[de.jsxDEV("div",{className:"list-overview-header",children:[de.jsxDEV("h4",{children:["📋 ",St.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:316,columnNumber:21},void 0),de.jsxDEV("div",{className:"list-header-actions",children:[de.jsxDEV("div",{className:"list-overview-stats",children:[de.jsxDEV("span",{className:"pending-count",children:[mt.length," pendents"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:319,columnNumber:25},void 0),de.jsxDEV("span",{className:"completed-count",children:[Ft.length," comprats"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:320,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:318,columnNumber:23},void 0),St.createdBy===e.email&&de.jsxDEV("button",{className:"delete-list-button",onClick:Xt=>{Xt.stopPropagation(),Te(St.id,St.name)},disabled:ie===St.id,title:"Eliminar llista (només el creador)",children:ie===St.id?"⏳":"🗑️"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:323,columnNumber:25},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:317,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:315,columnNumber:19},void 0),de.jsxDEV("div",{className:"list-content",onClick:()=>ze(St.id),children:[de.jsxDEV("div",{className:"list-overview-info",children:[de.jsxDEV("p",{className:"list-location",children:["📍 ",St.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:343,columnNumber:23},void 0),de.jsxDEV("p",{className:"list-members",children:["👥 ",St.members.length," membres"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:344,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:342,columnNumber:21},void 0),rn.length>0&&de.jsxDEV("div",{className:"list-preview-items",children:[de.jsxDEV("h5",{children:"Productes pendents:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:349,columnNumber:25},void 0),rn.map(Xt=>de.jsxDEV("div",{className:"preview-item",children:de.jsxDEV("span",{className:"preview-item-name",children:Xt.task},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:352,columnNumber:29},void 0)},Xt.id,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:351,columnNumber:27},void 0)),mt.length>2&&de.jsxDEV("p",{className:"more-items-preview",children:["... i ",mt.length-2," més"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:356,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:348,columnNumber:23},void 0),mt.length===0&&de.jsxDEV("div",{className:"no-pending-items",children:de.jsxDEV("p",{children:"✅ Tots els productes comprats!"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:365,columnNumber:25},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:364,columnNumber:23},void 0),de.jsxDEV("div",{className:"click-hint",children:de.jsxDEV("p",{children:"Click per accedir a la llista →"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:370,columnNumber:23},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:369,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:338,columnNumber:19},void 0)]},St.id,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:311,columnNumber:17},void 0)})},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:304,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:285,columnNumber:7},void 0),de.jsxDEV("section",{className:"quick-actions",children:[de.jsxDEV("h2",{children:"⚡ Accions Ràpides"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:382,columnNumber:9},void 0),de.jsxDEV("div",{className:"action-buttons",children:[de.jsxDEV("button",{onClick:()=>T("/lists"),className:"action-button",children:"📝 Gestionar Llistes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:384,columnNumber:11},void 0),de.jsxDEV("button",{onClick:()=>T("/"),className:"action-button",children:"🛒 Anar a Comprar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:387,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:383,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:381,columnNumber:7},void 0),de.jsxDEV("div",{className:"page-footer",children:de.jsxDEV("button",{onClick:()=>T("/"),className:"back-button",children:"← Tornar a la llista de compra"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:395,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:394,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/UserPage.tsx",lineNumber:143,columnNumber:5},void 0)},Pse=()=>{const t=Xm(),{userProfile:e}=lf(),{userLists:n,currentList:r,switchToList:c,joinList:d,leaveList:m,deleteList:s,isLoading:T}=cf(),[D,P]=ke.useState(!1),[z,F]=ke.useState(!1),[$,J]=ke.useState(""),X=()=>{P(!1),t("/pendents")},te=async Ne=>{Ne.preventDefault(),$.trim()&&(await d($.trim().toUpperCase()),F(!1),J(""))},ie=Ne=>{c(Ne),t("/pendents")},we=(Ne,Xe)=>{window.confirm(`Estàs segur que vols sortir de la llista "${Xe}"?`)&&m(Ne)},Ie=async(Ne,Xe)=>{e&&confirm(`Estàs segur que vols eliminar la llista "${Xe}"?

Això eliminarà tots els productes i no es podrà desfer.`)&&await s(Ne)},Re=Ne=>new Date(Ne).toLocaleDateString("ca-ES",{year:"numeric",month:"long",day:"numeric"});return D?de.jsxDEV("div",{className:"lists-page",children:de.jsxDEV(d8,{onListCreated:X,onCancel:()=>P(!1)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:75,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:74,columnNumber:7},void 0):de.jsxDEV("div",{className:"lists-page",children:[de.jsxDEV("div",{className:"page-header",children:[de.jsxDEV("h2",{children:"Les Meves Llistes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:86,columnNumber:9},void 0),de.jsxDEV("p",{children:"Gestiona les teves llistes de compra compartides"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:87,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:85,columnNumber:7},void 0),de.jsxDEV("div",{className:"lists-actions",children:[de.jsxDEV("button",{className:"btn-primary create-list-btn",onClick:()=>P(!0),children:"➕ Crear Nova Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:91,columnNumber:9},void 0),de.jsxDEV("button",{className:"btn-secondary join-list-btn",onClick:()=>F(!z),children:"🔗 Unir-se a una Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:98,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:90,columnNumber:7},void 0),z&&de.jsxDEV("div",{className:"join-list-form",children:[de.jsxDEV("h4",{children:"Unir-se a una Llista Existent"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:108,columnNumber:11},void 0),de.jsxDEV("form",{onSubmit:te,children:[de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{htmlFor:"joinListId",children:"ID de la llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:111,columnNumber:15},void 0),de.jsxDEV("input",{type:"text",id:"joinListId",value:$,onChange:Ne=>J(Ne.target.value.toUpperCase()),placeholder:"Ex: ABC123XYZ",maxLength:9,style:{textTransform:"uppercase"}},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:112,columnNumber:15},void 0),de.jsxDEV("small",{className:"form-help",children:"Demana l'ID de la llista a la persona que la va crear"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:121,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:110,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-actions",children:[de.jsxDEV("button",{type:"button",onClick:()=>{F(!1),J("")},className:"btn-secondary",children:"Cancel·lar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:127,columnNumber:15},void 0),de.jsxDEV("button",{type:"submit",className:"btn-primary",disabled:T,children:T?"Unint-se...":"Unir-se"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:137,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:126,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:109,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:107,columnNumber:9},void 0),de.jsxDEV("div",{className:"lists-container",children:n.length===0?de.jsxDEV("div",{className:"empty-lists",children:[de.jsxDEV("div",{className:"empty-icon",children:"📝"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:152,columnNumber:13},void 0),de.jsxDEV("h3",{children:"No tens cap llista encara"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:153,columnNumber:13},void 0),de.jsxDEV("p",{children:"Crea la teva primera llista o uneix-te a una existent"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:154,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:151,columnNumber:11},void 0):de.jsxDEV("div",{className:"lists-grid",children:n.map(Ne=>de.jsxDEV("div",{className:`list-card ${(r==null?void 0:r.id)===Ne.id?"active":""}`,children:[de.jsxDEV("div",{className:"list-header",children:[de.jsxDEV("h4",{children:Ne.name},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:164,columnNumber:19},void 0),de.jsxDEV("span",{className:"list-id",children:["ID: ",Ne.id]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:165,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:163,columnNumber:17},void 0),de.jsxDEV("div",{className:"list-info",children:[de.jsxDEV("p",{className:"list-location",children:["📍 ",Ne.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:169,columnNumber:19},void 0),de.jsxDEV("p",{className:"list-items",children:[Ne.items.length," productes • ",Ne.items.filter(Xe=>Xe.done).length," comprats"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:170,columnNumber:19},void 0),de.jsxDEV("p",{className:"list-members",children:["👥 ",Ne.members.length," membre",Ne.members.length!==1?"s":""]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:173,columnNumber:19},void 0),de.jsxDEV("p",{className:"list-date",children:["Creada: ",Re(Ne.createdAt)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:176,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:168,columnNumber:17},void 0),de.jsxDEV("div",{className:"list-actions",children:[de.jsxDEV("button",{className:"btn-primary",onClick:()=>ie(Ne.id),children:(r==null?void 0:r.id)===Ne.id?"Llista Activa":"Seleccionar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:182,columnNumber:19},void 0),Ne.createdBy===(e==null?void 0:e.email)?de.jsxDEV("button",{className:"btn-danger",onClick:()=>Ie(Ne.id,Ne.name),title:"Eliminar llista (només el creador)",children:[de.jsxDEV(aL,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:195,columnNumber:23},void 0),"Eliminar"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:190,columnNumber:21},void 0):de.jsxDEV("button",{className:"btn-danger",onClick:()=>we(Ne.id,Ne.name),children:"Sortir"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:199,columnNumber:21},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:181,columnNumber:17},void 0)]},Ne.id,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:159,columnNumber:15},void 0))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:157,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:149,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/ListsPage.tsx",lineNumber:84,columnNumber:5},void 0)};function kse({onUserRegistered:t,onPostalCodeChange:e,onSwitchToLogin:n}){const{register:r}=lf(),[c,d]=ke.useState({user:"",email:"",password:"",repeatPassword:"",postal:"",listOption:"new-list"}),[m,s]=ke.useState([]),[T,D]=ke.useState(!1),[P,z]=ke.useState(""),F=X=>{const{name:te,value:ie}=X.target,we={...c,[te]:ie};d(we),te==="postal"&&(e==null||e(ie)),m.length>0&&s([])},$=()=>{const X=[];c.user.trim()?c.user.length<3&&X.push("El nom d'usuari ha de tenir almenys 3 caràcters"):X.push("El nom d'usuari és obligatori");const te=/^[^\s@]+@[^\s@]+\.[^\s@]+$/;return c.email.trim()?te.test(c.email)||X.push("Format d'email no vàlid"):X.push("L'email és obligatori"),c.password?c.password.length<6&&X.push("La contrasenya ha de tenir almenys 6 caràcters"):X.push("La contrasenya és obligatòria"),c.password!==c.repeatPassword&&X.push("Les contrasenyes no coincideixen"),c.postal.trim()?/^\d{5}$/.test(c.postal)||X.push("El codi postal ha de tenir 5 dígits"):X.push("El codi postal és obligatori"),X},J=async X=>{X.preventDefault();const te=$();if(te.length>0){s(te);return}D(!0),s([]);try{await r(c.email,c.password,c.user,c.postal,c.listOption),z("✅ Usuari registrat correctament!"),t==null||t(c.postal),setTimeout(()=>{d({user:"",email:"",password:"",repeatPassword:"",postal:"",listOption:"new-list"}),z("")},2e3)}catch(ie){const we=ie instanceof Error?ie.message:"Error desconegut en el registre";s([we])}finally{D(!1)}};return de.jsxDEV("section",{children:de.jsxDEV("form",{onSubmit:J,children:[de.jsxDEV("fieldset",{children:[de.jsxDEV("legend",{children:de.jsxDEV("h3",{children:"Crea el teu usuari!"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:146,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:145,columnNumber:11},this),m.length>0&&de.jsxDEV("div",{className:"error-messages",children:m.map((X,te)=>de.jsxDEV("div",{className:"error-message",children:["❌ ",X]},te,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:153,columnNumber:17},this))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:151,columnNumber:13},this),P&&de.jsxDEV("div",{className:"success-message",children:P},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:162,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"user",children:"Usuari:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:167,columnNumber:11},this),de.jsxDEV("input",{id:"user",placeholder:"usuari",type:"text",name:"user",value:c.user,onChange:F,disabled:T,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:168,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:177,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"email",children:"Email:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:179,columnNumber:11},this),de.jsxDEV("input",{id:"email",placeholder:"email@example.com",type:"email",name:"email",value:c.email,onChange:F,disabled:T,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:180,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:189,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"password",children:"Contrasenya:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:191,columnNumber:11},this),de.jsxDEV("input",{id:"password",placeholder:"contrasenya (mínim 6 caràcters)",type:"password",name:"password",value:c.password,onChange:F,disabled:T,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:192,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:201,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"repeatPassword",children:"Repeteixi contrasenya:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:203,columnNumber:11},this),de.jsxDEV("input",{id:"repeatPassword",placeholder:"repeteixi contrasenya",type:"password",name:"repeatPassword",value:c.repeatPassword,onChange:F,disabled:T,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:204,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:213,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"postal",children:"Introdueixi el seu codi postal:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:215,columnNumber:11},this),de.jsxDEV("input",{id:"postal",placeholder:"08001",type:"text",name:"postal",value:c.postal,onChange:F,disabled:T,maxLength:5,pattern:"\\d{5}",required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:216,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:227,columnNumber:13},this),de.jsxDEV("div",{className:"radio-group",children:[de.jsxDEV("label",{children:[de.jsxDEV("input",{type:"radio",name:"listOption",value:"new-list",checked:c.listOption==="new-list",onChange:F,disabled:T},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:231,columnNumber:15},this),"Crear una nova llista"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:230,columnNumber:13},this),de.jsxDEV("label",{children:[de.jsxDEV("input",{type:"radio",name:"listOption",value:"add-to-list",checked:c.listOption==="add-to-list",onChange:F,disabled:T},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:242,columnNumber:15},this),"Unir-me a una llista existent"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:241,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:229,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:144,columnNumber:9},this),de.jsxDEV("div",{className:"inicia-section",children:de.jsxDEV("button",{type:"submit",className:"inicia-button",disabled:T,children:T?"⏳ Registrant...":"Registra't"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:256,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:255,columnNumber:9},this),n&&de.jsxDEV("div",{className:"switch-form",children:de.jsxDEV("p",{children:["Ja tens compte?",de.jsxDEV("button",{type:"button",className:"link-button",onClick:n,disabled:T,children:"Inicia sessió aquí"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:269,columnNumber:15},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:267,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:266,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:143,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/FormUser.tsx",lineNumber:142,columnNumber:5},this)}function Nse({onSwitchToRegister:t}){const{login:e}=lf(),n=Xm(),[r,c]=ke.useState({email:"",password:""}),[d,m]=ke.useState([]),[s,T]=ke.useState(!1),D=z=>{const{name:F,value:$}=z.target;c({...r,[F]:$}),d.length>0&&m([])},P=async z=>{if(z.preventDefault(),!r.email||!r.password){m(["Tots els camps són obligatoris"]);return}T(!0),m([]);try{await e(r.email,r.password),n("/")}catch(F){m([F.message||"Error en iniciar sessió"])}finally{T(!1)}};return de.jsxDEV("section",{children:de.jsxDEV("form",{onSubmit:P,children:[de.jsxDEV("fieldset",{children:[de.jsxDEV("legend",{children:de.jsxDEV("h3",{children:"Inicia sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:57,columnNumber:13},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:56,columnNumber:11},this),d.length>0&&de.jsxDEV("div",{className:"error-messages",children:d.map((z,F)=>de.jsxDEV("div",{className:"error-message",children:["❌ ",z]},F,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:64,columnNumber:17},this))},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:62,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"loginEmail",children:"Email:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:71,columnNumber:11},this),de.jsxDEV("input",{id:"loginEmail",placeholder:"email@example.com",type:"email",name:"email",value:r.email,onChange:D,disabled:s,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:72,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:81,columnNumber:13},this),de.jsxDEV("label",{htmlFor:"loginPassword",children:"Contrasenya:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:83,columnNumber:11},this),de.jsxDEV("input",{id:"loginPassword",placeholder:"contrasenya",type:"password",name:"password",value:r.password,onChange:D,disabled:s,required:!0},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:84,columnNumber:11},this),de.jsxDEV("br",{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:93,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:55,columnNumber:9},this),de.jsxDEV("div",{className:"inicia-section",children:de.jsxDEV("button",{type:"submit",className:"inicia-button",disabled:s,children:s?"⏳ Iniciant sessió...":"Inicia sessió"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:97,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:96,columnNumber:9},this),de.jsxDEV("div",{className:"switch-form",children:de.jsxDEV("p",{children:["No tens compte?",de.jsxDEV("button",{type:"button",className:"link-button",onClick:t,disabled:s,children:"Registra't aquí"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:109,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:107,columnNumber:11},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:106,columnNumber:9},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:54,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/LoginForm.tsx",lineNumber:53,columnNumber:5},this)}const Lse=()=>{const t=Xm(),[e,n]=ke.useState(!1),r=d=>{t("/",{replace:!0})},c=d=>{};return de.jsxDEV("div",{className:"register-page",children:[de.jsxDEV("div",{className:"register-header",children:[de.jsxDEV("h1",{children:"Uneix-te a Inprocode Shopping"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:24,columnNumber:9},void 0),de.jsxDEV("p",{children:"Crea el teu compte per començar a gestionar llistes compartides"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:25,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:23,columnNumber:7},void 0),de.jsxDEV("section",{className:"inicia-section",children:de.jsxDEV("button",{className:"inicia-button",onClick:()=>n(!e),children:e?"Vull registrar-me":"Ja tinc compte"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:30,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:29,columnNumber:7},void 0),e?de.jsxDEV(Nse,{onSwitchToRegister:()=>n(!1)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:40,columnNumber:9},void 0):de.jsxDEV(kse,{onUserRegistered:r,onPostalCodeChange:c,onSwitchToLogin:()=>n(!0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:42,columnNumber:9},void 0),de.jsxDEV(h8,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:50,columnNumber:7},void 0),de.jsxDEV("div",{className:"page-footer",children:de.jsxDEV("button",{onClick:()=>t("/"),className:"back-button",children:"← Tornar a l'inici"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:54,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:53,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/RegisterPage.tsx",lineNumber:21,columnNumber:5},void 0)};var KR={exports:{}},zse=KR.exports,EF;function Bse(){return EF||(EF=1,function(t,e){(function(n,r){t.exports=r()})(zse,function(){var n,r,c;function d(s,T){if(!n)n=T;else if(!r)r=T;else{var D="self.onerror = function() { console.error('An error occurred while parsing the WebWorker bundle. This is most likely due to improper transpilation by Babel; please see https://docs.mapbox.com/mapbox-gl-js/guides/install/#transpiling'); }; var sharedChunk = {}; ("+n+")(sharedChunk); ("+r+")(sharedChunk); self.onerror = null;",P={};n(P),c=T(P),typeof window<"u"&&window&&window.URL&&window.URL.createObjectURL&&(c.workerUrl=window.URL.createObjectURL(new Blob([D],{type:"text/javascript"})))}}d(["exports"],function(s){var T=1e-6,D=typeof Float32Array<"u"?Float32Array:Array;function P(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=l*b-g*p;return x?(u[0]=b*(x=1/x),u[1]=-p*x,u[2]=-g*x,u[3]=l*x,u):null}function z(){var u=new D(9);return D!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[5]=0,u[6]=0,u[7]=0),u[0]=1,u[4]=1,u[8]=1,u}function F(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=i[4],A=i[5],R=i[6],O=i[7],L=i[8];return u[0]=x*L-A*O,u[1]=g*O-p*L,u[2]=p*A-g*x,u[3]=A*R-b*L,u[4]=l*L-g*R,u[5]=g*b-l*A,u[6]=b*O-x*R,u[7]=p*R-l*O,u[8]=l*x-p*b,u}function $(u,i,l){var p=i[0],g=i[1],b=i[2],x=i[3],A=i[4],R=i[5],O=i[6],L=i[7],B=i[8],U=l[0],q=l[1],Y=l[2],ne=l[3],ae=l[4],he=l[5],Se=l[6],Ae=l[7],re=l[8];return u[0]=U*p+q*x+Y*O,u[1]=U*g+q*A+Y*L,u[2]=U*b+q*R+Y*B,u[3]=ne*p+ae*x+he*O,u[4]=ne*g+ae*A+he*L,u[5]=ne*b+ae*R+he*B,u[6]=Se*p+Ae*x+re*O,u[7]=Se*g+Ae*A+re*L,u[8]=Se*b+Ae*R+re*B,u}function J(){var u=new D(16);return D!=Float32Array&&(u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=0,u[12]=0,u[13]=0,u[14]=0),u[0]=1,u[5]=1,u[10]=1,u[15]=1,u}function X(u){return u[0]=1,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=1,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=1,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function te(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=i[4],A=i[5],R=i[6],O=i[7],L=i[8],B=i[9],U=i[10],q=i[11],Y=i[12],ne=i[13],ae=i[14],he=i[15],Se=l*A-p*x,Ae=l*R-g*x,re=l*O-b*x,ye=p*R-g*A,Oe=p*O-b*A,Le=g*O-b*R,nt=L*ne-B*Y,Qe=L*ae-U*Y,st=L*he-q*Y,dt=B*ae-U*ne,a=B*he-q*ne,h=U*he-q*ae,v=Se*h-Ae*a+re*dt+ye*st-Oe*Qe+Le*nt;return v?(u[0]=(A*h-R*a+O*dt)*(v=1/v),u[1]=(g*a-p*h-b*dt)*v,u[2]=(ne*Le-ae*Oe+he*ye)*v,u[3]=(U*Oe-B*Le-q*ye)*v,u[4]=(R*st-x*h-O*Qe)*v,u[5]=(l*h-g*st+b*Qe)*v,u[6]=(ae*re-Y*Le-he*Ae)*v,u[7]=(L*Le-U*re+q*Ae)*v,u[8]=(x*a-A*st+O*nt)*v,u[9]=(p*st-l*a-b*nt)*v,u[10]=(Y*Oe-ne*re+he*Se)*v,u[11]=(B*re-L*Oe-q*Se)*v,u[12]=(A*Qe-x*dt-R*nt)*v,u[13]=(l*dt-p*Qe+g*nt)*v,u[14]=(ne*Ae-Y*ye-ae*Se)*v,u[15]=(L*ye-B*Ae+U*Se)*v,u):null}function ie(u,i,l){var p=i[0],g=i[1],b=i[2],x=i[3],A=i[4],R=i[5],O=i[6],L=i[7],B=i[8],U=i[9],q=i[10],Y=i[11],ne=i[12],ae=i[13],he=i[14],Se=i[15],Ae=l[0],re=l[1],ye=l[2],Oe=l[3];return u[0]=Ae*p+re*A+ye*B+Oe*ne,u[1]=Ae*g+re*R+ye*U+Oe*ae,u[2]=Ae*b+re*O+ye*q+Oe*he,u[3]=Ae*x+re*L+ye*Y+Oe*Se,u[4]=(Ae=l[4])*p+(re=l[5])*A+(ye=l[6])*B+(Oe=l[7])*ne,u[5]=Ae*g+re*R+ye*U+Oe*ae,u[6]=Ae*b+re*O+ye*q+Oe*he,u[7]=Ae*x+re*L+ye*Y+Oe*Se,u[8]=(Ae=l[8])*p+(re=l[9])*A+(ye=l[10])*B+(Oe=l[11])*ne,u[9]=Ae*g+re*R+ye*U+Oe*ae,u[10]=Ae*b+re*O+ye*q+Oe*he,u[11]=Ae*x+re*L+ye*Y+Oe*Se,u[12]=(Ae=l[12])*p+(re=l[13])*A+(ye=l[14])*B+(Oe=l[15])*ne,u[13]=Ae*g+re*R+ye*U+Oe*ae,u[14]=Ae*b+re*O+ye*q+Oe*he,u[15]=Ae*x+re*L+ye*Y+Oe*Se,u}function we(u,i,l){var p,g,b,x,A,R,O,L,B,U,q,Y,ne=l[0],ae=l[1],he=l[2];return i===u?(u[12]=i[0]*ne+i[4]*ae+i[8]*he+i[12],u[13]=i[1]*ne+i[5]*ae+i[9]*he+i[13],u[14]=i[2]*ne+i[6]*ae+i[10]*he+i[14],u[15]=i[3]*ne+i[7]*ae+i[11]*he+i[15]):(g=i[1],b=i[2],x=i[3],A=i[4],R=i[5],O=i[6],L=i[7],B=i[8],U=i[9],q=i[10],Y=i[11],u[0]=p=i[0],u[1]=g,u[2]=b,u[3]=x,u[4]=A,u[5]=R,u[6]=O,u[7]=L,u[8]=B,u[9]=U,u[10]=q,u[11]=Y,u[12]=p*ne+A*ae+B*he+i[12],u[13]=g*ne+R*ae+U*he+i[13],u[14]=b*ne+O*ae+q*he+i[14],u[15]=x*ne+L*ae+Y*he+i[15]),u}function Ie(u,i,l){var p=l[0],g=l[1],b=l[2];return u[0]=i[0]*p,u[1]=i[1]*p,u[2]=i[2]*p,u[3]=i[3]*p,u[4]=i[4]*g,u[5]=i[5]*g,u[6]=i[6]*g,u[7]=i[7]*g,u[8]=i[8]*b,u[9]=i[9]*b,u[10]=i[10]*b,u[11]=i[11]*b,u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15],u}function Re(u,i,l){var p=Math.sin(l),g=Math.cos(l),b=i[4],x=i[5],A=i[6],R=i[7],O=i[8],L=i[9],B=i[10],U=i[11];return i!==u&&(u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[3],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[4]=b*g+O*p,u[5]=x*g+L*p,u[6]=A*g+B*p,u[7]=R*g+U*p,u[8]=O*g-b*p,u[9]=L*g-x*p,u[10]=B*g-A*p,u[11]=U*g-R*p,u}function Ne(u,i,l){var p=Math.sin(l),g=Math.cos(l),b=i[0],x=i[1],A=i[2],R=i[3],O=i[8],L=i[9],B=i[10],U=i[11];return i!==u&&(u[4]=i[4],u[5]=i[5],u[6]=i[6],u[7]=i[7],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=b*g-O*p,u[1]=x*g-L*p,u[2]=A*g-B*p,u[3]=R*g-U*p,u[8]=b*p+O*g,u[9]=x*p+L*g,u[10]=A*p+B*g,u[11]=R*p+U*g,u}function Xe(u,i,l){var p=Math.sin(l),g=Math.cos(l),b=i[0],x=i[1],A=i[2],R=i[3],O=i[4],L=i[5],B=i[6],U=i[7];return i!==u&&(u[8]=i[8],u[9]=i[9],u[10]=i[10],u[11]=i[11],u[12]=i[12],u[13]=i[13],u[14]=i[14],u[15]=i[15]),u[0]=b*g+O*p,u[1]=x*g+L*p,u[2]=A*g+B*p,u[3]=R*g+U*p,u[4]=O*g-b*p,u[5]=L*g-x*p,u[6]=B*g-A*p,u[7]=U*g-R*p,u}function be(u,i){return u[0]=i[0],u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=i[1],u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=i[2],u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}function _e(u,i,l){var p,g,b,x=l[0],A=l[1],R=l[2],O=Math.hypot(x,A,R);return O<T?null:(x*=O=1/O,A*=O,R*=O,p=Math.sin(i),g=Math.cos(i),u[0]=x*x*(b=1-g)+g,u[1]=A*x*b+R*p,u[2]=R*x*b-A*p,u[3]=0,u[4]=x*A*b-R*p,u[5]=A*A*b+g,u[6]=R*A*b+x*p,u[7]=0,u[8]=x*R*b+A*p,u[9]=A*R*b-x*p,u[10]=R*R*b+g,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u)}function Te(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=l+l,A=p+p,R=g+g,O=l*x,L=p*x,B=p*A,U=g*x,q=g*A,Y=g*R,ne=b*x,ae=b*A,he=b*R;return u[0]=1-B-Y,u[1]=L+he,u[2]=U-ae,u[3]=0,u[4]=L-he,u[5]=1-O-Y,u[6]=q+ne,u[7]=0,u[8]=U+ae,u[9]=q-ne,u[10]=1-O-B,u[11]=0,u[12]=0,u[13]=0,u[14]=0,u[15]=1,u}Math.hypot||(Math.hypot=function(){for(var u=0,i=arguments.length;i--;)u+=arguments[i]*arguments[i];return Math.sqrt(u)});var oe=ie;function Ee(){var u=new D(3);return D!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u}function $e(u){var i=new D(3);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i}function ze(u){return Math.hypot(u[0],u[1],u[2])}function zt(u,i,l){var p=new D(3);return p[0]=u,p[1]=i,p[2]=l,p}function St(u,i,l){return u[0]=i[0]+l[0],u[1]=i[1]+l[1],u[2]=i[2]+l[2],u}function mt(u,i,l){return u[0]=i[0]-l[0],u[1]=i[1]-l[1],u[2]=i[2]-l[2],u}function Ft(u,i,l){return u[0]=i[0]*l[0],u[1]=i[1]*l[1],u[2]=i[2]*l[2],u}function rn(u,i,l){return u[0]=Math.min(i[0],l[0]),u[1]=Math.min(i[1],l[1]),u[2]=Math.min(i[2],l[2]),u}function Xt(u,i,l){return u[0]=Math.max(i[0],l[0]),u[1]=Math.max(i[1],l[1]),u[2]=Math.max(i[2],l[2]),u}function Fe(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u[2]=i[2]*l,u}function Ot(u,i,l,p){return u[0]=i[0]+l[0]*p,u[1]=i[1]+l[1]*p,u[2]=i[2]+l[2]*p,u}function Ut(u,i){var l=i[0]-u[0],p=i[1]-u[1],g=i[2]-u[2];return l*l+p*p+g*g}function ln(u){var i=u[0],l=u[1],p=u[2];return i*i+l*l+p*p}function wn(u,i){return u[0]=-i[0],u[1]=-i[1],u[2]=-i[2],u}function dn(u,i){var l=i[0],p=i[1],g=i[2],b=l*l+p*p+g*g;return b>0&&(b=1/Math.sqrt(b)),u[0]=i[0]*b,u[1]=i[1]*b,u[2]=i[2]*b,u}function Ht(u,i){return u[0]*i[0]+u[1]*i[1]+u[2]*i[2]}function Mn(u,i,l){var p=i[0],g=i[1],b=i[2],x=l[0],A=l[1],R=l[2];return u[0]=g*R-b*A,u[1]=b*x-p*R,u[2]=p*A-g*x,u}function yn(u,i,l,p){var g=i[0],b=i[1],x=i[2];return u[0]=g+p*(l[0]-g),u[1]=b+p*(l[1]-b),u[2]=x+p*(l[2]-x),u}function Tn(u,i,l){var p=i[0],g=i[1],b=i[2],x=l[3]*p+l[7]*g+l[11]*b+l[15];return u[0]=(l[0]*p+l[4]*g+l[8]*b+l[12])/(x=x||1),u[1]=(l[1]*p+l[5]*g+l[9]*b+l[13])/x,u[2]=(l[2]*p+l[6]*g+l[10]*b+l[14])/x,u}function Cn(u,i,l){var p=i[0],g=i[1],b=i[2];return u[0]=p*l[0]+g*l[3]+b*l[6],u[1]=p*l[1]+g*l[4]+b*l[7],u[2]=p*l[2]+g*l[5]+b*l[8],u}function Kn(u,i,l){var p=l[0],g=l[1],b=l[2],x=i[0],A=i[1],R=i[2],O=g*R-b*A,L=b*x-p*R,B=p*A-g*x,U=g*B-b*L,q=b*O-p*B,Y=p*L-g*O,ne=2*l[3];return L*=ne,B*=ne,q*=2,Y*=2,u[0]=x+(O*=ne)+(U*=2),u[1]=A+L+q,u[2]=R+B+Y,u}function Bt(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]}var ni=mt,er=Ft,_r=ze;function Li(){var u=new D(4);return D!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0,u[3]=0),u}function jr(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u[2]=i[2]*l,u[3]=i[3]*l,u}function ss(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=l*l+p*p+g*g+b*b;return x>0&&(x=1/Math.sqrt(x)),u[0]=l*x,u[1]=p*x,u[2]=g*x,u[3]=b*x,u}function Nr(u,i,l){var p=i[0],g=i[1],b=i[2],x=i[3];return u[0]=l[0]*p+l[4]*g+l[8]*b+l[12]*x,u[1]=l[1]*p+l[5]*g+l[9]*b+l[13]*x,u[2]=l[2]*p+l[6]*g+l[10]*b+l[14]*x,u[3]=l[3]*p+l[7]*g+l[11]*b+l[15]*x,u}function ti(){var u=new D(4);return D!=Float32Array&&(u[0]=0,u[1]=0,u[2]=0),u[3]=1,u}function dr(u){return u[0]=0,u[1]=0,u[2]=0,u[3]=1,u}function di(u,i,l){l*=.5;var p=i[0],g=i[1],b=i[2],x=i[3],A=Math.sin(l),R=Math.cos(l);return u[0]=p*R+x*A,u[1]=g*R+b*A,u[2]=b*R-g*A,u[3]=x*R-p*A,u}function ks(u,i,l){l*=.5;var p=i[0],g=i[1],b=i[2],x=i[3],A=Math.sin(l),R=Math.cos(l);return u[0]=p*R-b*A,u[1]=g*R+x*A,u[2]=b*R+p*A,u[3]=x*R-g*A,u}Ee(),Li();var fs,Uo,Kr,ir,Po,ro=ss,jo=(fs=Ee(),Uo=zt(1,0,0),Kr=zt(0,1,0),function(u,i,l){var p=Ht(i,l);return p<-.999999?(Mn(fs,Uo,i),_r(fs)<1e-6&&Mn(fs,Kr,i),dn(fs,fs),function(g,b,x){x*=.5;var A=Math.sin(x);g[0]=A*b[0],g[1]=A*b[1],g[2]=A*b[2],g[3]=Math.cos(x)}(u,fs,Math.PI),u):p>.999999?(u[0]=0,u[1]=0,u[2]=0,u[3]=1,u):(Mn(fs,i,l),u[0]=fs[0],u[1]=fs[1],u[2]=fs[2],u[3]=1+p,ro(u,u))});function Or(){var u=new D(2);return D!=Float32Array&&(u[0]=0,u[1]=0),u}function ps(u,i){var l=new D(2);return l[0]=u,l[1]=i,l}function Ns(u,i,l){return u[0]=i[0]+l[0],u[1]=i[1]+l[1],u}function Hr(u,i,l){return u[0]=i[0]-l[0],u[1]=i[1]-l[1],u}function Xs(u,i,l){return u[0]=i[0]*l,u[1]=i[1]*l,u}function ho(u){return Math.hypot(u[0],u[1])}function Ge(u,i){var l=i[0],p=i[1],g=l*l+p*p;return g>0&&(g=1/Math.sqrt(g)),u[0]=i[0]*g,u[1]=i[1]*g,u}function xt(u,i){return u[0]*i[0]+u[1]*i[1]}function Pn(u){return u&&u.__esModule&&Object.prototype.hasOwnProperty.call(u,"default")?u.default:u}ti(),ti(),z(),Or();var jn,Wn,zi=function(){if(Po)return ir;function u(i,l,p,g){this.cx=3*i,this.bx=3*(p-i)-this.cx,this.ax=1-this.cx-this.bx,this.cy=3*l,this.by=3*(g-l)-this.cy,this.ay=1-this.cy-this.by,this.p1x=i,this.p1y=l,this.p2x=p,this.p2y=g}return Po=1,ir=u,u.prototype={sampleCurveX:function(i){return((this.ax*i+this.bx)*i+this.cx)*i},sampleCurveY:function(i){return((this.ay*i+this.by)*i+this.cy)*i},sampleCurveDerivativeX:function(i){return(3*this.ax*i+2*this.bx)*i+this.cx},solveCurveX:function(i,l){if(l===void 0&&(l=1e-6),i<0)return 0;if(i>1)return 1;for(var p=i,g=0;g<8;g++){var b=this.sampleCurveX(p)-i;if(Math.abs(b)<l)return p;var x=this.sampleCurveDerivativeX(p);if(Math.abs(x)<1e-6)break;p-=b/x}var A=0,R=1;for(p=i,g=0;g<20&&(b=this.sampleCurveX(p),!(Math.abs(b-i)<l));g++)i>b?A=p:R=p,p=.5*(R-A)+A;return p},solve:function(i,l){return this.sampleCurveY(this.solveCurveX(i,l))}},ir}(),Ri=Pn(zi);function Ii(){if(Wn)return jn;function u(i,l){this.x=i,this.y=l}return Wn=1,jn=u,u.prototype={clone:function(){return new u(this.x,this.y)},add:function(i){return this.clone()._add(i)},sub:function(i){return this.clone()._sub(i)},multByPoint:function(i){return this.clone()._multByPoint(i)},divByPoint:function(i){return this.clone()._divByPoint(i)},mult:function(i){return this.clone()._mult(i)},div:function(i){return this.clone()._div(i)},rotate:function(i){return this.clone()._rotate(i)},rotateAround:function(i,l){return this.clone()._rotateAround(i,l)},matMult:function(i){return this.clone()._matMult(i)},unit:function(){return this.clone()._unit()},perp:function(){return this.clone()._perp()},round:function(){return this.clone()._round()},mag:function(){return Math.sqrt(this.x*this.x+this.y*this.y)},equals:function(i){return this.x===i.x&&this.y===i.y},dist:function(i){return Math.sqrt(this.distSqr(i))},distSqr:function(i){var l=i.x-this.x,p=i.y-this.y;return l*l+p*p},angle:function(){return Math.atan2(this.y,this.x)},angleTo:function(i){return Math.atan2(this.y-i.y,this.x-i.x)},angleWith:function(i){return this.angleWithSep(i.x,i.y)},angleWithSep:function(i,l){return Math.atan2(this.x*l-this.y*i,this.x*i+this.y*l)},_matMult:function(i){var l=i[2]*this.x+i[3]*this.y;return this.x=i[0]*this.x+i[1]*this.y,this.y=l,this},_add:function(i){return this.x+=i.x,this.y+=i.y,this},_sub:function(i){return this.x-=i.x,this.y-=i.y,this},_mult:function(i){return this.x*=i,this.y*=i,this},_div:function(i){return this.x/=i,this.y/=i,this},_multByPoint:function(i){return this.x*=i.x,this.y*=i.y,this},_divByPoint:function(i){return this.x/=i.x,this.y/=i.y,this},_unit:function(){return this._div(this.mag()),this},_perp:function(){var i=this.y;return this.y=this.x,this.x=-i,this},_rotate:function(i){var l=Math.cos(i),p=Math.sin(i),g=p*this.x+l*this.y;return this.x=l*this.x-p*this.y,this.y=g,this},_rotateAround:function(i,l){var p=Math.cos(i),g=Math.sin(i),b=l.y+g*(this.x-l.x)+p*(this.y-l.y);return this.x=l.x+p*(this.x-l.x)-g*(this.y-l.y),this.y=b,this},_round:function(){return this.x=Math.round(this.x),this.y=Math.round(this.y),this}},u.convert=function(i){return i instanceof u?i:Array.isArray(i)?new u(i[0],i[1]):i},jn}var Lt=Pn(Ii());function $r(u,i){if(Array.isArray(u)){if(!Array.isArray(i)||u.length!==i.length)return!1;for(let l=0;l<u.length;l++)if(!$r(u[l],i[l]))return!1;return!0}if(typeof u=="object"&&u!==null&&i!==null){if(typeof i!="object"||Object.keys(u).length!==Object.keys(i).length)return!1;for(const l in u)if(!$r(u[l],i[l]))return!1;return!0}return u===i}const _i=Math.PI/180,Ls=180/Math.PI;function bi(u){return u*_i}function gt(u){return u*Ls}const fe=[[0,0],[1,0],[1,1],[0,1]];function ve(u){if(u<=0)return 0;if(u>=1)return 1;const i=u*u,l=i*u;return 4*(u<.5?l:3*(u-i)+l-.75)}function Be(u,i,l,p){const g=new Ri(u,i,l,p);return function(b){return g.solve(b)}}const tt=Be(.25,.1,.25,1);function He(u,i,l){return Math.min(l,Math.max(i,u))}function at(u,i,l){return(l=He((l-u)/(i-u),0,1))*l*(3-2*l)}function bt(u,i,l){const p=l-i,g=((u-i)%p+p)%p+i;return g===i?l:g}function Ze(u,i,l){if(!u.length)return l(null,[]);let p=u.length;const g=new Array(u.length);let b=null;u.forEach((x,A)=>{i(x,(R,O)=>{R&&(b=R),g[A]=O,--p==0&&l(b,g)})})}function vt(u,...i){for(const l of i)for(const p in l)u[p]=l[p];return u}let It=1;function Et(){return It++}function Kt(u){return u<=1?1:Math.pow(2,Math.ceil(Math.log(u)/Math.LN2))}function _n(u,i){u.forEach(l=>{i[l]&&(i[l]=i[l].bind(i))})}function Sn(u,i,l){const p={};for(const g in u)p[g]=i.call(this,u[g],g,u);return p}function Gn(u,i,l){const p={};for(const g in u)i.call(this,u[g],g,u)&&(p[g]=u[g]);return p}function Vn(u){return Array.isArray(u)?u.map(Vn):typeof u=="object"&&u?Sn(u,Vn):u}function Jn(u,i){for(let l=0;l<u.length;l++)if(i.indexOf(u[l])>=0)return!0;return!1}const oi={};function ii(u){oi[u]||(typeof console<"u"&&console.warn(u),oi[u]=!0)}function Xi(u,i,l){return(l.y-u.y)*(i.x-u.x)>(i.y-u.y)*(l.x-u.x)}function tr(u){let i=0;for(let l,p,g=0,b=u.length,x=b-1;g<b;x=g++)l=u[g],p=u[x],i+=(p.x-l.x)*(l.y+p.y);return i}function cr([u,i,l]){const p=bi(i+90),g=bi(l);return{x:u*Math.cos(p)*Math.sin(g),y:u*Math.sin(p)*Math.sin(g),z:u*Math.cos(g),azimuthal:i,polar:l}}function Ai(u){return(typeof self<"u"||u!==void 0)&&typeof WorkerGlobalScope<"u"&&(u!==void 0?u:self)instanceof WorkerGlobalScope}function Ei(u){const i={};if(u.replace(/(?:^|(?:\s*\,\s*))([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)(?:\=(?:([^\x00-\x20\(\)<>@\,;\:\\"\/\[\]\?\=\{\}\x7F]+)|(?:\"((?:[^"\\]|\\.)*)\")))?/g,(l,p,g,b)=>{const x=g||b;return i[p]=!x||x.toLowerCase(),""}),i["max-age"]){const l=parseInt(i["max-age"],10);isNaN(l)?delete i["max-age"]:i["max-age"]=l}return i}let fr=null;function xr(u,i){return[u[4*i],u[4*i+1],u[4*i+2],u[4*i+3]]}function Ir(u,i,l,p){for(;i<l;){const g=i+l>>1;u[g]<p?i=g+1:l=g}return i}function qs(u,i,l,p){for(;i<l;){const g=i+l>>1;u[g]<=p?i=g+1:l=g}return i}function os(u){return u>0?1/(1.001-u):1+u}function zs(u){return u>0?1-1/(1.001-u):-u}function Ua(u,i,l){return(u-i.min)*(l.max-l.min)/(i.max-i.min)+l.min}const Ws={API_URL:"https://api.mapbox.com",get API_URL_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/|\?|$)/i},get API_TILEJSON_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/v[0-9]*\/.*\.json.*$)/i},get API_SPRITE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*\/sprite.*\..*$)/i},get API_FONTS_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/fonts\/v[0-9]*\/)(.*\.pbf.*$)/i},get API_STYLE_REGEX(){return/^((https?:)?\/\/)?([^\/]+\.)?mapbox\.c(n|om)(\/styles\/v[0-9]*\/)(.*$)/i},get API_CDN_URL_REGEX(){return/^((https?:)?\/\/)?api\.mapbox\.c(n|om)(\/mapbox-gl-js\/)(.*$)/i},get EVENTS_URL(){if(!Ws.API_URL)return null;try{const u=new URL(Ws.API_URL);return u.hostname==="api.mapbox.cn"?"https://events.mapbox.cn/events/v2":u.hostname==="api.mapbox.com"?"https://events.mapbox.com/events/v2":null}catch{return null}},SESSION_PATH:"/map-sessions/v1",FEEDBACK_URL:"https://apps.mapbox.com/feedback",TILE_URL_VERSION:"v4",RASTER_URL_PREFIX:"raster/v1",RASTERARRAYS_URL_PREFIX:"rasterarrays/v1",REQUIRE_ACCESS_TOKEN:!0,ACCESS_TOKEN:null,DEFAULT_STYLE:"mapbox://styles/mapbox/standard",MAX_PARALLEL_IMAGE_REQUESTS:16,DRACO_URL:"https://api.mapbox.com/mapbox-gl-js/draco_decoder_gltf_v1.5.6.wasm",MESHOPT_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_base_v0.20.wasm",MESHOPT_SIMD_URL:"https://api.mapbox.com/mapbox-gl-js/meshopt_simd_v0.20.wasm",BUILDING_GEN_URL:"https://api.mapbox.com/mapbox-gl-js/building-gen/building_gen_v0.3.0.wasm",GLYPHS_URL:"mapbox://fonts/mapbox/{fontstack}/{range}.pbf",TILES3D_URL_PREFIX:"3dtiles/v1"};function ja(u){return Ws.API_URL_REGEX.test(u)}function wu(u){return Ws.API_SPRITE_REGEX.test(u)}let Zu,Hc,Jl,Xu,Qu,Dl;function Ha(){return Zu==null&&(Zu=self.OffscreenCanvas&&new OffscreenCanvas(1,1).getContext("2d")&&typeof self.createImageBitmap=="function"),Zu}const Ho={now:()=>Xu!==void 0?Xu:performance.now(),setNow(u){Xu=u},restoreNow(){Xu=void 0},frame(u){const i=requestAnimationFrame(u);return{cancel:()=>cancelAnimationFrame(i)}},getImageData(u,i=0){const{width:l,height:p}=u;Qu||(Qu=document.createElement("canvas"));const g=Qu.getContext("2d",{willReadFrequently:!0});if(!g)throw new Error("failed to create canvas 2d context");return(l>Qu.width||p>Qu.height)&&(Qu.width=l,Qu.height=p),g.clearRect(-i,-i,l+2*i,p+2*i),g.drawImage(u,0,0,l,p),g.getImageData(-i,-i,l+2*i,p+2*i)},resolveURL:u=>(Hc||(Hc=document.createElement("a")),Hc.href=u,Hc.href),get devicePixelRatio(){return window.devicePixelRatio},get prefersReducedMotion(){return!!window.matchMedia&&(Jl==null&&(Jl=window.matchMedia("(prefers-reduced-motion: reduce)")),Jl.matches)},hasCanvasFingerprintNoise(){if(Dl!==void 0)return Dl;if(!Ha())return Dl=!1,!1;const u=new OffscreenCanvas(85,1),i=u.getContext("2d",{willReadFrequently:!0});let l=0;for(let g=0;g<u.width;++g)i.fillStyle=`rgba(${l++},${l++},${l++}, 255)`,i.fillRect(g,0,1,1);const p=i.getImageData(0,0,u.width,u.height);l=0;for(let g=0;g<p.data.length;++g)if(g%4!=3&&l++!==p.data[g])return Dl=!0,!0;return Dl=!1,!1}};function To(u,i){const l=u.indexOf("?");if(l<0)return`${u}?${new URLSearchParams(i).toString()}`;const p=new URLSearchParams(u.slice(l));for(const g in i)p.set(g,i[g]);return`${u.slice(0,l)}?${p.toString()}`}function ya(u,i={persistentParams:[]}){const l=u.indexOf("?");if(l<0)return u;const p=new URLSearchParams,g=new URLSearchParams(u.slice(l));for(const x of i.persistentParams){const A=g.get(x);A&&p.set(x,A)}const b=p.toString();return`${u.slice(0,l)}${b.length>0?`?${b}`:""}`}const Mr="mapbox-tiles";let na=500,$a=50;const ec=["language","worldview","jobid"];let ll,$c;function Rl(){try{return caches}catch{}}function Xh(){const u=Rl();u&&ll==null&&(ll=u.open(Mr))}let bp=1/0;const xp={supported:!1,testSupport:function(u){!Qh&&ia&&(Ku?Ju(u):Bs=u)}};let Bs,ia,Qh=!1,Ku=!1;const Qm=typeof self<"u"?self:{};function Ju(u){const i=u.createTexture();u.bindTexture(u.TEXTURE_2D,i);try{if(u.texImage2D(u.TEXTURE_2D,0,u.RGBA,u.RGBA,u.UNSIGNED_BYTE,ia),u.isContextLost())return;xp.supported=!0}catch{}u.deleteTexture(i),Qh=!0}Qm.document&&(ia=Qm.document.createElement("img"),ia.onload=function(){Bs&&Ju(Bs),Bs=null,Ku=!0},ia.onerror=function(){Qh=!0,Bs=null},ia.src="data:image/webp;base64,UklGRh4AAABXRUJQVlA4TBEAAAAvAQAAAAfQ//73v/+BiOh/AAA=");const Gc={Unknown:"Unknown",Style:"Style",Source:"Source",Tile:"Tile",Glyphs:"Glyphs",SpriteImage:"SpriteImage",SpriteJSON:"SpriteJSON",Iconset:"Iconset",Image:"Image",Model:"Model"};typeof Object.freeze=="function"&&Object.freeze(Gc);class Si extends Error{constructor(i,l,p){l===401&&ja(p)&&(i+=": you may have provided an invalid Mapbox access token. See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes"),super(i),this.status=l,this.url=p}toString(){return`${this.name}: ${this.message} (${this.status}): ${this.url}`}}const uf=Ai()?()=>self.worker.referrer:()=>(location.protocol==="blob:"?parent:self).location.href,va=function(u,i){if(!(/^file:/.test(l=u.url)||/^file:/.test(uf())&&!/^\w+:/.test(l))){if(self.fetch&&self.Request&&self.AbortController&&Request.prototype.hasOwnProperty("signal"))return function(p,g){const b=new AbortController,x=new Request(p.url,{method:p.method||"GET",body:p.body,credentials:p.credentials,headers:p.headers,referrer:uf(),referrerPolicy:p.referrerPolicy,signal:b.signal});let A=!1,R=!1;const O=(L=x.url).indexOf("sku=")>0&&ja(L);var L;p.type==="json"&&x.headers.set("Accept","application/json");const B=(q,Y,ne)=>{if(R)return;if(q&&q.message!=="SecurityError"&&ii(q.toString()),Y&&ne)return U(Y);const ae=Date.now();fetch(x).then(he=>{if(he.ok){const Se=O?he.clone():null;return U(he,Se,ae)}return g(new Si(he.statusText,he.status,p.url))}).catch(he=>{he.name!=="AbortError"&&g(new Error(`${he.message} ${p.url}`))})},U=(q,Y,ne)=>{(p.type==="arrayBuffer"?q.arrayBuffer():p.type==="json"?q.json():q.text()).then(ae=>{R||(Y&&ne&&function(he,Se,Ae){if(Xh(),ll==null)return;const re=Ei(Se.headers.get("Cache-Control")||"");if(re["no-store"])return;const ye={status:Se.status,statusText:Se.statusText,headers:new Headers};Se.headers.forEach((nt,Qe)=>ye.headers.set(Qe,nt)),re["max-age"]&&ye.headers.set("Expires",new Date(Ae+1e3*re["max-age"]).toUTCString());const Oe=ye.headers.get("Expires");if(!Oe||new Date(Oe).getTime()-Ae<42e4)return;let Le=ya(he.url,{persistentParams:ec});if(Se.status===206){const nt=he.headers.get("Range");if(!nt)return;ye.status=200,Le=To(Le,{range:nt})}(function(nt,Qe){if($c===void 0)try{new Response(new ReadableStream),$c=!0}catch{$c=!1}$c?Qe(nt.body):nt.blob().then(Qe).catch(st=>ii(st.message))})(Se,nt=>{const Qe=new Response((st=Se.status)!==200&&st!==404&&[101,103,204,205,304].includes(st)?null:nt,ye);var st;Xh(),ll!=null&&ll.then(dt=>dt.put(Le,Qe)).catch(dt=>ii(dt.message))})}(x,Y,ne),A=!0,g(null,ae,q.headers.get("Cache-Control"),q.headers.get("Expires")))}).catch(ae=>{R||g(new Error(ae.message))})};return O?function(q,Y){if(Xh(),ll==null)return Y(null);ll.then(ne=>{let ae=ya(q.url,{persistentParams:ec});const he=q.headers.get("Range");he&&(ae=To(ae,{range:he})),ne.match(ae).then(Se=>{const Ae=function(re){if(!re)return!1;const ye=new Date(re.headers.get("Expires")||0),Oe=Ei(re.headers.get("Cache-Control")||"");return Number(ye)>Date.now()&&!Oe["no-cache"]}(Se);ne.delete(ae).catch(Y),Ae&&ne.put(ae,Se.clone()).catch(Y),Y(null,Se,Ae)}).catch(Y)}).catch(Y)}(x,B):B(null,null),{cancel:()=>{R=!0,A||b.abort()}}}(u,i);if(Ai(self)&&self.worker.actor)return self.worker.actor.send("getResource",u,i,void 0,!0)}var l;return function(p,g){const b=new XMLHttpRequest;b.open(p.method||"GET",p.url,!0),p.type==="arrayBuffer"&&(b.responseType="arraybuffer");for(const x in p.headers)b.setRequestHeader(x,p.headers[x]);return p.type==="json"&&(b.responseType="text",b.setRequestHeader("Accept","application/json")),b.withCredentials=p.credentials==="include",b.onerror=()=>{g(new Error(b.statusText))},b.onload=()=>{if((b.status>=200&&b.status<300||b.status===0)&&b.response!==null){let x=b.response;if(p.type==="json")try{x=JSON.parse(b.response)}catch(A){return g(A)}g(null,x,b.getResponseHeader("Cache-Control"),b.getResponseHeader("Expires"))}else g(new Si(b.statusText,b.status,p.url))},b.send(p.body),{cancel:()=>b.abort()}}(u,i)},qc=function(u,i){return va(vt(u,{type:"arrayBuffer"}),i)};function B_(u){const i=document.createElement("a");return i.href=u,i.protocol===location.protocol&&i.host===location.host}const Ol="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAAEAAAABCAYAAAAfFcSJAAAAC0lEQVQYV2NgAAIAAAUAAarVyFEAAAAASUVORK5CYII=";let Ga,tc;Ga=[],tc=0;const so=function(u,i){if(xp.supported&&(u.headers||(u.headers={}),u.headers.accept="image/webp,*/*"),tc>=Ws.MAX_PARALLEL_IMAGE_REQUESTS){const b={requestParameters:u,callback:i,cancelled:!1,cancel(){this.cancelled=!0}};return Ga.push(b),b}tc++;let l=!1;const p=()=>{if(!l)for(l=!0,tc--;Ga.length&&tc<Ws.MAX_PARALLEL_IMAGE_REQUESTS;){const b=Ga.shift(),{requestParameters:x,callback:A,cancelled:R}=b;R||(b.cancel=so(x,A).cancel)}},g=qc(u,(b,x,A,R)=>{p(),b?i(b):x&&(self.createImageBitmap?function(O,L){const B=new Blob([new Uint8Array(O)],{type:"image/png"});createImageBitmap(B).then(U=>{L(null,U)}).catch(U=>{L(new Error(`Could not load image because of ${U.message}. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported.`))})}(x,(O,L)=>i(O,L,A,R)):function(O,L){const B=new Image;B.onload=()=>{L(null,B),URL.revokeObjectURL(B.src),B.onload=null,requestAnimationFrame(()=>{B.src=Ol})},B.onerror=()=>L(new Error("Could not load image. Please make sure to use a supported image type such as PNG or JPEG. Note that SVGs are not supported."));const U=new Blob([new Uint8Array(O)],{type:"image/png"});B.src=O.byteLength?URL.createObjectURL(U):Ol}(x,(O,L)=>i(O,L,A,R)))});return{cancel:()=>{g.cancel(),p()}}};var eh,nc,hf,Gr={exports:{}},wp={exports:{}},Tp={exports:{}},qa=function(){if(hf)return Gr.exports;hf=1;var u=(eh||(eh=1,wp.exports=function(l,p){var g,b,x,A,R,O,L,B;for(b=l.length-(g=3&l.length),x=p,R=3432918353,O=461845907,B=0;B<b;)L=255&l.charCodeAt(B)|(255&l.charCodeAt(++B))<<8|(255&l.charCodeAt(++B))<<16|(255&l.charCodeAt(++B))<<24,++B,x=27492+(65535&(A=5*(65535&(x=(x^=L=(65535&(L=(L=(65535&L)*R+(((L>>>16)*R&65535)<<16)&4294967295)<<15|L>>>17))*O+(((L>>>16)*O&65535)<<16)&4294967295)<<13|x>>>19))+((5*(x>>>16)&65535)<<16)&4294967295))+((58964+(A>>>16)&65535)<<16);switch(L=0,g){case 3:L^=(255&l.charCodeAt(B+2))<<16;case 2:L^=(255&l.charCodeAt(B+1))<<8;case 1:x^=L=(65535&(L=(L=(65535&(L^=255&l.charCodeAt(B)))*R+(((L>>>16)*R&65535)<<16)&4294967295)<<15|L>>>17))*O+(((L>>>16)*O&65535)<<16)&4294967295}return x^=l.length,x=2246822507*(65535&(x^=x>>>16))+((2246822507*(x>>>16)&65535)<<16)&4294967295,x=3266489909*(65535&(x^=x>>>13))+((3266489909*(x>>>16)&65535)<<16)&4294967295,(x^=x>>>16)>>>0}),wp.exports),i=(nc||(nc=1,Tp.exports=function(l,p){for(var g,b=l.length,x=p^b,A=0;b>=4;)g=1540483477*(65535&(g=255&l.charCodeAt(A)|(255&l.charCodeAt(++A))<<8|(255&l.charCodeAt(++A))<<16|(255&l.charCodeAt(++A))<<24))+((1540483477*(g>>>16)&65535)<<16),x=1540483477*(65535&x)+((1540483477*(x>>>16)&65535)<<16)^(g=1540483477*(65535&(g^=g>>>24))+((1540483477*(g>>>16)&65535)<<16)),b-=4,++A;switch(b){case 3:x^=(255&l.charCodeAt(A+2))<<16;case 2:x^=(255&l.charCodeAt(A+1))<<8;case 1:x=1540483477*(65535&(x^=255&l.charCodeAt(A)))+((1540483477*(x>>>16)&65535)<<16)}return x=1540483477*(65535&(x^=x>>>13))+((1540483477*(x>>>16)&65535)<<16),(x^=x>>>15)>>>0}),Tp.exports);return Gr.exports=u,Gr.exports.murmur3=u,Gr.exports.murmur2=i,Gr.exports}(),Kh=Pn(qa);class Wc{constructor(i,...l){vt(this,l[0]||{}),this.type=i}}class th extends Wc{constructor(i,l={}){super("error",vt({error:i},l))}}function nh(u,i,l){l[u]&&l[u].indexOf(i)!==-1||(l[u]=l[u]||[],l[u].push(i))}function Wa(u,i,l){if(l&&l[u]){const p=l[u].indexOf(i);p!==-1&&l[u].splice(p,1)}}class Yc{on(i,l){return this._listeners=this._listeners||{},nh(i,l,this._listeners),this}off(i,l){return Wa(i,l,this._listeners),Wa(i,l,this._oneTimeListeners),this}once(i,l){return l?(this._oneTimeListeners=this._oneTimeListeners||{},nh(i,l,this._oneTimeListeners),this):new Promise(p=>{this.once(i,p)})}fire(i,l){const p=typeof i=="string"?new Wc(i,l):i,g=p.type;if(this.listens(g)){p.target=this;const b=this._listeners&&this._listeners[g]?this._listeners[g].slice():[];for(const R of b)R.call(this,p);const x=this._oneTimeListeners&&this._oneTimeListeners[g]?this._oneTimeListeners[g].slice():[];for(const R of x)Wa(g,R,this._oneTimeListeners),R.call(this,p);const A=this._eventedParent;A&&(vt(p,typeof this._eventedParentData=="function"?this._eventedParentData():this._eventedParentData),A.fire(p))}else p instanceof th&&console.error(p.error);return this}listens(i){return!!(this._listeners&&this._listeners[i]&&this._listeners[i].length>0||this._oneTimeListeners&&this._oneTimeListeners[i]&&this._oneTimeListeners[i].length>0||this._eventedParent&&this._eventedParent.listens(i))}setEventedParent(i,l){return this._eventedParent=i,this._eventedParentData=l,this}}class ra{constructor(i){typeof i=="string"?this.name=i:(this.name=i.name,this.iconsetId=i.iconsetId)}static from(i){return new ra(i)}static toString(i){return i.iconsetId?`${i.name}${i.iconsetId}`:i.name}static parse(i){const[l,p]=i.split("");return new ra({name:l,iconsetId:p})}static isEqual(i,l){return i.name===l.name&&i.iconsetId===l.iconsetId}toString(){return ra.toString(this)}serialize(){return{name:this.name,iconsetId:this.iconsetId}}}var ih,rh={},Zc=function(){if(ih)return rh;ih=1;var u={transparent:[0,0,0,0],aliceblue:[240,248,255,1],antiquewhite:[250,235,215,1],aqua:[0,255,255,1],aquamarine:[127,255,212,1],azure:[240,255,255,1],beige:[245,245,220,1],bisque:[255,228,196,1],black:[0,0,0,1],blanchedalmond:[255,235,205,1],blue:[0,0,255,1],blueviolet:[138,43,226,1],brown:[165,42,42,1],burlywood:[222,184,135,1],cadetblue:[95,158,160,1],chartreuse:[127,255,0,1],chocolate:[210,105,30,1],coral:[255,127,80,1],cornflowerblue:[100,149,237,1],cornsilk:[255,248,220,1],crimson:[220,20,60,1],cyan:[0,255,255,1],darkblue:[0,0,139,1],darkcyan:[0,139,139,1],darkgoldenrod:[184,134,11,1],darkgray:[169,169,169,1],darkgreen:[0,100,0,1],darkgrey:[169,169,169,1],darkkhaki:[189,183,107,1],darkmagenta:[139,0,139,1],darkolivegreen:[85,107,47,1],darkorange:[255,140,0,1],darkorchid:[153,50,204,1],darkred:[139,0,0,1],darksalmon:[233,150,122,1],darkseagreen:[143,188,143,1],darkslateblue:[72,61,139,1],darkslategray:[47,79,79,1],darkslategrey:[47,79,79,1],darkturquoise:[0,206,209,1],darkviolet:[148,0,211,1],deeppink:[255,20,147,1],deepskyblue:[0,191,255,1],dimgray:[105,105,105,1],dimgrey:[105,105,105,1],dodgerblue:[30,144,255,1],firebrick:[178,34,34,1],floralwhite:[255,250,240,1],forestgreen:[34,139,34,1],fuchsia:[255,0,255,1],gainsboro:[220,220,220,1],ghostwhite:[248,248,255,1],gold:[255,215,0,1],goldenrod:[218,165,32,1],gray:[128,128,128,1],green:[0,128,0,1],greenyellow:[173,255,47,1],grey:[128,128,128,1],honeydew:[240,255,240,1],hotpink:[255,105,180,1],indianred:[205,92,92,1],indigo:[75,0,130,1],ivory:[255,255,240,1],khaki:[240,230,140,1],lavender:[230,230,250,1],lavenderblush:[255,240,245,1],lawngreen:[124,252,0,1],lemonchiffon:[255,250,205,1],lightblue:[173,216,230,1],lightcoral:[240,128,128,1],lightcyan:[224,255,255,1],lightgoldenrodyellow:[250,250,210,1],lightgray:[211,211,211,1],lightgreen:[144,238,144,1],lightgrey:[211,211,211,1],lightpink:[255,182,193,1],lightsalmon:[255,160,122,1],lightseagreen:[32,178,170,1],lightskyblue:[135,206,250,1],lightslategray:[119,136,153,1],lightslategrey:[119,136,153,1],lightsteelblue:[176,196,222,1],lightyellow:[255,255,224,1],lime:[0,255,0,1],limegreen:[50,205,50,1],linen:[250,240,230,1],magenta:[255,0,255,1],maroon:[128,0,0,1],mediumaquamarine:[102,205,170,1],mediumblue:[0,0,205,1],mediumorchid:[186,85,211,1],mediumpurple:[147,112,219,1],mediumseagreen:[60,179,113,1],mediumslateblue:[123,104,238,1],mediumspringgreen:[0,250,154,1],mediumturquoise:[72,209,204,1],mediumvioletred:[199,21,133,1],midnightblue:[25,25,112,1],mintcream:[245,255,250,1],mistyrose:[255,228,225,1],moccasin:[255,228,181,1],navajowhite:[255,222,173,1],navy:[0,0,128,1],oldlace:[253,245,230,1],olive:[128,128,0,1],olivedrab:[107,142,35,1],orange:[255,165,0,1],orangered:[255,69,0,1],orchid:[218,112,214,1],palegoldenrod:[238,232,170,1],palegreen:[152,251,152,1],paleturquoise:[175,238,238,1],palevioletred:[219,112,147,1],papayawhip:[255,239,213,1],peachpuff:[255,218,185,1],peru:[205,133,63,1],pink:[255,192,203,1],plum:[221,160,221,1],powderblue:[176,224,230,1],purple:[128,0,128,1],rebeccapurple:[102,51,153,1],red:[255,0,0,1],rosybrown:[188,143,143,1],royalblue:[65,105,225,1],saddlebrown:[139,69,19,1],salmon:[250,128,114,1],sandybrown:[244,164,96,1],seagreen:[46,139,87,1],seashell:[255,245,238,1],sienna:[160,82,45,1],silver:[192,192,192,1],skyblue:[135,206,235,1],slateblue:[106,90,205,1],slategray:[112,128,144,1],slategrey:[112,128,144,1],snow:[255,250,250,1],springgreen:[0,255,127,1],steelblue:[70,130,180,1],tan:[210,180,140,1],teal:[0,128,128,1],thistle:[216,191,216,1],tomato:[255,99,71,1],turquoise:[64,224,208,1],violet:[238,130,238,1],wheat:[245,222,179,1],white:[255,255,255,1],whitesmoke:[245,245,245,1],yellow:[255,255,0,1],yellowgreen:[154,205,50,1]};function i(b){return(b=Math.round(b))<0?0:b>255?255:b}function l(b){return i(b[b.length-1]==="%"?parseFloat(b)/100*255:parseInt(b))}function p(b){return(x=b[b.length-1]==="%"?parseFloat(b)/100:parseFloat(b))<0?0:x>1?1:x;var x}function g(b,x,A){return A<0?A+=1:A>1&&(A-=1),6*A<1?b+(x-b)*A*6:2*A<1?x:3*A<2?b+(x-b)*(2/3-A)*6:b}try{rh.parseCSSColor=function(b){var x,A=b.replace(/ /g,"").toLowerCase();if(A in u)return u[A].slice();if(A[0]==="#")return A.length===4?(x=parseInt(A.substr(1),16))>=0&&x<=4095?[(3840&x)>>4|(3840&x)>>8,240&x|(240&x)>>4,15&x|(15&x)<<4,1]:null:A.length===7&&(x=parseInt(A.substr(1),16))>=0&&x<=16777215?[(16711680&x)>>16,(65280&x)>>8,255&x,1]:null;var R=A.indexOf("("),O=A.indexOf(")");if(R!==-1&&O+1===A.length){var L=A.substr(0,R),B=A.substr(R+1,O-(R+1)).split(","),U=1;switch(L){case"rgba":if(B.length!==4)return null;U=p(B.pop());case"rgb":return B.length!==3?null:[l(B[0]),l(B[1]),l(B[2]),U];case"hsla":if(B.length!==4)return null;U=p(B.pop());case"hsl":if(B.length!==3)return null;var q=(parseFloat(B[0])%360+360)%360/360,Y=p(B[1]),ne=p(B[2]),ae=ne<=.5?ne*(Y+1):ne+Y-ne*Y,he=2*ne-ae;return[i(255*g(he,ae,q+1/3)),i(255*g(he,ae,q)),i(255*g(he,ae,q-1/3)),U];default:return null}}return null}}catch{}return rh}();class Mi{constructor(i,l,p,g=1){this.r=i,this.g=l,this.b=p,this.a=g}static parse(i){if(!i)return;if(i instanceof Mi)return i;if(typeof i!="string")return;const l=Zc.parseCSSColor(i);return l?new Mi(l[0]/255,l[1]/255,l[2]/255,l[3]):void 0}toString(){const[i,l,p,g]=[this.r,this.g,this.b,this.a];return`rgba(${Math.round(255*i)},${Math.round(255*l)},${Math.round(255*p)},${g})`}toNonPremultipliedRenderColor(i){const{r:l,g:p,b:g,a:b}=this;return new Tu(i,l,p,g,b)}toPremultipliedRenderColor(i){const{r:l,g:p,b:g,a:b}=this;return new Ep(i,l*b,p*b,g*b,b)}clone(){return new Mi(this.r,this.g,this.b,this.a)}}class cl{constructor(i,l,p,g,b,x=!1){if(this.premultiplied=!1,this.premultiplied=x,i){const A=i.image.height,R=A*A;this.premultiplied?(l=b===0?0:l/b*(A-1),p=b===0?0:p/b*(A-1),g=b===0?0:g/b*(A-1)):(l*=A-1,p*=A-1,g*=A-1);const O=Math.floor(l),L=Math.floor(p),B=Math.floor(g),U=Math.ceil(l),q=Math.ceil(p),Y=Math.ceil(g),ne=l-O,ae=p-L,he=g-B,Se=i.image.data,Ae=4*(O+L*R+B*A),re=4*(O+L*R+Y*A),ye=4*(O+q*R+B*A),Oe=4*(O+q*R+Y*A),Le=4*(U+L*R+B*A),nt=4*(U+L*R+Y*A),Qe=4*(U+q*R+B*A),st=4*(U+q*R+Y*A);if(Ae<0||st>=Se.length)throw new Error("out of range");this.r=$n($n($n(Se[Ae],Se[re],he),$n(Se[ye],Se[Oe],he),ae),$n($n(Se[Le],Se[nt],he),$n(Se[Qe],Se[st],he),ae),ne)/255*(this.premultiplied?b:1),this.g=$n($n($n(Se[Ae+1],Se[re+1],he),$n(Se[ye+1],Se[Oe+1],he),ae),$n($n(Se[Le+1],Se[nt+1],he),$n(Se[Qe+1],Se[st+1],he),ae),ne)/255*(this.premultiplied?b:1),this.b=$n($n($n(Se[Ae+2],Se[re+2],he),$n(Se[ye+2],Se[Oe+2],he),ae),$n($n(Se[Le+2],Se[nt+2],he),$n(Se[Qe+2],Se[st+2],he),ae),ne)/255*(this.premultiplied?b:1),this.a=b}else this.r=l,this.g=p,this.b=g,this.a=b}toArray(){const{r:i,g:l,b:p,a:g}=this;return[255*i,255*l,255*p,g]}toHslaArray(){let{r:i,g:l,b:p,a:g}=this;if(this.premultiplied){if(g===0)return[0,0,0,0];i/=g,l/=g,p/=g}const b=Math.min(Math.max(i,0),1),x=Math.min(Math.max(l,0),1),A=Math.min(Math.max(p,0),1),R=Math.min(b,x,A),O=Math.max(b,x,A),L=(R+O)/2;if(R===O)return[0,0,100*L,g];const B=O-R,U=L>.5?B/(2-O-R):B/(O+R);let q=0;return O===b?q=(x-A)/B+(x<A?6:0):O===x?q=(A-b)/B+2:O===A&&(q=(b-x)/B+4),q*=60,[Math.min(Math.max(q,0),360),Math.min(Math.max(100*U,0),100),Math.min(Math.max(100*L,0),100),g]}toArray01(){const{r:i,g:l,b:p,a:g}=this;return[i,l,p,g]}toArray01Scaled(i){const{r:l,g:p,b:g}=this;return[l*i,p*i,g*i]}toArray01Linear(){const{r:i,g:l,b:p,a:g}=this;return[Math.pow(i,2.2),Math.pow(l,2.2),Math.pow(p,2.2),g]}}class Tu extends cl{constructor(i,l,p,g,b){super(i,l,p,g,b,!1)}}class Ep extends cl{constructor(i,l,p,g,b){super(i,l,p,g,b,!0)}}function $n(u,i,l){return u*(1-l)+i*l}function Xc(u,i,l){return u.map((p,g)=>$n(p,i[g],l))}Mi.black=new Mi(0,0,0,1),Mi.white=new Mi(1,1,1,1),Mi.transparent=new Mi(0,0,0,0),Mi.red=new Mi(1,0,0,1),Mi.blue=new Mi(0,0,1,1);var sh=Object.freeze({__proto__:null,array:Xc,color:function(u,i,l){return new Mi($n(u.r,i.r,l),$n(u.g,i.g,l),$n(u.b,i.b,l),$n(u.a,i.a,l))},number:$n});function ic(u,...i){for(const l of i)for(const p in l)u[p]=l[p];return u}class $o extends Error{constructor(i,l){super(l),this.message=l,this.key=i}}class Il{constructor(i,l=[]){this.parent=i,this.bindings={};for(const[p,g]of l)this.bindings[p]=g}concat(i){return new Il(this,i)}get(i){if(this.bindings[i])return this.bindings[i];if(this.parent)return this.parent.get(i);throw new Error(`${i} not found in scope.`)}has(i){return!!this.bindings[i]||!!this.parent&&this.parent.has(i)}}const Ya={kind:"null"},xn={kind:"number"},gi={kind:"string"},Di={kind:"boolean"},Fs={kind:"color"},ul={kind:"object"},fi={kind:"value"},Jh={kind:"collator"},Qc={kind:"formatted"},ba={kind:"resolvedImage"};function Wr(u,i){return{kind:"array",itemType:u,N:i}}function ys(u){if(u.kind==="array"){const i=ys(u.itemType);return typeof u.N=="number"?`array<${i}, ${u.N}>`:u.itemType.kind==="value"?"array":`array<${i}>`}return u.kind}const Km=[Ya,xn,gi,Di,Fs,Qc,ul,Wr(fi),ba];function Za(u,i){if(i.kind==="error")return null;if(u.kind==="array"){if(i.kind==="array"&&(i.N===0&&i.itemType.kind==="value"||!Za(u.itemType,i.itemType))&&(typeof u.N!="number"||u.N===i.N))return null}else{if(u.kind===i.kind)return null;if(u.kind==="value"){for(const l of Km)if(!Za(l,i))return null}}return`Expected ${ys(u)} but found ${ys(i)} instead.`}function V(u,i){return i.some(l=>l.kind===u.kind)}function le(u,i){return i.some(l=>l==="null"?u===null:l==="array"?Array.isArray(u):l==="object"?u&&!Array.isArray(u)&&typeof u=="object":l===typeof u)}function xe(u,i){return u.kind==="array"&&i.kind==="array"?u.N===i.N&&xe(u.itemType,i.itemType):u.kind===i.kind}class Ke{constructor(i,l,p){this.sensitivity=i?l?"variant":"case":l?"accent":"base",this.locale=p,this.collator=new Intl.Collator(this.locale?this.locale:[],{sensitivity:this.sensitivity,usage:"search"})}compare(i,l){return this.collator.compare(i,l)}resolvedLocale(){return new Intl.Collator(this.locale?this.locale:[]).resolvedOptions().locale}}class Vt{constructor(i,l,p,g,b){this.text=i.normalize?i.normalize():i,this.image=l,this.scale=p,this.fontStack=g,this.textColor=b}}class $t{constructor(i){this.sections=i}static fromString(i){return new $t([new Vt(i,null,null,null,null)])}isEmpty(){return this.sections.length===0||!this.sections.some(i=>i.text.length!==0||!!i.image&&i.image.hasPrimary())}static factory(i){return i instanceof $t?i:$t.fromString(i)}toString(){return this.sections.length===0?"":this.sections.map(i=>i.text).join("")}serialize(){const i=["format"];for(const l of this.sections){if(l.image){const g=l.image.getPrimary().id.toString();i.push(["image",g]);continue}i.push(l.text);const p={};l.fontStack&&(p["text-font"]=["literal",l.fontStack.split(",")]),l.scale&&(p["font-scale"]=l.scale),l.textColor&&(p["text-color"]=["rgba"].concat(l.textColor.toNonPremultipliedRenderColor(null).toArray())),i.push(p)}return i}}class Ln{constructor(i,l={}){if(this.id=ra.from(i),this.options=Object.assign({},l),l.transform){const{a:p,b:g,c:b,d:x,e:A,f:R}=l.transform;this.options.transform=new DOMMatrix([p,g,b,x,A,R])}else this.options.transform=new DOMMatrix([1,0,0,1,0,0])}toString(){const{a:i,b:l,c:p,d:g,e:b,f:x}=this.options.transform;return JSON.stringify({name:this.id.name,iconsetId:this.id.iconsetId,params:this.options.params,transform:{a:i,b:l,c:p,d:g,e:b,f:x}})}static parse(i){let l,p,g,b;try{({name:l,iconsetId:p,params:g,transform:b}=JSON.parse(i)||{})}catch{return null}if(!l)return null;const{a:x,b:A,c:R,d:O,e:L,f:B}=b||{};return new Ln({name:l,iconsetId:p},{params:g,transform:new DOMMatrix([x,A,R,O,L,B])})}scaleSelf(i,l){return this.options.transform.scaleSelf(i,l),this}}class Hi{constructor(i,l,p,g,b=!1){this.primaryId=ra.from(i),this.primaryOptions=l,p&&(this.secondaryId=ra.from(p)),this.secondaryOptions=g,this.available=b}toString(){return this.primaryId&&this.secondaryId?`[${this.primaryId.name},${this.secondaryId.name}]`:this.primaryId.name}hasPrimary(){return!!this.primaryId}getPrimary(){return new Ln(this.primaryId,this.primaryOptions)}hasSecondary(){return!!this.secondaryId}getSecondary(){return this.secondaryId?new Ln(this.secondaryId,this.secondaryOptions):null}static from(i){return typeof i=="string"?Hi.build({name:i}):i}static build(i,l,p,g){return!i||typeof i=="object"&&!("name"in i)?null:new Hi(i,p,l,g)}}function Ss(u,i,l,p){return typeof u=="number"&&u>=0&&u<=255&&typeof i=="number"&&i>=0&&i<=255&&typeof l=="number"&&l>=0&&l<=255?p===void 0||typeof p=="number"&&p>=0&&p<=1?null:`Invalid rgba value [${[u,i,l,p].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid rgba value [${(typeof p=="number"?[u,i,l,p]:[u,i,l]).join(", ")}]: 'r', 'g', and 'b' must be between 0 and 255.`}function kn(u){if(u===null||typeof u=="string"||typeof u=="boolean"||typeof u=="number"||u instanceof Mi||u instanceof Ke||u instanceof $t||u instanceof Hi)return!0;if(Array.isArray(u)){for(const i of u)if(!kn(i))return!1;return!0}if(typeof u=="object"){for(const i in u)if(!kn(u[i]))return!1;return!0}return!1}function an(u){if(u===null)return Ya;if(typeof u=="string")return gi;if(typeof u=="boolean")return Di;if(typeof u=="number")return xn;if(u instanceof Mi)return Fs;if(u instanceof Ke)return Jh;if(u instanceof $t)return Qc;if(u instanceof Hi)return ba;if(Array.isArray(u)){const i=u.length;let l;for(const p of u){const g=an(p);if(l){if(l===g)continue;l=fi;break}l=g}return Wr(l||fi,i)}return ul}function Jr(u){const i=typeof u;return u===null?"":i==="string"||i==="number"||i==="boolean"?String(u):u instanceof $t||u instanceof Hi||u instanceof Mi?u.toString():JSON.stringify(u)}class Hn{constructor(i,l){this.type=i,this.value=l}static parse(i,l){if(i.length!==2)return l.error(`'literal' expression requires exactly one argument, but found ${i.length-1} instead.`);if(!kn(i[1]))return l.error("invalid value");const p=i[1];let g=an(p);const b=l.expectedType;return g.kind!=="array"||g.N!==0||!b||b.kind!=="array"||typeof b.N=="number"&&b.N!==0||(g=b),new Hn(g,p)}evaluate(){return this.value}eachChild(){}outputDefined(){return!0}serialize(){return this.type.kind==="array"||this.type.kind==="object"?["literal",this.value]:this.value instanceof Mi?["rgba"].concat(this.value.toNonPremultipliedRenderColor(null).toArray()):this.value instanceof $t?this.value.serialize():this.value}}class Ki{constructor(i){this.name="ExpressionEvaluationError",this.message=i}toJSON(){return this.message}}const xa={string:gi,number:xn,boolean:Di,object:ul};class Un{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");let p,g=1;const b=i[0];if(b==="array"){let A,R;if(i.length>2){const O=i[1];if(typeof O!="string"||!(O in xa)||O==="object")return l.error('The item type argument of "array" must be one of string, number, boolean',1);A=xa[O],g++}else A=fi;if(i.length>3){if(i[2]!==null&&(typeof i[2]!="number"||i[2]<0||i[2]!==Math.floor(i[2])))return l.error('The length argument to "array" must be a positive integer literal',2);R=i[2],g++}p=Wr(A,R)}else p=xa[b];const x=[];for(;g<i.length;g++){const A=l.parse(i[g],g,fi);if(!A)return null;x.push(A)}return new Un(p,x)}evaluate(i){for(let l=0;l<this.args.length;l++){const p=this.args[l].evaluate(i);if(!Za(this.type,an(p)))return p;if(l===this.args.length-1)throw new Ki(`The expression ${JSON.stringify(this.args[l].serialize())} evaluated to ${ys(an(p))} but was expected to be of type ${ys(this.type)}.`)}return null}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=this.type,l=[i.kind];if(i.kind==="array"){const p=i.itemType;if(p.kind==="string"||p.kind==="number"||p.kind==="boolean"){l.push(p.kind);const g=i.N;(typeof g=="number"||this.args.length>1)&&l.push(g)}}return l.concat(this.args.map(p=>p.serialize()))}}class rc{constructor(i){this.type=Qc,this.sections=i}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[1];if(!Array.isArray(p)&&typeof p=="object")return l.error("First argument must be an image or text section.");const g=[];let b=!1;for(let x=1;x<=i.length-1;++x){const A=i[x];if(b&&typeof A=="object"&&!Array.isArray(A)){b=!1;let R=null;if(A["font-scale"]&&(R=l.parseObjectValue(A["font-scale"],x,"font-scale",xn),!R))return null;let O=null;if(A["text-font"]&&(O=l.parseObjectValue(A["text-font"],x,"text-font",Wr(gi)),!O))return null;let L=null;if(A["text-color"]&&(L=l.parseObjectValue(A["text-color"],x,"text-color",Fs),!L))return null;const B=g[g.length-1];B.scale=R,B.font=O,B.textColor=L}else{const R=l.parse(i[x],x,fi);if(!R)return null;const O=R.type.kind;if(O!=="string"&&O!=="value"&&O!=="null"&&O!=="resolvedImage")return l.error("Formatted text type must be 'string', 'value', 'image' or 'null'.");b=!0,g.push({content:R,scale:null,font:null,textColor:null})}}return new rc(g)}evaluate(i){return new $t(this.sections.map(l=>{const p=l.content.evaluate(i);return xe(an(p),ba)?new Vt("",p,null,null,null):new Vt(Jr(p),null,l.scale?l.scale.evaluate(i):null,l.font?l.font.evaluate(i).join(","):null,l.textColor?l.textColor.evaluate(i):null)}))}eachChild(i){for(const l of this.sections)i(l.content),l.scale&&i(l.scale),l.font&&i(l.font),l.textColor&&i(l.textColor)}outputDefined(){return!1}serialize(){const i=["format"];for(const l of this.sections){i.push(l.content.serialize());const p={};l.scale&&(p["font-scale"]=l.scale.serialize()),l.font&&(p["text-font"]=l.font.serialize()),l.textColor&&(p["text-color"]=l.textColor.serialize()),i.push(p)}return i}}class df{constructor(i,l,p,g){this._imageWarnHistory={},this.type=ba,this.namePrimary=i,this.nameSecondary=l,p&&(this.paramsPrimary=p.params,this.iconsetIdPrimary=p.iconset?p.iconset.id:void 0),g&&(this.paramsSecondary=g.params,this.iconsetIdSecondary=g.iconset?g.iconset.id:void 0)}static parse(i,l){if(i.length<2)return l.error("Expected two or more arguments.");let p=1;const g=[];function b(){if(p<i.length){const A=l.parse(i[p],p++,gi);return A?(g.push({image:A,options:{}}),!0):(l.error(g.length?"Secondary image variant is not a string.":"No image name provided."),!1)}return!0}function x(){if(p<i.length){const R=i[p];if((A=R)===null||typeof A!="object"||Array.isArray(A))return!0;const O=R.params,L=R.iconset,B=l.concat(p);if(!O&&!L)return p++,!0;if(O){if(typeof O!="object"||O.constructor!==Object)return B.error('Image options "params" should be an object'),!1;const U={},q=B.concat(void 0,"params");for(const Y in O){if(!Y)return q.error("Image parameter name should be non-empty"),!1;const ne=q.concat(void 0,Y).parse(O[Y],void 0,Fs,void 0,{typeAnnotation:"coerce"});if(!ne)return!1;U[Y]=ne}g[g.length-1].options.params=U}if(L){if(typeof L!="object"||L.constructor!==Object)return B.error('Image options "iconset" should be an object'),!1;if(!L.id)return B.error('Image options "iconset" should have an "id" property'),!1;g[g.length-1].options.iconset=L}return p++,!0}var A;return!0}for(let A=0;A<2;A++)if(!b()||!x())return;return new df(g[0].image,g[1]?g[1].image:void 0,g[0].options,g[1]?g[1].options:void 0)}evaluateParams(i,l){const p={};if(l){for(const g in l)if(l[g])try{p[g]=l[g].evaluate(i)}catch{continue}if(Object.keys(p).length!==0)return{params:p}}}evaluate(i){const l={name:this.namePrimary.evaluate(i),iconsetId:this.iconsetIdPrimary},p=this.nameSecondary?{name:this.nameSecondary.evaluate(i),iconsetId:this.iconsetIdSecondary}:void 0,g=Hi.build(l,p,this.paramsPrimary?this.evaluateParams(i,this.paramsPrimary):void 0,this.paramsSecondary?this.evaluateParams(i,this.paramsSecondary):void 0);if(g&&i.availableImages){const b=g.getPrimary().id;if(g.available=i.availableImages.some(x=>ra.isEqual(x,b)),g.available){const x=g.getSecondary()?g.getSecondary().id:null;x&&(g.available=i.availableImages.some(A=>ra.isEqual(A,x)))}}return g}eachChild(i){if(i(this.namePrimary),this.paramsPrimary)for(const l in this.paramsPrimary)this.paramsPrimary[l]&&i(this.paramsPrimary[l]);if(this.nameSecondary&&(i(this.nameSecondary),this.paramsSecondary))for(const l in this.paramsSecondary)this.paramsSecondary[l]&&i(this.paramsSecondary[l])}outputDefined(){return!1}serializeOptions(i,l){const p={};if(l&&(p.iconset={id:l}),i){p.params={};for(const g in i)i[g]&&(p.params[g]=i[g].serialize())}return Object.keys(p).length>0?p:void 0}serialize(){const i=["image",this.namePrimary.serialize()];if(this.paramsPrimary||this.iconsetIdPrimary){const l=this.serializeOptions(this.paramsPrimary,this.iconsetIdPrimary);l&&i.push(l)}if(this.nameSecondary&&(i.push(this.nameSecondary.serialize()),this.paramsSecondary||this.iconsetIdSecondary)){const l=this.serializeOptions(this.paramsSecondary,this.iconsetIdSecondary);l&&i.push(l)}return i}}function oh(u){return u instanceof Number?"number":u instanceof String?"string":u instanceof Boolean?"boolean":Array.isArray(u)?"array":u===null?"null":typeof u}const Sp={"to-boolean":Di,"to-color":Fs,"to-number":xn,"to-string":gi};class wa{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expected at least one argument.");const p=i[0],g=[];let b=Ya;if(p==="to-array"){if(!Array.isArray(i[1]))return null;const x=i[1].length;if(l.expectedType){if(l.expectedType.kind!=="array")return l.error(`Expected ${l.expectedType.kind} but found array.`);b=Wr(l.expectedType.itemType,x)}else{if(!(x>0&&kn(i[1][0])))return null;b=Wr(an(i[1][0]),x)}for(let A=0;A<x;A++){const R=i[1][A];let O;if(oh(R)==="array")O=l.parse(R,void 0,b.itemType);else{const L=oh(R);if(L!==b.itemType.kind)return l.error(`Expected ${b.itemType.kind} but found ${L}.`);O=l.registry.literal.parse(["literal",R===void 0?null:R],l)}if(!O)return null;g.push(O)}}else{if((p==="to-boolean"||p==="to-string")&&i.length!==2)return l.error("Expected one argument.");b=Sp[p];for(let x=1;x<i.length;x++){const A=l.parse(i[x],x,fi);if(!A)return null;g.push(A)}}return new wa(b,g)}evaluate(i){if(this.type.kind==="boolean")return!!this.args[0].evaluate(i);if(this.type.kind==="color"){let l,p;for(const g of this.args){if(l=g.evaluate(i),p=null,l instanceof Mi)return l;if(typeof l=="string"){const b=i.parseColor(l);if(b)return b}else if(Array.isArray(l)&&(p=l.length<3||l.length>4?`Invalid rbga value ${JSON.stringify(l)}: expected an array containing either three or four numeric values.`:Ss(l[0],l[1],l[2],l[3]),!p))return new Mi(l[0]/255,l[1]/255,l[2]/255,l[3])}throw new Ki(p||`Could not parse color from value '${typeof l=="string"?l:String(JSON.stringify(l))}'`)}if(this.type.kind==="number"){let l=null;for(const p of this.args){if(l=p.evaluate(i),l===null)return 0;const g=Number(l);if(!isNaN(g))return g}throw new Ki(`Could not convert ${JSON.stringify(l)} to number.`)}return this.type.kind==="formatted"?$t.fromString(Jr(this.args[0].evaluate(i))):this.type.kind==="resolvedImage"?Hi.build(Jr(this.args[0].evaluate(i))):this.type.kind==="array"?this.args.map(l=>l.evaluate(i)):Jr(this.args[0].evaluate(i))}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){if(this.type.kind==="formatted")return new rc([{content:this.args[0],scale:null,font:null,textColor:null}]).serialize();if(this.type.kind==="resolvedImage")return new df(this.args[0]).serialize();const i=this.type.kind==="array"?[]:[`to-${this.type.kind}`];return this.eachChild(l=>{i.push(l.serialize())}),i}}const sa=["Unknown","Point","LineString","Polygon"];class ah{constructor(i,l){this.globals=null,this.feature=null,this.featureState=null,this.formattedSection=null,this._parseColorCache={},this.availableImages=null,this.canonical=null,this.featureTileCoord=null,this.featureDistanceData=null,this.scope=i,this.options=l}id(){return this.feature&&this.feature.id!==void 0?this.feature.id:null}geometryType(){return this.feature?typeof this.feature.type=="number"?sa[this.feature.type]:this.feature.type:null}geometry(){return this.feature&&"geometry"in this.feature?this.feature.geometry:null}canonicalID(){return this.canonical}properties(){return this.feature&&this.feature.properties||{}}measureLight(i){return this.globals.brightness||0}distanceFromCenter(){if(this.featureTileCoord&&this.featureDistanceData){const i=this.featureDistanceData.center,l=this.featureDistanceData.scale,{x:p,y:g}=this.featureTileCoord;return this.featureDistanceData.bearing[0]*(p*l-i[0])+this.featureDistanceData.bearing[1]*(g*l-i[1])}return 0}parseColor(i){let l=this._parseColorCache[i];return l||(l=this._parseColorCache[i]=Mi.parse(i)),l}getConfig(i){return this.options?this.options.get(i):null}}class fo{constructor(i,l,p,g,b){this.name=i,this.type=l,this._evaluate=p,this.args=g,this._overloadIndex=b}evaluate(i){if(!this._evaluate){const l=fo.definitions[this.name];this._evaluate=Array.isArray(l)?l[2]:l.overloads[this._overloadIndex][1]}return this._evaluate(i,this.args)}eachChild(i){this.args.forEach(i)}outputDefined(){return!1}serialize(){return[this.name].concat(this.args.map(i=>i.serialize()))}static parse(i,l){const p=i[0],g=fo.definitions[p];if(!g)return l.error(`Unknown expression "${p}". If you wanted a literal array, use ["literal", [...]].`,0);const b=Array.isArray(g)?g[0]:g.type,x=Array.isArray(g)?[[g[1],g[2]]]:g.overloads,A=[];let R=null,O=-1;for(const[L,B]of x){if(Array.isArray(L)&&L.length!==i.length-1)continue;A.push(L),O++,R=new _f(l.registry,l.path,null,l.scope,void 0,l._scope,l.options);const U=[];let q=!1;for(let Y=1;Y<i.length;Y++){const ne=i[Y],ae=Array.isArray(L)?L[Y-1]:L.type,he=R.parse(ne,1+U.length,ae);if(!he){q=!0;break}U.push(he)}if(!q)if(Array.isArray(L)&&L.length!==U.length)R.error(`Expected ${L.length} arguments, but found ${U.length} instead.`);else{for(let Y=0;Y<U.length;Y++){const ne=Array.isArray(L)?L[Y]:L.type,ae=U[Y];R.concat(Y+1).checkSubtype(ne,ae.type)}if(R.errors.length===0)return new fo(p,b,B,U,O)}}if(A.length===1)l.errors.push(...R.errors);else{const L=(A.length?A:x.map(([U])=>U)).map(Ap).join(" | "),B=[];for(let U=1;U<i.length;U++){const q=l.parse(i[U],1+B.length);if(!q)return null;B.push(ys(q.type))}l.error(`Expected arguments of type ${L}, but found (${B.join(", ")}) instead.`)}return null}static register(i,l){fo.definitions=l;for(const p in l)i[p]=fo}}function Ap(u){return Array.isArray(u)?`(${u.map(ys).join(", ")})`:`(${ys(u.type)}...)`}class oa{constructor(i,l,p){this.type=Jh,this.locale=p,this.caseSensitive=i,this.diacriticSensitive=l}static parse(i,l){if(i.length!==2)return l.error("Expected one argument.");const p=i[1];if(typeof p!="object"||Array.isArray(p))return l.error("Collator options argument must be an object.");const g=p["case-sensitive"]===void 0?l.parse(!1,1,Di):l.parseObjectValue(p["case-sensitive"],1,"case-sensitive",Di);if(!g)return null;const b=p["diacritic-sensitive"]===void 0?l.parse(!1,1,Di):l.parseObjectValue(p["diacritic-sensitive"],1,"diacritic-sensitive",Di);if(!b)return null;let x=null;return p.locale&&(x=l.parseObjectValue(p.locale,1,"locale",gi),!x)?null:new oa(g,b,x)}evaluate(i){return new Ke(this.caseSensitive.evaluate(i),this.diacriticSensitive.evaluate(i),this.locale?this.locale.evaluate(i):null)}eachChild(i){i(this.caseSensitive),i(this.diacriticSensitive),this.locale&&i(this.locale)}outputDefined(){return!1}serialize(){const i={};return i["case-sensitive"]=this.caseSensitive.serialize(),i["diacritic-sensitive"]=this.diacriticSensitive.serialize(),this.locale&&(i.locale=this.locale.serialize()),["collator",i]}}function Vs(u,i,l=0,p=u.length-1,g=f0){for(;p>l;){if(p-l>600){const R=p-l+1,O=i-l+1,L=Math.log(R),B=.5*Math.exp(2*L/3),U=.5*Math.sqrt(L*B*(R-B)/R)*(O-R/2<0?-1:1);Vs(u,i,Math.max(l,Math.floor(i-O*B/R+U)),Math.min(p,Math.floor(i+(R-O)*B/R+U)),g)}const b=u[i];let x=l,A=p;for(ff(u,l,i),g(u[p],b)>0&&ff(u,l,p);x<A;){for(ff(u,x,A),x++,A--;g(u[x],b)<0;)x++;for(;g(u[A],b)>0;)A--}g(u[l],b)===0?ff(u,l,A):(A++,ff(u,A,p)),A<=i&&(l=A+1),i<=A&&(p=A-1)}}function ff(u,i,l){const p=u[i];u[i]=u[l],u[l]=p}function f0(u,i){return u<i?-1:u>i?1:0}function Jm(u){let i=0;for(let l,p,g=0,b=u.length,x=b-1;g<b;x=g++)l=u[g],p=u[x],i+=(p.x-l.x)*(l.y+p.y);return i}function Kc(u,i){u[0]=Math.min(u[0],i[0]),u[1]=Math.min(u[1],i[1]),u[2]=Math.max(u[2],i[0]),u[3]=Math.max(u[3],i[1])}function sc(u,i){return!(u[0]<=i[0]||u[2]>=i[2]||u[1]<=i[1]||u[3]>=i[3])}function as(u,i,l){const p=u[0]-i[0],g=u[1]-i[1],b=u[0]-l[0],x=u[1]-l[1];return p*x-b*g==0&&p*b<=0&&g*x<=0}function lh(u,i,l=!1){let p=!1;for(let A=0,R=i.length;A<R;A++){const O=i[A];for(let L=0,B=O.length,U=B-1;L<B;U=L++){const q=O[U],Y=O[L];if(as(u,q,Y))return l;(b=q)[1]>(g=u)[1]!=(x=Y)[1]>g[1]&&g[0]<(x[0]-b[0])*(g[1]-b[1])/(x[1]-b[1])+b[0]&&(p=!p)}}var g,b,x;return p}function p0(u,i,l,p){const g=p[0]-l[0],b=p[1]-l[1],x=(u[0]-l[0])*b-g*(u[1]-l[1]),A=(i[0]-l[0])*b-g*(i[1]-l[1]);return x>0&&A<0||x<0&&A>0}function Cp(u,i,l,p){return(g=[p[0]-l[0],p[1]-l[1]])[0]*(b=[i[0]-u[0],i[1]-u[1]])[1]-g[1]*b[0]!=0&&!(!p0(u,i,l,p)||!p0(l,p,u,i));var g,b}function ch(u){const i=new Lt(Number.POSITIVE_INFINITY,Number.POSITIVE_INFINITY),l=new Lt(Number.NEGATIVE_INFINITY,Number.NEGATIVE_INFINITY);for(const p of u[0])i.x>p.x&&(i.x=p.x),i.y>p.y&&(i.y=p.y),l.x<p.x&&(l.x=p.x),l.y<p.y&&(l.y=p.y);return{min:i,max:l}}const Ml=8192;function uh(u,i){const l=(180+u[0])/360,p=(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u[1]*Math.PI/360)))/360,g=Math.pow(2,i.z);return[Math.round(l*g*Ml),Math.round(p*g*Ml)]}function F_(u,i){for(let l=0;l<i.length;l++)if(lh(u,i[l]))return!0;return!1}function Dp(u,i,l){for(const p of l)for(let g=0,b=p.length,x=b-1;g<b;x=g++)if(Cp(u,i,p[x],p[g]))return!0;return!1}function V_(u,i){for(let l=0;l<u.length;++l)if(!lh(u[l],i))return!1;for(let l=0;l<u.length-1;++l)if(Dp(u[l],u[l+1],i))return!1;return!0}function hh(u,i){for(let l=0;l<i.length;l++)if(V_(u,i[l]))return!0;return!1}function U_(u,i,l){const p=[];for(let g=0;g<u.length;g++){const b=[];for(let x=0;x<u[g].length;x++){const A=uh(u[g][x],l);Kc(i,A),b.push(A)}p.push(b)}return p}function Jc(u,i,l){const p=[];for(let g=0;g<u.length;g++){const b=U_(u[g],i,l);p.push(b)}return p}function Pl(u,i,l,p){if(u[0]<l[0]||u[0]>l[2]){const g=.5*p;let b=u[0]-l[0]>g?-p:l[0]-u[0]>g?p:0;b===0&&(b=u[0]-l[2]>g?-p:l[2]-u[0]>g?p:0),u[0]+=b}Kc(i,u)}function Rp(u,i,l,p){const g=Math.pow(2,p.z)*Ml,b=[p.x*Ml,p.y*Ml],x=[];if(!u)return x;for(const A of u)for(const R of A){const O=[R.x+b[0],R.y+b[1]];Pl(O,i,l,g),x.push(O)}return x}function m0(u,i,l,p){const g=Math.pow(2,p.z)*Ml,b=[p.x*Ml,p.y*Ml],x=[];if(!u)return x;for(const R of u){const O=[];for(const L of R){const B=[L.x+b[0],L.y+b[1]];Kc(i,B),O.push(B)}x.push(O)}if(i[2]-i[0]<=g/2){(A=i)[0]=A[1]=1/0,A[2]=A[3]=-1/0;for(const R of x)for(const O of R)Pl(O,i,l,g)}var A;return x}class Go{constructor(i,l){this.type=Di,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'within' expression requires exactly one argument, but found ${i.length-1} instead.`);if(kn(i[1])){const p=i[1];if(p.type==="FeatureCollection")for(let g=0;g<p.features.length;++g){const b=p.features[g].geometry.type;if(b==="Polygon"||b==="MultiPolygon")return new Go(p,p.features[g].geometry)}else if(p.type==="Feature"){const g=p.geometry.type;if(g==="Polygon"||g==="MultiPolygon")return new Go(p,p.geometry)}else if(p.type==="Polygon"||p.type==="MultiPolygon")return new Go(p,p)}return l.error("'within' expression requires valid geojson object that contains polygon geometry type.")}evaluate(i){if(i.geometry()!=null&&i.canonicalID()!=null){if(i.geometryType()==="Point")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const A=U_(p.coordinates,b,x),R=Rp(l.geometry(),g,b,x);if(!sc(g,b))return!1;for(const O of R)if(!lh(O,A))return!1}if(p.type==="MultiPolygon"){const A=Jc(p.coordinates,b,x),R=Rp(l.geometry(),g,b,x);if(!sc(g,b))return!1;for(const O of R)if(!F_(O,A))return!1}return!0}(i,this.geometries);if(i.geometryType()==="LineString")return function(l,p){const g=[1/0,1/0,-1/0,-1/0],b=[1/0,1/0,-1/0,-1/0],x=l.canonicalID();if(!x)return!1;if(p.type==="Polygon"){const A=U_(p.coordinates,b,x),R=m0(l.geometry(),g,b,x);if(!sc(g,b))return!1;for(const O of R)if(!V_(O,A))return!1}if(p.type==="MultiPolygon"){const A=Jc(p.coordinates,b,x),R=m0(l.geometry(),g,b,x);if(!sc(g,b))return!1;for(const O of R)if(!hh(O,A))return!1}return!0}(i,this.geometries)}return!1}eachChild(){}outputDefined(){return!0}serialize(){return["within",this.geojson]}}const eg={kilometers:1,miles:1e3/1609.344,nauticalmiles:1e3/1852,meters:1e3,metres:1e3,yards:1e3/.9144,feet:1e3/.3048,inches:1e3/.0254},tg=1/298.257223563,Op=tg*(2-tg),pf=Math.PI/180;class mf{static fromTile(i,l,p){const g=Math.PI*(1-2*(i+.5)/Math.pow(2,l)),b=Math.atan(.5*(Math.exp(g)-Math.exp(-g)))/pf;return new mf(b,p)}static get units(){return eg}constructor(i,l){if(i===void 0)throw new Error("No latitude given.");if(l&&!eg[l])throw new Error(`Unknown unit ${l}. Use one of: ${Object.keys(eg).join(", ")}`);const p=6378.137*pf*(l?eg[l]:1),g=Math.cos(i*pf),b=1/(1-Op*(1-g*g)),x=Math.sqrt(b);this.kx=p*x*g,this.ky=p*x*b*(1-Op)}distance(i,l){const p=hl(i[0]-l[0])*this.kx,g=(i[1]-l[1])*this.ky;return Math.sqrt(p*p+g*g)}bearing(i,l){const p=hl(l[0]-i[0])*this.kx;return Math.atan2(p,(l[1]-i[1])*this.ky)/pf}destination(i,l,p){const g=p*pf;return this.offset(i,Math.sin(g)*l,Math.cos(g)*l)}offset(i,l,p){return[i[0]+l/this.kx,i[1]+p/this.ky]}lineDistance(i){let l=0;for(let p=0;p<i.length-1;p++)l+=this.distance(i[p],i[p+1]);return l}area(i){let l=0;for(let p=0;p<i.length;p++){const g=i[p];for(let b=0,x=g.length,A=x-1;b<x;A=b++)l+=hl(g[b][0]-g[A][0])*(g[b][1]+g[A][1])*(p?-1:1)}return Math.abs(l)/2*this.kx*this.ky}along(i,l){let p=0;if(l<=0)return i[0];for(let g=0;g<i.length-1;g++){const b=i[g],x=i[g+1],A=this.distance(b,x);if(p+=A,p>l)return gf(b,x,(l-(p-A))/A)}return i[i.length-1]}pointToSegmentDistance(i,l,p){let[g,b]=l,x=hl(p[0]-g)*this.kx,A=(p[1]-b)*this.ky;if(x!==0||A!==0){const R=(hl(i[0]-g)*this.kx*x+(i[1]-b)*this.ky*A)/(x*x+A*A);R>1?(g=p[0],b=p[1]):R>0&&(g+=x/this.kx*R,b+=A/this.ky*R)}return x=hl(i[0]-g)*this.kx,A=(i[1]-b)*this.ky,Math.sqrt(x*x+A*A)}pointOnLine(i,l){let p=1/0,g=i[0][0],b=i[0][1],x=0,A=0;for(let R=0;R<i.length-1;R++){let O=i[R][0],L=i[R][1],B=hl(i[R+1][0]-O)*this.kx,U=(i[R+1][1]-L)*this.ky,q=0;B===0&&U===0||(q=(hl(l[0]-O)*this.kx*B+(l[1]-L)*this.ky*U)/(B*B+U*U),q>1?(O=i[R+1][0],L=i[R+1][1]):q>0&&(O+=B/this.kx*q,L+=U/this.ky*q)),B=hl(l[0]-O)*this.kx,U=(l[1]-L)*this.ky;const Y=B*B+U*U;Y<p&&(p=Y,g=O,b=L,x=R,A=q)}return{point:[g,b],index:x,t:Math.max(0,Math.min(1,A))}}lineSlice(i,l,p){let g=this.pointOnLine(p,i),b=this.pointOnLine(p,l);if(g.index>b.index||g.index===b.index&&g.t>b.t){const O=g;g=b,b=O}const x=[g.point],A=g.index+1,R=b.index;!j_(p[A],x[0])&&A<=R&&x.push(p[A]);for(let O=A+1;O<=R;O++)x.push(p[O]);return j_(p[R],b.point)||x.push(b.point),x}lineSliceAlong(i,l,p){let g=0;const b=[];for(let x=0;x<p.length-1;x++){const A=p[x],R=p[x+1],O=this.distance(A,R);if(g+=O,g>i&&b.length===0&&b.push(gf(A,R,(i-(g-O))/O)),g>=l)return b.push(gf(A,R,(l-(g-O))/O)),b;g>i&&b.push(R)}return b}bufferPoint(i,l){const p=l/this.ky,g=l/this.kx;return[i[0]-g,i[1]-p,i[0]+g,i[1]+p]}bufferBBox(i,l){const p=l/this.ky,g=l/this.kx;return[i[0]-g,i[1]-p,i[2]+g,i[3]+p]}insideBBox(i,l){return hl(i[0]-l[0])>=0&&hl(i[0]-l[2])<=0&&i[1]>=l[1]&&i[1]<=l[3]}}function j_(u,i){return u[0]===i[0]&&u[1]===i[1]}function gf(u,i,l){const p=hl(i[0]-u[0]);return[u[0]+p*l,u[1]+(i[1]-u[1])*l]}function hl(u){for(;u<-180;)u+=360;for(;u>180;)u-=360;return u}class ng{constructor(i=[],l=(p,g)=>p<g?-1:p>g?1:0){if(this.data=i,this.length=this.data.length,this.compare=l,this.length>0)for(let p=(this.length>>1)-1;p>=0;p--)this._down(p)}push(i){this.data.push(i),this._up(this.length++)}pop(){if(this.length===0)return;const i=this.data[0],l=this.data.pop();return--this.length>0&&(this.data[0]=l,this._down(0)),i}peek(){return this.data[0]}_up(i){const{data:l,compare:p}=this,g=l[i];for(;i>0;){const b=i-1>>1,x=l[b];if(p(g,x)>=0)break;l[i]=x,i=b}l[i]=g}_down(i){const{data:l,compare:p}=this,g=this.length>>1,b=l[i];for(;i<g;){let x=1+(i<<1);const A=x+1;if(A<this.length&&p(l[A],l[x])<0&&(x=A),p(l[x],b)>=0)break;l[i]=l[x],i=x}l[i]=b}}var sn=8192;function ig(u,i){return i.dist-u.dist}const ed=100,kl=50;function oc(u){const i=[1/0,1/0,-1/0,-1/0];if(i.length!==u.length)return!1;for(let l=0;l<i.length;l++)if(i[l]!==u[l])return!1;return!0}function dh(u){return u[1]-u[0]+1}function Nl(u,i){const l=u[1]>=u[0]&&u[1]<i;return l||console.warn("Distance Expression: Index is out of range"),l}function td(u,i){if(u[0]>u[1])return[null,null];const l=dh(u);if(i){if(l===2)return[u,null];const p=Math.floor(l/2);return[[u[0],u[0]+p],[u[0]+p,u[1]]]}{if(l===1)return[u,null];const p=Math.floor(l/2)-1;return[[u[0],u[0]+p],[u[0]+p+1,u[1]]]}}function Ta(u,i){const l=[1/0,1/0,-1/0,-1/0];if(!Nl(i,u.length))return l;for(let p=i[0];p<=i[1];++p)Kc(l,u[p]);return l}function yi(u){const i=[1/0,1/0,-1/0,-1/0];for(let l=0;l<u.length;++l)for(let p=0;p<u[l].length;++p)Kc(i,u[l][p]);return i}function Ip(u,i,l){if(oc(u)||oc(i))return NaN;let p=0,g=0;return u[2]<i[0]&&(p=i[0]-u[2]),u[0]>i[2]&&(p=u[0]-i[2]),u[1]>i[3]&&(g=u[1]-i[3]),u[3]<i[1]&&(g=i[1]-u[3]),l.distance([0,0],[p,g])}function Bx(u){return 360*u-180}function Fx(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function Mp(u,i){const l=Math.pow(2,i.z),p=(u.y/sn+i.y)/l;return[Bx((u.x/sn+i.x)/l),Fx(p)]}function g0(u,i){const l=[];for(let p=0;p<u.length;++p)l.push(Mp(u[p],i));return l}function ri(u,i,l){const p=l.pointOnLine(i,u).point;return l.distance(u,p)}function zn(u,i,l,p,g){const b=l.slice(p[0],p[1]+1);let x=1/0;for(let A=i[0];A<=i[1];++A)if((x=Math.min(x,ri(u[A],b,g)))===0)return 0;return x}function nd(u,i,l,p,g){const b=Math.min(g.pointToSegmentDistance(u,l,p),g.pointToSegmentDistance(i,l,p)),x=Math.min(g.pointToSegmentDistance(l,u,i),g.pointToSegmentDistance(p,u,i));return Math.min(b,x)}function H_(u,i,l,p,g){if(!Nl(i,u.length)||!Nl(p,l.length))return NaN;let b=1/0;for(let x=i[0];x<i[1];++x)for(let A=p[0];A<p[1];++A){if(Cp(u[x],u[x+1],l[A],l[A+1]))return 0;b=Math.min(b,nd(u[x],u[x+1],l[A],l[A+1],g))}return b}function po(u,i,l,p,g){if(!Nl(i,u.length)||!Nl(p,l.length))return NaN;let b=1/0;for(let x=i[0];x<=i[1];++x)for(let A=p[0];A<=p[1];++A)if((b=Math.min(b,g.distance(u[x],l[A])))===0)return b;return b}function _0(u,i,l){if(lh(u,i,!0))return 0;let p=1/0;for(const g of i){const b=g.length;if(b<2)return console.warn("Distance Expression: Invalid polygon!"),NaN;if(g[0]!==g[b-1]&&(p=Math.min(p,l.pointToSegmentDistance(u,g[b-1],g[0])))===0||(p=Math.min(p,ri(u,g,l)))===0)return p}return p}function y0(u,i,l,p){if(!Nl(i,u.length))return NaN;for(let b=i[0];b<=i[1];++b)if(lh(u[b],l,!0))return 0;let g=1/0;for(let b=i[0];b<i[1];++b)for(const x of l)for(let A=0,R=x.length,O=R-1;A<R;O=A++){if(Cp(u[b],u[b+1],x[O],x[A]))return 0;g=Math.min(g,nd(u[b],u[b+1],x[O],x[A],p))}return g}function v0(u,i){for(const l of u)for(let p=0;p<=l.length-1;++p)if(lh(l[p],i,!0))return!0;return!1}function b0(u,i,l,p=1/0){const g=yi(u),b=yi(i);if(p!==1/0&&Ip(g,b,l)>=p)return p;if(sc(g,b)){if(v0(u,i))return 0}else if(v0(i,u))return 0;let x=p;for(const A of u)for(let R=0,O=A.length,L=O-1;R<O;L=R++)for(const B of i)for(let U=0,q=B.length,Y=q-1;U<q;Y=U++){if(Cp(A[L],A[R],B[Y],B[U]))return 0;x=Math.min(x,nd(A[L],A[R],B[Y],B[U],l))}return x}function $_(u,i,l,p,g,b,x){if(b===null||x===null)return;const A=Ip(Ta(p,b),Ta(g,x),l);A<i&&u.push({dist:A,range1:b,range2:x})}function x0(u,i,l,p,g=1/0){let b=Math.min(p.distance(u[0],l[0][0]),g);if(b===0)return b;const x=new ng([{dist:0,range1:[0,u.length-1],range2:[0,0]}],ig),A=i?kl:ed,R=yi(l);for(;x.length;){const O=x.pop();if(O.dist>=b)continue;const L=O.range1;if(dh(L)<=A){if(!Nl(L,u.length))return NaN;if(i){const B=y0(u,L,l,p);if((b=Math.min(b,B))===0)return b}else for(let B=L[0];B<=L[1];++B){const U=_0(u[B],l,p);if((b=Math.min(b,U))===0)return b}}else{const B=td(L,i);if(B[0]!==null){const U=Ip(Ta(u,B[0]),R,p);U<b&&x.push({dist:U,range1:B[0],range2:[0,0]})}if(B[1]!==null){const U=Ip(Ta(u,B[1]),R,p);U<b&&x.push({dist:U,range1:B[1],range2:[0,0]})}}}return b}function G_(u,i,l,p,g,b=1/0){let x=Math.min(b,g.distance(u[0],l[0]));if(x===0)return x;const A=new ng([{dist:0,range1:[0,u.length-1],range2:[0,l.length-1]}],ig),R=i?kl:ed,O=p?kl:ed;for(;A.length;){const L=A.pop();if(L.dist>=x)continue;const B=L.range1,U=L.range2;if(dh(B)<=R&&dh(U)<=O){if(!Nl(B,u.length)||!Nl(U,l.length))return NaN;if(i&&p?x=Math.min(x,H_(u,B,l,U,g)):i||p?i&&!p?x=Math.min(x,zn(l,U,u,B,g)):!i&&p&&(x=Math.min(x,zn(u,B,l,U,g))):x=Math.min(x,po(u,B,l,U,g)),x===0)return x}else{const q=td(B,i),Y=td(U,p);$_(A,x,g,u,l,q[0],Y[0]),$_(A,x,g,u,l,q[0],Y[1]),$_(A,x,g,u,l,q[1],Y[0]),$_(A,x,g,u,l,q[1],Y[1])}}return x}function rg(u,i,l,p,g=1/0){let b=g;const x=Ta(u,[0,u.length-1]);for(const A of l)if(!(b!==1/0&&Ip(x,Ta(A,[0,A.length-1]),p)>=b)&&(b=Math.min(b,G_(u,i,A,!0,p,b)),b===0))return b;return b}function aa(u,i,l,p,g=1/0){let b=g;const x=Ta(u,[0,u.length-1]);for(const A of l){if(b!==1/0&&Ip(x,yi(A),p)>=b)continue;const R=x0(u,i,A,p,b);if(isNaN(R))return R;if((b=Math.min(b,R))===0)return b}return b}function es(u){return u==="Point"||u==="MultiPoint"||u==="LineString"||u==="MultiLineString"||u==="Polygon"||u==="MultiPolygon"}class fh{constructor(i,l){this.type=xn,this.geojson=i,this.geometries=l}static parse(i,l){if(i.length!==2)return l.error(`'distance' expression requires either one argument, but found ' ${i.length-1} instead.`);if(kn(i[1])){const p=i[1];if(p.type==="FeatureCollection"){for(let g=0;g<p.features.length;++g)if(es(p.features[g].geometry.type))return new fh(p,p.features[g].geometry)}else if(p.type==="Feature"){if(es(p.geometry.type))return new fh(p,p.geometry)}else if(es(p.type))return new fh(p,p)}return l.error("'distance' expression needs to be an array with format ['Distance', GeoJSONObj].")}evaluate(i){const l=i.geometry(),p=i.canonicalID();if(l!=null&&p!=null){if(i.geometryType()==="Point")return function(g,b,x){const A=[];for(const O of g)for(const L of O)A.push(Mp(L,b));const R=new mf(A[0][1],"meters");return x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString"?G_(A,!1,x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",R):x.type==="MultiLineString"?rg(A,!1,x.coordinates,R):x.type==="Polygon"||x.type==="MultiPolygon"?aa(A,!1,x.type==="Polygon"?[x.coordinates]:x.coordinates,R):null}(l,p,this.geometries);if(i.geometryType()==="LineString")return function(g,b,x){const A=[];for(const O of g){const L=[];for(const B of O)L.push(Mp(B,b));A.push(L)}const R=new mf(A[0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return rg(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",A,R);if(x.type==="MultiLineString"){let O=1/0;for(let L=0;L<x.coordinates.length;L++){const B=rg(x.coordinates[L],!0,A,R,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}if(x.type==="Polygon"||x.type==="MultiPolygon"){let O=1/0;for(let L=0;L<A.length;L++){const B=aa(A[L],!0,x.type==="Polygon"?[x.coordinates]:x.coordinates,R,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}return null}(l,p,this.geometries);if(i.geometryType()==="Polygon")return function(g,b,x){const A=[];for(const O of function(L,B){const U=L.length;if(U<=1)return[L];const q=[];let Y,ne;for(let ae=0;ae<U;ae++){const he=Jm(L[ae]);he!==0&&(L[ae].area=Math.abs(he),ne===void 0&&(ne=he<0),ne===he<0?(Y&&q.push(Y),Y=[L[ae]]):Y.push(L[ae]))}return Y&&q.push(Y),q}(g)){const L=[];for(let B=0;B<O.length;++B)L.push(g0(O[B],b));A.push(L)}const R=new mf(A[0][0][0][1],"meters");if(x.type==="Point"||x.type==="MultiPoint"||x.type==="LineString")return aa(x.type==="Point"?[x.coordinates]:x.coordinates,x.type==="LineString",A,R);if(x.type==="MultiLineString"){let O=1/0;for(let L=0;L<x.coordinates.length;L++){const B=aa(x.coordinates[L],!0,A,R,O);if(isNaN(B))return B;if((O=Math.min(O,B))===0)return O}return O}return x.type==="Polygon"||x.type==="MultiPolygon"?function(O,L,B){let U=1/0;for(const q of O)for(const Y of L){const ne=b0(q,Y,B,U);if(isNaN(ne))return ne;if((U=Math.min(U,ne))===0)return U}return U}(x.type==="Polygon"?[x.coordinates]:x.coordinates,A,R):null}(l,p,this.geometries);console.warn("Distance Expression: currently only evaluates valid Point/LineString/Polygon geometries.")}else console.warn("Distance Expression: requirs valid feature and canonical information.");return null}eachChild(){}outputDefined(){return!0}serialize(){return["distance",this.geojson]}}function Eu(u){if(u instanceof fo&&(u.name==="get"&&u.args.length===1||u.name==="feature-state"||u.name==="has"&&u.args.length===1||u.name==="properties"||u.name==="geometry-type"||u.name==="id"||/^filter-/.test(u.name))||u instanceof Go||u instanceof fh)return!1;if(u instanceof Au)return u.featureConstant;let i=!0;return u.eachChild(l=>{i&&!Eu(l)&&(i=!1)}),i}function eu(u){if(u instanceof fo&&u.name==="feature-state")return!1;let i=!0;return u.eachChild(l=>{i&&!eu(l)&&(i=!1)}),i}function Su(u){if(u instanceof Au)return new Set([u.key]);let i=new Set;return u.eachChild(l=>{i=new Set([...i,...Su(l)])}),i}function Ea(u,i){if(u instanceof fo&&i.indexOf(u.name)>=0)return!1;let l=!0;return u.eachChild(p=>{l&&!Ea(p,i)&&(l=!1)}),l}function q_(u,i,l){return[u,i,l].filter(Boolean).join("")}function id(u,i){switch(u){case"string":return Jr(i);case"number":return+i;case"boolean":return!!i;case"color":return Mi.parse(i);case"formatted":return $t.fromString(Jr(i));case"resolvedImage":return Hi.build(Jr(i))}return i}function W_(u,i,l,p){return p!==void 0&&(u=p*Math.round(u/p)),i!==void 0&&u<i&&(u=i),l!==void 0&&u>l&&(u=l),u}class Au{constructor(i,l,p,g=!1){this.type=i,this.key=l,this.scope=p,this.featureConstant=g}static parse(i,l){let p=l.expectedType;if(p==null&&(p=fi),i.length<2||i.length>3)return l.error("Invalid number of arguments for 'config' expression.");const g=l.parse(i[1],1);if(!(g instanceof Hn))return l.error("Key name of 'config' expression must be a string literal.");let b,x=!0;const A=Jr(g.value);if(i.length>=3){const R=l.parse(i[2],2);if(!(R instanceof Hn))return l.error("Scope of 'config' expression must be a string literal.");b=Jr(R.value)}if(l.options){const R=q_(A,b,l._scope),O=l.options.get(R);O&&(x=Eu(O.value||O.default))}return new Au(p,A,b,x)}evaluate(i){const l=q_(this.key,this.scope,i.scope),p=i.getConfig(l);if(!p)return null;const{type:g,value:b,values:x,minValue:A,maxValue:R,stepValue:O}=p,L=p.default.evaluate(i);let B=L;if(b){const U=i.scope;i.scope=(U||"").split("").slice(1).join(""),B=b.evaluate(i),i.scope=U}return g&&(B=id(g,B)),B===void 0||A===void 0&&R===void 0&&O===void 0||(typeof B=="number"?B=W_(B,A,R,O):Array.isArray(B)&&(B=B.map(U=>typeof U=="number"?W_(U,A,R,O):U))),b!==void 0&&B!==void 0&&x&&!x.includes(B)&&(B=L,g&&(B=id(g,B))),(g&&g!==this.type||B!==void 0&&!xe(an(B),this.type))&&(B=id(this.type.kind,B)),B}eachChild(){}outputDefined(){return!1}serialize(){const i=["config",this.key];return this.scope&&i.concat(this.scope),i}}class Pp{constructor(i,l){this.type=l.type,this.name=i,this.boundExpression=l}static parse(i,l){if(i.length!==2||typeof i[1]!="string")return l.error("'var' expression requires exactly one string literal argument.");const p=i[1];return l.scope.has(p)?new Pp(p,l.scope.get(p)):l.error(`Unknown variable "${p}". Make sure "${p}" has been bound in an enclosing "let" expression before using it.`,1)}evaluate(i){return this.boundExpression.evaluate(i)}eachChild(){}outputDefined(){return!1}serialize(){return["var",this.name]}}class _f{constructor(i,l=[],p,g=new Il,b=[],x,A){this.registry=i,this.path=l,this.key=l.map(R=>typeof R=="string"?`['${R}']`:`[${R}]`).join(""),this.scope=g,this.errors=b,this.expectedType=p,this._scope=x,this.options=A}parse(i,l,p,g,b={}){return l||p?this.concat(l,null,p,g)._parse(i,b):this._parse(i,b)}parseObjectValue(i,l,p,g,b,x={}){return this.concat(l,p,g,b)._parse(i,x)}_parse(i,l){function p(g,b,x){return x==="assert"?new Un(b,[g]):x==="coerce"?new wa(b,[g]):g}if(i!==null&&typeof i!="string"&&typeof i!="boolean"&&typeof i!="number"||(i=["literal",i]),Array.isArray(i)){if(i.length===0)return this.error('Expected an array with at least one element. If you wanted a literal array, use ["literal", []].');const g=typeof i[0]=="string"?this.registry[i[0]]:void 0;if(g){let b=g.parse(i,this);if(!b)return null;if(this.expectedType){const x=this.expectedType,A=b.type;if(x.kind!=="string"&&x.kind!=="number"&&x.kind!=="boolean"&&x.kind!=="object"&&x.kind!=="array"||A.kind!=="value")if(x.kind!=="color"&&x.kind!=="formatted"&&x.kind!=="resolvedImage"||A.kind!=="value"&&A.kind!=="string"){if(this.checkSubtype(x,A))return null}else b=p(b,x,l.typeAnnotation||"coerce");else b=p(b,x,l.typeAnnotation||"assert")}if(!(b instanceof Hn)&&b.type.kind!=="resolvedImage"&&Y_(b)){const x=new ah(this._scope,this.options);try{b=new Hn(b.type,b.evaluate(x))}catch(A){return this.error(A.message),null}}return b}return wa.parse(["to-array",i],this)}return this.error(i===void 0?"'undefined' value invalid. Use null instead.":typeof i=="object"?'Bare objects invalid. Use ["literal", {...}] instead.':`Expected an array, but found ${typeof i} instead.`)}concat(i,l,p,g){let b=typeof i=="number"?this.path.concat(i):this.path;b=typeof l=="string"?b.concat(l):b;const x=g?this.scope.concat(g):this.scope;return new _f(this.registry,b,p||null,x,this.errors,this._scope,this.options)}error(i,...l){const p=`${this.key}${l.map(g=>`[${g}]`).join("")}`;this.errors.push(new $o(p,i))}checkSubtype(i,l){const p=Za(i,l);return p&&this.error(p),p}}function Y_(u){if(u instanceof Pp)return Y_(u.boundExpression);if(u instanceof fo&&u.name==="error"||u instanceof oa||u instanceof Go||u instanceof fh||u instanceof Au)return!1;const i=u instanceof wa||u instanceof Un;let l=!0;return u.eachChild(p=>{l=i?l&&Y_(p):l&&p instanceof Hn}),!!l&&Eu(u)&&Ea(u,["zoom","heatmap-density","worldview","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])}function sg(u,i){const l=u.length-1;let p,g,b=0,x=l,A=0;for(;b<=x;)if(A=Math.floor((b+x)/2),p=u[A],g=u[A+1],p<=i){if(A===l||i<g)return A;b=A+1}else{if(!(p>i))throw new Ki("Input is not a number.");x=A-1}return 0}class kp{constructor(i,l,p){this.type=i,this.input=l,this.labels=[],this.outputs=[];for(const[g,b]of p)this.labels.push(g),this.outputs.push(b)}static parse(i,l){if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if((i.length-1)%2!=0)return l.error("Expected an even number of arguments.");const p=l.parse(i[1],1,xn);if(!p)return null;const g=[];let b=null;l.expectedType&&l.expectedType.kind!=="value"&&(b=l.expectedType);for(let x=1;x<i.length;x+=2){const A=x===1?-1/0:i[x],R=i[x+1],O=x,L=x+1;if(typeof A!="number")return l.error('Input/output pairs for "step" expressions must be defined using literal numeric values (not computed expressions) for the input values.',O);if(g.length&&g[g.length-1][0]>=A)return l.error('Input/output pairs for "step" expressions must be arranged with input values in strictly ascending order.',O);const B=l.parse(R,L,b);if(!B)return null;b=b||B.type,g.push([A,B])}return new kp(b,p,g)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const b=l.length;return g>=l[b-1]?p[b-1].evaluate(i):p[sg(l,g)].evaluate(i)}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){const i=["step",this.input.serialize()];for(let l=0;l<this.labels.length;l++)l>0&&i.push(this.labels[l]),i.push(this.outputs[l].serialize());return i}}const w0=.95047,T0=1.08883,Z_=4/29,Cu=6/29,X_=3*Cu*Cu,E0=Cu*Cu*Cu,Vx=Math.PI/180,Ux=180/Math.PI;function S0(u){return u>E0?Math.pow(u,1/3):u/X_+Z_}function og(u){return u>Cu?u*u*u:X_*(u-Z_)}function ag(u){return 255*(u<=.0031308?12.92*u:1.055*Math.pow(u,1/2.4)-.055)}function ph(u){return(u/=255)<=.04045?u/12.92:Math.pow((u+.055)/1.055,2.4)}function lg(u){const i=ph(u.r),l=ph(u.g),p=ph(u.b),g=S0((.4124564*i+.3575761*l+.1804375*p)/w0),b=S0((.2126729*i+.7151522*l+.072175*p)/1);return{l:116*b-16,a:500*(g-b),b:200*(b-S0((.0193339*i+.119192*l+.9503041*p)/T0)),alpha:u.a}}function Q_(u){let i=(u.l+16)/116,l=isNaN(u.a)?i:i+u.a/500,p=isNaN(u.b)?i:i-u.b/200;return i=1*og(i),l=w0*og(l),p=T0*og(p),new Mi(ag(3.2404542*l-1.5371385*i-.4985314*p),ag(-.969266*l+1.8760108*i+.041556*p),ag(.0556434*l-.2040259*i+1.0572252*p),u.alpha)}function jx(u,i,l){const p=i-u;return u+l*(p>180||p<-180?p-360*Math.round(p/360):p)}const ac={forward:lg,reverse:Q_,interpolate:function(u,i,l){return{l:$n(u.l,i.l,l),a:$n(u.a,i.a,l),b:$n(u.b,i.b,l),alpha:$n(u.alpha,i.alpha,l)}}},Du={forward:function(u){const{l:i,a:l,b:p}=lg(u),g=Math.atan2(p,l)*Ux;return{h:g<0?g+360:g,c:Math.sqrt(l*l+p*p),l:i,alpha:u.a}},reverse:function(u){const i=u.h*Vx,l=u.c;return Q_({l:u.l,a:Math.cos(i)*l,b:Math.sin(i)*l,alpha:u.alpha})},interpolate:function(u,i,l){return{h:jx(u.h,i.h,l),c:$n(u.c,i.c,l),l:$n(u.l,i.l,l),alpha:$n(u.alpha,i.alpha,l)}}};var A0=Object.freeze({__proto__:null,hcl:Du,lab:ac});class Ll{constructor(i,l,p,g,b){this.type=i,this.operator=l,this.interpolation=p,this.input=g,this.labels=[],this.outputs=[];for(const[x,A]of b)this.labels.push(x),this.outputs.push(A)}static interpolationFactor(i,l,p,g){let b=0;if(i.name==="exponential")b=yf(l,i.base,p,g);else if(i.name==="linear")b=yf(l,1,p,g);else if(i.name==="cubic-bezier"){const x=i.controlPoints;b=new Ri(x[0],x[1],x[2],x[3]).solve(yf(l,1,p,g))}return b}static parse(i,l){let[p,g,b,...x]=i;if(!Array.isArray(g)||g.length===0)return l.error("Expected an interpolation type expression.",1);if(g[0]==="linear")g={name:"linear"};else if(g[0]==="exponential"){const O=g[1];if(typeof O!="number")return l.error("Exponential interpolation requires a numeric base.",1,1);g={name:"exponential",base:O}}else{if(g[0]!=="cubic-bezier")return l.error(`Unknown interpolation type ${String(g[0])}`,1,0);{const O=g.slice(1);if(O.length!==4||O.some(L=>typeof L!="number"||L<0||L>1))return l.error("Cubic bezier interpolation requires four numeric arguments with values between 0 and 1.",1);g={name:"cubic-bezier",controlPoints:O}}}if(i.length-1<4)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length-1>3&&(i.length-1)%2!=0)return l.error("Expected an even number of arguments.");if(b=l.parse(b,2,xn),!b)return null;const A=[];let R=null;p==="interpolate-hcl"||p==="interpolate-lab"?R=Fs:l.expectedType&&l.expectedType.kind!=="value"&&(R=l.expectedType);for(let O=0;O<x.length;O+=2){const L=x[O],B=x[O+1],U=O+3,q=O+4;if(typeof L!="number")return l.error('Input/output pairs for "interpolate" expressions must be defined using literal numeric values (not computed expressions) for the input values.',U);if(A.length&&A[A.length-1][0]>=L)return l.error('Input/output pairs for "interpolate" expressions must be arranged with input values in strictly ascending order.',U);const Y=l.parse(B,q,R);if(!Y)return null;R=R||Y.type,A.push([L,Y])}return R.kind==="number"||R.kind==="color"||R.kind==="array"&&R.itemType.kind==="number"&&typeof R.N=="number"?new Ll(R,p,g,b,A):l.error(`Type ${ys(R)} is not interpolatable.`)}evaluate(i){const l=this.labels,p=this.outputs;if(l.length===1)return p[0].evaluate(i);const g=this.input.evaluate(i);if(g<=l[0])return p[0].evaluate(i);const b=l.length;if(g>=l[b-1])return p[b-1].evaluate(i);const x=sg(l,g),A=Ll.interpolationFactor(this.interpolation,g,l[x],l[x+1]),R=p[x].evaluate(i),O=p[x+1].evaluate(i);return this.operator==="interpolate"?sh[this.type.kind.toLowerCase()](R,O,A):this.operator==="interpolate-hcl"?Du.reverse(Du.interpolate(Du.forward(R),Du.forward(O),A)):ac.reverse(ac.interpolate(ac.forward(R),ac.forward(O),A))}eachChild(i){i(this.input);for(const l of this.outputs)i(l)}outputDefined(){return this.outputs.every(i=>i.outputDefined())}serialize(){let i;i=this.interpolation.name==="linear"?["linear"]:this.interpolation.name==="exponential"?this.interpolation.base===1?["linear"]:["exponential",this.interpolation.base]:["cubic-bezier",...this.interpolation.controlPoints];const l=[this.operator,i,this.input.serialize()];for(let p=0;p<this.labels.length;p++)l.push(this.labels[p],this.outputs[p].serialize());return l}}function yf(u,i,l,p){const g=p-l,b=u-l;return g===0?0:i===1?b/g:(Math.pow(i,b)-1)/(Math.pow(i,g)-1)}class Ru{constructor(i,l){this.type=i,this.args=l}static parse(i,l){if(i.length<2)return l.error("Expectected at least one argument.");let p=null;const g=l.expectedType;g&&g.kind!=="value"&&(p=g);const b=[];for(const A of i.slice(1)){const R=l.parse(A,1+b.length,p,void 0,{typeAnnotation:"omit"});if(!R)return null;p=p||R.type,b.push(R)}const x=g&&b.some(A=>Za(g,A.type));return new Ru(x?fi:p,b)}evaluate(i){let l,p=null,g=0;for(const b of this.args){if(g++,p=b.evaluate(i),p&&p instanceof Hi&&!p.available&&(l||(l=p),p=null,g===this.args.length))return l;if(p!==null)break}return p}eachChild(i){this.args.forEach(i)}outputDefined(){return this.args.every(i=>i.outputDefined())}serialize(){const i=["coalesce"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class vf{constructor(i,l){this.type=l.type,this.bindings=[].concat(i),this.result=l}evaluate(i){return this.result.evaluate(i)}eachChild(i){for(const l of this.bindings)i(l[1]);i(this.result)}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found ${i.length-1} instead.`);const p=[];for(let b=1;b<i.length-1;b+=2){const x=i[b];if(typeof x!="string")return l.error(`Expected string, but found ${typeof x} instead.`,b);if(/[^a-zA-Z0-9_]/.test(x))return l.error("Variable names must contain only alphanumeric characters or '_'.",b);const A=l.parse(i[b+1],b+1);if(!A)return null;p.push([x,A])}const g=l.parse(i[i.length-1],i.length-1,l.expectedType,p);return g?new vf(p,g):null}outputDefined(){return this.result.outputDefined()}serialize(){const i=["let"];for(const[l,p]of this.bindings)i.push(l,p.serialize());return i.push(this.result.serialize()),i}}class cg{constructor(i,l,p){this.type=i,this.index=l,this.input=p}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,xn),g=l.parse(i[2],2,Wr(l.expectedType||fi));return p&&g?new cg(g.type.itemType,p,g):null}evaluate(i){const l=this.index.evaluate(i),p=this.input.evaluate(i);if(l<0)throw new Ki(`Array index out of bounds: ${l} < 0.`);if(l>=p.length)throw new Ki(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l!==Math.floor(l))throw new Ki(`Array index must be an integer, but found ${l} instead. Use at-interpolated to retrieve interpolated result with a fractional index.`);return p[l]}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at",this.index.serialize(),this.input.serialize()]}}class mh{constructor(i,l,p){this.type=i,this.index=l,this.input=p}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,xn),g=l.parse(i[2],2,Wr(l.expectedType||fi));return p&&g?new mh(g.type.itemType,p,g):null}evaluate(i){const l=this.index.evaluate(i),p=this.input.evaluate(i);if(l<0)throw new Ki(`Array index out of bounds: ${l} < 0.`);if(l>p.length-1)throw new Ki(`Array index out of bounds: ${l} > ${p.length-1}.`);if(l===Math.floor(l))return p[l];const g=Math.floor(l),b=Math.ceil(l),x=p[g],A=p[b];if(typeof x!="number"||typeof A!="number")throw new Ki(`Cannot interpolate between non-number values at index ${l}.`);const R=l-g;return x*(1-R)+A*R}eachChild(i){i(this.index),i(this.input)}outputDefined(){return!1}serialize(){return["at-interpolated",this.index.serialize(),this.input.serialize()]}}class la{constructor(i,l){this.type=Di,this.needle=i,this.haystack=l}static parse(i,l){if(i.length!==3)return l.error(`Expected 2 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,fi),g=l.parse(i[2],2,fi);return p&&g?V(p.type,[Di,gi,xn,Ya,fi])?new la(p,g):l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ys(p.type)} instead`):null}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(p==null)return!1;if(!le(l,["boolean","string","number","null"]))throw new Ki(`Expected first argument to be of type boolean, string, number or null, but found ${ys(an(l))} instead.`);if(!le(p,["string","array"]))throw new Ki(`Expected second argument to be of type array or string, but found ${ys(an(p))} instead.`);return p.indexOf(l)>=0}eachChild(i){i(this.needle),i(this.haystack)}outputDefined(){return!0}serialize(){return["in",this.needle.serialize(),this.haystack.serialize()]}}class rd{constructor(i,l,p){this.type=xn,this.needle=i,this.haystack=l,this.fromIndex=p}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,fi),g=l.parse(i[2],2,fi);if(!p||!g)return null;if(!V(p.type,[Di,gi,xn,Ya,fi]))return l.error(`Expected first argument to be of type boolean, string, number or null, but found ${ys(p.type)} instead`);if(i.length===4){const b=l.parse(i[3],3,xn);return b?new rd(p,g,b):null}return new rd(p,g)}evaluate(i){const l=this.needle.evaluate(i),p=this.haystack.evaluate(i);if(!le(l,["boolean","string","number","null"]))throw new Ki(`Expected first argument to be of type boolean, string, number or null, but found ${ys(an(l))} instead.`);if(!le(p,["string","array"]))throw new Ki(`Expected second argument to be of type array or string, but found ${ys(an(p))} instead.`);if(this.fromIndex){const g=this.fromIndex.evaluate(i);return p.indexOf(l,g)}return p.indexOf(l)}eachChild(i){i(this.needle),i(this.haystack),this.fromIndex&&i(this.fromIndex)}outputDefined(){return!1}serialize(){if(this.fromIndex!=null&&this.fromIndex!==void 0){const i=this.fromIndex.serialize();return["index-of",this.needle.serialize(),this.haystack.serialize(),i]}return["index-of",this.needle.serialize(),this.haystack.serialize()]}}class sd{constructor(i,l,p,g,b,x){this.inputType=i,this.type=l,this.input=p,this.cases=g,this.outputs=b,this.otherwise=x}static parse(i,l){if(i.length<5)return l.error(`Expected at least 4 arguments, but found only ${i.length-1}.`);if(i.length%2!=1)return l.error("Expected an even number of arguments.");let p,g;l.expectedType&&l.expectedType.kind!=="value"&&(g=l.expectedType);const b={},x=[];for(let O=2;O<i.length-1;O+=2){let L=i[O];const B=i[O+1];Array.isArray(L)||(L=[L]);const U=l.concat(O);if(L.length===0)return U.error("Expected at least one branch label.");for(const Y of L){if(typeof Y!="number"&&typeof Y!="string")return U.error("Branch labels must be numbers or strings.");if(typeof Y=="number"&&Math.abs(Y)>Number.MAX_SAFE_INTEGER)return U.error(`Branch labels must be integers no larger than ${Number.MAX_SAFE_INTEGER}.`);if(typeof Y=="number"&&Math.floor(Y)!==Y)return U.error("Numeric branch labels must be integer values.");if(p){if(U.checkSubtype(p,an(Y)))return null}else p=an(Y);if(b[String(Y)]!==void 0)return U.error("Branch labels must be unique.");b[String(Y)]=x.length}const q=l.parse(B,O,g);if(!q)return null;g=g||q.type,x.push(q)}const A=l.parse(i[1],1,fi);if(!A)return null;const R=l.parse(i[i.length-1],i.length-1,g);return R?A.type.kind!=="value"&&l.concat(1).checkSubtype(p,A.type)?null:new sd(p,g,A,b,x,R):null}evaluate(i){const l=this.input.evaluate(i);return(xe(an(l),this.inputType)&&this.outputs[this.cases[l]]||this.otherwise).evaluate(i)}eachChild(i){i(this.input),this.outputs.forEach(i),i(this.otherwise)}outputDefined(){return this.outputs.every(i=>i.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["match",this.input.serialize()],l=Object.keys(this.cases).sort(),p=[],g={};for(const x of l){const A=g[this.cases[x]];A===void 0?(g[this.cases[x]]=p.length,p.push([this.cases[x],[x]])):p[A][1].push(x)}const b=x=>this.inputType.kind==="number"?Number(x):x;for(const[x,A]of p)i.push(A.length===1?b(A[0]):A.map(b)),i.push(this.outputs[x].serialize());return i.push(this.otherwise.serialize()),i}}class K_{constructor(i,l,p){this.type=i,this.branches=l,this.otherwise=p}static parse(i,l){if(i.length<4)return l.error(`Expected at least 3 arguments, but found only ${i.length-1}.`);if(i.length%2!=0)return l.error("Expected an odd number of arguments.");let p;l.expectedType&&l.expectedType.kind!=="value"&&(p=l.expectedType);const g=[];for(let x=1;x<i.length-1;x+=2){const A=l.parse(i[x],x,Di);if(!A)return null;const R=l.parse(i[x+1],x+1,p);if(!R)return null;g.push([A,R]),p=p||R.type}const b=l.parse(i[i.length-1],i.length-1,p);return b?new K_(p,g,b):null}evaluate(i){for(const[l,p]of this.branches)if(l.evaluate(i))return p.evaluate(i);return this.otherwise.evaluate(i)}eachChild(i){for(const[l,p]of this.branches)i(l),i(p);i(this.otherwise)}outputDefined(){return this.branches.every(([i,l])=>l.outputDefined())&&this.otherwise.outputDefined()}serialize(){const i=["case"];return this.eachChild(l=>{i.push(l.serialize())}),i}}class bf{constructor(i,l,p,g){this.type=i,this.input=l,this.beginIndex=p,this.endIndex=g}static parse(i,l){if(i.length<=2||i.length>=5)return l.error(`Expected 3 or 4 arguments, but found ${i.length-1} instead.`);const p=l.parse(i[1],1,fi),g=l.parse(i[2],2,xn);if(!p||!g)return null;if(!V(p.type,[Wr(fi),gi,fi]))return l.error(`Expected first argument to be of type array or string, but found ${ys(p.type)} instead`);if(i.length===4){const b=l.parse(i[3],3,xn);return b?new bf(p.type,p,g,b):null}return new bf(p.type,p,g)}evaluate(i){const l=this.input.evaluate(i),p=this.beginIndex.evaluate(i);if(!le(l,["string","array"]))throw new Ki(`Expected first argument to be of type array or string, but found ${ys(an(l))} instead.`);if(this.endIndex){const g=this.endIndex.evaluate(i);return l.slice(p,g)}return l.slice(p)}eachChild(i){i(this.input),i(this.beginIndex),this.endIndex&&i(this.endIndex)}outputDefined(){return!1}serialize(){if(this.endIndex!=null&&this.endIndex!==void 0){const i=this.endIndex.serialize();return["slice",this.input.serialize(),this.beginIndex.serialize(),i]}return["slice",this.input.serialize(),this.beginIndex.serialize()]}}function ug(u,i){return u==="=="||u==="!="?i.kind==="boolean"||i.kind==="string"||i.kind==="number"||i.kind==="null"||i.kind==="value":i.kind==="string"||i.kind==="number"||i.kind==="value"}function J_(u,i,l,p){return p.compare(i,l)===0}function Ou(u,i,l){const p=u!=="=="&&u!=="!=";return class f8{constructor(b,x,A){this.type=Di,this.lhs=b,this.rhs=x,this.collator=A,this.hasUntypedArgument=b.type.kind==="value"||x.type.kind==="value"}static parse(b,x){if(b.length!==3&&b.length!==4)return x.error("Expected two or three arguments.");const A=b[0];let R=x.parse(b[1],1,fi);if(!R)return null;if(!ug(A,R.type))return x.concat(1).error(`"${A}" comparisons are not supported for type '${ys(R.type)}'.`);let O=x.parse(b[2],2,fi);if(!O)return null;if(!ug(A,O.type))return x.concat(2).error(`"${A}" comparisons are not supported for type '${ys(O.type)}'.`);if(R.type.kind!==O.type.kind&&R.type.kind!=="value"&&O.type.kind!=="value")return x.error(`Cannot compare types '${ys(R.type)}' and '${ys(O.type)}'.`);p&&(R.type.kind==="value"&&O.type.kind!=="value"?R=new Un(O.type,[R]):R.type.kind!=="value"&&O.type.kind==="value"&&(O=new Un(R.type,[O])));let L=null;if(b.length===4){if(R.type.kind!=="string"&&O.type.kind!=="string"&&R.type.kind!=="value"&&O.type.kind!=="value")return x.error("Cannot use collator to compare non-string types.");if(L=x.parse(b[3],3,Jh),!L)return null}return new f8(R,O,L)}evaluate(b){const x=this.lhs.evaluate(b),A=this.rhs.evaluate(b);if(p&&this.hasUntypedArgument){const R=an(x),O=an(A);if(R.kind!==O.kind||R.kind!=="string"&&R.kind!=="number")throw new Ki(`Expected arguments for "${u}" to be (string, string) or (number, number), but found (${R.kind}, ${O.kind}) instead.`)}if(this.collator&&!p&&this.hasUntypedArgument){const R=an(x),O=an(A);if(R.kind!=="string"||O.kind!=="string")return i(b,x,A)}return this.collator?l(b,x,A,this.collator.evaluate(b)):i(b,x,A)}eachChild(b){b(this.lhs),b(this.rhs),this.collator&&b(this.collator)}outputDefined(){return!0}serialize(){const b=[u];return this.eachChild(x=>{b.push(x.serialize())}),b}}}const ey=Ou("==",function(u,i,l){return i===l},J_),ty=Ou("!=",function(u,i,l){return i!==l},function(u,i,l,p){return!J_(0,i,l,p)}),C0=Ou("<",function(u,i,l){return i<l},function(u,i,l,p){return p.compare(i,l)<0}),Hx=Ou(">",function(u,i,l){return i>l},function(u,i,l,p){return p.compare(i,l)>0}),hg=Ou("<=",function(u,i,l){return i<=l},function(u,i,l,p){return p.compare(i,l)<=0}),D0=Ou(">=",function(u,i,l){return i>=l},function(u,i,l,p){return p.compare(i,l)>=0});class dg{constructor(i,l,p,g,b,x){this.type=gi,this.number=i,this.locale=l,this.currency=p,this.unit=g,this.minFractionDigits=b,this.maxFractionDigits=x}static parse(i,l){if(i.length!==3)return l.error("Expected two arguments.");const p=l.parse(i[1],1,xn);if(!p)return null;const g=i[2];if(typeof g!="object"||Array.isArray(g))return l.error("NumberFormat options argument must be an object.");let b=null;if(g.locale&&(b=l.parseObjectValue(g.locale,2,"locale",gi),!b))return null;let x=null;if(g.currency&&(x=l.parseObjectValue(g.currency,2,"currency",gi),!x))return null;let A=null;if(g.unit&&(A=l.parseObjectValue(g.unit,2,"unit",gi),!A))return null;let R=null;if(g["min-fraction-digits"]&&(R=l.parseObjectValue(g["min-fraction-digits"],2,"min-fraction-digits",xn),!R))return null;let O=null;return g["max-fraction-digits"]&&(O=l.parseObjectValue(g["max-fraction-digits"],2,"max-fraction-digits",xn),!O)?null:new dg(p,b,x,A,R,O)}evaluate(i){return new Intl.NumberFormat(this.locale?this.locale.evaluate(i):[],{style:(this.currency?"currency":this.unit&&"unit")||"decimal",currency:this.currency?this.currency.evaluate(i):void 0,unit:this.unit?this.unit.evaluate(i):void 0,minimumFractionDigits:this.minFractionDigits?this.minFractionDigits.evaluate(i):void 0,maximumFractionDigits:this.maxFractionDigits?this.maxFractionDigits.evaluate(i):void 0}).format(this.number.evaluate(i))}eachChild(i){i(this.number),this.locale&&i(this.locale),this.currency&&i(this.currency),this.unit&&i(this.unit),this.minFractionDigits&&i(this.minFractionDigits),this.maxFractionDigits&&i(this.maxFractionDigits)}outputDefined(){return!1}serialize(){const i={};return this.locale&&(i.locale=this.locale.serialize()),this.currency&&(i.currency=this.currency.serialize()),this.unit&&(i.unit=this.unit.serialize()),this.minFractionDigits&&(i["min-fraction-digits"]=this.minFractionDigits.serialize()),this.maxFractionDigits&&(i["max-fraction-digits"]=this.maxFractionDigits.serialize()),["number-format",this.number.serialize(),i]}}class ny{constructor(i){this.type=xn,this.input=i}static parse(i,l){if(i.length!==2)return l.error(`Expected 1 argument, but found ${i.length-1} instead.`);const p=l.parse(i[1],1);return p?p.type.kind!=="array"&&p.type.kind!=="string"&&p.type.kind!=="value"?l.error(`Expected argument of type string or array, but found ${ys(p.type)} instead.`):new ny(p):null}evaluate(i){const l=this.input.evaluate(i);if(typeof l=="string"||Array.isArray(l))return l.length;throw new Ki(`Expected value to be of type string or array, but found ${ys(an(l))} instead.`)}eachChild(i){i(this.input)}outputDefined(){return!1}serialize(){const i=["length"];return this.eachChild(l=>{i.push(l.serialize())}),i}}function iy(u){return function(){u=1831565813+(u|=0)|0;let i=Math.imul(u^u>>>15,1|u);return i=i+Math.imul(i^i>>>7,61|i)^i,((i^i>>>14)>>>0)/4294967296}}const od={"==":ey,"!=":ty,">":Hx,"<":C0,">=":D0,"<=":hg,array:Un,at:cg,"at-interpolated":mh,boolean:Un,case:K_,coalesce:Ru,collator:oa,format:rc,image:df,in:la,"index-of":rd,interpolate:Ll,"interpolate-hcl":Ll,"interpolate-lab":Ll,length:ny,let:vf,literal:Hn,match:sd,number:Un,"number-format":dg,object:Un,slice:bf,step:kp,string:Un,"to-boolean":wa,"to-color":wa,"to-number":wa,"to-string":wa,var:Pp,within:Go,distance:fh,config:Au};function ry(u,[i,l,p,g]){i=i.evaluate(u),l=l.evaluate(u),p=p.evaluate(u);const b=g?g.evaluate(u):1,x=Ss(i,l,p,b);if(x)throw new Ki(x);return new Mi(i/255,l/255,p/255,b)}function fg(u,[i,l,p,g]){i=i.evaluate(u),l=l.evaluate(u),p=p.evaluate(u);const b=g?g.evaluate(u):1,x=function(O,L,B,U){return typeof O=="number"&&O>=0&&O<=360?typeof L=="number"&&L>=0&&L<=100&&typeof B=="number"&&B>=0&&B<=100?U===void 0||typeof U=="number"&&U>=0&&U<=1?null:`Invalid hsla value [${[O,L,B,U].join(", ")}]: 'a' must be between 0 and 1.`:`Invalid hsla value [${(typeof U=="number"?[O,L,B,U]:[O,L,B]).join(", ")}]: 's', and 'l' must be between 0 and 100.`:`Invalid hsla value [${(typeof U=="number"?[O,L,B,U]:[O,L,B]).join(", ")}]: 'h' must be between 0 and 360.`}(i,l,p,b);if(x)throw new Ki(x);const A=`hsla(${i}, ${l}%, ${p}%, ${b})`,R=Mi.parse(A);if(!R)throw new Ki(`Failed to parse HSLA color: ${A}`);return R}function R0(u,i){return u in i}function gh(u,i){const l=i[u];return l===void 0?null:l}function zl(u){return{type:u}}function sy(u){return{result:"success",value:u}}function Iu(u){return{result:"error",value:u}}function oy(u,i){return!!u&&!!u.parameters&&u.parameters.indexOf(i)>-1}function pg(u){return u["property-type"]==="data-driven"}function ay(u){return oy(u.expression,"measure-light")}function xf(u){return oy(u.expression,"zoom")}function wf(u){return!!u.expression&&u.expression.interpolated}function ad(u){return typeof u=="object"&&u!==null&&!Array.isArray(u)}function O0(u){return u}function I0(u,i){const l=i.type==="color",p=u.stops&&typeof u.stops[0][0]=="object",g=p||!(p||u.property!==void 0),b=u.type||(wf(i)?"exponential":"interval");if(l&&((u=ic({},u)).stops&&(u.stops=u.stops.map(O=>[O[0],Mi.parse(O[1])])),u.default=Mi.parse(u.default?u.default:i.default)),u.colorSpace&&u.colorSpace!=="rgb"&&!A0[u.colorSpace])throw new Error(`Unknown color space: ${u.colorSpace}`);let x,A,R;if(b==="exponential")x=Tf;else if(b==="interval")x=cy;else if(b==="categorical"){x=ly,A=Object.create(null);for(const O of u.stops)A[O[0]]=O[1];R=typeof u.stops[0][0]}else{if(b!=="identity")throw new Error(`Unknown function type "${b}"`);x=uy}if(p){const O={},L=[];for(let q=0;q<u.stops.length;q++){const Y=u.stops[q],ne=Y[0].zoom;O[ne]===void 0&&(O[ne]={zoom:ne,type:u.type,property:u.property,default:u.default,stops:[]},L.push(ne)),O[ne].stops.push([Y[0].value,Y[1]])}const B=[];for(const q of L)B.push([O[q].zoom,I0(O[q],i)]);const U={name:"linear"};return{kind:"composite",interpolationType:U,interpolationFactor:Ll.interpolationFactor.bind(void 0,U),zoomStops:B.map(q=>q[0]),evaluate:({zoom:q},Y)=>Tf({stops:B,base:u.base},i,q).evaluate(q,Y)}}if(g){const O=b==="exponential"?{name:"exponential",base:u.base!==void 0?u.base:1}:null;return{kind:"camera",interpolationType:O,interpolationFactor:Ll.interpolationFactor.bind(void 0,O),zoomStops:u.stops.map(L=>L[0]),evaluate:({zoom:L})=>x(u,i,L,A,R)}}return{kind:"source",evaluate(O,L){const B=L&&L.properties?L.properties[u.property]:void 0;return B===void 0?vs(u.default,i.default):x(u,i,B,A,R)}}}function vs(u,i,l){return u!==void 0?u:i!==void 0?i:l!==void 0?l:void 0}function ly(u,i,l,p,g){return vs(typeof l===g?p[l]:void 0,u.default,i.default)}function cy(u,i,l){if(oh(l)!=="number")return vs(u.default,i.default);const p=u.stops.length;if(p===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[p-1][0])return u.stops[p-1][1];const g=sg(u.stops.map(b=>b[0]),l);return u.stops[g][1]}function Tf(u,i,l){const p=u.base!==void 0?u.base:1;if(oh(l)!=="number")return vs(u.default,i.default);const g=u.stops.length;if(g===1||l<=u.stops[0][0])return u.stops[0][1];if(l>=u.stops[g-1][0])return u.stops[g-1][1];const b=sg(u.stops.map(L=>L[0]),l),x=function(L,B,U,q){const Y=q-U,ne=L-U;return Y===0?0:B===1?ne/Y:(Math.pow(B,ne)-1)/(Math.pow(B,Y)-1)}(l,p,u.stops[b][0],u.stops[b+1][0]),A=u.stops[b][1],R=u.stops[b+1][1];let O=sh[i.type]||O0;if(u.colorSpace&&u.colorSpace!=="rgb"){const L=A0[u.colorSpace];O=(B,U)=>L.reverse(L.interpolate(L.forward(B),L.forward(U),x))}return typeof A.evaluate=="function"?{evaluate(...L){const B=A.evaluate.apply(void 0,L),U=R.evaluate.apply(void 0,L);if(B!==void 0&&U!==void 0)return O(B,U,x)}}:O(A,R,x)}function uy(u,i,l){return i.type==="color"?l=Mi.parse(l):i.type==="formatted"?l=$t.fromString(l.toString()):i.type==="resolvedImage"?l=Hi.build(l.toString()):oh(l)===i.type||i.type==="enum"&&i.values[l]||(l=void 0),vs(l,u.default,i.default)}fo.register(od,{error:[{kind:"error"},[gi],(u,[i])=>{throw new Ki(i.evaluate(u))}],typeof:[gi,[fi],(u,[i])=>ys(an(i.evaluate(u)))],"to-rgba":[Wr(xn,4),[Fs],(u,[i])=>i.evaluate(u).toNonPremultipliedRenderColor(null).toArray()],"to-hsla":[Wr(xn,4),[Fs],(u,[i])=>i.evaluate(u).toNonPremultipliedRenderColor(null).toHslaArray()],rgb:[Fs,[xn,xn,xn],ry],rgba:[Fs,[xn,xn,xn,xn],ry],hsl:[Fs,[xn,xn,xn],fg],hsla:[Fs,[xn,xn,xn,xn],fg],has:{type:Di,overloads:[[[gi],(u,[i])=>R0(i.evaluate(u),u.properties())],[[gi,ul],(u,[i,l])=>R0(i.evaluate(u),l.evaluate(u))]]},get:{type:fi,overloads:[[[gi],(u,[i])=>gh(i.evaluate(u),u.properties())],[[gi,ul],(u,[i,l])=>gh(i.evaluate(u),l.evaluate(u))]]},"feature-state":[fi,[gi],(u,[i])=>gh(i.evaluate(u),u.featureState||{})],properties:[ul,[],u=>u.properties()],"geometry-type":[gi,[],u=>u.geometryType()],worldview:[gi,[],u=>u.globals.worldview||""],id:[fi,[],u=>u.id()],zoom:[xn,[],u=>u.globals.zoom],pitch:[xn,[],u=>u.globals.pitch||0],"distance-from-center":[xn,[],u=>u.distanceFromCenter()],"measure-light":[xn,[gi],(u,[i])=>u.measureLight(i.evaluate(u))],"heatmap-density":[xn,[],u=>u.globals.heatmapDensity||0],"line-progress":[xn,[],u=>u.globals.lineProgress||0],"raster-value":[xn,[],u=>u.globals.rasterValue||0],"raster-particle-speed":[xn,[],u=>u.globals.rasterParticleSpeed||0],"sky-radial-progress":[xn,[],u=>u.globals.skyRadialProgress||0],accumulated:[fi,[],u=>u.globals.accumulated===void 0?null:u.globals.accumulated],"+":[xn,zl(xn),(u,i)=>{let l=0;for(const p of i)l+=p.evaluate(u);return l}],"*":[xn,zl(xn),(u,i)=>{let l=1;for(const p of i)l*=p.evaluate(u);return l}],"-":{type:xn,overloads:[[[xn,xn],(u,[i,l])=>i.evaluate(u)-l.evaluate(u)],[[xn],(u,[i])=>-i.evaluate(u)]]},"/":[xn,[xn,xn],(u,[i,l])=>i.evaluate(u)/l.evaluate(u)],"%":[xn,[xn,xn],(u,[i,l])=>i.evaluate(u)%l.evaluate(u)],ln2:[xn,[],()=>Math.LN2],pi:[xn,[],()=>Math.PI],e:[xn,[],()=>Math.E],"^":[xn,[xn,xn],(u,[i,l])=>Math.pow(i.evaluate(u),l.evaluate(u))],sqrt:[xn,[xn],(u,[i])=>Math.sqrt(i.evaluate(u))],log10:[xn,[xn],(u,[i])=>Math.log(i.evaluate(u))/Math.LN10],ln:[xn,[xn],(u,[i])=>Math.log(i.evaluate(u))],log2:[xn,[xn],(u,[i])=>Math.log(i.evaluate(u))/Math.LN2],sin:[xn,[xn],(u,[i])=>Math.sin(i.evaluate(u))],cos:[xn,[xn],(u,[i])=>Math.cos(i.evaluate(u))],tan:[xn,[xn],(u,[i])=>Math.tan(i.evaluate(u))],asin:[xn,[xn],(u,[i])=>Math.asin(i.evaluate(u))],acos:[xn,[xn],(u,[i])=>Math.acos(i.evaluate(u))],atan:[xn,[xn],(u,[i])=>Math.atan(i.evaluate(u))],min:[xn,zl(xn),(u,i)=>Math.min(...i.map(l=>l.evaluate(u)))],max:[xn,zl(xn),(u,i)=>Math.max(...i.map(l=>l.evaluate(u)))],abs:[xn,[xn],(u,[i])=>Math.abs(i.evaluate(u))],round:[xn,[xn],(u,[i])=>{const l=i.evaluate(u);return l<0?-Math.round(-l):Math.round(l)}],floor:[xn,[xn],(u,[i])=>Math.floor(i.evaluate(u))],ceil:[xn,[xn],(u,[i])=>Math.ceil(i.evaluate(u))],"filter-==":[Di,[gi,fi],(u,[i,l])=>u.properties()[i.value]===l.value],"filter-id-==":[Di,[fi],(u,[i])=>u.id()===i.value],"filter-type-==":[Di,[gi],(u,[i])=>u.geometryType()===i.value],"filter-<":[Di,[gi,fi],(u,[i,l])=>{const p=u.properties()[i.value],g=l.value;return typeof p==typeof g&&p<g}],"filter-id-<":[Di,[fi],(u,[i])=>{const l=u.id(),p=i.value;return typeof l==typeof p&&l<p}],"filter->":[Di,[gi,fi],(u,[i,l])=>{const p=u.properties()[i.value],g=l.value;return typeof p==typeof g&&p>g}],"filter-id->":[Di,[fi],(u,[i])=>{const l=u.id(),p=i.value;return typeof l==typeof p&&l>p}],"filter-<=":[Di,[gi,fi],(u,[i,l])=>{const p=u.properties()[i.value],g=l.value;return typeof p==typeof g&&p<=g}],"filter-id-<=":[Di,[fi],(u,[i])=>{const l=u.id(),p=i.value;return typeof l==typeof p&&l<=p}],"filter->=":[Di,[gi,fi],(u,[i,l])=>{const p=u.properties()[i.value],g=l.value;return typeof p==typeof g&&p>=g}],"filter-id->=":[Di,[fi],(u,[i])=>{const l=u.id(),p=i.value;return typeof l==typeof p&&l>=p}],"filter-has":[Di,[fi],(u,[i])=>i.value in u.properties()],"filter-has-id":[Di,[],u=>u.id()!==null&&u.id()!==void 0],"filter-type-in":[Di,[Wr(gi)],(u,[i])=>i.value.indexOf(u.geometryType())>=0],"filter-id-in":[Di,[Wr(fi)],(u,[i])=>i.value.indexOf(u.id())>=0],"filter-in-small":[Di,[gi,Wr(fi)],(u,[i,l])=>l.value.indexOf(u.properties()[i.value])>=0],"filter-in-large":[Di,[gi,Wr(fi)],(u,[i,l])=>function(p,g,b,x){for(;b<=x;){const A=b+x>>1;if(g[A]===p)return!0;g[A]>p?x=A-1:b=A+1}return!1}(u.properties()[i.value],l.value,0,l.value.length-1)],all:{type:Di,overloads:[[[Di,Di],(u,[i,l])=>i.evaluate(u)&&l.evaluate(u)],[zl(Di),(u,i)=>{for(const l of i)if(!l.evaluate(u))return!1;return!0}]]},any:{type:Di,overloads:[[[Di,Di],(u,[i,l])=>i.evaluate(u)||l.evaluate(u)],[zl(Di),(u,i)=>{for(const l of i)if(l.evaluate(u))return!0;return!1}]]},"!":[Di,[Di],(u,[i])=>!i.evaluate(u)],"is-supported-script":[Di,[gi],(u,[i])=>{const l=u.globals&&u.globals.isSupportedScript;return!l||l(i.evaluate(u))}],upcase:[gi,[gi],(u,[i])=>i.evaluate(u).toUpperCase()],downcase:[gi,[gi],(u,[i])=>i.evaluate(u).toLowerCase()],concat:[gi,zl(fi),(u,i)=>i.map(l=>Jr(l.evaluate(u))).join("")],"resolved-locale":[gi,[Jh],(u,[i])=>i.evaluate(u).resolvedLocale()],random:[xn,[xn,xn,fi],(u,i)=>{const[l,p,g]=i.map(x=>x.evaluate(u));if(l>p||l===p)return l;let b;if(typeof g=="string")b=function(x){let A=0;if(x.length===0)return A;for(let R=0;R<x.length;R++)A=(A<<5)-A+x.charCodeAt(R),A|=0;return A}(g);else{if(typeof g!="number")throw new Ki(`Invalid seed input: ${g}`);b=g}return l+iy(b)()*(p-l)}]});class _h{constructor(i,l,p,g){this.expression=i,this._warningHistory={},this._evaluator=new ah(p,g),this._defaultValue=l?function(b){return b.type==="color"&&(ad(b.default)||Array.isArray(b.default))?new Mi(0,0,0,0):b.type==="color"?Mi.parse(b.default)||null:b.default===void 0?null:b.default}(l):null,this._enumValues=l&&l.type==="enum"?l.values:null,this.configDependencies=Su(i)}evaluateWithoutErrorHandling(i,l,p,g,b,x,A,R){return this._evaluator.globals=i,this._evaluator.feature=l,this._evaluator.featureState=p,this._evaluator.canonical=g||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=R||null,this.expression.evaluate(this._evaluator)}evaluate(i,l,p,g,b,x,A,R){this._evaluator.globals=i,this._evaluator.feature=l||null,this._evaluator.featureState=p||null,this._evaluator.canonical=g||null,this._evaluator.availableImages=b||null,this._evaluator.formattedSection=x||null,this._evaluator.featureTileCoord=A||null,this._evaluator.featureDistanceData=R||null;try{const O=this.expression.evaluate(this._evaluator);if(O==null||typeof O=="number"&&O!=O)return this._defaultValue;if(this._enumValues&&!(O in this._enumValues))throw new Ki(`Expected value to be one of ${Object.keys(this._enumValues).map(L=>JSON.stringify(L)).join(", ")}, but found ${JSON.stringify(O)} instead.`);return O}catch(O){return this._warningHistory[O.message]||(this._warningHistory[O.message]=!0,typeof console<"u"&&console.warn(`Failed to evaluate expression "${JSON.stringify(this.expression.serialize())}". ${O.message}`)),this._defaultValue}}}function Ef(u){return Array.isArray(u)&&u.length>0&&typeof u[0]=="string"&&u[0]in od}function Mu(u,i,l,p){const g=new _f(od,[],i?function(x){const A={color:Fs,string:gi,number:xn,enum:gi,boolean:Di,formatted:Qc,resolvedImage:ba};return x.type==="array"?Wr(A[x.value]||fi,x.length):A[x.type]}(i):void 0,void 0,void 0,l,p),b=g.parse(u,void 0,void 0,void 0,i&&i.type==="string"?{typeAnnotation:"coerce"}:void 0);return b?sy(new _h(b,i,l,p)):Iu(g.errors)}class lc{constructor(i,l,p,g){this.kind=i,this._styleExpression=l,this.isLightConstant=p,this.isLineProgressConstant=g,this.isStateDependent=i!=="constant"&&!eu(l.expression),this.configDependencies=Su(l.expression)}evaluateWithoutErrorHandling(i,l,p,g,b,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,b,x)}evaluate(i,l,p,g,b,x){return this._styleExpression.evaluate(i,l,p,g,b,x)}}class Np{constructor(i,l,p,g,b,x){this.kind=i,this.zoomStops=p,this._styleExpression=l,this.isStateDependent=i!=="camera"&&!eu(l.expression),this.isLightConstant=b,this.isLineProgressConstant=x,this.configDependencies=Su(l.expression),this.interpolationType=g}evaluateWithoutErrorHandling(i,l,p,g,b,x){return this._styleExpression.evaluateWithoutErrorHandling(i,l,p,g,b,x)}evaluate(i,l,p,g,b,x){return this._styleExpression.evaluate(i,l,p,g,b,x)}interpolationFactor(i,l,p){return this.interpolationType?Ll.interpolationFactor(this.interpolationType,i,l,p):0}}function yh(u,i,l,p){if((u=Mu(u,i,l,p)).result==="error")return u;const g=u.value.expression,b=Eu(g);if(!b&&!pg(i))return Iu([new $o("","data expressions not supported")]);const x=Ea(g,["zoom","pitch","distance-from-center"]);if(!x&&!xf(i))return Iu([new $o("","zoom expressions not supported")]);const A=Ea(g,["measure-light"]);if(!A&&!ay(i))return Iu([new $o("","measure-light expression not supported")]);const R=Ea(g,["line-progress"]);if(!R&&!function(B){return oy(B.expression,"line-progress")}(i))return Iu([new $o("","line-progress expression not supported")]);const O=i.expression&&i.expression.relaxZoomRestriction,L=vh(g);return L||x||O?L instanceof $o?Iu([L]):L instanceof Ll&&!wf(i)?Iu([new $o("",'"interpolate" expressions cannot be used with this property')]):sy(L?new Np(b&&R?"camera":"composite",u.value,L.labels,L instanceof Ll?L.interpolation:void 0,A,R):new lc(b&&R?"constant":"source",u.value,A,R)):Iu([new $o("",'"zoom" expression may only be used as input to a top-level "step" or "interpolate" expression, or in the properties of atmosphere.')])}class dl{constructor(i,l){this._parameters=i,this._specification=l,ic(this,I0(this._parameters,this._specification))}static deserialize(i){return new dl(i._parameters,i._specification)}static serialize(i){return{_parameters:i._parameters,_specification:i._specification}}}function vh(u){let i=null;if(u instanceof vf)i=vh(u.result);else if(u instanceof Ru){for(const l of u.args)if(i=vh(l),i)break}else(u instanceof kp||u instanceof Ll)&&u.input instanceof fo&&u.input.name==="zoom"&&(i=u);return i instanceof $o||u.eachChild(l=>{const p=vh(l);p instanceof $o?i=p:i&&p&&i!==p&&(i=new $o("",'Only one zoom-based "step" or "interpolate" subexpression may be used in an expression.'))}),i}var Lp,mg,hy=function(){if(mg)return Lp;mg=1,Lp=i;var u=3;function i(l,p,g){var b=this.cells=[];if(l instanceof ArrayBuffer){this.arrayBuffer=l;var x=new Int32Array(this.arrayBuffer);l=x[0],this.d=(p=x[1])+2*(g=x[2]);for(var A=0;A<this.d*this.d;A++){var R=x[u+A],O=x[u+A+1];b.push(R===O?null:x.subarray(R,O))}var L=x[u+b.length+1];this.keys=x.subarray(x[u+b.length],L),this.bboxes=x.subarray(L),this.insert=this._insertReadonly}else{this.d=p+2*g;for(var B=0;B<this.d*this.d;B++)b.push([]);this.keys=[],this.bboxes=[]}this.n=p,this.extent=l,this.padding=g,this.scale=p/l,this.uid=0;var U=g/p*l;this.min=-U,this.max=l+U}return i.prototype.insert=function(l,p,g,b,x){this._forEachCell(p,g,b,x,this._insertCell,this.uid++),this.keys.push(l),this.bboxes.push(p),this.bboxes.push(g),this.bboxes.push(b),this.bboxes.push(x)},i.prototype._insertReadonly=function(){throw"Cannot insert into a GridIndex created from an ArrayBuffer."},i.prototype._insertCell=function(l,p,g,b,x,A){this.cells[x].push(A)},i.prototype.query=function(l,p,g,b,x){var A=this.min,R=this.max;if(l<=A&&p<=A&&R<=g&&R<=b&&!x)return Array.prototype.slice.call(this.keys);var O=[];return this._forEachCell(l,p,g,b,this._queryCell,O,{},x),O},i.prototype._queryCell=function(l,p,g,b,x,A,R,O){var L=this.cells[x];if(L!==null)for(var B=this.keys,U=this.bboxes,q=0;q<L.length;q++){var Y=L[q];if(R[Y]===void 0){var ne=4*Y;(O?O(U[ne+0],U[ne+1],U[ne+2],U[ne+3]):l<=U[ne+2]&&p<=U[ne+3]&&g>=U[ne+0]&&b>=U[ne+1])?(R[Y]=!0,A.push(B[Y])):R[Y]=!1}}},i.prototype._forEachCell=function(l,p,g,b,x,A,R,O){for(var L=this._convertToCellCoord(l),B=this._convertToCellCoord(p),U=this._convertToCellCoord(g),q=this._convertToCellCoord(b),Y=L;Y<=U;Y++)for(var ne=B;ne<=q;ne++){var ae=this.d*ne+Y;if((!O||O(this._convertFromCellCoord(Y),this._convertFromCellCoord(ne),this._convertFromCellCoord(Y+1),this._convertFromCellCoord(ne+1)))&&x.call(this,l,p,g,b,ae,A,R,O))return}},i.prototype._convertFromCellCoord=function(l){return(l-this.padding)/this.scale},i.prototype._convertToCellCoord=function(l){return Math.max(0,Math.min(this.d-1,Math.floor(l*this.scale)+this.padding))},i.prototype.toArrayBuffer=function(){if(this.arrayBuffer)return this.arrayBuffer;for(var l=this.cells,p=u+this.cells.length+1+1,g=0,b=0;b<this.cells.length;b++)g+=this.cells[b].length;var x=new Int32Array(p+g+this.keys.length+this.bboxes.length);x[0]=this.extent,x[1]=this.n,x[2]=this.padding;for(var A=p,R=0;R<l.length;R++){var O=l[R];x[u+R]=A,x.set(O,A),A+=O.length}return x[u+l.length]=A,x.set(this.keys,A),x[u+l.length+1]=A+=this.keys.length,x.set(this.bboxes,A),A+=this.bboxes.length,x.buffer},Lp}(),Pu=Pn(hy);const Xa={};function vn(u,i,l={}){Object.defineProperty(u,"_classRegistryKey",{value:i,writable:!1}),Xa[i]={klass:u,omit:l.omit||[]}}vn(Object,"Object"),Pu.serialize=function(u,i){const l=u.toArrayBuffer();return i&&i.add(l),{buffer:l}},Pu.deserialize=function(u){return new Pu(u.buffer)},Object.defineProperty(Pu,"name",{value:"Grid"}),vn(Pu,"Grid"),typeof DOMMatrix<"u"&&vn(DOMMatrix,"DOMMatrix"),vn(Mi,"Color"),vn(Error,"Error"),vn($t,"Formatted"),vn(Vt,"FormattedSection"),vn(Si,"AJAXError"),vn(Hi,"ResolvedImage"),vn(dl,"StylePropertyFunction"),vn(_h,"StyleExpression",{omit:["_evaluator"]}),vn(ra,"ImageId"),vn(Ln,"ImageVariant"),vn(Np,"ZoomDependentExpression"),vn(lc,"ZoomConstantExpression"),vn(fo,"CompoundExpression",{omit:["_evaluate"]});for(const u in od)Xa[od[u]._classRegistryKey]||vn(od[u],`Expression${u}`);function M0(u){return u&&typeof ArrayBuffer<"u"&&(u instanceof ArrayBuffer||u.constructor&&u.constructor.name==="ArrayBuffer")}function P0(u){return self.ImageBitmap&&u instanceof ImageBitmap}function tu(u,i){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp)return u;if(M0(u)||P0(u))return i&&i.add(u),u;if(ArrayBuffer.isView(u))return i&&i.add(u.buffer),u;if(u instanceof ImageData)return i&&i.add(u.data.buffer),u;if(Array.isArray(u)){const l=[];for(const p of u)l.push(tu(p,i));return l}if(u instanceof Map){const l={$name:"Map",entries:[]};for(const[p,g]of u.entries())l.entries.push(tu(p),tu(g,i));return l}if(u instanceof Set){const l={$name:"Set"};let p=0;for(const g of u.values())l[++p]=tu(g);return l}if(u instanceof DOMMatrix){const l={$name:"DOMMatrix"},p=["is2D","m11","m12","m13","m14","m21","m22","m23","m24","m31","m32","m33","m34","m41","m42","m43","m44","a","b","c","d","e","f"];for(const g of p)l[g]=u[g];return l}if(typeof u=="bigint")return{$name:"BigInt",value:u.toString()};if(typeof u=="object"){const l=u.constructor,p=l._classRegistryKey;if(!p)throw new Error(`Can't serialize object of unregistered class "${l.name}".`);const g=l.serialize?l.serialize(u,i):{};if(!l.serialize){for(const b in u)u.hasOwnProperty(b)&&(Xa[p].omit.indexOf(b)>=0||(g[b]=tu(u[b],i)));u instanceof Error&&(g.message=u.message)}if(g.$name)throw new Error("$name property is reserved for worker serialization logic.");return p!=="Object"&&(g.$name=p),g}throw new Error("can't serialize object of type "+typeof u)}function bh(u){if(u==null||typeof u=="boolean"||typeof u=="number"||typeof u=="string"||u instanceof Boolean||u instanceof Number||u instanceof String||u instanceof Date||u instanceof RegExp||M0(u)||P0(u)||ArrayBuffer.isView(u)||u instanceof ImageData)return u;if(Array.isArray(u))return u.map(bh);if(typeof u=="object"){const i=u.$name||"Object";if(i==="Map"){const g=u.entries||[],b=new Map;for(let x=0;x<g.length;x+=2)b.set(bh(g[x]),bh(g[x+1]));return b}if(i==="Set"){const g=new Set;for(const b of Object.keys(u))b!=="$name"&&g.add(bh(u[b]));return g}if(i==="DOMMatrix"){let g;return g=u.is2D?[u.a,u.b,u.c,u.d,u.e,u.f]:[u.m11,u.m12,u.m13,u.m14,u.m21,u.m22,u.m23,u.m24,u.m31,u.m32,u.m33,u.m34,u.m41,u.m42,u.m43,u.m44],new DOMMatrix(g)}if(i==="BigInt")return BigInt(u.value);const{klass:l}=Xa[i];if(!l)throw new Error(`Can't deserialize unregistered class "${i}".`);if(l.deserialize)return l.deserialize(u);const p=Object.create(l.prototype);for(const g of Object.keys(u))g!=="$name"&&(p[g]=bh(u[g]));return p}throw new Error("can't deserialize object of type "+typeof u)}const Fn={"Latin-1 Supplement":u=>u>=128&&u<=255,Arabic:u=>u>=1536&&u<=1791,"Arabic Supplement":u=>u>=1872&&u<=1919,"Arabic Extended-A":u=>u>=2208&&u<=2303,"Hangul Jamo":u=>u>=4352&&u<=4607,"Unified Canadian Aboriginal Syllabics":u=>u>=5120&&u<=5759,Khmer:u=>u>=6016&&u<=6143,"Unified Canadian Aboriginal Syllabics Extended":u=>u>=6320&&u<=6399,"General Punctuation":u=>u>=8192&&u<=8303,"Letterlike Symbols":u=>u>=8448&&u<=8527,"Number Forms":u=>u>=8528&&u<=8591,"Miscellaneous Technical":u=>u>=8960&&u<=9215,"Control Pictures":u=>u>=9216&&u<=9279,"Optical Character Recognition":u=>u>=9280&&u<=9311,"Enclosed Alphanumerics":u=>u>=9312&&u<=9471,"Geometric Shapes":u=>u>=9632&&u<=9727,"Miscellaneous Symbols":u=>u>=9728&&u<=9983,"Miscellaneous Symbols and Arrows":u=>u>=11008&&u<=11263,"CJK Radicals Supplement":u=>u>=11904&&u<=12031,"Kangxi Radicals":u=>u>=12032&&u<=12255,"Ideographic Description Characters":u=>u>=12272&&u<=12287,"CJK Symbols and Punctuation":u=>u>=12288&&u<=12351,Hiragana:u=>u>=12352&&u<=12447,Katakana:u=>u>=12448&&u<=12543,Bopomofo:u=>u>=12544&&u<=12591,"Hangul Compatibility Jamo":u=>u>=12592&&u<=12687,Kanbun:u=>u>=12688&&u<=12703,"Bopomofo Extended":u=>u>=12704&&u<=12735,"CJK Strokes":u=>u>=12736&&u<=12783,"Katakana Phonetic Extensions":u=>u>=12784&&u<=12799,"Enclosed CJK Letters and Months":u=>u>=12800&&u<=13055,"CJK Compatibility":u=>u>=13056&&u<=13311,"CJK Unified Ideographs Extension A":u=>u>=13312&&u<=19903,"Yijing Hexagram Symbols":u=>u>=19904&&u<=19967,"CJK Unified Ideographs":u=>u>=19968&&u<=40959,"Yi Syllables":u=>u>=40960&&u<=42127,"Yi Radicals":u=>u>=42128&&u<=42191,"Hangul Jamo Extended-A":u=>u>=43360&&u<=43391,"Hangul Syllables":u=>u>=44032&&u<=55215,"Hangul Jamo Extended-B":u=>u>=55216&&u<=55295,"Private Use Area":u=>u>=57344&&u<=63743,"CJK Compatibility Ideographs":u=>u>=63744&&u<=64255,"Arabic Presentation Forms-A":u=>u>=64336&&u<=65023,"Vertical Forms":u=>u>=65040&&u<=65055,"CJK Compatibility Forms":u=>u>=65072&&u<=65103,"Small Form Variants":u=>u>=65104&&u<=65135,"Arabic Presentation Forms-B":u=>u>=65136&&u<=65279,"Halfwidth and Fullwidth Forms":u=>u>=65280&&u<=65519,Osage:u=>u>=66736&&u<=66815,"CJK Unified Ideographs Extension B":u=>u>=131072&&u<=173791};function Sf(u){for(const i of u)if(ko(i.charCodeAt(0)))return!0;return!1}function k0(u){for(const i of u)if(!DT(i.charCodeAt(0)))return!1;return!0}function DT(u){return!(Fn.Arabic(u)||Fn["Arabic Supplement"](u)||Fn["Arabic Extended-A"](u)||Fn["Arabic Presentation Forms-A"](u)||Fn["Arabic Presentation Forms-B"](u))}function ko(u){return!(u!==746&&u!==747&&(u<4352||!(Fn["Bopomofo Extended"](u)||Fn.Bopomofo(u)||Fn["CJK Compatibility Forms"](u)&&!(u>=65097&&u<=65103)||Fn["CJK Compatibility Ideographs"](u)||Fn["CJK Compatibility"](u)||Fn["CJK Radicals Supplement"](u)||Fn["CJK Strokes"](u)||!(!Fn["CJK Symbols and Punctuation"](u)||u>=12296&&u<=12305||u>=12308&&u<=12319||u===12336)||Fn["CJK Unified Ideographs Extension A"](u)||Fn["CJK Unified Ideographs"](u)||Fn["Enclosed CJK Letters and Months"](u)||Fn["Hangul Compatibility Jamo"](u)||Fn["Hangul Jamo Extended-A"](u)||Fn["Hangul Jamo Extended-B"](u)||Fn["Hangul Jamo"](u)||Fn["Hangul Syllables"](u)||Fn.Hiragana(u)||Fn["Ideographic Description Characters"](u)||Fn.Kanbun(u)||Fn["Kangxi Radicals"](u)||Fn["Katakana Phonetic Extensions"](u)||Fn.Katakana(u)&&u!==12540||!(!Fn["Halfwidth and Fullwidth Forms"](u)||u===65288||u===65289||u===65293||u>=65306&&u<=65310||u===65339||u===65341||u===65343||u>=65371&&u<=65503||u===65507||u>=65512&&u<=65519)||!(!Fn["Small Form Variants"](u)||u>=65112&&u<=65118||u>=65123&&u<=65126)||Fn["Unified Canadian Aboriginal Syllabics"](u)||Fn["Unified Canadian Aboriginal Syllabics Extended"](u)||Fn["Vertical Forms"](u)||Fn["Yijing Hexagram Symbols"](u)||Fn["Yi Syllables"](u)||Fn["Yi Radicals"](u))))}function N0(u){return!(ko(u)||function(i){return!!(Fn["Latin-1 Supplement"](i)&&(i===167||i===169||i===174||i===177||i===188||i===189||i===190||i===215||i===247)||Fn["General Punctuation"](i)&&(i===8214||i===8224||i===8225||i===8240||i===8241||i===8251||i===8252||i===8258||i===8263||i===8264||i===8265||i===8273)||Fn["Letterlike Symbols"](i)||Fn["Number Forms"](i)||Fn["Miscellaneous Technical"](i)&&(i>=8960&&i<=8967||i>=8972&&i<=8991||i>=8996&&i<=9e3||i===9003||i>=9085&&i<=9114||i>=9150&&i<=9165||i===9167||i>=9169&&i<=9179||i>=9186&&i<=9215)||Fn["Control Pictures"](i)&&i!==9251||Fn["Optical Character Recognition"](i)||Fn["Enclosed Alphanumerics"](i)||Fn["Geometric Shapes"](i)||Fn["Miscellaneous Symbols"](i)&&!(i>=9754&&i<=9759)||Fn["Miscellaneous Symbols and Arrows"](i)&&(i>=11026&&i<=11055||i>=11088&&i<=11097||i>=11192&&i<=11243)||Fn["CJK Symbols and Punctuation"](i)||Fn.Katakana(i)||Fn["Private Use Area"](i)||Fn["CJK Compatibility Forms"](i)||Fn["Small Form Variants"](i)||Fn["Halfwidth and Fullwidth Forms"](i)||i===8734||i===8756||i===8757||i>=9984&&i<=10087||i>=10102&&i<=10131||i===65532||i===65533)}(u))}function $x(u){return Fn.Arabic(u)||Fn["Arabic Supplement"](u)||Fn["Arabic Extended-A"](u)||Fn["Arabic Presentation Forms-A"](u)||Fn["Arabic Presentation Forms-B"](u)}function L0(u){return u>=1424&&u<=2303||Fn["Arabic Presentation Forms-A"](u)||Fn["Arabic Presentation Forms-B"](u)}function Gx(u,i){return!(!i&&L0(u)||u>=2304&&u<=3583||u>=3840&&u<=4255||Fn.Khmer(u))}function qx(u){for(const i of u)if(L0(i.charCodeAt(0)))return!0;return!1}const ca={unavailable:"unavailable",deferred:"deferred",loading:"loading",parsing:"parsing",parsed:"parsed",loaded:"loaded",error:"error"};let gg=null,ua=ca.unavailable,ku=null;const ld=function(u){u&&typeof u=="string"&&u.indexOf("NetworkError")>-1&&(ua=ca.error),gg&&gg(u)};function zp(){Bp.fire(new Wc("pluginStateChange",{pluginStatus:ua,pluginURL:ku}))}const Bp=new Yc,cd=function(){return ua},z0=function(){if(ua!==ca.deferred||!ku)throw new Error("rtl-text-plugin cannot be downloaded unless a pluginURL is specified");ua=ca.loading,zp(),ku&&qc({url:ku},u=>{u?ld(u):(ua=ca.loaded,zp())})},nu={applyArabicShaping:null,processBidirectionalText:null,processStyledBidirectionalText:null,isLoaded:()=>ua===ca.loaded||nu.applyArabicShaping!=null,isLoading:()=>ua===ca.loading,setState(u){ua=u.pluginStatus,ku=u.pluginURL},isParsing:()=>ua===ca.parsing,isParsed:()=>ua===ca.parsed,getPluginURL:()=>ku};class $i{constructor(i,l){this.zoom=i,l?(this.now=l.now,this.fadeDuration=l.fadeDuration,this.transition=l.transition,this.pitch=l.pitch,this.brightness=l.brightness,this.worldview=l.worldview):(this.now=0,this.fadeDuration=0,this.transition={},this.pitch=0,this.brightness=0)}isSupportedScript(i){return function(l,p){for(const g of l)if(!Gx(g.charCodeAt(0),p))return!1;return!0}(i,nu.isLoaded())}}class Af{constructor(i,l,p,g){this.property=i,this.value=l,this.expression=function(b,x,A,R){if(ad(b))return new dl(b,x);if(Ef(b)||Array.isArray(b)&&b.length>0){const O=yh(b,x,A,R);if(O.result==="error")throw new Error(O.value.map(L=>`${L.key}: ${L.message}`).join(", "));return O.value}{let O=b;return typeof b=="string"&&x.type==="color"&&(O=Mi.parse(b)),{kind:"constant",configDependencies:new Set,evaluate:()=>O}}}(l===void 0?i.specification.default:l,i.specification,p,g)}isDataDriven(){return this.expression.kind==="source"||this.expression.kind==="composite"}possiblyEvaluate(i,l,p){return this.property.possiblyEvaluate(this,i,l,p)}}class xh{constructor(i,l,p){this.property=i,this.value=new Af(i,void 0,l,p)}transitioned(i,l){return new dy(this.property,this.value,l,vt({},i.transition,this.transition),i.now)}untransitioned(){return new dy(this.property,this.value,null,{},0)}}class B0{constructor(i,l,p){this._properties=i,this._values=Object.create(i.defaultTransitionablePropertyValues),this._scope=l,this._options=p,this.configDependencies=new Set}getValue(i){return Vn(this._values[i].value.value)}setValue(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new xh(this._values[i].property,this._scope,this._options)),this._values[i].value=new Af(this._values[i].property,l===null?void 0:Vn(l),this._scope,this._options),this._values[i].value.expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].value.expression.configDependencies]))}setTransitionOrValue(i,l){l&&(this._options=l);const p=this._properties.properties;if(i)for(const g in i){const b=i[g];if(g.endsWith("-transition")){const x=g.slice(0,-11);p[x]&&this.setTransition(x,b)}else p.hasOwnProperty(g)&&this.setValue(g,b)}}getTransition(i){return Vn(this._values[i].transition)}setTransition(i,l){this._values.hasOwnProperty(i)||(this._values[i]=new xh(this._values[i].property)),this._values[i].transition=Vn(l)||void 0}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p);const g=this.getTransition(l);g!==void 0&&(i[`${l}-transition`]=g)}return i}transitioned(i,l){const p=new F0(this._properties);for(const g of Object.keys(this._values))p._values[g]=this._values[g].transitioned(i,l._values[g]);return p}untransitioned(){const i=new F0(this._properties);for(const l of Object.keys(this._values))i._values[l]=this._values[l].untransitioned();return i}}class dy{constructor(i,l,p,g,b){const x=g.delay||0,A=g.duration||0;b=b||0,this.property=i,this.value=l,this.begin=b+x,this.end=this.begin+A,i.specification.transition&&(g.delay||g.duration)&&(this.prior=p)}possiblyEvaluate(i,l,p){const g=i.now||0,b=this.value.possiblyEvaluate(i,l,p),x=this.prior;if(x){if(g>this.end)return this.prior=null,b;if(this.value.isDataDriven())return this.prior=null,b;if(g<this.begin)return x.possiblyEvaluate(i,l,p);{const A=(g-this.begin)/(this.end-this.begin);return this.property.interpolate(x.possiblyEvaluate(i,l,p),b,ve(A))}}return b}}class F0{constructor(i){this._properties=i,this._values=Object.create(i.defaultTransitioningPropertyValues)}possiblyEvaluate(i,l,p){const g=new Cf(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(i,l,p);return g}hasTransition(){for(const i of Object.keys(this._values))if(this._values[i].prior)return!0;return!1}}class wh{constructor(i,l,p){this._properties=i,this._values=Object.create(i.defaultPropertyValues),this._scope=l,this._options=p,this.configDependencies=new Set}getValue(i){return Vn(this._values[i].value)}setValue(i,l){this._values[i]=new Af(this._values[i].property,l===null?void 0:Vn(l),this._scope,this._options),this._values[i].expression.configDependencies&&(this.configDependencies=new Set([...this.configDependencies,...this._values[i].expression.configDependencies]))}serialize(){const i={};for(const l of Object.keys(this._values)){const p=this.getValue(l);p!==void 0&&(i[l]=p)}return i}possiblyEvaluate(i,l,p){const g=new Cf(this._properties);for(const b of Object.keys(this._values))g._values[b]=this._values[b].possiblyEvaluate(i,l,p);return g}}class ud{constructor(i,l,p){this.property=i,this.value=l,this.parameters=p}isConstant(){return this.value.kind==="constant"}constantOr(i){return this.value.kind==="constant"?this.value.value:i}evaluate(i,l,p,g){return this.property.evaluate(this.value,this.parameters,i,l,p,g)}}class Cf{constructor(i){this._properties=i,this._values=Object.create(i.defaultPossiblyEvaluatedValues)}get(i){return this._values[i]}}class Gt{constructor(i){this.specification=i}possiblyEvaluate(i,l){return i.expression.evaluate(l)}interpolate(i,l,p){const g=sh[this.specification.type];return g?g(i,l,p):i}}class cn{constructor(i,l){this.specification=i,this.overrides=l}possiblyEvaluate(i,l,p,g){return new ud(this,i.expression.kind==="constant"||i.expression.kind==="camera"?{kind:"constant",value:i.expression.evaluate(l,null,{},p,g)}:i.expression,l)}interpolate(i,l,p){if(i.value.kind!=="constant"||l.value.kind!=="constant")return i;if(i.value.value===void 0||l.value.value===void 0)return new ud(this,{kind:"constant",value:void 0},i.parameters);const g=sh[this.specification.type];return g?new ud(this,{kind:"constant",value:g(i.value.value,l.value.value,p)},i.parameters):i}evaluate(i,l,p,g,b,x){return i.kind==="constant"?i.value:i.evaluate(l,p,g,b,x)}}class hd{constructor(i){this.specification=i}possiblyEvaluate(i,l,p,g){return!!i.expression.evaluate(l,null,{},p,g)}interpolate(){return!1}}class Lr{constructor(i){this.properties=i,this.defaultPropertyValues={},this.defaultTransitionablePropertyValues={},this.defaultTransitioningPropertyValues={},this.defaultPossiblyEvaluatedValues={},this.overridableProperties=[];const l=new $i(0,{});for(const p in i){const g=i[p];g.specification.overridable&&this.overridableProperties.push(p);const b=this.defaultPropertyValues[p]=new Af(g,void 0),x=this.defaultTransitionablePropertyValues[p]=new xh(g);this.defaultTransitioningPropertyValues[p]=x.untransitioned(),this.defaultPossiblyEvaluatedValues[p]=b.possiblyEvaluate(l)}}}vn(cn,"DataDrivenProperty"),vn(Gt,"DataConstantProperty"),vn(hd,"ColorRampProperty");var pt=JSON.parse('{"$version":8,"$root":{"version":{"type":"enum","values":[8]},"fragment":{"type":"boolean"},"name":{"type":"string"},"metadata":{"type":"*"},"center":{"type":"array","value":"number"},"zoom":{"type":"number"},"bearing":{"type":"number","default":0,"period":360},"pitch":{"type":"number","default":0},"light":{"type":"light"},"lights":{"type":"array","value":"light-3d"},"terrain":{"type":"terrain","optional":true},"fog":{"type":"fog"},"snow":{"type":"snow"},"rain":{"type":"rain"},"camera":{"type":"camera"},"color-theme":{"type":"colorTheme"},"indoor":{"type":"indoor"},"imports":{"type":"array","value":"import"},"iconsets":{"type":"iconsets"},"schema":{"type":"schema"},"sources":{"type":"sources"},"sprite":{"type":"string"},"glyphs":{"type":"string","default":"mapbox://fonts/mapbox/{fontstack}/{range}.pbf"},"transition":{"type":"transition"},"projection":{"type":"projection"},"layers":{"type":"array","value":"layer"},"models":{"type":"models"},"featuresets":{"type":"featuresets"}},"featuresets":{"*":{"type":"featureset"}},"featureset":{"metadata":{"type":"*"},"selectors":{"type":"array","value":"selector"}},"selector":{"layer":{"type":"string"},"properties":{"type":"selectorProperty"},"featureNamespace":{"type":"string"},"_uniqueFeatureID":{"type":"boolean"}},"selectorProperty":{"*":{"type":"*"}},"model":{"type":"string"},"import":{"id":{"type":"string"},"url":{"type":"string"},"config":{"type":"config"},"data":{"type":"$root"},"color-theme":{"type":"colorTheme","optional":true}},"config":{"*":{"type":"*"}},"schema":{"*":{"type":"option"}},"option":{"default":{"type":"*","expression":{}},"type":{"type":"enum","values":{"string":1,"number":1,"boolean":1,"color":1}},"array":{"type":"boolean"},"minValue":{"type":"number"},"maxValue":{"type":"number"},"stepValue":{"type":"number"},"values":{"type":"array","value":"*"},"metadata":{"type":"*"}},"models":{"*":{"type":"model"}},"light-3d":{"id":{"type":"string"},"properties":{"type":"properties"},"type":{"type":"enum","values":{"ambient":{},"directional":{},"flat":{}}}},"properties":["properties_light_directional","properties_light_ambient","properties_light_flat"],"properties_light_directional":{"direction":{"type":"array","default":[210,30],"minimum":[0,0],"maximum":[360,90],"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"cast-shadows":{"type":"boolean","default":false},"shadow-quality":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"parameters":["zoom"]}},"shadow-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_ambient":{"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"properties_light_flat":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"iconsets":{"*":{"type":"iconset"}},"iconset":["iconset_sprite","iconset_source"],"iconset_sprite":{"type":{"type":"enum","values":{"sprite":1}},"url":{"type":"string"}},"iconset_source":{"type":{"type":"enum","values":{"source":1}},"source":{"type":"string"}},"sources":{"*":{"type":"source"}},"source":["source_vector","source_raster","source_raster_dem","source_raster_array","source_geojson","source_video","source_image","source_model"],"source_vector":{"type":{"type":"enum","values":{"vector":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"attribution":{"type":"string"},"promoteId":{"type":"promoteId"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster":{"type":{"type":"enum","values":{"raster":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"scheme":{"type":"enum","values":{"xyz":1,"tms":1},"default":"xyz"},"attribution":{"type":"string"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_dem":{"type":{"type":"enum","values":{"raster-dem":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"encoding":{"type":"enum","values":{"terrarium":1,"mapbox":1},"default":"mapbox"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_raster_array":{"type":{"type":"enum","values":{"raster-array":1}},"url":{"type":"string"},"tiles":{"type":"array","value":"string"},"bounds":{"type":"array","value":"number","length":4,"default":[-180,-85.051129,180,85.051129]},"extra_bounds":{"type":"array","value":{"type":"array","value":"number","length":4}},"minzoom":{"type":"number","default":0},"maxzoom":{"type":"number","default":22},"tileSize":{"type":"number","default":512},"attribution":{"type":"string"},"rasterLayers":{"type":"*"},"volatile":{"type":"boolean","default":false},"*":{"type":"*"}},"source_geojson":{"type":{"type":"enum","values":{"geojson":1}},"data":{"type":"*"},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"attribution":{"type":"string"},"buffer":{"type":"number","default":128,"maximum":512,"minimum":0},"filter":{"type":"*"},"tolerance":{"type":"number","default":0.375},"cluster":{"type":"boolean","default":false},"clusterRadius":{"type":"number","default":50,"minimum":0},"clusterMaxZoom":{"type":"number"},"clusterMinPoints":{"type":"number"},"clusterProperties":{"type":"*"},"lineMetrics":{"type":"boolean","default":false},"generateId":{"type":"boolean","default":false},"promoteId":{"type":"promoteId"},"dynamic":{"type":"boolean","default":false}},"source_video":{"type":{"type":"enum","values":{"video":1}},"urls":{"type":"array","value":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_image":{"type":{"type":"enum","values":{"image":1}},"url":{"type":"string"},"coordinates":{"type":"array","length":4,"value":{"type":"array","length":2,"value":"number"}}},"source_model":{"type":{"type":"enum","values":{"model":1,"batched-model":1}},"maxzoom":{"type":"number","default":18},"minzoom":{"type":"number","default":0},"tiles":{"type":"array","value":"string"}},"layer":{"id":{"type":"string"},"type":{"type":"enum","values":{"fill":{},"line":{},"symbol":{},"circle":{},"heatmap":{},"fill-extrusion":{},"building":{},"raster":{},"raster-particle":{},"hillshade":{},"model":{},"background":{},"sky":{},"slot":{},"clip":{}}},"metadata":{"type":"*"},"source":{"type":"string"},"source-layer":{"type":"string"},"slot":{"type":"string"},"minzoom":{"type":"number","minimum":0,"maximum":24},"maxzoom":{"type":"number","minimum":0,"maximum":24},"filter":{"type":"filter"},"layout":{"type":"layout"},"paint":{"type":"paint"}},"layout":["layout_clip","layout_fill","layout_line","layout_circle","layout_heatmap","layout_fill-extrusion","layout_building","layout_symbol","layout_raster","layout_raster-particle","layout_hillshade","layout_background","layout_sky","layout_model"],"layout_background":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_sky":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_model":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"model-id":{"type":"string","default":"","property-type":"data-driven","expression":{"parameters":["zoom","feature"]}}},"layout_clip":{"clip-layer-types":{"type":"array","value":"enum","values":{"model":1,"symbol":1},"default":[],"expression":{}},"clip-layer-scope":{"type":"array","value":"string","default":[],"expression":{}}},"layout_fill":{"fill-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-base":1,"hd-road-markup":1},"default":"none","expression":{}},"fill-construct-bridge-guard-rail":{"type":"boolean","default":"true","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"}},"layout_circle":{"circle-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"circle-elevation-reference":{"type":"enum","values":{"none":1,"hd-road-markup":1},"default":"none","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_heatmap":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_fill-extrusion":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"fill-extrusion-edge-radius":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}}},"layout_building":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"building-roof-shape":{"type":"enum","values":{"flat":1,"hipped":1,"gabled":1,"parapet":1,"mansard":1,"skillion":1,"pyramidal":1},"default":"flat","expression":{"parameters":["feature"]},"property-type":"data-driven"},"building-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"},"building-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{},"property-type":"data-driven"}},"layout_line":{"line-cap":{"type":"enum","values":{"butt":1,"round":1,"square":1},"default":"butt","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-join":{"type":"enum","values":{"bevel":1,"round":1,"miter":1,"none":1},"default":"miter","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-miter-limit":{"type":"number","default":2,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-round-limit":{"type":"number","default":1.05,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-z-offset":{"type":"number","default":0,"expression":{"parameters":["zoom","feature","line-progress"]},"property-type":"data-driven"},"line-elevation-reference":{"type":"enum","values":{"none":1,"sea":1,"ground":1,"hd-road-markup":1},"default":"none","expression":{}},"line-cross-slope":{"type":"number","expression":{}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}},"line-width-unit":{"type":"enum","values":{"pixels":1,"meters":1},"default":"pixels","expression":{"parameters":["zoom"]}}},"layout_symbol":{"symbol-placement":{"type":"enum","values":{"point":1,"line":1,"line-center":1},"default":"point","expression":{"parameters":["zoom"]}},"symbol-spacing":{"type":"number","default":250,"minimum":1,"expression":{"interpolated":true,"parameters":["zoom"]}},"symbol-avoid-edges":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-sort-key":{"type":"number","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"symbol-z-order":{"type":"enum","values":{"auto":1,"viewport-y":1,"source":1},"default":"auto","expression":{"parameters":["zoom"]}},"symbol-z-elevate":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"symbol-elevation-reference":{"type":"enum","values":{"sea":1,"ground":1,"hd-road-markup":1},"default":"ground","expression":{"parameters":["zoom"]}},"icon-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"icon-size":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"icon-text-fit":{"type":"enum","values":{"none":1,"width":1,"height":1,"both":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-text-fit-padding":{"type":"array","value":"number","length":4,"default":[0,0,0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-image":{"type":"resolvedImage","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-keep-upright":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"icon-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"icon-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-rotation-alignment":{"type":"enum","values":{"map":1,"viewport":1,"auto":1},"default":"auto","expression":{"parameters":["zoom"]}},"text-field":{"type":"formatted","default":"","tokens":true,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-font":{"type":"array","value":"string","default":["Open Sans Regular","Arial Unicode MS Regular"],"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size":{"type":"number","default":16,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-size-scale-range":{"type":"array","value":"number","length":2,"default":[0.8,2],"minimum":0.1,"maximum":10,"expression":{}},"text-max-width":{"type":"number","default":10,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-line-height":{"type":"number","default":1.2,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-letter-spacing":{"type":"number","default":0,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-justify":{"type":"enum","values":{"auto":1,"left":1,"center":1,"right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-radial-offset":{"type":"number","default":0,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["zoom","feature"]}},"text-variable-anchor":{"type":"array","value":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"expression":{"parameters":["zoom"]}},"text-anchor":{"type":"enum","values":{"center":1,"left":1,"right":1,"top":1,"bottom":1,"top-left":1,"top-right":1,"bottom-left":1,"bottom-right":1},"default":"center","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-max-angle":{"type":"number","default":45,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-writing-mode":{"type":"array","value":"enum","values":{"horizontal":1,"vertical":1},"expression":{"parameters":["zoom"]}},"text-rotate":{"type":"number","default":0,"period":360,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-padding":{"type":"number","default":2,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-keep-upright":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"text-transform":{"type":"enum","values":{"none":1,"uppercase":1,"lowercase":1},"default":"none","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-offset":{"type":"array","value":"number","length":2,"default":[0,0],"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"text-allow-overlap":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-ignore-placement":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"text-optional":{"type":"boolean","default":false,"expression":{"parameters":["zoom"]}},"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_raster-particle":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"layout_hillshade":{"visibility":{"type":"enum","values":{"visible":1,"none":1},"default":"visible","expression":{}}},"filter":{"type":"array","value":"*"},"filter_symbol":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature","pitch","distance-from-center"]}},"filter_fill":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_hillshade":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_raster-particle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_clip":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_model":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_line":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_circle":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_fill-extrusion":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_building":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_heatmap":{"type":"boolean","default":false,"property-type":"data-driven","expression":{"parameters":["zoom","feature"]}},"filter_operator":{"type":"enum","values":{"==":1,"!=":1,">":1,">=":1,"<":1,"<=":1,"in":1,"!in":1,"all":1,"any":1,"none":1,"has":1,"!has":1}},"geometry_type":{"type":"enum","values":{"Point":1,"LineString":1,"Polygon":1}},"function":{"expression":{"type":"expression"},"stops":{"type":"array","value":"function_stop"},"base":{"type":"number","default":1,"minimum":0},"property":{"type":"string","default":"$zoom"},"type":{"type":"enum","values":{"identity":1,"exponential":1,"interval":1,"categorical":1},"default":"exponential"},"colorSpace":{"type":"enum","values":{"rgb":1,"lab":1,"hcl":1},"default":"rgb"},"default":{"type":"*"}},"function_stop":{"type":"array","minimum":0,"maximum":24,"value":["number","color"],"length":2},"expression":{"type":"array","value":"*","minimum":1},"fog":{"range":{"type":"array","default":[0.5,10],"minimum":-20,"maximum":20,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"high-color":{"type":"color","default":"#245cdf","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"space-color":{"type":"color","default":["interpolate",["linear"],["zoom"],4,"#010b19",7,"#367ab9"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"horizon-blend":{"type":"number","default":["interpolate",["linear"],["zoom"],4,0.2,7,0.1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"star-intensity":{"type":"number","default":["interpolate",["linear"],["zoom"],5,0.35,6,0],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vertical-range":{"type":"array","default":[0,0],"minimum":0,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}}},"snow":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.85],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.3],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.4,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,50],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"flake-size":{"type":"number","default":0.71,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"rain":{"density":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,0.5],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#03113d",0.3,"#a8adbc"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"opacity":{"type":"number","default":["interpolate",["linear"],["measure-light","brightness"],0,0.88,1,0.7],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette":{"type":"number","default":["interpolate",["linear"],["zoom"],11,0,13,1],"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"vignette-color":{"type":"color","default":["interpolate",["linear"],["measure-light","brightness"],0,"#001736",0.3,"#464646"],"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"use-theme":true,"transition":true},"center-thinning":{"type":"number","default":0.57,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true},"direction":{"type":"array","default":[0,80],"minimum":0,"maximum":360,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"droplet-size":{"type":"array","default":[2.6,18.2],"minimum":0,"maximum":50,"length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true}},"distortion-strength":{"type":"number","default":0.7,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"],"relaxZoomRestriction":true},"transition":true}},"camera":{"camera-projection":{"type":"enum","values":{"perspective":1,"orthographic":1},"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]},"default":"perspective"}},"colorTheme":{"data":{"type":"string","expression":{}}},"indoor":{"floorplanFeaturesetId":{"type":"string","expression":{}},"buildingFeaturesetId":{"type":"string","expression":{}}},"light":{"anchor":{"type":"enum","default":"viewport","values":{"map":1,"viewport":1},"expression":{"parameters":["zoom"]}},"position":{"type":"array","default":[1.15,210,30],"length":3,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"color":{"type":"color","default":"#ffffff","expression":{"interpolated":true,"parameters":["zoom"]},"use-theme":true,"transition":true},"intensity":{"type":"number","default":0.5,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"projection":{"name":{"type":"enum","values":{"albers":1,"equalEarth":1,"equirectangular":1,"lambertConformalConic":1,"mercator":1,"naturalEarth":1,"winkelTripel":1,"globe":1},"default":"mercator"},"center":{"type":"array","length":2,"value":"number","minimum":[-180,-90],"maximum":[180,90]},"parallels":{"type":"array","length":2,"value":"number","minimum":[-90,-90],"maximum":[90,90]}},"terrain":{"source":{"type":"string"},"exaggeration":{"type":"number","default":1,"minimum":0,"maximum":1000,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint":["paint_fill","paint_line","paint_circle","paint_heatmap","paint_fill-extrusion","paint_building","paint_symbol","paint_raster","paint_raster-particle","paint_hillshade","paint_background","paint_sky","paint_model"],"paint_fill":{"fill-antialias":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-outline-color":{"type":"color","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-bridge-guard-rail-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"},"fill-tunnel-structure-color":{"type":"color","default":"rgba(241, 236, 225, 255)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature"]},"property-type":"data-driven"}},"paint_fill-extrusion":{"fill-extrusion-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"fill-extrusion-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"fill-extrusion-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-height":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-base":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"fill-extrusion-height-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"flat"},"fill-extrusion-base-alignment":{"type":"enum","values":{"terrain":1,"flat":1},"default":"terrain"},"fill-extrusion-vertical-gradient":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-ambient-occlusion-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-wall-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"fill-extrusion-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-flood-light-color":{"type":"color","default":"#ffffff","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"fill-extrusion-flood-light-wall-radius":{"property-type":"data-driven","type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-radius":{"property-type":"data-driven","type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]}},"fill-extrusion-flood-light-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"fill-extrusion-rounded-roof":{"type":"boolean","default":true,"expression":{"parameters":["zoom"]}},"fill-extrusion-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"fill-extrusion-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"fill-extrusion-line-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"fill-extrusion-cast-shadows":{"type":"boolean","default":true}},"paint_building":{"building-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-ambient-occlusion-wall-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-intensity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-radius":{"type":"number","default":3,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"building-ambient-occlusion-ground-attenuation":{"type":"number","default":0.69,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-vertical-scale":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"building-cast-shadows":{"type":"boolean","default":true},"building-color":{"type":"color","default":"rgba(193, 154, 127, 1)","use-theme":true,"expression":{"interpolated":true,"parameters":["feature","feature-state"]},"property-type":"data-driven"},"building-emissive-strength":{"type":"number","default":0,"minimum":0,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"property-type":"data-driven"}},"paint_line":{"line-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"line-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"line-width":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light","line-progress"]},"property-type":"data-driven"},"line-gap-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-offset":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"line-dasharray":{"type":"array","value":"number","minimum":0,"expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom","feature"]},"property-type":"data-driven"},"line-pattern-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-gradient":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["line-progress"]}},"line-trim-offset":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1]},"line-trim-fade-range":{"type":"array","value":"number","length":2,"default":[0,0],"minimum":[0,0],"maximum":[1,1],"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-trim-color":{"type":"color","default":"transparent","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"line-border-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-border-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state"]},"property-type":"data-driven"},"line-occlusion-opacity":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true}},"paint_circle":{"circle-radius":{"type":"number","default":5,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-blur":{"type":"number","default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"circle-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-scale":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"circle-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"circle-stroke-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-stroke-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"circle-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_heatmap":{"heatmap-radius":{"type":"number","default":30,"minimum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-weight":{"type":"number","default":1,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"heatmap-intensity":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"heatmap-color":{"type":"color","default":["interpolate",["linear"],["heatmap-density"],0,"rgba(0, 0, 255, 0)",0.1,"royalblue",0.3,"cyan",0.5,"lime",0.7,"yellow",1,"red"],"use-theme":true,"expression":{"interpolated":true,"parameters":["heatmap-density"]}},"heatmap-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_symbol":{"icon-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"text-emissive-strength":{"type":"number","default":1,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light","feature-state"]},"property-type":"data-driven"},"icon-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"icon-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"icon-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-image-cross-fade":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"text-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-occlusion-opacity":{"type":"number","minimum":0,"maximum":1,"default":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"overridable":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-color":{"type":"color","default":"rgba(0, 0, 0, 0)","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-width":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-halo-blur":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature","feature-state","measure-light"]},"property-type":"data-driven"},"text-translate":{"type":"array","value":"number","length":2,"default":[0,0],"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"text-translate-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":["zoom"]}},"icon-color-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"expression":{}},"icon-color-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"icon-color-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{}},"symbol-z-offset":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","feature"]},"property-type":"data-driven"}},"paint_raster":{"raster-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-value"]}},"raster-color-mix":{"type":"array","default":[0.2126,0.7152,0.0722,0],"length":4,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-color-range":{"type":"array","length":2,"value":"number","transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-hue-rotate":{"type":"number","default":0,"period":360,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-min":{"type":"number","default":0,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-brightness-max":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-saturation":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-contrast":{"type":"number","default":0,"minimum":-1,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-resampling":{"type":"enum","values":{"linear":1,"nearest":1},"default":"linear","expression":{"parameters":["zoom"]}},"raster-fade-duration":{"type":"number","default":300,"minimum":0,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"raster-array-band":{"type":"string"},"raster-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_raster-particle":{"raster-particle-array-band":{"type":"string"},"raster-particle-count":{"type":"number","default":512,"minimum":1},"raster-particle-color":{"type":"color","use-theme":true,"expression":{"interpolated":true,"parameters":["raster-particle-speed"]}},"raster-particle-max-speed":{"type":"number","default":1,"minimum":1},"raster-particle-speed-factor":{"type":"number","default":0.2,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-fade-opacity-factor":{"type":"number","default":0.98,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"raster-particle-reset-rate-factor":{"type":"number","default":0.8,"minimum":0,"maximum":1},"raster-particle-elevation":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_hillshade":{"hillshade-illumination-direction":{"type":"number","default":335,"minimum":0,"maximum":359,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-illumination-anchor":{"type":"enum","values":{"map":1,"viewport":1},"default":"viewport","expression":{"parameters":["zoom"]}},"hillshade-exaggeration":{"type":"number","default":0.5,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"hillshade-shadow-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-highlight-color":{"type":"color","default":"#FFFFFF","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-accent-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}},"hillshade-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_background":{"background-pitch-alignment":{"type":"enum","values":{"map":1,"viewport":1},"default":"map","expression":{"parameters":[]}},"background-color":{"type":"color","default":"#000000","use-theme":true,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-pattern":{"type":"resolvedImage","expression":{"parameters":["zoom"]}},"background-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}},"background-emissive-strength":{"type":"number","default":0,"minimum":0,"transition":true,"expression":{"interpolated":true,"parameters":["zoom","measure-light"]}}},"paint_sky":{"sky-type":{"type":"enum","values":{"gradient":1,"atmosphere":1},"default":"atmosphere","expression":{"parameters":["zoom"]}},"sky-atmosphere-sun":{"type":"array","value":"number","length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-atmosphere-sun-intensity":{"type":"number","default":10,"minimum":0,"maximum":100},"sky-gradient-center":{"type":"array","value":"number","default":[0,0],"length":2,"minimum":[0,0],"maximum":[360,180],"expression":{"parameters":["zoom"]}},"sky-gradient-radius":{"type":"number","default":90,"minimum":0,"maximum":180,"expression":{"parameters":["zoom"]}},"sky-gradient":{"type":"color","default":["interpolate",["linear"],["sky-radial-progress"],0.8,"#87ceeb",1,"white"],"use-theme":true,"expression":{"interpolated":true,"parameters":["sky-radial-progress"]}},"sky-atmosphere-halo-color":{"type":"color","default":"white","use-theme":true},"sky-atmosphere-color":{"type":"color","default":"white","use-theme":true},"sky-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["zoom"]}}},"paint_model":{"model-opacity":{"type":"number","default":1,"minimum":0,"maximum":1,"transition":true,"expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"property-type":"data-driven"},"model-rotation":{"type":"array","value":"number","length":3,"default":[0,0,0],"period":360,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-scale":{"type":"array","value":"number","length":3,"default":[1,1,1],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-translation":{"type":"array","value":"number","length":3,"default":[0,0,0],"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","zoom"]},"transition":true},"model-color":{"type":"color","default":"#ffffff","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light","zoom"]},"use-theme":true,"transition":true},"model-color-mix-intensity":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-type":{"type":"enum","values":{"common-3d":1,"location-indicator":1},"default":"common-3d"},"model-cast-shadows":{"type":"boolean","default":true},"model-receive-shadows":{"type":"boolean","default":true},"model-ambient-occlusion-intensity":{"type":"number","default":1,"minimum":0,"maximum":1,"expression":{"interpolated":true,"parameters":["zoom"]},"transition":true},"model-emissive-strength":{"type":"number","property-type":"data-driven","default":0,"minimum":0,"maximum":5,"expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-roughness":{"type":"number","default":1,"minimum":0,"maximum":1,"property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state"]},"transition":true},"model-height-based-emissive-strength-multiplier":{"type":"array","default":[1,1,1,1,0],"length":5,"value":"number","property-type":"data-driven","expression":{"interpolated":true,"parameters":["feature","feature-state","measure-light"]},"transition":true},"model-cutoff-fade-range":{"type":"number","default":0,"minimum":0,"maximum":1,"expression":{}},"model-front-cutoff":{"type":"array","value":"number","expression":{"interpolated":true,"parameters":["zoom"]},"length":3,"default":[0,0,1],"minimum":[0,0,0],"maximum":[1,1,1]}},"transition":{"duration":{"type":"number","default":300,"minimum":0},"delay":{"type":"number","default":0,"minimum":0}},"promoteId":{"*":{"type":"*"}}}');function Vr(u){return u instanceof Number||u instanceof String||u instanceof Boolean?u.valueOf():u}function fy(u){if(Array.isArray(u))return u.map(fy);if(u instanceof Object&&!(u instanceof Number||u instanceof String||u instanceof Boolean)){const i={};for(const l in u)i[l]=fy(u[l]);return i}return Vr(u)}function py(u){if(u===!0||u===!1)return!0;if(!Array.isArray(u)||u.length===0)return!1;switch(u[0]){case"has":return u.length>=2&&u[1]!=="$id"&&u[1]!=="$type";case"in":return u.length>=3&&(typeof u[1]!="string"||Array.isArray(u[2]));case"!in":case"!has":case"none":return!1;case"==":case"!=":case">":case">=":case"<":case"<=":return u.length!==3||Array.isArray(u[1])||Array.isArray(u[2]);case"any":case"all":for(const i of u.slice(1))if(!py(i)&&typeof i!="boolean")return!1;return!0;default:return!0}}function my(u,i="",l=null,p="fill"){if(u==null)return{filter:()=>!0,needGeometry:!1,needFeature:!1};py(u)||(u=Vp(u));const g=u;let b=!0;try{b=function(L){if(!dd(L))return L;let B=fy(L);return V0(B),B=iu(B),B}(g)}catch{console.warn(`Failed to extract static filter. Filter will continue working, but at higher memory usage and slower framerate.
This is most likely a bug, please report this via https://github.com/mapbox/mapbox-gl-js/issues/new?assignees=&labels=&template=Bug_report.md
and paste the contents of this message in the report.
Thank you!
Filter Expression:
${JSON.stringify(g,null,2)}
        `)}let x=null,A=null;if(p!=="background"&&p!=="sky"&&p!=="slot"){A=pt[`filter_${p}`];const L=Mu(b,A,i,l);if(L.result==="error")throw new Error(L.value.map(B=>`${B.key}: ${B.message}`).join(", "));x=(B,U,q)=>L.value.evaluate(B,U,{},q)}let R=null,O=null;if(b!==g){const L=Mu(g,A,i,l);if(L.result==="error")throw new Error(L.value.map(B=>`${B.key}: ${B.message}`).join(", "));R=(B,U,q,Y,ne)=>L.value.evaluate(B,U,{},q,void 0,void 0,Y,ne),O=!Eu(L.value.expression)}return{filter:x,dynamicFilter:R||void 0,needGeometry:U0(b),needFeature:!!O}}function iu(u){if(!Array.isArray(u))return u;const i=function(l){if(_g.has(l[0])){for(let p=1;p<l.length;p++)if(dd(l[p]))return!0}return l}(u);return i===!0?i:i.map(l=>iu(l))}function V0(u){let i=!1;const l=[];if(u[0]==="case"){for(let p=1;p<u.length-1;p+=2)i=i||dd(u[p]),l.push(u[p+1]);l.push(u[u.length-1])}else if(u[0]==="match"){i=i||dd(u[1]);for(let p=2;p<u.length-1;p+=2)l.push(u[p+1]);l.push(u[u.length-1])}else if(u[0]==="step"){i=i||dd(u[1]);for(let p=1;p<u.length-1;p+=2)l.push(u[p+1])}i&&(u.length=0,u.push("any",...l));for(let p=1;p<u.length;p++)V0(u[p])}function dd(u){if(!Array.isArray(u))return!1;if((i=u[0])==="pitch"||i==="distance-from-center")return!0;var i;for(let l=1;l<u.length;l++)if(dd(u[l]))return!0;return!1}const _g=new Set(["in","==","!=",">",">=","<","<=","to-boolean"]);function Fp(u,i){return u<i?-1:u>i?1:0}function U0(u){if(!Array.isArray(u))return!1;if(u[0]==="within"||u[0]==="distance")return!0;for(let i=1;i<u.length;i++)if(U0(u[i]))return!0;return!1}function Vp(u){if(!u)return!0;const i=u[0];return u.length<=1?i!=="any":i==="=="?gy(u[1],u[2],"=="):i==="!="?yg(gy(u[1],u[2],"==")):i==="<"||i===">"||i==="<="||i===">="?gy(u[1],u[2],i):i==="any"?(l=u.slice(1),["any"].concat(l.map(Vp))):i==="all"?["all"].concat(u.slice(1).map(Vp)):i==="none"?["all"].concat(u.slice(1).map(Vp).map(yg)):i==="in"?j0(u[1],u.slice(2)):i==="!in"?yg(j0(u[1],u.slice(2))):i==="has"?Wx(u[1]):i!=="!has"||yg(Wx(u[1]));var l}function gy(u,i,l){switch(u){case"$type":return[`filter-type-${l}`,i];case"$id":return[`filter-id-${l}`,i];default:return[`filter-${l}`,u,i]}}function j0(u,i){if(i.length===0)return!1;switch(u){case"$type":return["filter-type-in",["literal",i]];case"$id":return["filter-id-in",["literal",i]];default:return i.length>200&&!i.some(l=>typeof l!=typeof i[0])?["filter-in-large",u,["literal",i.sort(Fp)]]:["filter-in-small",u,["literal",i]]}}function Wx(u){switch(u){case"$type":return!0;case"$id":return["filter-has-id"];default:return["filter-has",u]}}function yg(u){return["!",u]}const vg="";function ru(u,i){return i?`${u}${vg}${i}`:u}const cc="-transition",Th=new Set(["fill","line","background","hillshade","raster"]);class ha extends Yc{constructor(i,l,p,g,b){if(super(),this.id=i.id,this.fqid=ru(this.id,p),this.type=i.type,this.scope=p,this.lut=g,this.options=b,this._featureFilter={filter:()=>!0,needGeometry:!1,needFeature:!1},this._filterCompiled=!1,this.configDependencies=new Set,i.type!=="custom"){if(this.metadata=i.metadata,this.minzoom=i.minzoom,this.maxzoom=i.maxzoom,i.type&&i.type!=="background"&&i.type!=="sky"&&i.type!=="slot"){this.source=i.source,this.sourceLayer=i["source-layer"],this.filter=i.filter;const x=Mu(this.filter,pt[`filter_${i.type}`]);x.result!=="error"&&(this.configDependencies=new Set([...this.configDependencies,...x.value.configDependencies]))}if(i.slot&&(this.slot=i.slot),l.layout&&(this._unevaluatedLayout=new wh(l.layout,this.scope,b),this.configDependencies=new Set([...this.configDependencies,...this._unevaluatedLayout.configDependencies])),l.paint){this._transitionablePaint=new B0(l.paint,this.scope,b);for(const x in i.paint)this.setPaintProperty(x,i.paint[x]);for(const x in i.layout)this.setLayoutProperty(x,i.layout[x]);this.configDependencies=new Set([...this.configDependencies,...this._transitionablePaint.configDependencies]),this._transitioningPaint=this._transitionablePaint.untransitioned(),this.paint=new Cf(l.paint)}}}onAdd(i){}onRemove(i){}isDraped(i){return!this.is3D(!0)&&Th.has(this.type)}getLayoutProperty(i){return i==="visibility"?this.visibility:this._unevaluatedLayout.getValue(i)}setLayoutProperty(i,l){if(this.type==="custom"&&i==="visibility")return void(this.visibility=l);const p=this._unevaluatedLayout;p._properties.properties[i]&&(p.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),i==="visibility"&&this.possiblyEvaluateVisibility())}possiblyEvaluateVisibility(){this._unevaluatedLayout._values.visibility&&(this.visibility=this._unevaluatedLayout._values.visibility.possiblyEvaluate({zoom:0}))}getPaintProperty(i){return i.endsWith(cc)?this._transitionablePaint.getTransition(i.slice(0,-11)):this._transitionablePaint.getValue(i)}setPaintProperty(i,l){const p=this._transitionablePaint,g=p._properties.properties;if(i.endsWith(cc)){const B=i.slice(0,-11);return g[B]&&p.setTransition(B,l||void 0),!1}if(!g[i])return!1;const b=p._values[i],x=b.value.isDataDriven(),A=b.value;p.setValue(i,l),this.configDependencies=new Set([...this.configDependencies,...p.configDependencies]),this._handleSpecialPaintPropertyUpdate(i);const R=p._values[i].value,O=R.isDataDriven(),L=i.endsWith("pattern")||i==="line-dasharray";return O||x||L||this._handleOverridablePaintPropertyUpdate(i,A,R)}_handleSpecialPaintPropertyUpdate(i){}getProgramIds(){return null}getDefaultProgramParams(i,l,p){return null}_handleOverridablePaintPropertyUpdate(i,l,p){return!1}isHidden(i){return!!(this.minzoom&&i<this.minzoom)||!!(this.maxzoom&&i>=this.maxzoom)||this.visibility==="none"}updateTransitions(i){this._transitioningPaint=this._transitionablePaint.transitioned(i,this._transitioningPaint)}hasTransition(){return this._transitioningPaint.hasTransition()}recalculate(i,l){this._unevaluatedLayout&&(this.layout=this._unevaluatedLayout.possiblyEvaluate(i,void 0,l)),this.paint=this._transitioningPaint.possiblyEvaluate(i,void 0,l)}serialize(){return Gn({id:this.id,type:this.type,slot:this.slot,source:this.source,"source-layer":this.sourceLayer,metadata:this.metadata,minzoom:this.minzoom,maxzoom:this.maxzoom,filter:this.filter,layout:this._unevaluatedLayout&&this._unevaluatedLayout.serialize(),paint:this._transitionablePaint&&this._transitionablePaint.serialize()},(i,l)=>!(i===void 0||l==="layout"&&!Object.keys(i).length||l==="paint"&&!Object.keys(i).length))}is3D(i){return!1}hasElevation(){return!1}isSky(){return!1}isTileClipped(){return!1}hasOffscreenPass(){return!1}hasShadowPass(){return!1}canCastShadows(){return!1}hasLightBeamPass(){return!1}cutoffRange(){return 0}tileCoverLift(){return 0}resize(){}isStateDependent(){for(const i in this.paint._values){const l=this.paint.get(i);if(l instanceof ud&&pg(l.property.specification)&&(l.value.kind==="source"||l.value.kind==="composite")&&l.value.isStateDependent)return!0}return!1}compileFilter(i){this._filterCompiled||(this._featureFilter=my(this.filter,this.scope,i),this._filterCompiled=!0)}invalidateCompiledFilter(){this._filterCompiled=!1}dynamicFilter(){return this._featureFilter.dynamicFilter}dynamicFilterNeedsFeature(){return this._featureFilter.needFeature}getLayerRenderingStats(){return this._stats}resetLayerRenderingStats(i){this._stats&&(i.renderPass==="shadow"?this._stats.numRenderedVerticesInShadowPass=0:this._stats.numRenderedVerticesInTransparentPass=0)}queryRadius(i){}queryIntersectsFeature(i,l,p,g,b,x,A,R,O){}}const Yx={Int8:Int8Array,Uint8:Uint8Array,Int16:Int16Array,Uint16:Uint16Array,Int32:Int32Array,Uint32:Uint32Array,Float32:Float32Array};class Df{constructor(i,l){this._structArray=i,this._pos1=l*this.size,this._pos2=this._pos1/2,this._pos4=this._pos1/4,this._pos8=this._pos1/8}}class wr{constructor(){this.capacity=-1,this.resize(0)}static serialize(i,l){return i._trim(),l&&l.add(i.arrayBuffer),{length:i.length,arrayBuffer:i.arrayBuffer}}static deserialize(i){const l=Object.create(this.prototype);return l.arrayBuffer=i.arrayBuffer,l.length=i.length,l.capacity=i.arrayBuffer.byteLength/l.bytesPerElement,l._refreshViews(),l}_trim(){this.length!==this.capacity&&(this.capacity=this.length,this.arrayBuffer=this.arrayBuffer.slice(0,this.length*this.bytesPerElement),this._refreshViews())}clear(){this.length=0}resize(i){this.reserve(i),this.length=i}reserve(i){if(i>this.capacity){this.capacity=Math.max(i,Math.floor(5*this.capacity),128),this.arrayBuffer=new ArrayBuffer(this.capacity*this.bytesPerElement);const l=this.uint8;this._refreshViews(),l&&this.uint8.set(l)}}_refreshViews(){throw new Error("StructArray#_refreshViews() must be implemented by each concrete StructArray layout")}emplace(...i){throw new Error("StructArray#emplace() must be implemented by each concrete StructArray layout")}emplaceBack(...i){throw new Error("StructArray#emplaceBack() must be implemented by each concrete StructArray layout")}destroy(){this.int8=this.uint8=this.int16=this.uint16=this.int32=this.uint32=this.float32=null,this.arrayBuffer=null}}function Oi(u,i=1){let l=0,p=0;return{members:u.map(g=>{const b=Yx[g.type].BYTES_PER_ELEMENT,x=l=bg(l,Math.max(i,b)),A=g.components||1;return p=Math.max(p,b),l+=b*A,{name:g.name,type:g.type,components:A,offset:x}}),size:bg(l,Math.max(p,i)),alignment:i}}function bg(u,i){return Math.ceil(u/i)*i}class uc extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.int16[g+0]=l,this.int16[g+1]=p,i}}uc.prototype.bytesPerElement=4,vn(uc,"StructArrayLayout2i4");class xg extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const b=3*i;return this.int16[b+0]=l,this.int16[b+1]=p,this.int16[b+2]=g,i}}xg.prototype.bytesPerElement=6,vn(xg,"StructArrayLayout3i6");class Rf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,p,g)}emplace(i,l,p,g,b){const x=4*i;return this.int16[x+0]=l,this.int16[x+1]=p,this.int16[x+2]=g,this.int16[x+3]=b,i}}Rf.prototype.bytesPerElement=8,vn(Rf,"StructArrayLayout4i8");class fd extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.float32[1*i+0]=l,i}}fd.prototype.bytesPerElement=4,vn(fd,"StructArrayLayout1f4");class _y extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const b=4*i,x=2*i;return this.int16[b+0]=l,this.int16[b+1]=p,this.float32[x+1]=g,i}}_y.prototype.bytesPerElement=8,vn(_y,"StructArrayLayout2i1f8");class wg extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const b=4*i;return this.int16[b+0]=l,this.int16[b+1]=p,this.int16[b+2]=g,i}}wg.prototype.bytesPerElement=8,vn(wg,"StructArrayLayout3i8");class fl extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,b)}emplace(i,l,p,g,b,x){const A=5*i;return this.int16[A+0]=l,this.int16[A+1]=p,this.int16[A+2]=g,this.int16[A+3]=b,this.int16[A+4]=x,i}}fl.prototype.bytesPerElement=10,vn(fl,"StructArrayLayout5i10");class yy extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A){const R=this.length;return this.resize(R+1),this.emplace(R,i,l,p,g,b,x,A)}emplace(i,l,p,g,b,x,A,R){const O=6*i,L=12*i,B=3*i;return this.int16[O+0]=l,this.int16[O+1]=p,this.uint8[L+4]=g,this.uint8[L+5]=b,this.uint8[L+6]=x,this.uint8[L+7]=A,this.float32[B+2]=R,i}}yy.prototype.bytesPerElement=12,vn(yy,"StructArrayLayout2i4ub1f12");class su extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const b=3*i;return this.float32[b+0]=l,this.float32[b+1]=p,this.float32[b+2]=g,i}}su.prototype.bytesPerElement=12,vn(su,"StructArrayLayout3f12");class pd extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,b)}emplace(i,l,p,g,b,x){const A=6*i,R=3*i;return this.uint16[A+0]=l,this.uint16[A+1]=p,this.uint16[A+2]=g,this.uint16[A+3]=b,this.float32[R+2]=x,i}}pd.prototype.bytesPerElement=12,vn(pd,"StructArrayLayout4ui1f12");class Of extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,p,g)}emplace(i,l,p,g,b){const x=4*i;return this.uint16[x+0]=l,this.uint16[x+1]=p,this.uint16[x+2]=g,this.uint16[x+3]=b,i}}Of.prototype.bytesPerElement=8,vn(Of,"StructArrayLayout4ui8");class Sa extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,i,l,p,g,b,x)}emplace(i,l,p,g,b,x,A){const R=6*i;return this.int16[R+0]=l,this.int16[R+1]=p,this.int16[R+2]=g,this.int16[R+3]=b,this.int16[R+4]=x,this.int16[R+5]=A,i}}Sa.prototype.bytesPerElement=12,vn(Sa,"StructArrayLayout6i12");class If extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B,U){const q=this.length;return this.resize(q+1),this.emplace(q,i,l,p,g,b,x,A,R,O,L,B,U)}emplace(i,l,p,g,b,x,A,R,O,L,B,U,q){const Y=12*i;return this.int16[Y+0]=l,this.int16[Y+1]=p,this.int16[Y+2]=g,this.int16[Y+3]=b,this.uint16[Y+4]=x,this.uint16[Y+5]=A,this.uint16[Y+6]=R,this.uint16[Y+7]=O,this.int16[Y+8]=L,this.int16[Y+9]=B,this.int16[Y+10]=U,this.int16[Y+11]=q,i}}If.prototype.bytesPerElement=24,vn(If,"StructArrayLayout4i4ui4i24");class qo extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,i,l,p,g,b,x)}emplace(i,l,p,g,b,x,A){const R=10*i,O=5*i;return this.int16[R+0]=l,this.int16[R+1]=p,this.int16[R+2]=g,this.float32[O+2]=b,this.float32[O+3]=x,this.float32[O+4]=A,i}}qo.prototype.bytesPerElement=20,vn(qo,"StructArrayLayout3i3f20");class Eo extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,p,g)}emplace(i,l,p,g,b){const x=4*i;return this.float32[x+0]=l,this.float32[x+1]=p,this.float32[x+2]=g,this.float32[x+3]=b,i}}Eo.prototype.bytesPerElement=16,vn(Eo,"StructArrayLayout4f16");class pl extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint32[1*i+0]=l,i}}pl.prototype.bytesPerElement=4,vn(pl,"StructArrayLayout1ul4");class Eh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.uint16[g+0]=l,this.uint16[g+1]=p,i}}Eh.prototype.bytesPerElement=4,vn(Eh,"StructArrayLayout2ui4");class Sh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B,U,q){const Y=this.length;return this.resize(Y+1),this.emplace(Y,i,l,p,g,b,x,A,R,O,L,B,U,q)}emplace(i,l,p,g,b,x,A,R,O,L,B,U,q,Y){const ne=20*i,ae=10*i;return this.int16[ne+0]=l,this.int16[ne+1]=p,this.int16[ne+2]=g,this.int16[ne+3]=b,this.int16[ne+4]=x,this.float32[ae+3]=A,this.float32[ae+4]=R,this.float32[ae+5]=O,this.float32[ae+6]=L,this.int16[ne+14]=B,this.uint32[ae+8]=U,this.uint16[ne+18]=q,this.uint16[ne+19]=Y,i}}Sh.prototype.bytesPerElement=40,vn(Sh,"StructArrayLayout5i4f1i1ul2ui40");class Tg extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A){const R=this.length;return this.resize(R+1),this.emplace(R,i,l,p,g,b,x,A)}emplace(i,l,p,g,b,x,A,R){const O=8*i;return this.int16[O+0]=l,this.int16[O+1]=p,this.int16[O+2]=g,this.int16[O+4]=b,this.int16[O+5]=x,this.int16[O+6]=A,this.int16[O+7]=R,i}}Tg.prototype.bytesPerElement=16,vn(Tg,"StructArrayLayout3i2i2i16");class ou extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,b)}emplace(i,l,p,g,b,x){const A=4*i,R=8*i;return this.float32[A+0]=l,this.float32[A+1]=p,this.float32[A+2]=g,this.int16[R+6]=b,this.int16[R+7]=x,i}}ou.prototype.bytesPerElement=16,vn(ou,"StructArrayLayout2f1f2i16");class Mf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,i,l,p,g,b,x)}emplace(i,l,p,g,b,x,A){const R=20*i,O=5*i;return this.uint8[R+0]=l,this.uint8[R+1]=p,this.float32[O+1]=g,this.float32[O+2]=b,this.float32[O+3]=x,this.float32[O+4]=A,i}}Mf.prototype.bytesPerElement=20,vn(Mf,"StructArrayLayout2ub4f20");class mo extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p){const g=this.length;return this.resize(g+1),this.emplace(g,i,l,p)}emplace(i,l,p,g){const b=3*i;return this.uint16[b+0]=l,this.uint16[b+1]=p,this.uint16[b+2]=g,i}}mo.prototype.bytesPerElement=6,vn(mo,"StructArrayLayout3ui6");class ml extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye){const Oe=this.length;return this.resize(Oe+1),this.emplace(Oe,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye)}emplace(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye,Oe){const Le=30*i,nt=15*i,Qe=60*i;return this.int16[Le+0]=l,this.int16[Le+1]=p,this.int16[Le+2]=g,this.float32[nt+2]=b,this.float32[nt+3]=x,this.uint16[Le+8]=A,this.uint16[Le+9]=R,this.uint32[nt+5]=O,this.uint32[nt+6]=L,this.uint32[nt+7]=B,this.uint16[Le+16]=U,this.uint16[Le+17]=q,this.uint16[Le+18]=Y,this.float32[nt+10]=ne,this.float32[nt+11]=ae,this.uint8[Qe+48]=he,this.uint8[Qe+49]=Se,this.uint8[Qe+50]=Ae,this.uint32[nt+13]=re,this.int16[Le+28]=ye,this.uint8[Qe+58]=Oe,i}}ml.prototype.bytesPerElement=60,vn(ml,"StructArrayLayout3i2f2ui3ul3ui2f3ub1ul1i1ub60");class vy extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye,Oe,Le,nt,Qe,st,dt,a,h,v,S,I,k){const K=this.length;return this.resize(K+1),this.emplace(K,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye,Oe,Le,nt,Qe,st,dt,a,h,v,S,I,k)}emplace(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae,re,ye,Oe,Le,nt,Qe,st,dt,a,h,v,S,I,k,K){const ee=20*i,me=40*i,De=80*i;return this.float32[ee+0]=l,this.float32[ee+1]=p,this.int16[me+4]=g,this.int16[me+5]=b,this.int16[me+6]=x,this.int16[me+7]=A,this.int16[me+8]=R,this.int16[me+9]=O,this.int16[me+10]=L,this.int16[me+11]=B,this.int16[me+12]=U,this.uint16[me+13]=q,this.uint16[me+14]=Y,this.uint16[me+15]=ne,this.uint16[me+16]=ae,this.uint16[me+17]=he,this.uint16[me+18]=Se,this.uint16[me+19]=Ae,this.uint16[me+20]=re,this.uint16[me+21]=ye,this.uint16[me+22]=Oe,this.uint16[me+23]=Le,this.uint16[me+24]=nt,this.uint16[me+25]=Qe,this.uint16[me+26]=st,this.uint16[me+27]=dt,this.uint32[ee+14]=a,this.float32[ee+15]=h,this.float32[ee+16]=v,this.float32[ee+17]=S,this.float32[ee+18]=I,this.uint8[De+76]=k,this.uint16[me+39]=K,i}}vy.prototype.bytesPerElement=80,vn(vy,"StructArrayLayout2f9i15ui1ul4f1ub1ui80");class md extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x){const A=this.length;return this.resize(A+1),this.emplace(A,i,l,p,g,b,x)}emplace(i,l,p,g,b,x,A){const R=6*i;return this.float32[R+0]=l,this.float32[R+1]=p,this.float32[R+2]=g,this.float32[R+3]=b,this.float32[R+4]=x,this.float32[R+5]=A,i}}md.prototype.bytesPerElement=24,vn(md,"StructArrayLayout6f24");class Ah extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b){const x=this.length;return this.resize(x+1),this.emplace(x,i,l,p,g,b)}emplace(i,l,p,g,b,x){const A=5*i;return this.float32[A+0]=l,this.float32[A+1]=p,this.float32[A+2]=g,this.float32[A+3]=b,this.float32[A+4]=x,i}}Ah.prototype.bytesPerElement=20,vn(Ah,"StructArrayLayout5f20");class Ch extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A){const R=this.length;return this.resize(R+1),this.emplace(R,i,l,p,g,b,x,A)}emplace(i,l,p,g,b,x,A,R){const O=7*i;return this.float32[O+0]=l,this.float32[O+1]=p,this.float32[O+2]=g,this.float32[O+3]=b,this.float32[O+4]=x,this.float32[O+5]=A,this.float32[O+6]=R,i}}Ch.prototype.bytesPerElement=28,vn(Ch,"StructArrayLayout7f28");class gd extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B){const U=this.length;return this.resize(U+1),this.emplace(U,i,l,p,g,b,x,A,R,O,L,B)}emplace(i,l,p,g,b,x,A,R,O,L,B,U){const q=11*i;return this.float32[q+0]=l,this.float32[q+1]=p,this.float32[q+2]=g,this.float32[q+3]=b,this.float32[q+4]=x,this.float32[q+5]=A,this.float32[q+6]=R,this.float32[q+7]=O,this.float32[q+8]=L,this.float32[q+9]=B,this.float32[q+10]=U,i}}gd.prototype.bytesPerElement=44,vn(gd,"StructArrayLayout11f44");class Eg extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O){const L=this.length;return this.resize(L+1),this.emplace(L,i,l,p,g,b,x,A,R,O)}emplace(i,l,p,g,b,x,A,R,O,L){const B=9*i;return this.float32[B+0]=l,this.float32[B+1]=p,this.float32[B+2]=g,this.float32[B+3]=b,this.float32[B+4]=x,this.float32[B+5]=A,this.float32[B+6]=R,this.float32[B+7]=O,this.float32[B+8]=L,i}}Eg.prototype.bytesPerElement=36,vn(Eg,"StructArrayLayout9f36");class _d extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l){const p=this.length;return this.resize(p+1),this.emplace(p,i,l)}emplace(i,l,p){const g=2*i;return this.float32[g+0]=l,this.float32[g+1]=p,i}}_d.prototype.bytesPerElement=8,vn(_d,"StructArrayLayout2f8");class Pf extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint32=new Uint32Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i,l,p,g){const b=this.length;return this.resize(b+1),this.emplace(b,i,l,p,g)}emplace(i,l,p,g,b){const x=6*i;return this.uint32[3*i+0]=l,this.uint16[x+2]=p,this.uint16[x+3]=g,this.uint16[x+4]=b,i}}Pf.prototype.bytesPerElement=12,vn(Pf,"StructArrayLayout1ul3ui12");class Up extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint16[1*i+0]=l,i}}Up.prototype.bytesPerElement=2,vn(Up,"StructArrayLayout1ui2");class Dh extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae){const he=this.length;return this.resize(he+1),this.emplace(he,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae)}emplace(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he){const Se=16*i;return this.float32[Se+0]=l,this.float32[Se+1]=p,this.float32[Se+2]=g,this.float32[Se+3]=b,this.float32[Se+4]=x,this.float32[Se+5]=A,this.float32[Se+6]=R,this.float32[Se+7]=O,this.float32[Se+8]=L,this.float32[Se+9]=B,this.float32[Se+10]=U,this.float32[Se+11]=q,this.float32[Se+12]=Y,this.float32[Se+13]=ne,this.float32[Se+14]=ae,this.float32[Se+15]=he,i}}Dh.prototype.bytesPerElement=64,vn(Dh,"StructArrayLayout16f64");class jp extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.uint16=new Uint16Array(this.arrayBuffer),this.float32=new Float32Array(this.arrayBuffer)}emplaceBack(i,l,p,g,b,x,A){const R=this.length;return this.resize(R+1),this.emplace(R,i,l,p,g,b,x,A)}emplace(i,l,p,g,b,x,A,R){const O=10*i,L=5*i;return this.uint16[O+0]=l,this.uint16[O+1]=p,this.uint16[O+2]=g,this.uint16[O+3]=b,this.float32[L+2]=x,this.float32[L+3]=A,this.float32[L+4]=R,i}}jp.prototype.bytesPerElement=20,vn(jp,"StructArrayLayout4ui3f20");class by extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer),this.int16=new Int16Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.int16[1*i+0]=l,i}}by.prototype.bytesPerElement=2,vn(by,"StructArrayLayout1i2");class xy extends wr{_refreshViews(){this.uint8=new Uint8Array(this.arrayBuffer)}emplaceBack(i){const l=this.length;return this.resize(l+1),this.emplace(l,i)}emplace(i,l){return this.uint8[1*i+0]=l,i}}xy.prototype.bytesPerElement=1,vn(xy,"StructArrayLayout1ub1");class H0 extends Df{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.int16[this._pos2+3]}get tileAnchorY(){return this._structArray.int16[this._pos2+4]}get x1(){return this._structArray.float32[this._pos4+3]}get y1(){return this._structArray.float32[this._pos4+4]}get x2(){return this._structArray.float32[this._pos4+5]}get y2(){return this._structArray.float32[this._pos4+6]}get padding(){return this._structArray.int16[this._pos2+14]}get featureIndex(){return this._structArray.uint32[this._pos4+8]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+18]}get bucketIndex(){return this._structArray.uint16[this._pos2+19]}}H0.prototype.size=40;class Aa extends Sh{get(i){return new H0(this,i)}}vn(Aa,"CollisionBoxArray");class $0 extends Df{get projectedAnchorX(){return this._structArray.int16[this._pos2+0]}get projectedAnchorY(){return this._structArray.int16[this._pos2+1]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+2]}get tileAnchorX(){return this._structArray.float32[this._pos4+2]}get tileAnchorY(){return this._structArray.float32[this._pos4+3]}get glyphStartIndex(){return this._structArray.uint16[this._pos2+8]}get numGlyphs(){return this._structArray.uint16[this._pos2+9]}get vertexStartIndex(){return this._structArray.uint32[this._pos4+5]}get lineStartIndex(){return this._structArray.uint32[this._pos4+6]}get lineLength(){return this._structArray.uint32[this._pos4+7]}get segment(){return this._structArray.uint16[this._pos2+16]}get lowerSize(){return this._structArray.uint16[this._pos2+17]}get upperSize(){return this._structArray.uint16[this._pos2+18]}get lineOffsetX(){return this._structArray.float32[this._pos4+10]}get lineOffsetY(){return this._structArray.float32[this._pos4+11]}get writingMode(){return this._structArray.uint8[this._pos1+48]}get placedOrientation(){return this._structArray.uint8[this._pos1+49]}set placedOrientation(i){this._structArray.uint8[this._pos1+49]=i}get hidden(){return this._structArray.uint8[this._pos1+50]}set hidden(i){this._structArray.uint8[this._pos1+50]=i}get crossTileID(){return this._structArray.uint32[this._pos4+13]}set crossTileID(i){this._structArray.uint32[this._pos4+13]=i}get associatedIconIndex(){return this._structArray.int16[this._pos2+28]}get flipState(){return this._structArray.uint8[this._pos1+58]}set flipState(i){this._structArray.uint8[this._pos1+58]=i}}$0.prototype.size=60;class oo extends ml{get(i){return new $0(this,i)}}vn(oo,"PlacedSymbolArray");class G0 extends Df{get tileAnchorX(){return this._structArray.float32[this._pos4+0]}get tileAnchorY(){return this._structArray.float32[this._pos4+1]}get projectedAnchorX(){return this._structArray.int16[this._pos2+4]}get projectedAnchorY(){return this._structArray.int16[this._pos2+5]}get projectedAnchorZ(){return this._structArray.int16[this._pos2+6]}get rightJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+7]}get centerJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+8]}get leftJustifiedTextSymbolIndex(){return this._structArray.int16[this._pos2+9]}get verticalPlacedTextSymbolIndex(){return this._structArray.int16[this._pos2+10]}get placedIconSymbolIndex(){return this._structArray.int16[this._pos2+11]}get verticalPlacedIconSymbolIndex(){return this._structArray.int16[this._pos2+12]}get key(){return this._structArray.uint16[this._pos2+13]}get textBoxStartIndex(){return this._structArray.uint16[this._pos2+14]}get textBoxEndIndex(){return this._structArray.uint16[this._pos2+15]}get verticalTextBoxStartIndex(){return this._structArray.uint16[this._pos2+16]}get verticalTextBoxEndIndex(){return this._structArray.uint16[this._pos2+17]}get iconBoxStartIndex(){return this._structArray.uint16[this._pos2+18]}get iconBoxEndIndex(){return this._structArray.uint16[this._pos2+19]}get verticalIconBoxStartIndex(){return this._structArray.uint16[this._pos2+20]}get verticalIconBoxEndIndex(){return this._structArray.uint16[this._pos2+21]}get featureIndex(){return this._structArray.uint16[this._pos2+22]}get numHorizontalGlyphVertices(){return this._structArray.uint16[this._pos2+23]}get numVerticalGlyphVertices(){return this._structArray.uint16[this._pos2+24]}get numIconVertices(){return this._structArray.uint16[this._pos2+25]}get numVerticalIconVertices(){return this._structArray.uint16[this._pos2+26]}get useRuntimeCollisionCircles(){return this._structArray.uint16[this._pos2+27]}get crossTileID(){return this._structArray.uint32[this._pos4+14]}set crossTileID(i){this._structArray.uint32[this._pos4+14]=i}get textOffset0(){return this._structArray.float32[this._pos4+15]}get textOffset1(){return this._structArray.float32[this._pos4+16]}get collisionCircleDiameter(){return this._structArray.float32[this._pos4+17]}get zOffset(){return this._structArray.float32[this._pos4+18]}set zOffset(i){this._structArray.float32[this._pos4+18]=i}get hasIconTextFit(){return this._structArray.uint8[this._pos1+76]}get elevationFeatureIndex(){return this._structArray.uint16[this._pos2+39]}}G0.prototype.size=80;class q0 extends vy{get(i){return new G0(this,i)}}vn(q0,"SymbolInstanceArray");class W0 extends fd{getoffsetX(i){return this.float32[1*i+0]}}vn(W0,"GlyphOffsetArray");class Rh extends uc{getx(i){return this.int16[2*i+0]}gety(i){return this.int16[2*i+1]}}vn(Rh,"SymbolLineVertexArray");class kf extends Df{get featureIndex(){return this._structArray.uint32[this._pos4+0]}get sourceLayerIndex(){return this._structArray.uint16[this._pos2+2]}get bucketIndex(){return this._structArray.uint16[this._pos2+3]}get layoutVertexArrayOffset(){return this._structArray.uint16[this._pos2+4]}}kf.prototype.size=12;class wy extends Pf{get(i){return new kf(this,i)}}vn(wy,"FeatureIndexArray");class Nf extends Eh{geta_centroid_pos0(i){return this.uint16[2*i+0]}geta_centroid_pos1(i){return this.uint16[2*i+1]}}vn(Nf,"FillExtrusionCentroidArray");class Y0 extends Df{get a_join_normal_inside0(){return this._structArray.int16[this._pos2+0]}get a_join_normal_inside1(){return this._structArray.int16[this._pos2+1]}get a_join_normal_inside2(){return this._structArray.int16[this._pos2+2]}}Y0.prototype.size=6;class Z0 extends xg{get(i){return new Y0(this,i)}}vn(Z0,"FillExtrusionWallArray");const Zx=Oi([{name:"a_pos",components:2,type:"Int16"}],4),X0=Oi([{name:"a_circle_z_offset",components:1,type:"Float32"}],4),Hp=Oi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]);class Yr{constructor(i=[]){this.segments=i}_prepareSegment(i,l,p,g){let b=this.segments[this.segments.length-1];return i>Yr.MAX_VERTEX_ARRAY_LENGTH&&ii(`Max vertices per segment is ${Yr.MAX_VERTEX_ARRAY_LENGTH}: bucket requested ${i}`),(!b||b.vertexLength+i>Yr.MAX_VERTEX_ARRAY_LENGTH||b.sortKey!==g)&&(b={vertexOffset:l,primitiveOffset:p,vertexLength:0,primitiveLength:0},g!==void 0&&(b.sortKey=g),this.segments.push(b)),b}prepareSegment(i,l,p,g){return this._prepareSegment(i,l.length,p.length,g)}get(){return this.segments}destroy(){for(const i of this.segments)for(const l in i.vaos)i.vaos[l].destroy()}static simpleSegment(i,l,p,g){return new Yr([{vertexOffset:i,primitiveOffset:l,vertexLength:p,primitiveLength:g,vaos:{},sortKey:0}])}}function Xx(u,i){return 256*(u=He(Math.floor(u),0,255))+He(Math.floor(i),0,255)}Yr.MAX_VERTEX_ARRAY_LENGTH=Math.pow(2,16)-1,vn(Yr,"SegmentVector");const Ty=Oi([{name:"a_pattern",components:4,type:"Uint16"},{name:"a_pixel_ratio",components:1,type:"Float32"}]),Ey=Oi([{name:"a_pattern_b",components:4,type:"Uint16"}]),Q0=Oi([{name:"a_dash",components:4,type:"Uint16"}]);class Sg{constructor(){this.ids=[],this.uniqueIds=[],this.positions=[],this.indexed=!1}add(i,l,p,g){this.ids.push(yd(i)),this.positions.push(l,p,g)}eachPosition(i,l){const p=yd(i);let g=0,b=this.ids.length-1;for(;g<b;){const x=g+b>>1;this.ids[x]>=p?b=x:g=x+1}for(;this.ids[g]===p;)l(this.positions[3*g],this.positions[3*g+1],this.positions[3*g+2]),g++}static serialize(i,l){const p=new Float64Array(i.ids),g=new Uint32Array(i.positions);return Lf(p,g,0,p.length-1),l&&(l.add(p.buffer),l.add(g.buffer)),{ids:p,positions:g}}static deserialize(i){const l=new Sg;let p;l.ids=i.ids,l.positions=i.positions;for(const g of l.ids)g!==p&&l.uniqueIds.push(g),p=g;return l.indexed=!0,l}}function yd(u){const i=+u;return!isNaN(i)&&Number.MIN_SAFE_INTEGER<=i&&i<=Number.MAX_SAFE_INTEGER?i:Kh(String(u))}function Lf(u,i,l,p){for(;l<p;){const g=u[l+p>>1];let b=l-1,x=p+1;for(;;){do b++;while(u[b]<g);do x--;while(u[x]>g);if(b>=x)break;$p(u,b,x),$p(i,3*b,3*x),$p(i,3*b+1,3*x+1),$p(i,3*b+2,3*x+2)}x-l<p-x?(Lf(u,i,l,x),l=x+1):(Lf(u,i,x+1,p),p=x)}}function $p(u,i,l){const p=u[i];u[i]=u[l],u[l]=p}vn(Sg,"FeaturePositionMap");class au{constructor(i){this.gl=i.gl,this.initialized=!1}fetchUniformLocation(i,l){return this.location||this.initialized||(this.location=this.gl.getUniformLocation(i,l),this.initialized=!0),!!this.location}set(i,l,p){throw new Error("Uniform#set() must be implemented by each concrete Uniform")}}class Ag extends au{constructor(i){super(i),this.current=0}set(i,l,p){this.fetchUniformLocation(i,l)&&this.current!==p&&(this.current=p,this.gl.uniform1i(this.location,p))}}class bs extends au{constructor(i){super(i),this.current=0}set(i,l,p){this.fetchUniformLocation(i,l)&&this.current!==p&&(this.current=p,this.gl.uniform1f(this.location,p))}}class lu extends au{constructor(i){super(i),this.current=[0,0]}set(i,l,p){this.fetchUniformLocation(i,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]||(this.current=p,this.gl.uniform2f(this.location,p[0],p[1])))}}class Cg extends au{constructor(i){super(i),this.current=[0,0,0]}set(i,l,p){this.fetchUniformLocation(i,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]||(this.current=p,this.gl.uniform3f(this.location,p[0],p[1],p[2])))}}class Dg extends au{constructor(i){super(i),this.current=[0,0,0,0]}set(i,l,p){this.fetchUniformLocation(i,l)&&(p[0]===this.current[0]&&p[1]===this.current[1]&&p[2]===this.current[2]&&p[3]===this.current[3]||(this.current=p,this.gl.uniform4f(this.location,p[0],p[1],p[2],p[3])))}}class Gp extends au{constructor(i){super(i),this.current=Mi.transparent.toPremultipliedRenderColor(null)}set(i,l,p){this.fetchUniformLocation(i,l)&&(p.r===this.current.r&&p.g===this.current.g&&p.b===this.current.b&&p.a===this.current.a||(this.current=p,this.gl.uniform4f(this.location,p.r,p.g,p.b,p.a)))}}const Qx=new Float32Array(16);class zf extends au{constructor(i){super(i),this.current=Qx}set(i,l,p){if(this.fetchUniformLocation(i,l)){if(p[12]!==this.current[12]||p[0]!==this.current[0])return this.current=p,void this.gl.uniformMatrix4fv(this.location,!1,p);for(let g=1;g<16;g++)if(p[g]!==this.current[g]){this.current=p,this.gl.uniformMatrix4fv(this.location,!1,p);break}}}}const ls=new Float32Array(9),hc=new Float32Array(4);class Rg extends au{constructor(i){super(i),this.current=hc}set(i,l,p){if(this.fetchUniformLocation(i,l)){for(let g=0;g<4;g++)if(p[g]!==this.current[g]){this.current=p,this.gl.uniformMatrix2fv(this.location,!1,p);break}}}}function Sy(u){return[Xx(255*u.r,255*u.g),Xx(255*u.b,255*u.a)]}class Og{constructor(i,l,p,g){this.value=i,this.uniformNames=l.map(b=>`u_${b}`),this.type=p,this.context=g}setUniform(i,l,p,g,b){const x=g.constantOr(this.value);l.set(i,b,x instanceof Mi?x.toPremultipliedRenderColor(this.lutExpression&&this.lutExpression.value==="none"?null:this.context.lut):x)}getBinding(i,l){return this.type==="color"?new Gp(i):new bs(i)}}class qp{constructor(i,l){this.uniformNames=l.map(p=>`u_${p}`),this.pattern=null,this.patternTransition=null,this.pixelRatio=1}setConstantPatternPositions(i,l){this.pixelRatio=i.pixelRatio||1,this.pattern=i.tl.concat(i.br),this.patternTransition=l?l.tl.concat(l.br):this.pattern}setUniform(i,l,p,g,b){let x=null;b!=="u_pattern"&&b!=="u_dash"||(x=this.pattern),b==="u_pattern_b"&&(x=this.patternTransition),b==="u_pixel_ratio"&&(x=this.pixelRatio),x&&l.set(i,b,x)}getBinding(i,l){return l==="u_pattern"||l==="u_pattern_b"||l==="u_dash"?new Dg(i):new bs(i)}}class cu{constructor(i,l,p,g){this.expression=i,this.type=p,this.maxValue=0,this.paintVertexAttributes=l.map(b=>({name:`a_${b}`,type:"Float32",components:p==="color"?2:1,offset:0})),this.paintVertexArray=new g}populatePaintArray(i,l,p,g,b,x,A,R){const O=this.paintVertexArray.length,L=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate(new $i(0,{brightness:x,worldview:R}),l,{},b,g,A):this.expression.kind==="constant"&&this.expression.value,B=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $i(0,{brightness:x,worldview:R}),l,{},b,g,A):this.lutExpression.value)==="none";this.paintVertexArray.resize(i),this._setPaintValue(O,i,L,B?null:this.context.lut)}updatePaintArray(i,l,p,g,b,x,A,R){const O=this.expression.kind==="composite"||this.expression.kind==="source"?this.expression.evaluate({zoom:0,brightness:A,worldview:R},p,g,void 0,b):this.expression.kind==="constant"&&this.expression.value,L=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $i(0,{brightness:A,worldview:R}),p,g,void 0,b):this.lutExpression.value)==="none";this._setPaintValue(i,l,O,L?null:this.context.lut)}_setPaintValue(i,l,p,g){if(this.type==="color"){const b=Sy(p.toPremultipliedRenderColor(g));for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,b[0],b[1])}else{for(let b=i;b<l;b++)this.paintVertexArray.emplace(b,p);this.maxValue=Math.max(this.maxValue,Math.abs(p))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.lutExpression&&this.lutExpression.kind!=="constant"&&(this.lutExpression.isStateDependent||!this.lutExpression.isLightConstant)||this.expression.kind!=="constant"&&(this.expression.isStateDependent||!this.expression.isLightConstant)))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}}class dc{constructor(i,l,p,g,b,x){this.expression=i,this.uniformNames=l.map(A=>`u_${A}_t`),this.type=p,this.useIntegerZoom=g,this.context=b,this.maxValue=0,this.paintVertexAttributes=l.map(A=>({name:`a_${A}`,type:"Float32",components:p==="color"?4:2,offset:0})),this.paintVertexArray=new x}populatePaintArray(i,l,p,g,b,x,A,R){const O=this.expression.evaluate(new $i(this.context.zoom,{brightness:x,worldview:R}),l,{},b,g,A),L=this.expression.evaluate(new $i(this.context.zoom+1,{brightness:x,worldview:R}),l,{},b,g,A),B=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $i(0,{brightness:x,worldview:R}),l,{},b,g,A):this.lutExpression.value)==="none",U=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValue(U,i,O,L,B?null:this.context.lut)}updatePaintArray(i,l,p,g,b,x,A,R){const O=this.expression.evaluate({zoom:this.context.zoom,brightness:A,worldview:R},p,g,void 0,b),L=this.expression.evaluate({zoom:this.context.zoom+1,brightness:A,worldview:R},p,g,void 0,b),B=!!this.lutExpression&&(this.lutExpression.kind==="composite"||this.lutExpression.kind==="source"?this.lutExpression.evaluate(new $i(0,{brightness:A,worldview:R}),p,g,void 0,b):this.lutExpression.value)==="none";this._setPaintValue(i,l,O,L,B?null:this.context.lut)}_setPaintValue(i,l,p,g,b){if(this.type==="color"){const x=Sy(p.toPremultipliedRenderColor(b)),A=Sy(p.toPremultipliedRenderColor(b));for(let R=i;R<l;R++)this.paintVertexArray.emplace(R,x[0],x[1],A[0],A[1])}else{for(let x=i;x<l;x++)this.paintVertexArray.emplace(x,p,g);this.maxValue=Math.max(this.maxValue,Math.abs(p),Math.abs(g))}}upload(i){this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer&&this.paintVertexBuffer.buffer?this.paintVertexBuffer.updateData(this.paintVertexArray):this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,this.expression.isStateDependent||!this.expression.isLightConstant))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy()}setUniform(i,l,p,g,b){const x=this.useIntegerZoom?Math.floor(p.zoom):p.zoom,A=He(this.expression.interpolationFactor(x,this.context.zoom,this.context.zoom+1),0,1);l.set(i,b,A)}getBinding(i,l){return new bs(i)}}class Bl{constructor(i,l,p,g,b){this.expression=i,this.layerId=b,this.paintVertexAttributes=(p==="array"?Q0:Ty).members;for(let x=0;x<l.length;++x);this.paintVertexArray=new g,this.paintTransitionVertexArray=new Of}populatePaintArray(i,l,p,g){const b=this.paintVertexArray.length;this.paintVertexArray.resize(i),this._setPaintValues(b,i,l.patterns&&l.patterns[this.layerId],p)}updatePaintArray(i,l,p,g,b,x,A){this._setPaintValues(i,l,p.patterns&&p.patterns[this.layerId],x)}_setPaintValues(i,l,p,g){if(!g||!p)return;const b=g[p[0]],x=g[p[1]];if(b){if(b){const{tl:A,br:R,pixelRatio:O}=b;for(let L=i;L<l;L++)this.paintVertexArray.emplace(L,A[0],A[1],R[0],R[1],O)}if(x){this.paintTransitionVertexArray.resize(this.paintVertexArray.length);const{tl:A,br:R}=x;for(let O=i;O<l;O++)this.paintTransitionVertexArray.emplace(O,A[0],A[1],R[0],R[1])}}}upload(i){const l=this.expression.isStateDependent||!this.expression.isLightConstant;this.paintVertexArray&&this.paintVertexArray.arrayBuffer&&(this.paintVertexBuffer=i.createVertexBuffer(this.paintVertexArray,this.paintVertexAttributes,l)),this.paintTransitionVertexArray&&this.paintTransitionVertexArray.length&&(this.paintTransitionVertexBuffer=i.createVertexBuffer(this.paintTransitionVertexArray,Ey.members,l))}destroy(){this.paintVertexBuffer&&this.paintVertexBuffer.destroy(),this.paintTransitionVertexBuffer&&this.paintTransitionVertexBuffer.destroy()}}class Bf{constructor(i,l,p=()=>!0){this.binders={},this._buffers=[],this.context=l;const g=[];for(const b in i.paint._values){const x=i.paint.get(b);if(b.endsWith("-use-theme")||!p(b)||!(x instanceof ud&&pg(x.property.specification)))continue;const A=f(b,i.type),R=x.value,O=x.property.specification.type,L=!!x.property.useIntegerZoom,B=b==="line-dasharray"||b.endsWith("pattern"),U=i.paint.get(`${b}-use-theme`),q=b==="line-dasharray"&&i.layout.get("line-cap").value.kind!=="constant"||U&&U.value.kind!=="constant";if(R.kind!=="constant"||q)if(R.kind==="source"||q||B){const Y=E(b,O,"source");this.binders[b]=B?new Bl(R,A,O,Y,i.id):new cu(R,A,O,Y),g.push(`/a_${b}`)}else{const Y=E(b,O,"composite");this.binders[b]=new dc(R,A,O,L,l,Y),g.push(`/z_${b}`)}else this.binders[b]=B?new qp(R.value,A):new Og(R.value,A,O,l),g.push(`/u_${b}`);U&&(this.binders[b].lutExpression=U.value)}this.cacheKey=g.sort().join("")}getMaxValue(i){const l=this.binders[i];return l instanceof cu||l instanceof dc?l.maxValue:0}populatePaintArrays(i,l,p,g,b,x,A,R){for(const O in this.binders){const L=this.binders[O];L.context=this.context,(L instanceof cu||L instanceof dc||L instanceof Bl)&&L.populatePaintArray(i,l,p,g,b,x,A,R)}}setConstantPatternPositions(i,l){for(const p in this.binders){const g=this.binders[p];g instanceof qp&&g.setConstantPatternPositions(i,l)}}getPatternTransitionVertexBuffer(i){const l=this.binders[i];return l instanceof Bl?l.paintTransitionVertexBuffer:null}updatePaintArrays(i,l,p,g,b,x,A,R,O,L){let B=!1;const U=Object.keys(i),q=U.length!==0&&!R,Y=q?U:l.uniqueIds;this.context.lut=b.lut;for(const ne in this.binders){const ae=this.binders[ne];if(ae.context=this.context,(ae instanceof cu||ae instanceof dc||ae instanceof Bl)&&ae.expression&&ae.expression.kind&&ae.expression.kind!=="constant"&&(ae.expression.isStateDependent===!0||ae.expression.isLightConstant===!1)){const he=b.paint.get(ne);ae.expression=he.value;for(const Se of Y){const Ae=i[Se.toString()];l.eachPosition(Se,(re,ye,Oe)=>{const Le=g.feature(re);ae.updatePaintArray(ye,Oe,Le,Ae,x,A,O,L)})}if(!q)for(const Se of p.uniqueIds){const Ae=i[Se.toString()];p.eachPosition(Se,(re,ye,Oe)=>{const Le=g.feature(re);ae.updatePaintArray(ye,Oe,Le,Ae,x,A,O,L)})}B=!0}}return B}defines(){const i=[];for(const l in this.binders){const p=this.binders[l];(p instanceof Og||p instanceof qp)&&i.push(...p.uniformNames.map(g=>`#define HAS_UNIFORM_${g}`))}return i}getBinderAttributes(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof cu||p instanceof dc||p instanceof Bl)for(let g=0;g<p.paintVertexAttributes.length;g++)i.push(p.paintVertexAttributes[g].name);if(p instanceof Bl)for(let g=0;g<Ey.members.length;g++)i.push(Ey.members[g].name)}return i}getBinderUniforms(){const i=[];for(const l in this.binders){const p=this.binders[l];if(p instanceof Og||p instanceof qp||p instanceof dc)for(const g of p.uniformNames)i.push(g)}return i}getPaintVertexBuffers(){return this._buffers}getUniforms(i){const l=[];for(const p in this.binders){const g=this.binders[p];if(g instanceof Og||g instanceof qp||g instanceof dc)for(const b of g.uniformNames)l.push({name:b,property:p,binding:g.getBinding(i,b)})}return l}setUniforms(i,l,p,g,b){for(const{name:x,property:A,binding:R}of p)this.binders[A].setUniform(i,R,b,g.get(A),x)}updatePaintBuffers(){this._buffers=[];for(const i in this.binders){const l=this.binders[i];(l instanceof cu||l instanceof dc||l instanceof Bl)&&l.paintVertexBuffer&&this._buffers.push(l.paintVertexBuffer),l instanceof Bl&&l.paintTransitionVertexBuffer&&this._buffers.push(l.paintTransitionVertexBuffer)}}upload(i){for(const l in this.binders){const p=this.binders[l];(p instanceof cu||p instanceof dc||p instanceof Bl)&&p.upload(i)}this.updatePaintBuffers()}destroy(){for(const i in this.binders){const l=this.binders[i];(l instanceof cu||l instanceof dc||l instanceof Bl)&&l.destroy()}}}class _{constructor(i,l,p=()=>!0){this.programConfigurations={};for(const g of i)this.programConfigurations[g.id]=new Bf(g,l,p);this.needsUpload=!1,this._featureMap=new Sg,this._featureMapWithoutIds=new Sg,this._bufferOffset=0,this._idlessCounter=0}populatePaintArrays(i,l,p,g,b,x,A,R,O){for(const L in this.programConfigurations)this.programConfigurations[L].populatePaintArrays(i,l,g,b,x,A,R,O);l.id!==void 0?this._featureMap.add(l.id,p,this._bufferOffset,i):(this._featureMapWithoutIds.add(this._idlessCounter,p,this._bufferOffset,i),this._idlessCounter+=1),this._bufferOffset=i,this.needsUpload=!0}updatePaintArrays(i,l,p,g,b,x,A,R){for(const O of p)this.needsUpload=this.programConfigurations[O.id].updatePaintArrays(i,this._featureMap,this._featureMapWithoutIds,l,O,g,b,x,A||0,R)||this.needsUpload}get(i){return this.programConfigurations[i]}upload(i){if(this.needsUpload){for(const l in this.programConfigurations)this.programConfigurations[l].upload(i);this.needsUpload=!1}}destroy(){for(const i in this.programConfigurations)this.programConfigurations[i].destroy()}}const o={"text-opacity":["opacity"],"icon-opacity":["opacity"],"text-occlusion-opacity":["occlusion_opacity"],"icon-occlusion-opacity":["occlusion_opacity"],"text-color":["fill_color"],"icon-color":["fill_color"],"text-emissive-strength":["emissive_strength"],"icon-emissive-strength":["emissive_strength"],"text-halo-color":["halo_color"],"icon-halo-color":["halo_color"],"text-halo-blur":["halo_blur"],"icon-halo-blur":["halo_blur"],"text-halo-width":["halo_width"],"icon-halo-width":["halo_width"],"symbol-z-offset":["z_offset"],"line-gap-width":["gapwidth"],"line-pattern":["pattern","pixel_ratio","pattern_b"],"fill-pattern":["pattern","pixel_ratio","pattern_b"],"fill-extrusion-pattern":["pattern","pixel_ratio","pattern_b"],"line-dasharray":["dash"],"fill-bridge-guard-rail-color":["structure_color"],"fill-tunnel-structure-color":["structure_color"]};function f(u,i){return o[u]||[u.replace(`${i}-`,"").replace(/-/g,"_")]}const y={"line-pattern":{source:pd,composite:pd},"fill-pattern":{source:pd,composite:pd},"fill-extrusion-pattern":{source:pd,composite:pd},"line-dasharray":{source:Of,composite:Of}},w={color:{source:_d,composite:Eo},number:{source:fd,composite:_d}};function E(u,i,l){const p=y[u];return p&&p[l]||w[i][l]}vn(Og,"ConstantBinder"),vn(qp,"PatternConstantBinder"),vn(cu,"SourceExpressionBinder"),vn(Bl,"PatternCompositeBinder"),vn(dc,"CompositeExpressionBinder"),vn(Bf,"ProgramConfiguration",{omit:["_buffers"]}),vn(_,"ProgramConfigurationSet");const C=sn/Math.PI/2,M=5,N=6,j=16383,H=64,Z=[H,32,16],W=-C,Q=C;function ce(u,i,l,p=C){return l=bi(l),[u*Math.sin(l)*p,-i*p,u*Math.cos(l)*p]}function se(u,i,l){return ce(Math.cos(bi(u)),Math.sin(bi(u)),i,l)}const ue=63710088e-1,pe=2*Math.PI*ue;class ge{constructor(i,l){if(isNaN(i)||isNaN(l))throw new Error(`Invalid LngLat object: (${i}, ${l})`);if(this.lng=+i,this.lat=+l,this.lat>90||this.lat<-90)throw new Error("Invalid LngLat latitude value: must be between -90 and 90")}wrap(){return new ge(bt(this.lng,-180,180),this.lat)}toArray(){return[this.lng,this.lat]}toString(){return`LngLat(${this.lng}, ${this.lat})`}distanceTo(i){const l=Math.PI/180,p=this.lat*l,g=i.lat*l,b=Math.sin(p)*Math.sin(g)+Math.cos(p)*Math.cos(g)*Math.cos((i.lng-this.lng)*l);return ue*Math.acos(Math.min(b,1))}toBounds(i=0){const l=360*i/40075017,p=l/Math.cos(Math.PI/180*this.lat);return new Pe({lng:this.lng-p,lat:this.lat-l},{lng:this.lng+p,lat:this.lat+l})}toEcef(i){return se(this.lat,this.lng,C+i*C/ue)}static convert(i){if(i instanceof ge)return i;if(Array.isArray(i)&&(i.length===2||i.length===3))return new ge(Number(i[0]),Number(i[1]));if(!Array.isArray(i)&&typeof i=="object"&&i!==null)return new ge(Number("lng"in i?i.lng:i.lon),Number(i.lat));throw new Error("`LngLatLike` argument must be specified as a LngLat instance, an object {lng: <lng>, lat: <lat>}, an object {lon: <lng>, lat: <lat>}, or an array of [<lng>, <lat>]")}}class Pe{constructor(i,l){if(i)if(l)this.setSouthWest(i).setNorthEast(l);else if(i.length===4){const p=i;this.setSouthWest([p[0],p[1]]).setNorthEast([p[2],p[3]])}else{const p=i;this.setSouthWest(p[0]).setNorthEast(p[1])}}setNorthEast(i){return this._ne=i instanceof ge?new ge(i.lng,i.lat):ge.convert(i),this}setSouthWest(i){return this._sw=i instanceof ge?new ge(i.lng,i.lat):ge.convert(i),this}extend(i){const l=this._sw,p=this._ne;let g,b;if(i instanceof ge)g=i,b=i;else{if(!(i instanceof Pe))return Array.isArray(i)?i.length===4||i.every(Array.isArray)?this.extend(Pe.convert(i)):this.extend(ge.convert(i)):typeof i=="object"&&i!==null&&i.hasOwnProperty("lat")&&(i.hasOwnProperty("lon")||i.hasOwnProperty("lng"))?this.extend(ge.convert(i)):this;if(g=i._sw,b=i._ne,!g||!b)return this}return l||p?(l.lng=Math.min(g.lng,l.lng),l.lat=Math.min(g.lat,l.lat),p.lng=Math.max(b.lng,p.lng),p.lat=Math.max(b.lat,p.lat)):(this._sw=new ge(g.lng,g.lat),this._ne=new ge(b.lng,b.lat)),this}getCenter(){return new ge((this._sw.lng+this._ne.lng)/2,(this._sw.lat+this._ne.lat)/2)}getSouthWest(){return this._sw}getNorthEast(){return this._ne}getNorthWest(){return new ge(this.getWest(),this.getNorth())}getSouthEast(){return new ge(this.getEast(),this.getSouth())}getWest(){return this._sw.lng}getSouth(){return this._sw.lat}getEast(){return this._ne.lng}getNorth(){return this._ne.lat}toArray(){return[this._sw.toArray(),this._ne.toArray()]}toString(){return`LngLatBounds(${this._sw.toString()}, ${this._ne.toString()})`}isEmpty(){return!(this._sw&&this._ne)}contains(i){const{lng:l,lat:p}=ge.convert(i);let g=this._sw.lng<=l&&l<=this._ne.lng;return this._sw.lng>this._ne.lng&&(g=this._sw.lng>=l&&l>=this._ne.lng),this._sw.lat<=p&&p<=this._ne.lat&&g}static convert(i){if(i)return i instanceof Pe?i:new Pe(i)}}const Ve=0,Ye=25.5;function qe(u){return pe*Math.cos(u*Math.PI/180)}function je(u){return(180+u)/360}function Ue(u){return(180-180/Math.PI*Math.log(Math.tan(Math.PI/4+u*Math.PI/360)))/360}function We(u,i){return u/qe(i)}function et(u){return 360*u-180}function _t(u){return 360/Math.PI*Math.atan(Math.exp((180-360*u)*Math.PI/180))-90}function ft(u,i){return u*qe(_t(i))}const Mt=85.051129;function Rt(u){return Math.cos(bi(He(u,-85.051129,Mt)))}function jt(u,i){const l=He(i,Ve,Ye),p=Math.pow(2,l);return Rt(u)*pe/(512*p)}function ht(u){return 1/Math.cos(u*Math.PI/180)}function Dt(u,i=0){const l=Math.exp(Math.PI*(1-(u.y+i/sn)/(1<<u.z)*2));return 80150034*l/(l*l+1)/sn/(1<<u.z)}class ot{constructor(i,l,p=0){this.x=+i,this.y=+l,this.z=+p}static fromLngLat(i,l=0){const p=ge.convert(i);return new ot(je(p.lng),Ue(p.lat),We(l,p.lat))}toLngLat(){return new ge(et(this.x),_t(this.y))}toAltitude(){return ft(this.z,this.y)}meterInMercatorCoordinateUnits(){return 1/pe*ht(_t(this.y))}}function At(u,i,l,p,g,b,x,A,R){const O=(i+p)/2,L=(l+g)/2,B=new Lt(O,L);A(B),function(U,q,Y,ne,ae,he){const Se=Y-ae,Ae=ne-he;return Math.abs((ne-q)*Se-(Y-U)*Ae)/Math.hypot(Se,Ae)}(B.x,B.y,b.x,b.y,x.x,x.y)>=R?(At(u,i,l,O,L,b,B,A,R),At(u,O,L,p,g,B,x,A,R)):u.push(x)}function Tt(u,i,l){let p=u[0],g=p.x,b=p.y;i(p);const x=[p];for(let A=1;A<u.length;A++){const R=u[A],{x:O,y:L}=R;i(R),At(x,g,b,O,L,p,R,i,l),g=O,b=L,p=R}return x}function Nt(u,i,l,p){if(p(i,l)){const g=i.add(l)._mult(.5);Nt(u,i,g,p),Nt(u,g,l,p)}else u.push(l)}function Yt(u,i){let l=u[0];const p=[l];for(let g=1;g<u.length;g++){const b=u[g];Nt(p,l,b,i),l=b}return p}const Pt=Math.pow(2,14)-1,qt=-Pt-1;function bn(u,i){const l=Math.round(u.x*i),p=Math.round(u.y*i);return u.x=He(l,qt,Pt),u.y=He(p,qt,Pt),(l<u.x||l>u.x+1||p<u.y||p>u.y+1)&&ii("Geometry exceeds allowed extent, reduce your vector tile buffer size"),u}function fn(u,i,l){const p=u.loadGeometry(),g=u.extent,b=sn/g;if(i&&l&&l.projection.isReprojectedInTileSpace){const x=1<<i.z,{scale:A,x:R,y:O,projection:L}=l,B=U=>{const q=et((i.x+U.x/g)/x),Y=_t((i.y+U.y/g)/x),ne=L.project(q,Y);U.x=(ne.x*A-R)*g,U.y=(ne.y*A-O)*g};for(let U=0;U<p.length;U++)if(u.type!==1)p[U]=Tt(p[U],B,1);else{const q=[];for(const Y of p[U])Y.x<0||Y.x>=g||Y.y<0||Y.y>=g||(B(Y),q.push(Y));p[U]=q}}for(const x of p)for(const A of x)bn(A,b);return p}function pn(u,i){return{type:u.type,id:u.id,properties:u.properties,geometry:i?fn(u):[]}}var Rn,Nn,Bn,Xn,ai,Bi,pr,Gi={};function qi(){if(Nn)return Rn;Nn=1;var u=Ii();function i(g,b,x,A,R){this.properties={},this.extent=x,this.type=0,this._pbf=g,this._geometry=-1,this._keys=A,this._values=R,g.readFields(l,this,b)}function l(g,b,x){g==1?b.id=x.readVarint():g==2?function(A,R){for(var O=A.readVarint()+A.pos;A.pos<O;){var L=R._keys[A.readVarint()],B=R._values[A.readVarint()];R.properties[L]=B}}(x,b):g==3?b.type=x.readVarint():g==4&&(b._geometry=x.pos)}function p(g){for(var b,x,A=0,R=0,O=g.length,L=O-1;R<O;L=R++)A+=((x=g[L]).x-(b=g[R]).x)*(b.y+x.y);return A}return Rn=i,i.types=["Unknown","Point","LineString","Polygon"],i.prototype.loadGeometry=function(){var g=this._pbf;g.pos=this._geometry;for(var b,x=g.readVarint()+g.pos,A=1,R=0,O=0,L=0,B=[];g.pos<x;){if(R<=0){var U=g.readVarint();A=7&U,R=U>>3}if(R--,A===1||A===2)O+=g.readSVarint(),L+=g.readSVarint(),A===1&&(b&&B.push(b),b=[]),b.push(new u(O,L));else{if(A!==7)throw new Error("unknown command "+A);b&&b.push(b[0].clone())}}return b&&B.push(b),B},i.prototype.bbox=function(){var g=this._pbf;g.pos=this._geometry;for(var b=g.readVarint()+g.pos,x=1,A=0,R=0,O=0,L=1/0,B=-1/0,U=1/0,q=-1/0;g.pos<b;){if(A<=0){var Y=g.readVarint();x=7&Y,A=Y>>3}if(A--,x===1||x===2)(R+=g.readSVarint())<L&&(L=R),R>B&&(B=R),(O+=g.readSVarint())<U&&(U=O),O>q&&(q=O);else if(x!==7)throw new Error("unknown command "+x)}return[L,U,B,q]},i.prototype.toGeoJSON=function(g,b,x){var A,R,O=this.extent*Math.pow(2,x),L=this.extent*g,B=this.extent*b,U=this.loadGeometry(),q=i.types[this.type];function Y(he){for(var Se=0;Se<he.length;Se++){var Ae=he[Se];he[Se]=[360*(Ae.x+L)/O-180,360/Math.PI*Math.atan(Math.exp((180-360*(Ae.y+B)/O)*Math.PI/180))-90]}}switch(this.type){case 1:var ne=[];for(A=0;A<U.length;A++)ne[A]=U[A][0];Y(U=ne);break;case 2:for(A=0;A<U.length;A++)Y(U[A]);break;case 3:for(U=function(he){var Se=he.length;if(Se<=1)return[he];for(var Ae,re,ye=[],Oe=0;Oe<Se;Oe++){var Le=p(he[Oe]);Le!==0&&(re===void 0&&(re=Le<0),re===Le<0?(Ae&&ye.push(Ae),Ae=[he[Oe]]):Ae.push(he[Oe]))}return Ae&&ye.push(Ae),ye}(U),A=0;A<U.length;A++)for(R=0;R<U[A].length;R++)Y(U[A][R])}U.length===1?U=U[0]:q="Multi"+q;var ae={type:"Feature",geometry:{type:q,coordinates:U},properties:this.properties};return"id"in this&&(ae.id=this.id),ae},Rn}function cs(){if(Xn)return Bn;Xn=1;var u=qi();function i(p,g){this.version=1,this.name=null,this.extent=4096,this.length=0,this._pbf=p,this._keys=[],this._values=[],this._features=[],p.readFields(l,this,g),this.length=this._features.length}function l(p,g,b){p===15?g.version=b.readVarint():p===1?g.name=b.readString():p===5?g.extent=b.readVarint():p===2?g._features.push(b.pos):p===3?g._keys.push(b.readString()):p===4&&g._values.push(function(x){for(var A=null,R=x.readVarint()+x.pos;x.pos<R;){var O=x.readVarint()>>3;A=O===1?x.readString():O===2?x.readFloat():O===3?x.readDouble():O===4?x.readVarint64():O===5?x.readVarint():O===6?x.readSVarint():O===7?x.readBoolean():null}return A}(b))}return Bn=i,i.prototype.feature=function(p){if(p<0||p>=this._features.length)throw new Error("feature index out of bounds");this._pbf.pos=this._features[p];var g=this._pbf.readVarint()+this._pbf.pos;return new u(this._pbf,g,this.extent,this._keys,this._values)},Bn}function si(){return pr||(pr=1,Gi.VectorTile=function(){if(Bi)return ai;Bi=1;var u=cs();function i(l,p,g){if(l===3){var b=new u(g,g.readVarint()+g.pos);b.length&&(p[b.name]=b)}}return ai=function(l,p){this.layers=l.readFields(i,{},p)},ai}(),Gi.VectorTileFeature=qi(),Gi.VectorTileLayer=cs()),Gi}var li=si();const mi="3d_elevation_id",yr="level";class Us{constructor(){this._valid=!1}reset(i){return this.feature=i,this._valid=!0,this._geometry=i.loadGeometry(),this._geometry.length!==0&&this._geometry[0].length!==0||(this._valid=!1),this}geometry(i,l){return this._valid&&i(l(this._geometry)),this}require(i,l,p){return this.get(i,!0,l,p)}optional(i,l,p){return this.get(i,!1,l,p)}success(){return this._valid}get(i,l,p,g){const b=this.feature.properties.hasOwnProperty(i)?+this.feature.properties[i]:void 0;return this._valid&&b!==void 0&&!Number.isNaN(b)?p(g?g(b):b):l&&(this._valid=!1),this}}class Wi{constructor(i,l){this.featureFunc=i,this.vertexFunc=l}parseFeature(i,l,p){return this.featureFunc(i,l,p)}parseVertex(i,l,p){return this.vertexFunc(i,l,p)}}const ji=new Wi((u,i,l)=>u.reset(i).require(mi,p=>{l.id=p}).optional("fixed_height_relative",p=>{l.constantHeight=p},Ci.decodeRelativeHeight).geometry(p=>{l.bounds=p},ch).success(),(u,i,l)=>u.reset(i).require(mi,p=>{l.id=p}).require("elevation_idx",p=>{l.idx=p}).require("extent",p=>{l.extent=p}).require("height_relative",p=>{l.height=p},Ci.decodeRelativeHeight).geometry(p=>{l.position=p},Ci.getPoint).success()),Zr=new Wi((u,i,l)=>u.reset(i).require(mi,p=>{l.id=p}).optional("fixed_height",p=>{l.constantHeight=p},Ci.decodeMetricHeight).geometry(p=>{l.bounds=p},ch).success(),(u,i,l)=>u.reset(i).require(mi,p=>{l.id=p}).require("elevation_idx",p=>{l.idx=p}).require("extent",p=>{l.extent=p}).require("height",p=>{l.height=p},Ci.decodeMetricHeight).geometry(p=>{l.position=p},Ci.getPoint).success());class Ci{static getPoint(i){return ps(i[0][0].x,i[0][0].y)}static decodeRelativeHeight(i){return 1e-4*i*5}static decodeMetricHeight(i){return 1e-4*i}static parse(i){const l=[],p=[],g=i.length,b=new Us;for(let A=0;A<g;A++){const R=i.feature(A),O=R.properties.hasOwnProperty("version")?String(R.properties.version):void 0,L=(x=O)?x==="1.0.1"?Zr:void 0:ji;if(L===void 0){ii(`Unknown elevation feature version number ${O||"(unknown)"}`);continue}const B=R.properties.hasOwnProperty("type")?R.properties.type:void 0;if(B){if(li.VectorTileFeature.types[R.type]==="Point"&&B==="curve_point"){const U={};L.parseVertex(b,R,U)&&l.push(U)}else if(li.VectorTileFeature.types[R.type]==="Polygon"&&B==="curve_meta"){const U={};L.parseFeature(b,R,U)&&p.push(U)}}}var x;return{vertices:l,features:p}}}class As{constructor(i,l){this.pos=i,this.dir=l}intersectsPlane(i,l,p){const g=xt(l,this.dir);if(Math.abs(g)<1e-6)return!1;const b=((i[0]-this.pos[0])*l[0]+(i[1]-this.pos[1])*l[1])/g;return p[0]=this.pos[0]+this.dir[0]*b,p[1]=this.pos[1]+this.dir[1]*b,!0}}class Tr{constructor(i,l){this.pos=i,this.dir=l}intersectsPlane(i,l,p){const g=Ht(l,this.dir);if(Math.abs(g)<1e-6)return!1;const b=((i[0]-this.pos[0])*l[0]+(i[1]-this.pos[1])*l[1]+(i[2]-this.pos[2])*l[2])/g;return p[0]=this.pos[0]+this.dir[0]*b,p[1]=this.pos[1]+this.dir[1]*b,p[2]=this.pos[2]+this.dir[2]*b,!0}closestPointOnSphere(i,l,p){if(function(q,Y){var ne=q[0],ae=q[1],he=q[2],Se=Y[0],Ae=Y[1],re=Y[2];return Math.abs(ne-Se)<=T*Math.max(1,Math.abs(ne),Math.abs(Se))&&Math.abs(ae-Ae)<=T*Math.max(1,Math.abs(ae),Math.abs(Ae))&&Math.abs(he-re)<=T*Math.max(1,Math.abs(he),Math.abs(re))}(this.pos,i)||l===0)return p[0]=p[1]=p[2]=0,!1;const[g,b,x]=this.dir,A=this.pos[0]-i[0],R=this.pos[1]-i[1],O=this.pos[2]-i[2],L=g*g+b*b+x*x,B=2*(A*g+R*b+O*x),U=B*B-4*L*(A*A+R*R+O*O-l*l);if(U<0){const q=Math.max(-B/2,0),Y=A+g*q,ne=R+b*q,ae=O+x*q,he=Math.hypot(Y,ne,ae);return p[0]=Y*l/he,p[1]=ne*l/he,p[2]=ae*l/he,!1}{const q=(-B-Math.sqrt(U))/(2*L);if(q<0){const Y=Math.hypot(A,R,O);return p[0]=A*l/Y,p[1]=R*l/Y,p[2]=O*l/Y,!1}return p[0]=A+g*q,p[1]=R+b*q,p[2]=O+x*q,!0}}}class mr{constructor(i,l,p,g,b){this.TL=i,this.TR=l,this.BR=p,this.BL=g,this.horizon=b}static fromInvProjectionMatrix(i,l,p){const g=[-1,1,1],b=[1,1,1],x=[1,-1,1],A=[-1,-1,1],R=Tn(g,g,i),O=Tn(b,b,i),L=Tn(x,x,i),B=Tn(A,A,i);return new mr(R,O,L,B,l/p)}}function Er(u,i,l){let p=1/0,g=-1/0;const b=[];for(const x of u){ni(b,x,i);const A=Ht(b,l);p=Math.min(p,A),g=Math.max(g,A)}return[p,g]}function Fi(u,i){let l=!0;for(let p=0;p<u.planes.length;p++){const g=u.planes[p];let b=0;for(let x=0;x<i.length;x++)b+=Ht(g,i[x])+g[3]>=0;if(b===0)return 0;b!==i.length&&(l=!1)}return l?2:1}function ts(u,i){for(const l of u.projections){const p=Er(i,u.points[0],l.axis);if(l.projection[1]<p[0]||l.projection[0]>p[1])return 0}return 1}function No(u,i){let l=0;const p=[0,0,0,0];for(let x=0;x<u.length;x++)p[0]=u[x][0],p[1]=u[x][1],p[2]=u[x][2],p[3]=1,(g=p)[0]*(b=i)[0]+g[1]*b[1]+g[2]*b[2]+g[3]*b[3]>=0&&l++;var g,b;return l}class vr{constructor(i,l){this.points=i||new Array(8).fill([0,0,0]),this.planes=l||new Array(6).fill([0,0,0,0]),this.bounds=Vi.fromPoints(this.points),this.projections=[],this.frustumEdges=[ni([],this.points[2],this.points[3]),ni([],this.points[0],this.points[3]),ni([],this.points[4],this.points[0]),ni([],this.points[5],this.points[1]),ni([],this.points[6],this.points[2]),ni([],this.points[7],this.points[3])];for(const p of this.frustumEdges){const g=[0,-p[2],p[1]],b=[p[2],0,-p[0]];this.projections.push({axis:g,projection:Er(this.points,this.points[0],g)}),this.projections.push({axis:b,projection:Er(this.points,this.points[0],b)})}}static fromInvProjectionMatrix(i,l,p,g){const b=Math.pow(2,p),x=[[-1,1,-1,1],[1,1,-1,1],[1,-1,-1,1],[-1,-1,-1,1],[-1,1,1,1],[1,1,1,1],[1,-1,1,1],[-1,-1,1,1]].map(O=>{const L=Nr([],O,i),B=1/L[3]/l*b;return(U=L)[0]=(q=L)[0]*(Y=[B,B,g?1/L[3]:B,B])[0],U[1]=q[1]*Y[1],U[2]=q[2]*Y[2],U[3]=q[3]*Y[3],U;var U,q,Y}),A=[[0,1,2],[6,5,4],[0,3,7],[2,1,5],[3,2,6],[0,4,5]].map(O=>{const L=dn([],Mn([],ni([],x[O[0]],x[O[1]]),ni([],x[O[2]],x[O[1]]))),B=-Ht(L,x[O[1]]);return L.concat(B)}),R=[];for(let O=0;O<x.length;O++)R.push([x[O][0],x[O][1],x[O][2]]);return new vr(R,A)}intersectsPrecise(i,l,p){for(let g=0;g<l.length;g++)if(!No(i,l[g]))return 0;for(let g=0;g<this.planes.length;g++)if(!No(i,this.planes[g]))return 0;for(const g of p)for(const b of this.frustumEdges){const x=Mn([],g,b),A=ze(x);if(A===0)continue;Fe(x,x,1/A);const R=Er(this.points,this.points[0],x),O=Er(i,this.points[0],x);if(R[0]>O[1]||O[0]>R[1])return 0}return 1}containsPoint(i){for(const l of this.planes){const p=l[3];if(Ht([l[0],l[1],l[2]],i)+p<0)return!1}return!0}}class Vi{static fromPoints(i){const l=[1/0,1/0,1/0],p=[-1/0,-1/0,-1/0];for(const g of i)rn(l,l,g),Xt(p,p,g);return new Vi(l,p)}static fromTileIdAndHeight(i,l,p){const g=1<<i.canonical.z,b=i.canonical.x,x=i.canonical.y;return new Vi([b/g,x/g,l],[(b+1)/g,(x+1)/g,p])}static applyTransform(i,l){const p=i.getCorners();for(let g=0;g<p.length;++g)Tn(p[g],p[g],l);return Vi.fromPoints(p)}static applyTransformFast(i,l){const p=[l[12],l[13],l[14]],g=[...p];for(let b=0;b<3;b++)for(let x=0;x<3;x++){const A=l[4*x+b],R=A*i.min[x],O=A*i.max[x];p[b]+=Math.min(R,O),g[b]+=Math.max(R,O)}return new Vi(p,g)}static projectAabbCorners(i,l){const p=i.getCorners();for(let g=0;g<p.length;++g)Tn(p[g],p[g],l);return p}constructor(i,l){this.min=i,this.max=l,this.center=Fe([],St([],this.min,this.max),.5)}quadrant(i){const l=[i%2==0,i<2],p=$e(this.min),g=$e(this.max);for(let b=0;b<l.length;b++)p[b]=l[b]?this.min[b]:this.center[b],g[b]=l[b]?this.center[b]:this.max[b];return g[2]=this.max[2],new Vi(p,g)}distanceX(i){return Math.max(Math.min(this.max[0],i[0]),this.min[0])-i[0]}distanceY(i){return Math.max(Math.min(this.max[1],i[1]),this.min[1])-i[1]}distanceZ(i){return Math.max(Math.min(this.max[2],i[2]),this.min[2])-i[2]}getCorners(){const i=this.min,l=this.max;return[[i[0],i[1],i[2]],[l[0],i[1],i[2]],[l[0],l[1],i[2]],[i[0],l[1],i[2]],[i[0],i[1],l[2]],[l[0],i[1],l[2]],[l[0],l[1],l[2]],[i[0],l[1],l[2]]]}intersects(i){return this.intersectsAabb(i.bounds)?Fi(i,this.getCorners()):0}intersectsFlat(i){return this.intersectsAabb(i.bounds)?Fi(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsPrecise(i,l){return l||this.intersects(i)?ts(i,this.getCorners()):0}intersectsPreciseFlat(i,l){return l||this.intersectsFlat(i)?ts(i,[[this.min[0],this.min[1],0],[this.max[0],this.min[1],0],[this.max[0],this.max[1],0],[this.min[0],this.max[1],0]]):0}intersectsAabb(i){for(let l=0;l<3;++l)if(this.min[l]>i.max[l]||i.min[l]>this.max[l])return!1;return!0}intersectsAabbXY(i){return!(this.min[0]>i.max[0]||i.min[0]>this.max[0]||this.min[1]>i.max[1]||i.min[1]>this.max[1])}encapsulate(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i.min[l]),this.max[l]=Math.max(this.max[l],i.max[l])}encapsulatePoint(i){for(let l=0;l<3;l++)this.min[l]=Math.min(this.min[l],i[l]),this.max[l]=Math.max(this.max[l],i[l])}closestPoint(i){return[Math.max(Math.min(this.max[0],i[0]),this.min[0]),Math.max(Math.min(this.max[1],i[1]),this.min[1]),Math.max(Math.min(this.max[2],i[2]),this.min[2])]}}vn(Vi,"Aabb");class js{constructor(i,l){this.feature=i,this.metersToTile=l,this.index=0}get(){const i=this.feature.vertices[this.index],l=this.feature.vertexProps[this.index].dir,p=l[1],g=-l[0],b=(i.extent+1)*this.metersToTile;return[new Lt(Math.trunc(i.position[0]+p*b),Math.trunc(i.position[1]+g*b)),new Lt(Math.trunc(i.position[0]-p*b),Math.trunc(i.position[1]-g*b))]}next(){this.index++}valid(){return this.index<this.feature.vertices.length}}class Ca{constructor(i,l,p,g,b,x){if(this.vertices=new Array,this.vertexProps=new Array,this.edges=new Array,this.edgeProps=new Array,this.id=i,this.heightRange={min:p,max:p},this.safeArea=l,this.constantHeight=p,this.constantHeight==null&&(this.constantHeight!=null||g.length!==0)){this.vertices=g,this.edges=b,this.edges=this.edges.filter(A=>{return A.a<this.vertices.length&&A.b<this.vertices.length&&!((R=this.vertices[A.a].position)[0]===(O=this.vertices[A.b].position)[0]&&R[1]===O[1]);var R,O}),this.heightRange={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY};for(const A of this.vertices)this.vertexProps.push({dir:ps(0,0)}),this.heightRange.min=Math.min(this.heightRange.min,A.height),this.heightRange.max=Math.max(this.heightRange.max,A.height);for(const A of this.edges){const R=this.vertices[A.a].position,O=this.vertices[A.b].position,L=Hr(Or(),O,R),B=ho(L),U=Xs(Or(),L,1/B);this.edgeProps.push({vec:L,dir:U,len:B});const q=this.vertexProps[A.a].dir,Y=this.vertexProps[A.b].dir;Ns(q,q,U),Ns(Y,Y,U)}for(const A of this.vertexProps)A.dir[0]===0&&A.dir[1]===0||Ge(A.dir,A.dir);this.tessellate(x)}}pointElevation(i){if(this.constantHeight!=null)return this.constantHeight;const l=this.getClosestEdge(i);if(l==null)return 0;const[p,g]=l;return $n(this.vertices[this.edges[p].a].height,this.vertices[this.edges[p].b].height,g)}computeSlopeNormal(i,l){const p=this.getClosestEdge(i);if(!p)return zt(0,0,1);const g=p[0],b=this.edges[g],x=this.edgeProps[g].vec,A=zt(x[0],x[1],(this.vertices[b.b].height-this.vertices[b.a].height)*l),R=zt(A[1],-A[0],0);Mn(R,R,A);const O=ze(R);return O>0?Fe(R,R,1/O):zt(0,0,1)}getSafeArea(){return this.safeArea}isTunnel(){return this.heightRange.max<=-5}getClosestEdge(i){if(this.edges.length===0)return;let l=0,p=Number.POSITIVE_INFINITY,g=0;const b=ps(i.x,i.y);for(let x=0;x<this.edges.length;x++){const A=this.edges[x],R=this.edgeProps[x].dir,O=new As(b,this.edgeProps[x].dir),L=this.vertices[A.a].position,B=this.vertices[A.b].position,U=Or(),q=Or(),Y=O.intersectsPlane(L,this.vertexProps[A.a].dir,U),ne=O.intersectsPlane(B,this.vertexProps[A.b].dir,q);if(!Y||!ne)continue;const ae=Hr(Or(),q,U),he=Hr(Or(),b,U),Se=xt(ae,ae),Ae=Se>0?xt(he,ae)/Se:0,re=He(Ae,0,1),ye=Math.abs((Ae-re)*this.edgeProps[x].len),Oe=Hr(Or(),b,L),Le=ye+Math.abs(xt(Oe,ps(R[1],-R[0])));Le<p&&(l=x,p=Le,g=re)}return[l,g]}tessellate(i){for(let l=this.edges.length-1;l>=0;--l){const p=this.edges[l].a,g=this.edges[l].b,{position:b,height:x,extent:A}=this.vertices[p],{position:R,height:O,extent:L}=this.vertices[g],B=this.vertexProps[p].dir,U=this.vertexProps[g].dir,q=zt(b[0]/i,b[1]/i,x),Y=zt(R[0]/i,R[1]/i,O),ne=zt(B[1],-B[0],0);Fe(ne,ne,A);const ae=zt(U[1],-U[0],0);if(Fe(ae,ae,L),this.distSqLines(zt(q[0]+.5*ne[0],q[1]+.5*ne[1],q[2]+.5*ne[2]),zt(Y[0]-.5*ae[0],Y[1]-.5*ae[1],Y[2]-.5*ae[2]),zt(q[0]-.5*ne[0],q[1]-.5*ne[1],q[2]-.5*ne[2]),zt(Y[0]+.5*ae[0],Y[1]+.5*ae[1],Y[2]+.5*ae[2]))<=.0025000000000000005)continue;const he=this.vertices.length,Se=Ns(Or(),b,R);this.vertices.push({position:Xs(Se,Se,.5),height:.5*(x+O),extent:.5*(A+L)});const Ae=Ns(Or(),B,U);this.vertexProps.push({dir:Ge(Ae,Ae)}),this.edges.splice(l,1),this.edgeProps.splice(l,1),this.edges.push({a:p,b:he}),this.edges.push({a:he,b:g});const re=Hr(Or(),this.vertices[he].position,b),ye=ho(re),Oe={vec:re,dir:Xs(Or(),re,1/ye),len:ye};this.edgeProps.push(Oe),this.edgeProps.push(Oe)}}distSqLines(i,l,p,g){const b=mt(Ee(),l,i),x=mt(Ee(),g,p),A=mt(Ee(),i,p),R=Ht(b,b),O=Ht(b,x),L=Ht(b,A),B=Ht(x,x),U=Ht(x,A),q=R*B-O*O;if(q===0){const ae=Ht(A,x)/Ht(x,x);return Ut(yn(Ee(),p,g,ae),i)}const Y=(O*U-L*B)/q,ne=(R*U-O*L)/q;return Ut(yn(Ee(),i,l,Y),yn(Ee(),p,g,ne))}}class gl{static parseFrom(i,l){const p=Ci.parse(i);if(!p)return[];let{vertices:g,features:b}=p;const x=1/Dt(l);b.sort((L,B)=>L.id-B.id),g.sort((L,B)=>L.id-B.id||L.idx-B.idx),g=g.filter((L,B,U)=>B===U.findIndex(q=>q.id===L.id&&q.idx===L.idx));const A=new Array;let R=0;const O=g.length;for(const L of b){if(L.constantHeight){A.push(new Ca(L.id,L.bounds,L.constantHeight));continue}for(;R!==O&&g[R].id<L.id;)R++;if(R===O||g[R].id!==L.id)continue;const B=new Array,U=new Array,q=R;for(;R!==O&&g[R].id===L.id;){const Y=g[R];if(B.push({position:Y.position,height:Y.height,extent:Y.extent}),R!==q&&g[R-1].idx===Y.idx-1){const ne=R-q;U.push({a:ne-1,b:ne})}R++}A.push(new Ca(L.id,L.bounds,void 0,B,U,x))}return A}static getElevationFeature(i,l){if(!l)return;const p=+i.properties[mi];return Number.isNaN(p)?void 0:l.find(g=>g.id===p)}}class fc{constructor(i,l){this.zScale=1,this.xOffset=0,this.yOffset=0,i.equals(l)||(this.zScale=Math.pow(2,l.z-i.z),this.xOffset=(i.x*this.zScale-l.x)*sn,this.yOffset=(i.y*this.zScale-l.y)*sn)}constantElevation(i,l){if(i.constantHeight!=null)return this.computeBiasedHeight(i.constantHeight,l)}pointElevation(i,l,p){const g=this.constantElevation(l,p);return g??(i.x=i.x*this.zScale+this.xOffset,i.y=i.y*this.zScale+this.yOffset,this.computeBiasedHeight(l.pointElevation(i),p))}computeBiasedHeight(i,l){return l<=0?i:i+l*at(0,l,i>=0?i:Math.abs(.5*i))}}vn(Ca,"ElevationFeature");class Fl{constructor(i){this.zoom=i.zoom,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.projection=i.projection,this.layoutVertexArray=new uc,this.indexArray=new mo,this.segments=new Yr,this.programConfigurations=new _(i.layers,{zoom:i.zoom,lut:i.lut}),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.elevationMode=this.layers[0].layout.get("circle-elevation-reference"),this.hasElevation=!1,this.elevationMode!=="none"&&(this.elevatedLayoutVertexArray=new fd),this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,p,g){const b=this.layers[0],x=[];let A=null;b.type==="circle"&&(A=b.layout.get("circle-sort-key"));for(const{feature:O,id:L,index:B,sourceLayerIndex:U}of i){const q=this.layers[0]._featureFilter.needGeometry,Y=pn(O,q);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),Y,p))continue;const ne=A?A.evaluate(Y,{},p):void 0,ae={id:L,properties:O.properties,type:O.type,sourceLayerIndex:U,index:B,geometry:q?Y.geometry:fn(O,p,g),patterns:{},sortKey:ne};x.push(ae)}A&&x.sort((O,L)=>O.sortKey-L.sortKey);let R=null;g.projection.name==="globe"&&(this.globeExtVertexArray=new Sa,R=g.projection);for(const O of x){const{geometry:L,index:B,sourceLayerIndex:U}=O,q=i[B].feature;this.addFeature(O,L,B,l.availableImages,p,R,l.brightness,l.elevationFeatures),l.featureIndex.insert(q,L,B,U,this.index)}this.hasElevation||(this.elevatedLayoutVertexArray=void 0)}update(i,l,p,g,b,x,A){this.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,Zx.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.globeExtVertexArray&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,Hp.members)),this.elevatedLayoutVertexArray&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,X0.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy())}addFeature(i,l,p,g,b,x,A,R){let O;this.elevationMode!=="none"&&(O=gl.getElevationFeature(i,R));for(const L of l)for(const B of L){const U=B.x,q=B.y;if(U<0||U>=sn||q<0||q>=sn)continue;if(x){const ae=x.projectTilePoint(U,q,b),he=x.upVector(b,U,q);this.addGlobeExtVertex(ae,he),this.addGlobeExtVertex(ae,he),this.addGlobeExtVertex(ae,he),this.addGlobeExtVertex(ae,he)}const Y=this.segments.prepareSegment(4,this.layoutVertexArray,this.indexArray,i.sortKey),ne=Y.vertexLength;if(this.addCircleVertex(U,q,-1,-1),this.addCircleVertex(U,q,1,-1),this.addCircleVertex(U,q,1,1),this.addCircleVertex(U,q,-1,1),this.elevationMode!=="none"){const ae=O?O.pointElevation(new Lt(U,q)):0;this.hasElevation=this.hasElevation||ae!==0;for(let he=0;he<4;he++)this.elevatedLayoutVertexArray.emplaceBack(ae)}this.indexArray.emplaceBack(ne,ne+1,ne+2),this.indexArray.emplaceBack(ne,ne+2,ne+3),Y.vertexLength+=4,Y.primitiveLength+=2}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,{},g,b,A,void 0,this.worldview)}addCircleVertex(i,l,p,g){this.layoutVertexArray.emplaceBack(2*i+(p+1)/2,2*l+(g+1)/2)}addGlobeExtVertex(i,l){this.globeExtVertexArray.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}}function Qa(u,i){for(let l=0;l<u.length;l++)if(uu(i,u[l]))return!0;for(let l=0;l<i.length;l++)if(uu(u,i[l]))return!0;return!!Oh(u,i)}function vd(u,i,l){return!!uu(u,i)||!!xd(i,u,l)}function pc(u,i){if(u.length===1)return wd(i,u[0]);for(let l=0;l<i.length;l++){const p=i[l];for(let g=0;g<p.length;g++)if(uu(u,p[g]))return!0}for(let l=0;l<u.length;l++)if(wd(i,u[l]))return!0;for(let l=0;l<i.length;l++)if(Oh(u,i[l]))return!0;return!1}function bd(u,i,l){if(u.length>1){if(Oh(u,i))return!0;for(let p=0;p<i.length;p++)if(xd(i[p],u,l))return!0}for(let p=0;p<u.length;p++)if(xd(u[p],i,l))return!0;return!1}function Oh(u,i){if(u.length===0||i.length===0)return!1;for(let l=0;l<u.length-1;l++){const p=u[l],g=u[l+1];for(let b=0;b<i.length-1;b++)if(Wp(p,g,i[b],i[b+1]))return!0}return!1}function Wp(u,i,l,p){return Xi(u,l,p)!==Xi(i,l,p)&&Xi(u,i,l)!==Xi(u,i,p)}function Ff(u,i,l){return(u.x-l.x)*(i.y-l.y)-(u.y-l.y)*(i.x-l.x)}function Ay(u,i,l,p){const g=Ff(u,i,p),b=Ff(u,i,l);if(Math.sign(g)===Math.sign(b))return;const x=Ff(l,p,u),A=x+b-g;return Math.sign(x)!==Math.sign(A)?[x/(x-A),b/(b-g)]:void 0}function xd(u,i,l){const p=l*l;if(i.length===1)return u.distSqr(i[0])<p;for(let g=1;g<i.length;g++)if(Ih(u,i[g-1],i[g])<p)return!0;return!1}function Ih(u,i,l){const p=i.distSqr(l);if(p===0)return u.distSqr(i);const g=((u.x-i.x)*(l.x-i.x)+(u.y-i.y)*(l.y-i.y))/p;return u.distSqr(g<0?i:g>1?l:l.sub(i)._mult(g)._add(i))}function wd(u,i){let l,p,g,b=!1;for(let x=0;x<u.length;x++){l=u[x];for(let A=0,R=l.length-1;A<l.length;R=A++)p=l[A],g=l[R],p.y>i.y!=g.y>i.y&&i.x<(g.x-p.x)*(i.y-p.y)/(g.y-p.y)+p.x&&(b=!b)}return b}function uu(u,i){let l=!1;for(let p=0,g=u.length-1;p<u.length;g=p++){const b=u[p],x=u[g];b.y>i.y!=x.y>i.y&&i.x<(x.x-b.x)*(i.y-b.y)/(x.y-b.y)+b.x&&(l=!l)}return l}function Yp(u,i,l,p,g){for(const x of u)if(i<=x.x&&l<=x.y&&p>=x.x&&g>=x.y)return!0;const b=[new Lt(i,l),new Lt(i,g),new Lt(p,g),new Lt(p,l)];if(u.length>2){for(const x of b)if(uu(u,x))return!0}for(let x=0;x<u.length-1;x++)if(mc(u[x],u[x+1],b))return!0;return!1}function mc(u,i,l){const p=l[0],g=l[2];if(u.x<p.x&&i.x<p.x||u.x>g.x&&i.x>g.x||u.y<p.y&&i.y<p.y||u.y>g.y&&i.y>g.y)return!1;const b=Xi(u,i,l[0]);return b!==Xi(u,i,l[1])||b!==Xi(u,i,l[2])||b!==Xi(u,i,l[3])}function gc(u,i,l,p,g,b){let x=i.y-u.y,A=u.x-i.x;if(b=b||0){const R=x*x+A*A;if(R===0)return!0;const O=Math.sqrt(R);x/=O,A/=O}return!((l.x-u.x)*x+(l.y-u.y)*A-b<0||(p.x-u.x)*x+(p.y-u.y)*A-b<0||(g.x-u.x)*x+(g.y-u.y)*A-b<0)}function Kx(u,i,l,p,g,b,x){return!(gc(u,i,p,g,b,x)||gc(i,l,p,g,b,x)||gc(l,u,p,g,b,x)||gc(p,g,u,i,l,x)||gc(g,b,u,i,l,x)||gc(b,p,u,i,l,x))}function Vf(u,i,l){const p=i.paint.get(u).value;return p.kind==="constant"?p.value:l.programConfigurations.get(i.id).getMaxValue(u)}function Cy(u){return Math.sqrt(u[0]*u[0]+u[1]*u[1])}function Jx(u,i,l,p,g){if(!i[0]&&!i[1])return u;const b=Lt.convert(i)._mult(g);l==="viewport"&&b._rotate(-p);const x=[];for(let A=0;A<u.length;A++)x.push(u[A].sub(b));return x}function RT(u,i,l,p){const g=Lt.convert(u)._mult(p);return i==="viewport"&&g._rotate(-l),g}let OT,sC;function IT(u,i,l){var p=2*Math.PI*6378137/256/Math.pow(2,l);return[u*p-2*Math.PI*6378137/2,i*p-2*Math.PI*6378137/2]}vn(Fl,"CircleBucket",{omit:["layers"]});class Ig{constructor(i,l,p){this.z=i,this.x=l,this.y=p,this.key=Uf(0,i,i,l,p)}equals(i){return this.z===i.z&&this.x===i.x&&this.y===i.y}url(i,l){const p=function(b,x,A){var R=IT(256*b,256*(x=Math.pow(2,A)-x-1),A),O=IT(256*(b+1),256*(x+1),A);return R[0]+","+R[1]+","+O[0]+","+O[1]}(this.x,this.y,this.z),g=function(b,x,A){let R,O="";for(let L=b;L>0;L--)R=1<<L-1,O+=(x&R?1:0)+(A&R?2:0);return O}(this.z,this.x,this.y);return i[(this.x+this.y)%i.length].replace("{prefix}",(this.x%16).toString(16)+(this.y%16).toString(16)).replace(/{z}/g,String(this.z)).replace(/{x}/g,String(this.x)).replace(/{y}/g,String(l==="tms"?Math.pow(2,this.z)-this.y-1:this.y)).replace("{quadkey}",g).replace("{bbox-epsg-3857}",p)}toString(){return`${this.z}/${this.x}/${this.y}`}}class oC{constructor(i,l){this.wrap=i,this.canonical=l,this.key=Uf(i,l.z,l.z,l.x,l.y)}}class Da{constructor(i,l,p,g,b){this.overscaledZ=i,this.wrap=l,this.canonical=new Ig(p,+g,+b),this.key=l===0&&i===p?this.canonical.key:Uf(l,i,p,g,b)}equals(i){return this.overscaledZ===i.overscaledZ&&this.wrap===i.wrap&&this.canonical.equals(i.canonical)}scaledTo(i){const l=this.canonical.z-i;return i>this.canonical.z?new Da(i,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y):new Da(i,this.wrap,i,this.canonical.x>>l,this.canonical.y>>l)}calculateScaledKey(i,l=!0){if(this.overscaledZ===i&&l)return this.key;if(i>this.canonical.z)return Uf(this.wrap*+l,i,this.canonical.z,this.canonical.x,this.canonical.y);{const p=this.canonical.z-i;return Uf(this.wrap*+l,i,i,this.canonical.x>>p,this.canonical.y>>p)}}isChildOf(i){if(i.wrap!==this.wrap)return!1;const l=this.canonical.z-i.canonical.z;return i.overscaledZ===0||i.overscaledZ<this.overscaledZ&&i.canonical.z<this.canonical.z&&i.canonical.x===this.canonical.x>>l&&i.canonical.y===this.canonical.y>>l}children(i){if(this.overscaledZ>=i)return[new Da(this.overscaledZ+1,this.wrap,this.canonical.z,this.canonical.x,this.canonical.y)];const l=this.canonical.z+1,p=2*this.canonical.x,g=2*this.canonical.y;return[new Da(l,this.wrap,l,p,g),new Da(l,this.wrap,l,p+1,g),new Da(l,this.wrap,l,p,g+1),new Da(l,this.wrap,l,p+1,g+1)]}isLessThan(i){return this.wrap<i.wrap||!(this.wrap>i.wrap)&&(this.overscaledZ<i.overscaledZ||!(this.overscaledZ>i.overscaledZ)&&(this.canonical.x<i.canonical.x||!(this.canonical.x>i.canonical.x)&&this.canonical.y<i.canonical.y))}wrapped(){return new Da(this.overscaledZ,0,this.canonical.z,this.canonical.x,this.canonical.y)}unwrapTo(i){return new Da(this.overscaledZ,i,this.canonical.z,this.canonical.x,this.canonical.y)}overscaleFactor(){return Math.pow(2,this.overscaledZ-this.canonical.z)}toUnwrapped(){return new oC(this.wrap,this.canonical)}toString(){return`${this.overscaledZ}/${this.canonical.x}/${this.canonical.y}`}}function Uf(u,i,l,p,g){const b=1<<Math.min(l,22);let x=b*(g%b)+p%b;return u&&l<22&&(x+=b*b*((u<0?-2*u-1:2*u)%(1<<2*(22-l)))),16*(32*x+l)+(i-l)}const MT=[u=>{let i=u.canonical.x-1,l=u.wrap;return i<0&&(i=(1<<u.canonical.z)-1,l--),new Da(u.overscaledZ,l,u.canonical.z,i,u.canonical.y)},u=>{let i=u.canonical.x+1,l=u.wrap;return i===1<<u.canonical.z&&(i=0,l++),new Da(u.overscaledZ,l,u.canonical.z,i,u.canonical.y)},u=>new Da(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,(u.canonical.y===0?1<<u.canonical.z:u.canonical.y)-1),u=>new Da(u.overscaledZ,u.wrap,u.canonical.z,u.canonical.x,u.canonical.y===(1<<u.canonical.z)-1?0:u.canonical.y+1)];vn(Ig,"CanonicalTileID"),vn(Da,"OverscaledTileID",{omit:["projMatrix","expandedProjMatrix"]});const bM=Oi([{type:"Float32",name:"a_globe_pos",components:3},{type:"Float32",name:"a_uv",components:2}]),{members:e1}=bM,aC=Oi([{name:"a_pos_3",components:3,type:"Int16"}]);var PT=Oi([{name:"a_pos",type:"Int16",components:2}]);function Dy(u){return u*C/ue}const lC=[new Vi([W,W,W],[Q,Q,Q]),new Vi([W,W,W],[0,0,Q]),new Vi([0,W,W],[Q,0,Q]),new Vi([W,0,W],[0,Q,Q]),new Vi([0,0,W],[Q,Q,Q])];function t1(u,i,l,p=!0){const g=Fe([],u._camera.position,u.worldSize),b=[i,l,1,1];Nr(b,b,u.pixelMatrixInverse),jr(b,b,1/b[3]);const x=dn([],ni([],b,g)),A=u.globeMatrix,R=[A[12],A[13],A[14]],O=ni([],R,g),L=ze(O),B=dn([],O),U=u.worldSize/(2*Math.PI),q=Ht(B,x),Y=Math.asin(U/L);if(Y<Math.acos(q)){if(!p)return null;const st=[],dt=[];Fe(st,x,L/q),dn(dt,ni(dt,st,O)),dn(x,St(x,O,Fe(x,dt,Math.tan(Y)*L)))}const ne=[];new Tr(g,x).closestPointOnSphere(R,U,ne);const ae=dn([],xr(A,0)),he=dn([],xr(A,1)),Se=dn([],xr(A,2)),Ae=Ht(ae,ne),re=Ht(he,ne),ye=Ht(Se,ne),Oe=gt(Math.asin(-re/U));let Le=gt(Math.atan2(Ae,ye));Le=u.center.lng+function(st,dt){const a=(dt-st+180)%360-180;return a<-180?a+360:a}(u.center.lng,Le);const nt=je(Le),Qe=He(Ue(Oe),0,1);return new ot(nt,Qe)}class cC{constructor(i,l,p){this.a=ni([],i,p),this.b=ni([],l,p),this.center=p;const g=dn([],this.a),b=dn([],this.b);this.angle=Math.acos(Ht(g,b))}}function kT(u,i){if(u.angle===0)return null;let l;return l=u.a[i]===0?1/u.angle*.5*Math.PI:1/u.angle*Math.atan(u.b[i]/u.a[i]/Math.sin(u.angle)-1/Math.tan(u.angle)),l<0||l>1?null:function(p,g,b,x){const A=Math.sin(b);return p*(Math.sin((1-x)*b)/A)+g*(Math.sin(x*b)/A)}(u.a[i],u.b[i],u.angle,He(l,0,1))+u.center[i]}function Td(u){if(u.z<=1)return lC[u.z+2*u.y+u.x];const i=K0(Ry(u));return Vi.fromPoints(i)}function jf(u,i,l){return Fe(u,u,1-l),Ot(u,u,i,l)}function uC(u,i,l){for(const p of u)Tn(p,p,i),Fe(p,p,l)}function n1(u,i,l,p){const g=i/u.worldSize,b=u.globeMatrix;if(l.z<=1){const Qe=Td(l).getCorners();return uC(Qe,b,g),Vi.fromPoints(Qe)}const x=Ry(l,p),A=K0(x,C+Dy(u._tileCoverLift));uC(A,b,g);const R=Number.MAX_VALUE,O=[-R,-R,-R],L=[R,R,R];if(x.contains(u.center)){for(const dt of A)rn(L,L,dt),Xt(O,O,dt);O[2]=0;const Qe=u.point,st=[Qe.x*g,Qe.y*g,0];return rn(L,L,st),Xt(O,O,st),new Vi(L,O)}if(u._tileCoverLift>0){for(const Qe of A)rn(L,L,Qe),Xt(O,O,Qe);return new Vi(L,O)}const B=[b[12]*g,b[13]*g,b[14]*g],U=x.getCenter(),q=He(u.center.lat,-85.051129,Mt),Y=He(U.lat,-85.051129,Mt),ne=je(u.center.lng),ae=Ue(q);let he=ne-je(U.lng);const Se=ae-Ue(Y);he>.5?he-=1:he<-.5&&(he+=1);let Ae=0;Math.abs(he)>Math.abs(Se)?Ae=he>=0?1:3:(Ae=Se>=0?0:2,Ot(B,B,[b[4]*g,b[5]*g,b[6]*g],-Math.sin(bi(Se>=0?x.getSouth():x.getNorth()))*C));const re=A[Ae],ye=A[(Ae+1)%4],Oe=new cC(re,ye,B),Le=[kT(Oe,0)||re[0],kT(Oe,1)||re[1],kT(Oe,2)||re[2]],nt=Mh(u.zoom);if(nt>0){const Qe=function({x:dt,y:a,z:h},v,S,I,k){const K=1/(1<<h);let ee=dt*K,me=ee+K,De=a*K,it=De+K,yt=0;const ct=(ee+me)/2-I;return ct>.5?yt=-1:ct<-.5&&(yt=1),ee=((ee+yt)*v-(I*=v))*S+I,me=((me+yt)*v-I)*S+I,De=(De*v-(k*=v))*S+k,it=(it*v-k)*S+k,[[ee,it,0],[me,it,0],[me,De,0],[ee,De,0]]}(l,i,u._pixelsPerMercatorPixel,ne,ae);for(let dt=0;dt<A.length;dt++)jf(A[dt],Qe[dt],nt);const st=St([],Qe[Ae],Qe[(Ae+1)%4]);Fe(st,st,.5),jf(Le,st,nt)}for(const Qe of A)rn(L,L,Qe),Xt(O,O,Qe);return L[2]=Math.min(re[2],ye[2]),rn(L,L,Le),Xt(O,O,Le),new Vi(L,O)}function Ry({x:u,y:i,z:l},p=!1){const g=1/(1<<l),b=new ge(et(u*g),i===(1<<l)-1&&p?-90:_t((i+1)*g)),x=new ge(et((u+1)*g),i===0&&p?90:_t(i*g));return new Pe(b,x)}function K0(u,i=C){const l=bi(u.getNorth()),p=bi(u.getSouth()),g=Math.cos(l),b=Math.cos(p),x=Math.sin(l),A=Math.sin(p),R=u.getWest(),O=u.getEast();return[ce(b,A,R,i),ce(b,A,O,i),ce(g,x,O,i),ce(g,x,R,i)]}function Oy(u,i,l,p){const g=1<<l.z,b=(u/sn+l.x)/g;return se(_t((i/sn+l.y)/g),et(b),p)}function J0({min:u,max:i}){return j/Math.max(i[0]-u[0],i[1]-u[1],i[2]-u[2])}const Iy=new Float64Array(16);function i1(u){const i=J0(u),l=be(Iy,[i,i,i]);return we(l,l,wn([],u.min))}function r1(u){const i=(p=u.min,(l=Iy)[0]=1,l[1]=0,l[2]=0,l[3]=0,l[4]=0,l[5]=1,l[6]=0,l[7]=0,l[8]=0,l[9]=0,l[10]=1,l[11]=0,l[12]=p[0],l[13]=p[1],l[14]=p[2],l[15]=1,l);var l,p;const g=1/J0(u);return Ie(i,i,[g,g,g])}function My(u){const i=sn/(2*Math.PI);return u/(2*Math.PI)/i}function NT(u,i){return sn/(512*Math.pow(2,u))*J0(Td(i))}function hC(u,i,l,p,g){const b=My(l),x=[u,i,-l/(2*Math.PI)],A=X(new Float64Array(16));return we(A,A,x),Ie(A,A,[b,b,b]),Re(A,A,bi(-g)),Ne(A,A,bi(-p)),A}function Mh(u){return at(M,N,u)}function LT(u,i){const l=se(i.lat,i.lng),p=function(Y){const ne=se(Y._center.lat,Y._center.lng);let ae=Mn([],zt(0,1,0),ne);const he=_e([],-Y.angle,ne);ae=Tn(ae,ae,he),_e(he,-Y._pitch,ae);const Se=dn([],ne);return Fe(Se,Se,Dy(Y.cameraToCenterDistance/Y.pixelsPerMeter)),Tn(Se,Se,he),St([],ne,Se)}(u);return x=(g=mt([],p,l))[0],A=g[1],R=g[2],O=(b=l)[0],L=b[1],B=b[2],q=(U=Math.sqrt(x*x+A*A+R*R)*Math.sqrt(O*O+L*L+B*B))&&Ht(g,b)/U,Math.acos(Math.min(Math.max(q,-1),1));var g,b,x,A,R,O,L,B,U,q}function Mg(u,i){return LT(u,i)>Math.PI/2*1.01}const s1=bi(85),o1=Math.cos(s1),dC=Math.sin(s1),Wo=J(),a1=u=>{const i=[];return u.paint.get("circle-pitch-alignment")==="map"&&i.push("PITCH_WITH_MAP"),u.paint.get("circle-pitch-scale")==="map"&&i.push("SCALE_WITH_MAP"),i};function fC(u,i,l,p,g,b,x,A,R){if(b&&u.queryGeometry.isAboveHorizon)return!1;b&&(R*=u.pixelToTileUnitsFactor);const O=u.tileID.canonical,L=l.projection.upVectorScale(O,l.center.lat,l.worldSize).metersToTile;for(const B of i)for(const U of B){const q=U.add(A),Y=g&&l.elevation?l.elevation.exaggeration()*g.getElevationAt(q.x,q.y,!0):0,ne=l.projection.projectTilePoint(q.x,q.y,O);if(Y>0){const Ae=l.projection.upVector(O,q.x,q.y);ne.x+=Ae[0]*L*Y,ne.y+=Ae[1]*L*Y,ne.z+=Ae[2]*L*Y}const ae=b?q:br(ne.x,ne.y,ne.z,p),he=b?u.tilespaceRays.map(Ae=>Py(Ae,Y)):u.queryGeometry.screenGeometry,Se=Nr([],[ne.x,ne.y,ne.z,1],p);if(!x&&b?R*=Se[3]/l.cameraToCenterDistance:x&&!b&&(R*=l.cameraToCenterDistance/Se[3]),b){const Ae=_t((U.y/sn+O.y)/(1<<O.z));R/=l.projection.pixelsPerMeter(Ae,1)/We(1,Ae)}if(vd(he,ae,R))return!0}return!1}function br(u,i,l,p){const g=Nr([],[u,i,l,1],p);return new Lt(g[0]/g[3],g[1]/g[3])}const pC=zt(0,0,0),Zp=zt(0,0,1);function Py(u,i){const l=Ee();return pC[2]=i,u.intersectsPlane(pC,Zp,l),new Lt(l[0],l[1])}class Pg extends Fl{}let eb,l1,mC,c1;function Ph(u,{width:i,height:l},p,g){if(g){if(g instanceof Uint8ClampedArray)g=new Uint8Array(g.buffer);else if(g.length!==i*l*p)throw new RangeError("mismatched image size")}else g=new Uint8Array(i*l*p);return u.width=i,u.height=l,u.data=g,u}function ky(u,i,l){const{width:p,height:g}=i;p===u.width&&g===u.height||(tb(u,i,{x:0,y:0},{x:0,y:0},{width:Math.min(u.width,p),height:Math.min(u.height,g)},l,null),u.width=p,u.height=g,u.data=i.data)}function tb(u,i,l,p,g,b,x,A){if(g.width===0||g.height===0)return i;if(g.width>u.width||g.height>u.height||l.x>u.width-g.width||l.y>u.height-g.height)throw new RangeError("out of range source coordinates for image copy");if(g.width>i.width||g.height>i.height||p.x>i.width-g.width||p.y>i.height-g.height)throw new RangeError("out of range destination coordinates for image copy");const R=u.data,O=i.data,L=b===4&&A;for(let B=0;B<g.height;B++){const U=((l.y+B)*u.width+l.x)*b,q=((p.y+B)*i.width+p.x)*b;if(L)for(let Y=0;Y<g.width;Y++){const ne=U+Y*b+3,ae=q+Y*b;O[ae+0]=255,O[ae+1]=255,O[ae+2]=255,O[ae+3]=R[ne]}else if(x)for(let Y=0;Y<g.width;Y++){const ne=U+Y*b,ae=q+Y*b,he=new Mi(R[ne+0]/255,R[ne+1]/255,R[ne+2]/255,R[ne+3]).toNonPremultipliedRenderColor(x).toArray();O[ae+0]=he[0],O[ae+1]=he[1],O[ae+2]=he[2],O[ae+3]=he[3]}else for(let Y=0;Y<g.width*b;Y++)O[q+Y]=R[U+Y]}return i}vn(Pg,"HeatmapBucket",{omit:["layers"]});class Ed{constructor(i,l){Ph(this,i,1,l)}resize(i){ky(this,new Ed(i),1)}clone(){return new Ed({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,b){tb(i,l,p,g,b,1,null)}}class go{constructor(i,l){Ph(this,i,4,l)}resize(i){ky(this,new go(i),4)}replace(i,l){l?this.data.set(i):this.data=i instanceof Uint8ClampedArray?new Uint8Array(i.buffer):i}clone(){return new go({width:this.width,height:this.height},new Uint8Array(this.data))}static copy(i,l,p,g,b,x,A){tb(i,l,p,g,b,4,x,A)}}class _c{constructor(i,l){this.width=i.width,this.height=i.height,this.data=l instanceof Uint8Array?new Float32Array(l.buffer):l}}function kg(u){const i={},l=u.resolution||256,p=u.clips?u.clips.length:1,g=u.image||new go({width:l,height:p}),b=(x,A,R)=>{i[u.evaluationKey]=R;const O=u.expression.evaluate(i),L=O?O.toNonPremultipliedRenderColor(null):null;L&&(g.data[x+A+0]=Math.floor(255*L.r),g.data[x+A+1]=Math.floor(255*L.g),g.data[x+A+2]=Math.floor(255*L.b),g.data[x+A+3]=Math.floor(255*L.a))};if(u.clips)for(let x=0,A=0;x<p;++x,A+=4*l)for(let R=0,O=0;R<l;R++,O+=4){const L=R/(l-1),{start:B,end:U}=u.clips[x];b(A,O,B*(1-L)+U*L)}else for(let x=0,A=0;x<l;x++,A+=4)b(0,A,x/(l-1));return g}vn(Ed,"AlphaImage"),vn(go,"RGBAImage");const xM=Oi([{name:"a_pos",components:2,type:"Int16"}],4),gC=Oi([{name:"a_road_z_offset",components:1,type:"Float32"}],4),wM=Oi([{name:"a_pos",components:2,type:"Int16"},{name:"a_height",components:1,type:"Float32"}],4),Ka=Oi([{name:"a_pos_normal_3",components:3,type:"Int16"}],4);function Jt(u,i,l=2){const p=i&&i.length,g=p?i[0]*l:u.length;let b=us(u,0,g,l,!0);const x=[];if(!b||b.next===b.prev)return x;let A,R,O;if(p&&(b=function(L,B,U,q){const Y=[];for(let ne=0,ae=B.length;ne<ae;ne++){const he=us(L,B[ne]*q,ne<ae-1?B[ne+1]*q:L.length,q,!1);he===he.next&&(he.steiner=!0),Y.push(TM(he))}Y.sort(Qp);for(let ne=0;ne<Y.length;ne++)U=u1(Y[ne],U);return U}(u,i,b,l)),u.length>80*l){A=1/0,R=1/0;let L=-1/0,B=-1/0;for(let U=l;U<g;U+=l){const q=u[U],Y=u[U+1];q<A&&(A=q),Y<R&&(R=Y),q>L&&(L=q),Y>B&&(B=Y)}O=Math.max(L-A,B-R),O=O!==0?32767/O:0}return Lg(b,x,l,A,R,O,0),x}function us(u,i,l,p,g){let b;if(g===function(x,A,R,O){let L=0;for(let B=A,U=R-O;B<R;B+=O)L+=(x[U]-x[B])*(x[B+1]+x[U+1]),U=B;return L}(u,i,l,p)>0)for(let x=i;x<l;x+=p)b=vC(x/p|0,u[x],u[x+1],b);else for(let x=l-p;x>=i;x-=p)b=vC(x/p|0,u[x],u[x+1],b);return b&&Kp(b,b.next)&&(Ad(b),b=b.next),b}function Ng(u,i){if(!u)return u;i||(i=u);let l,p=u;do if(l=!1,p.steiner||!Kp(p,p.next)&&_o(p.prev,p,p.next)!==0)p=p.next;else{if(Ad(p),p=i=p.prev,p===p.next)break;l=!0}while(l||p!==i);return i}function Lg(u,i,l,p,g,b,x){if(!u)return;!x&&b&&function(R,O,L,B){let U=R;do U.z===0&&(U.z=ib(U.x,U.y,O,L,B)),U.prevZ=U.prev,U.nextZ=U.next,U=U.next;while(U!==R);U.prevZ.nextZ=null,U.prevZ=null,function(q){let Y,ne=1;do{let ae,he=q;q=null;let Se=null;for(Y=0;he;){Y++;let Ae=he,re=0;for(let Oe=0;Oe<ne&&(re++,Ae=Ae.nextZ,Ae);Oe++);let ye=ne;for(;re>0||ye>0&&Ae;)re!==0&&(ye===0||!Ae||he.z<=Ae.z)?(ae=he,he=he.nextZ,re--):(ae=Ae,Ae=Ae.nextZ,ye--),Se?Se.nextZ=ae:q=ae,ae.prevZ=Se,Se=ae;he=Ae}Se.nextZ=null,ne*=2}while(Y>1)}(U)}(u,p,g,b);let A=u;for(;u.prev!==u.next;){const R=u.prev,O=u.next;if(b?Hf(u,p,g,b):zT(u))i.push(R.i,u.i,O.i),Ad(u),u=O.next,A=O.next;else if((u=O)===A){x?x===1?Lg(u=Xp(Ng(u),i),i,l,p,g,b,2):x===2&&nb(u,i,l,p,g,b):Lg(Ng(u),i,l,p,g,b,1);break}}}function zT(u){const i=u.prev,l=u,p=u.next;if(_o(i,l,p)>=0)return!1;const g=i.x,b=l.x,x=p.x,A=i.y,R=l.y,O=p.y,L=Math.min(g,b,x),B=Math.min(A,R,O),U=Math.max(g,b,x),q=Math.max(A,R,O);let Y=p.next;for(;Y!==i;){if(Y.x>=L&&Y.x<=U&&Y.y>=B&&Y.y<=q&&rb(g,A,b,R,x,O,Y.x,Y.y)&&_o(Y.prev,Y,Y.next)>=0)return!1;Y=Y.next}return!0}function Hf(u,i,l,p){const g=u.prev,b=u,x=u.next;if(_o(g,b,x)>=0)return!1;const A=g.x,R=b.x,O=x.x,L=g.y,B=b.y,U=x.y,q=Math.min(A,R,O),Y=Math.min(L,B,U),ne=Math.max(A,R,O),ae=Math.max(L,B,U),he=ib(q,Y,i,l,p),Se=ib(ne,ae,i,l,p);let Ae=u.prevZ,re=u.nextZ;for(;Ae&&Ae.z>=he&&re&&re.z<=Se;){if(Ae.x>=q&&Ae.x<=ne&&Ae.y>=Y&&Ae.y<=ae&&Ae!==g&&Ae!==x&&rb(A,L,R,B,O,U,Ae.x,Ae.y)&&_o(Ae.prev,Ae,Ae.next)>=0||(Ae=Ae.prevZ,re.x>=q&&re.x<=ne&&re.y>=Y&&re.y<=ae&&re!==g&&re!==x&&rb(A,L,R,B,O,U,re.x,re.y)&&_o(re.prev,re,re.next)>=0))return!1;re=re.nextZ}for(;Ae&&Ae.z>=he;){if(Ae.x>=q&&Ae.x<=ne&&Ae.y>=Y&&Ae.y<=ae&&Ae!==g&&Ae!==x&&rb(A,L,R,B,O,U,Ae.x,Ae.y)&&_o(Ae.prev,Ae,Ae.next)>=0)return!1;Ae=Ae.prevZ}for(;re&&re.z<=Se;){if(re.x>=q&&re.x<=ne&&re.y>=Y&&re.y<=ae&&re!==g&&re!==x&&rb(A,L,R,B,O,U,re.x,re.y)&&_o(re.prev,re,re.next)>=0)return!1;re=re.nextZ}return!0}function Xp(u,i){let l=u;do{const p=l.prev,g=l.next.next;!Kp(p,g)&&h1(p,l,l.next,g)&&zg(p,g)&&zg(g,p)&&(i.push(p.i,l.i,g.i),Ad(l),Ad(l.next),l=u=g),l=l.next}while(l!==u);return Ng(l)}function nb(u,i,l,p,g,b){let x=u;do{let A=x.next.next;for(;A!==x.prev;){if(x.i!==A.i&&Sd(x,A)){let R=yC(x,A);return x=Ng(x,x.next),R=Ng(R,R.next),Lg(x,i,l,p,g,b,0),void Lg(R,i,l,p,g,b,0)}A=A.next}x=x.next}while(x!==u)}function Qp(u,i){let l=u.x-i.x;return l===0&&(l=u.y-i.y,l===0)&&(l=(u.next.y-u.y)/(u.next.x-u.x)-(i.next.y-i.y)/(i.next.x-i.x)),l}function u1(u,i){const l=function(g,b){let x=b;const A=g.x,R=g.y;let O,L=-1/0;if(Kp(g,x))return x;do{if(Kp(g,x.next))return x.next;if(R<=x.y&&R>=x.next.y&&x.next.y!==x.y){const ne=x.x+(R-x.y)*(x.next.x-x.x)/(x.next.y-x.y);if(ne<=A&&ne>L&&(L=ne,O=x.x<x.next.x?x:x.next,ne===A))return O}x=x.next}while(x!==b);if(!O)return null;const B=O,U=O.x,q=O.y;let Y=1/0;x=O;do{if(A>=x.x&&x.x>=U&&A!==x.x&&_C(R<q?A:L,R,U,q,R<q?L:A,R,x.x,x.y)){const ne=Math.abs(R-x.y)/(A-x.x);zg(x,g)&&(ne<Y||ne===Y&&(x.x>O.x||x.x===O.x&&$f(O,x)))&&(O=x,Y=ne)}x=x.next}while(x!==B);return O}(u,i);if(!l)return i;const p=yC(l,u);return Ng(p,p.next),Ng(l,l.next)}function $f(u,i){return _o(u.prev,u,i.prev)<0&&_o(i.next,u,u.next)<0}function ib(u,i,l,p,g){return(u=1431655765&((u=858993459&((u=252645135&((u=16711935&((u=(u-l)*g|0)|u<<8))|u<<4))|u<<2))|u<<1))|(i=1431655765&((i=858993459&((i=252645135&((i=16711935&((i=(i-p)*g|0)|i<<8))|i<<4))|i<<2))|i<<1))<<1}function TM(u){let i=u,l=u;do(i.x<l.x||i.x===l.x&&i.y<l.y)&&(l=i),i=i.next;while(i!==u);return l}function _C(u,i,l,p,g,b,x,A){return(g-x)*(i-A)>=(u-x)*(b-A)&&(u-x)*(p-A)>=(l-x)*(i-A)&&(l-x)*(b-A)>=(g-x)*(p-A)}function rb(u,i,l,p,g,b,x,A){return!(u===x&&i===A)&&_C(u,i,l,p,g,b,x,A)}function Sd(u,i){return u.next.i!==i.i&&u.prev.i!==i.i&&!function(l,p){let g=l;do{if(g.i!==l.i&&g.next.i!==l.i&&g.i!==p.i&&g.next.i!==p.i&&h1(g,g.next,l,p))return!0;g=g.next}while(g!==l);return!1}(u,i)&&(zg(u,i)&&zg(i,u)&&function(l,p){let g=l,b=!1;const x=(l.x+p.x)/2,A=(l.y+p.y)/2;do g.y>A!=g.next.y>A&&g.next.y!==g.y&&x<(g.next.x-g.x)*(A-g.y)/(g.next.y-g.y)+g.x&&(b=!b),g=g.next;while(g!==l);return b}(u,i)&&(_o(u.prev,u,i.prev)||_o(u,i.prev,i))||Kp(u,i)&&_o(u.prev,u,u.next)>0&&_o(i.prev,i,i.next)>0)}function _o(u,i,l){return(i.y-u.y)*(l.x-i.x)-(i.x-u.x)*(l.y-i.y)}function Kp(u,i){return u.x===i.x&&u.y===i.y}function h1(u,i,l,p){const g=d1(_o(u,i,l)),b=d1(_o(u,i,p)),x=d1(_o(l,p,u)),A=d1(_o(l,p,i));return g!==b&&x!==A||!(g!==0||!Gf(u,l,i))||!(b!==0||!Gf(u,p,i))||!(x!==0||!Gf(l,u,p))||!(A!==0||!Gf(l,i,p))}function Gf(u,i,l){return i.x<=Math.max(u.x,l.x)&&i.x>=Math.min(u.x,l.x)&&i.y<=Math.max(u.y,l.y)&&i.y>=Math.min(u.y,l.y)}function d1(u){return u>0?1:u<0?-1:0}function zg(u,i){return _o(u.prev,u,u.next)<0?_o(u,i,u.next)>=0&&_o(u,u.prev,i)>=0:_o(u,i,u.prev)<0||_o(u,u.next,i)<0}function yC(u,i){const l=Ra(u.i,u.x,u.y),p=Ra(i.i,i.x,i.y),g=u.next,b=i.prev;return u.next=i,i.prev=u,l.next=g,g.prev=l,p.next=l,l.prev=p,b.next=p,p.prev=b,p}function vC(u,i,l,p){const g=Ra(u,i,l);return p?(g.next=p.next,g.prev=p,p.next.prev=g,p.next=g):(g.prev=g,g.next=g),g}function Ad(u){u.next.prev=u.prev,u.prev.next=u.next,u.prevZ&&(u.prevZ.nextZ=u.nextZ),u.nextZ&&(u.nextZ.prevZ=u.prevZ)}function Ra(u,i,l){return{i:u,x:i,y:l,prev:null,next:null,z:0,prevZ:null,nextZ:null,steiner:!1}}function ei(u,i){const l=u.length;if(l<=1)return[u];const p=[];let g,b;for(let x=0;x<l;x++){const A=tr(u[x]);A!==0&&(u[x].area=Math.abs(A),b===void 0&&(b=A<0),b===A<0?(g&&p.push(g),g=[u[x]]):g.push(u[x]))}if(g&&p.push(g),i>1)for(let x=0;x<p.length;x++)p[x].length<=i||(Vs(p[x],i,1,p[x].length-1,Cd),p[x]=p[x].slice(0,i));return p}function Cd(u,i){return i.area-u.area}function Nu(u,i,l=1){if(!u)return null;const p=typeof u=="string"?Hi.from(u).getPrimary():u.getPrimary(),g=typeof u=="string"?null:u.getSecondary();for(const b of[p,g]){if(!b)continue;const x=b.id.toString();i.has(x)||i.set(x,[]),b.scaleSelf(l),i.get(x).push(b)}return{primary:p.toString(),secondary:g?g.toString():null}}function Ja(u,i,l,p){const g=p.patternDependencies;let b=!1;for(const x of i){const A=x.paint.get(`${u}-pattern`);A.isConstant()||(b=!0),Nu(A.constantOr(null),g,l)&&(b=!0)}return b}function BT(u,i,l,p,g,b){const x=b.patternDependencies;for(const A of i){const R=A.paint.get(`${u}-pattern`).value;if(R.kind!=="constant"){let O=R.evaluate({zoom:p},l,{},b.availableImages);O=O&&O.name?O.name:O;const L=Nu(O,x,g);if(!L)continue;const{primary:B,secondary:U}=L;B&&(l.patterns[A.id]=[B,U].filter(Boolean))}}return l}class bC{constructor(){this.polygons=new Map}add(i,...l){this.polygons.has(i)?this.polygons.get(i).push(...l):this.polygons.set(i,l)}merge(i){for(const[l,p]of i.polygons)this.add(l,...p)}}class Dd{constructor(){this.portals=[]}static evaluate(i){if(i.length===0)return new Dd;let l=[];for(const O of i)l.push(...O.portals);if(l.length===0)return new Dd;const p=(O,L)=>O<=0&&L<=0||O>=sn&&L>=sn;for(const O of l){const L=O.va,B=O.vb;(p(L.x,B.x)||p(L.y,B.y))&&(O.type="border")}const g=l.filter(O=>O.type!=="unevaluated"),b=l.filter(O=>O.type==="unevaluated");if(b.length===0)return new Dd;b.sort((O,L)=>O.hash===L.hash?O.isTunnel===L.isTunnel?0:O.isTunnel?-1:1:O.hash<L.hash?1:-1),l=g.concat(b);let x=g.length,A=x,R=x;do if(A++,A===l.length||l[x].hash!==l[A].hash){if(A-x==2){R<x&&(l[R]=l[x],l[x]=null);const O=l[R],L=l[A-1];O.type=O.isTunnel!==L.isTunnel?"tunnel":"polygon",O.connection={a:O.connection.a,b:L.connection.a},R++}x=A}while(x!==l.length);return l.splice(R),l.sort((O,L)=>O.hash<L.hash?1:-1),{portals:l}}}vn(Dd,"ElevationPortalGraph"),vn(bC,"ElevationPolygons");class f1{constructor(i,l,p){this.outPositions=i,this.outNormals=l,this.outIndices=p,this.vertexLookup=new Map,this.buffer=new ArrayBuffer(4),this.view=new DataView(this.buffer)}addVertex(i,l,p){let g=i[2];p!=null&&(g*=p);const b=this.getVec3Bits(i)<<96n|this.getVec3Bits(l),x=this.vertexLookup.get(b);if(x!=null)return x;const A=this.outPositions.length;this.vertexLookup.set(b,A);const R=Math.trunc(16384*l[0]),O=Math.trunc(16384*l[1]),L=Math.trunc(16384*l[2]);return this.outPositions.emplaceBack(i[0],i[1],g),this.outNormals.emplaceBack(R,O,L),A}addVertices(i,l,...p){const g=[];for(const b of p){const x=this.addVertex(b,i,l);g.push(x)}return g}addTriangles(i,l,p){if(l&&p){const g=p.length===1,b=zt(0,0,0);for(let x=0;x<i.length;x+=3){const A=l[i[x+0]],R=l[i[x+1]],O=l[i[x+2]],L=g?p[0]:p[i[x+1]],B=g?p[0]:p[i[x+2]],U=this.addVertex(zt(A.x,A.y,g?p[0]:p[i[x+0]]),b),q=this.addVertex(zt(R.x,R.y,L),b),Y=this.addVertex(zt(O.x,O.y,B),b);this.outIndices.emplaceBack(U,q,Y)}}else for(let g=0;g<i.length;g+=3)this.outIndices.emplaceBack(i[g+0],i[g+1],i[g+2])}addQuad(i,l){const p=this.addVertices(l,void 0,...i.map(R=>zt(R.coord.x,R.coord.y,R.height))),[g,b,x,A]=p;this.addTriangles([g,b,x,x,A,g])}getVertexCount(){return this.outPositions.length}clearVertexLookup(){this.vertexLookup.clear()}getBits(i){return this.view.setFloat32(0,i),BigInt(this.view.getUint32(0))}getVec3Bits(i){return this.getBits(i[0])<<64n|this.getBits(i[1])<<32n|this.getBits(i[2])}}class Qs{constructor(i,l,p,g){this.unevaluatedPortals=new Dd,this.portalPolygons=new bC,this.bridgeFeatureSections=[],this.tunnelFeatureSections=[],this.vertexHashLookup=new Map,this.unevalVertices=[],this.unevalHeights=[],this.unevalTriangles=[],this.unevalTunnelTriangles=[],this.unevalEdges=[],this.vertexPositions=new _y,this.vertexNormals=new wg,this.indexArray=new mo,this.tileToMeters=Dt(i),this.bridgeProgramConfigurations=new _(l,{zoom:p,lut:g},b=>b!=="fill-tunnel-structure-color"),this.tunnelProgramConfigurations=new _(l,{zoom:p,lut:g},b=>b!=="fill-bridge-guard-rail-color")}addVertices(i,l){const p=this.unevalVertices.length;for(let g=0;g<i.length;g++)this.unevalVertices.push(i[g]),this.unevalHeights.push(l[g]);return p}addTriangles(i,l,p){const g=p?this.unevalTunnelTriangles:this.unevalTriangles;for(const b of i)g.push(b+l)}addRenderableRing(i,l,p,g,b,x){const A=[new Lt(b.min.x,b.min.y),new Lt(b.max.x,b.min.y),new Lt(b.max.x,b.max.y),new Lt(b.min.x,b.max.y)];for(let R=0;R<p-1;R++){const O=l+R,L=O+1,B=this.unevalVertices[O],U=this.unevalVertices[L];if(!(B.x>=b.min.x&&B.x<=b.max.x&&B.y>=b.min.y&&B.y<=b.max.y||U.x>=b.min.x&&U.x<=b.max.x&&U.y>=b.min.y&&U.y<=b.max.y||mc(B,U,A))||this.isOnBorder(B.x,U.x)||this.isOnBorder(B.y,U.y))continue;const q=Qs.computeEdgeHash(this.unevalVertices[O],this.unevalVertices[L]);let Y,ne=this.vertexHashLookup.get(Qs.computePosHash(B));ne!=null?Y=ne.next:(ne=this.vertexHashLookup.get(Qs.computePosHash(U)),Y=ne!=null?ne.prev:q),this.unevalEdges.push({polygonIdx:i,a:O,b:L,hash:q,portalHash:Y,isTunnel:g,type:"unevaluated",featureInfo:x})}}addPortalCandidates(i,l,p,g,b){if(l.length===0)return;this.portalPolygons.add(i,{geometry:l,zLevel:b});const x=l[0];this.vertexHashLookup.clear();let A=Qs.computeEdgeHash(x[x.length-2],x[x.length-1]);for(let R=0;R<x.length-1;R++){const O=x[R+0],L=x[R+1],B=ps(L.x-O.x,L.y-O.y),U=ho(B);if(U===0)continue;let q="unevaluated";const Y=g.pointElevation(O),ne=g.pointElevation(L);Math.abs(Y)<.01&&Math.abs(ne)<.01?q="entrance":(this.isOnBorder(O.x,L.x)||this.isOnBorder(O.y,L.y))&&(q="border");const ae=Qs.computeEdgeHash(O,L);this.unevaluatedPortals.portals.push({connection:{a:i,b:void 0},va:O,vb:L,vab:B,length:U,hash:ae,isTunnel:p,type:q});const he=Qs.computePosHash(O);this.vertexHashLookup.set(he,{prev:A,next:ae}),A=ae}}construct(i){if(this.unevalVertices.length===0)return;const l=()=>({vertexOffset:0,primitiveOffset:this.indexArray.length}),p=U=>{U.primitiveLength=this.indexArray.length-U.primitiveOffset},g=new f1(this.vertexPositions,this.vertexNormals,this.indexArray);this.prepareEdges(i.portals,this.unevalEdges);const b=l(),x=l(),A=l(),R=(U,q)=>{U.sort((ne,ae)=>ne.type===q&&ae.type!==q?-1:ne.type!==q&&ae.type===q?1:0);const Y=U.findIndex(ne=>ne.type!==q);return Y>=0?Y:U.length};let O=0;this.unevalEdges.length>0&&(O=R(this.unevalEdges,"none"),this.constructBridgeStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},this.tileToMeters)),p(A);const L=l(),B=l();if(this.unevalEdges.length>0){const U=this.unevalEdges.splice(O),q=R(U,"tunnel")+O;this.unevalEdges.push(...U),this.constructTunnelStructures(g,this.unevalVertices,this.unevalHeights,this.unevalEdges,{min:0,max:O},{min:O,max:q})}p(L),g.addTriangles(this.unevalTriangles,this.unevalVertices,this.unevalHeights),p(B),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,this.unevalHeights),p(x),g.addTriangles(this.unevalTunnelTriangles,this.unevalVertices,[-.1]),p(b),this.maskSegments=Yr.simpleSegment(0,B.primitiveOffset,0,B.primitiveLength),this.depthSegments=Yr.simpleSegment(0,x.primitiveOffset,0,x.primitiveLength),this.renderableBridgeSegments=Yr.simpleSegment(0,A.primitiveOffset,0,A.primitiveLength),this.renderableTunnelSegments=Yr.simpleSegment(0,L.primitiveOffset,0,L.primitiveLength),this.shadowCasterSegments=Yr.simpleSegment(0,b.primitiveOffset,0,b.primitiveLength)}update(i,l,p,g,b,x,A,R){this.bridgeProgramConfigurations.updatePaintArrays(i,l,b,p,g,x,A,R),this.tunnelProgramConfigurations.updatePaintArrays(i,l,b,p,g,x,A,R)}upload(i){this.vertexBuffer||this.vertexPositions.length===0||this.vertexNormals.length===0||this.indexArray.length===0||(this.vertexBuffer=i.createVertexBuffer(this.vertexPositions,wM.members),this.vertexBufferNormal=i.createVertexBuffer(this.vertexNormals,Ka.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.bridgeProgramConfigurations.upload(i),this.tunnelProgramConfigurations.upload(i))}destroy(){this.vertexBuffer&&(this.vertexBuffer.destroy(),this.vertexBufferNormal.destroy(),this.indexBuffer.destroy()),this.maskSegments&&(this.maskSegments.destroy(),this.depthSegments.destroy(),this.renderableBridgeSegments.destroy(),this.renderableTunnelSegments.destroy(),this.shadowCasterSegments.destroy()),this.bridgeProgramConfigurations.destroy(),this.tunnelProgramConfigurations.destroy()}populatePaintArrays(i,l,p,g,b){const x=(A,R)=>{for(let O=0;O<R.length-1;O++){const L=R[O].featureIndex,B=R[O+1].vertexStart,U=i.feature(L);A.populatePaintArrays(B,U,L,{},p,l,g,void 0,b)}};x(this.bridgeProgramConfigurations,this.bridgeFeatureSections),x(this.tunnelProgramConfigurations,this.tunnelFeatureSections)}computeVertexConnections(i,l,p,g,b){const x=new Map;for(let A=g;A<b;A++){const R=p[A],O=R.a,L=R.b,B=Qs.computePosHash(i[O]),U=Qs.computePosHash(i[L]);x.has(B)||x.set(B,{}),x.has(U)||x.set(U,{});const q=x.get(B),Y=x.get(U);l[O]<=0&&l[L]<=0||(q.to=L,Y.from=O)}return x}constructBridgeStructures(i,l,p,g,b,x){i.clearVertexLookup();const A=this.computeVertexConnections(l,p,g,b.min,b.max),R=1/x,O=.5*R,L=q=>zt(l[q].x,l[q].y,p[q]*R),B=q=>{const Y=A.get(Qs.computePosHash(l[q])),ne=Y.from,ae=Y.to;if(!ne||!ae)return;const he=L(ne),Se=L(q),Ae=L(ae),re=zt(0,0,0);if(!Bt(he,Se)){const Oe=ni(Ee(),Se,he);St(re,re,dn(Oe,Oe))}if(!Bt(Ae,Se)){const Oe=ni(Ee(),Ae,Se);St(re,re,dn(Oe,Oe))}const ye=_r(re);return ye>0?Fe(re,re,1/ye):void 0};let U=Number.POSITIVE_INFINITY;this.sortSubarray(g,b.min,b.max,(q,Y)=>q.featureInfo.featureIndex-Y.featureInfo.featureIndex);for(let q=b.min;q<b.max;q++){const Y=g[q];if(!Y.featureInfo.guardRailEnabled)continue;const ne=this.prepareEdgePoints(l,p,Y,(mn,tn)=>mn>tn);if(ne==null)continue;const ae=ne[0],he=ne[1],Se=zt(ae.coord.x,ae.coord.y,R*ae.height),Ae=zt(he.coord.x,he.coord.y,R*he.height);if(Bt(Se,Ae))continue;const re=ni(Ee(),Ae,Se);dn(re,re);const ye=mn=>dn(mn,mn),Oe=B(Y.a)||re,Le=B(Y.b)||re,nt=ye(zt(Oe[1],-Oe[0],0)),Qe=ye(zt(Le[1],-Le[0],0)),st=ye(Mn(Ee(),nt,Oe)),dt=ye(Mn(Ee(),Qe,Le)),a=Ee(),h=[St(Ee(),Se,Fe(a,ni(a,nt,st),O)),St(Ee(),Se,Fe(a,St(a,nt,st),O)),St(Ee(),Se,Fe(a,st,O)),Se],v=[St(Ee(),Ae,Fe(a,ni(a,Qe,dt),O)),St(Ee(),Ae,Fe(a,St(a,Qe,dt),O)),St(Ee(),Ae,Fe(a,dt,O)),Ae];U=this.addFeatureSection(Y.featureInfo.featureIndex,U,this.bridgeFeatureSections,i);const[S,I]=i.addVertices(nt,x,h[0],h[1]),[k,K]=i.addVertices(Qe,x,v[0],v[1]);i.addTriangles([S,I,k,I,K,k]);const[ee,me]=i.addVertices(st,x,h[1],h[2]),[De,it]=i.addVertices(dt,x,v[1],v[2]);i.addTriangles([ee,me,De,me,it,De]);const[yt,ct]=i.addVertices(wn(nt,nt),x,h[2],h[3]),[ut,Ct]=i.addVertices(wn(Qe,Qe),x,v[2],v[3]);i.addTriangles([yt,ct,ut,ct,Ct,ut])}this.bridgeFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}constructTunnelStructures(i,l,p,g,b,x){i.clearVertexLookup();let A=Number.POSITIVE_INFINITY;const R=(L,B)=>L.featureInfo.featureIndex-B.featureInfo.featureIndex;this.sortSubarray(g,b.min,b.max,R),this.sortSubarray(g,x.min,x.max,R);const O=L=>dn(L,L);for(let L=b.min;L<b.max;L++){const B=this.prepareEdgePoints(l,p,g[L],(ne,ae)=>ne<ae);if(B==null)continue;const[U,q]=B,Y=O(zt(-(q.coord.y-U.coord.y),q.coord.x-U.coord.x,0));A=this.addFeatureSection(g[L].featureInfo.featureIndex,A,this.tunnelFeatureSections,i),i.addQuad([U,q,{coord:q.coord,height:g[L].isTunnel?-.1:0},{coord:U.coord,height:g[L].isTunnel?-.1:0}],Y)}for(let L=x.min;L<x.max;L++){const B=g[L];B.isTunnel&&([B.a,B.b]=[B.b,B.a]);const U=l[B.a],q=l[B.b],Y=O(zt(-(q.y-U.y),q.x-U.x,0));A=this.addFeatureSection(B.featureInfo.featureIndex,A,this.tunnelFeatureSections,i),i.addQuad([{coord:q,height:0},{coord:U,height:0},{coord:U,height:p[B.a]+4},{coord:q,height:p[B.b]+4}],Y),i.addQuad([{coord:U,height:0},{coord:q,height:0},{coord:q,height:p[B.b]+4},{coord:U,height:p[B.a]+4}],Y)}this.tunnelFeatureSections.push({featureIndex:Number.POSITIVE_INFINITY,vertexStart:i.getVertexCount()})}prepareEdgePoints(i,l,p,g){let b=l[p.a],x=l[p.b];const A=g(b,0),R=g(x,0);if(A&&R)return[{coord:i[p.a],height:b},{coord:i[p.b],height:x}];if(!A&&!R)return;const O=i[p.a].clone(),L=i[p.b].clone();if(A){if(!R){const B=x/(x-b);L.x=$n(L.x,O.x,B),L.y=$n(L.y,O.y,B),x=$n(x,b,B)}}else{const B=b/(b-x);O.x=$n(O.x,L.x,B),O.y=$n(O.y,L.y,B),b=$n(b,x,B)}return[{coord:O,height:b},{coord:L,height:x}]}prepareEdges(i,l){if(l.length===0)return;l.sort((A,R)=>A.hash===R.hash?R.polygonIdx-A.polygonIdx:R.hash>A.hash?1:-1);let p=0,g=0,b=0,x=l[p].polygonIdx;do g++,(g===l.length||l[p].hash!==l[g].hash)&&((g-p==1||l[g-1].polygonIdx!==x)&&(b<p&&(l[b]=l[p],l[p]=null),l[b].type="none",b++),p=g,p!==l.length&&(x=l[p].polygonIdx));while(p!==l.length);if(l.splice(b),l.length!==0&&i.length!==0){l.sort((O,L)=>O.portalHash<L.portalHash?1:-1);let A=0,R=0;for(;A!==l.length&&R!==i.length;){const O=l[A],L=i[R];O.portalHash>L.hash?A++:L.hash>O.portalHash?R++:(O.type=L.type,A++)}}}isOnBorder(i,l){return i<=0&&l<=0||i>=sn&&l>=sn}addFeatureSection(i,l,p,g){return i!==l&&(l=i,p.push({featureIndex:i,vertexStart:g.getVertexCount()}),g.clearVertexLookup()),l}sortSubarray(i,l,p,g){const b=i.slice(l,p);b.sort(g),i.splice(l,b.length,...b)}static computeEdgeHash(i,l){return(i.y===l.y&&i.x>l.x||i.y>l.y)&&([i,l]=[l,i]),BigInt(Qs.computePosHash(i))<<32n|BigInt(Qs.computePosHash(l))}static computePosHash(i){return((65535&i.x)<<16|65535&i.y)>>>0}}var kh,Rd={exports:{}},sb=(kh||(kh=1,function(u,i){(function(l){function p(Ce,Me){return Ce>Me?1:Ce<Me?-1:0}var g=function(Ce,Me){Ce===void 0&&(Ce=p),Me===void 0&&(Me=!1),this._compare=Ce,this._root=null,this._size=0,this._noDuplicates=!!Me},b={size:{configurable:!0}};function x(Ce,Me,wt,Wt,un){var hn=un-Wt;if(hn>0){var En=Wt+Math.floor(hn/2),Zn={key:Me[En],data:wt[En],parent:Ce};return Zn.left=x(Zn,Me,wt,Wt,En),Zn.right=x(Zn,Me,wt,En+1,un),Zn}return null}function A(Ce,Me,wt,Wt,un){if(!(wt>=Wt)){for(var hn=Ce[wt+Wt>>1],En=wt-1,Zn=Wt+1;;){do En++;while(un(Ce[En],hn)<0);do Zn--;while(un(Ce[Zn],hn)>0);if(En>=Zn)break;var xi=Ce[En];Ce[En]=Ce[Zn],Ce[Zn]=xi,xi=Me[En],Me[En]=Me[Zn],Me[Zn]=xi}A(Ce,Me,wt,Zn,un),A(Ce,Me,Zn+1,Wt,un)}}g.prototype.rotateLeft=function(Ce){var Me=Ce.right;Me&&(Ce.right=Me.left,Me.left&&(Me.left.parent=Ce),Me.parent=Ce.parent),Ce.parent?Ce===Ce.parent.left?Ce.parent.left=Me:Ce.parent.right=Me:this._root=Me,Me&&(Me.left=Ce),Ce.parent=Me},g.prototype.rotateRight=function(Ce){var Me=Ce.left;Me&&(Ce.left=Me.right,Me.right&&(Me.right.parent=Ce),Me.parent=Ce.parent),Ce.parent?Ce===Ce.parent.left?Ce.parent.left=Me:Ce.parent.right=Me:this._root=Me,Me&&(Me.right=Ce),Ce.parent=Me},g.prototype._splay=function(Ce){for(;Ce.parent;){var Me=Ce.parent;Me.parent?Me.left===Ce&&Me.parent.left===Me?(this.rotateRight(Me.parent),this.rotateRight(Me)):Me.right===Ce&&Me.parent.right===Me?(this.rotateLeft(Me.parent),this.rotateLeft(Me)):Me.left===Ce&&Me.parent.right===Me?(this.rotateRight(Me),this.rotateLeft(Me)):(this.rotateLeft(Me),this.rotateRight(Me)):Me.left===Ce?this.rotateRight(Me):this.rotateLeft(Me)}},g.prototype.splay=function(Ce){for(var Me,wt,Wt,un,hn;Ce.parent;)(wt=(Me=Ce.parent).parent)&&wt.parent?((Wt=wt.parent).left===wt?Wt.left=Ce:Wt.right=Ce,Ce.parent=Wt):(Ce.parent=null,this._root=Ce),un=Ce.left,hn=Ce.right,Ce===Me.left?(wt&&(wt.left===Me?(Me.right?(wt.left=Me.right,wt.left.parent=wt):wt.left=null,Me.right=wt,wt.parent=Me):(un?(wt.right=un,un.parent=wt):wt.right=null,Ce.left=wt,wt.parent=Ce)),hn?(Me.left=hn,hn.parent=Me):Me.left=null,Ce.right=Me,Me.parent=Ce):(wt&&(wt.right===Me?(Me.left?(wt.right=Me.left,wt.right.parent=wt):wt.right=null,Me.left=wt,wt.parent=Me):(hn?(wt.left=hn,hn.parent=wt):wt.left=null,Ce.right=wt,wt.parent=Ce)),un?(Me.right=un,un.parent=Me):Me.right=null,Ce.left=Me,Me.parent=Ce)},g.prototype.replace=function(Ce,Me){Ce.parent?Ce===Ce.parent.left?Ce.parent.left=Me:Ce.parent.right=Me:this._root=Me,Me&&(Me.parent=Ce.parent)},g.prototype.minNode=function(Ce){if(Ce===void 0&&(Ce=this._root),Ce)for(;Ce.left;)Ce=Ce.left;return Ce},g.prototype.maxNode=function(Ce){if(Ce===void 0&&(Ce=this._root),Ce)for(;Ce.right;)Ce=Ce.right;return Ce},g.prototype.insert=function(Ce,Me){var wt=this._root,Wt=null,un=this._compare;if(this._noDuplicates)for(;wt;){if(Wt=wt,un(wt.key,Ce)===0)return;wt=un(wt.key,Ce)<0?wt.right:wt.left}else for(;wt;)Wt=wt,wt=un(wt.key,Ce)<0?wt.right:wt.left;return wt={key:Ce,data:Me,left:null,right:null,parent:Wt},Wt?un(Wt.key,wt.key)<0?Wt.right=wt:Wt.left=wt:this._root=wt,this.splay(wt),this._size++,wt},g.prototype.find=function(Ce){for(var Me=this._root,wt=this._compare;Me;){var Wt=wt(Me.key,Ce);if(Wt<0)Me=Me.right;else{if(!(Wt>0))return Me;Me=Me.left}}return null},g.prototype.contains=function(Ce){for(var Me=this._root,wt=this._compare;Me;){var Wt=wt(Ce,Me.key);if(Wt===0)return!0;Me=Wt<0?Me.left:Me.right}return!1},g.prototype.remove=function(Ce){var Me=this.find(Ce);if(!Me)return!1;if(this.splay(Me),Me.left)if(Me.right){var wt=this.minNode(Me.right);wt.parent!==Me&&(this.replace(wt,wt.right),wt.right=Me.right,wt.right.parent=wt),this.replace(Me,wt),wt.left=Me.left,wt.left.parent=wt}else this.replace(Me,Me.left);else this.replace(Me,Me.right);return this._size--,!0},g.prototype.removeNode=function(Ce){if(!Ce)return!1;if(this.splay(Ce),Ce.left)if(Ce.right){var Me=this.minNode(Ce.right);Me.parent!==Ce&&(this.replace(Me,Me.right),Me.right=Ce.right,Me.right.parent=Me),this.replace(Ce,Me),Me.left=Ce.left,Me.left.parent=Me}else this.replace(Ce,Ce.left);else this.replace(Ce,Ce.right);return this._size--,!0},g.prototype.erase=function(Ce){var Me=this.find(Ce);if(Me){this.splay(Me);var wt=Me.left,Wt=Me.right,un=null;wt&&(wt.parent=null,un=this.maxNode(wt),this.splay(un),this._root=un),Wt&&(wt?un.right=Wt:this._root=Wt,Wt.parent=un),this._size--}},g.prototype.pop=function(){var Ce=this._root,Me=null;if(Ce){for(;Ce.left;)Ce=Ce.left;Me={key:Ce.key,data:Ce.data},this.remove(Ce.key)}return Me},g.prototype.next=function(Ce){var Me=Ce;if(Me)if(Me.right)for(Me=Me.right;Me&&Me.left;)Me=Me.left;else for(Me=Ce.parent;Me&&Me.right===Ce;)Ce=Me,Me=Me.parent;return Me},g.prototype.prev=function(Ce){var Me=Ce;if(Me)if(Me.left)for(Me=Me.left;Me&&Me.right;)Me=Me.right;else for(Me=Ce.parent;Me&&Me.left===Ce;)Ce=Me,Me=Me.parent;return Me},g.prototype.forEach=function(Ce){for(var Me=this._root,wt=[],Wt=!1,un=0;!Wt;)Me?(wt.push(Me),Me=Me.left):wt.length>0?(Ce(Me=wt.pop(),un++),Me=Me.right):Wt=!0;return this},g.prototype.range=function(Ce,Me,wt,Wt){for(var un=[],hn=this._compare,En=this._root;un.length!==0||En;)if(En)un.push(En),En=En.left;else{if(hn((En=un.pop()).key,Me)>0)break;if(hn(En.key,Ce)>=0&&wt.call(Wt,En))return this;En=En.right}return this},g.prototype.keys=function(){for(var Ce=this._root,Me=[],wt=[],Wt=!1;!Wt;)Ce?(Me.push(Ce),Ce=Ce.left):Me.length>0?(Ce=Me.pop(),wt.push(Ce.key),Ce=Ce.right):Wt=!0;return wt},g.prototype.values=function(){for(var Ce=this._root,Me=[],wt=[],Wt=!1;!Wt;)Ce?(Me.push(Ce),Ce=Ce.left):Me.length>0?(Ce=Me.pop(),wt.push(Ce.data),Ce=Ce.right):Wt=!0;return wt},g.prototype.at=function(Ce){for(var Me=this._root,wt=[],Wt=!1,un=0;!Wt;)if(Me)wt.push(Me),Me=Me.left;else if(wt.length>0){if(Me=wt.pop(),un===Ce)return Me;un++,Me=Me.right}else Wt=!0;return null},g.prototype.load=function(Ce,Me,wt){if(Ce===void 0&&(Ce=[]),Me===void 0&&(Me=[]),wt===void 0&&(wt=!1),this._size!==0)throw new Error("bulk-load: tree is not empty");var Wt=Ce.length;return wt&&A(Ce,Me,0,Wt-1,this._compare),this._root=x(null,Ce,Me,0,Wt),this._size=Wt,this},g.prototype.min=function(){var Ce=this.minNode(this._root);return Ce?Ce.key:null},g.prototype.max=function(){var Ce=this.maxNode(this._root);return Ce?Ce.key:null},g.prototype.isEmpty=function(){return this._root===null},b.size.get=function(){return this._size},g.createTree=function(Ce,Me,wt,Wt,un){return new g(wt,un).load(Ce,Me,Wt)},Object.defineProperties(g.prototype,b);var R=0,O=1,L=2,B=3,U=0,q=1,Y=2,ne=3;function ae(Ce,Me,wt){Me===null?(Ce.inOut=!1,Ce.otherInOut=!0):(Ce.isSubject===Me.isSubject?(Ce.inOut=!Me.inOut,Ce.otherInOut=Me.otherInOut):(Ce.inOut=!Me.otherInOut,Ce.otherInOut=Me.isVertical()?!Me.inOut:Me.inOut),Me&&(Ce.prevInResult=!he(Me,wt)||Me.isVertical()?Me.prevInResult:Me));var Wt=he(Ce,wt);Ce.resultTransition=Wt?function(un,hn){var En,Zn=!un.inOut,xi=!un.otherInOut;switch(hn){case U:En=Zn&&xi;break;case q:En=Zn||xi;break;case ne:En=Zn^xi;break;case Y:En=un.isSubject?Zn&&!xi:xi&&!Zn}return En?1:-1}(Ce,wt):0}function he(Ce,Me){switch(Ce.type){case R:switch(Me){case U:return!Ce.otherInOut;case q:return Ce.otherInOut;case Y:return Ce.isSubject&&Ce.otherInOut||!Ce.isSubject&&!Ce.otherInOut;case ne:return!0}break;case L:return Me===U||Me===q;case B:return Me===Y;case O:return!1}return!1}var Se=function(Ce,Me,wt,Wt,un){this.left=Me,this.point=Ce,this.otherEvent=wt,this.isSubject=Wt,this.type=un||R,this.inOut=!1,this.otherInOut=!1,this.prevInResult=null,this.resultTransition=0,this.otherPos=-1,this.outputContourId=-1,this.isExteriorRing=!0},Ae={inResult:{configurable:!0}};function re(Ce,Me){return Ce[0]===Me[0]&&Ce[1]===Me[1]}Se.prototype.isBelow=function(Ce){var Me=this.point,wt=this.otherEvent.point;return this.left?(Me[0]-Ce[0])*(wt[1]-Ce[1])-(wt[0]-Ce[0])*(Me[1]-Ce[1])>0:(wt[0]-Ce[0])*(Me[1]-Ce[1])-(Me[0]-Ce[0])*(wt[1]-Ce[1])>0},Se.prototype.isAbove=function(Ce){return!this.isBelow(Ce)},Se.prototype.isVertical=function(){return this.point[0]===this.otherEvent.point[0]},Ae.inResult.get=function(){return this.resultTransition!==0},Se.prototype.clone=function(){var Ce=new Se(this.point,this.left,this.otherEvent,this.isSubject,this.type);return Ce.contourId=this.contourId,Ce.resultTransition=this.resultTransition,Ce.prevInResult=this.prevInResult,Ce.isExteriorRing=this.isExteriorRing,Ce.inOut=this.inOut,Ce.otherInOut=this.otherInOut,Ce},Object.defineProperties(Se.prototype,Ae);var ye=11102230246251565e-32,Oe=134217729,Le=(3+8*ye)*ye;function nt(Ce,Me,wt,Wt,un){var hn,En,Zn,xi,wi=Me[0],ci=Wt[0],nr=0,Ar=0;ci>wi==ci>-wi?(hn=wi,wi=Me[++nr]):(hn=ci,ci=Wt[++Ar]);var Ti=0;if(nr<Ce&&Ar<wt)for(ci>wi==ci>-wi?(Zn=hn-((En=wi+hn)-wi),wi=Me[++nr]):(Zn=hn-((En=ci+hn)-ci),ci=Wt[++Ar]),hn=En,Zn!==0&&(un[Ti++]=Zn);nr<Ce&&Ar<wt;)ci>wi==ci>-wi?(Zn=hn-((En=hn+wi)-(xi=En-hn))+(wi-xi),wi=Me[++nr]):(Zn=hn-((En=hn+ci)-(xi=En-hn))+(ci-xi),ci=Wt[++Ar]),hn=En,Zn!==0&&(un[Ti++]=Zn);for(;nr<Ce;)Zn=hn-((En=hn+wi)-(xi=En-hn))+(wi-xi),wi=Me[++nr],hn=En,Zn!==0&&(un[Ti++]=Zn);for(;Ar<wt;)Zn=hn-((En=hn+ci)-(xi=En-hn))+(ci-xi),ci=Wt[++Ar],hn=En,Zn!==0&&(un[Ti++]=Zn);return hn===0&&Ti!==0||(un[Ti++]=hn),Ti}function Qe(Ce){return new Float64Array(Ce)}var st=33306690738754716e-32,dt=22204460492503146e-32,a=11093356479670487e-47,h=Qe(4),v=Qe(8),S=Qe(12),I=Qe(16),k=Qe(4);function K(Ce,Me,wt){var Wt=function(un,hn,En,Zn,xi,wi){var ci=(hn-wi)*(En-xi),nr=(un-xi)*(Zn-wi),Ar=ci-nr;if(ci===0||nr===0||ci>0!=nr>0)return Ar;var Ti=Math.abs(ci+nr);return Math.abs(Ar)>=st*Ti?Ar:-function(is,Pr,Ji,Es,zr,Cr,kr){var sr,hi,hr,rs,qn,Pi,Br,ms,Ur,lo,gr,Ks,Dc,ka,pa,Rc,Sm,co,Do=is-zr,Na=Ji-zr,Sl=Pr-Cr,rl=Es-Cr;h[0]=(pa=(ms=Do-(Br=(Pi=Oe*Do)-(Pi-Do)))*(lo=rl-(Ur=(Pi=Oe*rl)-(Pi-rl)))-((ka=Do*rl)-Br*Ur-ms*Ur-Br*lo))-((gr=pa-(Sm=(ms=Sl-(Br=(Pi=Oe*Sl)-(Pi-Sl)))*(lo=Na-(Ur=(Pi=Oe*Na)-(Pi-Na)))-((Rc=Sl*Na)-Br*Ur-ms*Ur-Br*lo)))+(qn=pa-gr))+(qn-Sm),h[1]=(Dc=ka-((Ks=ka+gr)-(qn=Ks-ka))+(gr-qn))-((gr=Dc-Rc)+(qn=Dc-gr))+(qn-Rc),h[2]=Ks-((co=Ks+gr)-(qn=co-Ks))+(gr-qn),h[3]=co;var Sv=function(qme,XL){for(var QL=XL[0],YM=1;YM<4;YM++)QL+=XL[YM];return QL}(0,h),iS=dt*kr;if(Sv>=iS||-Sv>=iS||(sr=is-(Do+(qn=is-Do))+(qn-zr),hr=Ji-(Na+(qn=Ji-Na))+(qn-zr),hi=Pr-(Sl+(qn=Pr-Sl))+(qn-Cr),rs=Es-(rl+(qn=Es-rl))+(qn-Cr),sr===0&&hi===0&&hr===0&&rs===0)||(iS=a*kr+Le*Math.abs(Sv),(Sv+=Do*rs+rl*sr-(Sl*hr+Na*hi))>=iS||-Sv>=iS))return Sv;k[0]=(pa=(ms=sr-(Br=(Pi=Oe*sr)-(Pi-sr)))*(lo=rl-(Ur=(Pi=Oe*rl)-(Pi-rl)))-((ka=sr*rl)-Br*Ur-ms*Ur-Br*lo))-((gr=pa-(Sm=(ms=hi-(Br=(Pi=Oe*hi)-(Pi-hi)))*(lo=Na-(Ur=(Pi=Oe*Na)-(Pi-Na)))-((Rc=hi*Na)-Br*Ur-ms*Ur-Br*lo)))+(qn=pa-gr))+(qn-Sm),k[1]=(Dc=ka-((Ks=ka+gr)-(qn=Ks-ka))+(gr-qn))-((gr=Dc-Rc)+(qn=Dc-gr))+(qn-Rc),k[2]=Ks-((co=Ks+gr)-(qn=co-Ks))+(gr-qn),k[3]=co;var z$=nt(4,h,4,k,v);k[0]=(pa=(ms=Do-(Br=(Pi=Oe*Do)-(Pi-Do)))*(lo=rs-(Ur=(Pi=Oe*rs)-(Pi-rs)))-((ka=Do*rs)-Br*Ur-ms*Ur-Br*lo))-((gr=pa-(Sm=(ms=Sl-(Br=(Pi=Oe*Sl)-(Pi-Sl)))*(lo=hr-(Ur=(Pi=Oe*hr)-(Pi-hr)))-((Rc=Sl*hr)-Br*Ur-ms*Ur-Br*lo)))+(qn=pa-gr))+(qn-Sm),k[1]=(Dc=ka-((Ks=ka+gr)-(qn=Ks-ka))+(gr-qn))-((gr=Dc-Rc)+(qn=Dc-gr))+(qn-Rc),k[2]=Ks-((co=Ks+gr)-(qn=co-Ks))+(gr-qn),k[3]=co;var B$=nt(z$,v,4,k,S);k[0]=(pa=(ms=sr-(Br=(Pi=Oe*sr)-(Pi-sr)))*(lo=rs-(Ur=(Pi=Oe*rs)-(Pi-rs)))-((ka=sr*rs)-Br*Ur-ms*Ur-Br*lo))-((gr=pa-(Sm=(ms=hi-(Br=(Pi=Oe*hi)-(Pi-hi)))*(lo=hr-(Ur=(Pi=Oe*hr)-(Pi-hr)))-((Rc=hi*hr)-Br*Ur-ms*Ur-Br*lo)))+(qn=pa-gr))+(qn-Sm),k[1]=(Dc=ka-((Ks=ka+gr)-(qn=Ks-ka))+(gr-qn))-((gr=Dc-Rc)+(qn=Dc-gr))+(qn-Rc),k[2]=Ks-((co=Ks+gr)-(qn=co-Ks))+(gr-qn),k[3]=co;var F$=nt(B$,S,4,k,I);return I[F$-1]}(un,hn,En,Zn,xi,wi,Ti)}(Ce[0],Ce[1],Me[0],Me[1],wt[0],wt[1]);return Wt>0?-1:Wt<0?1:0}function ee(Ce,Me){var wt=Ce.point,Wt=Me.point;return wt[0]>Wt[0]?1:wt[0]<Wt[0]?-1:wt[1]!==Wt[1]?wt[1]>Wt[1]?1:-1:function(un,hn,En,Zn){return un.left!==hn.left?un.left?1:-1:K(En,un.otherEvent.point,hn.otherEvent.point)!==0?un.isBelow(hn.otherEvent.point)?-1:1:!un.isSubject&&hn.isSubject?1:-1}(Ce,Me,wt)}function me(Ce,Me,wt){var Wt=new Se(Me,!1,Ce,Ce.isSubject),un=new Se(Me,!0,Ce.otherEvent,Ce.isSubject);return re(Ce.point,Ce.otherEvent.point)&&console.warn("what is that, a collapsed segment?",Ce),Wt.contourId=un.contourId=Ce.contourId,ee(un,Ce.otherEvent)>0&&(Ce.otherEvent.left=!0,un.left=!1),Ce.otherEvent.otherEvent=un,Ce.otherEvent=Wt,wt.push(un),wt.push(Wt),wt}function De(Ce,Me){return Ce[0]*Me[1]-Ce[1]*Me[0]}function it(Ce,Me){return Ce[0]*Me[0]+Ce[1]*Me[1]}function yt(Ce,Me,wt){var Wt=function(xi,wi,ci,nr,Ar){var Ti=[wi[0]-xi[0],wi[1]-xi[1]],is=[nr[0]-ci[0],nr[1]-ci[1]];function Pr(Pi,Br,ms){return[Pi[0]+Br*ms[0],Pi[1]+Br*ms[1]]}var Ji=[ci[0]-xi[0],ci[1]-xi[1]],Es=De(Ti,is),zr=Es*Es,Cr=it(Ti,Ti);if(zr>0){var kr=De(Ji,is)/Es;if(kr<0||kr>1)return null;var sr=De(Ji,Ti)/Es;return sr<0||sr>1?null:kr===0||kr===1?[Pr(xi,kr,Ti)]:sr===0||sr===1?[Pr(ci,sr,is)]:[Pr(xi,kr,Ti)]}if((zr=(Es=De(Ji,Ti))*Es)>0)return null;var hi=it(Ti,Ji)/Cr,hr=hi+it(Ti,is)/Cr,rs=Math.min(hi,hr),qn=Math.max(hi,hr);return rs<=1&&qn>=0?rs===1?[Pr(xi,rs>0?rs:0,Ti)]:qn===0?[Pr(xi,qn<1?qn:1,Ti)]:[Pr(xi,rs>0?rs:0,Ti),Pr(xi,qn<1?qn:1,Ti)]:null}(Ce.point,Ce.otherEvent.point,Me.point,Me.otherEvent.point),un=Wt?Wt.length:0;if(un===0||un===1&&(re(Ce.point,Me.point)||re(Ce.otherEvent.point,Me.otherEvent.point))||un===2&&Ce.isSubject===Me.isSubject)return 0;if(un===1)return re(Ce.point,Wt[0])||re(Ce.otherEvent.point,Wt[0])||me(Ce,Wt[0],wt),re(Me.point,Wt[0])||re(Me.otherEvent.point,Wt[0])||me(Me,Wt[0],wt),1;var hn=[],En=!1,Zn=!1;return re(Ce.point,Me.point)?En=!0:ee(Ce,Me)===1?hn.push(Me,Ce):hn.push(Ce,Me),re(Ce.otherEvent.point,Me.otherEvent.point)?Zn=!0:ee(Ce.otherEvent,Me.otherEvent)===1?hn.push(Me.otherEvent,Ce.otherEvent):hn.push(Ce.otherEvent,Me.otherEvent),En&&Zn||En?(Me.type=O,Ce.type=Me.inOut===Ce.inOut?L:B,En&&!Zn&&me(hn[1].otherEvent,hn[0].point,wt),2):Zn?(me(hn[0],hn[1].point,wt),3):hn[0]!==hn[3].otherEvent?(me(hn[0],hn[1].point,wt),me(hn[1],hn[2].point,wt),3):(me(hn[0],hn[1].point,wt),me(hn[3].otherEvent,hn[2].point,wt),3)}function ct(Ce,Me){if(Ce===Me)return 0;if(K(Ce.point,Ce.otherEvent.point,Me.point)!==0||K(Ce.point,Ce.otherEvent.point,Me.otherEvent.point)!==0)return re(Ce.point,Me.point)?Ce.isBelow(Me.otherEvent.point)?-1:1:Ce.point[0]===Me.point[0]?Ce.point[1]<Me.point[1]?-1:1:ee(Ce,Me)===1?Me.isAbove(Ce.point)?-1:1:Ce.isBelow(Me.point)?-1:1;if(Ce.isSubject!==Me.isSubject)return Ce.isSubject?-1:1;var wt=Ce.point,Wt=Me.point;return wt[0]===Wt[0]&&wt[1]===Wt[1]?(wt=Ce.otherEvent.point)[0]===(Wt=Me.otherEvent.point)[0]&&wt[1]===Wt[1]?0:Ce.contourId>Me.contourId?1:-1:ee(Ce,Me)===1?1:-1}var ut=function(){this.points=[],this.holeIds=[],this.holeOf=null,this.depth=null};function Ct(Ce,Me,wt,Wt){var un,hn=Ce+1,En=Me[Ce].point,Zn=Me.length;for(hn<Zn&&(un=Me[hn].point);hn<Zn&&un[0]===En[0]&&un[1]===En[1];){if(!wt[hn])return hn;++hn<Zn&&(un=Me[hn].point)}for(hn=Ce-1;wt[hn]&&hn>Wt;)hn--;return hn}ut.prototype.isExterior=function(){return this.holeOf==null};var mn=Qt,tn=Qt;function Qt(Ce,Me){if(!(this instanceof Qt))return new Qt(Ce,Me);if(this.data=Ce||[],this.length=this.data.length,this.compare=Me||Je,this.length>0)for(var wt=(this.length>>1)-1;wt>=0;wt--)this._down(wt)}function Je(Ce,Me){return Ce<Me?-1:Ce>Me?1:0}Qt.prototype={push:function(Ce){this.data.push(Ce),this.length++,this._up(this.length-1)},pop:function(){if(this.length!==0){var Ce=this.data[0];return this.length--,this.length>0&&(this.data[0]=this.data[this.length],this._down(0)),this.data.pop(),Ce}},peek:function(){return this.data[0]},_up:function(Ce){for(var Me=this.data,wt=this.compare,Wt=Me[Ce];Ce>0;){var un=Ce-1>>1,hn=Me[un];if(wt(Wt,hn)>=0)break;Me[Ce]=hn,Ce=un}Me[Ce]=Wt},_down:function(Ce){for(var Me=this.data,wt=this.compare,Wt=this.length>>1,un=Me[Ce];Ce<Wt;){var hn=1+(Ce<<1),En=hn+1,Zn=Me[hn];if(En<this.length&&wt(Me[En],Zn)<0&&(hn=En,Zn=Me[En]),wt(Zn,un)>=0)break;Me[Ce]=Zn,Ce=hn}Me[Ce]=un}},mn.default=tn;var rt=Math.max,lt=Math.min,kt=0;function Zt(Ce,Me,wt,Wt,un,hn){var En,Zn,xi,wi,ci,nr;for(En=0,Zn=Ce.length-1;En<Zn;En++)if(wi=Ce[En+1],ci=new Se(xi=Ce[En],!1,void 0,Me),nr=new Se(wi,!1,ci,Me),ci.otherEvent=nr,xi[0]!==wi[0]||xi[1]!==wi[1]){ci.contourId=nr.contourId=wt,hn||(ci.isExteriorRing=!1,nr.isExteriorRing=!1),ee(ci,nr)>0?nr.left=!0:ci.left=!0;var Ar=xi[0],Ti=xi[1];un[0]=lt(un[0],Ar),un[1]=lt(un[1],Ti),un[2]=rt(un[2],Ar),un[3]=rt(un[3],Ti),Wt.push(ci),Wt.push(nr)}}var On=[];function An(Ce,Me,wt){typeof Ce[0][0][0]=="number"&&(Ce=[Ce]),typeof Me[0][0][0]=="number"&&(Me=[Me]);var Wt=function(Ti,is,Pr){var Ji=null;return Ti.length*is.length==0&&(Pr===U?Ji=On:Pr===Y?Ji=Ti:Pr!==q&&Pr!==ne||(Ji=Ti.length===0?is:Ti)),Ji}(Ce,Me,wt);if(Wt)return Wt===On?null:Wt;var un=[1/0,1/0,-1/0,-1/0],hn=[1/0,1/0,-1/0,-1/0],En=function(Ti,is,Pr,Ji,Es){var zr,Cr,kr,sr,hi,hr,rs=new mn(null,ee);for(kr=0,sr=Ti.length;kr<sr;kr++)for(hi=0,hr=(zr=Ti[kr]).length;hi<hr;hi++)(Cr=hi===0)&&kt++,Zt(zr[hi],!0,kt,rs,Pr,Cr);for(kr=0,sr=is.length;kr<sr;kr++)for(hi=0,hr=(zr=is[kr]).length;hi<hr;hi++)Cr=hi===0,Es===Y&&(Cr=!1),Cr&&kt++,Zt(zr[hi],!1,kt,rs,Ji,Cr);return rs}(Ce,Me,un,hn,wt);if(Wt=function(Ti,is,Pr,Ji,Es){var zr=null;return(Pr[0]>Ji[2]||Ji[0]>Pr[2]||Pr[1]>Ji[3]||Ji[1]>Pr[3])&&(Es===U?zr=On:Es===Y?zr=Ti:Es!==q&&Es!==ne||(zr=Ti.concat(is))),zr}(Ce,Me,un,hn,wt))return Wt===On?null:Wt;for(var Zn=function(Ti){var is,Pr,Ji=function(kr){var sr,hi,hr,rs,qn=[];for(hi=0,hr=kr.length;hi<hr;hi++)((sr=kr[hi]).left&&sr.inResult||!sr.left&&sr.otherEvent.inResult)&&qn.push(sr);for(var Pi=!1;!Pi;)for(Pi=!0,hi=0,hr=qn.length;hi<hr;hi++)hi+1<hr&&ee(qn[hi],qn[hi+1])===1&&(rs=qn[hi],qn[hi]=qn[hi+1],qn[hi+1]=rs,Pi=!1);for(hi=0,hr=qn.length;hi<hr;hi++)(sr=qn[hi]).otherPos=hi;for(hi=0,hr=qn.length;hi<hr;hi++)(sr=qn[hi]).left||(rs=sr.otherPos,sr.otherPos=sr.otherEvent.otherPos,sr.otherEvent.otherPos=rs);return qn}(Ti),Es={},zr=[],Cr=function(){if(!Es[is]){var kr=zr.length,sr=function(qn,Pi,Br){var ms=new ut;if(qn.prevInResult!=null){var Ur=qn.prevInResult,lo=Ur.outputContourId;if(Ur.resultTransition>0){var gr=Pi[lo];if(gr.holeOf!=null){var Ks=gr.holeOf;Pi[Ks].holeIds.push(Br),ms.holeOf=Ks,ms.depth=Pi[lo].depth}else Pi[lo].holeIds.push(Br),ms.holeOf=lo,ms.depth=Pi[lo].depth+1}else ms.holeOf=null,ms.depth=Pi[lo].depth}else ms.holeOf=null,ms.depth=0;return ms}(Ji[is],zr,kr),hi=function(qn){Es[qn]=!0,qn<Ji.length&&Ji[qn]&&(Ji[qn].outputContourId=kr)},hr=is,rs=is;for(sr.points.push(Ji[is].point);hi(hr),hi(hr=Ji[hr].otherPos),sr.points.push(Ji[hr].point),!((hr=Ct(hr,Ji,Es,rs))==rs||hr>=Ji.length)&&Ji[hr];);zr.push(sr)}};for(is=0,Pr=Ji.length;is<Pr;is++)Cr();return zr}(function(Ti,is,Pr,Ji,Es,zr){for(var Cr,kr,sr,hi=new g(ct),hr=[],rs=Math.min(Ji[2],Es[2]);Ti.length!==0;){var qn=Ti.pop();if(hr.push(qn),zr===U&&qn.point[0]>rs||zr===Y&&qn.point[0]>Ji[2])break;if(qn.left){kr=Cr=hi.insert(qn),Cr=Cr!==(sr=hi.minNode())?hi.prev(Cr):null,kr=hi.next(kr);var Pi=Cr?Cr.key:null;if(ae(qn,Pi,zr),kr&&yt(qn,kr.key,Ti)===2&&(ae(qn,Pi,zr),ae(kr.key,qn,zr)),Cr&&yt(Cr.key,qn,Ti)===2){var Br=Cr;ae(Pi,(Br=Br!==sr?hi.prev(Br):null)?Br.key:null,zr),ae(qn,Pi,zr)}}else kr=Cr=hi.find(qn=qn.otherEvent),Cr&&kr&&(Cr=Cr!==sr?hi.prev(Cr):null,kr=hi.next(kr),hi.remove(qn),kr&&Cr&&yt(Cr.key,kr.key,Ti))}return hr}(En,0,0,un,hn,wt)),xi=[],wi=0;wi<Zn.length;wi++){var ci=Zn[wi];if(ci.isExterior()){for(var nr=[ci.points],Ar=0;Ar<ci.holeIds.length;Ar++)nr.push(Zn[ci.holeIds[Ar]].points);xi.push(nr)}}return xi}var Yn={UNION:q,DIFFERENCE:Y,INTERSECTION:U,XOR:ne};l.diff=function(Ce,Me){return An(Ce,Me,Y)},l.intersection=function(Ce,Me){return An(Ce,Me,U)},l.operations=Yn,l.union=function(Ce,Me){return An(Ce,Me,q)},l.xor=function(Ce,Me){return An(Ce,Me,ne)},Object.defineProperty(l,"__esModule",{value:!0})})(i)}(0,Rd.exports)),Rd.exports);/**
 * martinez v0.7.4
 * Martinez polygon clipping algorithm, does boolean operation on polygons (multipolygons, polygons with holes etc): intersection, union, difference, xor
 *
 * @author Alex Milevski <info@w8r.name>
 * @license MIT
 * @preserve
 */function Nh(u,i,l,p){const g=[],b=p===0?(x,A,R,O,L,B)=>{x.push(new Lt(B,R+(B-A)/(O-A)*(L-R)))}:(x,A,R,O,L,B)=>{x.push(new Lt(A+(B-R)/(L-R)*(O-A),B))};for(const x of u){const A=[];for(const R of x){if(R.length<=2)continue;const O=[];for(let U=0;U<R.length-1;U++){const q=R[U].x,Y=R[U].y,ne=R[U+1].x,ae=R[U+1].y,he=p===0?q:Y,Se=p===0?ne:ae;he<i?Se>i&&b(O,q,Y,ne,ae,i):he>l?Se<l&&b(O,q,Y,ne,ae,l):O.push(R[U]),Se<i&&he>=i&&b(O,q,Y,ne,ae,i),Se>l&&he<=l&&b(O,q,Y,ne,ae,l)}let L=R[R.length-1];const B=p===0?L.x:L.y;B>=i&&B<=l&&O.push(L),O.length&&(L=O[O.length-1],O[0].x===L.x&&O[0].y===L.y||O.push(O[0]),A.push(O))}A.length&&g.push(A)}return g}function _l(u,i){const l=Od(u),p=Od([i]),g=sb.intersection(l,p);return g==null?[]:p1(g)}function yc(u,i){let p=Od(u,65536);for(;i.valid();i.next()){const[g,b]=i.get(),x=g.x*65536,A=g.y*65536,R=b.x*65536,O=b.y*65536,L=R-x,B=O-A,U=Math.hypot(L,B),q=Math.trunc(B/U*3),Y=-Math.trunc(L/U*3);p=sb.diff(p,[[[x,A],[R,O],[R+q,O+Y],[x+q,A+Y],[x,A]]])}return p1(p,1/65536)}function Od(u,i=1){return[u.map(l=>l.map(p=>[p.x*i,p.y*i]))]}function p1(u,i=1){return u.map(l=>l.map((p,g)=>{const b=p.map(x=>new Lt(x[0]*i,x[1]*i).round());return g>0&&b.reverse(),b}))}class FT{constructor(i,l){this.layoutVertexArray=new uc,this.indexArray=new mo,this.lineIndexArray=new Eh,this.triangleSegments=new Yr,this.lineSegments=new Yr,this.programConfigurations=new _(i.layers,{zoom:i.zoom,lut:i.lut}),this.uploaded=!1,l&&(this.elevatedLayoutVertexArray=new fd)}update(i,l,p,g,b,x,A,R){this.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,R)}isEmpty(){return this.layoutVertexArray.length===0}needsUpload(){return this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,xM.members),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.lineIndexBuffer=i.createIndexBuffer(this.lineIndexArray),this.elevatedLayoutVertexArray&&this.elevatedLayoutVertexArray.length>0&&(this.elevatedLayoutVertexBuffer=i.createVertexBuffer(this.elevatedLayoutVertexArray,gC.members))),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.elevatedLayoutVertexBuffer&&this.elevatedLayoutVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.lineIndexBuffer.destroy(),this.programConfigurations.destroy(),this.triangleSegments.destroy(),this.lineSegments.destroy())}populatePaintArrays(i,l,p,g,b,x,A){this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,l,p,g,b,x,void 0,A)}}class VT{constructor(i){this.zoom=i.zoom,this.pixelRatio=i.pixelRatio,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.patternFeatures=[],this.lut=i.lut,this.bufferData=new FT(i,!1),this.elevationBufferData=new FT(i,!0),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.projection=i.projection,this.elevationMode=this.layers[0].layout.get("fill-elevation-reference"),this.sourceLayerIndex=i.sourceLayerIndex,this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,p,g){this.hasPattern=Ja("fill",this.layers,this.pixelRatio,l);const b=this.layers[0].layout.get("fill-sort-key"),x=[];for(const{feature:A,id:R,index:O,sourceLayerIndex:L}of i){const B=this.layers[0]._featureFilter.needGeometry,U=pn(A,B);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),U,p))continue;const q=b?b.evaluate(U,{},p,l.availableImages):void 0,Y={id:R,properties:A.properties,type:A.type,sourceLayerIndex:L,index:O,geometry:B?U.geometry:fn(A,p,g),patterns:{},sortKey:q};x.push(Y)}b&&x.sort((A,R)=>A.sortKey-R.sortKey);for(const A of x){const{geometry:R,index:O,sourceLayerIndex:L}=A;if(this.hasPattern){const B=BT("fill",this.layers,A,this.zoom,this.pixelRatio,l);this.patternFeatures.push(B)}else this.addFeature(A,R,O,p,{},l.availableImages,l.brightness,l.elevationFeatures);l.featureIndex.insert(i[O].feature,R,O,L,this.index)}}update(i,l,p,g,b,x,A){this.bufferData.update(i,l,p,g,b,x,A,this.worldview),this.elevationBufferData.update(i,l,p,g,b,x,A,this.worldview),this.elevatedStructures&&this.elevatedStructures.update(i,l,p,g,b,x,A,this.worldview)}addFeatures(i,l,p,g,b,x){for(const A of this.patternFeatures)this.addFeature(A,A.geometry,A.index,l,p,g,x,i.elevationFeatures)}isEmpty(){return this.bufferData.isEmpty()&&this.elevationBufferData.isEmpty()}uploadPending(){return!this.uploaded||this.bufferData.needsUpload()||this.elevationBufferData.needsUpload()}upload(i){this.bufferData.upload(i),this.elevationBufferData.upload(i),this.elevatedStructures&&this.elevatedStructures.upload(i)}destroy(){this.bufferData.destroy(),this.elevationBufferData.destroy(),this.elevatedStructures&&this.elevatedStructures.destroy()}addFeature(i,l,p,g,b,x=[],A,R){const O=ei(l,500);this.elevationMode!=="none"?this.addElevatedRoadFeature(i,O,g,p,R):this.addGeometry(O,this.bufferData),this.bufferData.populatePaintArrays(i,p,b,x,g,A,this.worldview),this.elevationBufferData.populatePaintArrays(i,p,b,x,g,A,this.worldview)}getUnevaluatedPortalGraph(){return this.elevatedStructures?this.elevatedStructures.unevaluatedPortals:void 0}getElevationPolygons(){return this.elevatedStructures?this.elevatedStructures.portalPolygons:void 0}setEvaluatedPortalGraph(i,l,p,g,b){this.elevatedStructures&&(this.elevatedStructures.construct(i),this.elevatedStructures.populatePaintArrays(l,p,g,b,this.worldview))}addElevatedRoadFeature(i,l,p,g,b){const x=new Array,A=gl.getElevationFeature(i,b);if(!A)return void this.addGeometry(l,this.bufferData);{const O=this.clipPolygonsToTile(l,1);O.length>0&&x.push({polygons:O,elevationFeature:A,elevationTileID:p})}const R={guardRailEnabled:this.layers[0].layout.get("fill-construct-bridge-guard-rail").evaluate(i,{},p),featureIndex:g};for(const O of x)if(O.elevationFeature){if(this.elevationMode==="hd-road-base"){this.elevatedStructures||(this.elevatedStructures=new Qs(O.elevationTileID,this.layers,this.zoom,this.lut));const B=O.elevationFeature.isTunnel();let U=0;i.properties.hasOwnProperty(yr)&&(U=+i.properties[yr]);for(const q of O.polygons)this.elevatedStructures.addPortalCandidates(O.elevationFeature.id,q,B,O.elevationFeature,U)}O.elevationFeature.constantHeight==null&&(O.polygons=this.prepareElevatedPolygons(O.polygons,O.elevationFeature,O.elevationTileID));const L=new fc(p,O.elevationTileID);this.addElevatedGeometry(O.polygons,L,O.elevationFeature,this.elevationMode==="hd-road-base"?0:.05,g,R)}}addElevatedGeometry(i,l,p,g,b,x){const A={elevation:p,elevationSampler:l,bias:g,index:b,featureInfo:x},[R,O]=this.addGeometry(i,this.elevationBufferData,A);this.elevationBufferData.heightRange==null?this.elevationBufferData.heightRange={min:R,max:O}:(this.elevationBufferData.heightRange.min=Math.min(this.elevationBufferData.heightRange.min,R),this.elevationBufferData.heightRange.max=Math.max(this.elevationBufferData.heightRange.max,O))}addGeometry(i,l,p){let g=Number.POSITIVE_INFINITY,b=Number.NEGATIVE_INFINITY,x=null;p&&(x=p.elevationSampler.constantElevation(p.elevation,p.bias),x!=null&&(g=x,b=x));const A=(R,O,L)=>{if(p!=null)if(O.push(R),x!=null)l.elevatedLayoutVertexArray.emplaceBack(x),L.push(x);else{const B=p.elevationSampler.pointElevation(R,p.elevation,p.bias);l.elevatedLayoutVertexArray.emplaceBack(B),L.push(B),g=Math.min(g,B),b=Math.max(b,B)}};for(const R of i){let O=0;for(const Ae of R)O+=Ae.length;const L=l.triangleSegments.prepareSegment(O,l.layoutVertexArray,l.indexArray),B=L.vertexLength,U=[],q=[],Y=[],ne=[],ae=[],he=l.layoutVertexArray.length;for(const Ae of R){if(Ae.length===0)continue;Ae!==R[0]&&q.push(U.length/2);const re=l.lineSegments.prepareSegment(Ae.length,l.layoutVertexArray,l.lineIndexArray),ye=re.vertexLength;p&&ae.push(l.layoutVertexArray.length-he),A(Ae[0],Y,ne),l.layoutVertexArray.emplaceBack(Ae[0].x,Ae[0].y),l.lineIndexArray.emplaceBack(ye+Ae.length-1,ye),U.push(Ae[0].x),U.push(Ae[0].y);for(let Oe=1;Oe<Ae.length;Oe++)A(Ae[Oe],Y,ne),l.layoutVertexArray.emplaceBack(Ae[Oe].x,Ae[Oe].y),l.lineIndexArray.emplaceBack(ye+Oe-1,ye+Oe),U.push(Ae[Oe].x),U.push(Ae[Oe].y);re.vertexLength+=Ae.length,re.primitiveLength+=Ae.length}const Se=Jt(U,q);for(let Ae=0;Ae<Se.length;Ae+=3)l.indexArray.emplaceBack(B+Se[Ae],B+Se[Ae+1],B+Se[Ae+2]);if(Se.length>0&&p&&this.elevationMode==="hd-road-base"){const Ae=p.elevation.isTunnel(),re=p.elevation.safeArea,ye=this.elevatedStructures.addVertices(Y,ne);this.elevatedStructures.addTriangles(Se,ye,Ae);const Oe=ae.length;if(Oe>0){for(let Le=0;Le<Oe-1;Le++)this.elevatedStructures.addRenderableRing(p.index,ae[Le]+ye,ae[Le+1]-ae[Le],Ae,re,p.featureInfo);this.elevatedStructures.addRenderableRing(p.index,ae[Oe-1]+ye,Y.length-ae[Oe-1],Ae,re,p.featureInfo)}}L.vertexLength+=O,L.primitiveLength+=Se.length/3}return[g,b]}prepareElevatedPolygons(i,l,p){const g=1/Dt(p),b=[];for(const x of i){const A=yc(x,new js(l,g));b.push(...A)}return b}clipPolygonsToTile(i,l){const p=-l,g=-l,b=sn+l,x=sn+l;let A=0;const R=[],O=[];for(;A<i.length;A++){const U=i[A],q=ch(U);(q.min.x>=p&&q.max.x<=b&&q.min.y>=g&&q.max.y<=x?R:O).push(U)}if(R.length===i.length)return i;const L=[new Lt(p,g),new Lt(b,g),new Lt(b,x),new Lt(p,x),new Lt(p,g)],B=R;for(const U of O)B.push(..._l(U,L));return B}}let UT,Ny,jT,Jp;vn(VT,"FillBucket",{omit:["layers","patternFeatures"]}),vn(FT,"FillBufferData"),vn(Qs,"ElevatedStructures");class ob{constructor(i,l,p,g){if(this.triangleCount=l.length/3,this.min=new Lt(0,0),this.max=new Lt(0,0),this.xScale=0,this.yScale=0,this.cellsX=0,this.cellsY=0,this.cells=[],this.payload=[],this.triangleCount===0||i.length===0)return;const[b,x]=[i[0].clone(),i[0].clone()];for(let B=1;B<i.length;++B){const U=i[B];b.x=Math.min(b.x,U.x),b.y=Math.min(b.y,U.y),x.x=Math.max(x.x,U.x),x.y=Math.max(x.y,U.y)}if(g){const B=Math.ceil(Math.max(x.x-b.x,x.y-b.y)/g);p=Math.max(p,B)}if(p===0)return;this.min=b,this.max=x;const A=this.max.sub(this.min);A.x=Math.max(A.x,1),A.y=Math.max(A.y,1);const R=Math.max(A.x,A.y)/p;this.cellsX=Math.max(1,Math.ceil(A.x/R)),this.cellsY=Math.max(1,Math.ceil(A.y/R)),this.xScale=1/R,this.yScale=1/R;const O=[];for(let B=0;B<this.triangleCount;B++){const U=i[l[3*B+0]].sub(this.min),q=i[l[3*B+1]].sub(this.min),Y=i[l[3*B+2]].sub(this.min),ne=Id(Math.floor(Math.min(U.x,q.x,Y.x)),this.xScale,this.cellsX),ae=Id(Math.floor(Math.max(U.x,q.x,Y.x)),this.xScale,this.cellsX),he=Id(Math.floor(Math.min(U.y,q.y,Y.y)),this.yScale,this.cellsY),Se=Id(Math.floor(Math.max(U.y,q.y,Y.y)),this.yScale,this.cellsY),Ae=new Lt(0,0),re=new Lt(0,0),ye=new Lt(0,0),Oe=new Lt(0,0);for(let Le=he;Le<=Se;++Le){Ae.y=re.y=Le*R,ye.y=Oe.y=(Le+1)*R;for(let nt=ne;nt<=ae;++nt)Ae.x=ye.x=nt*R,re.x=Oe.x=(nt+1)*R,(Kx(U,q,Y,Ae,re,Oe)||Kx(U,q,Y,Ae,Oe,ye))&&O.push({cellIdx:Le*this.cellsX+nt,triIdx:B})}}if(O.length===0)return;O.sort((B,U)=>B.cellIdx-U.cellIdx||B.triIdx-U.triIdx);let L=0;for(;L<O.length;){const B=O[L].cellIdx,U={start:this.payload.length,len:0};for(;L<O.length&&O[L].cellIdx===B;)++U.len,this.payload.push(O[L++].triIdx);this.cells[B]=U}}_lazyInitLookup(){this.lookup||(this.lookup=new Uint8Array(Math.ceil(this.triangleCount/8))),this.lookup.fill(0)}queryPoint(i,l){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>i.x||i.y>this.max.y||this.min.y>i.y)return;const p=Id(i.x-this.min.x,this.xScale,this.cellsX),g=Id(i.y-this.min.y,this.yScale,this.cellsY),b=this.cells[g*this.cellsX+p];if(b){this._lazyInitLookup();for(let x=0;x<b.len;x++){const A=this.payload[b.start+x],R=Math.floor(A/8),O=1<<A%8;if(!(this.lookup[R]&O)&&(this.lookup[R]|=O,l.push(A),l.length===this.triangleCount))return}}}query(i,l,p){if(this.triangleCount===0||this.cells.length===0||i.x>this.max.x||this.min.x>l.x||i.y>this.max.y||this.min.y>l.y)return;this._lazyInitLookup();const g=Id(i.x-this.min.x,this.xScale,this.cellsX),b=Id(l.x-this.min.x,this.xScale,this.cellsX),x=Id(i.y-this.min.y,this.yScale,this.cellsY),A=Id(l.y-this.min.y,this.yScale,this.cellsY);for(let R=x;R<=A;R++)for(let O=g;O<=b;O++){const L=this.cells[R*this.cellsX+O];if(L)for(let B=0;B<L.len;B++){const U=this.payload[L.start+B],q=Math.floor(U/8),Y=1<<U%8;if(!(this.lookup[q]&Y)&&(this.lookup[q]|=Y,p.push(U),p.length===this.triangleCount))return}}}}function Id(u,i,l){return Math.max(0,Math.min(l-1,Math.floor(u*i)))}vn(ob,"TriangleGridIndex");class xC{constructor(i){this.zoom=i.zoom,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.footprints=[],this.worldview=i.worldview}updateFootprints(i,l){for(const p of this.footprints)l.push({footprint:p,id:i})}populate(i,l,p,g){const b=[];for(const{feature:x,id:A,index:R,sourceLayerIndex:O}of i){const L=this.layers[0]._featureFilter.needGeometry,B=pn(x,L);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),B,p))continue;const U={id:A,properties:x.properties,type:x.type,sourceLayerIndex:O,index:R,geometry:L?B.geometry:fn(x,p,g),patterns:{}};b.push(U)}for(const x of b){const{geometry:A,index:R,sourceLayerIndex:O}=x;this.addFeature(x,A,R,p,{},l.availableImages,l.brightness),l.featureIndex.insert(i[R].feature,A,R,O,this.index)}}isEmpty(){return this.footprints.length===0}uploadPending(){return!1}upload(i){}update(i,l,p,g,b,x,A){}destroy(){}addFeature(i,l,p,g,b,x=[],A){for(const R of ei(l,2)){const O=[],L=[],B=[],U=new Lt(1/0,1/0),q=new Lt(-1/0,-1/0);for(const ae of R)if(ae.length!==0){ae!==R[0]&&B.push(L.length/2);for(let he=0;he<ae.length;he++)L.push(ae[he].x),L.push(ae[he].y),O.push(ae[he]),U.x=Math.min(U.x,ae[he].x),U.y=Math.min(U.y,ae[he].y),q.x=Math.max(q.x,ae[he].x),q.y=Math.max(q.y,ae[he].y)}const Y=Jt(L,B),ne=new ob(O,Y,8,256);this.footprints.push({vertices:O,indices:Y,grid:ne,min:U,max:q})}}}vn(xC,"ClipBucket",{omit:["layers"]});const wC=Oi([{name:"a_pos_normal_ed",components:4,type:"Int16"}]),TC=Oi([{name:"a_pos_end",components:4,type:"Int16"},{name:"a_angular_offset_factor",components:1,type:"Int16"}]),ab=Oi([{name:"a_centroid_pos",components:2,type:"Uint16"}]),EC=Oi([{name:"a_join_normal_inside",components:3,type:"Int16"}]),SC=Oi([{name:"a_hidden_by_landmark",components:1,type:"Uint8"}]),AC=Oi([{name:"a_pos_3",components:3,type:"Int16"},{name:"a_pos_normal_3",components:3,type:"Int16"}]),{members:CC}=wC,lb=Number.MAX_SAFE_INTEGER;function HT(u,i,l,p){return u.order<i||u.order===lb||!(u.clipMask&l)||function(g,b){return b.length!==0&&b.find(x=>x===g)===void 0}(p,u.clipScope)}function cb(u,i){return u.x-i.x||u.y-i.y}function m1(u,i){return cb(u.min,i.min)===0&&cb(u.max,i.max)===0}function g1(u,i){return!(u.min.x>i.max.x||u.max.x<i.min.x||u.min.y>i.max.y||u.max.y<i.min.y)}function ub(u,i){if(u.length!==i.length)return!1;for(let l=0;l<u.length;l++)if(u[l].sourceId!==i[l].sourceId||!m1(u[l],i[l])||u[l].order!==i[l].order||u[l].clipMask!==i[l].clipMask||!$r(u[l].clipScope,i[l].clipScope))return!1;return!0}function _1(u,i,l){const p=1/sn,g=1/(1<<l.canonical.z),b=(i.x*p+l.canonical.x)*g+l.wrap,x=(i.y*p+l.canonical.y)*g;return{min:new Lt((u.x*p+l.canonical.x)*g+l.wrap,(u.y*p+l.canonical.y)*g),max:new Lt(b,x)}}function hu(u,i,l){const p=1<<l.canonical.z,g=((i.x-l.wrap)*p-l.canonical.x)*sn,b=(i.y*p-l.canonical.y)*sn;return{min:new Lt(((u.x-l.wrap)*p-l.canonical.x)*sn,(u.y*p-l.canonical.y)*sn),max:new Lt(g,b)}}function Lh(u,i,l,p,g,b,x){const A=u.indices,R=u.vertices,O=[];for(let L=p;L<p+g;L+=3){const B=i[l[L+0]+b],U=i[l[L+1]+b],q=i[l[L+2]+b],Y=Math.min(B.x,U.x,q.x),ne=Math.max(B.x,U.x,q.x),ae=Math.min(B.y,U.y,q.y),he=Math.max(B.y,U.y,q.y);O.length=0,u.grid.query(new Lt(Y,ae),new Lt(ne,he),O);for(let Se=0;Se<O.length;Se++){const Ae=O[Se];if(Kx(R[A[3*Ae+0]],R[A[3*Ae+1]],R[A[3*Ae+2]],B,U,q,x))return!0}}return!1}function DC(u,i,l,p){if(!u||!l)return!1;let g=u.vertices;if(!i.canonical.equals(p.canonical)||i.wrap!==p.wrap){if(l.vertices.length<u.vertices.length)return DC(l,p,u,i);const b=i.canonical,x=p.canonical,A=Math.pow(2,x.z-b.z);g=u.vertices.map(R=>new Lt((R.x+b.x*sn)*A-x.x*sn,(R.y+b.y*sn)*A-x.y*sn))}return Lh(l,g,u.indices,0,u.indices.length,0,0)}function $T(u,i,l,p){const g=Math.pow(2,p.z-l.z);return new Lt((u+l.x*sn)*g-p.x*sn,(i+l.y*sn)*g-p.y*sn)}function GT(u,i){const l=[];i.grid.queryPoint(u,l);const p=i.indices,g=i.vertices;for(let b=0;b<l.length;b++){const x=l[b];if(uu([g[p[3*x+0]],g[p[3*x+1]],g[p[3*x+2]]],u))return!0}return!1}const y1=[new Lt(0,0),new Lt(sn,0),new Lt(sn,sn),new Lt(0,sn)];function qT(u,i){const l=[];let p=[];if(!i||u.length<2)return[u];if(u.length===2)return mc(u[0],u[1],y1)?[u]:[];for(let g=0;g<u.length+2;g++){const b=u[g%u.length],x=u[(g+1)%u.length],A=mc(g===0?u[u.length-1]:u[(g-1)%u.length],b,y1),R=mc(b,x,y1),O=A||R;O&&p.push(b),O&&R||p.length>0&&(p.length>1&&l.push(p),p=[])}return p.length>1&&l.push(p),l}const v1=li.VectorTileFeature.types,RC=["fill-extrusion-base","fill-extrusion-height","fill-extrusion-color","fill-extrusion-pattern","fill-extrusion-flood-light-wall-radius","fill-extrusion-line-width","fill-extrusion-emissive-strength"],OC=["fill-extrusion-flood-light-ground-radius"],IC=Math.pow(2,13),MC=Math.pow(2,15)-1,PC=new Lt(0,1),qf=2147483648;function hb(u,i,l,p,g,b,x,A){u.emplaceBack((i<<1)+x,(l<<1)+b,(Math.floor(p*IC)<<1)+g,Math.round(A))}function db(u,i,l){u.emplaceBack(i.x*sn,i.y*sn,l?1:0)}function fb(u,i,l,p,g,b){u.emplaceBack(i.x,i.y,(l.x<<1)+p,(l.y<<1)+g,b)}function em(u,i,l){u.emplaceBack(i.x,i.y,i.z,l[0]*16384,l[1]*16384,l[2]*16384)}class b1{constructor(){this.vertexOffset=0,this.vertexCount=0,this.indexOffset=0,this.indexCount=0}}class WT{constructor(){this.centroidXY=new Lt(0,0),this.vertexArrayOffset=0,this.vertexCount=0,this.groundVertexArrayOffset=0,this.groundVertexCount=0,this.flags=0,this.footprintSegIdx=-1,this.footprintSegLen=0,this.polygonSegIdx=-1,this.polygonSegLen=0,this.min=new Lt(Number.MAX_VALUE,Number.MAX_VALUE),this.max=new Lt(-Number.MAX_VALUE,-Number.MAX_VALUE),this.height=0}span(){return new Lt(this.max.x-this.min.x,this.max.y-this.min.y)}}class YT{constructor(){this.acc=new Lt(0,0),this.accCount=0,this.centroidDataIndex=0}startRing(i,l){i.min.x===Number.MAX_VALUE&&(i.min.x=i.max.x=l.x,i.min.y=i.max.y=l.y)}appendEdge(i,l,p){this.accCount++,this.acc._add(l);let g=!!this.borders;l.x<i.min.x?(i.min.x=l.x,g=!0):l.x>i.max.x&&(i.max.x=l.x,g=!0),l.y<i.min.y?(i.min.y=l.y,g=!0):l.y>i.max.y&&(i.max.y=l.y,g=!0),((l.x===0||l.x===sn)&&l.x===p.x)!=((l.y===0||l.y===sn)&&l.y===p.y)&&this.processBorderOverlap(l,p),g&&this.checkBorderIntersection(l,p)}checkBorderIntersection(i,l){l.x<0!=i.x<0&&this.addBorderIntersection(0,$n(l.y,i.y,(0-l.x)/(i.x-l.x))),l.x>sn!=i.x>sn&&this.addBorderIntersection(1,$n(l.y,i.y,(sn-l.x)/(i.x-l.x))),l.y<0!=i.y<0&&this.addBorderIntersection(2,$n(l.x,i.x,(0-l.y)/(i.y-l.y))),l.y>sn!=i.y>sn&&this.addBorderIntersection(3,$n(l.x,i.x,(sn-l.y)/(i.y-l.y)))}addBorderIntersection(i,l){this.borders||(this.borders=[[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE],[Number.MAX_VALUE,-Number.MAX_VALUE]]);const p=this.borders[i];l<p[0]&&(p[0]=l),l>p[1]&&(p[1]=l)}processBorderOverlap(i,l){if(i.x===l.x){if(i.y===l.y)return;const p=i.x===0?0:1;this.addBorderIntersection(p,l.y),this.addBorderIntersection(p,i.y)}else{const p=i.y===0?2:3;this.addBorderIntersection(p,l.x),this.addBorderIntersection(p,i.x)}}centroid(){return this.accCount===0?new Lt(0,0):new Lt(Math.floor(Math.max(0,this.acc.x)/this.accCount),Math.floor(Math.max(0,this.acc.y)/this.accCount))}intersectsCount(){return this.borders?this.borders.reduce((i,l)=>i+ +(l[0]!==Number.MAX_VALUE),0):0}}function kC(u,i){const l=u.add(i)._unit(),p=He(u.x*l.x+u.y*l.y,-1,1);var g,b,x;return g=Math.acos(p),Math.min(4,Math.max(-4,Math.tan(g)))/4*MC*((b=u).x*(x=i).y-b.y*x.x<0?-1:1)}const EM=[u=>u.x<0,u=>u.x>sn,u=>u.y<0,u=>u.y>sn];function SM(u,i,l,p){const g=[4];if(p===0)return g;l._mult(p);const b=u.sub(l),x=i.sub(l),A=[u,i,b,x];for(let R=0;R<4;R++)for(const O of A)if(EM[R](O)){g.push(R);break}return g}class ZT{constructor(i){this.vertexArray=new fl,this.indexArray=new mo,this.programConfigurations=new _(i.layers,{zoom:i.zoom,lut:i.lut},l=>OC.includes(l)),this._segments=new Yr,this.hiddenByLandmarkVertexArray=new xy,this._segmentToGroundQuads={},this._segmentToGroundQuads[0]=[],this._segmentToRegionTriCounts={},this._segmentToRegionTriCounts[0]=[0,0,0,0,0],this.regionSegments={},this.regionSegments[4]=new Yr}getDefaultSegment(){return this.regionSegments[4]}hasData(){return this.vertexArray.length!==0}addData(i,l,p,g=!1){const b=i.length;if(b>2){let x=Math.max(0,this._segments.get().length-1);const A=this._segments._prepareSegment(4*b,this.vertexArray.length,2*this._segmentToGroundQuads[x].length);let R;x!==this._segments.get().length-1&&(x++,this._segmentToGroundQuads[x]=[],this._segmentToRegionTriCounts[x]=[0,0,0,0,0]);{const O=i[0],L=i[1];R=kC(O.sub(i[b-1])._perp()._unit(),L.sub(O)._perp()._unit())}for(let O=0;O<b;O++){const L=O===b-1?0:O+1,B=i[O],U=i[L],q=i[L===b-1?0:L+1],Y=U.sub(B)._perp()._unit(),ne=kC(Y,q.sub(U)._perp()._unit()),ae=R,he=ne;if(w1(B,U,l)||g&&pb(B,l)&&pb(U,l)){R=ne;continue}const Se=A.vertexLength;fb(this.vertexArray,B,U,1,1,ae),fb(this.vertexArray,B,U,1,0,ae),fb(this.vertexArray,B,U,0,1,he),fb(this.vertexArray,B,U,0,0,he),A.vertexLength+=4;const Ae=SM(B,U,Y,p);for(const re of Ae)this._segmentToGroundQuads[x].push({id:Se,region:re}),this._segmentToRegionTriCounts[x][re]+=2,A.primitiveLength+=2;R=ne}}}prepareBorderSegments(){if(!this.hasData())return;const i=this._segments.get(),l=i.length;for(let p=0;p<l;p++)this._segmentToGroundQuads[p].sort((g,b)=>g.region-b.region);for(let p=0;p<l;p++){const g=this._segmentToGroundQuads[p],b=i[p],x=this._segmentToRegionTriCounts[p];x.reduce((R,O)=>R+O,0);let A=0;for(let R=0;R<=4;R++){const O=x[R];if(O!==0){let L=this.regionSegments[R];L||(L=this.regionSegments[R]=new Yr);const B={vertexOffset:b.vertexOffset,primitiveOffset:b.primitiveOffset+A,vertexLength:b.vertexLength,primitiveLength:O};L.get().push(B)}A+=O}for(let R=0;R<g.length;R++){const O=g[R].id;this.indexArray.emplaceBack(O,O+1,O+3),this.indexArray.emplaceBack(O,O+3,O+2)}}this._segmentToGroundQuads=null,this._segmentToRegionTriCounts=null,this._segments.destroy(),this._segments=null}addPaintPropertiesData(i,l,p,g,b,x,A){this.hasData()&&this.programConfigurations.populatePaintArrays(this.vertexArray.length,i,l,p,g,b,x,void 0,A)}upload(i){this.hasData()&&(this.vertexBuffer=i.createVertexBuffer(this.vertexArray,TC.members),this.indexBuffer=i.createIndexBuffer(this.indexArray))}uploadPaintProperties(i){this.hasData()&&this.programConfigurations.upload(i)}update(i,l,p,g,b,x,A,R){this.hasData()&&this.programConfigurations.updatePaintArrays(i,l,p,g,b,x,A,R)}updateHiddenByLandmark(i){if(!this.hasData())return;const l=i.groundVertexCount+i.groundVertexArrayOffset;if(i.groundVertexCount===0)return;const p=i.flags&qf?1:0;for(let g=i.groundVertexArrayOffset;g<l;++g)this.hiddenByLandmarkVertexArray.emplace(g,p);this._needsHiddenByLandmarkUpdate=!0}uploadHiddenByLandmark(i){this.hasData()&&this._needsHiddenByLandmarkUpdate&&(!this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexArray.length>0?this.hiddenByLandmarkVertexBuffer=i.createVertexBuffer(this.hiddenByLandmarkVertexArray,SC.members,!0):this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.updateData(this.hiddenByLandmarkVertexArray),this._needsHiddenByLandmarkUpdate=!1)}destroy(){if(this.vertexBuffer){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.hiddenByLandmarkVertexBuffer&&this.hiddenByLandmarkVertexBuffer.destroy(),this._segments&&this._segments.destroy(),this.programConfigurations.destroy();for(let i=0;i<=4;i++){const l=this.regionSegments[i];l&&l.destroy()}}}}class Wf{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.overscaling=i.overscaling,this.layers=i.layers,this.pixelRatio=i.pixelRatio,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.hasPattern=!1,this.edgeRadius=0,this.projection=i.projection,this.activeReplacements=[],this.replacementUpdateTime=0,this.centroidData=[],this.footprintIndices=new mo,this.footprintVertices=new uc,this.footprintSegments=[],this.layoutVertexArray=new Rf,this.centroidVertexArray=new Nf,this.wallVertexArray=new Z0,this.indexArray=new mo,this.programConfigurations=new _(i.layers,{zoom:i.zoom,lut:i.lut},l=>RC.includes(l)),this.segments=new Yr,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.groundEffect=new ZT(i),this.maxHeight=0,this.partLookup={},this.triangleSubSegments=[],this.polygonSegments=[],this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,p,g){this.features=[],this.hasPattern=Ja("fill-extrusion",this.layers,this.pixelRatio,l),this.featuresOnBorder=[],this.borderFeatureIndices=[[],[],[],[]],this.borderDoneWithNeighborZ=[-1,-1,-1,-1],this.selfDEMTileTimestamp=Number.MAX_VALUE,this.borderDEMTileTimestamp=[Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE,Number.MAX_VALUE],this.tileToMeter=Dt(p),this.edgeRadius=this.layers[0].layout.get("fill-extrusion-edge-radius")/this.tileToMeter,this.wallMode=this.layers[0].paint.get("fill-extrusion-line-width").constantOr(1)!==0;for(const{feature:b,id:x,index:A,sourceLayerIndex:R}of i){const O=this.layers[0]._featureFilter.needGeometry,L=pn(b,O);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),L,p))continue;const B={id:x,sourceLayerIndex:R,index:A,geometry:O?L.geometry:fn(b,p,g),properties:b.properties,type:b.type,patterns:{}},U=this.layoutVertexArray.length,q=v1[B.type]==="Polygon";if(this.hasPattern)this.features.push(BT("fill-extrusion",this.layers,B,this.zoom,this.pixelRatio,l));else if(this.wallMode)for(const Y of B.geometry)for(const ne of qT(Y,q))this.addFeature(B,[ne],A,p,{},l.availableImages,g,l.brightness);else this.addFeature(B,B.geometry,A,p,{},l.availableImages,g,l.brightness);l.featureIndex.insert(b,B.geometry,A,R,this.index,U)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles(),this.groundEffect.prepareBorderSegments(),this.polygonSegments.length=0}addFeatures(i,l,p,g,b,x){for(const A of this.features){const R=v1[A.type]==="Polygon",{geometry:O}=A;if(this.wallMode)for(const L of O)for(const B of qT(L,R))this.addFeature(A,[B],A.index,l,p,g,b,x);else this.addFeature(A,O,A.index,l,p,g,b,x)}this.sortBorders(),this.projection.name==="mercator"&&this.splitToSubtiles()}update(i,l,p,g,b,x,A){this.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,this.worldview),this.groundEffect.update(i,l,b,p,g,x,A,this.worldview)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload||this.groundEffect.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,CC),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.wallVertexBuffer=i.createVertexBuffer(this.wallVertexArray,EC.members),this.layoutVertexExtArray&&(this.layoutVertexExtBuffer=i.createVertexBuffer(this.layoutVertexExtArray,AC.members,!0)),this.groundEffect.upload(i)),this.groundEffect.uploadPaintProperties(i),this.programConfigurations.upload(i),this.uploaded=!0}uploadCentroid(i){this.groundEffect.uploadHiddenByLandmark(i),this.needsCentroidUpdate&&(!this.centroidVertexBuffer&&this.centroidVertexArray.length>0?this.centroidVertexBuffer=i.createVertexBuffer(this.centroidVertexArray,ab.members,!0):this.centroidVertexBuffer&&this.centroidVertexBuffer.updateData(this.centroidVertexArray),this.needsCentroidUpdate=!1)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.centroidVertexBuffer&&this.centroidVertexBuffer.destroy(),this.layoutVertexExtBuffer&&this.layoutVertexExtBuffer.destroy(),this.groundEffect.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}addFeature(i,l,p,g,b,x,A,R){const O=this.layers[0].paint.get("fill-extrusion-flood-light-ground-radius").evaluate(i,{})/this.tileToMeter,L=[new Lt(0,0),new Lt(sn,sn)],B=A.projection,U=B.name==="globe",q=this.wallMode||v1[i.type]==="Polygon",Y=new YT;Y.centroidDataIndex=this.centroidData.length;const ne=new WT,ae=this.layers[0].paint.get("fill-extrusion-base").evaluate(i,{},g)<=0,he=this.layers[0].paint.get("fill-extrusion-height").evaluate(i,{},g);let Se;if(ne.height=he,ne.vertexArrayOffset=this.layoutVertexArray.length,ne.groundVertexArrayOffset=this.groundEffect.vertexArray.length,U&&!this.layoutVertexExtArray&&(this.layoutVertexExtArray=new Sa),this.wallMode){if(U)return void ii("Non zero fill-extrusion-line-width is not yet supported on globe.");if(l.length!==1)return;Se=function(st){const dt=st[0].x===st[st.length-1].x&&st[0].y===st[st.length-1].y;(function(ut){let Ct=0;const mn=ut.length;for(let tn=0;tn<mn;tn++)Ct+=(ut[(tn+1)%mn].x-ut[tn].x)*(ut[(tn+1)%mn].y+ut[tn].y);return Ct>=0})(st)||(st=st.reverse());const h={geometry:[],joinNormals:[],indices:[]},v=[],S=[],I=[];let k=st.length;for(;k>=2&&st[k-1].equals(st[k-2]);)k--;if(k<(dt?3:2))return h;let K,ee,me,De,it,yt=0;for(;yt<k-1&&st[yt].equals(st[yt+1]);)yt++;dt&&(K=st[k-2],it=st[yt].sub(K)._unit()._perp());for(let ut=yt;ut<k;ut++){if(me=ut===k-1?dt?st[yt+1]:void 0:st[ut+1],me&&st[ut].equals(me))continue;it&&(De=it),K&&(ee=K),K=st[ut],it=me?me.sub(K)._unit()._perp():De,De=De||it;let Ct=De.add(it);Ct.x===0&&Ct.y===0||Ct._unit();const mn=Ct.x*it.x+Ct.y*it.y,tn=mn!==0?1/mn:1/0,Qt=De.x*it.y-De.y*it.x>0;let Je="miter";const rt=2;Je==="miter"&&tn>rt&&(Je="bevel"),Je==="bevel"&&(tn>100&&(Je="flipbevel"),tn<rt&&(Je="miter"));const lt=(kt,Zt,On,An)=>{const Yn=new Lt(kt.x,kt.y),Ce=new Lt(kt.x,kt.y);Yn.x+=Zt.x*An,Yn.y+=Zt.y*An,Ce.x-=Zt.x*Math.max(On,1),Ce.y-=Zt.y*Math.max(On,1),I.push(Zt),v.push(Yn),S.push(Ce)};if(Je==="miter")Ct._mult(tn),lt(K,Ct,0,0);else if(Je==="flipbevel")Ct=it.mult(-1),lt(K,Ct,0,0),lt(K,Ct.mult(-1),0,0);else{const kt=-Math.sqrt(tn*tn-1),Zt=Qt?kt:0,On=Qt?0:kt;ee&&lt(K,De,Zt,On),me&&lt(K,it,Zt,On)}}h.geometry=[...v,...S.reverse(),v[0]],h.joinNormals=[...I,...I.reverse(),I[I.length-1]];const ct=h.geometry.length-1;for(let ut=0;ut<ct/2;ut++)if(ut+1<ct/2){let Ct=ut,mn=ut+1,tn=ct-1-ut,Qt=ct-2-ut;Ct=Ct===0?ct-1:Ct-1,mn=mn===0?ct-1:mn-1,tn=tn===0?ct-1:tn-1,Qt=Qt===0?ct-1:Qt-1,h.indices.push(tn),h.indices.push(mn),h.indices.push(Ct),h.indices.push(tn),h.indices.push(Qt),h.indices.push(mn)}return h}(l[0]),l=[Se.geometry]}const Ae=(st,dt)=>st<(dt.length-1)/2||st===dt.length-1,re=this.wallMode?[l]:ei(l,500);for(let st=re.length-1;st>=0;st--){const dt=re[st];(dt.length===0||(ye=dt[0]).every(a=>a.x<=0)||ye.every(a=>a.x>=sn)||ye.every(a=>a.y<=0)||ye.every(a=>a.y>=sn))&&re.splice(st,1)}var ye;let Oe;if(U)Oe=QT(re,L,g);else{Oe=[];for(const st of re)Oe.push({polygon:st,bounds:L})}const Le=q?this.edgeRadius:0,nt=Le>0&&this.zoom<17,Qe=(st,dt)=>{if(st.length===0)return!1;const a=st[st.length-1];return dt.x===a.x&&dt.y===a.y};for(const{polygon:st,bounds:dt}of Oe){let a=0,h=0;for(const k of st)q&&!k[0].equals(k[k.length-1])&&k.push(k[0]),h+=q?k.length-1:k.length;const v=this.segments.prepareSegment((q?5:4)*h,this.layoutVertexArray,this.indexArray);ne.footprintSegIdx<0&&(ne.footprintSegIdx=this.footprintSegments.length),ne.polygonSegIdx<0&&(ne.polygonSegIdx=this.polygonSegments.length);const S={triangleArrayOffset:this.indexArray.length,triangleCount:0,triangleSegIdx:this.segments.segments.length-1},I=new b1;if(I.vertexOffset=this.footprintVertices.length,I.indexOffset=3*this.footprintIndices.length,I.ringIndices=[],q){const k=[],K=[];a=v.vertexLength;for(let me=0;me<st.length;me++){const De=st[me];De.length&&me!==0&&K.push(k.length/2);const it=[];let yt,ct;yt=De[1].sub(De[0])._perp()._unit(),I.ringIndices.push(De.length-1);for(let ut=1;ut<De.length;ut++){const Ct=De[ut],mn=De[ut===De.length-1?1:ut+1],tn=Ct.clone();if(Le){ct=mn.sub(Ct)._perp()._unit();const Qt=yt.add(ct)._unit(),Je=Le*Math.min(4,1/(yt.x*Qt.x+yt.y*Qt.y));tn.x+=Je*Qt.x,tn.y+=Je*Qt.y,tn.x=Math.round(tn.x),tn.y=Math.round(tn.y),yt=ct}if(!ae||Le!==0&&!nt||Qe(it,tn)||it.push(tn),hb(this.layoutVertexArray,tn.x,tn.y,0,0,1,1,0),this.wallMode){const Qt=Ae(ut,De);db(this.wallVertexArray,Se.joinNormals[ut],!Qt)}v.vertexLength++,this.footprintVertices.emplaceBack(Ct.x,Ct.y),k.push(Ct.x,Ct.y),U&&em(this.layoutVertexExtArray,B.projectTilePoint(tn.x,tn.y,g),B.upVector(g,tn.x,tn.y))}ae&&(Le===0||nt)&&(it.length!==0&&Qe(it,it[0])&&it.pop(),this.groundEffect.addData(it,dt,O))}const ee=this.wallMode?Se.indices:Jt(k,K);for(let me=0;me<ee.length;me+=3)this.footprintIndices.emplaceBack(I.vertexOffset+ee[me+0],I.vertexOffset+ee[me+1],I.vertexOffset+ee[me+2]),this.indexArray.emplaceBack(a+ee[me],a+ee[me+2],a+ee[me+1]),v.primitiveLength++;I.indexCount+=ee.length,I.vertexCount+=this.footprintVertices.length-I.vertexOffset}for(let k=0;k<st.length;k++){const K=st[k];Y.startRing(ne,K[0]);let ee=K.length>4&&Bg(K[K.length-2],K[0],K[1]),me=Le?NC(K[K.length-2],K[0],K[1],Le):0;const De=[];let it,yt,ct;yt=K[1].sub(K[0])._perp()._unit();let ut=!0;for(let Ct=1,mn=0;Ct<K.length;Ct++){let tn=K[Ct-1],Qt=K[Ct];const Je=K[Ct===K.length-1?1:Ct+1];if(Y.appendEdge(ne,Qt,tn),w1(Qt,tn,dt)){Le&&(yt=Je.sub(Qt)._perp()._unit(),ut=!ut);continue}const rt=Qt.sub(tn)._perp(),lt=rt.x/(Math.abs(rt.x)+Math.abs(rt.y)),kt=rt.y>0?1:0,Zt=tn.dist(Qt);if(mn+Zt>32768&&(mn=0),Le){ct=Je.sub(Qt)._perp()._unit();let Ce=XT(tn,Qt,Je,x1(yt,ct),Le);isNaN(Ce)&&(Ce=0);const Me=Qt.sub(tn)._unit();tn=tn.add(Me.mult(me))._round(),Qt=Qt.add(Me.mult(-Ce))._round(),me=Ce,yt=ct,ae&&this.zoom>=17&&(Qe(De,tn)||De.push(tn),Qe(De,Qt)||De.push(Qt))}const On=v.vertexLength,An=K.length>4&&Bg(tn,Qt,Je);let Yn=LC(mn,ee,ut);if(hb(this.layoutVertexArray,tn.x,tn.y,lt,kt,0,0,Yn),hb(this.layoutVertexArray,tn.x,tn.y,lt,kt,0,1,Yn),this.wallMode){const Ce=Ae(Ct-1,K),Me=Se.joinNormals[Ct-1];db(this.wallVertexArray,Me,Ce),db(this.wallVertexArray,Me,Ce)}if(mn+=Zt,Yn=LC(mn,An,!ut),ee=An,hb(this.layoutVertexArray,Qt.x,Qt.y,lt,kt,0,0,Yn),hb(this.layoutVertexArray,Qt.x,Qt.y,lt,kt,0,1,Yn),this.wallMode){const Ce=Ae(Ct,K),Me=Se.joinNormals[Ct];db(this.wallVertexArray,Me,Ce),db(this.wallVertexArray,Me,Ce)}if(v.vertexLength+=4,this.indexArray.emplaceBack(On+0,On+1,On+2),this.indexArray.emplaceBack(On+1,On+3,On+2),v.primitiveLength+=2,Le){const Ce=a+(Ct===1?K.length-2:Ct-2),Me=Ct===1?a:Ce+1;if(this.indexArray.emplaceBack(On+1,Ce,On+3),this.indexArray.emplaceBack(Ce,Me,On+3),v.primitiveLength+=2,it===void 0&&(it=On),!w1(Je,K[Ct],dt)){const wt=Ct===K.length-1?it:v.vertexLength;this.indexArray.emplaceBack(On+2,On+3,wt),this.indexArray.emplaceBack(On+3,wt+1,wt),this.indexArray.emplaceBack(On+3,Me,wt+1),v.primitiveLength+=3}ut=!ut}if(U){const Ce=this.layoutVertexExtArray,Me=B.projectTilePoint(tn.x,tn.y,g),wt=B.projectTilePoint(Qt.x,Qt.y,g),Wt=B.upVector(g,tn.x,tn.y),un=B.upVector(g,Qt.x,Qt.y);em(Ce,Me,Wt),em(Ce,Me,Wt),em(Ce,wt,un),em(Ce,wt,un)}}q&&(a+=K.length-1),ae&&Le&&this.zoom>=17&&(De.length!==0&&Qe(De,De[0])&&De.pop(),this.groundEffect.addData(De,dt,O,Le>0))}this.footprintSegments.push(I),S.triangleCount=this.indexArray.length-S.triangleArrayOffset,this.polygonSegments.push(S),++ne.footprintSegLen,++ne.polygonSegLen}if(ne.vertexCount=this.layoutVertexArray.length-ne.vertexArrayOffset,ne.groundVertexCount=this.groundEffect.vertexArray.length-ne.groundVertexArrayOffset,ne.vertexCount!==0){if(ne.centroidXY=Y.borders?PC:this.encodeCentroid(Y,ne),this.centroidData.push(ne),Y.borders){this.featuresOnBorder.push(Y);const st=this.featuresOnBorder.length-1;for(let dt=0;dt<Y.borders.length;dt++)Y.borders[dt][0]!==Number.MAX_VALUE&&this.borderFeatureIndices[dt].push(st)}this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,b,x,g,R,void 0,this.worldview),this.groundEffect.addPaintPropertiesData(i,p,b,x,g,R,this.worldview),this.maxHeight=Math.max(this.maxHeight,he)}}sortBorders(){for(let i=0;i<this.borderFeatureIndices.length;i++)this.borderFeatureIndices[i].sort((l,p)=>this.featuresOnBorder[l].borders[i][0]-this.featuresOnBorder[p].borders[i][0])}splitToSubtiles(){const i=[];for(let A=0;A<this.centroidData.length;A++){const R=this.centroidData[A],O=+(R.min.y+R.max.y>sn),L=2*O+(+(R.min.x+R.max.x>sn)^O);for(let B=0;B<R.polygonSegLen;B++){const U=R.polygonSegIdx+B;i.push({centroidIdx:A,subtile:L,polygonSegmentIdx:U,triangleSegmentIdx:this.polygonSegments[U].triangleSegIdx})}}const l=new mo;i.sort((A,R)=>A.triangleSegmentIdx===R.triangleSegmentIdx?A.subtile-R.subtile:A.triangleSegmentIdx-R.triangleSegmentIdx);let p=0,g=0,b=0;for(const A of i){if(A.triangleSegmentIdx!==p)break;b++}const x=i.length;for(;g!==i.length;){p=i[g].triangleSegmentIdx;let A=0,R=g,O=g;for(let L=R;L<b&&i[L].subtile===A;L++)O++;for(;R!==b;){const L=i[R];A=L.subtile;const B=this.centroidData[L.centroidIdx].min.clone(),U=this.centroidData[L.centroidIdx].max.clone(),q={vertexOffset:this.segments.segments[p].vertexOffset,primitiveOffset:l.length,vertexLength:this.segments.segments[p].vertexLength,primitiveLength:0,sortKey:void 0,vaos:{}};for(let Y=R;Y<O;Y++){const ne=i[Y],ae=this.polygonSegments[ne.polygonSegmentIdx],he=this.centroidData[ne.centroidIdx].min,Se=this.centroidData[ne.centroidIdx].max,Ae=this.indexArray.uint16;for(let re=ae.triangleArrayOffset;re<ae.triangleArrayOffset+ae.triangleCount;re++)l.emplaceBack(Ae[3*re],Ae[3*re+1],Ae[3*re+2]);q.primitiveLength+=ae.triangleCount,B.x=Math.min(B.x,he.x),B.y=Math.min(B.y,he.y),U.x=Math.max(U.x,Se.x),U.y=Math.max(U.y,Se.y)}q.primitiveLength>0&&this.triangleSubSegments.push({segment:q,min:B,max:U}),R=O;for(let Y=R;Y<b&&i[Y].subtile===i[R].subtile;Y++)O++}g=b;for(let L=g;L<x&&i[L].triangleSegmentIdx===i[g].triangleSegmentIdx;L++)b++}l._trim(),this.indexArray=l}getVisibleSegments(i,l,p){const g=new Yr;if(this.wallMode){for(const ne of this.triangleSubSegments)g.segments.push(ne.segment);return g}let b=0,x=0;const A=1<<i.canonical.z;if(l){const ne=l.getMinMaxForTile(i);ne&&(b=ne.min,x=ne.max)}x+=this.maxHeight;const R=i.toUnwrapped();let O;const L=[R.canonical.x/A+R.wrap,R.canonical.y/A],B=[(R.canonical.x+1)/A+R.wrap,(R.canonical.y+1)/A],U=(ne,ae,he)=>[ne[0]*(1-he[0])+ae[0]*he[0],ne[1]*(1-he[1])+ae[1]*he[1]],q=[],Y=[];for(const ne of this.triangleSubSegments){q[0]=ne.min.x/sn,q[1]=ne.min.y/sn,Y[0]=ne.max.x/sn,Y[1]=ne.max.y/sn;const ae=U(L,B,q),he=U(L,B,Y);if(new Vi([ae[0],ae[1],b],[he[0],he[1],x]).intersectsPrecise(p)===0){O&&(g.segments.push(O),O=void 0);continue}const Se=ne.segment;O&&O.vertexOffset!==Se.vertexOffset&&(g.segments.push(O),O=void 0),O?(O.vertexLength+=Se.vertexLength,O.primitiveLength+=Se.primitiveLength):O={vertexOffset:Se.vertexOffset,primitiveLength:Se.primitiveLength,vertexLength:Se.vertexLength,primitiveOffset:Se.primitiveOffset,sortKey:void 0,vaos:{}}}return O&&g.segments.push(O),g}encodeCentroid(i,l){const p=i.centroid(),g=l.span(),b=Math.min(7,Math.round(g.x*this.tileToMeter/10)),x=Math.min(7,Math.round(g.y*this.tileToMeter/10));return new Lt(He(p.x,1,sn-1)<<3|b,He(p.y,1,sn-1)<<3|x)}encodeBorderCentroid(i){if(!i.borders)return new Lt(0,0);const l=i.borders,p=Number.MAX_VALUE;if(l[0][0]!==p||l[1][0]!==p){const g=l[0][0]!==p?0:1;return new Lt(6|(l[0][0]!==p?0:65528),(l[g][0]+l[g][1])/2<<3|6)}{const g=l[2][0]!==p?2:3;return new Lt((l[g][0]+l[g][1])/2<<3|6,6|(l[2][0]!==p?0:65528))}}showCentroid(i){const l=this.centroidData[i.centroidDataIndex];l.flags&=qf,l.centroidXY.x=0,l.centroidXY.y=0,this.writeCentroidToBuffer(l)}writeCentroidToBuffer(i){this.groundEffect.updateHiddenByLandmark(i);const l=i.vertexArrayOffset,p=i.vertexCount+i.vertexArrayOffset,g=i.flags&qf?PC:i.centroidXY,b=this.centroidVertexArray.geta_centroid_pos0(l);if(this.centroidVertexArray.geta_centroid_pos1(l)!==g.y||b!==g.x){for(let x=l;x<p;++x)this.centroidVertexArray.emplace(x,g.x,g.y);this.needsCentroidUpdate=!0}}createCentroidsBuffer(){this.centroidVertexArray.resize(this.layoutVertexArray.length),this.groundEffect.hiddenByLandmarkVertexArray.resize(this.groundEffect.vertexArray.length);for(const i of this.centroidData)this.writeCentroidToBuffer(i)}updateReplacement(i,l,p){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const g=l.getReplacementRegionsForTile(i.toUnwrapped());if(ub(this.activeReplacements,g))return;if(this.activeReplacements=g,this.centroidVertexArray.length===0)this.createCentroidsBuffer();else for(const x of this.centroidData)x.flags&=2147483647;const b=[];for(const x of this.activeReplacements){if(x.order<p)continue;const A=Math.max(1,Math.pow(2,x.footprintTileId.canonical.z-i.canonical.z));for(const R of this.centroidData)if(!(R.flags&qf||x.min.x>R.max.x||R.min.x>x.max.x||x.min.y>R.max.y||R.min.y>x.max.y))for(let O=0;O<R.footprintSegLen;O++){const L=this.footprintSegments[R.footprintSegIdx+O];if(b.length=0,Ly(this.footprintVertices,L.vertexOffset,L.vertexCount,x.footprintTileId.canonical,i.canonical,b),Lh(x.footprint,b,this.footprintIndices.uint16,L.indexOffset,L.indexCount,-L.vertexOffset,-A)){R.flags|=qf;break}}}for(const x of this.centroidData)this.writeCentroidToBuffer(x);this.borderDoneWithNeighborZ=[-1,-1,-1,-1]}footprintContainsPoint(i,l,p){let g=!1;for(let b=0;b<p.footprintSegLen;b++){const x=this.footprintSegments[p.footprintSegIdx+b];let A=0;for(const R of x.ringIndices){for(let O=A,L=R+A-1;O<R+A;L=O++){const B=this.footprintVertices.int16[2*(O+x.vertexOffset)+0],U=this.footprintVertices.int16[2*(O+x.vertexOffset)+1],q=this.footprintVertices.int16[2*(L+x.vertexOffset)+1];U>l!=q>l&&i<(this.footprintVertices.int16[2*(L+x.vertexOffset)+0]-B)*(l-U)/(q-U)+B&&(g=!g)}A=R}}return g}getHeightAtTileCoord(i,l){let p=Number.NEGATIVE_INFINITY,g=!0;const b=4*(i+sn)*sn+(l+sn);if(this.partLookup.hasOwnProperty(b)){const x=this.partLookup[b];return x?{height:x.height,hidden:!!(x.flags&qf)}:void 0}for(const x of this.centroidData)i>x.max.x||x.min.x>i||l>x.max.y||x.min.y>l||this.footprintContainsPoint(i,l,x)&&x&&x.height>p&&(p=x.height,this.partLookup[b]=x,g=!!(x.flags&qf));if(p!==Number.NEGATIVE_INFINITY)return{height:p,hidden:g};this.partLookup[b]=void 0}}function x1(u,i){const l=u.add(i)._unit();return u.x*l.x+u.y*l.y}function NC(u,i,l,p){const g=i.sub(u)._perp()._unit(),b=l.sub(i)._perp()._unit();return XT(u,i,l,x1(g,b),p)}function XT(u,i,l,p,g){const b=Math.sqrt(1-p*p);return Math.min(u.dist(i)/3,i.dist(l)/3,g*b/p)}function w1(u,i,l){return u.x<l[0].x&&i.x<l[0].x||u.x>l[1].x&&i.x>l[1].x||u.y<l[0].y&&i.y<l[0].y||u.y>l[1].y&&i.y>l[1].y}function pb(u,i){return u.x<i[0].x||u.x>i[1].x||u.y<i[0].y||u.y>i[1].y}function Bg(u,i,l){if(u.x<0||u.x>=sn||i.x<0||i.x>=sn||l.x<0||l.x>=sn)return!1;const p=l.sub(i),g=p.perp(),b=u.sub(i);return(p.x*b.x+p.y*b.y)/Math.sqrt((p.x*p.x+p.y*p.y)*(b.x*b.x+b.y*b.y))>-.866&&g.x*b.x+g.y*b.y<0}function LC(u,i,l){const p=i?2|u:-3&u;return l?1|p:-2&p}function mb(){const u=Math.PI/32,i=Math.tan(u),l=ue;return l*Math.sqrt(1+2*i*i)-l}function QT(u,i,l){const p=1<<l.z,g=et(l.x/p),b=et((l.x+1)/p),x=_t(l.y/p),A=_t((l.y+1)/p);return function(R,O,L,B,U=0,q){const Y=[];if(!R.length||!L||!B)return Y;const ne=(Oe,Le)=>{for(const nt of Oe)Y.push({polygon:nt,bounds:Le})},ae=Math.ceil(Math.log2(L)),he=Math.ceil(Math.log2(B)),Se=ae-he,Ae=[];for(let Oe=0;Oe<Math.abs(Se);Oe++)Ae.push(Se>0?0:1);for(let Oe=0;Oe<Math.min(ae,he);Oe++)Ae.push(0),Ae.push(1);let re=R;if(re=Nh(re,O[0].y-U,O[1].y+U,1),re=Nh(re,O[0].x-U,O[1].x+U,0),!re.length)return Y;const ye=[];for(Ae.length?ye.push({polygons:re,bounds:O,depth:0}):ne(re,O);ye.length;){const Oe=ye.pop(),Le=Oe.depth,nt=Ae[Le],Qe=Oe.bounds[0],st=Oe.bounds[1],dt=nt===0?Qe.x:Qe.y,a=nt===0?st.x:st.y,h=q?q(nt,dt,a):.5*(dt+a),v=Nh(Oe.polygons,dt-U,h+U,nt),S=Nh(Oe.polygons,h-U,a+U,nt);if(v.length){const I=[Qe,new Lt(nt===0?h:st.x,nt===1?h:st.y)];Ae.length>Le+1?ye.push({polygons:v,bounds:I,depth:Le+1}):ne(v,I)}if(S.length){const I=[new Lt(nt===0?h:Qe.x,nt===1?h:Qe.y),st];Ae.length>Le+1?ye.push({polygons:S,bounds:I,depth:Le+1}):ne(S,I)}}return Y}(u,i,Math.ceil((b-g)/11.25),Math.ceil((x-A)/11.25),1,(R,O,L)=>{if(R===0)return .5*(O+L);{const B=_t((l.y+O/sn)/p);return(Ue(.5*(_t((l.y+L/sn)/p)+B))*p-l.y)*sn}})}function Ly(u,i,l,p,g,b){const x=Math.pow(2,p.z-g.z);for(let A=0;A<l;A++){let R=u.int16[2*(A+i)+0],O=u.int16[2*(A+i)+1];R=(R+g.x*sn)*x-p.x*sn,O=(O+g.y*sn)*x-p.y*sn,b.push(new Lt(R,O))}}let zC,BC;vn(Wf,"FillExtrusionBucket",{omit:["layers","features"]}),vn(WT,"PartData"),vn(b1,"FootprintSegment"),vn(YT,"BorderCentroidData"),vn(ZT,"GroundEffect");class tm extends Lt{constructor(i,l,p){super(i,l),this.z=p}}class yl extends tm{constructor(i,l,p,g){super(i,l,p),this.w=g}}function KT(u,i,l,p){const g=l==="x"?"y":"x",b=(p-u[l])/(i[l]-u[l]);u[g]=Math.round(u[g]+(i[g]-u[g])*b),u[l]=p,u.hasOwnProperty("z")&&(u.z=$n(u.z,i.z,b)),u.hasOwnProperty("w")&&(u.w=$n(u.w,i.w,b))}function FC(u,i,l,p){const g=l,b=p;for(const x of["x","y"]){let A=u,R=i;A[x]>=R[x]&&(A=i,R=u),A[x]<g&&R[x]>g&&KT(A,R,x,g),A[x]<b&&R[x]>b&&KT(R,A,x,b)}}function T1(u,i,l,p,g,b){const x=[];for(let A=0;A<u.length;A++){const R=u[A];let O;const L=x.length;let B=0;for(let U=0;U<R.length-1;U++){let q=R[U],Y=R[U+1],ne=0;const ae=B;let he,Se;b&&(ne=Math.hypot(Y.x-q.x,Y.y-q.y),B+=ne,he=q,Se=Y),q.x<i&&Y.x<i||(q.x<i?q=new Lt(i,q.y+(i-q.x)/(Y.x-q.x)*(Y.y-q.y))._round():Y.x<i&&(Y=new Lt(i,q.y+(i-q.x)/(Y.x-q.x)*(Y.y-q.y))._round()),q.y<l&&Y.y<l||(q.y<l?q=new Lt(q.x+(l-q.y)/(Y.y-q.y)*(Y.x-q.x),l)._round():Y.y<l&&(Y=new Lt(q.x+(l-q.y)/(Y.y-q.y)*(Y.x-q.x),l)._round()),q.x>=p&&Y.x>=p||(q.x>=p?q=new Lt(p,q.y+(p-q.x)/(Y.x-q.x)*(Y.y-q.y))._round():Y.x>=p&&(Y=new Lt(p,q.y+(p-q.x)/(Y.x-q.x)*(Y.y-q.y))._round()),q.y>=g&&Y.y>=g||(q.y>=g?q=new Lt(q.x+(g-q.y)/(Y.y-q.y)*(Y.x-q.x),g)._round():Y.y>=g&&(Y=new Lt(q.x+(g-q.y)/(Y.y-q.y)*(Y.x-q.x),g)._round()),O&&q.equals(O[O.length-1])||(O=[q],x.push(O),b&&b.push({progress:{min:ae+VC(he,Se,q)*ne,max:1},parentIndex:A,prevPoint:he,nextPoint:Se})),O.push(Y),b&&(b[b.length-1].progress.max=ae+VC(he,Se,Y)*ne,b[b.length-1].nextPoint=Se)))))}if(b&&B>0)for(let U=L;U<x.length;U++)b[U].progress.min/=B,b[U].progress.max/=B}return x}function AM(u,i,l,p,g){if(u.length<2)return void p.push(u);const b=[];for(;i.valid();){const[O,L]=i.get();for(let B=0;B<u.length-1;B++){const U=u[B],q=u[B+1],Y=Ay(U,q,O,L);if(Y){const[ne]=Y,ae=new Lt($n(U.x,q.x,ne),$n(U.y,q.y,ne));b.push({t:B+ne,distance:0,point:ae})}}i.next()}if(b.length===0)return void p.push(u);b.sort((O,L)=>O.t-L.t);let x=0,A=0,R=[];for(p.push(R);x!==u.length;){if(A===b.length){for(;x!==u.length;)R.length!==0&&R[R.length-1].equals(u[x])||R.push(u[x]),x++;break}b[A].t<=x?(R.length!==0&&R[R.length-1].equals(b[A].point)||R.push(b[A].point),Math.trunc(b[A].t),A++):(R.length!==0&&R[R.length-1].equals(u[x])||R.push(u[x]),x++)}}function VC(u,i,l){return u.x!==i.x?(l.x-u.x)/(i.x-u.x):u.y!==i.y?(l.y-u.y)/(i.y-u.y):0}function Yf(u,i){return u.x*i.x+u.y*i.y}function Fg(u,i){if(u.length===1){let l=0;const p=i[l++];let g;for(;!g||p.equals(g);)if(g=i[l++],!g)return 1/0;for(;l<i.length;l++){const b=i[l],x=u[0],A=g.sub(p),R=b.sub(p),O=x.sub(p),L=Yf(A,A),B=Yf(A,R),U=Yf(R,R),q=Yf(O,A),Y=Yf(O,R),ne=L*U-B*B,ae=(U*q-B*Y)/ne,he=(L*Y-B*q)/ne,Se=p.z*(1-ae-he)+g.z*ae+b.z*he;if(isFinite(Se))return Se}return 1/0}{let l=1/0;for(const p of i)l=Math.min(l,p.z);return l}}function Vg(u,i,l,p,g,b,x,A){const R=x*g.getElevationAt(u,i,!0,!0),O=b[0]!==0,L=O?b[1]===0?x*(b[0]/7-450):x*function(B,U,q){const Y=Math.floor(U[0]/8),ne=Math.floor(U[1]/8),ae=10*(U[0]-8*Y),he=10*(U[1]-8*ne),Se=B.getElevationAt(Y,ne,!0,!0),Ae=B.getMeterToDEM(q),re=Math.floor(.5*(ae*Ae-1)),ye=Math.floor(.5*(he*Ae-1)),Oe=B.tileCoordToPixel(Y,ne),Le=2*re+1,nt=2*ye+1,Qe=function(S,I,k,K,ee){return[S.getElevationAtPixel(I,k,!0),S.getElevationAtPixel(I+ee,k,!0),S.getElevationAtPixel(I,k+ee,!0),S.getElevationAtPixel(I+K,k+ee,!0)]}(B,Oe.x-re,Oe.y-ye,Le,nt),st=Math.abs(Qe[0]-Qe[1]),dt=Math.abs(Qe[2]-Qe[3]),a=Math.abs(Qe[0]-Qe[2])+Math.abs(Qe[1]-Qe[3]),h=Math.min(.25,.5*Ae*(st+dt)/Le),v=Math.min(.25,.5*Ae*a/nt);return Se+Math.max(h*ae,v*he)}(g,b,A):R;return{base:R+(l===0?-1:l),top:O?Math.max(L+p,R+l+2):R+p}}class JT{constructor(i){this._callback=i,this._triggered=!1,typeof MessageChannel<"u"&&(this._channel=new MessageChannel,this._channel.port2.onmessage=()=>{this._triggered=!1,this._callback()})}trigger(){this._triggered||(this._triggered=!0,this._channel?this._channel.port1.postMessage(!0):setTimeout(()=>{this._triggered=!1,this._callback()},0))}remove(){this._channel=void 0,this._callback=()=>{}}}class Md{constructor(){this.tasks={},this.taskQueue=[],_n(["process"],this),this.invoker=new JT(this.process),this.nextId=0}add(i,l){const p=this.nextId++,g=function({type:b,isSymbolTile:x,zoom:A}){return A=A||0,b==="message"?0:b!=="maybePrepare"||x?b!=="parseTile"||x?b==="parseTile"&&x?300-A:b==="maybePrepare"&&x?400-A:500:200-A:100-A}(l);if(g===0){try{i()}finally{}return null}return this.tasks[p]={fn:i,metadata:l,priority:g,id:p},this.taskQueue.push(p),this.invoker.trigger(),{cancel:()=>{delete this.tasks[p]}}}process(){try{if(this.taskQueue=this.taskQueue.filter(p=>!!this.tasks[p]),!this.taskQueue.length)return;const i=this.pick();if(i===null)return;const l=this.tasks[i];if(delete this.tasks[i],this.taskQueue.length&&this.invoker.trigger(),!l)return;l.fn()}finally{}}pick(){let i=null,l=1/0;for(let g=0;g<this.taskQueue.length;g++){const b=this.tasks[this.taskQueue[g]];b.priority<l&&(l=b.priority,i=g)}if(i===null)return null;const p=this.taskQueue[i];return this.taskQueue.splice(i,1),p}remove(){this.invoker.remove()}}class E1{constructor(i,l,p){this.target=i,this.parent=l,this.mapId=p,this.callbacks={},this.cancelCallbacks={},_n(["receive"],this),this.target.addEventListener("message",this.receive,!1),this.scheduler=new Md}send(i,l,p,g,b=!1,x){const A=Math.round(1e18*Math.random()).toString(36).substring(0,10);p&&(p.metadata=x,this.callbacks[A]=p);const R=new Set;return this.target.postMessage({id:A,type:i,hasCallback:!!p,targetMapId:g,mustQueue:b,sourceMapId:this.mapId,data:tu(l,R)},R),{cancel:()=>{p&&delete this.callbacks[A],this.target.postMessage({id:A,type:"<cancel>",targetMapId:g,sourceMapId:this.mapId})}}}receive(i){const l=i.data;if(!l)return;const p=l.id;if(p&&(!l.targetMapId||this.mapId===l.targetMapId))if(l.type==="<cancel>"){const g=this.cancelCallbacks[p];delete this.cancelCallbacks[p],g&&g.cancel()}else if(l.mustQueue||Ai(self)){const g=this.callbacks[p],b=this.scheduler.add(()=>this.processTask(p,l),g&&g.metadata||{type:"message"});b&&(this.cancelCallbacks[p]=b)}else this.processTask(p,l)}processTask(i,l){if(delete this.cancelCallbacks[i],l.type==="<response>"){const p=this.callbacks[i];delete this.callbacks[i],p&&(l.error?p(bh(l.error)):p(null,bh(l.data)))}else{const p=new Set,g=l.hasCallback?(x,A)=>{this.target.postMessage({id:i,type:"<response>",sourceMapId:this.mapId,error:x?tu(x):null,data:tu(A,p)},p)}:()=>{},b=bh(l.data);if(this.parent[l.type])this.parent[l.type](l.sourceMapId,b,g);else if(this.parent.getWorkerSource){const x=l.type.split("."),{source:A,scope:R}=b;this.parent.getWorkerSource(l.sourceMapId,x[0],A,R)[x[1]](b,g)}else g(new Error(`Could not find function ${l.type}`))}}remove(){this.scheduler.remove(),this.target.removeEventListener("message",this.receive,!1)}}var Zf={workerUrl:"",workerClass:null,workerParams:void 0};const Pd="mapboxgl_preloaded_worker_pool";class Xf{constructor(){this.active={}}acquire(i,l=Xf.workerCount){if(!this.workers)for(this.workers=[];this.workers.length<l;)this.workers.push(Zf.workerClass!=null?new Zf.workerClass:new self.Worker(Zf.workerUrl,Zf.workerParams));return this.active[i]=!0,this.workers.slice()}release(i){delete this.active[i],this.workers&&this.numActive()===0&&(this.workers.forEach(l=>{l.terminate()}),this.workers=null)}isPreloaded(){return!!this.active[Pd]}numActive(){return Object.keys(this.active).length}}Xf.workerCount=2;class Qf{constructor(i,l,p="Worker",g=Xf.workerCount){this.workerPool=i,this.actors=[],this.currentActor=0,this.id=Et();const b=this.workerPool.acquire(this.id,g);for(let x=0;x<b.length;x++){const A=new Qf.Actor(b[x],l,this.id);A.name=`${p} ${x}`,this.actors.push(A)}this.ready=!1,this.broadcast("checkIfReady",null,()=>{this.ready=!0})}broadcast(i,l,p){Ze(this.actors,(g,b)=>{g.send(i,l,b)},p=p||function(){})}getActor(){return this.currentActor=(this.currentActor+1)%this.actors.length,this.actors[this.currentActor]}remove(){this.actors.forEach(i=>{i.remove()}),this.actors=[],this.workerPool.release(this.id)}}let zh,zy;function nm(){return zh||(zh=new Xf),zh}Qf.Actor=E1;class CM{constructor(i){this.module=i}createIntArray(i){const l=new Int32Array(i),p=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heap32.set(l,p/l.BYTES_PER_ELEMENT),p}createFloatArray(i){const l=new Float32Array(i),p=this.module.malloc(l.length*l.BYTES_PER_ELEMENT);return this.module.heapF32.set(l,p/l.BYTES_PER_ELEMENT),p}createStringBuffer(i){const l=this.module.malloc(i.length+1);for(let p=0;p<i.length;++p)this.module.heapU8[l+p]=i.charCodeAt(p);return this.module.heapU8[l+i.length]=0,l}readStringBuffer(i){let l="";for(;this.module.heapU8[i]!==0;)l+=String.fromCharCode(this.module.heapU8[i]),++i;return l}setStyle(i){const l=i.entranceColorRgb,p=i.facadeGlazingColorRgb,g=i.roofColorRgb,b=i.wallColorRgb,x=i.normalScale;this.module.setStyle(l[0],l[1],l[2],p[0],p[1],p[2],g[0],g[1],g[2],b[0],b[1],b[2],x[0],x[1],x[2],i.tileToMeters)}setAOOptions(i,l){this.module.setAOOptions(i?1:0,l)}setMetricOptions(i,l){this.module.setMetricOptions(i?1:0,l)}setFacadeOptions(i,l,p){this.module.setFacadeOptions(i,l,p)}generateMesh(i,l){for(const A of i){const R=this.createStringBuffer(A.roofType),O=[0],L=[];for(const q of A.coordinates)if(Array.isArray(q)){for(const Y of q)L.push(Y.x),L.push(Y.y);O.push(L.length)}const B=this.createIntArray(O),U=this.createFloatArray(L);this.module.addFeature(A.id,A.sourceId,A.minHeight,A.height,R,A.roofType.length,U,B,O.length-1),this.module.free(R),this.module.free(B),this.module.free(U)}for(const A of l){let R;R=A.entrances?JSON.parse(A.entrances):[];const O=this.createFloatArray(R),L=[];for(const U of A.coordinates)L.push(U.x),L.push(U.y);const B=this.createFloatArray(L);this.module.addFacade(A.sourceId,A.crossPerc,A.distanceToRoad,O,R.length,B,L.length),this.module.free(O),this.module.free(B)}if(!this.module.generateMesh()){const A=this.module.getLastError();return this.readStringBuffer(A)}const p=this.module.getMeshCount(),g=new Array(p);for(let A=0;A<p;A++){const R=this.module.getPositionsPtr(A),O=this.module.getPositionsLength(A),L=new Float32Array(this.module.heapF32.buffer,R,O),B=this.module.getNormalsPtr(A),U=this.module.getNormalsLength(A),q=new Float32Array(this.module.heapF32.buffer,B,U),Y=this.module.getColorsPtr(A),ne=this.module.getColorsLength(A),ae=new Uint8Array(this.module.heapU8.buffer,Y,ne),he=this.module.getAOPtr(A),Se=this.module.getAOLength(A),Ae=new Float32Array(this.module.heapF32.buffer,he,Se),re=this.module.getIndicesPtr(A),ye=this.module.getIndicesLength(A),Oe=new Int32Array(this.module.heap32.buffer,re,ye),Le=this.module.getBuildingPart(A),nt=this.readStringBuffer(Le);g[A]={positions:L,normals:q,colors:ae,ao:Ae,indices:Oe,buildingPart:nt}}const b=this.module.getRingCount(),x=[];for(let A=0;A<b;A++){const R=this.module.getRingPtr(A),O=this.module.getRingLength(A),L=new Float32Array(this.module.heapF32.buffer,R,O);x.push(L)}return{meshes:g,modifiedPolygonRings:x}}}let Ug,gb,Vl,Kf,S1,By=null,Fy=null,UC=null,_b=null;function jC(){return Ai(self)&&self.worker.dracoUrl?self.worker.dracoUrl:gb||Ws.DRACO_URL}function HC(){if(Ai(self)&&self.worker.meshoptUrl)return self.worker.meshoptUrl;if(Kf)return Kf;const u=new Uint8Array([0,97,115,109,1,0,0,0,1,4,1,96,0,0,3,3,2,0,0,5,3,1,0,1,12,1,0,10,22,2,12,0,65,0,65,0,65,0,252,10,0,0,11,7,0,65,0,253,15,26,11]);if(typeof WebAssembly!="object")throw new Error("WebAssembly not supported, cannot instantiate meshoptimizer");return Kf=WebAssembly.validate(u)?Ws.MESHOPT_SIMD_URL:Ws.MESHOPT_URL,Kf}const A1={5120:Int8Array,5121:Uint8Array,5122:Int16Array,5123:Uint16Array,5125:Uint32Array,5126:Float32Array},DM={5120:"DT_INT8",5121:"DT_UINT8",5122:"DT_INT16",5123:"DT_UINT16",5125:"DT_UINT32",5126:"DT_FLOAT32"},yb={SCALAR:1,VEC2:2,VEC3:3,VEC4:4,MAT2:4,MAT3:9,MAT4:16};function eE(u,i,l){const p=l.json.bufferViews.length,g=l.buffers.length;i.bufferView=p,l.json.bufferViews[p]={buffer:g,byteLength:u.byteLength},l.buffers[g]=u}const tE="KHR_draco_mesh_compression";function RM(u,i){const l=u.extensions&&u.extensions[tE];if(!l)return;const p=new Vl.Decoder,g=YC(i,l.bufferView),b=new Vl.Mesh;if(!p.DecodeArrayToMesh(g,g.byteLength,b))throw new Error("Failed to decode Draco mesh");const x=i.json.accessors[u.indices],A=A1[x.componentType],R=x.count*A.BYTES_PER_ELEMENT,O=Vl._malloc(R);A===Uint16Array?p.GetTrianglesUInt16Array(b,R,O):p.GetTrianglesUInt32Array(b,R,O),eE(Vl.memory.buffer.slice(O,O+R),x,i),Vl._free(O);for(const L of Object.keys(l.attributes)){const B=p.GetAttributeByUniqueId(b,l.attributes[L]),U=i.json.accessors[u.attributes[L]],q=DM[U.componentType],Y=U.count*yb[U.type]*A1[U.componentType].BYTES_PER_ELEMENT,ne=Vl._malloc(Y);p.GetAttributeDataArrayForAllPoints(b,B,Vl[q],Y,ne),eE(Vl.memory.buffer.slice(ne,ne+Y),U,i),Vl._free(ne)}p.destroy(),b.destroy(),delete u.extensions[tE]}const C1="EXT_meshopt_compression";function OM(u,i){if(!u.extensions||!u.extensions[C1])return;const l=u.extensions[C1],p=new Uint8Array(i.buffers[l.buffer],l.byteOffset||0,l.byteLength||0),g=new Uint8Array(l.count*l.byteStride);S1.decodeGltfBuffer(g,l.count,l.byteStride,p,l.mode,l.filter),u.buffer=i.buffers.length,u.byteOffset=0,i.buffers[u.buffer]=g.buffer,delete u.extensions[C1]}const $C=1179937895,GC=new TextDecoder("utf8");function qC(u,i){return new URL(u,i).href}function WC(u,i,l,p){return fetch(qC(u.uri,p)).then(g=>g.arrayBuffer()).then(g=>{i.buffers[l]=g})}function YC(u,i){const l=u.json.bufferViews[i];return new Uint8Array(u.buffers[l.buffer],l.byteOffset||0,l.byteLength)}function IM(u,i,l,p){if(u.uri){const g=qC(u.uri,p);return fetch(g).then(b=>b.blob()).then(b=>createImageBitmap(b)).then(b=>{i.images[l]=b})}if(u.bufferView!==void 0){const g=YC(i,u.bufferView),b=new Blob([g],{type:u.mimeType});return createImageBitmap(b).then(x=>{i.images[l]=x})}}function ZC(u,i=0,l){const p={json:null,images:[],buffers:[]};if(new Uint32Array(u,i,1)[0]===$C){const L=new Uint32Array(u,i);let B=2;const U=(L[B++]>>2)-3,q=L[B++]>>2;if(B++,p.json=JSON.parse(GC.decode(L.subarray(B,B+q))),B+=q,B<U){const Y=L[B++];B++;const ne=i+(B<<2);p.buffers[0]=u.slice(ne,ne+Y)}}else p.json=JSON.parse(GC.decode(new Uint8Array(u,i)));const{buffers:g,images:b,meshes:x,extensionsUsed:A,bufferViews:R}=p.json;let O=Promise.resolve();if(g){const L=[];for(let B=0;B<g.length;B++){const U=g[B];U.uri?L.push(WC(U,p,B,l)):p.buffers[B]||(p.buffers[B]=null)}O=Promise.all(L)}return O.then(()=>{const L=[],B=A&&A.includes(tE),U=A&&A.includes(C1);if(B&&L.push(function(){if(!Vl)return Ug??(Ug=function(q){let Y,ne=null;function ae(){Y=new Uint8Array(ne.buffer)}function he(){throw new Error("Unexpected Draco error.")}const Se={a:{a:he,d:function(Ae,re,ye){return Y.copyWithin(Ae,re,re+ye)},c:function(Ae){const re=Y.length,ye=Math.max(Ae>>>0,Math.ceil(1.2*re)),Oe=Math.ceil((ye-re)/65536);try{return ne.grow(Oe),ae(),!0}catch{return!1}},b:he}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(q,Se):q.then(Ae=>Ae.arrayBuffer()).then(Ae=>WebAssembly.instantiate(Ae,Se))).then(Ae=>{const{Rb:re,Qb:ye,P:Oe,T:Le,X:nt,Ja:Qe,La:st,Qa:dt,Va:a,Wa:h,eb:v,jb:S,f:I,e:k,yb:K,zb:ee,Ab:me,Bb:De,Db:it,Gb:yt}=Ae.instance.exports;ne=k;const ct=(()=>{let ut=0,Ct=0,mn=0,tn=0;return Qt=>{mn&&(re(tn),re(ut),Ct+=mn,mn=ut=0),ut||(Ct+=128,ut=ye(Ct));const Je=Qt.length+7&-8;let rt=ut;Je>=Ct&&(mn=Je,rt=tn=ye(Je));for(let lt=0;lt<Qt.length;lt++)Y[rt+lt]=Qt[lt];return rt}})();return ae(),I(),{memory:k,_free:re,_malloc:ye,Mesh:class{constructor(){this.ptr=Oe()}destroy(){Le(this.ptr)}},Decoder:class{constructor(){this.ptr=Qe()}destroy(){S(this.ptr)}DecodeArrayToMesh(ut,Ct,mn){const tn=ct(ut),Qt=st(this.ptr,tn,Ct,mn.ptr);return!!nt(Qt)}GetAttributeByUniqueId(ut,Ct){return{ptr:dt(this.ptr,ut.ptr,Ct)}}GetTrianglesUInt16Array(ut,Ct,mn){a(this.ptr,ut.ptr,Ct,mn)}GetTrianglesUInt32Array(ut,Ct,mn){h(this.ptr,ut.ptr,Ct,mn)}GetAttributeDataArrayForAllPoints(ut,Ct,mn,tn,Qt){v(this.ptr,ut.ptr,Ct.ptr,mn,tn,Qt)}},DT_INT8:K(),DT_UINT8:ee(),DT_INT16:me(),DT_UINT16:De(),DT_UINT32:it(),DT_FLOAT32:yt()}})}(fetch(jC())),Ug.then(q=>{Vl=q,Ug=void 0}))}()),U&&L.push(function(){if(S1)return;const q=function(Y){let ne;const ae=WebAssembly.instantiateStreaming(Y,{}).then(Ae=>{ne=Ae.instance,ne.exports.__wasm_call_ctors()}),he={NONE:"",OCTAHEDRAL:"meshopt_decodeFilterOct",QUATERNION:"meshopt_decodeFilterQuat",EXPONENTIAL:"meshopt_decodeFilterExp"},Se={ATTRIBUTES:"meshopt_decodeVertexBuffer",TRIANGLES:"meshopt_decodeIndexBuffer",INDICES:"meshopt_decodeIndexSequence"};return{ready:ae,supported:!0,decodeGltfBuffer(Ae,re,ye,Oe,Le,nt){(function(Qe,st,dt,a,h,v,S){const I=Qe.exports.sbrk,k=a+3&-4,K=I(k*h),ee=I(v.length),me=new Uint8Array(Qe.exports.memory.buffer);me.set(v,ee);const De=st(K,a,h,ee,v.length);if(De===0&&S&&S(K,k,h),dt.set(me.subarray(K,K+a*h)),I(K-I(0)),De!==0)throw new Error(`Malformed buffer data: ${De}`)})(ne,ne.exports[Se[Le]],Ae,re,ye,Oe,ne.exports[he[nt]])}}}(fetch(HC()));return q.ready.then(()=>{S1=q})}()),b)for(let q=0;q<b.length;q++)L.push(IM(b[q],p,q,l));return(L.length?Promise.all(L):Promise.resolve()).then(()=>{if(B&&x)for(const{primitives:q}of x)for(const Y of q)RM(Y,p);if(U&&x&&R)for(const q of R)OM(q,p);return p})})}class XC{constructor(i){this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.hasPattern=!1,this.worldview=i.worldview}updateFootprints(i,l){}prepare(){return function(){if(_b!=null||UC!=null)return null;if(Fy!=null)return Fy;const i=fetch(Ws.BUILDING_GEN_URL);return Fy=function(l){let p,g,b,x;function A(){p=new Uint8Array(x.buffer),g=new Int32Array(x.buffer),b=new Float32Array(x.buffer)}function R(){throw new Error("Unexpected BuildingGen error.")}const O=()=>{},L={a:{a:R,f:function(B){const U=p.length,q=Math.max(B>>>0,Math.ceil(1.2*U)),Y=Math.ceil((q-U)/65536);try{return x.grow(Y),A(),!0}catch{return!1}},g:R,b:O,c:O,d:O,e:O}};return(WebAssembly.instantiateStreaming?WebAssembly.instantiateStreaming(l,L):l.then(B=>B.arrayBuffer()).then(B=>WebAssembly.instantiate(B,L))).then(B=>{const U=B.instance.exports;return(0,U.g)(),x=U.f,A(),new CM({setStyle:U.h,setAOOptions:U.i,setMetricOptions:U.j,setFacadeOptions:U.k,addFeature:U.l,addFacade:U.m,generateMesh:U.n,getLastError:U.o,getMeshCount:U.p,getPositionsPtr:U.q,getPositionsLength:U.r,getNormalsPtr:U.s,getNormalsLength:U.t,getColorsPtr:U.u,getColorsLength:U.v,getAOPtr:U.w,getAOLength:U.x,getIndicesPtr:U.y,getIndicesLength:U.z,getBuildingPart:U.A,getRingCount:U.B,getRingPtr:U.C,getRingLength:U.D,free:U.E,malloc:U.F,heapU8:p,heap32:g,heapF32:b})})}(i).then(l=>(Fy=null,_b=l,_b)).catch(l=>{ii("Could not load building-gen"),Fy=null,UC=l}),Fy}()}populate(i,l,p,g){}update(i,l,p,g,b,x,A){}isEmpty(){return!1}uploadPending(){return!1}upload(i){}destroy(){}getHeightAtTileCoord(i,l){return{height:Number.NEGATIVE_INFINITY,hidden:!0}}}let QC,KC;vn(XC,"BuildingBucket",{omit:["layers"]});const MM=Oi([{name:"a_pos_normal",components:2,type:"Int16"},{name:"a_data",components:4,type:"Uint8"},{name:"a_linesofar",components:1,type:"Float32"}],4),PM=Oi([{name:"a_z_offset_width",components:3,type:"Float32"}],4),{members:kM}=MM,JC=Oi([{name:"a_packed",components:3,type:"Float32"}]),{members:nE}=JC,vb=Oi([{name:"a_pattern_data",components:3,type:"Float32"}]),{members:NM}=vb;class iE{constructor(i,l){this.width=i,this.height=l,this.nextRow=0,this.image=new Ed({width:i,height:l}),this.positions={},this.uploaded=!1}getDash(i,l){const p=this.getKey(i,l);return this.positions[p]}trim(){const i=this.width,l=this.height=Kt(this.nextRow);this.image.resize({width:i,height:l})}getKey(i,l){return i.join(",")+l}getDashRanges(i,l,p){const g=[];let b=i.length%2==1?-i[i.length-1]*p:0,x=i[0]*p,A=!0;g.push({left:b,right:x,isDash:A,zeroLength:i[0]===0});let R=i[0];for(let O=1;O<i.length;O++){A=!A;const L=i[O];b=R*p,R+=L,x=R*p,g.push({left:b,right:x,isDash:A,zeroLength:L===0})}return g}addRoundDash(i,l,p){const g=l/2;for(let b=-p;b<=p;b++){const x=this.width*(this.nextRow+p+b);let A=0,R=i[A];for(let O=0;O<this.width;O++){O/R.right>1&&(R=i[++A]);const L=Math.abs(O-R.left),B=Math.abs(O-R.right),U=Math.min(L,B);let q;const Y=b/p*(g+1);if(R.isDash){const ne=g-Math.abs(Y);q=Math.sqrt(U*U+ne*ne)}else q=g-Math.sqrt(U*U+Y*Y);this.image.data[x+O]=Math.max(0,Math.min(255,q+128))}}}addRegularDash(i,l){for(let R=i.length-1;R>=0;--R){const O=i[R],L=i[R+1];O.zeroLength?i.splice(R,1):L&&L.isDash===O.isDash&&(L.left=O.left,i.splice(R,1))}const p=i[0],g=i[i.length-1];p.isDash===g.isDash&&(p.left=g.left-this.width,g.right=p.right+this.width);const b=this.width*this.nextRow;let x=0,A=i[x];for(let R=0;R<this.width;R++){R/A.right>1&&(A=i[++x]);const O=Math.abs(R-A.left),L=Math.abs(R-A.right),B=Math.min(O,L);this.image.data[b+R]=Math.max(0,Math.min(255,(A.isDash?B:-B)+l+128))}}addDash(i,l){const p=this.getKey(i,l);if(this.positions[p])return this.positions[p];const g=l==="round",b=g?7:0,x=2*b+1;if(this.nextRow+x>this.height)return ii("LineAtlas out of space"),null;i.length===0&&i.push(1);let A=0;for(let L=0;L<i.length;L++)i[L]<0&&(ii("Negative value is found in line dasharray, replacing values with 0"),i[L]=0),A+=i[L];if(A!==0){const L=this.width/A,B=this.getDashRanges(i,this.width,L);g?this.addRoundDash(B,L,b):this.addRegularDash(B,l==="square"?.5*L:0)}const R=this.nextRow+b;this.nextRow+=x;const O={tl:[R,b],br:[A,0]};return this.positions[p]=O,O}}vn(iE,"LineAtlas");const eD=li.VectorTileFeature.types,tD=Math.cos(Math.PI/180*37.5),nD=Math.cos(Math.PI/180*5);class im{constructor(i){this.evaluationGlobals={zoom:0,lineProgress:void 0},this.elevationType="none",this.zoom=i.zoom,this.evaluationGlobals.zoom=this.zoom,this.overscaling=i.overscaling,this.pixelRatio=i.pixelRatio,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.index=i.index,this.projection=i.projection,this.hasPattern=!1,this.hasCrossSlope=!1,this.patternFeatures=[],this.lineClipsArray=[],this.gradients={},this.layers.forEach(l=>{this.gradients[l.id]={}}),this.layoutVertexArray=new yy,this.layoutVertexArray2=new su,this.patternVertexArray=new su,this.indexArray=new mo,this.programConfigurations=new _(i.layers,{zoom:i.zoom,lut:i.lut}),this.segments=new Yr,this.maxLineLength=0,this.zOffsetVertexArray=new su,this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.tessellationStep=i.tessellationStep?i.tessellationStep:sn/64,this.worldview=i.worldview}updateFootprints(i,l){}populate(i,l,p,g){this.hasPattern=Ja("line",this.layers,this.pixelRatio,l);const b=this.layers[0].layout.get("line-sort-key");this.tileToMeter=Dt(p);const x=this.layers[0].layout.get("line-elevation-reference");if(x==="hd-road-markup")this.elevationType="road";else{const U=this.layers[0].layout.get("line-z-offset"),q=U.isConstant()&&!U.constantOr(0);this.elevationType=x!=="sea"&&x!=="ground"&&q?"none":"offset",this.elevationType==="offset"&&x==="none"&&ii(`line-elevation-reference: ground is used for the layer ${this.layerIds[0]} because non-zero line-z-offset value was found.`)}const A=this.layers[0].layout.get("line-cross-slope");this.hasCrossSlope=this.elevationType==="offset"&&A!==void 0;const R=[];for(const{feature:U,id:q,index:Y,sourceLayerIndex:ne}of i){const ae=this.layers[0]._featureFilter.needGeometry,he=pn(U,ae);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),he,p))continue;const Se=b?b.evaluate(he,{},p):void 0,Ae={id:q,properties:U.properties,type:U.type,sourceLayerIndex:ne,index:Y,geometry:ae?he.geometry:fn(U,p,g),patterns:{},sortKey:Se};R.push(Ae)}b&&R.sort((U,q)=>U.sortKey-q.sortKey);const{lineAtlas:O,featureIndex:L}=l,B=this.addConstantDashes(O);for(const U of R){const{geometry:q,index:Y,sourceLayerIndex:ne}=U;if(B&&this.addFeatureDashes(U,O),this.hasPattern){const ae=BT("line",this.layers,U,this.zoom,this.pixelRatio,l);this.patternFeatures.push(ae)}else this.addFeature(U,q,Y,p,O.positions,l.availableImages,l.brightness,l.elevationFeatures);L.insert(i[Y].feature,q,Y,ne,this.index)}}addConstantDashes(i){let l=!1;for(const p of this.layers){const g=p.paint.get("line-dasharray").value,b=p.layout.get("line-cap").value;if(g.kind!=="constant"||b.kind!=="constant")l=!0;else{const x=b.value,A=g.value;if(!A)continue;i.addDash(A,x)}}return l}addFeatureDashes(i,l){const p=this.zoom;for(const g of this.layers){const b=g.paint.get("line-dasharray").value,x=g.layout.get("line-cap").value;if(b.kind==="constant"&&x.kind==="constant")continue;let A,R;if(b.kind==="constant"){if(A=b.value,!A)continue}else A=b.evaluate({zoom:p},i);R=x.kind==="constant"?x.value:x.evaluate({zoom:p},i),l.addDash(A,R),i.patterns[g.id]=[l.getKey(A,R)]}}update(i,l,p,g,b,x,A,R){this.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,R)}addFeatures(i,l,p,g,b,x){for(const A of this.patternFeatures)this.addFeature(A,A.geometry,A.index,l,p,g,x)}isEmpty(){return this.layoutVertexArray.length===0}uploadPending(){return!this.uploaded||this.programConfigurations.needsUpload}upload(i){this.uploaded||(this.layoutVertexArray2.length!==0&&(this.layoutVertexBuffer2=i.createVertexBuffer(this.layoutVertexArray2,nE)),this.patternVertexArray.length!==0&&(this.patternVertexBuffer=i.createVertexBuffer(this.patternVertexArray,NM)),!this.zOffsetVertexBuffer&&this.zOffsetVertexArray.length>0&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,PM.members,!0)),this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,kM),this.indexBuffer=i.createIndexBuffer(this.indexArray)),this.programConfigurations.upload(i),this.uploaded=!0}destroy(){this.layoutVertexBuffer&&(this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy())}lineFeatureClips(i){if(i.properties&&i.properties.hasOwnProperty("mapbox_clip_start")&&i.properties.hasOwnProperty("mapbox_clip_end"))return{start:+i.properties.mapbox_clip_start,end:+i.properties.mapbox_clip_end}}addFeature(i,l,p,g,b,x,A,R){const O=this.layers[0].layout,L=O.get("line-join").evaluate(i,{}),B=O.get("line-cap").evaluate(i,{}),U=O.get("line-miter-limit"),q=O.get("line-round-limit");this.lineClips=this.lineFeatureClips(i),this.lineFeature=i,this.zOffsetValue=O.get("line-z-offset").value;const Y=this.layers[0].paint.get("line-width").value;if(Y.kind!=="constant"&&Y.isLineProgressConstant===!1&&(this.variableWidthValue=Y),this.elevationType==="road"){const ne=this.layoutVertexArray.length;if(!this.addElevatedRoadFeature(i,l,g,R,L,B,U,q)){const[ae,he]=this.clipRuntimeLinesToTile(l,1);for(let Se=0;Se<ae.length;Se++){const Ae=ae[Se],re=he[Se],ye={progress:{min:re.progress.min,max:re.progress.max},nextDir:this.computeSegNextDir(re,Ae),prevDir:this.computeSegPrevDir(re,Ae)};this.addLine(Ae,i,g,L,B,U,q,ye)}this.fillNonElevatedRoadSegment(ne)}}else for(const ne of l)this.addLine(ne,i,g,L,B,U,q);this.programConfigurations.populatePaintArrays(this.layoutVertexArray.length,i,p,b,x,g,A,void 0,this.worldview)}computeSegNextDir(i,l){return i.nextPoint.sub(l.at(-2)).unit()}computeSegPrevDir(i,l){return l[1].sub(i.prevPoint).unit()}clipLinesToTile(i,l){return T1(i,-l,-l,sn+l,sn+l)}clipRuntimeLinesToTile(i,l){const p=[];return[T1(i,-l,-l,sn+l,sn+l,p),p]}addElevatedRoadFeature(i,l,p,g,b,x,A,R){const O=[],L=gl.getElevationFeature(i,g);if(L){const B=this.clipLinesToTile(l,1),U=this.prepareElevatedLines(B,L,p);for(const q of U)O.push({geometry:q,elevation:L,elevationTileID:p,segment:{progress:{min:0,max:1},nextDir:void 0,prevDir:void 0}})}if(O.length===0)return!1;for(const B of O){const U=this.layoutVertexArray.length;this.addLine(B.geometry,i,p,b,x,A,R);const q=new fc(p,B.elevationTileID);if(B.elevation)for(let Y=U;Y<this.layoutVertexArray.length;Y++){const ne=new Lt(this.layoutVertexArray.int16[6*Y]>>1,this.layoutVertexArray.int16[6*Y+1]>>1),ae=q.pointElevation(ne,B.elevation,.05);this.updateHeightRange(ae),this.zOffsetVertexArray.emplaceBack(ae,0,0)}else this.fillNonElevatedRoadSegment(U)}return!0}prepareElevatedLines(i,l,p){if(l.constantHeight!=null)return i;const g=[],b=1/Dt(p);for(const x of i)AM(x,new js(l,b),0,g);return g}fillNonElevatedRoadSegment(i){for(let l=i;l<this.layoutVertexArray.length;l++)this.zOffsetVertexArray.emplaceBack(0,0,0)}updateHeightRange(i){this.heightRange?(this.heightRange.min=Math.min(this.heightRange.min,i),this.heightRange.max=Math.max(this.heightRange.max,i)):this.heightRange={min:i,max:i}}addLine(i,l,p,g,b,x,A,R){this.distance=0,this.prevDistance=0,this.scaledDistance=0,this.totalDistance=0,this.totalFeatureLength=0,this.lineSoFar=0,this.currentVertex=void 0;const O=g==="none";this.patternJoinNone=this.hasPattern&&O,this.segmentStart=0,this.segmentStartf32=0,this.segmentPoints=[];const L=R&&R.progress.min>0,B=R&&R.progress.max<1;if(this.lineClips){let nt={min:this.lineClips.start,max:this.lineClips.end},Qe=1;if(R){const a=this.lineClips.end-this.lineClips.start;nt=function(h,v,S){return{min:Ua(h.min,v,S),max:Ua(h.max,v,S)}}(R.progress,{min:0,max:1},nt),a>0&&(Qe=(nt.max-nt.min)/a)}const st=+l.properties.mapbox_clip_feature_len,dt=+l.properties.mapbox_clip_seg_len;if(Number.isNaN(st)||Number.isNaN(dt)){for(let h=0;h<i.length-1;h++)this.totalDistance+=i[h].dist(i[h+1]);const a=this.totalDistance/(nt.max-nt.min);this.totalFeatureLength=Number.isFinite(a)?a:0,this.lineClips.start=nt.min,this.lineClips.end=nt.max,this.maxLineLength=Math.max(this.maxLineLength,this.totalDistance)}else this.totalFeatureLength=st,this.distance=dt*Qe,this.lineClips.start=nt.min,this.lineClips.end=nt.max,this.maxLineLength=Math.max(this.maxLineLength,this.distance);this.lineClipsArray.push(this.lineClips),this.updateScaledDistance()}const U=eD[l.type]==="Polygon";let q=i.length;for(;q>=2&&i[q-1].equals(i[q-2]);)q--;let Y=0;for(;Y<q-1&&i[Y].equals(i[Y+1]);)Y++;if(q<(U?3:2))return;g==="bevel"&&(x=1.05);const ne=this.segments.prepareSegment(10*q,this.layoutVertexArray,this.indexArray);let ae,he,Se,Ae,re,ye,Oe,Le;R&&R.prevDir&&(ye=R.prevDir.perp()),R&&R.nextDir&&(Oe=R.nextDir.perp()),this.e1=this.e2=-1,U&&(ae=i[q-2],re=i[Y].sub(ae)._unit()._perp());for(let nt=Y;nt<q;nt++){if(Se=nt===q-1?U?i[Y+1]:void 0:i[nt+1],Se&&i[nt].equals(Se))continue;re&&(Ae=re),ae&&(he=ae),ae=i[nt],Le=this.evaluateLineProgressFeatures(he?he.dist(ae):0),re=Se?Se.sub(ae)._unit()._perp():Ae,Ae=Ae||re;const Qe=he&&Se;let st=Qe?g:U||O?"butt":b;const dt=Ae.x*re.x+Ae.y*re.y;if(O){const ee=function(me){if(me.patternJoinNone){const De=me.segmentPoints.length/2,it=me.lineSoFar-me.segmentStart;for(let yt=0;yt<De;++yt){const ct=me.segmentPoints[2*yt+1],ut=Math.round(me.segmentPoints[2*yt])+.5+.25*ct;me.patternVertexArray.emplaceBack(ut,it,me.segmentStart),me.patternVertexArray.emplaceBack(ut,it,me.segmentStart)}me.segmentPoints.length=0}me.e1=me.e2=-1};if(Qe&&dt<nD){this.updateDistance(he,ae),this.addCurrentVertex(ae,Ae,1,1,ne,Le),ee(this),this.addCurrentVertex(ae,re,-1,-1,ne,Le);continue}if(he){if(!Se){this.updateDistance(he,ae),this.addCurrentVertex(ae,Ae,1,1,ne,Le),ee(this);continue}st="miter"}}let a=Ae.add(re);a.x===0&&a.y===0||a._unit();const h=a.x*re.x+a.y*re.y,v=h!==0?1/h:1/0,S=2*Math.sqrt(2-2*h),I=h<tD&&he&&Se,k=Ae.x*re.y-Ae.y*re.x>0,K=this.overscaling<=16?15*sn/(512*this.overscaling):0;if(Qe&&st==="round"){if(v<A)st="miter";else if(v<=2){const ee=rE(ae,-10,sn+10);st=this.elevationType==="offset"&&(ee||this.hasCrossSlope)?"miter":"fakeround"}}if(st==="miter"&&v>x&&(st="bevel"),st==="bevel"&&(v>2&&(st="flipbevel"),v<x&&(st="miter")),he&&!(st==="miter"&&I)&&this.updateDistance(he,ae),st==="miter")if(I){const ee=ae.dist(he);if(ee>2*K){const De=ae.sub(ae.sub(he)._mult(K/ee)._round());this.updateDistance(he,De),this.addCurrentVertex(De,Ae,0,0,ne,Le),he=De}this.updateDistance(he,ae),a._mult(v),this.addCurrentVertex(ae,a,0,0,ne,Le);const me=ae.dist(Se);if(me>2*K){const De=ae.add(Se.sub(ae)._mult(K/me)._round());this.updateDistance(ae,De),this.addCurrentVertex(De,re,0,0,ne,Le),ae=De}}else a._mult(v),this.addCurrentVertex(ae,a,0,0,ne,Le);else if(st==="flipbevel"){if(v>100)a=re.mult(-1);else{const ee=v*Ae.add(re).mag()/Ae.sub(re).mag();a._perp()._mult(ee*(k?-1:1))}this.addCurrentVertex(ae,a,0,0,ne,Le),this.addCurrentVertex(ae,a.mult(-1),0,0,ne,Le)}else if(st==="bevel"||st==="fakeround"){Le!=null&&he&&this.addCurrentVertex(ae,Oe||Ae,-1,-1,ne,Le);const ee=ae.dist(he)<=2*K&&st!=="bevel",me=a.mult(k?1:-1);me._mult(v);const De=re.mult(k?-1:1),it=Ae.mult(k?-1:1),yt=this.evaluateLineProgressFeatures(this.distance);if(Le==null&&(this.addHalfVertex(ae,me.x,me.y,!1,!k,0,ne,yt),ee||this.addHalfVertex(ae,me.x+2*it.x,me.y+2*it.y,!1,k,0,ne,yt)),st==="fakeround"){const ct=Math.round(180*S/Math.PI/20);this.addHalfVertex(ae,it.x,it.y,!1,k,0,ne,yt);for(let ut=0;ut<ct;ut++){let Ct=ut/ct;if(Ct!==.5){const tn=Ct-.5;Ct+=Ct*tn*(Ct-1)*((1.0904+dt*(dt*(3.55645-1.43519*dt)-3.2452))*tn*tn+(.848013+dt*(.215638*dt-1.06021)))}const mn=De.sub(it)._mult(Ct)._add(it)._unit();this.addHalfVertex(ae,mn.x,mn.y,!1,k,0,ne,yt)}this.addHalfVertex(ae,De.x,De.y,!1,k,0,ne,yt)}ee||Le!=null||this.addHalfVertex(ae,me.x+2*De.x,me.y+2*De.y,!1,k,0,ne,yt),Le!=null&&Se&&this.addCurrentVertex(ae,ye||re,1,1,ne,Le)}else if(st==="butt")this.addCurrentVertex(ae,a,0,0,ne,Le);else if(st==="square"){if(!he){const ee=L?0:-1;this.addCurrentVertex(ae,a,ee,ee,ne,Le)}if(this.addCurrentVertex(ae,a,0,0,ne,Le),he){const ee=B?0:1;this.addCurrentVertex(ae,a,ee,ee,ne,Le)}}else if(st==="round"){if(he){const ee=!Qe&&Oe?Oe:Ae;this.addCurrentVertex(ae,ee,0,0,ne,Le),!Qe&&B||this.addCurrentVertex(ae,ee,1,1,ne,Le,!0)}if(Se){const ee=!Qe&&ye?ye:re;!Qe&&L||this.addCurrentVertex(ae,ee,-1,-1,ne,Le,!0),this.addCurrentVertex(ae,ee,0,0,ne,Le)}}}}addVerticesTo(i,l,p,g,b,x,A,R,O,L){const B=(l.w-i.w)/this.tessellationStep|0;let U=0;const q=this.scaledDistance;if(B>1){this.lineSoFar=i.w;const ne=(l.x-i.x)/B,ae=(l.y-i.y)/B,he=(l.z-i.z)/B,Se=(l.w-i.w)/B;for(let Ae=1;Ae<B;++Ae){i.x+=ne,i.y+=ae,i.z+=he,this.lineSoFar+=Se,U+=Se;const re=this.evaluateLineProgressFeatures(this.prevDistance+U);this.scaledDistance=(this.prevDistance+U)/this.totalDistance,this.addHalfVertex(i,p,g,L,!1,A,O,re),this.addHalfVertex(i,b,x,L,!0,-R,O,re)}}this.lineSoFar=l.w,this.scaledDistance=q;const Y=this.evaluateLineProgressFeatures(this.distance);this.addHalfVertex(l,p,g,L,!1,A,O,Y),this.addHalfVertex(l,b,x,L,!0,-R,O,Y)}evaluateLineProgressFeatures(i){if(!this.variableWidthValue&&this.elevationType!=="offset")return null;this.evaluationGlobals.lineProgress=0,this.lineClips?this.evaluationGlobals.lineProgress=Math.min(1,(this.totalFeatureLength*this.lineClips.start+i)/this.totalFeatureLength):ii(`line-progress evaluation for ${this.layerIds[0]} requires enabling 'lineMetrics' for the source.`);let l=0;return this.variableWidthValue&&this.variableWidthValue.kind!=="constant"&&(l=this.variableWidthValue.evaluate(this.evaluationGlobals,this.lineFeature)||0),this.elevationType!=="offset"?{zOffset:0,variableWidth:l}:this.zOffsetValue.kind==="constant"?{zOffset:this.zOffsetValue.value,variableWidth:l}:{zOffset:this.zOffsetValue.evaluate(this.evaluationGlobals,this.lineFeature)||0,variableWidth:l}}addCurrentVertex(i,l,p,g,b,x,A=!1){const R=l.x+l.y*p,O=l.y-l.x*p,L=l.y*g-l.x,B=-l.y-l.x*g;if(x!=null){const U=this.elevationType==="offset",q=-10,Y=sn+10,ne=x.zOffset,ae=new yl(i.x,i.y,ne,this.lineSoFar),he=!!U&&rE(i,q,Y),Se=this.lineSoFar,Ae=this.distance;if(this.currentVertex)if(he){const re=this.currentVertexIsOutside,ye=this.currentVertex,Oe=new yl(i.x,i.y,ne,this.lineSoFar);if(FC(ye,Oe,q,Y),!rE(Oe,q,Y)){if(re){this.e1=this.e2=-1,this.distance-=ye.dist(ae),this.lineSoFar=ye.w;const Le=this.evaluateLineProgressFeatures(ye.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(ye,R,O,A,!1,p,b,Le),this.addHalfVertex(ye,L,B,A,!0,-g,b,Le),this.prevDistance=this.distance}this.distance=this.prevDistance+ye.dist(Oe),this.scaledDistance=this.distance/this.totalDistance,this.addVerticesTo(ye,Oe,R,O,L,B,p,g,b,A),this.distance=Ae,this.scaledDistance=this.distance/this.totalDistance}}else{const re=this.currentVertex;if(this.currentVertexIsOutside){FC(re,ae,q,Y),this.e1=this.e2=-1,this.distance-=re.dist(ae),this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=re.w;const ye=this.evaluateLineProgressFeatures(re.w-this.totalFeatureLength*(this.lineClips?this.lineClips.start:0));this.addHalfVertex(re,R,O,A,!1,p,b,ye),this.addHalfVertex(re,L,B,A,!0,-g,b,ye),this.prevDistance=this.distance,this.distance=Ae,this.scaledDistance=this.distance/this.totalDistance}this.addVerticesTo(re,ae,R,O,L,B,p,g,b,A)}else he||(this.addHalfVertex(i,R,O,A,!1,p,b,x),this.addHalfVertex(i,L,B,A,!0,-g,b,x));this.currentVertex=ae,this.currentVertexIsOutside=he,this.lineSoFar=Se}else this.addHalfVertex(i,R,O,A,!1,p,b,x),this.addHalfVertex(i,L,B,A,!0,-g,b,x)}addHalfVertex({x:i,y:l},p,g,b,x,A,R,O){if(this.patternJoinNone&&(this.segmentPoints.length===0&&(this.segmentStart=this.lineSoFar,this.segmentStartf32=Math.fround(this.lineSoFar)),x||this.segmentPoints.push(this.lineSoFar-this.segmentStart,A)),this.layoutVertexArray.emplaceBack((i<<1)+(b?1:0),(l<<1)+(x?1:0),Math.round(63*p)+128,Math.round(63*g)+128,1+(A===0?0:A<0?-1:1),0,this.lineSoFar-this.segmentStartf32),this.lineClips){const B=$n(this.lineClips.start,this.lineClips.end,this.scaledDistance);this.layoutVertexArray2.emplaceBack(this.scaledDistance,this.lineClipsArray.length,B)}const L=R.vertexLength++;this.e1>=0&&this.e2>=0&&(this.indexArray.emplaceBack(this.e1,this.e2,L),R.primitiveLength++),x?this.e2=L:this.e1=L,O!=null&&this.zOffsetVertexArray.emplaceBack(O.zOffset,O.variableWidth,O.variableWidth)}updateScaledDistance(){this.lineClips?(this.scaledDistance=this.distance/this.totalDistance,this.lineSoFar=this.totalFeatureLength*this.lineClips.start+this.distance):this.lineSoFar=this.distance}updateDistance(i,l){this.prevDistance=this.distance,this.distance+=i.dist(l),this.updateScaledDistance()}}function rE(u,i,l){return u.x<i||u.x>l||u.y<i||u.y>l}let Vy,Uy;function sE(u,i,l){return i*(sn/(u.tileSize*Math.pow(2,l-u.tileID.overscaledZ)))}vn(im,"LineBucket",{omit:["layers","patternFeatures","currentVertex","currentVertexIsOutside"]});const vl=(u,i,l)=>(1-l)*u+l*i;function iD(u,i){return 1/sE(u,1,i.tileZoom)}function jg(u,i,l,p){return u.translatePosMatrix(p||i.tileID.projMatrix,i,l.paint.get("line-translate"),l.paint.get("line-translate-anchor"))}const D1=u=>{const i=[];jy(u)&&i.push("RENDER_LINE_DASH"),u.paint.get("line-gradient")&&i.push("RENDER_LINE_GRADIENT");const l=u.paint.get("line-trim-offset");l[0]===0&&l[1]===0||i.push("RENDER_LINE_TRIM_OFFSET"),u.paint.get("line-border-width").constantOr(1)!==0&&i.push("RENDER_LINE_BORDER");const p=u.layout.get("line-join").constantOr("miter")==="none",g=!!u.paint.get("line-pattern").constantOr(1);return p&&g&&i.push("LINE_JOIN_NONE"),i};function jy(u){const i=u.paint.get("line-dasharray").value;return i.value||i.kind!=="constant"}let bb;const Hg=()=>bb||(bb={layout:Vy||(Vy=new Lr({"line-cap":new cn(pt.layout_line["line-cap"]),"line-join":new cn(pt.layout_line["line-join"]),"line-miter-limit":new Gt(pt.layout_line["line-miter-limit"]),"line-round-limit":new Gt(pt.layout_line["line-round-limit"]),"line-sort-key":new cn(pt.layout_line["line-sort-key"]),"line-z-offset":new cn(pt.layout_line["line-z-offset"]),"line-elevation-reference":new Gt(pt.layout_line["line-elevation-reference"]),"line-cross-slope":new Gt(pt.layout_line["line-cross-slope"]),visibility:new Gt(pt.layout_line.visibility),"line-width-unit":new Gt(pt.layout_line["line-width-unit"])})),paint:Uy||(Uy=new Lr({"line-opacity":new cn(pt.paint_line["line-opacity"]),"line-color":new cn(pt.paint_line["line-color"]),"line-translate":new Gt(pt.paint_line["line-translate"]),"line-translate-anchor":new Gt(pt.paint_line["line-translate-anchor"]),"line-width":new cn(pt.paint_line["line-width"]),"line-gap-width":new cn(pt.paint_line["line-gap-width"]),"line-offset":new cn(pt.paint_line["line-offset"]),"line-blur":new cn(pt.paint_line["line-blur"]),"line-dasharray":new cn(pt.paint_line["line-dasharray"]),"line-pattern":new cn(pt.paint_line["line-pattern"]),"line-pattern-cross-fade":new Gt(pt.paint_line["line-pattern-cross-fade"]),"line-gradient":new hd(pt.paint_line["line-gradient"]),"line-trim-offset":new Gt(pt.paint_line["line-trim-offset"]),"line-trim-fade-range":new Gt(pt.paint_line["line-trim-fade-range"]),"line-trim-color":new Gt(pt.paint_line["line-trim-color"]),"line-emissive-strength":new Gt(pt.paint_line["line-emissive-strength"]),"line-border-width":new cn(pt.paint_line["line-border-width"]),"line-border-color":new cn(pt.paint_line["line-border-color"]),"line-occlusion-opacity":new Gt(pt.paint_line["line-occlusion-opacity"]),"line-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-trim-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"line-border-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},bb);class oE extends cn{possiblyEvaluate(i,l){return l=new $i(Math.floor(l.zoom),{now:l.now,fadeDuration:l.fadeDuration,transition:l.transition,worldview:l.worldview}),super.possiblyEvaluate(i,l)}evaluate(i,l,p,g){return l=vt({},l,{zoom:Math.floor(l.zoom)}),super.evaluate(i,l,p,g)}}let Hy;function aE(u,i){return i>0?i+2*u:u}const rD=Oi([{name:"a_pos_offset",components:4,type:"Int16"},{name:"a_tex_size",components:4,type:"Uint16"},{name:"a_pixeloffset",components:4,type:"Int16"}],4),sD=Oi([{name:"a_globe_anchor",components:3,type:"Int16"},{name:"a_globe_normal",components:3,type:"Float32"}],4),LM=Oi([{name:"a_projected_pos",components:4,type:"Float32"}],4);Oi([{name:"a_fade_opacity",components:1,type:"Uint32"}],4);const zM=Oi([{name:"a_auto_z_offset",components:1,type:"Float32"}],4),BM=Oi([{name:"a_x_axis",components:3,type:"Float32"},{name:"a_y_axis",components:3,type:"Float32"}]),oD=Oi([{name:"a_texb",components:2,type:"Uint16"}]),aD=Oi([{name:"a_placed",components:2,type:"Uint8"},{name:"a_shift",components:2,type:"Float32"},{name:"a_elevation_from_sea",components:2,type:"Float32"}]),lE=Oi([{name:"a_size_scale",components:1,type:"Float32"},{name:"a_padding",components:2,type:"Float32"},{name:"a_auto_z_offset",components:1,type:"Float32"}]);Oi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"tileAnchorX"},{type:"Int16",name:"tileAnchorY"},{type:"Float32",name:"x1"},{type:"Float32",name:"y1"},{type:"Float32",name:"x2"},{type:"Float32",name:"y2"},{type:"Int16",name:"padding"},{type:"Uint32",name:"featureIndex"},{type:"Uint16",name:"sourceLayerIndex"},{type:"Uint16",name:"bucketIndex"}]);const R1=Oi([{name:"a_pos",components:3,type:"Int16"},{name:"a_anchor_pos",components:2,type:"Int16"},{name:"a_extrude",components:2,type:"Int16"}],4),O1=Oi([{name:"a_pos_2f",components:2,type:"Float32"},{name:"a_radius",components:1,type:"Float32"},{name:"a_flags",components:2,type:"Int16"}],4);Oi([{name:"triangle",components:3,type:"Uint16"}]),Oi([{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Uint16",name:"glyphStartIndex"},{type:"Uint16",name:"numGlyphs"},{type:"Uint32",name:"vertexStartIndex"},{type:"Uint32",name:"lineStartIndex"},{type:"Uint32",name:"lineLength"},{type:"Uint16",name:"segment"},{type:"Uint16",name:"lowerSize"},{type:"Uint16",name:"upperSize"},{type:"Float32",name:"lineOffsetX"},{type:"Float32",name:"lineOffsetY"},{type:"Uint8",name:"writingMode"},{type:"Uint8",name:"placedOrientation"},{type:"Uint8",name:"hidden"},{type:"Uint32",name:"crossTileID"},{type:"Int16",name:"associatedIconIndex"},{type:"Uint8",name:"flipState"}]),Oi([{type:"Float32",name:"tileAnchorX"},{type:"Float32",name:"tileAnchorY"},{type:"Int16",name:"projectedAnchorX"},{type:"Int16",name:"projectedAnchorY"},{type:"Int16",name:"projectedAnchorZ"},{type:"Int16",name:"rightJustifiedTextSymbolIndex"},{type:"Int16",name:"centerJustifiedTextSymbolIndex"},{type:"Int16",name:"leftJustifiedTextSymbolIndex"},{type:"Int16",name:"verticalPlacedTextSymbolIndex"},{type:"Int16",name:"placedIconSymbolIndex"},{type:"Int16",name:"verticalPlacedIconSymbolIndex"},{type:"Uint16",name:"key"},{type:"Uint16",name:"textBoxStartIndex"},{type:"Uint16",name:"textBoxEndIndex"},{type:"Uint16",name:"verticalTextBoxStartIndex"},{type:"Uint16",name:"verticalTextBoxEndIndex"},{type:"Uint16",name:"iconBoxStartIndex"},{type:"Uint16",name:"iconBoxEndIndex"},{type:"Uint16",name:"verticalIconBoxStartIndex"},{type:"Uint16",name:"verticalIconBoxEndIndex"},{type:"Uint16",name:"featureIndex"},{type:"Uint16",name:"numHorizontalGlyphVertices"},{type:"Uint16",name:"numVerticalGlyphVertices"},{type:"Uint16",name:"numIconVertices"},{type:"Uint16",name:"numVerticalIconVertices"},{type:"Uint16",name:"useRuntimeCollisionCircles"},{type:"Uint32",name:"crossTileID"},{type:"Float32",components:2,name:"textOffset"},{type:"Float32",name:"collisionCircleDiameter"},{type:"Float32",name:"zOffset"},{type:"Uint8",name:"hasIconTextFit"},{type:"Uint16",name:"elevationFeatureIndex"}]),Oi([{type:"Float32",name:"offsetX"}]),Oi([{type:"Int16",name:"x"},{type:"Int16",name:"y"}]);var xs=24;function Lu(u,i,l){return u.sections.forEach(p=>{p.text=function(g,b,x){const A=b.layout.get("text-transform").evaluate(x,{});return A==="uppercase"?g=g.toLocaleUpperCase():A==="lowercase"&&(g=g.toLocaleLowerCase()),nu.applyArabicShaping&&(g=nu.applyArabicShaping(g)),g}(p.text,i,l)}),u}const kd={"!":"︕","#":"＃",$:"＄","%":"％","&":"＆","(":"︵",")":"︶","*":"＊","+":"＋",",":"︐","-":"︲",".":"・","/":"／",":":"︓",";":"︔","<":"︿","=":"＝",">":"﹀","?":"︖","@":"＠","[":"﹇","\\":"＼","]":"﹈","^":"＾",_:"︳","`":"｀","{":"︷","|":"―","}":"︸","~":"～","¢":"￠","£":"￡","¥":"￥","¦":"￤","¬":"￢","¯":"￣","–":"︲","—":"︱","‘":"﹃","’":"﹄","“":"﹁","”":"﹂","…":"︙","‧":"・","₩":"￦","、":"︑","。":"︒","〈":"︿","〉":"﹀","《":"︽","》":"︾","「":"﹁","」":"﹂","『":"﹃","』":"﹄","【":"︻","】":"︼","〔":"︹","〕":"︺","〖":"︗","〗":"︘","！":"︕","（":"︵","）":"︶","，":"︐","－":"︲","．":"・","：":"︓","；":"︔","＜":"︿","＞":"﹀","？":"︖","［":"﹇","］":"﹈","＿":"︳","｛":"︷","｜":"―","｝":"︸","｟":"︵","｠":"︶","｡":"︒","｢":"﹁","｣":"﹂","←":"↑","→":"↓"};function cE(u){return u==="︶"||u==="﹈"||u==="︸"||u==="﹄"||u==="﹂"||u==="︾"||u==="︼"||u==="︺"||u==="︘"||u==="﹀"||u==="︐"||u==="︓"||u==="︔"||u==="｀"||u==="￣"||u==="︑"||u==="︒"}function rm(u){return u==="︵"||u==="﹇"||u==="︷"||u==="﹃"||u==="﹁"||u==="︽"||u==="︻"||u==="︹"||u==="︗"||u==="︿"}var du,sm,Hs,uE={};/*! ieee754. BSD-3-Clause License. Feross Aboukhadijeh <https://feross.org/opensource> */function el(){return du||(du=1,uE.read=function(u,i,l,p,g){var b,x,A=8*g-p-1,R=(1<<A)-1,O=R>>1,L=-7,B=l?g-1:0,U=l?-1:1,q=u[i+B];for(B+=U,b=q&(1<<-L)-1,q>>=-L,L+=A;L>0;b=256*b+u[i+B],B+=U,L-=8);for(x=b&(1<<-L)-1,b>>=-L,L+=p;L>0;x=256*x+u[i+B],B+=U,L-=8);if(b===0)b=1-O;else{if(b===R)return x?NaN:1/0*(q?-1:1);x+=Math.pow(2,p),b-=O}return(q?-1:1)*x*Math.pow(2,b-p)},uE.write=function(u,i,l,p,g,b){var x,A,R,O=8*b-g-1,L=(1<<O)-1,B=L>>1,U=g===23?Math.pow(2,-24)-Math.pow(2,-77):0,q=p?0:b-1,Y=p?1:-1,ne=i<0||i===0&&1/i<0?1:0;for(i=Math.abs(i),isNaN(i)||i===1/0?(A=isNaN(i)?1:0,x=L):(x=Math.floor(Math.log(i)/Math.LN2),i*(R=Math.pow(2,-x))<1&&(x--,R*=2),(i+=x+B>=1?U/R:U*Math.pow(2,1-B))*R>=2&&(x++,R/=2),x+B>=L?(A=0,x=L):x+B>=1?(A=(i*R-1)*Math.pow(2,g),x+=B):(A=i*Math.pow(2,B-1)*Math.pow(2,g),x=0));g>=8;u[l+q]=255&A,q+=Y,A/=256,g-=8);for(x=x<<g|A,O+=g;O>0;u[l+q]=255&x,q+=Y,x/=256,O-=8);u[l+q-Y]|=128*ne}),uE}function tl(){if(Hs)return sm;Hs=1,sm=i;var u=el();function i(re){this.buf=ArrayBuffer.isView&&ArrayBuffer.isView(re)?re:new Uint8Array(re||0),this.pos=0,this.type=0,this.length=this.buf.length}i.Varint=0,i.Fixed64=1,i.Bytes=2,i.Fixed32=5;var l=4294967296,p=1/l,g=typeof TextDecoder>"u"?null:new TextDecoder("utf8");function b(re){return re.type===i.Bytes?re.readVarint()+re.pos:re.pos+1}function x(re,ye,Oe){return Oe?4294967296*ye+(re>>>0):4294967296*(ye>>>0)+(re>>>0)}function A(re,ye,Oe){var Le=ye<=16383?1:ye<=2097151?2:ye<=268435455?3:Math.floor(Math.log(ye)/(7*Math.LN2));Oe.realloc(Le);for(var nt=Oe.pos-1;nt>=re;nt--)Oe.buf[nt+Le]=Oe.buf[nt]}function R(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeVarint(re[Oe])}function O(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeSVarint(re[Oe])}function L(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeFloat(re[Oe])}function B(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeDouble(re[Oe])}function U(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeBoolean(re[Oe])}function q(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeFixed32(re[Oe])}function Y(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeSFixed32(re[Oe])}function ne(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeFixed64(re[Oe])}function ae(re,ye){for(var Oe=0;Oe<re.length;Oe++)ye.writeSFixed64(re[Oe])}function he(re,ye){return(re[ye]|re[ye+1]<<8|re[ye+2]<<16)+16777216*re[ye+3]}function Se(re,ye,Oe){re[Oe]=ye,re[Oe+1]=ye>>>8,re[Oe+2]=ye>>>16,re[Oe+3]=ye>>>24}function Ae(re,ye){return(re[ye]|re[ye+1]<<8|re[ye+2]<<16)+(re[ye+3]<<24)}return i.prototype={destroy:function(){this.buf=null},readFields:function(re,ye,Oe){for(Oe=Oe||this.length;this.pos<Oe;){var Le=this.readVarint(),nt=Le>>3,Qe=this.pos;this.type=7&Le,re(nt,ye,this),this.pos===Qe&&this.skip(Le)}return ye},readMessage:function(re,ye){return this.readFields(re,ye,this.readVarint()+this.pos)},readFixed32:function(){var re=he(this.buf,this.pos);return this.pos+=4,re},readSFixed32:function(){var re=Ae(this.buf,this.pos);return this.pos+=4,re},readFixed64:function(){var re=he(this.buf,this.pos)+he(this.buf,this.pos+4)*l;return this.pos+=8,re},readSFixed64:function(){var re=he(this.buf,this.pos)+Ae(this.buf,this.pos+4)*l;return this.pos+=8,re},readFloat:function(){var re=u.read(this.buf,this.pos,!0,23,4);return this.pos+=4,re},readDouble:function(){var re=u.read(this.buf,this.pos,!0,52,8);return this.pos+=8,re},readVarint:function(re){var ye,Oe,Le=this.buf;return ye=127&(Oe=Le[this.pos++]),Oe<128?ye:(ye|=(127&(Oe=Le[this.pos++]))<<7,Oe<128?ye:(ye|=(127&(Oe=Le[this.pos++]))<<14,Oe<128?ye:(ye|=(127&(Oe=Le[this.pos++]))<<21,Oe<128?ye:function(nt,Qe,st){var dt,a,h=st.buf;if(dt=(112&(a=h[st.pos++]))>>4,a<128||(dt|=(127&(a=h[st.pos++]))<<3,a<128)||(dt|=(127&(a=h[st.pos++]))<<10,a<128)||(dt|=(127&(a=h[st.pos++]))<<17,a<128)||(dt|=(127&(a=h[st.pos++]))<<24,a<128)||(dt|=(1&(a=h[st.pos++]))<<31,a<128))return x(nt,dt,Qe);throw new Error("Expected varint not more than 10 bytes")}(ye|=(15&(Oe=Le[this.pos]))<<28,re,this))))},readVarint64:function(){return this.readVarint(!0)},readSVarint:function(){var re=this.readVarint();return re%2==1?(re+1)/-2:re/2},readBoolean:function(){return!!this.readVarint()},readString:function(){var re=this.readVarint()+this.pos,ye=this.pos;return this.pos=re,re-ye>=12&&g?function(Oe,Le,nt){return g.decode(Oe.subarray(Le,nt))}(this.buf,ye,re):function(Oe,Le,nt){for(var Qe="",st=Le;st<nt;){var dt,a,h,v=Oe[st],S=null,I=v>239?4:v>223?3:v>191?2:1;if(st+I>nt)break;I===1?v<128&&(S=v):I===2?(192&(dt=Oe[st+1]))==128&&(S=(31&v)<<6|63&dt)<=127&&(S=null):I===3?(a=Oe[st+2],(192&(dt=Oe[st+1]))==128&&(192&a)==128&&((S=(15&v)<<12|(63&dt)<<6|63&a)<=2047||S>=55296&&S<=57343)&&(S=null)):I===4&&(a=Oe[st+2],h=Oe[st+3],(192&(dt=Oe[st+1]))==128&&(192&a)==128&&(192&h)==128&&((S=(15&v)<<18|(63&dt)<<12|(63&a)<<6|63&h)<=65535||S>=1114112)&&(S=null)),S===null?(S=65533,I=1):S>65535&&(S-=65536,Qe+=String.fromCharCode(S>>>10&1023|55296),S=56320|1023&S),Qe+=String.fromCharCode(S),st+=I}return Qe}(this.buf,ye,re)},readBytes:function(){var re=this.readVarint()+this.pos,ye=this.buf.subarray(this.pos,re);return this.pos=re,ye},readPackedVarint:function(re,ye){if(this.type!==i.Bytes)return re.push(this.readVarint(ye));var Oe=b(this);for(re=re||[];this.pos<Oe;)re.push(this.readVarint(ye));return re},readPackedSVarint:function(re){if(this.type!==i.Bytes)return re.push(this.readSVarint());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readSVarint());return re},readPackedBoolean:function(re){if(this.type!==i.Bytes)return re.push(this.readBoolean());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readBoolean());return re},readPackedFloat:function(re){if(this.type!==i.Bytes)return re.push(this.readFloat());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readFloat());return re},readPackedDouble:function(re){if(this.type!==i.Bytes)return re.push(this.readDouble());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readDouble());return re},readPackedFixed32:function(re){if(this.type!==i.Bytes)return re.push(this.readFixed32());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readFixed32());return re},readPackedSFixed32:function(re){if(this.type!==i.Bytes)return re.push(this.readSFixed32());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readSFixed32());return re},readPackedFixed64:function(re){if(this.type!==i.Bytes)return re.push(this.readFixed64());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readFixed64());return re},readPackedSFixed64:function(re){if(this.type!==i.Bytes)return re.push(this.readSFixed64());var ye=b(this);for(re=re||[];this.pos<ye;)re.push(this.readSFixed64());return re},skip:function(re){var ye=7&re;if(ye===i.Varint)for(;this.buf[this.pos++]>127;);else if(ye===i.Bytes)this.pos=this.readVarint()+this.pos;else if(ye===i.Fixed32)this.pos+=4;else{if(ye!==i.Fixed64)throw new Error("Unimplemented type: "+ye);this.pos+=8}},writeTag:function(re,ye){this.writeVarint(re<<3|ye)},realloc:function(re){for(var ye=this.length||16;ye<this.pos+re;)ye*=2;if(ye!==this.length){var Oe=new Uint8Array(ye);Oe.set(this.buf),this.buf=Oe,this.length=ye}},finish:function(){return this.length=this.pos,this.pos=0,this.buf.subarray(0,this.length)},writeFixed32:function(re){this.realloc(4),Se(this.buf,re,this.pos),this.pos+=4},writeSFixed32:function(re){this.realloc(4),Se(this.buf,re,this.pos),this.pos+=4},writeFixed64:function(re){this.realloc(8),Se(this.buf,-1&re,this.pos),Se(this.buf,Math.floor(re*p),this.pos+4),this.pos+=8},writeSFixed64:function(re){this.realloc(8),Se(this.buf,-1&re,this.pos),Se(this.buf,Math.floor(re*p),this.pos+4),this.pos+=8},writeVarint:function(re){(re=+re||0)>268435455||re<0?function(ye,Oe){var Le,nt;if(ye>=0?(Le=ye%4294967296|0,nt=ye/4294967296|0):(nt=~(-ye/4294967296),4294967295^(Le=~(-ye%4294967296))?Le=Le+1|0:(Le=0,nt=nt+1|0)),ye>=18446744073709552e3||ye<-18446744073709552e3)throw new Error("Given varint doesn't fit into 10 bytes");Oe.realloc(10),function(Qe,st,dt){dt.buf[dt.pos++]=127&Qe|128,Qe>>>=7,dt.buf[dt.pos++]=127&Qe|128,Qe>>>=7,dt.buf[dt.pos++]=127&Qe|128,Qe>>>=7,dt.buf[dt.pos++]=127&Qe|128,dt.buf[dt.pos]=127&(Qe>>>=7)}(Le,0,Oe),function(Qe,st){var dt=(7&Qe)<<4;st.buf[st.pos++]|=dt|((Qe>>>=3)?128:0),Qe&&(st.buf[st.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(st.buf[st.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(st.buf[st.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(st.buf[st.pos++]=127&Qe|((Qe>>>=7)?128:0),Qe&&(st.buf[st.pos++]=127&Qe)))))}(nt,Oe)}(re,this):(this.realloc(4),this.buf[this.pos++]=127&re|(re>127?128:0),re<=127||(this.buf[this.pos++]=127&(re>>>=7)|(re>127?128:0),re<=127||(this.buf[this.pos++]=127&(re>>>=7)|(re>127?128:0),re<=127||(this.buf[this.pos++]=re>>>7&127))))},writeSVarint:function(re){this.writeVarint(re<0?2*-re-1:2*re)},writeBoolean:function(re){this.writeVarint(!!re)},writeString:function(re){re=String(re),this.realloc(4*re.length),this.pos++;var ye=this.pos;this.pos=function(Le,nt,Qe){for(var st,dt,a=0;a<nt.length;a++){if((st=nt.charCodeAt(a))>55295&&st<57344){if(!dt){st>56319||a+1===nt.length?(Le[Qe++]=239,Le[Qe++]=191,Le[Qe++]=189):dt=st;continue}if(st<56320){Le[Qe++]=239,Le[Qe++]=191,Le[Qe++]=189,dt=st;continue}st=dt-55296<<10|st-56320|65536,dt=null}else dt&&(Le[Qe++]=239,Le[Qe++]=191,Le[Qe++]=189,dt=null);st<128?Le[Qe++]=st:(st<2048?Le[Qe++]=st>>6|192:(st<65536?Le[Qe++]=st>>12|224:(Le[Qe++]=st>>18|240,Le[Qe++]=st>>12&63|128),Le[Qe++]=st>>6&63|128),Le[Qe++]=63&st|128)}return Qe}(this.buf,re,this.pos);var Oe=this.pos-ye;Oe>=128&&A(ye,Oe,this),this.pos=ye-1,this.writeVarint(Oe),this.pos+=Oe},writeFloat:function(re){this.realloc(4),u.write(this.buf,re,this.pos,!0,23,4),this.pos+=4},writeDouble:function(re){this.realloc(8),u.write(this.buf,re,this.pos,!0,52,8),this.pos+=8},writeBytes:function(re){var ye=re.length;this.writeVarint(ye),this.realloc(ye);for(var Oe=0;Oe<ye;Oe++)this.buf[this.pos++]=re[Oe]},writeRawMessage:function(re,ye){this.pos++;var Oe=this.pos;re(ye,this);var Le=this.pos-Oe;Le>=128&&A(Oe,Le,this),this.pos=Oe-1,this.writeVarint(Le),this.pos+=Le},writeMessage:function(re,ye,Oe){this.writeTag(re,i.Bytes),this.writeRawMessage(ye,Oe)},writePackedVarint:function(re,ye){ye.length&&this.writeMessage(re,R,ye)},writePackedSVarint:function(re,ye){ye.length&&this.writeMessage(re,O,ye)},writePackedBoolean:function(re,ye){ye.length&&this.writeMessage(re,U,ye)},writePackedFloat:function(re,ye){ye.length&&this.writeMessage(re,L,ye)},writePackedDouble:function(re,ye){ye.length&&this.writeMessage(re,B,ye)},writePackedFixed32:function(re,ye){ye.length&&this.writeMessage(re,q,ye)},writePackedSFixed32:function(re,ye){ye.length&&this.writeMessage(re,Y,ye)},writePackedFixed64:function(re,ye){ye.length&&this.writeMessage(re,ne,ye)},writePackedSFixed64:function(re,ye){ye.length&&this.writeMessage(re,ae,ye)},writeBytesField:function(re,ye){this.writeTag(re,i.Bytes),this.writeBytes(ye)},writeFixed32Field:function(re,ye){this.writeTag(re,i.Fixed32),this.writeFixed32(ye)},writeSFixed32Field:function(re,ye){this.writeTag(re,i.Fixed32),this.writeSFixed32(ye)},writeFixed64Field:function(re,ye){this.writeTag(re,i.Fixed64),this.writeFixed64(ye)},writeSFixed64Field:function(re,ye){this.writeTag(re,i.Fixed64),this.writeSFixed64(ye)},writeVarintField:function(re,ye){this.writeTag(re,i.Varint),this.writeVarint(ye)},writeSVarintField:function(re,ye){this.writeTag(re,i.Varint),this.writeSVarint(ye)},writeStringField:function(re,ye){this.writeTag(re,i.Bytes),this.writeString(ye)},writeFloatField:function(re,ye){this.writeTag(re,i.Fixed32),this.writeFloat(ye)},writeDoubleField:function(re,ye){this.writeTag(re,i.Fixed64),this.writeDouble(ye)},writeBooleanField:function(re,ye){this.writeVarintField(re,!!ye)}},sm}var vc=Pn(tl());const I1=3;function lD(u,i,l){i.glyphs=[],u===1&&l.readMessage(cD,i)}function cD(u,i,l){if(u===3){const{id:p,bitmap:g,width:b,height:x,left:A,top:R,advance:O}=l.readMessage($y,{});i.glyphs.push({id:p,bitmap:new Ed({width:b+2*I1,height:x+2*I1},g),metrics:{width:b,height:x,left:A,top:R,advance:O}})}else u===4?i.ascender=l.readSVarint():u===5&&(i.descender=l.readSVarint())}function $y(u,i,l){u===1?i.id=l.readVarint():u===2?i.bitmap=l.readBytes():u===3?i.width=l.readVarint():u===4?i.height=l.readVarint():u===5?i.left=l.readSVarint():u===6?i.top=l.readSVarint():u===7&&(i.advance=l.readVarint())}const Gy=I1,Oa={horizontal:1,vertical:2,horizontalOnly:3};class om{constructor(){this.scale=1,this.fontStack="",this.image=null}static forText(i,l){const p=new om;return p.scale=i||1,p.fontStack=l,p}static forImage(i){const l=new om;return l.image=i,l}}class nl{constructor(){this.text="",this.sectionIndex=[],this.sections=[],this.imageSectionID=null}static fromFeature(i,l,p){const g=new nl;for(let b=0;b<i.sections.length;b++){const x=i.sections[b];x.image?g.addImageSection(x,p):g.addTextSection(x,l)}return g}length(){return this.text.length}getSection(i){return this.sections[this.sectionIndex[i]]}getSections(){return this.sections}getSectionIndex(i){return this.sectionIndex[i]}getCodePoint(i){return this.text.codePointAt(i)}verticalizePunctuation(i){this.text=function(l,p){let g="";for(let b=0;b<l.length;b++){const x=l.charCodeAt(b+1)||null,A=l.charCodeAt(b-1)||null;g+=!p&&(x&&N0(x)&&!kd[l[b+1]]||A&&N0(A)&&!kd[l[b-1]])||!kd[l[b]]?l[b]:kd[l[b]]}return g}(this.text,i)}trim(){let i=0;for(let p=0;p<this.text.length&&Nd[this.text.charCodeAt(p)];p++)i++;let l=this.text.length;for(let p=this.text.length-1;p>=0&&p>=i&&Nd[this.text.charCodeAt(p)];p--)l--;this.text=this.text.substring(i,l),this.sectionIndex=this.sectionIndex.slice(i,l)}substring(i,l){const p=new nl;return p.text=this.text.substring(i,l),p.sectionIndex=this.sectionIndex.slice(i,l),p.sections=this.sections,p}toString(){return this.text}getMaxScale(){return this.sectionIndex.reduce((i,l)=>Math.max(i,this.sections[l].scale),0)}addTextSection(i,l){this.text+=i.text,this.sections.push(om.forText(i.scale,i.fontStack||l));const p=this.sections.length-1;for(let g=0;g<i.text.length;++g)this.sectionIndex.push(p)}addImageSection(i,l){const p=i.image?i.image.getPrimary():null;if(!p)return void ii("Can't add FormattedSection with an empty image.");p.scaleSelf(l);const g=this.getNextImageSectionCharCode();g?(this.text+=String.fromCodePoint(g),this.sections.push(om.forImage(p)),this.sectionIndex.push(this.sections.length-1)):ii("Reached maximum number of images 6401")}getNextImageSectionCharCode(){return this.imageSectionID?this.imageSectionID>=63743?null:++this.imageSectionID:(this.imageSectionID=57344,this.imageSectionID)}}function bc(u,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne=1){const ae=nl.fromFeature(u,g,ne);B===Oa.vertical&&ae.verticalizePunctuation(U);let he=[];const Se=function(Le,nt,Qe,st,dt,a){if(!Le)return[];const h=[],v=function(K,ee,me,De,it,yt){let ct=0;for(let ut=0;ut<K.length();ut++){const Ct=K.getSection(ut);ct+=Ld(K.getCodePoint(ut),Ct,De,it,ee,yt)}return ct/Math.max(1,Math.ceil(ct/me))}(Le,nt,Qe,st,dt,a),S=Le.text.indexOf("​")>=0;let I=0;for(let K=0;K<Le.length();K++){const ee=Le.getSection(K),me=Le.getCodePoint(K);if(Nd[me]||(I+=Ld(me,ee,st,dt,nt,a)),K<Le.length()-1){const De=!((k=me)<11904||!(Fn["Bopomofo Extended"](k)||Fn.Bopomofo(k)||Fn["CJK Compatibility Forms"](k)||Fn["CJK Compatibility Ideographs"](k)||Fn["CJK Compatibility"](k)||Fn["CJK Radicals Supplement"](k)||Fn["CJK Strokes"](k)||Fn["CJK Symbols and Punctuation"](k)||Fn["CJK Unified Ideographs Extension A"](k)||Fn["CJK Unified Ideographs"](k)||Fn["Enclosed CJK Letters and Months"](k)||Fn["Halfwidth and Fullwidth Forms"](k)||Fn.Hiragana(k)||Fn["Ideographic Description Characters"](k)||Fn["Kangxi Radicals"](k)||Fn["Katakana Phonetic Extensions"](k)||Fn.Katakana(k)||Fn["Vertical Forms"](k)||Fn["Yi Radicals"](k)||Fn["Yi Syllables"](k)));(Jf[me]||De||ee.image)&&h.push(qr(K+1,I,v,h,So(me,Le.getCodePoint(K+1),De&&S),!1))}}var k;return zd(qr(Le.length(),I,v,h,0,!0))}(ae,O,b,i,p,q),{processBidirectionalText:Ae,processStyledBidirectionalText:re}=nu;if(Ae&&ae.sections.length===1){const Le=Ae(ae.toString(),Se);for(const nt of Le){const Qe=new nl;Qe.text=nt,Qe.sections=ae.sections;for(let st=0;st<nt.length;st++)Qe.sectionIndex.push(0);he.push(Qe)}}else if(re){const Le=re(ae.text,ae.sectionIndex,Se);for(const nt of Le){const Qe=new nl;Qe.text=nt[0],Qe.sectionIndex=nt[1],Qe.sections=ae.sections,he.push(Qe)}}else he=function(Le,nt){const Qe=[],st=Le.text;let dt=0;for(const a of nt)Qe.push(Le.substring(dt,a)),dt=a;return dt<st.length&&Qe.push(Le.substring(dt,st.length)),Qe}(ae,Se);const ye=[],Oe={positionedLines:ye,text:ae.toString(),top:L[1],bottom:L[1],left:L[0],right:L[0],writingMode:B,iconsInText:!1,verticalizable:!1,hasBaseline:!1};if(function(Le,nt,Qe,st,dt,a,h,v,S,I,k,K){let ee=0,me=0,De=0;const it=v==="right"?1:v==="left"?0:.5;let yt=!1;for(const Qt of dt){const Je=Qt.getSections();for(const rt of Je){if(rt.image)continue;const lt=nt[rt.fontStack];if(lt&&(yt=lt.ascender!==void 0&&lt.descender!==void 0,!yt))break}if(!yt)break}let ct=0;for(const Qt of dt){Qt.trim();const Je=Qt.getMaxScale(),rt=(Je-1)*xs,lt={positionedGlyphs:[],lineOffset:0};Le.positionedLines[ct]=lt;const kt=lt.positionedGlyphs;let Zt=0;if(!Qt.length()){me+=a,++ct;continue}let On=0,An=0;for(let Ce=0;Ce<Qt.length();Ce++){const Me=Qt.getSection(Ce),wt=Qt.getSectionIndex(Ce),Wt=Qt.getCodePoint(Ce);let un=Me.scale,hn=null,En=null,Zn=null,xi=xs,wi=0;S===Oa.vertical&&((ut=Wt)===12312||ut===12313||ut===12316||ut===12540||ut===12448)&&(S=Oa.horizontal);const ci=!(S===Oa.horizontal||!k&&!ko(Wt)||k&&(Nd[Wt]||$x(Wt)));if(Me.image){const nr=st.get(Me.image.toString());if(!nr)continue;Zn=Me.image,Le.iconsInText=Le.iconsInText||!0,En=nr.paddedRect;const Ar=nr.displaySize;un=un*xs/K,hn={width:Ar[0],height:Ar[1],left:0,top:-3,advance:ci?Ar[1]:Ar[0],localGlyph:!1},wi=yt?-hn.height*un:Je*xs-17-Ar[1]*un,xi=hn.advance;const Ti=(ci?Ar[0]:Ar[1])*un-xs*Je;Ti>0&&Ti>Zt&&(Zt=Ti)}else{const nr=Qe[Me.fontStack];if(!nr)continue;nr[Wt]&&(En=nr[Wt]);const Ar=nt[Me.fontStack];if(!Ar)continue;const Ti=Ar.glyphs[Wt];if(!Ti)continue;if(hn=Ti.metrics,xi=Wt!==8203?xs:0,yt){const is=Ar.ascender!==void 0?Math.abs(Ar.ascender):0,Pr=Ar.descender!==void 0?Math.abs(Ar.descender):0,Ji=(is+Pr)*un;On<Ji&&(On=Ji,An=(is-Pr)/2*un),wi=-is*un}else wi=(Je-un)*xs-17}ci?(Le.verticalizable=!0,kt.push({glyph:Wt,image:Zn,x:ee,y:me+wi,vertical:ci,scale:un,localGlyph:hn.localGlyph,fontStack:Me.fontStack,sectionIndex:wt,metrics:hn,rect:En}),ee+=xi*un+I):(kt.push({glyph:Wt,image:Zn,x:ee,y:me+wi,vertical:ci,scale:un,localGlyph:hn.localGlyph,fontStack:Me.fontStack,sectionIndex:wt,metrics:hn,rect:En}),ee+=hn.advance*un+I)}kt.length!==0&&(De=Math.max(ee-I,De),yt?am(kt,it,Zt,An,a*Je/2):am(kt,it,Zt,0,a/2)),ee=0;const Yn=a*Je+Zt;lt.lineOffset=Math.max(Zt,rt),me+=Yn,++ct}var ut;const Ct=me,{horizontalAlign:mn,verticalAlign:tn}=xc(h);(function(Qt,Je,rt,lt,kt,Zt){const On=(Je-rt)*kt,An=-Zt*lt;for(const Yn of Qt)for(const Ce of Yn.positionedGlyphs)Ce.x+=On,Ce.y+=An})(Le.positionedLines,it,mn,tn,De,Ct),Le.top+=-tn*Ct,Le.bottom=Le.top+Ct,Le.left+=-mn*De,Le.right=Le.left+De,Le.hasBaseline=yt}(Oe,i,l,p,he,x,A,R,B,O,U,Y),!function(Le){for(const nt of Le)if(nt.positionedGlyphs.length!==0)return!1;return!0}(ye))return Oe}const Nd={9:!0,10:!0,11:!0,12:!0,13:!0,32:!0},Jf={10:!0,32:!0,38:!0,40:!0,41:!0,43:!0,45:!0,47:!0,173:!0,183:!0,8203:!0,8208:!0,8211:!0,8231:!0};function Ld(u,i,l,p,g,b){if(i.image){const x=p.get(i.image.toString());return x?x.displaySize[0]*i.scale*xs/b+g:0}{const x=l[i.fontStack],A=x&&x.glyphs[u];return A?A.metrics.advance*i.scale+g:0}}function bl(u,i,l,p){const g=Math.pow(u-i,2);return p?u<i?g/2:2*g:g+Math.abs(l)*l}function So(u,i,l){let p=0;return u===10&&(p-=1e4),l&&(p+=150),u!==40&&u!==65288||(p+=50),i!==41&&i!==65289||(p+=50),p}function qr(u,i,l,p,g,b){let x=null,A=bl(i,l,g,b);for(const R of p){const O=bl(i-R.x,l,g,b)+R.badness;O<=A&&(x=R,A=O)}return{index:u,x:i,priorBreak:x,badness:A}}function zd(u){return u?zd(u.priorBreak).concat(u.index):[]}function xc(u){let i=.5,l=.5;switch(u){case"right":case"top-right":case"bottom-right":i=1;break;case"left":case"top-left":case"bottom-left":i=0}switch(u){case"bottom":case"bottom-right":case"bottom-left":l=1;break;case"top":case"top-right":case"top-left":l=0}return{horizontalAlign:i,verticalAlign:l}}function am(u,i,l,p,g){if(!(i||l||p||g))return;const b=u.length-1,x=u[b],A=(x.x+x.metrics.advance*x.scale)*i;for(let R=0;R<=b;R++)u[R].x-=A,u[R].y+=l+p+g}function Bh(u){return u.imagePrimary!==void 0&&u.top!==void 0&&u.bottom!==void 0&&u.left!==void 0&&u.right!==void 0}function hE(u,i,l,p){const{horizontalAlign:g,verticalAlign:b}=xc(p),x=l[0]-u.displaySize[0]*g,A=l[1]-u.displaySize[1]*b;return{imagePrimary:u,imageSecondary:i,top:A,bottom:A+u.displaySize[1],left:x,right:x+u.displaySize[0]}}function dE(u,i,l,p,g,b){const x=u.imagePrimary;let A;if(x.content){const ae=x.content,he=x.pixelRatio||1;A=[ae[0]/he,ae[1]/he,x.displaySize[0]-ae[2]/he,x.displaySize[1]-ae[3]/he]}const R=i.left*b,O=i.right*b;let L,B,U,q;l==="width"||l==="both"?(q=g[0]+R-p[3],B=g[0]+O+p[1]):(q=g[0]+(R+O-x.displaySize[0])/2,B=q+x.displaySize[0]);const Y=i.top*b,ne=i.bottom*b;return l==="height"||l==="both"?(L=g[1]+Y-p[0],U=g[1]+ne+p[2]):(L=g[1]+(Y+ne-x.displaySize[1])/2,U=L+x.displaySize[1]),{imagePrimary:x,imageSecondary:void 0,top:L,right:B,bottom:U,left:q,collisionPadding:A}}function uD(u){return!u.imagePrimary.stretchX}function fE(u){return!u.imagePrimary.stretchY}function hD(u){return{width:u.right-u.left,height:u.bottom-u.top}}const zu=128;function M1(u,i,l){const{expression:p}=i;if(p.kind==="constant")return{kind:"constant",layoutSize:p.evaluate(new $i(u+1,{worldview:l}))};if(p.kind==="source")return{kind:"source"};{const{zoomStops:g,interpolationType:b}=p;let x=0;for(;x<g.length&&g[x]<=u;)x++;x=Math.max(0,x-1);let A=x;for(;A<g.length&&g[A]<u+1;)A++;A=Math.min(g.length-1,A);const R=g[x],O=g[A];return p.kind==="composite"?{kind:"composite",minZoom:R,maxZoom:O,interpolationType:b}:{kind:"camera",minZoom:R,maxZoom:O,minSize:p.evaluate(new $i(R,{worldview:l})),maxSize:p.evaluate(new $i(O,{worldview:l})),interpolationType:b}}}function P1(u,{uSize:i,uSizeT:l},{lowerSize:p,upperSize:g}){return u.kind==="source"?p/zu:u.kind==="composite"?$n(p/zu,g/zu,l):i}function lm(u,i,l=1){let p=0,g=0;if(u.kind==="constant")g=u.layoutSize*l;else if(u.kind!=="source"){const{interpolationType:b,minZoom:x,maxZoom:A}=u,R=b?He(Ll.interpolationFactor(b,i,x,A),0,1):0;u.kind==="camera"?g=$n(u.minSize,u.maxSize,R)*l:p=R*l}return{uSizeT:p,uSize:g}}class wc extends Lt{constructor(i,l,p,g,b){super(i,l),this.angle=g,this.z=p,b!==void 0&&(this.segment=b)}clone(){return new wc(this.x,this.y,this.z,this.angle,this.segment)}}function $g(u,i,l,p,g){if(i.segment===void 0)return!0;let b=i,x=i.segment+1,A=0;for(;A>-l/2;){if(x--,x<0)return!1;A-=u[x].dist(b),b=u[x]}A+=u[x].dist(u[x+1]),x++;const R=[];let O=0;for(;A<l/2;){const L=u[x],B=u[x+1];if(!B)return!1;let U=u[x-1].angleTo(L)-L.angleTo(B);for(U=Math.abs((U+3*Math.PI)%(2*Math.PI)-Math.PI),R.push({distance:A,angleDelta:U}),O+=U;A-R[0].distance>p;)O-=R.shift().angleDelta;if(O>g)return!1;x++,A+=L.dist(B)}return!0}function dD(u){let i=0;for(let l=0;l<u.length-1;l++)i+=u[l].dist(u[l+1]);return i}function fD(u,i,l){return u?.6*i*l:0}function pD(u,i){return Math.max(u?u.right-u.left:0,i?i.right-i.left:0)}function da(u,i,l,p,g,b){const x=fD(l,g,b),A=pD(l,p)*b;let R=0;const O=dD(u)/2;for(let L=0;L<u.length-1;L++){const B=u[L],U=u[L+1],q=B.dist(U);if(R+q>O){const Y=(O-R)/q,ne=$n(B.x,U.x,Y),ae=$n(B.y,U.y,Y),he=new wc(ne,ae,0,U.angleTo(B),L);return!x||$g(u,he,A,x,i)?he:void 0}R+=q}}function qy(u,i,l,p,g,b,x,A,R){const O=fD(p,b,x),L=pD(p,g),B=L*x,U=u[0].x===0||u[0].x===R||u[0].y===0||u[0].y===R;return i-B<i/4&&(i=B+i/4),pE(u,U?i/2*A%i:(L/2+2*b)*x*A%i,i,O,l,B,U,!1,R)}function pE(u,i,l,p,g,b,x,A,R){const O=b/2,L=dD(u);let B=0,U=i-l,q=[];for(let Y=0;Y<u.length-1;Y++){const ne=u[Y],ae=u[Y+1],he=ne.dist(ae),Se=ae.angleTo(ne);for(;U+l<B+he;){U+=l;const Ae=(U-B)/he,re=$n(ne.x,ae.x,Ae),ye=$n(ne.y,ae.y,Ae);if(re>=0&&re<R&&ye>=0&&ye<R&&U-O>=0&&U+O<=L){const Oe=new wc(re,ye,0,Se,Y);p&&!$g(u,Oe,b,p,g)||q.push(Oe)}}B+=he}return A||q.length||x||(q=pE(u,B/2,l,p,g,b,x,!0,R)),q}function xb(u){let i=0,l=0;for(const x of u)i+=x.w*x.h,l=Math.max(l,x.w);u.sort((x,A)=>A.h-x.h);const p=[{x:0,y:0,w:Math.max(Math.ceil(Math.sqrt(i/.95)),l),h:1/0}];let g=0,b=0;for(const x of u)for(let A=p.length-1;A>=0;A--){const R=p[A];if(!(x.w>R.w||x.h>R.h)){if(x.x=R.x,x.y=R.y,b=Math.max(b,x.y+x.h),g=Math.max(g,x.x+x.w),x.w===R.w&&x.h===R.h){const O=p.pop();A<p.length&&(p[A]=O)}else x.h===R.h?(R.x+=x.w,R.w-=x.w):x.w===R.w?(R.y+=x.h,R.h-=x.h):(p.push({x:R.x+x.w,y:R.y,w:R.w-x.w,h:x.h}),R.y+=x.h,R.h-=x.h);break}}return{w:g,h:b,fill:i/(g*b)||0}}vn(wc,"Anchor");const Yo=1;class Fh{static getImagePositionScale(i,l,p){if(l&&i&&i.options&&i.options.transform){const g=i.options.transform;return{x:g.a,y:g.d}}return{x:p,y:p}}constructor(i,l,p,g){this.paddedRect=i;const{pixelRatio:b,version:x,stretchX:A,stretchY:R,content:O,sdf:L,usvg:B}=l;this.pixelRatio=b,this.stretchX=A,this.stretchY=R,this.content=O,this.version=x,this.padding=p,this.sdf=L,this.usvg=B,this.scale=Fh.getImagePositionScale(g,B,b)}get tl(){return[this.paddedRect.x+this.padding,this.paddedRect.y+this.padding]}get br(){return[this.paddedRect.x+this.paddedRect.w-this.padding,this.paddedRect.y+this.paddedRect.h-this.padding]}get displaySize(){return[(this.paddedRect.w-2*this.padding)/this.scale.x,(this.paddedRect.h-2*this.padding)/this.scale.y]}}function Wy(u,i,l){const p=Ln.parse(u),g=function(b,x,A=[1,1]){return{x:0,y:0,w:(b.data?b.data.width:b.width*A[0])+2*x,h:(b.data?b.data.height:b.height*A[1])+2*x}}(i,l,[p.options.transform.a,p.options.transform.d]);return{bin:g,imagePosition:new Fh(g,i,l,p),imageVariant:p}}class wb{constructor(i,l,p){const g=new Map,b=new Map;this.haveRenderCallbacks=[];const x=[];this.addImages(i,g,Yo,x),this.addImages(l,b,2,x);const{w:A,h:R}=xb(x),O=new go({width:A||1,height:R||1});for(const[L,B]of i.entries()){const U=g.get(L).paddedRect;go.copy(B.data,O,{x:0,y:0},{x:U.x+Yo,y:U.y+Yo},B.data,p,B.sdf)}for(const[L,B]of l.entries()){const U=b.get(L),q=U.paddedRect;let Y=U.padding;const ne=q.x+Y,ae=q.y+Y,he=B.data.width,Se=B.data.height;Y=Y>1?Y-1:Y,go.copy(B.data,O,{x:0,y:0},{x:ne,y:ae},B.data,p),go.copy(B.data,O,{x:0,y:Se-Y},{x:ne,y:ae-Y},{width:he,height:Y},p),go.copy(B.data,O,{x:0,y:0},{x:ne,y:ae+Se},{width:he,height:Y},p),go.copy(B.data,O,{x:he-Y,y:0},{x:ne-Y,y:ae},{width:Y,height:Se},p),go.copy(B.data,O,{x:0,y:0},{x:ne+he,y:ae},{width:Y,height:Se},p),go.copy(B.data,O,{x:he-Y,y:Se-Y},{x:ne-Y,y:ae-Y},{width:Y,height:Y},p),go.copy(B.data,O,{x:0,y:Se-Y},{x:ne+he,y:ae-Y},{width:Y,height:Y},p),go.copy(B.data,O,{x:0,y:0},{x:ne+he,y:ae+Se},{width:Y,height:Y},p),go.copy(B.data,O,{x:he-Y,y:0},{x:ne-Y,y:ae+Se},{width:Y,height:Y},p)}this.lut=p,this.image=O,this.iconPositions=g,this.patternPositions=b}addImages(i,l,p,g){for(const[b,x]of i.entries()){const{bin:A,imagePosition:R,imageVariant:O}=Wy(b,x,p);l.set(b,R),g.push(A),x.hasRenderCallback&&this.haveRenderCallbacks.push(O.id)}}patchUpdatedImages(i,l,p){this.haveRenderCallbacks=this.haveRenderCallbacks.filter(g=>i.hasImage(g,p)),i.dispatchRenderCallbacks(this.haveRenderCallbacks,p);for(const g of i.getUpdatedImages(p)){for(const b of this.iconPositions.keys()){const x=Ln.parse(b);if(ra.isEqual(x.id,g)){const A=i.getImage(g,p);this.patchUpdatedImage(this.iconPositions.get(b),A,l)}}for(const b of this.patternPositions.keys()){const x=Ln.parse(b);if(ra.isEqual(x.id,g)){const A=i.getImage(g,p);this.patchUpdatedImage(this.patternPositions.get(b),A,l)}}}}patchUpdatedImage(i,l,p){if(!i||!l||i.version===l.version)return;i.version=l.version;const[g,b]=i.tl,x=i.sdf;if(this.lut||x){const A={width:l.data.width,height:l.data.height},R=new go(A);go.copy(l.data,R,{x:0,y:0},{x:0,y:0},A,this.lut,x),p.update(R,{position:{x:g,y:b}})}else p.update(l.data,{position:{x:g,y:b}})}}vn(Fh,"ImagePosition"),vn(wb,"ImageAtlas");const cm=1e20;function k1(u,i,l,p,g,b,x,A,R){for(let O=i;O<i+p;O++)um(u,l*b+O,b,g,x,A,R);for(let O=l;O<l+g;O++)um(u,O*b+i,1,p,x,A,R)}function um(u,i,l,p,g,b,x){b[0]=0,x[0]=-1e20,x[1]=cm,g[0]=u[i];for(let A=1,R=0,O=0;A<p;A++){g[A]=u[i+A*l];const L=A*A;do{const B=b[R];O=(g[A]-g[B]+L-B*B)/(A-B)/2}while(O<=x[R]&&--R>-1);R++,b[R]=A,x[R]=O,x[R+1]=cm}for(let A=0,R=0;A<p;A++){for(;x[R+1]<A;)R++;const O=b[R],L=A-O;u[i+A*l]=g[O]+L*L}}const xl=2,N1={none:0,ideographs:1,all:2};class Bu{constructor(i,l,p){this.requestManager=i,this.localGlyphMode=l,this.localFontFamily=p,this.urls={},this.entries={},this.localGlyphs={200:{},400:{},500:{},900:{}}}setURL(i,l){this.urls[l]=i}getGlyphs(i,l,p){const g=[],b=this.urls[l]||Ws.GLYPHS_URL;for(const x in i)for(const A of i[x])g.push({stack:x,id:A});Ze(g,({stack:x,id:A},R)=>{let O=this.entries[x];O||(O=this.entries[x]={glyphs:{},requests:{},ranges:{},ascender:void 0,descender:void 0});let L=O.glyphs[A];if(L!==void 0)return void R(null,{stack:x,id:A,glyph:L});if(L=this._tinySDF(O,x,A),L)return O.glyphs[A]=L,void R(null,{stack:x,id:A,glyph:L});const B=Math.floor(A/256);if(256*B>65535)return ii("glyphs > 65535 not supported"),void R(null,{stack:x,id:A,glyph:L});if(O.ranges[B])return void R(null,{stack:x,id:A,glyph:L});let U=O.requests[B];U||(U=O.requests[B]=[],Bu.loadGlyphRange(x,B,b,this.requestManager,(q,Y)=>{if(Y){O.ascender=Y.ascender,O.descender=Y.descender;for(const ne in Y.glyphs)this._doesCharSupportLocalGlyph(+ne)||(O.glyphs[+ne]=Y.glyphs[+ne]);O.ranges[B]=!0}for(const ne of U)ne(q,Y);delete O.requests[B]})),U.push((q,Y)=>{q?R(q):Y&&R(null,{stack:x,id:A,glyph:Y.glyphs[A]||null})})},(x,A)=>{if(x)p(x);else if(A){const R={};for(const{stack:O,id:L,glyph:B}of A)R[O]===void 0&&(R[O]={}),R[O].glyphs===void 0&&(R[O].glyphs={}),R[O].glyphs[L]=B&&{id:B.id,bitmap:B.bitmap.clone(),metrics:B.metrics},R[O].ascender=this.entries[O].ascender,R[O].descender=this.entries[O].descender;p(null,R)}})}_doesCharSupportLocalGlyph(i){return this.localGlyphMode!==N1.none&&(this.localGlyphMode===N1.all?!!this.localFontFamily:!!this.localFontFamily&&(Fn["CJK Unified Ideographs"](i)||Fn["Hangul Syllables"](i)||Fn.Hiragana(i)||Fn.Katakana(i)||Fn["CJK Symbols and Punctuation"](i)||Fn["CJK Unified Ideographs Extension A"](i)||Fn["CJK Unified Ideographs Extension B"](i)||Fn.Osage(i)))}_tinySDF(i,l,p){const g=this.localFontFamily;if(!g||!this._doesCharSupportLocalGlyph(p))return;let b=i.tinySDF;if(!b){let ne="400";/bold/i.test(l)?ne="900":/medium/i.test(l)?ne="500":/light/i.test(l)&&(ne="200"),b=i.tinySDF=new Bu.TinySDF({fontFamily:g,fontWeight:ne,fontSize:24*xl,buffer:3*xl,radius:8*xl}),b.fontWeight=ne}if(this.localGlyphs[b.fontWeight][p])return this.localGlyphs[b.fontWeight][p];const x=String.fromCodePoint(p),{data:A,width:R,height:O,glyphWidth:L,glyphHeight:B,glyphLeft:U,glyphTop:q,glyphAdvance:Y}=b.draw(x);return this.localGlyphs[b.fontWeight][p]={id:p,bitmap:new Ed({width:R,height:O},A),metrics:{width:L/xl,height:B/xl,left:U/xl,top:q/xl-27,advance:Y/xl,localGlyph:!0}}}}Bu.loadGlyphRange=function(u,i,l,p,g){const b=256*i,x=b+255,A=p.transformRequest(p.normalizeGlyphsURL(l).replace("{fontstack}",u).replace("{range}",`${b}-${x}`),Gc.Glyphs);qc(A,(R,O)=>{if(R)g(R);else if(O){const L={},B=function(U){return new vc(U).readFields(lD,{})}(O);for(const U of B.glyphs)L[U.id]=U;g(null,{glyphs:L,ascender:B.ascender,descender:B.descender})}})},Bu.TinySDF=class{constructor({fontSize:u=24,buffer:i=3,radius:l=8,cutoff:p=.25,fontFamily:g="sans-serif",fontWeight:b="normal",fontStyle:x="normal"}={}){this.buffer=i,this.cutoff=p,this.radius=l;const A=this.size=u+4*i,R=this._createCanvas(A),O=this.ctx=R.getContext("2d",{willReadFrequently:!0});O.font=`${x} ${b} ${u}px ${g}`,O.textBaseline="alphabetic",O.textAlign="left",O.fillStyle="black",this.gridOuter=new Float64Array(A*A),this.gridInner=new Float64Array(A*A),this.f=new Float64Array(A),this.z=new Float64Array(A+1),this.v=new Uint16Array(A)}_createCanvas(u){const i=document.createElement("canvas");return i.width=i.height=u,i}draw(u){const{width:i,actualBoundingBoxAscent:l,actualBoundingBoxDescent:p,actualBoundingBoxLeft:g,actualBoundingBoxRight:b}=this.ctx.measureText(u),x=Math.ceil(l),A=Math.max(0,Math.min(this.size-this.buffer,Math.ceil(b-g))),R=Math.min(this.size-this.buffer,x+Math.ceil(p)),O=A+2*this.buffer,L=R+2*this.buffer,B=Math.max(O*L,0),U=new Uint8ClampedArray(B),q={data:U,width:O,height:L,glyphWidth:A,glyphHeight:R,glyphTop:x,glyphLeft:0,glyphAdvance:i};if(A===0||R===0)return q;const{ctx:Y,buffer:ne,gridInner:ae,gridOuter:he}=this;Y.clearRect(ne,ne,A,R),Y.fillText(u,ne,ne+x);const Se=Y.getImageData(ne,ne,A,R);he.fill(cm,0,B),ae.fill(0,0,B);for(let Ae=0;Ae<R;Ae++)for(let re=0;re<A;re++){const ye=Se.data[4*(Ae*A+re)+3]/255;if(ye===0)continue;const Oe=(Ae+ne)*O+re+ne;if(ye===1)he[Oe]=0,ae[Oe]=cm;else{const Le=.5-ye;he[Oe]=Le>0?Le*Le:0,ae[Oe]=Le<0?Le*Le:0}}k1(he,0,0,O,L,O,this.f,this.v,this.z),k1(ae,ne,ne,A,R,O,this.f,this.v,this.z);for(let Ae=0;Ae<B;Ae++){const re=Math.sqrt(he[Ae])-Math.sqrt(ae[Ae]);U[Ae]=Math.round(255-255*(re/this.radius+this.cutoff))}return q}};const il=Yo;function Yy(u,i){return u+i[1]-i[0]}function Zy(u,i,l,p,g=1){const b=[],x=u.imagePrimary,A=x.pixelRatio,R=x.paddedRect.w-2*il,O=x.paddedRect.h-2*il,L=(u.right-u.left)*g,B=(u.bottom-u.top)*g,U=x.stretchX||[[0,R]],q=x.stretchY||[[0,O]],Y=U.reduce(Yy,0),ne=q.reduce(Yy,0),ae=R-Y,he=O-ne;let Se=0,Ae=Y,re=0,ye=ne,Oe=0,Le=ae,nt=0,Qe=he;if(x.content&&p){const dt=x.content;Se=hm(U,0,dt[0]),re=hm(q,0,dt[1]),Ae=hm(U,dt[0],dt[2]),ye=hm(q,dt[1],dt[3]),Oe=dt[0]-Se,nt=dt[1]-re,Le=dt[2]-dt[0]-Ae,Qe=dt[3]-dt[1]-ye}const st=(dt,a,h,v)=>{const S=dm(dt.stretch-Se,Ae,L,u.left*g),I=fm(dt.fixed-Oe,Le,dt.stretch,Y),k=dm(a.stretch-re,ye,B,u.top*g),K=fm(a.fixed-nt,Qe,a.stretch,ne),ee=dm(h.stretch-Se,Ae,L,u.left*g),me=fm(h.fixed-Oe,Le,h.stretch,Y),De=dm(v.stretch-re,ye,B,u.top*g),it=fm(v.fixed-nt,Qe,v.stretch,ne),yt=new Lt(S,k),ct=new Lt(ee,k),ut=new Lt(ee,De),Ct=new Lt(S,De),mn=new Lt(I/A,K/A),tn=new Lt(me/A,it/A),Qt=i*Math.PI/180;if(Qt){const On=Math.sin(Qt),An=Math.cos(Qt),Yn=[An,-On,On,An];yt._matMult(Yn),ct._matMult(Yn),Ct._matMult(Yn),ut._matMult(Yn)}const Je=dt.stretch+dt.fixed,rt=h.stretch+h.fixed,lt=a.stretch+a.fixed,kt=v.stretch+v.fixed,Zt=u.imageSecondary;return{tl:yt,tr:ct,bl:Ct,br:ut,texPrimary:{x:x.paddedRect.x+il+Je,y:x.paddedRect.y+il+lt,w:rt-Je,h:kt-lt},texSecondary:Zt?{x:Zt.paddedRect.x+il+Je,y:Zt.paddedRect.y+il+lt,w:rt-Je,h:kt-lt}:void 0,writingMode:void 0,glyphOffset:[0,0],sectionIndex:0,pixelOffsetTL:mn,pixelOffsetBR:tn,minFontScaleX:Le/A/L,minFontScaleY:Qe/A/B,isSDF:l}};if(p&&(x.stretchX||x.stretchY)){const dt=Xy(U,ae,Y),a=Xy(q,he,ne);for(let h=0;h<dt.length-1;h++){const v=dt[h],S=dt[h+1];for(let I=0;I<a.length-1;I++)b.push(st(v,a[I],S,a[I+1]))}}else b.push(st({fixed:0,stretch:-1},{fixed:0,stretch:-1},{fixed:0,stretch:R+1},{fixed:0,stretch:O+1}));return b}function hm(u,i,l){let p=0;for(const g of u)p+=Math.max(i,Math.min(l,g[1]))-Math.max(i,Math.min(l,g[0]));return p}function Xy(u,i,l){const p=[{fixed:-1,stretch:0}];for(const[g,b]of u){const x=p[p.length-1];p.push({fixed:g-x.stretch,stretch:x.stretch}),p.push({fixed:g-x.stretch,stretch:x.stretch+(b-g)})}return p.push({fixed:i+il,stretch:l}),p}function dm(u,i,l,p){return u/i*l+p}function fm(u,i,l,p){return u-i*l/p}function Gg(u,i,l,p){const g=i+u.positionedLines[p].lineOffset;return p===0?l+g/2:l+(g+(i+u.positionedLines[p-1].lineOffset))/2}function L1(u,i=1,l=!1){let p=1/0,g=1/0,b=-1/0,x=-1/0;const A=u[0];for(let q=0;q<A.length;q++){const Y=A[q];(!q||Y.x<p)&&(p=Y.x),(!q||Y.y<g)&&(g=Y.y),(!q||Y.x>b)&&(b=Y.x),(!q||Y.y>x)&&(x=Y.y)}const R=Math.min(b-p,x-g);let O=R/2;const L=new ng([],mD);if(R===0)return new Lt(p,g);for(let q=p;q<b;q+=R)for(let Y=g;Y<x;Y+=R)L.push(new Bd(q+O,Y+O,O,u));let B=function(q){let Y=0,ne=0,ae=0;const he=q[0];for(let Se=0,Ae=he.length,re=Ae-1;Se<Ae;re=Se++){const ye=he[Se],Oe=he[re],Le=ye.x*Oe.y-Oe.x*ye.y;ne+=(ye.x+Oe.x)*Le,ae+=(ye.y+Oe.y)*Le,Y+=3*Le}return new Bd(ne/Y,ae/Y,0,q)}(u),U=L.length;for(;L.length;){const q=L.pop();(q.d>B.d||!B.d)&&(B=q,l&&console.log("found best %d after %d probes",Math.round(1e4*q.d)/1e4,U)),q.max-B.d<=i||(O=q.h/2,L.push(new Bd(q.p.x-O,q.p.y-O,O,u)),L.push(new Bd(q.p.x+O,q.p.y-O,O,u)),L.push(new Bd(q.p.x-O,q.p.y+O,O,u)),L.push(new Bd(q.p.x+O,q.p.y+O,O,u)),U+=4)}return l&&(console.log(`num probes: ${U}`),console.log(`best distance: ${B.d}`)),B.p}function mD(u,i){return i.max-u.max}class Bd{constructor(i,l,p,g){this.p=new Lt(i,l),this.h=p,this.d=function(b,x){let A=!1,R=1/0;for(let O=0;O<x.length;O++){const L=x[O];for(let B=0,U=L.length,q=U-1;B<U;q=B++){const Y=L[B],ne=L[q];Y.y>b.y!=ne.y>b.y&&b.x<(ne.x-Y.x)*(b.y-Y.y)/(ne.y-Y.y)+Y.x&&(A=!A),R=Math.min(R,Ih(b,Y,ne))}}return(A?1:-1)*Math.sqrt(R)}(this.p,g),this.max=this.d+this.h*Math.SQRT2}}const gD=Object.keys,Qy=Number.POSITIVE_INFINITY,mE=Math.sqrt(2);function Ky(u,[i,l]){let p=0,g=0;if(l===Qy){i<0&&(i=0);const b=i/mE;switch(u){case"top-right":case"top-left":g=b-7;break;case"bottom-right":case"bottom-left":g=7-b;break;case"bottom":g=7-i;break;case"top":g=i-7}switch(u){case"top-right":case"bottom-right":p=-b;break;case"top-left":case"bottom-left":p=b;break;case"left":p=i;break;case"right":p=-i}}else{switch(i=Math.abs(i),l=Math.abs(l),u){case"top-right":case"top-left":case"top":g=l-7;break;case"bottom-right":case"bottom-left":case"bottom":g=7-l}switch(u){case"top-right":case"bottom-right":case"right":p=-i;break;case"top-left":case"bottom-left":case"left":p=i}}return[p,g]}function qg(u,i,l,p,g,b,x,A,R){if(!i||!i.usvg)return;const O=hD(p),L=hD(g),B=b!=="both"&&b!=="width"||!uD(p)?1:L.width/O.width,U=b!=="both"&&b!=="height"||!fE(p)?1:L.height/O.height;l.scaleSelf(B,U);const q=l.toString();x.set(q,l),A.set(q,i);const{imagePosition:Y}=Wy(q,i,Yo);R.set(q,Y)}function fu(u,i,l,p,g,b,x,A,R){if(!u)return;const O=function(L,B,U,q,Y,ne){if(L.kind==="camera")return L.maxSize;if(L.kind==="composite"){const ae=B.possiblyEvaluate(new $i(L.maxZoom,{worldview:ne}),U).evaluate(Y,{},U),he=B.possiblyEvaluate(new $i(L.minZoom,{worldview:ne}),U).evaluate(Y,{},U);return Math.max(ae,he)}return B.possiblyEvaluate(new $i(q,{worldview:ne})).evaluate(Y,{},U)}(i,l,p,g,b,R);return u.scaleSelf(O*A*x)}function pu(u,i,l,p,g,b,x,A,R){return{iconPrimary:fu(u.getPrimary(),i,l,p,g,b,x,A,R),iconSecondary:fu(u.getSecondary(),i,l,p,g,b,x,A,R)}}function Ul(u,i,l){if(!i)return;const p=l.get(u.toString()),g=l.get(i.toString());g&&(p.paddedRect.w===g.paddedRect.w&&p.paddedRect.h===g.paddedRect.h||ii(`Mismatch in icon variant sizes: ${u.toString()} and ${i.toString()}`),p.usvg!==g.usvg&&ii(`Mismatch in icon variant image types: ${u.id} and ${i.id}`))}function Ia(u,i,l,p){if(!u)return;const g=i.get(l.toString());if(u.imagePrimary=g,p){const b=i.get(p.toString());u.imageSecondary=b}}function fa(u,i){for(const l in u.horizontal)gE(u.horizontal[l],i);gE(u.vertical,i)}function gE(u,i){if(u){for(const l of u.positionedLines)for(const p of l.positionedGlyphs)if(p.image!==null){const g=p.image.toString();p.rect=i.get(g).paddedRect}}}function z1(u){switch(u){case"right":case"top-right":case"bottom-right":return"right";case"left":case"top-left":case"bottom-left":return"left"}return"center"}function _D(u,i,l,p,g,b,x,A,R){const O=Tb(b.horizontal)||b.vertical,L=l.get("icon-text-fit-padding").evaluate(p,{},g);let B,U=i;return i&&R!=="none"&&(u.allowVerticalPlacement&&b.vertical&&(B=dE(i,b.vertical,R,L,A,x)),O&&(U=dE(i,O,R,L,A,x))),{defaultShapedIcon:U,verticallyShapedIcon:B}}function _E(u,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he,Se,Ae){let re=x.textMaxSize.evaluate(i,{},U);re===void 0?re=A*x.textScaleFactor:re*=x.textScaleFactor;const ye=u.layers[0].layout,Oe=Tb(l.horizontal)||l.vertical,Le=q.name==="globe",nt=xs,Qe=u.tilePixelRatio*re/nt,st=(I=u.overscaling,u.zoom>18&&I>2&&(I>>=1),Math.max(sn/(512*I),1)*ye.get("symbol-spacing")),dt=ye.get("text-padding")*u.tilePixelRatio,a=ye.get("icon-padding")*u.tilePixelRatio,h=bi(ye.get("text-max-angle")),v=ye.get("icon-rotation-alignment")==="map"&&Ae!=="point",S=st/2;var I;u.hasAnyIconTextFit===!1&&ae!=="none"&&(u.hasAnyIconTextFit=!0);const k=i.properties?+i.properties[mi]:null,K=k&&u.elevationFeatureIdToIndex?u.elevationFeatureIdToIndex.get(k):65535,ee=(me,De,it)=>{if(De.x<0||De.x>=sn||De.y<0||De.y>=sn)return;let yt=null;if(Le){const{x:ct,y:ut,z:Ct}=q.projectTilePoint(De.x,De.y,it);yt={anchor:new wc(ct,ut,Ct,0,void 0),up:q.upVector(it,De.x,De.y)}}(function(ct,ut,Ct,mn,tn,Qt,Je,rt,lt,kt,Zt,On,An,Yn,Ce,Me,wt,Wt,un,hn,En,Zn,xi,wi,ci,nr,Ar,Ti,is){const Pr=ct.addToLineVertexArray(ut,mn);let Ji,Es,zr,Cr,kr,sr,hi,hr=0,rs=0,qn=0,Pi=0,Br=-1,ms=-1;const Ur={};let lo=Kh("");const gr=Ct?Ct.anchor:ut,Ks=Ti!=="none";let Dc=0,ka=0;if(lt._unevaluatedLayout.getValue("text-radial-offset")===void 0){const co=lt.layout.get("text-offset").evaluate(En,{},ci);Dc=co[0]*xs,ka=co[1]*xs}else Dc=lt.layout.get("text-radial-offset").evaluate(En,{},ci)*xs,ka=Qy;if(ct.allowVerticalPlacement&&tn.vertical){const co=tn.vertical;if(Ce)sr=Jy(co),rt&&(hi=Jy(rt));else{const Do=lt.layout.get("text-rotate").evaluate(En,{},ci)+90;zr=tp(kt,gr,ut,Zt,On,An,co,Yn,Do,Me),rt&&(Cr=tp(kt,gr,ut,Zt,On,An,rt,Wt,Do))}}if(Qt){const co=ct.iconSizeData,Do=lt.layout.get("icon-rotate").evaluate(En,{},ci),Na=Zy(Qt,Do,xi,Ks,Zn.iconScaleFactor),Sl=rt?Zy(rt,Do,xi,Ks,Zn.iconScaleFactor):void 0;Es=tp(kt,gr,ut,Zt,On,An,Qt,Wt,Do,null),hr=4*Na.length;let rl=null;co.kind==="source"?(rl=[zu*lt.layout.get("icon-size").evaluate(En,{},ci)*Zn.iconScaleFactor],rl[0]>ep&&ii(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Fu}. Reduce your "icon-size".`)):co.kind==="composite"&&(rl=[zu*Zn.compositeIconSizes[0].evaluate(En,{},ci)*Zn.iconScaleFactor,zu*Zn.compositeIconSizes[1].evaluate(En,{},ci)*Zn.iconScaleFactor],(rl[0]>ep||rl[1]>ep)&&ii(`${ct.layerIds[0]}: Value for "icon-size" is >= ${Fu}. Reduce your "icon-size".`)),ct.addSymbols(ct.icon,Na,rl,hn,un,En,void 0,Ct,ut,Pr.lineStartIndex,Pr.lineLength,-1,wi,ci,nr,Ar),Br=ct.icon.placedSymbolArray.length-1,Sl&&(rs=4*Sl.length,ct.addSymbols(ct.icon,Sl,rl,hn,un,En,Oa.vertical,Ct,ut,Pr.lineStartIndex,Pr.lineLength,-1,wi,ci,nr,Ar),ms=ct.icon.placedSymbolArray.length-1)}for(const co in tn.horizontal){const Do=co,Na=tn.horizontal[Do];Ji||(lo=Kh(Na.text),Ce?kr=Jy(Na):Ji=tp(kt,gr,ut,Zt,On,An,Na,Yn,lt.layout.get("text-rotate").evaluate(En,{},ci),Me));const Sl=Na.positionedLines.length===1;if(qn+=B1(ct,Ct,ut,Na,Je,lt,Ce,En,Me,Pr,tn.vertical?Oa.horizontal:Oa.horizontalOnly,Sl?gD(tn.horizontal):[Do],Ur,Br,Zn,wi,ci,nr),Sl)break}tn.vertical&&(Pi+=B1(ct,Ct,ut,tn.vertical,Je,lt,Ce,En,Me,Pr,Oa.vertical,["vertical"],Ur,ms,Zn,wi,ci,nr));let pa=-1;const Rc=(co,Do)=>co?Math.max(co,Do):Do;pa=Rc(kr,pa),pa=Rc(sr,pa),pa=Rc(hi,pa);const Sm=pa>-1?1:0;ct.glyphOffsetArray.length>=65535&&ii("Too many glyphs being rendered in a tile. See https://github.com/mapbox/mapbox-gl-js/issues/2907"),En.sortKey!==void 0&&ct.addToSortKeyRanges(ct.symbolInstances.length,En.sortKey),ct.symbolInstances.emplaceBack(ut.x,ut.y,gr.x,gr.y,gr.z,Ur.right>=0?Ur.right:-1,Ur.center>=0?Ur.center:-1,Ur.left>=0?Ur.left:-1,Ur.vertical>=0?Ur.vertical:-1,Br,ms,lo,Ji!==void 0?Ji:ct.collisionBoxArray.length,Ji!==void 0?Ji+1:ct.collisionBoxArray.length,zr!==void 0?zr:ct.collisionBoxArray.length,zr!==void 0?zr+1:ct.collisionBoxArray.length,Es!==void 0?Es:ct.collisionBoxArray.length,Es!==void 0?Es+1:ct.collisionBoxArray.length,Cr||ct.collisionBoxArray.length,Cr?Cr+1:ct.collisionBoxArray.length,Zt,qn,Pi,hr,rs,Sm,0,Dc,ka,pa,0,Ks?1:0,is)})(u,De,yt,me,l,p,b,g,u.layers[0],u.collisionBoxArray,i.index,i.sourceLayerIndex,u.index,dt,Se,O,0,a,v,he,i,x,L,B,U,Y,ne,ae,K)};if(Ae==="line")for(const me of T1(i.geometry,0,0,sn,sn)){const De=qy(me,st,h,l.vertical||Oe,p,nt,Qe,u.overscaling,sn);for(const it of De)Oe&&ev(u,Oe.text,S,it)||ee(me,it,U)}else if(Ae==="line-center"){for(const me of i.geometry)if(me.length>1){const De=da(me,h,l.vertical||Oe,p,nt,Qe);De&&ee(me,De,U)}}else if(i.type==="Polygon")for(const me of ei(i.geometry,0)){const De=L1(me,16);ee(me[0],new wc(De.x,De.y,0,0,void 0),U)}else if(i.type==="LineString")for(const me of i.geometry)ee(me,new wc(me[0].x,me[0].y,0,0,void 0),U);else if(i.type==="Point")for(const me of i.geometry)for(const De of me)ee([De],new wc(De.x,De.y,0,0,void 0),U)}const Fu=255,ep=Fu*zu;function B1(u,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae,he){const Se=function(ye,Oe,Le,nt,Qe,st,dt,a){const h=[];if(Oe.positionedLines.length===0)return h;const v=nt.layout.get("text-rotate").evaluate(st,{})*Math.PI/180,S=function(me){const De=me[0],it=me[1],yt=De*it;return yt>0?[De,-it]:yt<0?[-De,it]:De===0?[it,De]:[it,-De]}(Le);let I=Math.abs(Oe.top-Oe.bottom);for(const me of Oe.positionedLines)I-=me.lineOffset;const k=Oe.positionedLines.length,K=I/k;let ee=Oe.top-Le[1];for(let me=0;me<k;++me){const De=Oe.positionedLines[me];ee=Gg(Oe,K,ee,me);for(const it of De.positionedGlyphs){if(!it.rect)continue;const yt=it.rect||{};let ct=Gy+1,ut=!0,Ct=1,mn=0;if(it.image){const En=dt.get(it.image.toString());if(!En)continue;if(En.sdf){ii("SDF images are not supported in formatted text and will be ignored.");continue}ut=!1,Ct=En.pixelRatio,ct=Yo/Ct}const tn=(Qe||a)&&it.vertical,Qt=it.metrics.advance*it.scale/2,Je=it.metrics,rt=it.rect;if(rt===null)continue;a&&Oe.verticalizable&&(mn=it.image?Qt-it.metrics.width*it.scale/2:0);const lt=Qe?[it.x+Qt,it.y]:[0,0];let kt=[0,0],Zt=[0,0],On=!1;Qe||(tn?(Zt=[it.x+Qt+S[0],it.y+S[1]-mn],On=!0):kt=[it.x+Qt+Le[0],it.y+Le[1]-mn]);const An=rt.w*it.scale/(Ct*(it.localGlyph?xl:1)),Yn=rt.h*it.scale/(Ct*(it.localGlyph?xl:1));let Ce,Me,wt,Wt;if(tn){const En=it.y-ee,Zn=new Lt(-Qt,Qt-En),xi=-Math.PI/2,wi=new Lt(...Zt);Ce=new Lt(-Qt+kt[0],kt[1]),Ce._rotateAround(xi,Zn)._add(wi),Ce.x+=-En+Qt,Ce.y-=(Je.left-ct)*it.scale;const ci=it.image?Je.advance*it.scale:xs*it.scale,nr=String.fromCodePoint(it.glyph);cE(nr)?Ce.x+=(1-ct)*it.scale:rm(nr)?Ce.x+=ci-Je.height*it.scale+(-ct-1)*it.scale:Ce.x+=it.image||Je.width+2*ct===rt.w&&Je.height+2*ct===rt.h?(ci-Yn)/2:(ci-(Je.height+2*ct)*it.scale)/2,Me=new Lt(Ce.x,Ce.y-An),wt=new Lt(Ce.x+Yn,Ce.y),Wt=new Lt(Ce.x+Yn,Ce.y-An)}else{const En=(Je.left-ct)*it.scale-Qt+kt[0],Zn=(-Je.top-ct)*it.scale+kt[1],xi=En+An,wi=Zn+Yn;Ce=new Lt(En,Zn),Me=new Lt(xi,Zn),wt=new Lt(En,wi),Wt=new Lt(xi,wi)}if(v){let En;En=Qe?new Lt(0,0):On?new Lt(S[0],S[1]):new Lt(Le[0],Le[1]),Ce._rotateAround(v,En),Me._rotateAround(v,En),wt._rotateAround(v,En),Wt._rotateAround(v,En)}const un=new Lt(0,0),hn=new Lt(0,0);h.push({tl:Ce,tr:Me,bl:wt,br:Wt,texPrimary:yt,texSecondary:void 0,writingMode:Oe.writingMode,glyphOffset:lt,sectionIndex:it.sectionIndex,isSDF:ut,pixelOffsetTL:un,pixelOffsetBR:hn,minFontScaleX:0,minFontScaleY:0})}}return h}(0,p,R,b,x,A,g,u.allowVerticalPlacement),Ae=u.textSizeData;let re=null;Ae.kind==="source"?(re=[zu*b.layout.get("text-size").evaluate(A,{},ae)*Y.textScaleFactor],re[0]>ep&&ii(`${u.layerIds[0]}: Value for "text-size" is >= ${Fu}. Reduce your "text-size".`)):Ae.kind==="composite"&&(re=[zu*Y.compositeTextSizes[0].evaluate(A,{},ae)*Y.textScaleFactor,zu*Y.compositeTextSizes[1].evaluate(A,{},ae)*Y.textScaleFactor],(re[0]>ep||re[1]>ep)&&ii(`${u.layerIds[0]}: Value for "text-size" is >= ${Fu}. Reduce your "text-size".`)),u.addSymbols(u.text,Se,re,R,x,A,L,i,l,O.lineStartIndex,O.lineLength,q,ne,ae,he,!1);for(const ye of B)U[ye]=u.text.placedSymbolArray.length-1;return 4*Se.length}function Tb(u){for(const i in u)return u[i];return null}function tp(u,i,l,p,g,b,x,A,R,O){let L=x.top,B=x.bottom,U=x.left,q=x.right;if(Bh(x)&&x.collisionPadding){const Y=x.collisionPadding;U-=Y[0],L-=Y[1],q+=Y[2],B+=Y[3]}if(R){const Y=new Lt(U,L),ne=new Lt(q,L),ae=new Lt(U,B),he=new Lt(q,B),Se=bi(R);let Ae=new Lt(0,0);O&&(Ae=new Lt(O[0],O[1])),Y._rotateAround(Se,Ae),ne._rotateAround(Se,Ae),ae._rotateAround(Se,Ae),he._rotateAround(Se,Ae),U=Math.min(Y.x,ne.x,ae.x,he.x),q=Math.max(Y.x,ne.x,ae.x,he.x),L=Math.min(Y.y,ne.y,ae.y,he.y),B=Math.max(Y.y,ne.y,ae.y,he.y)}return u.emplaceBack(i.x,i.y,i.z,l.x,l.y,U,L,q,B,A,p,g,b),u.length-1}function Jy(u){Bh(u)&&u.collisionPadding&&(u.top-=u.collisionPadding[1],u.bottom+=u.collisionPadding[3]);const i=u.bottom-u.top;return i>0?Math.max(10,i):null}function ev(u,i,l,p){const g=u.compareText;if(i in g){const b=g[i];for(let x=b.length-1;x>=0;x--)if(p.dist(b[x])<l)return!0}else g[i]=[];return g[i].push(p),!1}function yE(u,i){const l=u.fovAboveCenter,p=u.elevation?u.elevation.getMinElevationBelowMSL()*i:0,g=(u._camera.position[2]*u.worldSize-p)/Math.cos(u._pitch),b=Math.sin(l)*g/Math.sin(Math.max(Math.PI/2-u._pitch-l,.01));let x=Math.sin(u._pitch)*b+g;const A=g*(1/u._horizonShift);if(!u.elevation||u.elevation.exaggeration()===0){let R=Math.max(u.zoom-17,0);u.isOrthographic&&(R/=10),x*=1+R}return Math.min(1.01*x,A)}function tv(u,i){if(!i.isReprojectedInTileSpace)return{scale:1<<u.z,x:u.x,y:u.y,x2:u.x+1,y2:u.y+1,projection:i};const l=Math.pow(2,-u.z),p=u.x*l,g=(u.x+1)*l,b=u.y*l,x=(u.y+1)*l,A=et(p),R=et(g),O=_t(b),L=_t(x),B=i.project(A,O),U=i.project(R,O),q=i.project(R,L),Y=i.project(A,L);let ne=Math.min(B.x,U.x,q.x,Y.x),ae=Math.min(B.y,U.y,q.y,Y.y),he=Math.max(B.x,U.x,q.x,Y.x),Se=Math.max(B.y,U.y,q.y,Y.y);const Ae=l/16;function re(Oe,Le,nt,Qe,st,dt){const a=(nt+st)/2,h=(Qe+dt)/2,v=i.project(et(a),_t(h)),S=Math.max(0,ne-v.x,ae-v.y,v.x-he,v.y-Se);ne=Math.min(ne,v.x),he=Math.max(he,v.x),ae=Math.min(ae,v.y),Se=Math.max(Se,v.y),S>Ae&&(re(Oe,v,nt,Qe,a,h),re(v,Le,a,h,st,dt))}re(B,U,p,b,g,b),re(U,q,g,b,g,x),re(q,Y,g,x,p,x),re(Y,B,p,x,p,b),ne-=Ae,ae-=Ae,he+=Ae,Se+=Ae;const ye=1/Math.max(he-ne,Se-ae);return{scale:ye,x:ne*ye,y:ae*ye,x2:he*ye,y2:Se*ye,projection:i}}function F1(u,{x:i,y:l},p=0){return new Lt(((i-p)*u.scale-u.x)*sn,(l*u.scale-u.y)*sn)}const yD=X(new Float32Array(16));class jl{constructor(i){this.spec=i,this.name=i.name,this.wrap=!1,this.requiresDraping=!1,this.supportsWorldCopies=!1,this.supportsTerrain=!1,this.supportsFog=!1,this.supportsFreeCamera=!1,this.zAxisUnit="meters",this.isReprojectedInTileSpace=!0,this.unsupportedLayers=["custom"],this.center=[0,0],this.range=[3.5,7]}project(i,l){return{x:0,y:0,z:0}}unproject(i,l){return new ge(0,0)}projectTilePoint(i,l,p){return{x:i,y:l,z:0}}locationPoint(i,l,p,g=!0){return i._coordinatePoint(i.locationCoordinate(l,p),g)}pixelsPerMeter(i,l){return We(1,i)*l}pixelSpaceConversion(i,l,p){return 1}farthestPixelDistance(i){return yE(i,i.pixelsPerMeter)}pointCoordinate(i,l,p,g){const b=i.horizonLineFromTop(!1),x=new Lt(l,Math.max(b,p));return i.rayIntersectionCoordinate(i.pointRayIntersection(x,g))}pointCoordinate3D(i,l,p){const g=new Lt(l,p);if(i.elevation)return i.elevation.pointCoordinate(g);{const b=this.pointCoordinate(i,g.x,g.y,0);return[b.x,b.y,b.z]}}isPointAboveHorizon(i,l){if(i.elevation&&i.elevation.visibleDemTiles.length)return!this.pointCoordinate3D(i,l.x,l.y);const p=i.horizonLineFromTop();return l.y<p}createInversionMatrix(i,l){return yD}createTileMatrix(i,l,p){let g,b,x;const A=p.canonical,R=X(new Float64Array(16));if(this.isReprojectedInTileSpace){const O=tv(A,this);g=1,b=O.x+p.wrap*O.scale,x=O.y,Ie(R,R,[g/O.scale,g/O.scale,i.pixelsPerMeter/l])}else g=l/i.zoomScale(A.z),b=(A.x+Math.pow(2,A.z)*p.wrap)*g,x=A.y*g;return we(R,R,[b,x,0]),Ie(R,R,[g/sn,g/sn,1]),R}upVector(i,l,p){return[0,0,1]}upVectorScale(i,l,p){return{metersToTile:1}}}class Qi extends jl{constructor(i){super(i),this.range=[4,7],this.center=i.center||[-96,37.5];const[l,p]=this.parallels=i.parallels||[29.5,45.5],g=Math.sin(bi(l));this.n=(g+Math.sin(bi(p)))/2,this.c=1+g*(2*this.n-g),this.r0=Math.sqrt(this.c)/this.n}project(i,l){const{n:p,c:g,r0:b}=this,x=bi(i-this.center[0]),A=bi(l),R=Math.sqrt(g-2*p*Math.sin(A))/p;return{x:R*Math.sin(x*p),y:R*Math.cos(x*p)-b,z:0}}unproject(i,l){const{n:p,c:g,r0:b}=this,x=b+l;let A=Math.atan2(i,Math.abs(x))*Math.sign(x);x*p<0&&(A-=Math.PI*Math.sign(i)*Math.sign(x));const R=bi(this.center[0])*p;A=bt(A,-Math.PI-R,Math.PI-R);const O=He(gt(A/p)+this.center[0],-180,180),L=Math.asin(He((g-(i*i+x*x)*p*p)/(2*p),-1,1)),B=He(gt(L),-85.051129,Mt);return new ge(O,B)}}const hs=1.340264,ao=-.081106,pm=893e-6,Fd=.003796,Vd=Math.sqrt(3)/2;class V1 extends jl{project(i,l){l=l/180*Math.PI,i=i/180*Math.PI;const p=Math.asin(Vd*Math.sin(l)),g=p*p,b=g*g*g;return{x:.5*(i*Math.cos(p)/(Vd*(hs+3*ao*g+b*(7*pm+9*Fd*g)))/Math.PI+.5),y:1-.5*(p*(hs+ao*g+b*(pm+Fd*g))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,g=p*p,b=g*g*g;for(let L,B,U,q=0;q<12&&(B=p*(hs+ao*g+b*(pm+Fd*g))-l,U=hs+3*ao*g+b*(7*pm+9*Fd*g),L=B/U,p=He(p-L,-Math.PI/3,Math.PI/3),g=p*p,b=g*g*g,!(Math.abs(L)<1e-12));++q);const x=Vd*i*(hs+3*ao*g+b*(7*pm+9*Fd*g))/Math.cos(p),A=Math.asin(Math.sin(p)/Vd),R=He(180*x/Math.PI,-180,180),O=He(180*A/Math.PI,-85.051129,Mt);return new ge(R,O)}}class Eb extends jl{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){return{x:.5+i/360,y:.5-l/360,z:0}}unproject(i,l){const p=360*(i-.5),g=He(360*(.5-l),-85.051129,Mt);return new ge(p,g)}}const Tc=Math.PI/2;function U1(u){return Math.tan((Tc+u)/2)}class FM extends jl{constructor(i){super(i),this.center=i.center||[0,30];const[l,p]=this.parallels=i.parallels||[30,30];let g=bi(l),b=bi(p);this.southernCenter=g+b<0,this.southernCenter&&(g=-g,b=-b);const x=Math.cos(g),A=U1(g);this.n=g===b?Math.sin(g):Math.log(x/Math.cos(b))/Math.log(U1(b)/A),this.f=x*Math.pow(U1(g),this.n)/this.n}project(i,l){l=bi(l),this.southernCenter&&(l=-l),i=bi(i-this.center[0]);const p=1e-6,{n:g,f:b}=this;b>0?l<-Tc+p&&(l=-Tc+p):l>Tc-p&&(l=Tc-p);const x=b/Math.pow(U1(l),g);let A=x*Math.sin(g*i),R=b-x*Math.cos(g*i);return A=.5*(A/Math.PI+.5),R=.5*(R/Math.PI+.5),{x:A,y:this.southernCenter?R:1-R,z:0}}unproject(i,l){i=(2*i-.5)*Math.PI,this.southernCenter&&(l=1-l),l=(2*(1-l)-.5)*Math.PI;const{n:p,f:g}=this,b=g-l,x=Math.sign(b),A=Math.sign(p)*Math.sqrt(i*i+b*b);let R=Math.atan2(i,Math.abs(b))*x;b*p<0&&(R-=Math.PI*Math.sign(i)*x);const O=He(gt(R/p)+this.center[0],-180,180),L=He(gt(2*Math.atan(Math.pow(g/A,1/p))-Tc),-85.051129,Mt);return new ge(O,this.southernCenter?-L:L)}}class en extends jl{constructor(i){super(i),this.wrap=!0,this.supportsWorldCopies=!0,this.supportsTerrain=!0,this.supportsFog=!0,this.supportsFreeCamera=!0,this.isReprojectedInTileSpace=!1,this.unsupportedLayers=[],this.range=null}project(i,l){return{x:je(i),y:Ue(l),z:0}}unproject(i,l){const p=et(i),g=_t(l);return new ge(p,g)}}const mu=bi(Mt);class np extends jl{project(i,l){const p=(l=bi(l))*l,g=p*p;return{x:.5*((i=bi(i))*(.8707-.131979*p+g*(g*(.003971*p-.001529*g)-.013791))/Math.PI+.5),y:1-.5*(l*(1.007226+p*(.015085+g*(.028874*p-.044475-.005916*g)))/Math.PI+1),z:0}}unproject(i,l){i=(2*i-.5)*Math.PI;let p=l=(2*(1-l)-1)*Math.PI,g=25,b=0,x=p*p;do{x=p*p;const O=x*x;b=(p*(1.007226+x*(.015085+O*(.028874*x-.044475-.005916*O)))-l)/(1.007226+x*(.045255+O*(.259866*x-.311325-.005916*11*O))),p=He(p-b,-mu,mu)}while(Math.abs(b)>1e-6&&--g>0);x=p*p;const A=He(gt(i/(.8707+x*(x*(x*x*x*(.003971-.001529*x)-.013791)-.131979))),-180,180),R=gt(p);return new ge(A,R)}}const nv=bi(Mt);class j1 extends jl{project(i,l){l=bi(l),i=bi(i);const p=Math.cos(l),g=2/Math.PI,b=Math.acos(p*Math.cos(i/2)),x=Math.sin(b)/b,A=.5*(i*g+2*p*Math.sin(i/2)/x)||0,R=.5*(l+Math.sin(l)/x)||0;return{x:.5*(A/Math.PI+.5),y:1-.5*(R/Math.PI+1),z:0}}unproject(i,l){let p=i=(2*i-.5)*Math.PI,g=l=(2*(1-l)-1)*Math.PI,b=25;const x=1e-6;let A=0,R=0;do{const O=Math.cos(g),L=Math.sin(g),B=2*L*O,U=L*L,q=O*O,Y=Math.cos(p/2),ne=Math.sin(p/2),ae=2*Y*ne,he=ne*ne,Se=1-q*Y*Y,Ae=Se?1/Se:0,re=Se?Math.acos(O*Y)*Math.sqrt(1/Se):0,ye=.5*(2*re*O*ne+2*p/Math.PI)-i,Oe=.5*(re*L+g)-l,Le=.5*Ae*(q*he+re*O*Y*U)+1/Math.PI,nt=Ae*(ae*B/4-re*L*ne),Qe=.125*Ae*(B*ne-re*L*q*ae),st=.5*Ae*(U*Y+re*he*O)+.5,dt=nt*Qe-st*Le;A=(Oe*nt-ye*st)/dt,R=(ye*Qe-Oe*Le)/dt,p=He(p-A,-Math.PI,Math.PI),g=He(g-R,-nv,nv)}while((Math.abs(A)>x||Math.abs(R)>x)&&--b>0);return new ge(gt(p),gt(g))}}class H1 extends jl{constructor(i){super(i),this.center=i.center||[0,0],this.parallels=i.parallels||[0,0],this.cosPhi=Math.max(.01,Math.cos(bi(this.parallels[0]))),this.scale=1/(2*Math.max(Math.PI*this.cosPhi,1/this.cosPhi)),this.wrap=!0,this.supportsWorldCopies=!0}project(i,l){const{scale:p,cosPhi:g}=this;return{x:bi(i)*g*p+.5,y:-Math.sin(bi(l))/g*p+.5,z:0}}unproject(i,l){const{scale:p,cosPhi:g}=this,b=-(l-.5)/p,x=He(gt((i-.5)/p)/g,-180,180),A=Math.asin(He(b*g,-1,1)),R=He(gt(A),-85.051129,Mt);return new ge(x,R)}}class vD extends en{constructor(i){super(i),this.requiresDraping=!0,this.supportsWorldCopies=!1,this.supportsFog=!0,this.zAxisUnit="pixels",this.unsupportedLayers=["debug"],this.range=[3,5]}projectTilePoint(i,l,p){const g=Oy(i,l,p);return Tn(g,g,i1(Td(p))),{x:g[0],y:g[1],z:g[2]}}locationPoint(i,l,p){const g=se(l.lat,l.lng),b=dn([],g),x=p?i._centerAltitude+p:i.elevation?i.elevation.getAtPointOrZero(i.locationCoordinate(l),i._centerAltitude):i._centerAltitude;Ot(g,g,b,We(1,0)*sn*x);const A=X(new Float64Array(16));return ie(A,i.pixelMatrix,i.globeMatrix),Tn(g,g,A),new Lt(g[0],g[1])}pixelsPerMeter(i,l){return We(1,0)*l}pixelSpaceConversion(i,l,p){const g=We(1,i)*l,b=$n(We(1,45)*l,g,p);return this.pixelsPerMeter(i,l)/b}createTileMatrix(i,l,p){const g=r1(Td(p.canonical));return ie(new Float64Array(16),i.globeMatrix,g)}createInversionMatrix(i,l){const{center:p}=i,g=i1(Td(l));return Ne(g,g,bi(p.lng)),Re(g,g,bi(p.lat)),Ie(g,g,[i._pixelsPerMercatorPixel,i._pixelsPerMercatorPixel,1]),Float32Array.from(g)}pointCoordinate(i,l,p,g){return t1(i,l,p,!0)||new ot(0,0)}pointCoordinate3D(i,l,p){const g=this.pointCoordinate(i,l,p,0);return[g.x,g.y,g.z]}isPointAboveHorizon(i,l){return!t1(i,l.x,l.y,!1)}farthestPixelDistance(i){const l=function(g,b){const x=g.cameraToCenterDistance,A=g._centerAltitude*b,R=g._camera,O=g._camera.forward(),L=St([],Fe([],O,-x),[0,0,A]),B=g.worldSize/(2*Math.PI),U=[0,0,-B],q=g.width/g.height,Y=Math.tan(g.fovAboveCenter),ne=Fe([],R.up(),Y),ae=Fe([],R.right(),Y*q),he=dn([],St([],St([],O,ne),ae)),Se=[];let Ae;if(new Tr(L,he).closestPointOnSphere(U,B,Se)){const re=St([],Se,U),ye=ni([],re,L);Ae=Math.cos(g.fovAboveCenter)*ze(ye)}else{const re=ni([],L,U),ye=ni([],U,L);dn(ye,ye);const Oe=ze(re)-B;Ae=Math.sqrt(Oe*(Oe+2*B));const Le=Math.acos(Ae/(B+Oe))-Math.acos(Ht(O,ye));Ae*=Math.cos(Le)}return 1.01*Ae}(i,this.pixelsPerMeter(i.center.lat,i.worldSize)),p=Mh(i.zoom);if(p>0){const g=yE(i,We(1,i.center.lat)*i.worldSize),b=i.worldSize/(2*Math.PI),x=Math.max(i.width,i.height)/i.worldSize*Math.PI;return $n(l,g+b*(1-Math.cos(x)),Math.pow(p,10))}return l}upVector(i,l,p){return Oy(l,p,i,1)}upVectorScale(i){return{metersToTile:Dy(J0(Td(i)))}}}function $1(u){const i=u.parallels,l=!!i&&Math.abs(i[0]+i[1])<.01;switch(u.name){case"mercator":return new en(u);case"equirectangular":return new Eb(u);case"naturalEarth":return new np(u);case"equalEarth":return new V1(u);case"winkelTripel":return new j1(u);case"albers":return l?new H1(u):new Qi(u);case"lambertConformalConic":return l?new H1(u):new FM(u);case"globe":return new vD(u)}throw new Error(`Invalid projection name: ${u.name}`)}const bD=li.VectorTileFeature.types,Ud=[{name:"a_fade_opacity",components:1,type:"Uint8",offset:0}];function Ec(u,i,l,p,g,b,x,A,R,O,L,B,U){const q=A?Math.min(ep,Math.round(A[0])):0,Y=A?Math.min(ep,Math.round(A[1])):0;u.emplaceBack(i,l,Math.round(32*p),Math.round(32*g),b,x,(q<<1)+(R?1:0),Y,16*O,16*L,256*B,256*U)}function Wg(u,i,l){u.emplaceBack(i,l)}function Sb(u,i,l,p,g,b,x){u.emplaceBack(i,l,p,g,b,x)}const iv=(u,i,l,p)=>{for(let g=0;g<i;g++)u.emplaceBack(l[0],l[1],l[2],p[0],p[1],p[2])};function Ab(u,i,l,p,g){u.emplaceBack(i,l,p,g),u.emplaceBack(i,l,p,g),u.emplaceBack(i,l,p,g),u.emplaceBack(i,l,p,g)}function xD(u){for(const i of u.sections)if(qx(i.text))return!0;return!1}class G1{constructor(i){this.layoutVertexArray=new If,this.indexArray=new mo,this.programConfigurations=i,this.segments=new Yr,this.dynamicLayoutVertexArray=new Eo,this.opacityVertexArray=new pl,this.placedSymbolArray=new oo,this.iconTransitioningVertexArray=new Eh,this.globeExtVertexArray=new qo,this.zOffsetVertexArray=new fd,this.orientationVertexArray=new md}isEmpty(){return this.layoutVertexArray.length===0&&this.indexArray.length===0&&this.dynamicLayoutVertexArray.length===0&&this.opacityVertexArray.length===0&&this.iconTransitioningVertexArray.length===0}upload(i,l,p,g,b){this.isEmpty()||(p&&(this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,rD.members),this.indexBuffer=i.createIndexBuffer(this.indexArray,l),this.dynamicLayoutVertexBuffer=i.createVertexBuffer(this.dynamicLayoutVertexArray,LM.members,!0),this.opacityVertexBuffer=i.createVertexBuffer(this.opacityVertexArray,Ud,!0),this.iconTransitioningVertexArray.length>0&&(this.iconTransitioningVertexBuffer=i.createVertexBuffer(this.iconTransitioningVertexArray,oD.members,!0)),this.globeExtVertexArray.length>0&&(this.globeExtVertexBuffer=i.createVertexBuffer(this.globeExtVertexArray,sD.members,!0)),!this.zOffsetVertexBuffer&&(this.zOffsetVertexArray.length>0||b)&&(this.zOffsetVertexBuffer=i.createVertexBuffer(this.zOffsetVertexArray,zM.members,!0)),!this.orientationVertexBuffer&&this.orientationVertexArray&&this.orientationVertexArray.length>0&&(this.orientationVertexBuffer=i.createVertexBuffer(this.orientationVertexArray,BM.members,!0)),this.opacityVertexBuffer.itemSize=1),(p||g)&&this.programConfigurations.upload(i))}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.programConfigurations.destroy(),this.segments.destroy(),this.dynamicLayoutVertexBuffer.destroy(),this.opacityVertexBuffer.destroy(),this.iconTransitioningVertexBuffer&&this.iconTransitioningVertexBuffer.destroy(),this.globeExtVertexBuffer&&this.globeExtVertexBuffer.destroy(),this.zOffsetVertexBuffer&&this.zOffsetVertexBuffer.destroy(),this.orientationVertexBuffer&&this.orientationVertexBuffer.destroy())}}vn(G1,"SymbolBuffers");class Cb{constructor(i,l,p){this.layoutVertexArray=new i,this.layoutAttributes=l,this.indexArray=new p,this.segments=new Yr,this.collisionVertexArray=new Mf,this.collisionVertexArrayExt=new Eo}upload(i){this.layoutVertexBuffer=i.createVertexBuffer(this.layoutVertexArray,this.layoutAttributes),this.indexBuffer=i.createIndexBuffer(this.indexArray),this.collisionVertexBuffer=i.createVertexBuffer(this.collisionVertexArray,aD.members,!0),this.collisionVertexBufferExt=i.createVertexBuffer(this.collisionVertexArrayExt,lE.members,!0)}destroy(){this.layoutVertexBuffer&&(this.layoutVertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy(),this.collisionVertexBuffer.destroy(),this.collisionVertexBufferExt.destroy())}}vn(Cb,"CollisionBuffers");class Db{constructor(i){this.collisionBoxArray=i.collisionBoxArray,this.zoom=i.zoom,this.lut=i.lut,this.overscaling=i.overscaling,this.layers=i.layers,this.layerIds=this.layers.map(x=>x.fqid),this.index=i.index,this.pixelRatio=i.pixelRatio,this.sourceLayerIndex=i.sourceLayerIndex,this.hasPattern=!1,this.hasRTLText=!1,this.fullyClipped=!1,this.hasAnyIconTextFit=!1,this.sortKeyRanges=[],this.collisionCircleArray=[],this.placementInvProjMatrix=X([]),this.placementViewportMatrix=X([]);const l=this.layers[0]._unevaluatedLayout._values;this.worldview=i.worldview,this.textSizeData=M1(this.zoom,l["text-size"],this.worldview),this.iconSizeData=M1(this.zoom,l["icon-size"],this.worldview);const p=this.layers[0].layout,g=p.get("symbol-sort-key"),b=p.get("symbol-z-order");this.canOverlap=p.get("text-allow-overlap")||p.get("icon-allow-overlap")||p.get("text-ignore-placement")||p.get("icon-ignore-placement"),this.sortFeaturesByKey=b!=="viewport-y"&&g.constantOr(1)!==void 0,this.sortFeaturesByY=(b==="viewport-y"||b==="auto"&&!this.sortFeaturesByKey)&&this.canOverlap,this.writingModes=p.get("text-writing-mode").map(x=>Oa[x]),this.stateDependentLayerIds=this.layers.filter(x=>x.isStateDependent()).map(x=>x.id),this.sourceID=i.sourceID,this.projection=i.projection,this.hasAnyZOffset=!1,this.zOffsetSortDirty=!1,this.zOffsetBuffersNeedUpload=!1,this.elevationType="none",this.elevationStateComplete=!1,this.activeReplacements=[],this.replacementUpdateTime=0}createArrays(){this.text=new G1(new _(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("text")||i.startsWith("symbol"))),this.icon=new G1(new _(this.layers,{zoom:this.zoom,lut:this.lut},i=>i.startsWith("icon")||i.startsWith("symbol"))),this.glyphOffsetArray=new W0,this.lineVertexArray=new Rh,this.symbolInstances=new q0}calculateGlyphDependencies(i,l,p,g,b){for(const x of i){const A=x.codePointAt(0);if(A===void 0)break;if(l[A]=!0,g&&b&&A<=65535){const R=kd[x];R&&(l[R.charCodeAt(0)]=!0)}}}updateFootprints(i,l){}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);return!ub(this.activeReplacements,p)&&(this.activeReplacements=p,!0)}populate(i,l,p,g){const b=this.layers[0],x=b.layout,A=this.projection.name==="globe",R=x.get("text-font"),O=x.get("text-field"),L=x.get("icon-image"),[B,U]=x.get("icon-size-scale-range"),q=He(l.scaleFactor||1,B,U),Y=(O.value.kind!=="constant"||O.value.value instanceof $t&&!O.value.value.isEmpty()||O.value.value.toString().length>0)&&(R.value.kind!=="constant"||R.value.value.length>0),ne=L.value.kind!=="constant"||!!L.value.value||Object.keys(L.parameters).length>0,ae=x.get("symbol-sort-key");if(this.features=[],!Y&&!ne)return;const he=l.iconDependencies,Se=l.glyphDependencies,Ae=l.availableImages,re=new $i(this.zoom,{worldview:this.worldview});for(const{feature:ye,id:Oe,index:Le,sourceLayerIndex:nt}of i){const Qe=b._featureFilter.needGeometry,st=pn(ye,Qe);if(!b._featureFilter.filter(re,st,p))continue;if(Qe||(st.geometry=fn(ye,p,g)),A&&ye.type!==1&&p.z<=5){const S=st.geometry,I=.98078528056,k=(K,ee)=>Ht(Oy(K.x,K.y,p,1),Oy(ee.x,ee.y,p,1))<I;for(let K=0;K<S.length;K++)S[K]=Yt(S[K],k)}let dt,a;if(Y){const S=b.getValueAndResolveTokens("text-field",st,p,Ae),I=$t.factory(S);xD(I)&&(this.hasRTLText=!0),(!this.hasRTLText||cd()==="unavailable"||this.hasRTLText&&nu.isParsed())&&(dt=Lu(I,b,st))}if(ne){const S=b.getValueAndResolveTokens("icon-image",st,p,Ae);a=typeof S=="string"?Hi.build(S):S}if(!dt&&!a)continue;const h=this.sortFeaturesByKey?ae.evaluate(st,{},p):void 0,v={id:Oe,text:dt,icon:a,index:Le,sourceLayerIndex:nt,geometry:st.geometry,properties:ye.properties,type:bD[ye.type],sortKey:h};if(this.features.push(v),a){const S=this.layers[0]._unevaluatedLayout._values,{iconPrimary:I,iconSecondary:k}=pu(a,this.iconSizeData,S["icon-size"],p,this.zoom,v,this.pixelRatio,q,this.worldview),K=I.id.toString();if(he.has(K)?he.get(K).push(I):he.set(K,[I]),k){const ee=k.id.toString();he.has(ee)?he.get(ee).push(k):he.set(ee,[k])}}if(dt){const S=R.evaluate(st,{},p).join(","),I=x.get("text-rotation-alignment")==="map"&&x.get("symbol-placement")!=="point";this.allowVerticalPlacement=this.writingModes&&this.writingModes.indexOf(Oa.vertical)>=0;for(const k of dt.sections)if(k.image){const K=k.image.getPrimary().scaleSelf(this.pixelRatio),ee=K.id.toString(),me=he.get(ee)||[];me.push(K),he.set(ee,me)}else{const K=Sf(dt.toString()),ee=k.fontStack||S,me=Se[ee]=Se[ee]||{};this.calculateGlyphDependencies(k.text,me,I,this.allowVerticalPlacement,K)}}}if(x.get("symbol-placement")==="line"&&(this.features=function(ye){const Oe={},Le={},nt=[];let Qe=0;function st(v){nt.push(ye[v]),Qe++}function dt(v,S,I){const k=Le[v];return delete Le[v],Le[S]=k,nt[k].geometry[0].pop(),nt[k].geometry[0]=nt[k].geometry[0].concat(I[0]),k}function a(v,S,I){const k=Oe[S];return delete Oe[S],Oe[v]=k,nt[k].geometry[0].shift(),nt[k].geometry[0]=I[0].concat(nt[k].geometry[0]),k}function h(v,S,I){const k=I?S[0][S[0].length-1]:S[0][0];return`${v}:${k.x}:${k.y}`}for(let v=0;v<ye.length;v++){const S=ye[v],I=S.geometry,k=S.text?S.text.toString():null;if(!k){st(v);continue}const K=h(k,I),ee=h(k,I,!0);if(K in Le&&ee in Oe&&Le[K]!==Oe[ee]){const me=a(K,ee,I),De=dt(K,ee,nt[me].geometry);delete Oe[K],delete Le[ee],Le[h(k,nt[De].geometry,!0)]=De,nt[me].geometry=null}else K in Le?dt(K,ee,I):ee in Oe?a(K,ee,I):(st(v),Oe[K]=Qe-1,Le[ee]=Qe-1)}return nt.filter(v=>v.geometry)}(this.features)),x.get("symbol-elevation-reference")==="hd-road-markup"){if(this.elevationType="road",l.elevationFeatures){!this.elevationFeatures&&l.elevationFeatures.length>0&&(this.elevationFeatures=[],this.elevationFeatureIdToIndex=new Map);for(const ye of l.elevationFeatures)this.elevationFeatureIdToIndex.set(ye.id,this.elevationFeatures.length),this.elevationFeatures.push(ye)}}else x.get("symbol-z-elevate")&&(this.elevationType="offset");this.elevationType!=="none"&&(this.zOffsetBuffersNeedUpload=!0),this.sortFeaturesByKey&&this.features.sort((ye,Oe)=>ye.sortKey-Oe.sortKey)}update(i,l,p,g,b,x,A){this.text.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,this.worldview),this.icon.programConfigurations.updatePaintArrays(i,l,b,p,g,x,A,this.worldview)}updateRoadElevation(i){if(this.elevationType!=="road"||!this.elevationFeatures||this.elevationStateComplete)return;this.elevationStateComplete=!0,this.hasAnyZOffset=!1;let l=!1;const p=Dt(i),g=1/p;let b=!1,x=!1;for(let A=0;A<this.symbolInstances.length;A++){const R=this.symbolInstances.get(A),O=zt(1,0,0),L=zt(0,1,0),{numHorizontalGlyphVertices:B,numVerticalGlyphVertices:U,numIconVertices:q,numVerticalIconVertices:Y}=R,ne=B>0||U>0,ae=q>0,he=this.elevationFeatures[R.elevationFeatureIndex];if(he){const Se=new Lt(R.tileAnchorX,R.tileAnchorY),Ae=.075+he.pointElevation(Se);R.zOffset!==Ae&&(l=!0,R.zOffset=Ae);const re=he.computeSlopeNormal(Se,g),ye=jo(ti(),zt(0,0,1),re);Kn(O,O,ye),Kn(L,L,ye),O[2]*=p,L[2]*=p,O[0]===1&&O[1]===0&&O[2]===0&&L[0]===0&&L[1]===1&&L[2]===0||(b=b||ne,x=x||ae)}if(ne&&(iv(this.text.orientationVertexArray,B,O,L),iv(this.text.orientationVertexArray,U,O,L)),ae){const{placedIconSymbolIndex:Se,verticalPlacedIconSymbolIndex:Ae}=R;Se>=0&&iv(this.icon.orientationVertexArray,q,O,L),Ae>=0&&iv(this.icon.orientationVertexArray,Y,O,L)}}b||(this.text.orientationVertexArray=void 0),x||(this.icon.orientationVertexArray=void 0),l&&(this.zOffsetBuffersNeedUpload=!0,this.zOffsetSortDirty=!0)}updateZOffset(){const i=(b,x,A)=>{p+=x,p>b.length&&b.resize(p);for(let R=-x;R<0;R++)b.emplace(R+p,A)},l=(b,x,A)=>{g+=x,g>b.length&&b.resize(g);for(let R=-x;R<0;R++)b.emplace(R+g,A)};if(!this.zOffsetBuffersNeedUpload)return;this.zOffsetBuffersNeedUpload=!1;let p=0,g=0;for(let b=0;b<this.symbolInstances.length;b++){const x=this.symbolInstances.get(b),{numHorizontalGlyphVertices:A,numVerticalGlyphVertices:R,numIconVertices:O}=x,L=x.zOffset,B=O>0;if((A>0||R>0)&&(i(this.text.zOffsetVertexArray,A,L),i(this.text.zOffsetVertexArray,R,L)),B){const{placedIconSymbolIndex:U,verticalPlacedIconSymbolIndex:q}=x;U>=0&&l(this.icon.zOffsetVertexArray,O,L),q>=0&&l(this.icon.zOffsetVertexArray,x.numVerticalIconVertices,L)}}this.text.zOffsetVertexBuffer&&this.text.zOffsetVertexBuffer.updateData(this.text.zOffsetVertexArray),this.icon.zOffsetVertexBuffer&&this.icon.zOffsetVertexBuffer.updateData(this.icon.zOffsetVertexArray)}isEmpty(){return this.symbolInstances.length===0&&!this.hasRTLText}uploadPending(){return!this.uploaded||this.text.programConfigurations.needsUpload||this.icon.programConfigurations.needsUpload}upload(i){!this.uploaded&&this.hasDebugData()&&(this.textCollisionBox.upload(i),this.iconCollisionBox.upload(i)),this.text.upload(i,this.sortFeaturesByY,!this.uploaded,this.text.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.icon.upload(i,this.sortFeaturesByY,!this.uploaded,this.icon.programConfigurations.needsUpload,this.zOffsetBuffersNeedUpload),this.uploaded=!0}destroyDebugData(){this.textCollisionBox.destroy(),this.iconCollisionBox.destroy()}getProjection(){return this.projectionInstance||(this.projectionInstance=$1(this.projection)),this.projectionInstance}destroy(){this.text.destroy(),this.icon.destroy(),this.hasDebugData()&&this.destroyDebugData()}addToLineVertexArray(i,l){const p=this.lineVertexArray.length;if(i.segment!==void 0)for(const{x:g,y:b}of l)this.lineVertexArray.emplaceBack(g,b);return{lineStartIndex:p,lineLength:this.lineVertexArray.length-p}}addSymbols(i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne,ae){const he=i.indexArray,Se=i.layoutVertexArray,Ae=i.globeExtVertexArray,re=i.segments.prepareSegment(4*l.length,Se,he,this.canOverlap?x.sortKey:void 0),ye=this.glyphOffsetArray.length,Oe=re.vertexLength,Le=this.allowVerticalPlacement&&A===Oa.vertical?Math.PI/2:0,nt=x.text&&x.text.sections;for(let st=0;st<l.length;st++){const{tl:dt,tr:a,bl:h,br:v,texPrimary:S,texSecondary:I,pixelOffsetTL:k,pixelOffsetBR:K,minFontScaleX:ee,minFontScaleY:me,glyphOffset:De,isSDF:it,sectionIndex:yt}=l[st],ct=re.vertexLength,ut=De[1];if(Ec(Se,O.x,O.y,dt.x,ut+dt.y,S.x,S.y,p,it,k.x,k.y,ee,me),Ec(Se,O.x,O.y,a.x,ut+a.y,S.x+S.w,S.y,p,it,K.x,k.y,ee,me),Ec(Se,O.x,O.y,h.x,ut+h.y,S.x,S.y+S.h,p,it,k.x,K.y,ee,me),Ec(Se,O.x,O.y,v.x,ut+v.y,S.x+S.w,S.y+S.h,p,it,K.x,K.y,ee,me),R){const{x:Ct,y:mn,z:tn}=R.anchor,[Qt,Je,rt]=R.up;Sb(Ae,Ct,mn,tn,Qt,Je,rt),Sb(Ae,Ct,mn,tn,Qt,Je,rt),Sb(Ae,Ct,mn,tn,Qt,Je,rt),Sb(Ae,Ct,mn,tn,Qt,Je,rt),Ab(i.dynamicLayoutVertexArray,Ct,mn,tn,Le)}else Ab(i.dynamicLayoutVertexArray,O.x,O.y,O.z,Le);if(ae){const Ct=I||S;Wg(i.iconTransitioningVertexArray,Ct.x,Ct.y),Wg(i.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y),Wg(i.iconTransitioningVertexArray,Ct.x,Ct.y+Ct.h),Wg(i.iconTransitioningVertexArray,Ct.x+Ct.w,Ct.y+Ct.h)}he.emplaceBack(ct,ct+1,ct+2),he.emplaceBack(ct+1,ct+2,ct+3),re.vertexLength+=4,re.primitiveLength+=2,this.glyphOffsetArray.emplaceBack(De[0]),st!==l.length-1&&yt===l[st+1].sectionIndex||i.programConfigurations.populatePaintArrays(Se.length,x,x.index,{},q,Y,ne,nt&&nt[yt],this.worldview)}const Qe=R?R.anchor:O;i.placedSymbolArray.emplaceBack(Qe.x,Qe.y,Qe.z,O.x,O.y,ye,this.glyphOffsetArray.length-ye,Oe,L,B,O.segment,p?p[0]:0,p?p[1]:0,g[0],g[1],A,0,0,0,U,0)}_commitLayoutVertex(i,l,p,g,b,x,A){i.emplaceBack(l,p,g,b,x,Math.round(A.x),Math.round(A.y))}_addCollisionDebugVertices(i,l,p,g,b,x,A){const R=p.segments.prepareSegment(4,p.layoutVertexArray,p.indexArray),O=R.vertexLength,L=A.tileAnchorX,B=A.tileAnchorY;for(let q=0;q<4;q++)p.collisionVertexArray.emplaceBack(0,0,0,0,0,0);this._commitDebugCollisionVertexUpdate(p.collisionVertexArrayExt,l,i.padding,A.zOffset),this._commitLayoutVertex(p.layoutVertexArray,g,b,x,L,B,new Lt(i.x1,i.y1)),this._commitLayoutVertex(p.layoutVertexArray,g,b,x,L,B,new Lt(i.x2,i.y1)),this._commitLayoutVertex(p.layoutVertexArray,g,b,x,L,B,new Lt(i.x2,i.y2)),this._commitLayoutVertex(p.layoutVertexArray,g,b,x,L,B,new Lt(i.x1,i.y2)),R.vertexLength+=4;const U=p.indexArray;U.emplaceBack(O,O+1),U.emplaceBack(O+1,O+2),U.emplaceBack(O+2,O+3),U.emplaceBack(O+3,O),R.primitiveLength+=4}_addTextDebugCollisionBoxes(i,l,p,g,b,x){for(let A=g;A<b;A++){const R=p.get(A),O=this.getSymbolInstanceTextSize(i,x,l,A);this._addCollisionDebugVertices(R,O,this.textCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,x)}}_addIconDebugCollisionBoxes(i,l,p,g,b,x){for(let A=g;A<b;A++){const R=p.get(A),O=this.getSymbolInstanceIconSize(i,l,x.placedIconSymbolIndex);this._addCollisionDebugVertices(R,O,this.iconCollisionBox,R.projectedAnchorX,R.projectedAnchorY,R.projectedAnchorZ,x)}}generateCollisionDebugBuffers(i,l,p){this.hasDebugData()&&this.destroyDebugData(),this.textCollisionBox=new Cb(Tg,R1.members,Eh),this.iconCollisionBox=new Cb(Tg,R1.members,Eh);const g=lm(this.iconSizeData,i),b=lm(this.textSizeData,i,p);for(let x=0;x<this.symbolInstances.length;x++){const A=this.symbolInstances.get(x);this._addTextDebugCollisionBoxes(b,i,l,A.textBoxStartIndex,A.textBoxEndIndex,A),this._addTextDebugCollisionBoxes(b,i,l,A.verticalTextBoxStartIndex,A.verticalTextBoxEndIndex,A),this._addIconDebugCollisionBoxes(g,i,l,A.iconBoxStartIndex,A.iconBoxEndIndex,A),this._addIconDebugCollisionBoxes(g,i,l,A.verticalIconBoxStartIndex,A.verticalIconBoxEndIndex,A)}}getSymbolInstanceTextSize(i,l,p,g){const b=this.text.placedSymbolArray.get(l.rightJustifiedTextSymbolIndex>=0?l.rightJustifiedTextSymbolIndex:l.centerJustifiedTextSymbolIndex>=0?l.centerJustifiedTextSymbolIndex:l.leftJustifiedTextSymbolIndex>=0?l.leftJustifiedTextSymbolIndex:l.verticalPlacedTextSymbolIndex>=0?l.verticalPlacedTextSymbolIndex:g),x=P1(this.textSizeData,i,b)/xs;return this.tilePixelRatio*x}getSymbolInstanceIconSize(i,l,p){const g=this.icon.placedSymbolArray.get(p),b=P1(this.iconSizeData,i,g);return this.tilePixelRatio*b}_commitDebugCollisionVertexUpdate(i,l,p,g){i.emplaceBack(l,-p,-p,g),i.emplaceBack(l,p,-p,g),i.emplaceBack(l,p,p,g),i.emplaceBack(l,-p,p,g)}_updateTextDebugCollisionBoxes(i,l,p,g,b,x,A){for(let R=g;R<b;R++){const O=p.get(R),L=this.getSymbolInstanceTextSize(i,x,l,R);this._commitDebugCollisionVertexUpdate(this.textCollisionBox.collisionVertexArrayExt,L,O.padding,x.zOffset)}}_updateIconDebugCollisionBoxes(i,l,p,g,b,x,A){for(let R=g;R<b;R++){const O=p.get(R),L=this.getSymbolInstanceIconSize(i,l,x.placedIconSymbolIndex);this._commitDebugCollisionVertexUpdate(this.iconCollisionBox.collisionVertexArrayExt,L,O.padding,x.zOffset)}}updateCollisionDebugBuffers(i,l,p,g){if(!this.hasDebugData())return;this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexArrayExt.clear(),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexArrayExt.clear();const b=lm(this.iconSizeData,i,g),x=lm(this.textSizeData,i,p);for(let A=0;A<this.symbolInstances.length;A++){const R=this.symbolInstances.get(A);this._updateTextDebugCollisionBoxes(x,i,l,R.textBoxStartIndex,R.textBoxEndIndex,R,p),this._updateTextDebugCollisionBoxes(x,i,l,R.verticalTextBoxStartIndex,R.verticalTextBoxEndIndex,R,p),this._updateIconDebugCollisionBoxes(b,i,l,R.iconBoxStartIndex,R.iconBoxEndIndex,R,g),this._updateIconDebugCollisionBoxes(b,i,l,R.verticalIconBoxStartIndex,R.verticalIconBoxEndIndex,R,g)}this.hasTextCollisionBoxData()&&this.textCollisionBox.collisionVertexBufferExt&&this.textCollisionBox.collisionVertexBufferExt.updateData(this.textCollisionBox.collisionVertexArrayExt),this.hasIconCollisionBoxData()&&this.iconCollisionBox.collisionVertexBufferExt&&this.iconCollisionBox.collisionVertexBufferExt.updateData(this.iconCollisionBox.collisionVertexArrayExt)}_deserializeCollisionBoxesForSymbol(i,l,p,g,b,x,A,R,O){const L={};if(l<p){const{x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re,featureIndex:ye}=i.get(l);L.textBox={x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re},L.textFeatureIndex=ye}if(g<b){const{x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re,featureIndex:ye}=i.get(g);L.verticalTextBox={x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re},L.verticalTextFeatureIndex=ye}if(x<A){const{x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re,featureIndex:ye}=i.get(x);L.iconBox={x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re},L.iconFeatureIndex=ye}if(R<O){const{x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re,featureIndex:ye}=i.get(R);L.verticalIconBox={x1:B,y1:U,x2:q,y2:Y,padding:ne,projectedAnchorX:ae,projectedAnchorY:he,projectedAnchorZ:Se,tileAnchorX:Ae,tileAnchorY:re},L.verticalIconFeatureIndex=ye}return L}deserializeCollisionBoxes(i){this.collisionArrays=[];for(let l=0;l<this.symbolInstances.length;l++){const p=this.symbolInstances.get(l);this.collisionArrays.push(this._deserializeCollisionBoxesForSymbol(i,p.textBoxStartIndex,p.textBoxEndIndex,p.verticalTextBoxStartIndex,p.verticalTextBoxEndIndex,p.iconBoxStartIndex,p.iconBoxEndIndex,p.verticalIconBoxStartIndex,p.verticalIconBoxEndIndex))}}hasTextData(){return this.text.segments.get().length>0}hasIconData(){return this.icon.segments.get().length>0}hasDebugData(){return this.textCollisionBox&&this.iconCollisionBox}hasTextCollisionBoxData(){return this.hasDebugData()&&this.textCollisionBox.segments.get().length>0}hasIconCollisionBoxData(){return this.hasDebugData()&&this.iconCollisionBox.segments.get().length>0}hasIconTextFit(){return this.hasAnyIconTextFit}addIndicesForPlacedSymbol(i,l){const p=i.placedSymbolArray.get(l),g=p.vertexStartIndex+4*p.numGlyphs;for(let b=p.vertexStartIndex;b<g;b+=4)i.indexArray.emplaceBack(b,b+1,b+2),i.indexArray.emplaceBack(b+1,b+2,b+3)}getSortedSymbolIndexes(i){if(this.sortedAngle===i&&this.symbolInstanceIndexes!==void 0)return this.symbolInstanceIndexes;const l=Math.sin(i),p=Math.cos(i),g=[],b=[],x=[];for(let A=0;A<this.symbolInstances.length;++A){x.push(A);const R=this.symbolInstances.get(A);g.push(0|Math.round(l*R.tileAnchorX+p*R.tileAnchorY)),b.push(R.featureIndex)}return x.sort((A,R)=>g[A]-g[R]||b[R]-b[A]),x}getSortedIndexesByZOffset(){if(!this.zOffsetSortDirty)return this.symbolInstanceIndexesSortedZOffset;if(!this.symbolInstanceIndexesSortedZOffset){this.symbolInstanceIndexesSortedZOffset=[];for(let i=0;i<this.symbolInstances.length;++i)this.symbolInstanceIndexesSortedZOffset.push(i)}return this.zOffsetSortDirty=!1,this.symbolInstanceIndexesSortedZOffset.sort((i,l)=>this.symbolInstances.get(l).zOffset-this.symbolInstances.get(i).zOffset)}addToSortKeyRanges(i,l){const p=this.sortKeyRanges[this.sortKeyRanges.length-1];p&&p.sortKey===l?p.symbolInstanceEnd=i+1:this.sortKeyRanges.push({sortKey:l,symbolInstanceStart:i,symbolInstanceEnd:i+1})}sortFeatures(i){if(this.sortFeaturesByY&&this.sortedAngle!==i&&!(this.text.segments.get().length>1||this.icon.segments.get().length>1)){this.symbolInstanceIndexes=this.getSortedSymbolIndexes(i),this.sortedAngle=i,this.text.indexArray.clear(),this.icon.indexArray.clear(),this.featureSortOrder=[];for(const l of this.symbolInstanceIndexes){const p=this.symbolInstances.get(l);this.featureSortOrder.push(p.featureIndex);const{rightJustifiedTextSymbolIndex:g,centerJustifiedTextSymbolIndex:b,leftJustifiedTextSymbolIndex:x,verticalPlacedTextSymbolIndex:A,placedIconSymbolIndex:R,verticalPlacedIconSymbolIndex:O}=p;g>=0&&this.addIndicesForPlacedSymbol(this.text,g),b>=0&&b!==g&&this.addIndicesForPlacedSymbol(this.text,b),x>=0&&x!==b&&x!==g&&this.addIndicesForPlacedSymbol(this.text,x),A>=0&&this.addIndicesForPlacedSymbol(this.text,A),R>=0&&this.addIndicesForPlacedSymbol(this.icon,R),O>=0&&this.addIndicesForPlacedSymbol(this.icon,O)}this.text.indexBuffer&&this.text.indexBuffer.updateData(this.text.indexArray),this.icon.indexBuffer&&this.icon.indexBuffer.updateData(this.icon.indexArray)}}}let vE,bE,xE;vn(Db,"SymbolBucket",{omit:["layers","collisionBoxArray","features","compareText"]}),Db.addDynamicAttributes=Ab;class wE{constructor(i){this.type=i.property.overrides?i.property.overrides.runtimeType:Ya,this.defaultValue=i}evaluate(i){if(i.formattedSection){const l=this.defaultValue.property.overrides;if(l&&l.hasOverride(i.formattedSection))return l.getOverride(i.formattedSection)}return i.feature&&i.featureState?this.defaultValue.evaluate(i.feature,i.featureState):this.defaultValue.property.specification.default}eachChild(i){this.defaultValue.isConstant()||i(this.defaultValue.value._styleExpression.expression)}outputDefined(){return!1}serialize(){return null}}vn(wE,"FormatSectionOverride",{omit:["defaultValue"]});const q1=()=>xE||(xE={layout:vE||(vE=new Lr({"symbol-placement":new Gt(pt.layout_symbol["symbol-placement"]),"symbol-spacing":new Gt(pt.layout_symbol["symbol-spacing"]),"symbol-avoid-edges":new Gt(pt.layout_symbol["symbol-avoid-edges"]),"symbol-sort-key":new cn(pt.layout_symbol["symbol-sort-key"]),"symbol-z-order":new Gt(pt.layout_symbol["symbol-z-order"]),"symbol-z-elevate":new Gt(pt.layout_symbol["symbol-z-elevate"]),"symbol-elevation-reference":new Gt(pt.layout_symbol["symbol-elevation-reference"]),"icon-allow-overlap":new Gt(pt.layout_symbol["icon-allow-overlap"]),"icon-ignore-placement":new Gt(pt.layout_symbol["icon-ignore-placement"]),"icon-optional":new Gt(pt.layout_symbol["icon-optional"]),"icon-rotation-alignment":new Gt(pt.layout_symbol["icon-rotation-alignment"]),"icon-size":new cn(pt.layout_symbol["icon-size"]),"icon-size-scale-range":new Gt(pt.layout_symbol["icon-size-scale-range"]),"icon-text-fit":new cn(pt.layout_symbol["icon-text-fit"]),"icon-text-fit-padding":new cn(pt.layout_symbol["icon-text-fit-padding"]),"icon-image":new cn(pt.layout_symbol["icon-image"]),"icon-rotate":new cn(pt.layout_symbol["icon-rotate"]),"icon-padding":new Gt(pt.layout_symbol["icon-padding"]),"icon-keep-upright":new Gt(pt.layout_symbol["icon-keep-upright"]),"icon-offset":new cn(pt.layout_symbol["icon-offset"]),"icon-anchor":new cn(pt.layout_symbol["icon-anchor"]),"icon-pitch-alignment":new Gt(pt.layout_symbol["icon-pitch-alignment"]),"text-pitch-alignment":new Gt(pt.layout_symbol["text-pitch-alignment"]),"text-rotation-alignment":new Gt(pt.layout_symbol["text-rotation-alignment"]),"text-field":new cn(pt.layout_symbol["text-field"]),"text-font":new cn(pt.layout_symbol["text-font"]),"text-size":new cn(pt.layout_symbol["text-size"]),"text-size-scale-range":new Gt(pt.layout_symbol["text-size-scale-range"]),"text-max-width":new cn(pt.layout_symbol["text-max-width"]),"text-line-height":new cn(pt.layout_symbol["text-line-height"]),"text-letter-spacing":new cn(pt.layout_symbol["text-letter-spacing"]),"text-justify":new cn(pt.layout_symbol["text-justify"]),"text-radial-offset":new cn(pt.layout_symbol["text-radial-offset"]),"text-variable-anchor":new Gt(pt.layout_symbol["text-variable-anchor"]),"text-anchor":new cn(pt.layout_symbol["text-anchor"]),"text-max-angle":new Gt(pt.layout_symbol["text-max-angle"]),"text-writing-mode":new Gt(pt.layout_symbol["text-writing-mode"]),"text-rotate":new cn(pt.layout_symbol["text-rotate"]),"text-padding":new Gt(pt.layout_symbol["text-padding"]),"text-keep-upright":new Gt(pt.layout_symbol["text-keep-upright"]),"text-transform":new cn(pt.layout_symbol["text-transform"]),"text-offset":new cn(pt.layout_symbol["text-offset"]),"text-allow-overlap":new Gt(pt.layout_symbol["text-allow-overlap"]),"text-ignore-placement":new Gt(pt.layout_symbol["text-ignore-placement"]),"text-optional":new Gt(pt.layout_symbol["text-optional"]),visibility:new Gt(pt.layout_symbol.visibility)})),paint:bE||(bE=new Lr({"icon-opacity":new cn(pt.paint_symbol["icon-opacity"]),"icon-occlusion-opacity":new cn(pt.paint_symbol["icon-occlusion-opacity"]),"icon-emissive-strength":new cn(pt.paint_symbol["icon-emissive-strength"]),"text-emissive-strength":new cn(pt.paint_symbol["text-emissive-strength"]),"icon-color":new cn(pt.paint_symbol["icon-color"]),"icon-halo-color":new cn(pt.paint_symbol["icon-halo-color"]),"icon-halo-width":new cn(pt.paint_symbol["icon-halo-width"]),"icon-halo-blur":new cn(pt.paint_symbol["icon-halo-blur"]),"icon-translate":new Gt(pt.paint_symbol["icon-translate"]),"icon-translate-anchor":new Gt(pt.paint_symbol["icon-translate-anchor"]),"icon-image-cross-fade":new Gt(pt.paint_symbol["icon-image-cross-fade"]),"text-opacity":new cn(pt.paint_symbol["text-opacity"]),"text-occlusion-opacity":new cn(pt.paint_symbol["text-occlusion-opacity"]),"text-color":new cn(pt.paint_symbol["text-color"],{runtimeType:Fs,getOverride:u=>u.textColor,hasOverride:u=>!!u.textColor}),"text-halo-color":new cn(pt.paint_symbol["text-halo-color"]),"text-halo-width":new cn(pt.paint_symbol["text-halo-width"]),"text-halo-blur":new cn(pt.paint_symbol["text-halo-blur"]),"text-translate":new Gt(pt.paint_symbol["text-translate"]),"text-translate-anchor":new Gt(pt.paint_symbol["text-translate-anchor"]),"icon-color-saturation":new Gt(pt.paint_symbol["icon-color-saturation"]),"icon-color-contrast":new Gt(pt.paint_symbol["icon-color-contrast"]),"icon-color-brightness-min":new Gt(pt.paint_symbol["icon-color-brightness-min"]),"icon-color-brightness-max":new Gt(pt.paint_symbol["icon-color-brightness-max"]),"symbol-z-offset":new cn(pt.paint_symbol["symbol-z-offset"]),"icon-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"icon-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"text-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},xE);class Rb extends ha{constructor(i,l,p,g){super(i,q1(),l,p,g),this._colorAdjustmentMatrix=X([]),this.hasInitialOcclusionOpacityProperties=i.paint!==void 0&&("icon-occlusion-opacity"in i.paint||"text-occlusion-opacity"in i.paint)}recalculate(i,l){super.recalculate(i,l),this.layout.get("icon-rotation-alignment")==="auto"&&(this.layout._values["icon-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-rotation-alignment")==="auto"&&(this.layout._values["text-rotation-alignment"]=this.layout.get("symbol-placement")!=="point"?"map":"viewport"),this.layout.get("text-pitch-alignment")==="auto"&&(this.layout._values["text-pitch-alignment"]=this.layout.get("text-rotation-alignment")),this.layout.get("icon-pitch-alignment")==="auto"&&(this.layout._values["icon-pitch-alignment"]=this.layout.get("icon-rotation-alignment"));const p=this.layout.get("text-writing-mode");if(p){const g=[];for(const b of p)g.indexOf(b)<0&&g.push(b);this.layout._values["text-writing-mode"]=g}else this.layout._values["text-writing-mode"]=this.layout.get("symbol-placement")==="point"?["horizontal"]:["horizontal","vertical"];this._setPaintOverrides()}getColorAdjustmentMatrix(i,l,p,g){return this._saturation===i&&this._contrast===l&&this._brightnessMin===p&&this._brightnessMax===g||(this._colorAdjustmentMatrix=function(b,x,A,R){b=zs(b),x=os(x);const O=J(),L=b/3,B=1-2*L,U=[B,L,L,0,L,B,L,0,L,L,B,0,0,0,0,1],q=.5-.5*x,Y=R-A;return ie(O,[Y,0,0,0,0,Y,0,0,0,0,Y,0,A,A,A,1],[x,0,0,0,0,x,0,0,0,0,x,0,q,q,q,1]),ie(O,O,U),O}(i,l,p,g),this._saturation=i,this._contrast=l,this._brightnessMin=p,this._brightnessMax=g),this._colorAdjustmentMatrix}getValueAndResolveTokens(i,l,p,g){const b=this.layout.get(i).evaluate(l,{},p,g),x=this._unevaluatedLayout._values[i];return x.isDataDriven()||Ef(x.value)||!b?b:function(A,R){return R.replace(/{([^{}]+)}/g,(O,L)=>L in A?String(A[L]):"")}(l.properties,b)}createBucket(i){return new Db(i)}queryRadius(){return 0}queryIntersectsFeature(){return!1}_setPaintOverrides(){for(const i of q1().paint.overridableProperties){if(!Rb.hasPaintOverride(this.layout,i))continue;const l=this.paint.get(i),p=new wE(l),g=new _h(p,l.property.specification,this.scope,this.options);let b=null;b=l.value.kind==="constant"||l.value.kind==="source"?new lc("source",g):new Np("composite",g,l.value.zoomStops,l.value.interpolationType),this.paint._values[i]=new ud(l.property,b,l.parameters)}}_handleOverridablePaintPropertyUpdate(i,l,p){return!(!this.layout||l.isDataDriven()||p.isDataDriven())&&Rb.hasPaintOverride(this.layout,i)}static hasPaintOverride(i,l){const p=i.get("text-field"),g=q1().paint.properties[l];let b=!1;const x=A=>{for(const R of A)if(g.overrides&&g.overrides.hasOverride(R))return void(b=!0)};if(p.value.kind==="constant"&&p.value.value instanceof $t)x(p.value.value.sections);else if(p.value.kind==="source"){const A=O=>{b||(O instanceof Hn&&an(O.value)===Qc?x(O.value.sections):O instanceof rc?x(O.sections):O.eachChild(A))},R=p.value;R._styleExpression&&A(R._styleExpression.expression)}return b}getProgramIds(){return["symbol"]}getDefaultProgramParams(i,l,p){return{config:new Bf(this,{zoom:l,lut:p}),overrideFog:!1}}hasElevation(){return this.layout&&this.layout.get("symbol-elevation-reference")==="hd-road-markup"}}let wD,TE,TD,EE;var jd=Oi([{name:"a_pos",type:"Int16",components:2},{name:"a_texture_pos",type:"Int16",components:2}]);function mm(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.RGBA;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.DEPTH_COMPONENT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.DEPTH_STENCIL;case WebGL2RenderingContext.R8:case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.RED}}function Yg(u){switch(u){case WebGL2RenderingContext.RGBA8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.DEPTH_COMPONENT16:return WebGL2RenderingContext.UNSIGNED_SHORT;case WebGL2RenderingContext.DEPTH24_STENCIL8:return WebGL2RenderingContext.UNSIGNED_INT_24_8;case WebGL2RenderingContext.R8:return WebGL2RenderingContext.UNSIGNED_BYTE;case WebGL2RenderingContext.R32F:return WebGL2RenderingContext.FLOAT}}class rr{constructor(i,l,p,g){this.context=i,this.format=p,this.useMipmap=g&&g.useMipmap,this.texture=i.gl.createTexture(),this.update(l,{premultiply:g&&g.premultiply})}update(i,l){const p=i&&i instanceof HTMLVideoElement&&i.width===0?i.videoWidth:i.width,g=i&&i instanceof HTMLVideoElement&&i.height===0?i.videoHeight:i.height,{context:b}=this,{gl:x}=b,{x:A,y:R}=l&&l.position?l.position:{x:0,y:0},O=A+p,L=R+g;!this.size||this.size[0]===O&&this.size[1]===L||(x.bindTexture(x.TEXTURE_2D,null),x.deleteTexture(this.texture),this.texture=x.createTexture(),this.size=null),x.bindTexture(x.TEXTURE_2D,this.texture),b.pixelStoreUnpackFlipY.set(!1),b.pixelStoreUnpack.set(1),b.pixelStoreUnpackPremultiplyAlpha.set(this.format===x.RGBA8&&(!l||l.premultiply!==!1));const B=i instanceof HTMLImageElement||i instanceof HTMLCanvasElement||i instanceof HTMLVideoElement||i instanceof ImageData||ImageBitmap&&i instanceof ImageBitmap;if(!this.size&&O>0&&L>0){const U=this.useMipmap?Math.floor(Math.log2(Math.max(O,L)))+1:1;x.texStorage2D(x.TEXTURE_2D,U,this.format,O,L),this.size=[O,L]}if(this.size)if(B)x.texSubImage2D(x.TEXTURE_2D,0,A,R,mm(this.format),Yg(this.format),i);else{const U=i.data;U&&x.texSubImage2D(x.TEXTURE_2D,0,A,R,p,g,mm(this.format),Yg(this.format),U)}this.useMipmap&&x.generateMipmap(x.TEXTURE_2D)}bind(i,l,p=!1){const{context:g}=this,{gl:b}=g;b.bindTexture(b.TEXTURE_2D,this.texture),i!==this.minFilter&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MAG_FILTER,i),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_MIN_FILTER,this.useMipmap&&!p?i===b.NEAREST?b.NEAREST_MIPMAP_NEAREST:b.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),l!==this.wrapS&&(b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_S,l),b.texParameteri(b.TEXTURE_2D,b.TEXTURE_WRAP_T,l),this.wrapS=l)}bindExtraParam(i,l,p,g,b){const{context:x}=this,{gl:A}=x;A.bindTexture(A.TEXTURE_2D,this.texture),l!==this.magFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MAG_FILTER,l),this.magFilter=l),i!==this.minFilter&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_MIN_FILTER,this.useMipmap?i===A.NEAREST?A.NEAREST_MIPMAP_NEAREST:A.LINEAR_MIPMAP_LINEAR:i),this.minFilter=i),p!==this.wrapS&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_S,p),this.wrapS=p),g!==this.wrapT&&(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_WRAP_T,g),this.wrapT=g),b!==this.compareMode&&(b?(A.texParameteri(A.TEXTURE_2D,A.TEXTURE_COMPARE_MODE,A.COMPARE_REF_TO_TEXTURE),A.texParameteri(A.TEXTURE_2D,A.TEXTURE_COMPARE_FUNC,b)):A.texParameteri(A.TEXTURE_2D,A.TEXTURE_COMPARE_MODE,A.NONE),this.compareMode=b)}destroy(){const{gl:i}=this.context;i.deleteTexture(this.texture),this.texture=null}}class rv{constructor(i,l){this.context=i,this.texture=l}bind(i,l){const{context:p}=this,{gl:g}=p;g.bindTexture(g.TEXTURE_2D,this.texture),i!==this.minFilter&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MAG_FILTER,i),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_MIN_FILTER,i),this.minFilter=i),l!==this.wrapS&&(g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_S,l),g.texParameteri(g.TEXTURE_2D,g.TEXTURE_WRAP_T,l),this.wrapS=l)}}function Ob(u,i,l,p,g,b,x,A){const R=[u,i,1,l,p,1,g,b,1],O=[x,A,1],L=F([],R),[B,U,q]=Cn(O,O,L);return $(R,R,[B,0,0,0,U,0,0,0,q])}function SE(u,i,l,p,g,b,x,A){const R=function(O,L,B,U,q,Y,ne,ae){const he=Ob(0,0,1,0,1,1,0,1),Se=Ob(O,L,B,U,q,Y,ne,ae);return $(Se,Se,F([],he))}(u,i,l,p,g,b,x,A);return[R[2]/R[8]/sn,R[5]/R[8]/sn]}function Ib(u){return[u[0],Math.min(Math.max(u[1],-85.051129),Mt)]}class AE extends Yc{constructor(i,l,p,g){super(),this.id=i,this.dispatcher=p,this.coordinates=l.coordinates,this.type="image",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this.tiles={},this._loaded=!1,this.onNorthPole=!1,this.onSouthPole=!1,this.setEventedParent(g),this.options=l,this._dirty=!1}load(i,l){if(this._loaded=l||!1,this.fire(new Wc("dataloading",{dataType:"source"})),this.url=this.options.url,!this.url)return i&&(this.coordinates=i),this._loaded=!0,void this._finishLoading();this._imageRequest=so(this.map._requestManager.transformRequest(this.url,Gc.Image),(p,g)=>{this._imageRequest=null,this._loaded=!0,p?this.fire(new th(p)):g&&(this.image=g instanceof HTMLImageElement?Ho.getImageData(g):g,this._dirty=!0,this.width=this.image.width,this.height=this.image.height,i&&(this.coordinates=i),this._finishLoading())})}loaded(){return this._loaded}updateImage(i){return i.url?(this._imageRequest&&i.url!==this.options.url&&(this._imageRequest.cancel(),this._imageRequest=null),this.options.url=i.url,this.load(i.coordinates,this._loaded),this):this}setTexture(i){if(!(i.handle instanceof WebGLTexture))throw new Error("The provided handle is not a WebGLTexture instance");return this.texture=new rv(this.map.painter.context,i.handle),this.width=i.dimensions[0],this.height=i.dimensions[1],this._dirty=!1,this._loaded=!0,this._finishLoading(),this}_finishLoading(){this.map&&(this.setCoordinates(this.coordinates),this.fire(new Wc("data",{dataType:"source",sourceDataType:"metadata"})))}onAdd(i){this.map=i,this.load()}onRemove(i){this._imageRequest&&(this._imageRequest.cancel(),this._imageRequest=null),!this.texture||this.texture instanceof rv||this.texture.destroy(),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy())}setCoordinates(i){if(this.coordinates=i,this._boundsArray=void 0,this._unsupportedCoords=!1,!i.length)return this;this.onNorthPole=!1,this.onSouthPole=!1;let l=i[0][1],p=i[0][1];for(const b of i)b[1]>p&&(p=b[1]),b[1]<l&&(l=b[1]);const g=(p+l)/2;if(g>Mt?this.onNorthPole=!0:g<-85.051129&&(this.onSouthPole=!0),!this.onNorthPole&&!this.onSouthPole){const b=i.map(ot.fromLngLat);this.tileID=function(x){let A=1/0,R=1/0,O=-1/0,L=-1/0;for(const ne of x)A=Math.min(A,ne.x),R=Math.min(R,ne.y),O=Math.max(O,ne.x),L=Math.max(L,ne.y);const B=Math.max(O-A,L-R),U=Math.max(0,Math.floor(-Math.log(B)/Math.LN2)),q=Math.pow(2,U);let Y=Math.floor((A+O)/2*q);return Y>1&&(Y-=1),new Ig(U,Y,Math.floor((R+L)/2*q))}(b),this.minzoom=this.maxzoom=this.tileID.z}return this.fire(new Wc("data",{dataType:"source",sourceDataType:"content"})),this}_clear(){this._boundsArray=void 0,this._unsupportedCoords=!1}_prepareData(i){for(const he in this.tiles){const Se=this.tiles[he];Se.state!=="loaded"&&(Se.state="loaded",Se.texture=this.texture)}if(this._boundsArray||this.onNorthPole||this.onSouthPole||this._unsupportedCoords)return;const l=tv(new Ig(0,0,0),this.map.transform.projection),p=[l.projection.project(this.coordinates[0][0],this.coordinates[0][1]),l.projection.project(this.coordinates[1][0],this.coordinates[1][1]),l.projection.project(this.coordinates[2][0],this.coordinates[2][1]),l.projection.project(this.coordinates[3][0],this.coordinates[3][1])];if(!function(he){const Se=he[1].x-he[0].x,Ae=he[1].y-he[0].y,re=he[2].x-he[1].x,ye=he[2].y-he[1].y,Oe=he[3].x-he[2].x,Le=he[3].y-he[2].y,nt=he[0].x-he[3].x,Qe=he[0].y-he[3].y,st=Se*ye-re*Ae,dt=re*Le-Oe*ye,a=Oe*Qe-nt*Le,h=nt*Ae-Se*Qe;return st>0&&dt>0&&a>0&&h>0||st<0&&dt<0&&a<0&&h<0}(p))return console.warn("Image source coordinates are defining non-convex area in the Mercator projection"),void(this._unsupportedCoords=!0);const g=tv(this.tileID,this.map.transform.projection),[b,x,A,R]=this.coordinates.map(he=>{const Se=g.projection.project(he[0],he[1]);return F1(g,Se)._round()});this.perspectiveTransform=SE(b.x,b.y,x.x,x.y,A.x,A.y,R.x,R.y);const O=this._boundsArray=new Rf;O.emplaceBack(b.x,b.y,0,0),O.emplaceBack(x.x,x.y,sn,0),O.emplaceBack(R.x,R.y,0,sn),O.emplaceBack(A.x,A.y,sn,sn),this.boundsBuffer&&(this.boundsBuffer.destroy(),this.elevatedGlobeVertexBuffer&&this.elevatedGlobeVertexBuffer.destroy(),this.elevatedGlobeIndexBuffer&&this.elevatedGlobeIndexBuffer.destroy()),this.boundsBuffer=i.createVertexBuffer(O,jd.members),this.boundsSegments=Yr.simpleSegment(0,0,4,2);const L=[],B=[Ib((U=this.coordinates)[0]),Ib(U[1]),Ib(U[2]),Ib(U[3])];var U;const[q,Y,ne,ae]=function(he){let Se=he[0][0],Ae=Se,re=he[0][1],ye=re;for(let Oe=1;Oe<he.length;Oe++)he[Oe][0]<Se?Se=he[Oe][0]:he[Oe][0]>Ae&&(Ae=he[Oe][0]),he[Oe][1]<re?re=he[Oe][1]:he[Oe][1]>ye&&(ye=he[Oe][1]);return[Se,re,Ae-Se,ye-re]}(B);{const he=new Rf,[Se,Ae,re,ye]=function(k){let K=k[0].x,ee=K,me=k[0].y,De=me;for(let it=1;it<k.length;it++)k[it].x<K?K=k[it].x:k[it].x>ee&&(ee=k[it].x),k[it].y<me?me=k[it].y:k[it].y>De&&(De=k[it].y);return[K,me,ee-K,De-me]}(p),Oe=k=>[(k.x-Se)/re,(k.y-Ae)/ye],[Le,nt,Qe,st]=p.map(Oe),dt=function(k,K,ee,me,De,it,yt,ct){const ut=Ob(0,0,1,0,1,1,0,1);return $(ut,ut,F([],Ob(k,K,ee,me,De,it,yt,ct)))}(Le[0],Le[1],nt[0],nt[1],Qe[0],Qe[1],st[0],st[1]);this.elevatedGlobePerspectiveTransform=SE(Le[0],Le[1],nt[0],nt[1],Qe[0],Qe[1],st[0],st[1]);const a=(k,K)=>{L.push(k.lng);const ee=Math.round((k.lng-q)/ne*sn),me=Math.round((k.lat-Y)/ae*sn),De=Oe(K),it=Cn([],[De[0],De[1],1],dt),yt=Math.round(it[0]/it[2]*sn),ct=Math.round(it[1]/it[2]*sn);he.emplaceBack(ee,me,yt,ct)},h=p[3].x-p[0].x,v=p[3].y-p[0].y,S=p[2].x-p[1].x,I=p[2].y-p[1].y;for(let k=0;k<65;k++){const K=k/64,ee=[p[0].x+K*h,p[0].y+K*v],me=[p[1].x+K*S,p[1].y+K*I],De=me[0]-ee[0],it=me[1]-ee[1];for(let yt=0;yt<65;yt++){const ct=yt/64,ut={x:ee[0]+De*ct,y:ee[1]+it*ct};a(l.projection.unproject(ut.x,ut.y),ut)}}this.elevatedGlobeVertexBuffer=i.createVertexBuffer(he,jd.members)}{this.maxLongitudeTriangleSize=0;let he=[],Se=new mo;const Ae=(re,ye,Oe)=>{Se.emplaceBack(re,ye,Oe);const Le=L[re],nt=L[ye],Qe=L[Oe],st=Math.min(Math.min(Le,nt),Qe),dt=Math.max(Math.max(Le,nt),Qe)-st;dt>this.maxLongitudeTriangleSize&&(this.maxLongitudeTriangleSize=dt),he.push(st+dt/2)};for(let re=0;re<64;re++)for(let ye=0;ye<64;ye++){const Oe=65*re+ye,Le=Oe+1,nt=Oe+65,Qe=nt+1;Ae(Oe,nt,Le),Ae(Le,nt,Qe)}[he,Se]=function(re,ye){const Oe=Array.from({length:re.length},(Qe,st)=>st);Oe.sort((Qe,st)=>re[Qe]-re[st]);const Le=[],nt=new mo;for(let Qe=0;Qe<Oe.length;Qe++){const st=Oe[Qe];Le.push(re[st]);const dt=3*st,a=dt+1;nt.emplaceBack(ye.uint16[dt],ye.uint16[a],ye.uint16[a+1])}return[Le,nt]}(he,Se),this.elevatedGlobeTrianglesCenterLongitudes=he,this.elevatedGlobeIndexBuffer=i.createIndexBuffer(Se)}this.elevatedGlobeSegments=Yr.simpleSegment(0,0,4225,8192),this.elevatedGlobeGridMatrix=new Float32Array([0,ne/sn,0,ae/sn,0,0,Y,q,0])}prepare(){const i=Object.keys(this.tiles).length!==0;if(this.tileID&&!i)return;const l=this.map.painter.context,p=l.gl;!this._dirty||this.texture instanceof rv||(this.texture?this.texture.update(this.image):(this.texture=new rr(l,this.image,p.RGBA8),this.texture.bind(p.LINEAR,p.CLAMP_TO_EDGE)),this._dirty=!1),i&&this._prepareData(l)}loadTile(i,l){this.tileID&&this.tileID.equals(i.tileID.canonical)?(this.tiles[String(i.tileID.wrap)]=i,i.buckets={},l(null)):(i.state="errored",l(null))}serialize(){return{type:"image",url:this.options.url,coordinates:this.coordinates}}hasTransition(){return!1}getSegmentsForLongitude(i){const l=this.elevatedGlobeSegments;if(!this.elevatedGlobeTrianglesCenterLongitudes||!l)return null;const p=this.elevatedGlobeTrianglesCenterLongitudes;let g=(b=i+180)+360*Math.round((p[0]-b)/360);var b;const x=new Yr,A=(B,U)=>{x.segments.push({vertexOffset:0,primitiveOffset:B,vertexLength:l.segments[0].vertexLength,primitiveLength:U,sortKey:void 0,vaos:{}})},R=.51*this.maxLongitudeTriangleSize;if(Math.abs(p[0]-g)<=R){const B=qs(p,0,p.length,g+R);return B===p.length||A(B,Ir(p,B+1,p.length,g+360-R)-B),x}g<p[0]&&(g+=360);const O=Ir(p,0,p.length,g-R);if(O===p.length)return A(0,p.length),x;A(0,O-0);const L=qs(p,O+1,p.length,g+R);return L!==p.length&&A(L,p.length-L),x}}const sv=(Math.pow(256,2)-1)/16907520;class CE extends ha{constructor(i,l,p,g){super(i,{layout:TD||(TD=new Lr({visibility:new Gt(pt.layout_raster.visibility)})),paint:EE||(EE=new Lr({"raster-opacity":new Gt(pt.paint_raster["raster-opacity"]),"raster-color":new hd(pt.paint_raster["raster-color"]),"raster-color-mix":new Gt(pt.paint_raster["raster-color-mix"]),"raster-color-range":new Gt(pt.paint_raster["raster-color-range"]),"raster-hue-rotate":new Gt(pt.paint_raster["raster-hue-rotate"]),"raster-brightness-min":new Gt(pt.paint_raster["raster-brightness-min"]),"raster-brightness-max":new Gt(pt.paint_raster["raster-brightness-max"]),"raster-saturation":new Gt(pt.paint_raster["raster-saturation"]),"raster-contrast":new Gt(pt.paint_raster["raster-contrast"]),"raster-resampling":new Gt(pt.paint_raster["raster-resampling"]),"raster-fade-duration":new Gt(pt.paint_raster["raster-fade-duration"]),"raster-emissive-strength":new Gt(pt.paint_raster["raster-emissive-strength"]),"raster-array-band":new Gt(pt.paint_raster["raster-array-band"]),"raster-elevation":new Gt(pt.paint_raster["raster-elevation"]),"raster-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},l,p,g),this.updateColorRamp(),this._curRampRange=[NaN,NaN]}getProgramIds(){return["raster"]}hasColorMap(){return!!this._transitionablePaint._values["raster-color"].value.value}tileCoverLift(){return this.paint.get("raster-elevation")}isDraped(i){return!(i&&i._source instanceof AE&&(i._source.onNorthPole||i._source.onSouthPole))&&this.paint.get("raster-elevation")===0}_handleSpecialPaintPropertyUpdate(i){i!=="raster-color"&&i!=="raster-color-range"||(this._curRampRange=[NaN,NaN],this.updateColorRamp())}updateColorRamp(i){if(!this.hasColorMap()||!this._curRampRange)return;const l=this._transitionablePaint._values["raster-color"].value.expression,[p,g]=i||this._transitionablePaint._values["raster-color-range"].value.expression.evaluate({zoom:0})||[NaN,NaN];isNaN(p)&&isNaN(g)||p===this._curRampRange[0]&&g===this._curRampRange[1]||(this.colorRamp=kg({expression:l,evaluationKey:"rasterValue",image:this.colorRamp,clips:[{start:p,end:g}],resolution:256}),this.colorRampTexture=null,this._curRampRange=[p,g])}}let gu,Vh,Zg,ov,Zo;class DE extends ha{constructor(i,l,p,g){super(i,{layout:gu||(gu=new Lr({visibility:new Gt(pt["layout_raster-particle"].visibility)})),paint:Vh||(Vh=new Lr({"raster-particle-array-band":new Gt(pt["paint_raster-particle"]["raster-particle-array-band"]),"raster-particle-count":new Gt(pt["paint_raster-particle"]["raster-particle-count"]),"raster-particle-color":new hd(pt["paint_raster-particle"]["raster-particle-color"]),"raster-particle-max-speed":new Gt(pt["paint_raster-particle"]["raster-particle-max-speed"]),"raster-particle-speed-factor":new Gt(pt["paint_raster-particle"]["raster-particle-speed-factor"]),"raster-particle-fade-opacity-factor":new Gt(pt["paint_raster-particle"]["raster-particle-fade-opacity-factor"]),"raster-particle-reset-rate-factor":new Gt(pt["paint_raster-particle"]["raster-particle-reset-rate-factor"]),"raster-particle-elevation":new Gt(pt["paint_raster-particle"]["raster-particle-elevation"]),"raster-particle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},l,p,g),this._updateColorRamp(),this.lastInvalidatedAt=Ho.now()}onRemove(i){this.colorRampTexture&&this.colorRampTexture.destroy(),this.tileFramebuffer&&this.tileFramebuffer.destroy(),this.particleFramebuffer&&this.particleFramebuffer.destroy()}hasColorMap(){return!!this._transitionablePaint._values["raster-particle-color"].value.value}getProgramIds(){return["rasterParticle"]}hasOffscreenPass(){return this.visibility!=="none"}isDraped(i){return!1}_handleSpecialPaintPropertyUpdate(i){i!=="raster-particle-color"&&i!=="raster-particle-max-speed"||(this._updateColorRamp(),this._invalidateAnimationState()),i==="raster-particle-count"&&this._invalidateAnimationState()}_updateColorRamp(){if(!this.hasColorMap())return;const i=this._transitionablePaint._values["raster-particle-color"].value.expression,l=this._transitionablePaint._values["raster-particle-max-speed"].value.expression.evaluate({zoom:0});this.colorRamp=kg({expression:i,evaluationKey:"rasterParticleSpeed",image:this.colorRamp,clips:[{start:0,end:l}],resolution:256}),this.colorRampTexture=null}_invalidateAnimationState(){this.lastInvalidatedAt=Ho.now()}tileCoverLift(){return this.paint.get("raster-particle-elevation")}}class ED extends ha{constructor(i,l){super(i,{},l,null),this.implementation=i,i.slot&&(this.slot=i.slot)}is3D(i){return this.implementation.renderingMode==="3d"}hasOffscreenPass(){return this.implementation.prerender!==void 0}isDraped(i){return this.implementation.renderToTile!==void 0}shouldRedrape(){return!!this.implementation.shouldRerenderTiles&&this.implementation.shouldRerenderTiles()}recalculate(){}updateTransitions(){}hasTransition(){return!1}serialize(){}onAdd(i){this.implementation.onAdd&&this.implementation.onAdd(i,i.painter.context.gl)}onRemove(i){this.implementation.onRemove&&this.implementation.onRemove(i,i.painter.context.gl)}}function W1(u,i,l){const p=[0,0,1],g=dr([]);return ks(g,g,l?-bi(u)+Math.PI:bi(u)),di(g,g,-bi(i)),Kn(p,p,g),dn(p,p)}function RE(u,i){const l=Mb(u.projection,u.zoom,u.width,u.height),p=function(b,x,A,R,O){const L=new ge(A.lng-180*ip,A.lat),B=new ge(A.lng+180*ip,A.lat),U=b.project(L.lng,L.lat),q=b.project(B.lng,B.lat),Y=-Math.atan2(q.y-U.y,q.x-U.x),ne=ot.fromLngLat(A);ne.y=He(ne.y,-1+ip,1-ip);const ae=ne.toLngLat(),he=b.project(ae.lng,ae.lat),Se=ot.fromLngLat(ae);Se.x+=ip;const Ae=Se.toLngLat(),re=b.project(Ae.lng,Ae.lat),ye=IE(re.x-he.x,re.y-he.y,Y),Oe=ot.fromLngLat(ae);Oe.y+=ip;const Le=Oe.toLngLat(),nt=b.project(Le.lng,Le.lat),Qe=IE(nt.x-he.x,nt.y-he.y,Y),st=Math.abs(ye.x)/Math.abs(Qe.y),dt=X([]);Xe(dt,dt,-Y*(1-(O?0:R)));const a=X([]);return Ie(a,a,[1,1-(1-st)*R,1]),a[4]=-Qe.x/Qe.y*R,Xe(a,a,Y),ie(a,dt,a),a}(u.projection,0,u.center,l,i),g=OE(u);return Ie(p,p,[g,g,1]),p}function OE(u){const i=u.projection,l=Mb(u.projection,u.zoom,u.width,u.height),p=Y1(i,u.center),g=Y1(i,ge.convert(i.center));return Math.pow(2,p*l+(1-l)*g)}function Mb(u,i,l,p,g=1/0){const b=u.range;if(!b)return 0;const x=Math.min(g,Math.max(l,p)),A=Math.log(x/1024)/Math.LN2;return at(b[0]+A,b[1]+A,i)}const ip=1/4e4;function Y1(u,i){const l=He(i.lat,-85.051129,Mt),p=new ge(i.lng-180*ip,l),g=new ge(i.lng+180*ip,l),b=u.project(p.lng,l),x=u.project(g.lng,l),A=ot.fromLngLat(p),R=ot.fromLngLat(g),O=x.x-b.x,L=x.y-b.y,B=R.x-A.x,U=R.y-A.y,q=Math.sqrt((B*B+U*U)/(O*O+L*L));return Math.log(q)/Math.LN2}function IE(u,i,l){const p=Math.cos(l),g=Math.sin(l);return{x:u*p-i*g,y:u*g+i*p}}function ME(u,i,l){X(u),Xe(u,u,bi(i[2])),Re(u,u,bi(i[0])),Ne(u,u,bi(i[1])),Ie(u,u,l),ie(u,u,[1,0,0,0,0,0,1,0,0,1,0,0,0,0,0,1])}function Pb(u,i,l,p,g,b,x,A){const R=[l[0]-i[0],l[1]-i[1],0],O=[p[0]-i[0],p[1]-i[1],0];if(ze(R)<1e-12||ze(O)<1e-12)return dr(u);const L=Mn([],R,O);dn(L,L),mt(O,p,i),R[2]=(b-g)*A,O[2]=(x-g)*A;const B=R;return Mn(B,R,O),dn(B,B),jo(u,L,B)}function kb(u,i,l=!1){const p=Mh(i.zoom),g=function(b,x,A){const R=x.worldSize,O=[b[12],b[13],b[14]],L=_t(O[1]/R),B=et(O[0]/R),U=X([]),q=We(1,L)*R,Y=We(1,0)*R*jt(L,x.zoom),ne=1/My(R);let ae=Y*ne;if(A){const re=Mb(x.projection,x.zoom,x.width,x.height,1024);ae=ne*x.projection.pixelSpaceConversion(x.center.lat,R,re)}const he=se(L,B);St(he,he,Fe([],dn([],he),q*ae*O[2]));const Se=function(re){const ye=[re[0],re[1],re[2]];let Oe=[0,1,0];const Le=Mn([],Oe,ye);return Mn(Oe,ye,Le),ln(Oe)===0&&(Oe=[0,1,0],Mn(Le,ye,Oe)),dn(Le,Le),dn(Oe,Oe),dn(ye,ye),[Le[0],Le[1],Le[2],0,Oe[0],Oe[1],Oe[2],0,ye[0],ye[1],ye[2],0,re[0],re[1],re[2],1]}(he);Ie(U,U,[ae,ae,ae*q]),we(U,U,[-O[0],-O[1],-O[2]]);const Ae=ie([],x.globeMatrix,Se);return ie(Ae,Ae,U),ie(Ae,Ae,b),Ae}(u,i,l);if(p>0){const b=function(x,A){const R=A.worldSize,O=We(1,0)*R*jt(A.center.lat,A.zoom)/My(R),L=We(1,A.center.lat)*R,B=X([]);return Ne(B,B,bi(A.center.lng)),Re(B,B,bi(A.center.lat)),we(B,B,[0,0,C]),Ie(B,B,[O,O,O*L]),we(B,B,[A.point.x-.5*R,A.point.y-.5*R,0]),ie(B,B,x),ie(B,A.globeMatrix,B)}(u,i);return function(x,A,R){const O=(Y,ne,ae)=>{const he=ze(Y),Se=ze(ne),Ae=jf(Y,ne,ae);return Fe(Ae,Ae,1/ze(Ae)*$n(he,Se,ae))},L=O([x[0],x[1],x[2]],[A[0],A[1],A[2]],R),B=O([x[4],x[5],x[6]],[A[4],A[5],A[6]],R),U=O([x[8],x[9],x[10]],[A[8],A[9],A[10]],R),q=jf([x[12],x[13],x[14]],[A[12],A[13],A[14]],R);return[L[0],L[1],L[2],0,B[0],B[1],B[2],0,U[0],U[1],U[2],0,q[0],q[1],q[2],1]}(g,b,p)}return g}function Z1(u,i,l,p){const g=Vi.projectAabbCorners(p,l);let b=Number.MAX_VALUE,x=-1;for(let O=0;O<g.length;++O){const L=g[O];L[0]=(.5*L[0]+.5)*i.width,L[1]=(.5-.5*L[1])*i.height,L[2]<b&&(x=O,b=L[2])}const A=O=>new Lt(g[O][0],g[O][1]);let R;switch(x){case 0:case 6:R=[A(1),A(5),A(4),A(7),A(3),A(2),A(1)];break;case 1:case 7:R=[A(0),A(4),A(5),A(6),A(2),A(3),A(0)];break;case 3:case 5:R=[A(1),A(0),A(4),A(7),A(6),A(2),A(1)];break;default:R=[A(1),A(5),A(6),A(7),A(3),A(0),A(1)]}if(Qa(u,R))return b}const av=Oi([{name:"a_pos_3f",components:3,type:"Float32"}]),PE=Oi([{name:"a_color_3f",components:3,type:"Float32"}]),SD=Oi([{name:"a_color_4f",components:4,type:"Float32"}]),Ma=Oi([{name:"a_uv_2f",components:2,type:"Float32"}]),AD=Oi([{name:"a_normal_3f",components:3,type:"Float32"}]),CD=Oi([{name:"a_normal_matrix0",components:4,type:"Float32"},{name:"a_normal_matrix1",components:4,type:"Float32"},{name:"a_normal_matrix2",components:4,type:"Float32"},{name:"a_normal_matrix3",components:4,type:"Float32"}]),DD=Oi([{name:"a_pbr",components:4,type:"Uint16"},{name:"a_heightBasedEmissiveStrength",components:3,type:"Float32"}]),kE={None:0,Model:1,Symbol:2,FillExtrusion:4};class rp{constructor(i,l,p,g){this.message=(i?`${i}: `:"")+p,g&&(this.identifier=g),l!=null&&l.__line__&&(this.line=l.__line__)}}function X1(u,i){const l=u.indexOf("://")===-1;try{return new URL(u,l&&i?"http://example.com":void 0),!0}catch{return!1}}class Q1{constructor(i,l){this.feature=i,this.instancedDataOffset=l,this.instancedDataCount=0,this.rotation=[0,0,0],this.scale=[1,1,1],this.translation=[0,0,0]}}class K1{constructor(){this.instancedDataArray=new Dh,this.instancesEvaluatedElevation=[],this.features=[],this.idToFeaturesIndex={}}}class J1{constructor(i){this.zoom=i.zoom,this.canonical=i.canonical,this.layers=i.layers,this.layerIds=this.layers.map(l=>l.fqid),this.projection=i.projection,this.index=i.index,this.worldview=i.worldview,this.hasZoomDependentProperties=this.layers[0].isZoomDependent(),this.stateDependentLayerIds=this.layers.filter(l=>l.isStateDependent()).map(l=>l.id),this.hasPattern=!1,this.instancesPerModel={},this.validForExaggeration=0,this.maxVerticalOffset=0,this.maxScale=0,this.maxHeight=0,this.lookupDim=this.zoom>this.canonical.z?256:this.zoom>15?75:100,this.instanceCount=0,this.terrainElevationMin=0,this.terrainElevationMax=0,this.validForDEMTile={id:null,timestamp:0},this.modelUris=[],this.modelsRequested=!1,this.activeReplacements=[],this.replacementUpdateTime=0,this.styleDefinedModelURLs=i.styleDefinedModelURLs}updateFootprints(i,l){}populate(i,l,p,g){this.tileToMeter=Dt(p);const b=this.layers[0]._featureFilter.needGeometry;this.lookup=new Uint8Array(this.lookupDim*this.lookupDim);for(const{feature:x,id:A,index:R,sourceLayerIndex:O}of i){const L=A??(x.properties&&x.properties.hasOwnProperty("id")?x.properties.id:void 0),B=pn(x,b);if(!this.layers[0]._featureFilter.filter(new $i(this.zoom,{worldview:this.worldview}),B,p))continue;const U={id:L,sourceLayerIndex:O,index:R,geometry:b?B.geometry:fn(x,p,g),properties:x.properties,type:x.type,patterns:{}},q=this.addFeature(U,U.geometry,B);q&&l.featureIndex.insert(x,U.geometry,R,O,this.index,this.instancesPerModel[q].instancedDataArray.length,sn/32)}this.lookup=null}update(i,l,p,g){for(const b in this.instancesPerModel){const x=this.instancesPerModel[b];for(const A in i)x.idToFeaturesIndex.hasOwnProperty(A)&&(this.evaluate(x.features[x.idToFeaturesIndex[A]],i[A],x,!0),this.uploaded=!1)}this.maxHeight=0}updateZoomBasedPaintProperties(){if(!this.hasZoomDependentProperties)return!1;let i=!1;for(const l in this.instancesPerModel){const p=this.instancesPerModel[l];for(const g of p.features){const b=this.layers[0],x=g.feature,A=this.canonical,R=b.paint.get("model-rotation").evaluate(x,{},A),O=b.paint.get("model-scale").evaluate(x,{},A),L=b.paint.get("model-translation").evaluate(x,{},A);Bt(g.rotation,R)&&Bt(g.scale,O)&&Bt(g.translation,L)||(this.evaluate(g,g.featureStates,p,!0),i=!0)}}return i}updateReplacement(i,l,p,g){if(l.updateTime===this.replacementUpdateTime)return!1;this.replacementUpdateTime=l.updateTime;const b=l.getReplacementRegionsForTile(i.toUnwrapped(),!0);if(ub(this.activeReplacements,b))return!1;this.activeReplacements=b;let x=!1;for(const A in this.instancesPerModel){const R=this.instancesPerModel[A],O=R.instancedDataArray;for(const L of R.features){const B=L.instancedDataOffset,U=L.instancedDataCount;for(let q=0;q<U;q++){const Y=16*(q+B);let ne=O.float32[Y+0];const ae=ne>sn;ne=ae?ne-sn:ne;const he=Math.floor(ne),Se=O.float32[Y+1];let Ae=!1;for(const re of this.activeReplacements)if(!HT(re,p,kE.Model,g)&&!(re.min.x>he||he>re.max.x||re.min.y>Se||Se>re.max.y)&&(Ae=GT($T(he,Se,i.canonical,re.footprintTileId.canonical),re.footprint),Ae))break;O.float32[Y]=Ae?ne+sn:ne,x=x||Ae!==ae}}}return x}isEmpty(){for(const i in this.instancesPerModel)if(this.instancesPerModel[i].instancedDataArray.length!==0)return!1;return!0}uploadPending(){return!this.uploaded}upload(i){if(!this.uploaded)for(const l in this.instancesPerModel){const p=this.instancesPerModel[l];p.instancedDataArray.length<0||p.instancedDataArray.length===0||(p.instancedDataBuffer?p.instancedDataBuffer.updateData(p.instancedDataArray):p.instancedDataBuffer=i.createVertexBuffer(p.instancedDataArray,CD.members,!0,void 0,this.instanceCount))}this.uploaded=!0}destroy(){for(const l in this.instancesPerModel){const p=this.instancesPerModel[l];p.instancedDataArray.length!==0&&p.instancedDataBuffer&&p.instancedDataBuffer.destroy()}const i=this.layers[0].modelManager;if(i&&this.modelUris&&this.modelsRequested)for(const l of this.modelUris)i.removeModel(l,"",!0)}addFeature(i,l,p){const g=this.layers[0],b=g.layout.get("model-id").evaluate(p,{},this.canonical);if(!b)return ii(`modelId is not evaluated for layer ${g.id} and it is not going to get rendered.`),b;(X1(b,!1)||this.styleDefinedModelURLs[b]!==void 0)&&(this.modelUris.includes(b)||this.modelUris.push(b)),this.instancesPerModel[b]||(this.instancesPerModel[b]=new K1);const x=this.instancesPerModel[b],A=x.instancedDataArray,R=new Q1(p,A.length);for(const O of l)for(const L of O){if(L.x<0||L.x>=sn||L.y<0||L.y>=sn)continue;const B=(this.lookupDim-1)/sn,U=this.lookupDim*(L.y*B|0)+L.x*B|0;if(this.lookup){if(this.lookup[U]!==0)continue;this.lookup[U]=1}this.instanceCount++;const q=A.length;A.resize(q+1),x.instancesEvaluatedElevation.push(0),A.float32[16*q]=L.x,A.float32[16*q+1]=L.y}return R.instancedDataCount=x.instancedDataArray.length-R.instancedDataOffset,R.instancedDataCount>0&&(i.id&&(x.idToFeaturesIndex[i.id]=x.features.length),x.features.push(R),this.evaluate(R,{},x,!1)),b}getModelUris(){return this.modelUris}evaluate(i,l,p,g){const b=this.layers[0],x=i.feature,A=this.canonical,R=i.rotation=b.paint.get("model-rotation").evaluate(x,l,A),O=i.scale=b.paint.get("model-scale").evaluate(x,l,A),L=i.translation=b.paint.get("model-translation").evaluate(x,l,A),B=b.paint.get("model-color").evaluate(x,l,A);B.a=b.paint.get("model-color-mix-intensity").evaluate(x,l,A);const U=[];this.maxVerticalOffset<L[2]&&(this.maxVerticalOffset=L[2]),this.maxScale=Math.max(Math.max(this.maxScale,O[0]),Math.max(O[1],O[2])),ME(U,R,O);const q=Math.round(100*B.a)+B.b/1.05;for(let Y=0;Y<i.instancedDataCount;++Y){const ne=i.instancedDataOffset+Y,ae=16*ne,he=p.instancedDataArray.float32;let Se=0;g&&(Se=he[ae+6]-p.instancesEvaluatedElevation[ne]);const Ae=0|he[ae+1];he[ae]=(0|he[ae])+B.r/1.05,he[ae+1]=Ae+B.g/1.05,he[ae+2]=q,he[ae+3]=1/(A.z>10?this.tileToMeter:Dt(A,Ae)),he[ae+4]=L[0],he[ae+5]=L[1],he[ae+6]=L[2]+Se,he[ae+7]=U[0],he[ae+8]=U[1],he[ae+9]=U[2],he[ae+10]=U[4],he[ae+11]=U[5],he[ae+12]=U[6],he[ae+13]=U[8],he[ae+14]=U[9],he[ae+15]=U[10],p.instancesEvaluatedElevation[ne]=L[2]}}}let NE,Hd;vn(J1,"ModelBucket",{omit:["layers"]}),vn(K1,"PerModelAttributes"),vn(Q1,"ModelFeature");const $s=64,gm={CoordinateSpaceTile:1,HasMapboxMeshFeatures:4,HasMeshoptCompression:8};function LE(u,i,l,p,g,b,x,A,R,O=!1){const L=l.zoom,B=l.project(p),U=jt(p.lat,L),q=1/U;X(u),we(u,u,[B.x+x[0]*q,B.y+x[1]*q,x[2]]);let Y=1,ne=1;const ae=l.worldSize;if(O){if(l.projection.name==="mercator"){let re=0;l.elevation&&(re=l.elevation.getAtPointOrZero(new ot(B.x/ae,B.y/ae),0));const ye=Nr([],[B.x,B.y,re,1],l.projMatrix)[3]/l.cameraToCenterDistance;Y=ye,ne=ye*jt(l.center.lat,L)}else if(l.projection.name==="globe"){const re=kb(u,l),ye=[0,0,0,1];Nr(ye,ye,ie([],l.projMatrix,re));const Oe=ye[3]/l.cameraToCenterDistance,Le=Mh(L),nt=l.projection.pixelsPerMeter(p.lat,ae)*jt(p.lat,L),Qe=l.projection.pixelsPerMeter(l.center.lat,ae)*jt(l.center.lat,L);Y=Oe/$n(nt,Rt(l.center.lat),Le),ne=Oe*U/nt,Y*=Qe,ne*=Qe}}else Y=q;Ie(u,u,[Y,Y,ne]);const he=[...u],Se=i.orientation,Ae=[];if(ME(Ae,[Se[0]+g[0],Se[1]+g[1],Se[2]+g[2]],b),ie(u,he,Ae),A&&l.elevation){let re=0;const ye=[];if(R&&l.elevation){re=function(Le,nt,Qe,st,dt){const a=nt.elevation;if(!a)return 0;const h=Vi.projectAabbCorners(Qe,st),v=We(1,dt.lat)*nt.worldSize,S=function(Ct,mn){const tn=[0,0,1],Qt=[{corners:[0,1,3,2],dotProductWithUp:0},{corners:[1,5,2,6],dotProductWithUp:0},{corners:[0,4,1,5],dotProductWithUp:0},{corners:[2,6,3,7],dotProductWithUp:0},{corners:[4,7,5,6],dotProductWithUp:0},{corners:[0,3,4,7],dotProductWithUp:0}];for(const Je of Qt){const rt=Ct[Je.corners[0]],lt=Ct[Je.corners[1]],kt=Ct[Je.corners[2]],Zt=[lt[0]-rt[0],lt[1]-rt[1],mn*(lt[2]-rt[2])],On=Mn(Zt,Zt,[kt[0]-rt[0],kt[1]-rt[1],mn*(kt[2]-rt[2])]);dn(On,On),Je.dotProductWithUp=Ht(On,tn)}return Qt.sort((Je,rt)=>Je.dotProductWithUp-rt.dotProductWithUp),Qt[0].corners}(h,v),I=h[S[0]],k=h[S[1]],K=h[S[2]],ee=h[S[3]],me=a.getAtPointOrZero(new ot(I[0]/nt.worldSize,I[1]/nt.worldSize),0),De=a.getAtPointOrZero(new ot(k[0]/nt.worldSize,k[1]/nt.worldSize),0),it=a.getAtPointOrZero(new ot(K[0]/nt.worldSize,K[1]/nt.worldSize),0),yt=a.getAtPointOrZero(new ot(ee[0]/nt.worldSize,ee[1]/nt.worldSize),0),ct=(me+yt)/2,ut=(De+it)/2;return ct>ut?De<it?Pb(Le,k,ee,I,De,yt,me,v):Pb(Le,K,I,ee,it,me,yt,v):me<yt?Pb(Le,I,k,K,me,De,it,v):Pb(Le,ee,K,k,yt,it,De,v),Math.max(ct,ut)}(ye,l,i.aabb,u,p);const Oe=ie([],Te([],ye),Ae);ie(u,he,Oe)}else re=l.elevation.getAtPointOrZero(new ot(B.x/ae,B.y/ae),0);re!==0&&(u[14]+=re)}}function Ao(u,i,l=!1){u.uploaded||(u.gfxTexture=new rr(i,u.image,l?i.gl.R8:i.gl.RGBA8,{useMipmap:u.sampler.minFilter>=i.gl.NEAREST_MIPMAP_NEAREST}),u.uploaded=!0,u.image=null)}function lv(u,i,l){u.indexBuffer=i.createIndexBuffer(u.indexArray,!1,!0),u.vertexBuffer=i.createVertexBuffer(u.vertexArray,av.members,!1,!0),u.normalArray&&(u.normalBuffer=i.createVertexBuffer(u.normalArray,AD.members,!1,!0)),u.texcoordArray&&(u.texcoordBuffer=i.createVertexBuffer(u.texcoordArray,Ma.members,!1,!0)),u.colorArray&&(u.colorBuffer=i.createVertexBuffer(u.colorArray,(u.colorArray.bytesPerElement===12?PE:SD).members,!1,!0)),u.featureArray&&(u.pbrBuffer=i.createVertexBuffer(u.featureArray,DD.members,!0)),u.segments=Yr.simpleSegment(0,0,u.vertexArray.length,u.indexArray.length);const p=u.material;p.pbrMetallicRoughness.baseColorTexture&&Ao(p.pbrMetallicRoughness.baseColorTexture,i),p.pbrMetallicRoughness.metallicRoughnessTexture&&Ao(p.pbrMetallicRoughness.metallicRoughnessTexture,i),p.normalTexture&&Ao(p.normalTexture,i),p.occlusionTexture&&Ao(p.occlusionTexture,i,l),p.emissionTexture&&Ao(p.emissionTexture,i)}function _m(u,i,l){if(u.meshes)for(const p of u.meshes)lv(p,i,l);if(u.children)for(const p of u.children)_m(p,i,l)}function yo(u){if(u.meshes)for(const i of u.meshes)i.indexArray.destroy(),i.vertexArray.destroy(),i.colorArray&&i.colorArray.destroy(),i.normalArray&&i.normalArray.destroy(),i.texcoordArray&&i.texcoordArray.destroy(),i.featureArray&&i.featureArray.destroy();if(u.children)for(const i of u.children)yo(i)}function wl(u){if(u.meshes)for(const l of u.meshes)l.vertexBuffer&&(l.vertexBuffer.destroy(),l.indexBuffer.destroy(),l.normalBuffer&&l.normalBuffer.destroy(),l.texcoordBuffer&&l.texcoordBuffer.destroy(),l.colorBuffer&&l.colorBuffer.destroy(),l.pbrBuffer&&l.pbrBuffer.destroy(),l.segments.destroy(),l.material&&((i=l.material).pbrMetallicRoughness.baseColorTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture&&i.pbrMetallicRoughness.baseColorTexture.gfxTexture.destroy(),i.pbrMetallicRoughness.metallicRoughnessTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture&&i.pbrMetallicRoughness.metallicRoughnessTexture.gfxTexture.destroy(),i.normalTexture&&i.normalTexture.gfxTexture&&i.normalTexture.gfxTexture.destroy(),i.emissionTexture&&i.emissionTexture.gfxTexture&&i.emissionTexture.gfxTexture.destroy(),i.occlusionTexture&&i.occlusionTexture.gfxTexture&&i.occlusionTexture.gfxTexture.destroy()));var i;if(u.children)for(const l of u.children)wl(l)}class Tl{constructor(i,l,p){this._demTile=i,this._dem=this._demTile.dem,this._scale=l,this._offset=p}static create(i,l,p){const g=p||i.findDEMTileFor(l);if(!g||!g.dem)return;const b=g.dem,x=g.tileID,A=1<<l.canonical.z-x.canonical.z;return new Tl(g,b.dim/sn/A,[(l.canonical.x/A-x.canonical.x)*b.dim,(l.canonical.y/A-x.canonical.y)*b.dim])}tileCoordToPixel(i,l){const p=l*this._scale+this._offset[1],g=Math.floor(i*this._scale+this._offset[0]),b=Math.floor(p);return new Lt(g,b)}getElevationAt(i,l,p,g){const b=i*this._scale+this._offset[0],x=l*this._scale+this._offset[1],A=Math.floor(b),R=Math.floor(x),O=this._dem;return g=!!g,p?$n($n(O.get(A,R,g),O.get(A,R+1,g),x-R),$n(O.get(A+1,R,g),O.get(A+1,R+1,g),x-R),b-A):O.get(A,R,g)}getElevationAtPixel(i,l,p){return this._dem.get(i,l,!!p)}getMeterToDEM(i){return(1<<this._demTile.tileID.canonical.z)*We(1,i)*this._dem.stride}}const Xg=new Float32Array(262144),Qg=new Uint8Array(262144);function cv(u){let i=0;if(u.meshes)for(const l of u.meshes)i=Math.max(i,l.aabb.max[2]);if(u.children)for(const l of u.children)i=Math.max(i,cv(l));return i}function RD(u,i,l){if(u.meshes)for(const p of u.meshes){if(p.aabb.min[0]===1/0)continue;const g=Vi.applyTransform(p.aabb,u.matrix);l.insert(i,g.min[0],g.min[1],g.max[0],g.max[1])}if(u.children)for(const p of u.children)RD(p,i,l)}const OD=["","wall","door","roof","window","lamp","logo"];class Sc{constructor(i){this.node=i,this.evaluatedRMEA=[[1,0,0,1],[1,0,0,1],[1,0,0,1],[1,0,0,1],[.4,1,0,1],[1,0,0,1],[1,0,0,1]],this.hiddenByReplacement=!1,this.evaluatedTranslation=[0,0,0],this.evaluatedScale=[1,1,1],this.evaluatedColor=[],this.emissionHeightBasedParams=[],this.cameraCollisionOpacity=1,this.feature={type:"Point",id:i.id,geometry:[],properties:{height:cv(i)}},this.aabb=this._getLocalBounds(),this.state=null}_getLocalBounds(){if(!this.node.meshes)return new Vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);if(!this.aabb){let i=0;const l=new Vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]);for(const p of this.node.meshes)this.node.lightMeshIndex!==i&&(p.transformedAabb=Vi.applyTransformFast(p.aabb,this.node.matrix),l.encapsulate(p.transformedAabb)),i++;this.aabb=l}return this.aabb}}class Pa{constructor(i,l,p,g,b,x,A,R){this.id=p,this.layers=i,this.layerIds=this.layers.map(O=>O.fqid),this.stateDependentLayerIds=this.layers.filter(O=>O.isStateDependent()).map(O=>O.id),this.modelTraits|=gm.CoordinateSpaceTile,this.uploaded=!1,this.hasPattern=!1,g&&(this.modelTraits|=gm.HasMapboxMeshFeatures),b&&(this.modelTraits|=gm.HasMeshoptCompression),this.zoom=-1,this.terrainExaggeration=1,this.projection={name:"mercator"},this.replacementUpdateTime=0,this.elevationReadFromZ=255,this.brightness=x,this.worldview=R,this.dirty=!0,this.needsUpload=!1,this.filter=null,this.nodesInfo=[];for(const O of l)this.nodesInfo.push(new Sc(O)),RD(O,A.featureIndexArray.length,A.grid),A.featureIndexArray.emplaceBack(this.nodesInfo.length-1,0,A.bucketLayerIDs.length-1,0);this.states={}}updateFootprints(i,l){for(const p of this.getNodesInfo()){const g=p.node;g.footprint&&l.push({footprint:g.footprint,id:i})}}update(i){const l=Object.keys(i).length!==0;if(l&&!this.stateDependentLayers.length)return;const p=l?this.stateDependentLayers:this.layers;if(!$r(i,this.states))for(const g of p)this.evaluate(g,i);this.states=structuredClone(i)}populate(){console.log("populate 3D model bucket")}uploadPending(){return!this.uploaded||this.needsUpload}upload(i){if(!this.needsUpload)return;const l=this.getNodesInfo();for(const p of l){const g=p.node;this.uploaded?this.updatePbrBuffer(g):_m(g,i,!0)}for(const p of l)yo(p.node);this.uploaded=!0,this.needsUpload=!1}updatePbrBuffer(i){let l=!1;if(!i.meshes)return l;for(const p of i.meshes)p.pbrBuffer&&(p.pbrBuffer.updateData(p.featureArray),l=!0);return l}needsReEvaluation(i,l,p){const g=i.transform.projectionOptions,b=i.style.getBrightness(),x=this.brightness!==b;if(!this.uploaded||this.dirty||g.name!==this.projection.name||Hl(p.paint.get("model-color").value,x)||Hl(p.paint.get("model-color-mix-intensity").value,x)||Hl(p.paint.get("model-roughness").value,x)||Hl(p.paint.get("model-emissive-strength").value,x)||Hl(p.paint.get("model-height-based-emissive-strength-multiplier").value,x)){this.projection=g,this.brightness=b;const A=this.getNodesInfo();for(const R of A)R.state=null;return!0}return!1}evaluateTransform(i,l){if(i.transform.zoom===this.zoom)return;this.zoom=i.transform.zoom;const p=this.getNodesInfo(),g=this.id.canonical;for(const b of p){const x=b.feature;b.evaluatedTranslation=l.paint.get("model-translation").evaluate(x,{},g),b.evaluatedScale=l.paint.get("model-scale").evaluate(x,{},g)}}evaluate(i,l){const p=this.getNodesInfo();for(const g of p){if(!g.node.meshes)continue;const b=g.feature,x=l&&l[b.id];if($r(x,g.state))continue;g.state=structuredClone(x);const A=g.node.meshes&&g.node.meshes[0].featureData,R=g.evaluatedColor[2],O=g.evaluatedRMEA[2],L=this.id.canonical;if(g.hasTranslucentParts=!1,A){for(let B=0;B<OD.length;B++){const U=OD[B];U.length&&(b.properties.part=U);const q=i.paint.get("model-color").evaluate(b,x,L).toPremultipliedRenderColor(null),Y=i.paint.get("model-color-mix-intensity").evaluate(b,x,L);g.evaluatedColor[B]=[q.r,q.g,q.b,Y],g.evaluatedRMEA[B][0]=i.paint.get("model-roughness").evaluate(b,x,L),g.evaluatedRMEA[B][2]=i.paint.get("model-emissive-strength").evaluate(b,x,L),g.evaluatedRMEA[B][3]=q.a,g.emissionHeightBasedParams[B]=i.paint.get("model-height-based-emissive-strength-multiplier").evaluate(b,x,L),!g.hasTranslucentParts&&q.a<1&&(g.hasTranslucentParts=!0)}delete b.properties.part,Nb(g,R!==g.evaluatedColor[2]||O!==g.evaluatedRMEA[2],this.modelTraits)}else g.evaluatedRMEA[0][2]=i.paint.get("model-emissive-strength").evaluate(b,x,L);g.evaluatedTranslation=i.paint.get("model-translation").evaluate(b,x,L),g.evaluatedScale=i.paint.get("model-scale").evaluate(b,x,L),this.updatePbrBuffer(g.node)||(this.needsUpload=!0)}this.dirty=!1}elevationUpdate(i,l,p,g){const b=i.findDEMTileFor(p);if(b&&(b.tileID.canonical!==this.terrainTile||l!==this.terrainExaggeration)){if(b.dem&&b.tileID.overscaledZ!==this.elevationReadFromZ){this.elevationReadFromZ=b.tileID.overscaledZ;const x=Tl.create(i,p,b);if(!x)return;this.modelTraits&gm.HasMapboxMeshFeatures&&this.updateDEM(i,x,p,g);for(const A of this.getNodesInfo()){const R=A.node;if(!R.footprint||!R.footprint.vertices||!R.footprint.vertices.length)continue;const O=R.footprint.vertices;let L=x.getElevationAt(O[0].x,O[0].y,!0,!0);for(let B=1;B<O.length;B++)L=Math.min(L,x.getElevationAt(O[B].x,O[B].y,!0,!0));R.elevation=L}}this.terrainTile=b.tileID.canonical,this.terrainExaggeration=l}}updateDEM(i,l,p,g){let b=l._dem._modifiedForSources[g];if(b===void 0&&(l._dem._modifiedForSources[g]=[],b=l._dem._modifiedForSources[g]),b.includes(p.canonical))return;const x=l._dem.dim;b.push(p.canonical);let A=!1;for(const R of this.getNodesInfo()){const O=R.node;if(!O.footprint||!O.footprint.grid)continue;const L=O.footprint.grid,B=l.tileCoordToPixel(L.min.x,L.min.y),U=l.tileCoordToPixel(L.max.x,L.max.y),q=Math.min(Math.min(x-U.y,B.x),Math.min(B.y,x-U.x));if(q<0)continue;const Y=He(q,2,5);let ne=Math.max(0,B.x-Y),ae=Math.max(0,B.y-Y),he=Math.min(U.x+Y,x-1),Se=Math.min(U.y+Y,x-1);for(let Oe=ae;Oe<=Se;++Oe)for(let Le=ne;Le<=he;++Le)Qg[Oe*x+Le]=255;let Ae=0,re=0;for(let Oe=0;Oe<L.cellsY;++Oe)for(let Le=0;Le<L.cellsX;++Le){if(!L.cells[Oe*L.cellsX+Le])continue;const nt=l.tileCoordToPixel(L.min.x+Le/L.xScale,L.min.y+Oe/L.yScale),Qe=l.tileCoordToPixel(L.min.x+(Le+1)/L.xScale,L.min.y+(Oe+1)/L.yScale);for(let st=nt.y;st<=Math.min(Qe.y+1,x-1);++st)for(let dt=nt.x;dt<=Math.min(Qe.x+1,x-1);++dt)Qg[st*x+dt]===255&&(Qg[st*x+dt]=0,Ae+=l.getElevationAtPixel(dt,st),re++)}const ye=Ae/re;ne=Math.max(1,B.x-Y),ae=Math.max(1,B.y-Y),he=Math.min(U.x+Y,x-2),Se=Math.min(U.y+Y,x-2),A=!0;for(let Oe=ae;Oe<=Se;++Oe)for(let Le=ne;Le<=he;++Le)Qg[Oe*x+Le]===0&&(Xg[Oe*x+Le]=l._dem.set(Le,Oe,ye));for(let Oe=1;Oe<Y;++Oe){ne=Math.max(1,B.x-Oe),ae=Math.max(1,B.y-Oe),he=Math.min(U.x+Oe,x-2),Se=Math.min(U.y+Oe,x-2);for(let Le=ae;Le<=Se;++Le)for(let nt=ne;nt<=he;++nt){const Qe=Le*x+nt;if(Qg[Qe]===255){let st=0,dt=0,a=-1,h=-1;for(let v=-1;v<=1;++v)for(let S=-1;S<=1;++S){const I=(Le+v)*x+nt+S;if(Qg[I]>=Oe)continue;const k=Xg[I],K=Math.abs(k);K>dt&&(st=k,dt=K,a=S,h=v)}if(dt>.1){const v=1-(Oe+.5*Math.abs(a*h))/Y;let S=l._dem.get(nt,Le)+st*v;const I=l._dem.get(nt+a,Le+h),k=l._dem.get(nt-a,Le-h,!0);(S-I)*(S-k)>0&&(S=(I+k)/2),Xg[Qe]=l._dem.set(nt,Le,S),Qg[Qe]=Oe}}}}}A&&(l._demTile.needsDEMTextureUpload=!0,l._dem._timestamp=Ho.now())}setFilter(i){this.filter=i?my(i):null}getNodesInfo(){return this.filter?this.nodesInfo.filter(i=>this.filter.filter(new $i(this.id.overscaledZ,{worldview:this.worldview}),i.feature,this.id.canonical)):this.nodesInfo}destroy(){const i=this.getNodesInfo();for(const l of i)yo(l.node),wl(l.node)}isEmpty(){return!this.nodesInfo.length}updateReplacement(i,l){if(l.updateTime===this.replacementUpdateTime)return;this.replacementUpdateTime=l.updateTime;const p=l.getReplacementRegionsForTile(i.toUnwrapped());for(const g of this.getNodesInfo()){const b=g.node.footprint;g.hiddenByReplacement=!!b&&!p.find(x=>x.footprint===b)}}getHeightAtTileCoord(i,l){const p=[],g=[0,0,0],b=X([]);for(const x of this.getNodesInfo()){const A=x.node.meshes[0],R=A.transformedAabb;if(i<R.min[0]||l<R.min[1]||i>R.max[0]||l>R.max[1])continue;if(x.node.hidden===!0)return{height:1/0,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};te(b,x.node.matrix),g[0]=i,g[1]=l,Tn(g,g,b);const O=(g[0]-A.aabb.min[0])/(A.aabb.max[0]-A.aabb.min[0])*$s|0,L=Math.min(63,(g[1]-A.aabb.min[1])/(A.aabb.max[1]-A.aabb.min[1])*$s|0)*$s+Math.min(63,O),B=A.heightmap[L];if(!(B<0&&x.node.footprint))return x.hiddenByReplacement?void 0:{height:B,maxHeight:x.feature.properties.height,hidden:!1,verticalScale:x.evaluatedScale[2]};if(x.node.footprint.grid.query(new Lt(i,l),new Lt(i,l),p),p.length>0)return{height:void 0,maxHeight:x.feature.properties.height,hidden:x.hiddenByReplacement,verticalScale:x.evaluatedScale[2]}}}}function Hl(u,i){return u instanceof lc&&!u.isLightConstant&&i}function sp(u,i,l,p,g,b,x,A){let R=(61440&i|(61440&i)>>4)>>8,O=(3840&i|(3840&i)>>4)>>4,L=240&i|(240&i)>>4;l[3]>0&&(R=$n(R,255*l[0],l[3]),O=$n(O,255*l[1],l[3]),L=$n(L,255*l[2],l[3]));const B=R<<8|O,U=L<<8|Math.floor(255*p[3]),q=function(Oe){const Le=He(Oe,0,2);return Math.min(Math.round(.5*Le*255),255)}(p[2])<<8|15*p[0]<<4|15*p[1],Y=He(g[0],0,1),ne=He(g[1],0,1),ae=He(g[2],0,1),he=He(g[3],0,1);let Se,Ae,re,ye;if(Y!==ne&&x!==b&&ne!==Y){const Oe=x-b;Ae=1/(Oe*(ne-Y)),re=-(b+Oe*Y)/(Oe*(ne-Y));const Le=He(g[4],-1,1);ye=Math.pow(10,Le),Se=255*ae<<8|255*he}else Se=65535,Ae=0,re=1,ye=1;if(u.emplaceBack(B,U,q,Se,Ae,re,ye),A){const Oe=A.length;A.clear();for(let Le=0;Le<Oe;Le++)A.emplaceBack(B,U,q,Se,Ae,re,ye)}}function Nb(u,i,l){const p=u.node;let g=0;const b=l&gm.HasMeshoptCompression;for(const x of p.meshes){if(p.lights&&p.lightMeshIndex===g||!x.featureData)continue;x.featureArray=new jp,x.featureArray.reserve(x.featureData.length);let A=i;for(const R of x.featureData){const O=b?65535&R:R>>16&65535,L=b?R>>16&65535:65535&R,B=(15&L)<8?15&L:0,U=u.evaluatedRMEA[B],q=u.evaluatedColor[B],Y=u.emissionHeightBasedParams[B];let ne;if(A&&B===2&&p.lights&&(ne=new jp,ne.resize(10*p.lights.length)),sp(x.featureArray,O,q,U,Y,x.aabb.min[2],x.aabb.max[2],ne),ne&&A){A=!1;const ae=p.meshes[p.lightMeshIndex];ae.featureArray=ne,ae.featureArray._trim()}}x.featureArray._trim(),g++}}function Kg(u,i,l,p){const g=1<<u.z;i.lat=_t((p/sn+u.y)/g),i.lng=et((l/sn+u.x)/g)}function zE(u,i,l,p){const g=u.getNodesInfo()[i];if(!g||g.hiddenByReplacement||!g.node.meshes)return;let b=Number.MAX_VALUE;const x=g.node,A=l.tile,R=p.calculatePosMatrix(A.tileID.toUnwrapped(),p.worldSize),O=g.evaluatedScale;let L=0;p.elevation&&x.elevation&&(L=x.elevation*p.elevation.exaggeration()),we(R,R,[(x.anchor?x.anchor[0]:0)*(O[0]-1),(x.anchor?x.anchor[1]:0)*(O[1]-1),L]),Ie(R,R,O);const B=l.queryGeometry,U=B.isPointQuery()?B.screenBounds:B.screenGeometry,q=function(ne){const ae=ie([],R,ne.matrix);ie(ae,p.expandedFarZProjMatrix,ae);for(let he=0;he<ne.meshes.length;++he){const Se=ne.meshes[he];if(he===ne.lightMeshIndex)continue;const Ae=Z1(U,p,ae,Se.aabb);Ae!=null&&(b=Math.min(Ae,b))}if(ne.children)for(const he of ne.children)q(he)};if(q(x),b===Number.MAX_VALUE)return;const Y=new ge(0,0);return Kg(A.tileID.canonical,Y,g.node.anchor[0],g.node.anchor[1]),{intersectionZ:b,position:Y,feature:g.feature}}vn(Pa,"Tiled3dModelBucket",{omit:["layers"]}),vn(Sc,"Tiled3dModelFeature");const Jg={circle:class extends ha{constructor(u,i,l,p){super(u,{layout:OT||(OT=new Lr({"circle-sort-key":new cn(pt.layout_circle["circle-sort-key"]),"circle-elevation-reference":new Gt(pt.layout_circle["circle-elevation-reference"]),visibility:new Gt(pt.layout_circle.visibility)})),paint:sC||(sC=new Lr({"circle-radius":new cn(pt.paint_circle["circle-radius"]),"circle-color":new cn(pt.paint_circle["circle-color"]),"circle-blur":new cn(pt.paint_circle["circle-blur"]),"circle-opacity":new cn(pt.paint_circle["circle-opacity"]),"circle-translate":new Gt(pt.paint_circle["circle-translate"]),"circle-translate-anchor":new Gt(pt.paint_circle["circle-translate-anchor"]),"circle-pitch-scale":new Gt(pt.paint_circle["circle-pitch-scale"]),"circle-pitch-alignment":new Gt(pt.paint_circle["circle-pitch-alignment"]),"circle-stroke-width":new cn(pt.paint_circle["circle-stroke-width"]),"circle-stroke-color":new cn(pt.paint_circle["circle-stroke-color"]),"circle-stroke-opacity":new cn(pt.paint_circle["circle-stroke-opacity"]),"circle-emissive-strength":new Gt(pt.paint_circle["circle-emissive-strength"]),"circle-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"circle-stroke-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p)}createBucket(u){return new Fl(u)}queryRadius(u){const i=u;return Vf("circle-radius",this,i)+Vf("circle-stroke-width",this,i)+Cy(this.paint.get("circle-translate"))}queryIntersectsFeature(u,i,l,p,g,b,x,A){const R=RT(this.paint.get("circle-translate"),this.paint.get("circle-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),O=this.paint.get("circle-radius").evaluate(i,l)+this.paint.get("circle-stroke-width").evaluate(i,l);return fC(u,p,b,x,A,this.paint.get("circle-pitch-alignment")==="map",this.paint.get("circle-pitch-scale")==="map",R,O)}getProgramIds(){return["circle"]}getDefaultProgramParams(u,i,l){const p=a1(this);return{config:new Bf(this,{zoom:i,lut:l}),defines:p,overrideFog:!1}}is3D(u){return!u&&!!this.layout&&this.layout.get("circle-elevation-reference")!=="none"}hasElevation(){return this.layout&&this.layout.get("circle-elevation-reference")!=="none"}},heatmap:class extends ha{createBucket(u){return new Pg(u)}constructor(u,i,l,p){super(u,{layout:eb||(eb=new Lr({visibility:new Gt(pt.layout_heatmap.visibility)})),paint:l1||(l1=new Lr({"heatmap-radius":new cn(pt.paint_heatmap["heatmap-radius"]),"heatmap-weight":new cn(pt.paint_heatmap["heatmap-weight"]),"heatmap-intensity":new Gt(pt.paint_heatmap["heatmap-intensity"]),"heatmap-color":new hd(pt.paint_heatmap["heatmap-color"]),"heatmap-opacity":new Gt(pt.paint_heatmap["heatmap-opacity"]),"heatmap-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="heatmap-color"&&this._updateColorRamp()}_updateColorRamp(){this.colorRamp=kg({expression:this._transitionablePaint._values["heatmap-color"].value.expression,evaluationKey:"heatmapDensity",image:this.colorRamp}),this.colorRampTexture=null}resize(){this.heatmapFbo&&(this.heatmapFbo.destroy(),this.heatmapFbo=null)}queryRadius(u){return Vf("heatmap-radius",this,u)}queryIntersectsFeature(u,i,l,p,g,b,x,A){const R=this.paint.get("heatmap-radius").evaluate(i,l);return fC(u,p,b,x,A,!0,!0,new Lt(0,0),R)}hasOffscreenPass(){return this.paint.get("heatmap-opacity")!==0&&this.visibility!=="none"}getProgramIds(){return["heatmap","heatmapTexture"]}getDefaultProgramParams(u,i,l){return u==="heatmap"?{config:new Bf(this,{zoom:i,lut:l}),overrideFog:!1}:{}}},hillshade:class extends ha{constructor(u,i,l,p){super(u,{layout:mC||(mC=new Lr({visibility:new Gt(pt.layout_hillshade.visibility)})),paint:c1||(c1=new Lr({"hillshade-illumination-direction":new Gt(pt.paint_hillshade["hillshade-illumination-direction"]),"hillshade-illumination-anchor":new Gt(pt.paint_hillshade["hillshade-illumination-anchor"]),"hillshade-exaggeration":new Gt(pt.paint_hillshade["hillshade-exaggeration"]),"hillshade-shadow-color":new Gt(pt.paint_hillshade["hillshade-shadow-color"]),"hillshade-highlight-color":new Gt(pt.paint_hillshade["hillshade-highlight-color"]),"hillshade-accent-color":new Gt(pt.paint_hillshade["hillshade-accent-color"]),"hillshade-emissive-strength":new Gt(pt.paint_hillshade["hillshade-emissive-strength"]),"hillshade-shadow-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-highlight-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"hillshade-accent-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p)}shouldRedrape(){return this.hasOffscreenPass()&&this.paint.get("hillshade-illumination-anchor")==="viewport"}hasOffscreenPass(){return this.paint.get("hillshade-exaggeration")!==0&&this.visibility!=="none"}getProgramIds(){return["hillshade","hillshadePrepare"]}getDefaultProgramParams(u,i,l){return{overrideFog:!1}}},fill:class extends ha{constructor(u,i,l,p){super(u,{layout:UT||(UT=new Lr({"fill-sort-key":new cn(pt.layout_fill["fill-sort-key"]),visibility:new Gt(pt.layout_fill.visibility),"fill-elevation-reference":new Gt(pt.layout_fill["fill-elevation-reference"]),"fill-construct-bridge-guard-rail":new cn(pt.layout_fill["fill-construct-bridge-guard-rail"])})),paint:Ny||(Ny=new Lr({"fill-antialias":new Gt(pt.paint_fill["fill-antialias"]),"fill-opacity":new cn(pt.paint_fill["fill-opacity"]),"fill-color":new cn(pt.paint_fill["fill-color"]),"fill-outline-color":new cn(pt.paint_fill["fill-outline-color"]),"fill-translate":new Gt(pt.paint_fill["fill-translate"]),"fill-translate-anchor":new Gt(pt.paint_fill["fill-translate-anchor"]),"fill-pattern":new cn(pt.paint_fill["fill-pattern"]),"fill-pattern-cross-fade":new Gt(pt.paint_fill["fill-pattern-cross-fade"]),"fill-emissive-strength":new Gt(pt.paint_fill["fill-emissive-strength"]),"fill-z-offset":new cn(pt.paint_fill["fill-z-offset"]),"fill-bridge-guard-rail-color":new cn(pt.paint_fill["fill-bridge-guard-rail-color"]),"fill-tunnel-structure-color":new cn(pt.paint_fill["fill-tunnel-structure-color"]),"fill-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-outline-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-bridge-guard-rail-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-tunnel-structure-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p)}getProgramIds(){const u=this.paint.get("fill-pattern"),i=u&&u.constantOr(1),l=[i?"fillPattern":"fill"];return this.paint.get("fill-antialias")&&l.push(i&&!this.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline"),l}getDefaultProgramParams(u,i,l){return{config:new Bf(this,{zoom:i,lut:l}),overrideFog:!1}}recalculate(u,i){super.recalculate(u,i);const l=this.paint._values["fill-outline-color"];l.value.kind==="constant"&&l.value.value===void 0&&(this.paint._values["fill-outline-color"]=this.paint._values["fill-color"])}createBucket(u){return new VT(u)}queryRadius(){return Cy(this.paint.get("fill-translate"))}queryIntersectsFeature(u,i,l,p,g,b){return!u.queryGeometry.isAboveHorizon&&pc(Jx(u.tilespaceGeometry,this.paint.get("fill-translate"),this.paint.get("fill-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),p)}isTileClipped(){return this.paint.get("fill-z-offset").constantOr(1)===0}is3D(u){if(this.paint.get("fill-z-offset").constantOr(1)!==0)return!0;const i=this.layout&&this.layout.get("fill-elevation-reference")!=="none";return u!=null?i&&!u:i}hasElevation(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}hasShadowPass(){return this.layout&&this.layout.get("fill-elevation-reference")!=="none"}},"fill-extrusion":class extends ha{constructor(u,i,l,p){super(u,{layout:zC||(zC=new Lr({visibility:new Gt(pt["layout_fill-extrusion"].visibility),"fill-extrusion-edge-radius":new Gt(pt["layout_fill-extrusion"]["fill-extrusion-edge-radius"])})),paint:BC||(BC=new Lr({"fill-extrusion-opacity":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-opacity"]),"fill-extrusion-color":new cn(pt["paint_fill-extrusion"]["fill-extrusion-color"]),"fill-extrusion-translate":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-translate"]),"fill-extrusion-translate-anchor":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-translate-anchor"]),"fill-extrusion-pattern":new cn(pt["paint_fill-extrusion"]["fill-extrusion-pattern"]),"fill-extrusion-pattern-cross-fade":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-pattern-cross-fade"]),"fill-extrusion-height":new cn(pt["paint_fill-extrusion"]["fill-extrusion-height"]),"fill-extrusion-base":new cn(pt["paint_fill-extrusion"]["fill-extrusion-base"]),"fill-extrusion-height-alignment":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-height-alignment"]),"fill-extrusion-base-alignment":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-base-alignment"]),"fill-extrusion-vertical-gradient":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-vertical-gradient"]),"fill-extrusion-ambient-occlusion-intensity":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-intensity"]),"fill-extrusion-ambient-occlusion-radius":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-radius"]),"fill-extrusion-ambient-occlusion-wall-radius":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-wall-radius"]),"fill-extrusion-ambient-occlusion-ground-radius":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-radius"]),"fill-extrusion-ambient-occlusion-ground-attenuation":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-ambient-occlusion-ground-attenuation"]),"fill-extrusion-flood-light-color":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-color"]),"fill-extrusion-flood-light-intensity":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-intensity"]),"fill-extrusion-flood-light-wall-radius":new cn(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-wall-radius"]),"fill-extrusion-flood-light-ground-radius":new cn(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-radius"]),"fill-extrusion-flood-light-ground-attenuation":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-flood-light-ground-attenuation"]),"fill-extrusion-vertical-scale":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-vertical-scale"]),"fill-extrusion-rounded-roof":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-rounded-roof"]),"fill-extrusion-cutoff-fade-range":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-cutoff-fade-range"]),"fill-extrusion-emissive-strength":new cn(pt["paint_fill-extrusion"]["fill-extrusion-emissive-strength"]),"fill-extrusion-line-width":new cn(pt["paint_fill-extrusion"]["fill-extrusion-line-width"]),"fill-extrusion-cast-shadows":new Gt(pt["paint_fill-extrusion"]["fill-extrusion-cast-shadows"]),"fill-extrusion-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"fill-extrusion-flood-light-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new Wf(u)}queryRadius(){return Cy(this.paint.get("fill-extrusion-translate"))}is3D(u){return!0}hasShadowPass(){return this.paint.get("fill-extrusion-cast-shadows")}cutoffRange(){return this.paint.get("fill-extrusion-cutoff-fade-range")}canCastShadows(){return!0}getProgramIds(){return[this.paint.get("fill-extrusion-pattern").constantOr(1)?"fillExtrusionPattern":"fillExtrusion"]}queryIntersectsFeature(u,i,l,p,g,b,x,A,R){const O=RT(this.paint.get("fill-extrusion-translate"),this.paint.get("fill-extrusion-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),L=this.paint.get("fill-extrusion-height").evaluate(i,l),B=this.paint.get("fill-extrusion-base").evaluate(i,l),U=[0,0],q=A&&b.elevation,Y=b.elevation?b.elevation.exaggeration():1,ne=u.tile.getBucket(this);if(q&&ne instanceof Wf){const re=ne.centroidVertexArray,ye=R+1;ye<re.length&&(U[0]=re.geta_centroid_pos0(ye),U[1]=re.geta_centroid_pos1(ye))}if(U[0]===0&&U[1]===1)return!1;b.projection.name==="globe"&&(p=QT([p],[new Lt(0,0),new Lt(sn,sn)],u.tileID.canonical).map(re=>re.polygon).flat());const ae=q?A:null,[he,Se]=function(re,ye,Oe,Le,nt,Qe,st,dt,a,h,v){return re.projection.name==="globe"?function(S,I,k,K,ee,me,De,it,yt,ct,ut){const Ct=[],mn=[],tn=S.projection.upVectorScale(ut,S.center.lat,S.worldSize).metersToTile,Qt=[0,0,0,1],Je=[0,0,0,1],rt=(kt,Zt,On,An)=>{kt[0]=Zt,kt[1]=On,kt[2]=An,kt[3]=1},lt=mb();k>0&&(k+=lt),K+=lt;for(const kt of I){const Zt=[],On=[];for(const An of kt){const Yn=An.x+ee.x,Ce=An.y+ee.y,Me=S.projection.projectTilePoint(Yn,Ce,ut),wt=S.projection.upVector(ut,An.x,An.y);let Wt=k,un=K;if(De){const hn=Vg(Yn,Ce,k,K,De,it,yt,ct);Wt+=hn.base,un+=hn.top}k!==0?rt(Qt,Me.x+wt[0]*tn*Wt,Me.y+wt[1]*tn*Wt,Me.z+wt[2]*tn*Wt):rt(Qt,Me.x,Me.y,Me.z),rt(Je,Me.x+wt[0]*tn*un,Me.y+wt[1]*tn*un,Me.z+wt[2]*tn*un),Tn(Qt,Qt,me),Tn(Je,Je,me),Zt.push(new tm(Qt[0],Qt[1],Qt[2])),On.push(new tm(Je[0],Je[1],Je[2]))}Ct.push(Zt),mn.push(On)}return[Ct,mn]}(re,ye,Oe,Le,nt,Qe,st,dt,a,h,v):st?function(S,I,k,K,ee,me,De,it,yt){const ct=[],ut=[],Ct=[0,0,0,1];for(const mn of S){const tn=[],Qt=[];for(const Je of mn){const rt=Je.x+K.x,lt=Je.y+K.y,kt=Vg(rt,lt,I,k,me,De,it,yt);Ct[0]=rt,Ct[1]=lt,Ct[2]=kt.base,Ct[3]=1,Nr(Ct,Ct,ee),Ct[3]=Math.max(Ct[3],1e-5);const Zt=new tm(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);Ct[0]=rt,Ct[1]=lt,Ct[2]=kt.top,Ct[3]=1,Nr(Ct,Ct,ee),Ct[3]=Math.max(Ct[3],1e-5);const On=new tm(Ct[0]/Ct[3],Ct[1]/Ct[3],Ct[2]/Ct[3]);tn.push(Zt),Qt.push(On)}ct.push(tn),ut.push(Qt)}return[ct,ut]}(ye,Oe,Le,nt,Qe,st,dt,a,h):function(S,I,k,K,ee){const me=[],De=[],it=ee[8]*I,yt=ee[9]*I,ct=ee[10]*I,ut=ee[11]*I,Ct=ee[8]*k,mn=ee[9]*k,tn=ee[10]*k,Qt=ee[11]*k;for(const Je of S){const rt=[],lt=[];for(const kt of Je){const Zt=kt.x+K.x,On=kt.y+K.y,An=ee[0]*Zt+ee[4]*On+ee[12],Yn=ee[1]*Zt+ee[5]*On+ee[13],Ce=ee[2]*Zt+ee[6]*On+ee[14],Me=ee[3]*Zt+ee[7]*On+ee[15],wt=An+it,Wt=Yn+yt,un=Ce+ct,hn=Math.max(Me+ut,1e-5),En=An+Ct,Zn=Yn+mn,xi=Ce+tn,wi=Math.max(Me+Qt,1e-5);rt.push(new tm(wt/hn,Wt/hn,un/hn)),lt.push(new tm(En/wi,Zn/wi,xi/wi))}me.push(rt),De.push(lt)}return[me,De]}(ye,Oe,Le,nt,Qe)}(b,p,B,L,O,x,ae,U,Y,b.center.lat,u.tileID.canonical),Ae=u.queryGeometry;return function(re,ye,Oe){let Le=1/0;pc(Oe,ye)&&(Le=Fg(Oe,ye[0]));for(let nt=0;nt<ye.length;nt++){const Qe=ye[nt],st=re[nt];for(let dt=0;dt<Qe.length-1;dt++){const a=Qe[dt],h=[a,Qe[dt+1],st[dt+1],st[dt],a];Qa(Oe,h)&&(Le=Math.min(Le,Fg(Oe,h)))}}return Le!==1/0&&Le}(he,Se,Ae.isPointQuery()?Ae.screenBounds:Ae.screenGeometry)}},building:class extends ha{constructor(u,i,l,p){super(u,{layout:QC||(QC=new Lr({visibility:new Gt(pt.layout_building.visibility),"building-roof-shape":new cn(pt.layout_building["building-roof-shape"]),"building-height":new cn(pt.layout_building["building-height"]),"building-base":new cn(pt.layout_building["building-base"])})),paint:KC||(KC=new Lr({"building-opacity":new Gt(pt.paint_building["building-opacity"]),"building-ambient-occlusion-wall-intensity":new Gt(pt.paint_building["building-ambient-occlusion-wall-intensity"]),"building-ambient-occlusion-ground-intensity":new Gt(pt.paint_building["building-ambient-occlusion-ground-intensity"]),"building-ambient-occlusion-ground-radius":new Gt(pt.paint_building["building-ambient-occlusion-ground-radius"]),"building-ambient-occlusion-ground-attenuation":new Gt(pt.paint_building["building-ambient-occlusion-ground-attenuation"]),"building-vertical-scale":new Gt(pt.paint_building["building-vertical-scale"]),"building-cast-shadows":new Gt(pt.paint_building["building-cast-shadows"]),"building-color":new cn(pt.paint_building["building-color"]),"building-emissive-strength":new cn(pt.paint_building["building-emissive-strength"]),"building-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new XC(u)}},line:class extends ha{constructor(u,i,l,p){const g=Hg();super(u,g,i,l,p),g.layout&&(this.layout=new Cf(g.layout)),this.gradientVersion=0,this.hasElevatedBuckets=!1,this.hasNonElevatedBuckets=!1}_handleSpecialPaintPropertyUpdate(u){if(u==="line-gradient"){const i=this._transitionablePaint._values["line-gradient"].value.expression;this.stepInterpolant=i._styleExpression&&i._styleExpression.expression instanceof kp,this.gradientVersion=(this.gradientVersion+1)%Number.MAX_SAFE_INTEGER}}gradientExpression(){return this._transitionablePaint._values["line-gradient"].value.expression}widthExpression(){return this._transitionablePaint._values["line-width"].value.expression}recalculate(u,i){super.recalculate(u,i),this.paint._values["line-floorwidth"]=(()=>{if(Hy)return Hy;const l=Hg();return Hy=new oE(l.paint.properties["line-width"].specification),Hy.useIntegerZoom=!0,Hy})().possiblyEvaluate(this._transitioningPaint._values["line-width"].value,u)}createBucket(u){return new im(u)}getProgramIds(){return[this.paint.get("line-pattern").constantOr(1)?"linePattern":"line"]}getDefaultProgramParams(u,i,l){const p=D1(this);return{config:new Bf(this,{zoom:i,lut:l}),defines:p,overrideFog:!1}}queryRadius(u){const i=u,l=aE(Vf("line-width",this,i),Vf("line-gap-width",this,i)),p=Vf("line-offset",this,i);return l/2+Math.abs(p)+Cy(this.paint.get("line-translate"))}queryIntersectsFeature(u,i,l,p,g,b){if(u.queryGeometry.isAboveHorizon)return!1;const x=Jx(u.tilespaceGeometry,this.paint.get("line-translate"),this.paint.get("line-translate-anchor"),b.angle,u.pixelToTileUnitsFactor),A=u.pixelToTileUnitsFactor/2*aE(this.paint.get("line-width").evaluate(i,l),this.paint.get("line-gap-width").evaluate(i,l)),R=this.paint.get("line-offset").evaluate(i,l);return R&&(p=function(O,L){const B=[],U=new Lt(0,0);for(let q=0;q<O.length;q++){const Y=O[q],ne=[];for(let ae=0;ae<Y.length;ae++){const he=Y[ae],Se=Y[ae+1],Ae=ae===0?U:he.sub(Y[ae-1])._unit()._perp(),re=ae===Y.length-1?U:Se.sub(he)._unit()._perp(),ye=Ae._add(re)._unit();ye._mult(1/(ye.x*re.x+ye.y*re.y)),ne.push(ye._mult(L)._add(he))}B.push(ne)}return B}(p,R*u.pixelToTileUnitsFactor)),function(O,L,B){for(let U=0;U<L.length;U++){const q=L[U];if(O.length>=3){for(let Y=0;Y<q.length;Y++)if(uu(O,q[Y]))return!0}if(bd(O,q,B))return!0}return!1}(x,p,A)}isTileClipped(){return this.hasNonElevatedBuckets}isDraped(u){return!this.hasElevatedBuckets}hasElevation(){return this.layout&&this.layout.get("line-elevation-reference")!=="none"}},symbol:Rb,background:class extends ha{constructor(u,i,l,p){super(u,{layout:wD||(wD=new Lr({visibility:new Gt(pt.layout_background.visibility)})),paint:TE||(TE=new Lr({"background-pitch-alignment":new Gt(pt.paint_background["background-pitch-alignment"]),"background-color":new Gt(pt.paint_background["background-color"]),"background-pattern":new Gt(pt.paint_background["background-pattern"]),"background-opacity":new Gt(pt.paint_background["background-opacity"]),"background-emissive-strength":new Gt(pt.paint_background["background-emissive-strength"]),"background-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p)}getProgramIds(){return[this.paint.get("background-pattern")?"backgroundPattern":"background"]}getDefaultProgramParams(u,i,l){return{overrideFog:!1}}is3D(u){return this.paint.get("background-pitch-alignment")==="viewport"}},raster:CE,"raster-particle":DE,sky:class extends ha{constructor(u,i,l,p){super(u,{layout:Zg||(Zg=new Lr({visibility:new Gt(pt.layout_sky.visibility)})),paint:ov||(ov=new Lr({"sky-type":new Gt(pt.paint_sky["sky-type"]),"sky-atmosphere-sun":new Gt(pt.paint_sky["sky-atmosphere-sun"]),"sky-atmosphere-sun-intensity":new Gt(pt.paint_sky["sky-atmosphere-sun-intensity"]),"sky-gradient-center":new Gt(pt.paint_sky["sky-gradient-center"]),"sky-gradient-radius":new Gt(pt.paint_sky["sky-gradient-radius"]),"sky-gradient":new hd(pt.paint_sky["sky-gradient"]),"sky-atmosphere-halo-color":new Gt(pt.paint_sky["sky-atmosphere-halo-color"]),"sky-atmosphere-color":new Gt(pt.paint_sky["sky-atmosphere-color"]),"sky-opacity":new Gt(pt.paint_sky["sky-opacity"]),"sky-gradient-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-halo-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"}),"sky-atmosphere-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p),this._updateColorRamp()}_handleSpecialPaintPropertyUpdate(u){u==="sky-gradient"?this._updateColorRamp():u!=="sky-atmosphere-sun"&&u!=="sky-atmosphere-halo-color"&&u!=="sky-atmosphere-color"&&u!=="sky-atmosphere-sun-intensity"||(this._skyboxInvalidated=!0)}_updateColorRamp(){this.colorRamp=kg({expression:this._transitionablePaint._values["sky-gradient"].value.expression,evaluationKey:"skyRadialProgress"}),this.colorRampTexture&&(this.colorRampTexture.destroy(),this.colorRampTexture=null)}needsSkyboxCapture(u){if(this._skyboxInvalidated||!this.skyboxTexture||!this.skyboxGeometry)return!0;if(!this.paint.get("sky-atmosphere-sun")){const i=u.style.light.properties.get("position");return this._lightPosition.azimuthal!==i.azimuthal||this._lightPosition.polar!==i.polar}return!1}getCenter(u,i){if(this.paint.get("sky-type")==="atmosphere"){const p=this.paint.get("sky-atmosphere-sun"),g=!p,b=u.style.light,x=b.properties.get("position");return g&&b.properties.get("anchor")==="viewport"&&ii("The sun direction is attached to a light with viewport anchor, lighting may behave unexpectedly."),g?W1(x.azimuthal,90-x.polar,i):W1(p[0],90-p[1],i)}const l=this.paint.get("sky-gradient-center");return W1(l[0],90-l[1],i)}isSky(){return!0}markSkyboxValid(u){this._skyboxInvalidated=!1,this._lightPosition=u.style.light.properties.get("position")}hasOffscreenPass(){return!0}getProgramIds(){const u=this.paint.get("sky-type");return u==="atmosphere"?["skyboxCapture","skybox"]:u==="gradient"?["skyboxGradient"]:null}},slot:class extends ha{constructor(u,i,l,p){super(u,{paint:Zo||(Zo=new Lr({}))},i,null)}},model:class extends ha{constructor(u,i,l,p){super(u,{layout:NE||(NE=new Lr({visibility:new Gt(pt.layout_model.visibility),"model-id":new cn(pt.layout_model["model-id"])})),paint:Hd||(Hd=new Lr({"model-opacity":new cn(pt.paint_model["model-opacity"]),"model-rotation":new cn(pt.paint_model["model-rotation"]),"model-scale":new cn(pt.paint_model["model-scale"]),"model-translation":new cn(pt.paint_model["model-translation"]),"model-color":new cn(pt.paint_model["model-color"]),"model-color-mix-intensity":new cn(pt.paint_model["model-color-mix-intensity"]),"model-type":new Gt(pt.paint_model["model-type"]),"model-cast-shadows":new Gt(pt.paint_model["model-cast-shadows"]),"model-receive-shadows":new Gt(pt.paint_model["model-receive-shadows"]),"model-ambient-occlusion-intensity":new Gt(pt.paint_model["model-ambient-occlusion-intensity"]),"model-emissive-strength":new cn(pt.paint_model["model-emissive-strength"]),"model-roughness":new cn(pt.paint_model["model-roughness"]),"model-height-based-emissive-strength-multiplier":new cn(pt.paint_model["model-height-based-emissive-strength-multiplier"]),"model-cutoff-fade-range":new Gt(pt.paint_model["model-cutoff-fade-range"]),"model-front-cutoff":new Gt(pt.paint_model["model-front-cutoff"]),"model-color-use-theme":new cn({type:"string",default:"default","property-type":"data-driven"})}))},i,l,p),this._stats={numRenderedVerticesInShadowPass:0,numRenderedVerticesInTransparentPass:0}}createBucket(u){return new J1(u)}getProgramIds(){return["model"]}is3D(u){return!0}hasShadowPass(){return!0}canCastShadows(){return!0}hasLightBeamPass(){return!0}cutoffRange(){return this.paint.get("model-cutoff-fade-range")}queryRadius(u){return u instanceof Pa?sn-1:0}queryIntersectsFeature(u,i,l,p,g,b){if(!this.modelManager)return!1;const x=this.modelManager,A=u.tile.getBucket(this);if(!(A&&A instanceof J1))return!1;for(const R in A.instancesPerModel){const O=A.instancesPerModel[R],L=i.id!==void 0?i.id:i.properties&&i.properties.hasOwnProperty("id")?i.properties.id:void 0;if(O.idToFeaturesIndex.hasOwnProperty(L)){const B=O.features[O.idToFeaturesIndex[L]],U=x.getModel(R,this.scope);if(!U)return!1;let q=J();const Y=new ge(0,0),ne=A.canonical;let ae=Number.MAX_VALUE;for(let he=0;he<B.instancedDataCount;++he){const Se=16*(B.instancedDataOffset+he),Ae=O.instancedDataArray.float32,re=[Ae[Se+4],Ae[Se+5],Ae[Se+6]];Kg(ne,Y,Ae[Se],0|Ae[Se+1]),LE(q,U,b,Y,B.rotation,B.scale,re,!1,!1,!1),b.projection.name==="globe"&&(q=kb(q,b));const ye=ie([],b.projMatrix,q),Oe=u.queryGeometry,Le=Z1(Oe.isPointQuery()?Oe.screenBounds:Oe.screenGeometry,b,ye,U.aabb);Le!=null&&(ae=Math.min(Le,ae))}return ae!==Number.MAX_VALUE&&ae}}return!1}_handleOverridablePaintPropertyUpdate(u,i,l){return!(!this.layout||i.isDataDriven()||l.isDataDriven()||u!=="model-color"&&u!=="model-color-mix-intensity"&&u!=="model-rotation"&&u!=="model-scale"&&u!=="model-translation"&&u!=="model-emissive-strength")}_isPropertyZoomDependent(u){const i=this._transitionablePaint._values[u];return i!=null&&i.value!=null&&i.value.expression!=null&&i.value.expression instanceof Np}isZoomDependent(){return this._isPropertyZoomDependent("model-scale")||this._isPropertyZoomDependent("model-rotation")||this._isPropertyZoomDependent("model-translation")}},clip:class extends ha{constructor(u,i,l,p){super(u,{layout:jT||(jT=new Lr({"clip-layer-types":new Gt(pt.layout_clip["clip-layer-types"]),"clip-layer-scope":new Gt(pt.layout_clip["clip-layer-scope"])})),paint:Jp||(Jp=new Lr({}))},i,l,p)}recalculate(u,i){super.recalculate(u,i)}createBucket(u){return new xC(u)}is3D(u){return!0}}},uv=new Mi(0,0,0),ew={PATH_RULE_NON_ZERO:1,PATH_RULE_EVEN_ODD:2},ns={LINE_CAP_BUTT:1,LINE_CAP_ROUND:2,LINE_CAP_SQUARE:3},ws={LINE_JOIN_MITER:1,LINE_JOIN_MITER_CLIP:2,LINE_JOIN_ROUND:3,LINE_JOIN_BEVEL:4},Sr={PAINT_ORDER_FILL_AND_STROKE:1},ur={PATH_COMMAND_MOVE:1,PATH_COMMAND_LINE:2,PATH_COMMAND_QUAD:3,PATH_COMMAND_CUBIC:4,PATH_COMMAND_CLOSE:5},$l={MASK_TYPE_LUMINANCE:1};function Lb(u,i,l){u===1&&i.icons.push(function(p,g){return function(b){if(b.usvg_tree.height||(b.usvg_tree.height=b.usvg_tree.width),!b.metadata)return b;const{metadata:x}=b;if(x.content_area){const{content_area:A}=x;A.top==null&&(A.top=A.left),A.width==null&&(A.width=b.usvg_tree.width),A.height==null&&(A.height=A.width)}return x.stretch_x&&x.stretch_x.length&&ym(x,"x"),x.stretch_y&&x.stretch_y.length&&ym(x,"y"),b}(p.readFields(zb,{name:void 0},g))}(l,l.readVarint()+l.pos))}function ym(u,i){const l=[],p=u[`stretch_${i}`];let g=null;for(let b=0;b<p.length;b++)g===null?g=l.length===0?p[0]:l[l.length-1][1]+p[b]:(l.push([g,g+p[b]]),g=null);u[`stretch_${i}_areas`]=l}function zb(u,i,l){u===1?i.name=l.readString():u===2?i.metadata=function(p,g){return p.readFields(ID,{stretch_x:null,stretch_y:null,stretch_x_areas:null,stretch_y_areas:null,variables:[]},g)}(l,l.readVarint()+l.pos):u===3&&(i.usvg_tree=function(p,g){return p.readFields(Bb,{width:20,children:[],linear_gradients:[],radial_gradients:[],clip_paths:[],masks:[]},g)}(l,l.readVarint()+l.pos),i.data="usvg_tree")}function ID(u,i,l){u===1?i.stretch_x=l.readPackedVarint():u===2?i.stretch_y=l.readPackedVarint():u===3?i.content_area=function(p,g){return p.readFields(BE,{left:0},g)}(l,l.readVarint()+l.pos):u===4&&i.variables.push(function(p,g){return p.readFields(hv,{name:void 0},g)}(l,l.readVarint()+l.pos))}function BE(u,i,l){u===1?i.left=l.readVarint():u===2?i.width=l.readVarint():u===3?i.top=l.readVarint():u===4&&(i.height=l.readVarint())}function hv(u,i,l){u===1?i.name=l.readString():u===2&&(i.rgb_color=_u(l.readVarint()),i.value="rgb_color")}function Bb(u,i,l){u===1?i.width=i.height=l.readVarint():u===2?i.height=l.readVarint():u===3?i.children.push(dv(l,l.readVarint()+l.pos)):u===4?i.linear_gradients.push(function(p,g){return p.readFields(bm,{spread_method:1,stops:[],x1:0,y1:0,x2:1,y2:0},g)}(l,l.readVarint()+l.pos)):u===5?i.radial_gradients.push(function(p,g){return p.readFields(yu,{spread_method:1,stops:[],cx:.5,cy:.5,r:.5,fx:.5,fy:.5,fr:0},g)}(l,l.readVarint()+l.pos)):u===7?i.clip_paths.push(function(p,g){return p.readFields(t_,{children:[]},g)}(l,l.readVarint()+l.pos)):u===8&&i.masks.push(function(p,g){const b=p.readFields(Fb,{left:0,width:20,mask_type:$l.MASK_TYPE_LUMINANCE,children:[]},g);return b.height==null&&(b.height=b.width),b.top==null&&(b.top=b.left),b}(l,l.readVarint()+l.pos))}function dv(u,i){return u.readFields(e_,{},i)}function e_(u,i,l){u===1?(i.group=function(p,g){return p.readFields(Ts,{opacity:255,children:[]},g)}(l,l.readVarint()+l.pos),i.node="group"):u===2&&(i.path=function(p,g){return p.readFields(fv,{paint_order:1,commands:[],step:1,diffs:[],rule:ew.PATH_RULE_NON_ZERO},g)}(l,l.readVarint()+l.pos),i.node="path")}function Ts(u,i,l){u===1?i.transform=El(l,l.readVarint()+l.pos):u===2?i.opacity=l.readVarint():u===5?i.clip_path_idx=l.readVarint():u===6?i.mask_idx=l.readVarint():u===7&&i.children.push(dv(l,l.readVarint()+l.pos))}function El(u,i){return u.readFields(vm,{sx:1,ky:0,kx:0,sy:1,tx:0,ty:0},i)}function vm(u,i,l){u===1?i.sx=l.readFloat():u===2?i.ky=l.readFloat():u===3?i.kx=l.readFloat():u===4?i.sy=l.readFloat():u===5?i.tx=l.readFloat():u===6&&(i.ty=l.readFloat())}function fv(u,i,l){u===1?i.fill=function(p,g){return p.readFields(FE,{rgb_color:uv,paint:"rgb_color",opacity:255},g)}(l,l.readVarint()+l.pos):u===2?i.stroke=function(p,g){return p.readFields(Co,{rgb_color:uv,paint:"rgb_color",dasharray:[],dashoffset:0,miterlimit:4,opacity:255,width:1,linecap:1,linejoin:1},g)}(l,l.readVarint()+l.pos):u===3?i.paint_order=l.readVarint():u===5?l.readPackedVarint(i.commands):u===6?i.step=l.readFloat():u===7?l.readPackedSVarint(i.diffs):u===8&&(i.rule=l.readVarint())}function FE(u,i,l){u===1?(i.rgb_color=_u(l.readVarint()),i.paint="rgb_color"):u===2?(i.linear_gradient_idx=l.readVarint(),i.paint="linear_gradient_idx"):u===3?(i.radial_gradient_idx=l.readVarint(),i.paint="radial_gradient_idx"):u===5&&(i.opacity=l.readVarint())}function _u(u){return new Mi((u>>16&255)/255,(u>>8&255)/255,(255&u)/255,1)}function Co(u,i,l){u===1?(i.rgb_color=_u(l.readVarint()),i.paint="rgb_color"):u===2?(i.linear_gradient_idx=l.readVarint(),i.paint="linear_gradient_idx"):u===3?(i.radial_gradient_idx=l.readVarint(),i.paint="radial_gradient_idx"):u===5?l.readPackedFloat(i.dasharray):u===6?i.dashoffset=l.readFloat():u===7?i.miterlimit=l.readFloat():u===8?i.opacity=l.readVarint():u===9?i.width=l.readFloat():u===10?i.linecap=l.readVarint():u===11&&(i.linejoin=l.readVarint())}function bm(u,i,l){u===1?i.transform=El(l,l.readVarint()+l.pos):u===2?i.spread_method=l.readVarint():u===3?i.stops.push(op(l,l.readVarint()+l.pos)):u===4?i.x1=l.readFloat():u===5?i.y1=l.readFloat():u===6?i.x2=l.readFloat():u===7&&(i.y2=l.readFloat())}function op(u,i){return u.readFields(VE,{offset:0,opacity:255,rgb_color:uv},i)}function VE(u,i,l){u===1?i.offset=l.readFloat():u===2?i.opacity=l.readVarint():u===3&&(i.rgb_color=_u(l.readVarint()))}function yu(u,i,l){u===1?i.transform=El(l,l.readVarint()+l.pos):u===2?i.spread_method=l.readVarint():u===3?i.stops.push(op(l,l.readVarint()+l.pos)):u===4?i.cx=l.readFloat():u===5?i.cy=l.readFloat():u===6?i.r=l.readFloat():u===7?i.fx=l.readFloat():u===8?i.fy=l.readFloat():u===9&&(i.fr=l.readFloat())}function t_(u,i,l){u===1?i.transform=El(l,l.readVarint()+l.pos):u===2?i.clip_path_idx=l.readVarint():u===3&&i.children.push(dv(l,l.readVarint()+l.pos))}function Fb(u,i,l){u===1?i.left=i.top=l.readFloat():u===2?i.width=i.height=l.readFloat():u===3?i.top=l.readFloat():u===4?i.height=l.readFloat():u===5?i.mask_type=l.readVarint():u===6?i.mask_idx=l.readVarint():u===7&&i.children.push(dv(l,l.readVarint()+l.pos))}class Gl{static calculate(i={},l=[]){const p=new Map,g=new Map;if(Object.keys(i).length===0)return p;l.forEach(b=>{g.set(b.name,b.rgb_color||new Mi(0,0,0))});for(const[b,x]of Object.entries(i))g.has(b)?p.set(g.get(b).toString(),x):console.warn(`Ignoring unknown image variable "${b}"`);return p}}function ap(u,i=255,l){const p=i/255,g=u.toString(),b=l.has(g)?l.get(g).clone():u.clone();return b.a*=p,b.toString()}function n_(u,i){if(!Ha()){const l=document.createElement("canvas");return l.width=u,l.height=i,l}return new OffscreenCanvas(u,i)}function MD(u,i){const l=Gl.calculate(i.params,u.metadata?u.metadata.variables:[]),p=u.usvg_tree,g=p.width,b=p.height,x=i.transform?i.transform:new DOMMatrix,A=Math.max(1,Math.round(g*x.a)),R=Math.max(1,Math.round(b*x.d)),O=new DOMMatrix([A/g,0,0,R/b,0,0]),L=n_(A,R).getContext("2d");return pv(L,O,p,p,l),L.getImageData(0,0,A,R)}function pv(u,i,l,p,g){for(const b of p.children)UE(u,i,l,b,g)}function UE(u,i,l,p,g){p.group?(u.save(),function(b,x,A,R,O){const L=R.mask_idx!=null?A.masks[R.mask_idx]:null,B=R.clip_path_idx!=null?A.clip_paths[R.clip_path_idx]:null;if(R.transform&&(x=i_(R.transform).preMultiplySelf(x)),!function(Y,ne,ae){return Y.opacity!==255||ne||ae}(R,B!=null,L!=null))return void pv(b,x,A,R,O);const U=n_(b.canvas.width,b.canvas.height),q=U.getContext("2d");pv(q,x,A,R,O),B&&jE(q,x,A,B),L&&HE(q,x,A,L,O),b.globalAlpha=R.opacity/255,b.drawImage(U,0,0)}(u,i,l,p.group,g),u.restore()):p.path&&(u.save(),function(b,x,A,R,O){b.setTransform(x),R.paint_order===Sr.PAINT_ORDER_FILL_AND_STROKE?(mv(b,A,R,O),PD(b,A,R,O)):(PD(b,A,R,O),mv(b,A,R,O))}(u,i,l,p.path,g),u.restore())}function mv(u,i,l,p){const g=l.fill;if(!g)return;const b=g.opacity/255;switch(u.save(),u.beginPath(),LD(l,u),g.paint){case"rgb_color":u.fillStyle=ap(g.rgb_color,g.opacity,p);break;case"linear_gradient_idx":{const x=i.linear_gradients[g.linear_gradient_idx];x.transform&&u.setTransform(i_(x.transform).preMultiplySelf(u.getTransform())),u.fillStyle=kD(u,x,b,p);break}case"radial_gradient_idx":{const x=i.radial_gradients[g.radial_gradient_idx];x.transform&&u.setTransform(i_(x.transform).preMultiplySelf(u.getTransform())),u.fillStyle=ND(u,x,b,p)}}u.fill(lp(l)),u.restore()}function lp(u){return u.rule===ew.PATH_RULE_NON_ZERO?"nonzero":u.rule===ew.PATH_RULE_EVEN_ODD?"evenodd":void 0}function PD(u,i,l,p){const g=l.stroke;if(!g)return;const b=tw(l);u.lineWidth=g.width,u.miterLimit=g.miterlimit,u.setLineDash(g.dasharray),u.lineDashOffset=g.dashoffset;const x=g.opacity/255;switch(g.paint){case"rgb_color":u.strokeStyle=ap(g.rgb_color,g.opacity,p);break;case"linear_gradient_idx":u.strokeStyle=kD(u,i.linear_gradients[g.linear_gradient_idx],x,p,!0);break;case"radial_gradient_idx":u.strokeStyle=ND(u,i.radial_gradients[g.radial_gradient_idx],x,p,!0)}switch(g.linejoin){case ws.LINE_JOIN_MITER_CLIP:case ws.LINE_JOIN_MITER:u.lineJoin="miter";break;case ws.LINE_JOIN_ROUND:u.lineJoin="round";break;case ws.LINE_JOIN_BEVEL:u.lineJoin="bevel"}switch(g.linecap){case ns.LINE_CAP_BUTT:u.lineCap="butt";break;case ns.LINE_CAP_ROUND:u.lineCap="round";break;case ns.LINE_CAP_SQUARE:u.lineCap="square"}u.stroke(b)}function kD(u,i,l,p,g=!1){if(i.stops.length===1){const U=i.stops[0];return ap(U.rgb_color,U.opacity*l,p)}const{x1:b,y1:x,x2:A,y2:R}=i;let O=new DOMPoint(b,x),L=new DOMPoint(A,R);if(g){const U=i_(i.transform);O=U.transformPoint(O),L=U.transformPoint(L)}const B=u.createLinearGradient(O.x,O.y,L.x,L.y);for(const U of i.stops)B.addColorStop(U.offset,ap(U.rgb_color,U.opacity*l,p));return B}function ND(u,i,l,p,g=!1){if(i.stops.length===1){const he=i.stops[0];return ap(he.rgb_color,he.opacity*l,p)}const b=i_(i.transform),{fx:x,fy:A,fr:R,cx:O,cy:L,r:B}=i;let U=new DOMPoint(x,A),q=new DOMPoint(O,L),Y=R,ne=B;if(g){U=b.transformPoint(U),q=b.transformPoint(q);const he=(b.a+b.d)/2;Y=R*he,ne=i.r*he}const ae=u.createRadialGradient(U.x,U.y,Y,q.x,q.y,ne);for(const he of i.stops)ae.addColorStop(he.offset,ap(he.rgb_color,he.opacity*l,p));return ae}function xm(u,i,l,p){const g=p.transform?i_(p.transform).preMultiplySelf(i):i,b=n_(u.canvas.width,u.canvas.height),x=b.getContext("2d");for(const R of p.children)if(R.group)xm(x,g,l,R.group);else if(R.path){const O=R.path,L=new Path2D;L.addPath(tw(O),g),x.fill(L,lp(O))}const A=p.clip_path_idx!=null?l.clip_paths[p.clip_path_idx]:null;A&&jE(x,g,l,A),u.globalCompositeOperation="source-over",u.drawImage(b,0,0)}function jE(u,i,l,p){const g=n_(u.canvas.width,u.canvas.height);xm(g.getContext("2d"),i,l,p),u.globalCompositeOperation="destination-in",u.drawImage(g,0,0)}function HE(u,i,l,p,g){if(p.children.length===0)return;const b=p.mask_idx!=null?l.masks[p.mask_idx]:null;b&&HE(u,i,l,b,g);const x=u.canvas.width,A=u.canvas.height,R=n_(x,A),O=R.getContext("2d"),L=p.width,B=p.height,U=p.left,q=p.top,Y=new Path2D,ne=new Path2D;ne.rect(U,q,L,B),Y.addPath(ne,i),O.clip(Y);for(const Se of p.children)UE(O,i,l,Se,g);const ae=O.getImageData(0,0,x,A),he=ae.data;if(p.mask_type===$l.MASK_TYPE_LUMINANCE)for(let Se=0;Se<he.length;Se+=4)he[Se+3]=he[Se+3]/255*(.2126*he[Se]+.7152*he[Se+1]+.0722*he[Se+2]);O.putImageData(ae,0,0),u.globalCompositeOperation="destination-in",u.drawImage(R,0,0)}function i_(u){return u?new DOMMatrix([u.sx,u.ky,u.kx,u.sy,u.tx,u.ty]):new DOMMatrix}function LD(u,i){const l=u.step;let p=u.diffs[0]*l,g=u.diffs[1]*l;i.moveTo(p,g);for(let b=0,x=2;b<u.commands.length;b++)switch(u.commands[b]){case ur.PATH_COMMAND_MOVE:p+=u.diffs[x++]*l,g+=u.diffs[x++]*l,i.moveTo(p,g);break;case ur.PATH_COMMAND_LINE:p+=u.diffs[x++]*l,g+=u.diffs[x++]*l,i.lineTo(p,g);break;case ur.PATH_COMMAND_QUAD:{const A=p+u.diffs[x++]*l,R=g+u.diffs[x++]*l;p=A+u.diffs[x++]*l,g=R+u.diffs[x++]*l,i.quadraticCurveTo(A,R,p,g);break}case ur.PATH_COMMAND_CUBIC:{const A=p+u.diffs[x++]*l,R=g+u.diffs[x++]*l,O=A+u.diffs[x++]*l,L=R+u.diffs[x++]*l;p=O+u.diffs[x++]*l,g=L+u.diffs[x++]*l,i.bezierCurveTo(A,R,O,L,p,g);break}case ur.PATH_COMMAND_CLOSE:i.closePath()}return i}function tw(u){return LD(u,new Path2D)}class Xo{constructor(i){this.capacity=i,this.cache=new Map}get(i){if(!this.cache.has(i))return;const l=this.cache.get(i);return this.cache.delete(i),this.cache.set(i,l),l}put(i,l){this.cache.has(i)?this.cache.delete(i):this.cache.size===this.capacity&&this.cache.delete(this.cache.keys().next().value),this.cache.set(i,l)}delete(i){this.cache.delete(i)}}vn(Xo,"LRUCache");class $d{constructor(){this.cacheMap=new Map,this.cacheDependenciesMap=new Map}static _getImage(i){return new go(i,i.data)}getFromCache(i,l,p){return this.cacheMap.has(p)||this.cacheMap.set(p,new Xo(150)),this.cacheMap.get(p).get(ru(i.toString(),l))}setInCache(i,l,p,g){this.cacheDependenciesMap.has(g)||this.cacheDependenciesMap.set(g,new Map),this.cacheMap.has(g)||this.cacheMap.set(g,new Xo(150));const b=this.cacheDependenciesMap.get(g),x=ru(i.id.toString(),p);b.get(x)||b.set(x,new Set);const A=this.cacheMap.get(g),R=i.toString();b.get(x).add(R),A.put(ru(i.toString(),p),l)}removeImagesFromCacheByIds(i,l,p=0){if(!this.cacheMap.has(p)||!this.cacheDependenciesMap.has(p))return;const g=this.cacheMap.get(p),b=this.cacheDependenciesMap.get(p);for(const x of i){const A=ru(x.toString(),l);if(b.has(A)){for(const R of b.get(A))g.delete(R);b.delete(A)}}}rasterize(i,l,p,g,b=MD){const x=this.getFromCache(i,p,g);if(x)return x.clone();const A=b(l.icon,i.options),R=$d._getImage(A);return this.setInCache(i,R,p,g),R.clone()}}class r_{constructor(i){this.size=i,this.minimums=[],this.maximums=[],this.leaves=[]}getElevation(i,l){const p=this.toIdx(i,l);return{min:this.minimums[p],max:this.maximums[p]}}isLeaf(i,l){return this.leaves[this.toIdx(i,l)]}toIdx(i,l){return l*this.size+i}}function cp(u,i,l,p){let g=0,b=Number.MAX_VALUE;for(let x=0;x<3;x++)if(Math.abs(p[x])<1e-15){if(l[x]<u[x]||l[x]>i[x])return null}else{const A=1/p[x];let R=(u[x]-l[x])*A,O=(i[x]-l[x])*A;if(R>O){const L=R;R=O,O=L}if(R>g&&(g=R),O<b&&(b=O),g>b)return null}return g}function nw(u,i,l,p,g,b,x,A,R,O,L){const B=p-u,U=g-i,q=b-l,Y=x-u,ne=A-i,ae=R-l,he=L[1]*ae-L[2]*ne,Se=L[2]*Y-L[0]*ae,Ae=L[0]*ne-L[1]*Y,re=B*he+U*Se+q*Ae;if(Math.abs(re)<1e-15)return null;const ye=1/re,Oe=O[0]-u,Le=O[1]-i,nt=O[2]-l,Qe=(Oe*he+Le*Se+nt*Ae)*ye;if(Qe<0||Qe>1)return null;const st=Le*q-nt*U,dt=nt*B-Oe*q,a=Oe*U-Le*B,h=(L[0]*st+L[1]*dt+L[2]*a)*ye;return h<0||Qe+h>1?null:(Y*st+ne*dt+ae*a)*ye}function iw(u,i,l){return(u-i)/(l-i)}function $E(u,i,l,p,g,b,x,A,R){const O=1<<l,L=b-p,B=x-g,U=(u+1)/O*L+p,q=(i+0)/O*B+g,Y=(i+1)/O*B+g;A[0]=(u+0)/O*L+p,A[1]=q,R[0]=U,R[1]=Y}class zD{constructor(i){if(this.maximums=[],this.minimums=[],this.leaves=[],this.childOffsets=[],this.nodeCount=0,this.dem=i,this._siblingOffset=[[0,0],[1,0],[0,1],[1,1]],!this.dem)return;const l=function(b){const x=Math.ceil(Math.log2(b.dim/8)),A=[];let R=Math.ceil(Math.pow(2,x));const O=1/R,L=(q,Y,ne,ae,he)=>{const Se=ae?1:0,Ae=(q+1)*ne-Se,re=Y*ne,ye=(Y+1)*ne-Se;he[0]=q*ne,he[1]=re,he[2]=Ae,he[3]=ye};let B=new r_(R);const U=[];for(let q=0;q<R*R;q++){L(q%R,Math.floor(q/R),O,!1,U);const Y=Gd(U[0],U[1],b),ne=Gd(U[2],U[1],b),ae=Gd(U[2],U[3],b),he=Gd(U[0],U[3],b);B.minimums.push(Math.min(Y,ne,ae,he)),B.maximums.push(Math.max(Y,ne,ae,he)),B.leaves.push(1)}for(A.push(B),R/=2;R>=1;R/=2){const q=A[A.length-1];B=new r_(R);for(let Y=0;Y<R*R;Y++){L(Y%R,Math.floor(Y/R),2,!0,U);const ne=q.getElevation(U[0],U[1]),ae=q.getElevation(U[2],U[1]),he=q.getElevation(U[2],U[3]),Se=q.getElevation(U[0],U[3]),Ae=q.isLeaf(U[0],U[1]),re=q.isLeaf(U[2],U[1]),ye=q.isLeaf(U[2],U[3]),Oe=q.isLeaf(U[0],U[3]),Le=Math.min(ne.min,ae.min,he.min,Se.min),nt=Math.max(ne.max,ae.max,he.max,Se.max),Qe=Ae&&re&&ye&&Oe;B.maximums.push(nt),B.minimums.push(Le),B.leaves.push(nt-Le<=5&&Qe?1:0)}A.push(B)}return A}(this.dem),p=l.length-1,g=l[p];this._addNode(g.minimums[0],g.maximums[0],g.leaves[0]),this._construct(l,0,0,p,0)}raycastRoot(i,l,p,g,b,x,A=1){return cp([i,l,-100],[p,g,this.maximums[0]*A],b,x)}raycast(i,l,p,g,b,x,A=1){if(!this.nodeCount)return null;const R=this.raycastRoot(i,l,p,g,b,x,A);if(R==null)return null;const O=[],L=[],B=[],U=[],q=[{idx:0,t:R,nodex:0,nodey:0,depth:0}];for(;q.length>0;){const{idx:Y,t:ne,nodex:ae,nodey:he,depth:Se}=q.pop();if(this.leaves[Y]){$E(ae,he,Se,i,l,p,g,B,U);const re=1<<Se,ye=(ae+0)/re,Oe=(ae+1)/re,Le=(he+0)/re,nt=(he+1)/re,Qe=Gd(ye,Le,this.dem)*A,st=Gd(Oe,Le,this.dem)*A,dt=Gd(Oe,nt,this.dem)*A,a=Gd(ye,nt,this.dem)*A,h=nw(B[0],B[1],Qe,U[0],B[1],st,U[0],U[1],dt,b,x),v=nw(U[0],U[1],dt,B[0],U[1],a,B[0],B[1],Qe,b,x),S=Math.min(h!==null?h:Number.MAX_VALUE,v!==null?v:Number.MAX_VALUE);if(S!==Number.MAX_VALUE)return S;{const I=Ot([],b,x,ne);if(gv(Qe,st,a,dt,iw(I[0],B[0],U[0]),iw(I[1],B[1],U[1]))>=I[2])return ne}continue}let Ae=0;for(let re=0;re<this._siblingOffset.length;re++){$E((ae<<1)+this._siblingOffset[re][0],(he<<1)+this._siblingOffset[re][1],Se+1,i,l,p,g,B,U),B[2]=-100,U[2]=this.maximums[this.childOffsets[Y]+re]*A;const ye=cp(B,U,b,x);if(ye!=null){const Oe=ye;O[re]=Oe;let Le=!1;for(let nt=0;nt<Ae&&!Le;nt++)Oe>=O[L[nt]]&&(L.splice(nt,0,re),Le=!0);Le||(L[Ae]=re),Ae++}}for(let re=0;re<Ae;re++){const ye=L[re];q.push({idx:this.childOffsets[Y]+ye,t:O[ye],nodex:(ae<<1)+this._siblingOffset[ye][0],nodey:(he<<1)+this._siblingOffset[ye][1],depth:Se+1})}}return null}_addNode(i,l,p){return this.minimums.push(i),this.maximums.push(l),this.leaves.push(p),this.childOffsets.push(0),this.nodeCount++}_construct(i,l,p,g,b){if(i[g].isLeaf(l,p)===1)return;this.childOffsets[b]||(this.childOffsets[b]=this.nodeCount);const x=g-1,A=i[x];let R=0,O=0;for(let L=0;L<this._siblingOffset.length;L++){const B=2*l+this._siblingOffset[L][0],U=2*p+this._siblingOffset[L][1],q=A.getElevation(B,U),Y=A.isLeaf(B,U),ne=this._addNode(q.min,q.max,Y);Y&&(R|=1<<L),O||(O=ne)}for(let L=0;L<this._siblingOffset.length;L++)R&1<<L||this._construct(i,2*l+this._siblingOffset[L][0],2*p+this._siblingOffset[L][1],x,O+L)}}function gv(u,i,l,p,g,b){return $n($n(u,l,b),$n(i,p,b),g)}function Gd(u,i,l){const p=l.dim,g=He(u*p-.5,0,p-1),b=He(i*p-.5,0,p-1),x=Math.floor(g),A=Math.floor(b),R=Math.min(x+1,p-1),O=Math.min(A+1,p-1);return gv(l.get(x,A),l.get(R,A),l.get(x,O),l.get(R,O),g-x,b-A)}const GE={mapbox:[6553.6,25.6,.1,1e4],terrarium:[256,1,1/256,32768]};function rw(u,i,l){return(256*u*256+256*i+l)/10-1e4}function VM(u,i,l){return 256*u+i+l/256-32768}class qd{get tree(){return this._tree||this._buildQuadTree(),this._tree}constructor(i,l,p,g=!1){if(this.uid=i,l.height!==l.width)throw new RangeError("DEM tiles must be square");if(p&&p!=="mapbox"&&p!=="terrarium")return void ii(`"${p}" is not a valid encoding type. Valid types include "mapbox" and "terrarium".`);this.stride=l.height;const b=this.dim=l.height-2,x=new Uint32Array(l.data.buffer);if(this.pixels=new Uint8Array(l.data.buffer),this.floatView=new Float32Array(l.data.buffer),this.borderReady=g,this._modifiedForSources={},!g){for(let R=0;R<b;R++)x[this._idx(-1,R)]=x[this._idx(0,R)],x[this._idx(b,R)]=x[this._idx(b-1,R)],x[this._idx(R,-1)]=x[this._idx(R,0)],x[this._idx(R,b)]=x[this._idx(R,b-1)];x[this._idx(-1,-1)]=x[this._idx(0,0)],x[this._idx(b,-1)]=x[this._idx(b-1,0)],x[this._idx(-1,b)]=x[this._idx(0,b-1)],x[this._idx(b,b)]=x[this._idx(b-1,b-1)]}const A=p==="terrarium"?VM:rw;for(let R=0;R<x.length;++R){const O=4*R;this.floatView[R]=A(this.pixels[O],this.pixels[O+1],this.pixels[O+2])}this._timestamp=Ho.now()}_buildQuadTree(){this._tree=new zD(this)}get(i,l,p=!1){p&&(i=He(i,-1,this.dim),l=He(l,-1,this.dim));const g=this._idx(i,l);return this.floatView[g]}set(i,l,p){const g=this._idx(i,l),b=this.floatView[g];return this.floatView[g]=p,p-b}static getUnpackVector(i){return GE[i]}_idx(i,l){if(i<-1||i>=this.dim+1||l<-1||l>=this.dim+1)throw new RangeError("out of range source coordinates for DEM data");return(l+1)*this.stride+(i+1)}static pack(i,l){const p=[0,0,0,0],g=qd.getUnpackVector(l);let b=Math.floor((i+g[3])/g[2]);return p[2]=b%256,b=Math.floor(b/256),p[1]=b%256,b=Math.floor(b/256),p[0]=b,p}getPixels(){return new _c({width:this.stride,height:this.stride},this.pixels)}backfillBorder(i,l,p){if(this.dim!==i.dim)throw new Error("dem dimension mismatch");let g=l*this.dim,b=l*this.dim+this.dim,x=p*this.dim,A=p*this.dim+this.dim;switch(l){case-1:g=b-1;break;case 1:b=g+1}switch(p){case-1:x=A-1;break;case 1:A=x+1}const R=-l*this.dim,O=-p*this.dim;for(let L=x;L<A;L++)for(let B=g;B<b;B++){const U=4*this._idx(B,L),q=4*this._idx(B+R,L+O);this.pixels[U+0]=i.pixels[q+0],this.pixels[U+1]=i.pixels[q+1],this.pixels[U+2]=i.pixels[q+2],this.pixels[U+3]=i.pixels[q+3]}}onDeserialize(){this._tree&&(this._tree.dem=this)}}function Vb(u,i,l){u===1?i.headerLength=l.readFixed32():u===2?i.x=l.readVarint():u===3?i.y=l.readVarint():u===4?i.z=l.readVarint():u===5&&i.layers.push(function(p,g){return p.readFields(UM,{version:0,name:"",units:"",tileSize:0,buffer:0,pixelFormat:0,dataIndex:[]},g)}(l,l.readVarint()+l.pos))}function _v(u,i,l){u===1?(i.delta_filter=function(p,g){return p.readFields(sw,{blockSize:0},g)}(l,l.readVarint()+l.pos),i.filter="delta_filter"):u===2?(l.readVarint(),i.filter="zigzag_filter"):u===3?(l.readVarint(),i.filter="bitshuffle_filter"):u===4&&(l.readVarint(),i.filter="byteshuffle_filter")}function sw(u,i,l){u===1&&(i.blockSize=l.readVarint())}function BD(u,i,l){u===1?(l.readVarint(),i.codec="gzip_data"):u===2?(l.readVarint(),i.codec="jpeg_image"):u===3?(l.readVarint(),i.codec="webp_image"):u===4&&(l.readVarint(),i.codec="png_image")}function FD(u,i,l){let p=0,g=0;u===1?i.firstByte=l.readFixed64():u===2?i.lastByte=l.readFixed64():u===3?i.filters.push(function(b,x){return b.readFields(_v,{},x)}(l,l.readVarint()+l.pos)):u===4?i.codec=function(b,x){return b.readFields(BD,{},x)}(l,l.readVarint()+l.pos):u===5?g=l.readFloat():u===6?p=l.readFloat():u===7?i.bands.push(l.readString()):u===8?i.offset=l.readDouble():u===9&&(i.scale=l.readDouble()),i.offset===0&&(i.offset=g),i.scale===0&&(i.scale=p)}function UM(u,i,l){u===1?i.version=l.readVarint():u===2?i.name=l.readString():u===3?i.units=l.readString():u===4?i.tileSize=l.readVarint():u===5?i.buffer=l.readVarint():u===6?i.pixelFormat=l.readVarint():u===7&&i.dataIndex.push(function(p,g){return p.readFields(FD,{firstByte:0,lastByte:0,filters:[],codec:null,offset:0,scale:0,bands:[]},g)}(l,l.readVarint()+l.pos))}function ow(u,i,l){if(u===2)(function(p,g,b){p.readFields(yv,b,g)})(l,l.readVarint()+l.pos,i);else if(u===3)throw new Error("Not implemented")}function yv(u,i,l){if(u===1){let p=0;const g=l.readVarint()+l.pos;for(;l.pos<g;)i[p++]=l.readVarint()}}function qE(u,i){if(i.length!==4)throw new Error(`Expected data of dimension 4 but got ${i.length}.`);let l=i[3];for(let p=2;p>=1;p--){const g=p===1?1:0,b=p===2?1:0;for(let x=0;x<i[0];x++){const A=i[1]*x;for(let R=g;R<i[1];R++){const O=i[2]*(R+A);for(let L=b;L<i[2];L++){const B=i[3]*(L+O);for(let U=0;U<i[3];U++){const q=B+U;u[q]+=u[q-l]}}}}l*=i[p]}return u}function WE(u){for(let i=0,l=u.length;i<l;i++)u[i]=u[i]>>>1^-(1&u[i]);return u}function aw(u,i){switch(i){case"uint32":return u;case"uint16":for(let l=0;l<u.length;l+=2){const p=u[l],g=u[l+1];u[l]=(240&p)>>4|(61440&p)>>8|(240&g)<<4|61440&g,u[l+1]=15&p|(3840&p)>>4|(15&g)<<8|(3840&g)<<4}return u;case"uint8":for(let l=0;l<u.length;l+=4){const p=u[l],g=u[l+1],b=u[l+2],x=u[l+3];u[l+0]=(192&p)>>6|(192&g)>>4|(192&b)>>2|192&x,u[l+1]=(48&p)>>4|(48&g)>>2|48&b|(48&x)<<2,u[l+2]=(12&p)>>2|12&g|(12&b)<<2|(12&x)<<4,u[l+3]=3&p|(3&g)<<2|(3&b)<<4|(3&x)<<6}return u;default:throw new Error(`Invalid pixel format, "${i}"`)}}vn(qd,"DEMData"),vn(zD,"DemMinMaxQuadTree",{omit:["dem"]});var ql=Uint8Array,Uh=Uint16Array,YE=Int32Array,vv=new ql([0,0,0,0,0,0,0,0,1,1,1,1,2,2,2,2,3,3,3,3,4,4,4,4,5,5,5,5,0,0,0,0]),lw=new ql([0,0,0,0,1,1,2,2,3,3,4,4,5,5,6,6,7,7,8,8,9,9,10,10,11,11,12,12,13,13,0,0]),cw=new ql([16,17,18,0,8,7,9,6,10,5,11,4,12,3,13,2,14,1,15]),ZE=function(u,i){for(var l=new Uh(31),p=0;p<31;++p)l[p]=i+=1<<u[p-1];var g=new YE(l[30]);for(p=1;p<30;++p)for(var b=l[p];b<l[p+1];++b)g[b]=b-l[p]<<5|p;return{b:l,r:g}},XE=ZE(vv,2),Ub=XE.b,VD=XE.r;Ub[28]=258,VD[258]=28;for(var uw=ZE(lw,0).b,jb=new Uh(32768),Ys=0;Ys<32768;++Ys){var up=(43690&Ys)>>1|(21845&Ys)<<1;jb[Ys]=((65280&(up=(61680&(up=(52428&up)>>2|(13107&up)<<2))>>4|(3855&up)<<4))>>8|(255&up)<<8)>>1}var Hb=function(u,i,l){for(var p=u.length,g=0,b=new Uh(i);g<p;++g)u[g]&&++b[u[g]-1];var x,A=new Uh(i);for(g=1;g<i;++g)A[g]=A[g-1]+b[g-1]<<1;x=new Uh(1<<i);var R=15-i;for(g=0;g<p;++g)if(u[g])for(var O=g<<4|u[g],L=i-u[g],B=A[u[g]-1]++<<L,U=B|(1<<L)-1;B<=U;++B)x[jb[B]>>R]=O;return x},$b=new ql(288);for(Ys=0;Ys<144;++Ys)$b[Ys]=8;for(Ys=144;Ys<256;++Ys)$b[Ys]=9;for(Ys=256;Ys<280;++Ys)$b[Ys]=7;for(Ys=280;Ys<288;++Ys)$b[Ys]=8;var wm=new ql(32);for(Ys=0;Ys<32;++Ys)wm[Ys]=5;var QE=Hb($b,9),jM=Hb(wm,5),KE=function(u){for(var i=u[0],l=1;l<u.length;++l)u[l]>i&&(i=u[l]);return i},Ac=function(u,i,l){var p=i/8|0;return(u[p]|u[p+1]<<8)>>(7&i)&l},bv=function(u,i){var l=i/8|0;return(u[l]|u[l+1]<<8|u[l+2]<<16)>>(7&i)},hp=["unexpected EOF","invalid block type","invalid length/literal","invalid distance","stream finished","no stream handler",,"no callback","invalid UTF-8 data","extra field too long","date not in range 1980-2099","filename too long","stream finishing","invalid zip data"],Wl=function(u,i,l){var p=new Error(i||hp[u]);if(p.code=u,Error.captureStackTrace&&Error.captureStackTrace(p,Wl),!l)throw p;return p},HM=new ql(0),$M=typeof TextDecoder<"u"&&new TextDecoder;try{$M.decode(HM,{stream:!0})}catch{}const GM={gzip_data:"gzip"};class Cc extends Error{constructor(i){super(i),this.name="MRTError"}}const UD={0:"uint32",1:"uint32",2:"uint16",3:"uint8"},JE={uint32:1,uint16:2,uint8:4},qM={uint32:Uint32Array,uint16:Uint16Array,uint8:Uint8Array};let jh;class dp{constructor(i=5){this.x=NaN,this.y=NaN,this.z=NaN,this.layers={},this._cacheSize=i}getLayer(i){const l=this.layers[i];if(!l)throw new Cc(`Layer '${i}' not found`);return l}getHeaderLength(i){const l=new Uint8Array(i),p=new DataView(i);if(l[0]!==13)throw new Cc("File is not a valid MRT.");return p.getUint32(1,!0)}parseHeader(i){const l=new Uint8Array(i),p=this.getHeaderLength(i);if(l.length<p)throw new Cc(`Expected header with length >= ${p} but got buffer of length ${l.length}`);const g=function(b,x){return b.readFields(Vb,{headerLength:0,x:0,y:0,z:0,layers:[]},void 0)}(new jh(l.subarray(0,p)));if(!isNaN(this.x)&&(this.x!==g.x||this.y!==g.y||this.z!==g.z))throw new Cc(`Invalid attempt to parse header ${g.z}/${g.x}/${g.y} for tile ${this.z}/${this.x}/${this.y}`);this.x=g.x,this.y=g.y,this.z=g.z;for(const b of g.layers)this.layers[b.name]=new Gb(b,{cacheSize:this._cacheSize});return this}createDecodingTask(i){const l=[],p=this.getLayer(i.layerName);for(let g of i.blockIndices){const b=p.dataIndex[g],x=b.firstByte-i.firstByte,A=b.lastByte-i.firstByte;if(p._blocksInProgress.has(g))continue;const R={layerName:p.name,firstByte:x,lastByte:A,pixelFormat:p.pixelFormat,blockIndex:g,blockShape:[b.bands.length].concat(p.bandShape),buffer:p.buffer,codec:b.codec.codec,filters:b.filters.map(O=>O.filter)};p._blocksInProgress.add(g),l.push(R)}return new hw(l,()=>{l.forEach(g=>p._blocksInProgress.delete(g.blockIndex))},(g,b)=>{if(l.forEach(x=>p._blocksInProgress.delete(x.blockIndex)),g)throw g;b.forEach(x=>{this.getLayer(x.layerName).processDecodedData(x)})})}}class Gb{constructor({version:i,name:l,units:p,tileSize:g,pixelFormat:b,buffer:x,dataIndex:A},R){if(this.version=i,this.version!==1)throw new Cc(`Cannot parse raster layer encoded with MRT version ${i}`);this.name=l,this.units=p,this.tileSize=g,this.buffer=x,this.pixelFormat=UD[b],this.dataIndex=A,this.bandShape=[g+2*x,g+2*x,JE[this.pixelFormat]],this._decodedBlocks=new Xo(R?R.cacheSize:5),this._blocksInProgress=new Set}get dimension(){return JE[this.pixelFormat]}get cacheSize(){return this._decodedBlocks.capacity}getBandList(){return this.dataIndex.map(({bands:i})=>i).flat()}processDecodedData(i){const l=i.blockIndex.toString();this._decodedBlocks.get(l)||this._decodedBlocks.put(l,i.data)}getBlockForBand(i){let l=0;switch(typeof i){case"string":for(const[p,g]of this.dataIndex.entries()){for(const[b,x]of g.bands.entries())if(x===i)return{bandIndex:l+b,blockIndex:p,blockBandIndex:b};l+=g.bands.length}break;case"number":for(const[p,g]of this.dataIndex.entries()){if(i>=l&&i<l+g.bands.length)return{bandIndex:i,blockIndex:p,blockBandIndex:i-l};l+=g.bands.length}break;default:throw new Cc(`Invalid band \`${JSON.stringify(i)}\`. Expected string or integer.`)}return{blockIndex:-1,blockBandIndex:-1}}getDataRange(i){let l=1/0,p=-1/0;const g=[],b=new Set;for(const x of i){const{blockIndex:A}=this.getBlockForBand(x);if(A<0)throw new Cc(`Invalid band: ${JSON.stringify(x)}`);const R=this.dataIndex[A];g.includes(A)||g.push(A),b.add(A),l=Math.min(l,R.firstByte),p=Math.max(p,R.lastByte)}if(b.size>this.cacheSize)throw new Cc(`Number of blocks to decode (${b.size}) exceeds cache size (${this.cacheSize}).`);return{layerName:this.name,firstByte:l,lastByte:p,blockIndices:g}}hasBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0}hasDataForBand(i){const{blockIndex:l}=this.getBlockForBand(i);return l>=0&&!!this._decodedBlocks.get(l.toString())}getBandView(i){const{blockIndex:l,blockBandIndex:p}=this.getBlockForBand(i);if(l<0)throw new Cc(`Band not found: ${JSON.stringify(i)}`);const g=this._decodedBlocks.get(l.toString());if(!g)throw new Cc(`Data for band ${JSON.stringify(i)} of layer "${this.name}" not decoded.`);const b=this.dataIndex[l],x=this.bandShape.reduce((O,L)=>O*L,1),A=p*x,R=g.subarray(A,A+x);return{data:R,bytes:new Uint8Array(R.buffer).subarray(R.byteOffset,R.byteOffset+R.byteLength),tileSize:this.tileSize,buffer:this.buffer,pixelFormat:this.pixelFormat,dimension:this.dimension,offset:b.offset,scale:b.scale}}}dp.setPbf=function(u){jh=u};class hw{constructor(i,l,p){this.tasks=i,this._onCancel=l,this._onComplete=p,this._finalized=!1}cancel(){this._finalized||(this._onCancel(),this._finalized=!0)}complete(i,l){this._finalized||(this._onComplete(i,l),this._finalized=!0)}}function fp(u,i){const l=u.json.bufferViews[i.bufferView],p=A1[i.componentType];return new p(u.buffers[l.buffer],(i.byteOffset||0)+(l.byteOffset||0),i.count*(l.byteStride&&l.byteStride!==yb[i.type]*p.BYTES_PER_ELEMENT?l.byteStride/p.BYTES_PER_ELEMENT:yb[i.type]))}function dw(u,i,l,p){const g=A1[i.componentType],b=function(L){switch(L){case Int8Array:return 1/127;case Uint8Array:return 1/255;case Int16Array:return 1/32767;case Uint16Array:return 1/65535;default:return 1}}(g),x=u.json.bufferViews[i.bufferView],A=x.byteStride?x.byteStride/g.BYTES_PER_ELEMENT:yb[i.type],R=l.float32,O=R.length/l.capacity;for(let L=0,B=0;L<i.count*A;L+=A,B+=O)for(let U=0;U<O;U++)R[B+U]=p[L+U]*b;l._trim()}function eS(u,i,l){const p=u.indices,g=u.attributes,b={};b.indexArray=new mo;const x=i.json.accessors[p],A=x.count/3;b.indexArray.reserve(A);const R=fp(i,x);for(let U=0;U<A;U++)b.indexArray.emplaceBack(R[3*U],R[3*U+1],R[3*U+2]);b.indexArray._trim(),b.vertexArray=new su;const O=i.json.accessors[g.POSITION];b.vertexArray.reserve(O.count);const L=fp(i,O);for(let U=0;U<O.count;U++)b.vertexArray.emplaceBack(L[3*U],L[3*U+1],L[3*U+2]);if(b.vertexArray._trim(),b.aabb=new Vi(O.min,O.max),b.centroid=function(U,q){const Y=[0,0,0],ne=U.length;if(ne>0){for(let ae=0;ae<ne;ae++){const he=3*U[ae];Y[0]+=q[he],Y[1]+=q[he+1],Y[2]+=q[he+2]}Y[0]/=ne,Y[1]/=ne,Y[2]/=ne}return Y}(R,L),g.COLOR_0!==void 0){const U=i.json.accessors[g.COLOR_0],q=yb[U.type],Y=fp(i,U);b.colorArray=q===3?new su:new Eo,b.colorArray.resize(U.count),dw(i,U,b.colorArray,Y)}if(g.NORMAL!==void 0){b.normalArray=new su;const U=i.json.accessors[g.NORMAL];b.normalArray.resize(U.count);const q=fp(i,U);dw(i,U,b.normalArray,q)}if(g.TEXCOORD_0!==void 0&&l.length>0){b.texcoordArray=new _d;const U=i.json.accessors[g.TEXCOORD_0];b.texcoordArray.resize(U.count);const q=fp(i,U);dw(i,U,b.texcoordArray,q)}if(g._FEATURE_ID_RGBA4444!==void 0){const U=i.json.accessors[g._FEATURE_ID_RGBA4444];i.json.extensionsUsed&&i.json.extensionsUsed.includes("EXT_meshopt_compression")&&(b.featureData=fp(i,U))}g._FEATURE_RGBA4444!==void 0&&(b.featureData=new Uint32Array(fp(i,i.json.accessors[g._FEATURE_RGBA4444]).buffer));const B=u.material;return b.material=function(U,q){const{emissiveFactor:Y=[0,0,0],alphaMode:ne="OPAQUE",alphaCutoff:ae=.5,normalTexture:he,occlusionTexture:Se,emissiveTexture:Ae,doubleSided:re}=U,{baseColorFactor:ye=[1,1,1,1],metallicFactor:Oe=1,roughnessFactor:Le=1,baseColorTexture:nt,metallicRoughnessTexture:Qe}=U.pbrMetallicRoughness||{},st=Se?q[Se.index]:void 0;if(Se&&Se.extensions&&Se.extensions.KHR_texture_transform&&st){const dt=Se.extensions.KHR_texture_transform;st.offsetScale=[dt.offset[0],dt.offset[1],dt.scale[0],dt.scale[1]]}return{pbrMetallicRoughness:{baseColorFactor:new Mi(...ye),metallicFactor:Oe,roughnessFactor:Le,baseColorTexture:nt?q[nt.index]:void 0,metallicRoughnessTexture:Qe?q[Qe.index]:void 0},doubleSided:re,emissiveFactor:new Mi(...Y),alphaMode:ne,alphaCutoff:ae,normalTexture:he?q[he.index]:void 0,occlusionTexture:st,emissionTexture:Ae?q[Ae.index]:void 0,defined:U.defined===void 0}}(B!==void 0?i.json.materials[B]:{defined:!1},l),b}function tS(u,i,l){const{matrix:p,rotation:g,translation:b,scale:x,mesh:A,extras:R,children:O}=u,L={};if(L.matrix=p||function(B,U,q,Y){var ne=U[0],ae=U[1],he=U[2],Se=U[3],Ae=ne+ne,re=ae+ae,ye=he+he,Oe=ne*Ae,Le=ne*re,nt=ne*ye,Qe=ae*re,st=ae*ye,dt=he*ye,a=Se*Ae,h=Se*re,v=Se*ye,S=Y[0],I=Y[1],k=Y[2];return B[0]=(1-(Qe+dt))*S,B[1]=(Le+v)*S,B[2]=(nt-h)*S,B[3]=0,B[4]=(Le-v)*I,B[5]=(1-(Oe+dt))*I,B[6]=(st+a)*I,B[7]=0,B[8]=(nt+h)*k,B[9]=(st-a)*k,B[10]=(1-(Oe+Qe))*k,B[11]=0,B[12]=q[0],B[13]=q[1],B[14]=q[2],B[15]=1,B}([],g||[0,0,0,1],b||[0,0,0],x||[1,1,1]),A!==void 0){L.meshes=l[A];const B=L.anchor=[0,0];for(const U of L.meshes){const{min:q,max:Y}=U.aabb;B[0]+=q[0]+Y[0],B[1]+=q[1]+Y[1]}B[0]=Math.floor(B[0]/L.meshes.length/2),B[1]=Math.floor(B[1]/L.meshes.length/2)}if(R&&(R.id&&(L.id=R.id),R.lights&&(L.lights=function(B){if(!B.length)return[];const U=function(he){const Se=atob(he),Ae=new Uint8Array(Se.length);for(let re=0;re<Se.length;re++)Ae[re]=Se.codePointAt(re);return Ae}(B),q=[],Y=U.length/24,ne=new Uint16Array(U.buffer),ae=new Float32Array(U.buffer);for(let he=0;he<Y;he++){const Se=ne[2*he*6]/30,Ae=ne[2*he*6+1]/30,re=ne[2*he*6+10]/100,ye=ae[6*he+1],Oe=ae[6*he+2],Le=ae[6*he+3],nt=ae[6*he+4],Qe=Le-ye,st=nt-Oe,dt=Math.hypot(Qe,st);q.push({pos:[ye+.5*Qe,Oe+.5*st,Ae],normal:[st/dt,-Qe/dt,0],width:dt,height:Se,depth:re,points:[ye,Oe,Le,nt]})}return q}(R.lights))),O){const B=[];for(const U of O)B.push(tS(i.json.nodes[U],i,l));L.children=B}return L}function WM(u){if(u.vertices.length===0||u.indices.length===0)return null;const i=new ob(u.vertices,u.indices,8,256),[l,p]=[i.min.clone(),i.max.clone()];return{vertices:u.vertices,indices:u.indices,grid:i,min:l,max:p}}function s_(u){if(!u.extras||!u.extras.ground)return null;const i=u.extras.ground;if(!i||!Array.isArray(i)||i.length===0)return null;const l=i[0];if(!l||!Array.isArray(l)||l.length===0)return null;const p=[];for(const x of l){if(!Array.isArray(x)||x.length!==2)continue;const A=x[0],R=x[1];typeof A=="number"&&typeof R=="number"&&p.push(new Lt(A,R))}if(p.length<3)return null;p.length>1&&p[p.length-1].equals(p[0])&&p.pop();let g=0;for(let x=0;x<p.length;x++){const A=p[x],R=p[(x+1)%p.length],O=p[(x+2)%p.length];g+=(A.x-R.x)*(O.y-R.y)-(O.x-R.x)*(A.y-R.y)}g>0&&p.reverse();const b=Jt(p.flatMap(x=>[x.x,x.y]),[]);return b.length===0?null:{vertices:p,indices:b}}function jD(u,i){const l=[],p=[];let g=0;const b=[];for(const x of u){g=l.length;const A=x.vertexArray.float32,R=x.indexArray.uint16;for(let O=0;O<x.vertexArray.length;O++)b[0]=A[3*O+0],b[1]=A[3*O+1],b[2]=A[3*O+2],Tn(b,b,i),l.push(new Lt(b[0],b[1]));for(let O=0;O<3*x.indexArray.length;O++)p.push(R[O]+g)}if(p.length%3!=0)return null;for(let x=0;x<p.length;x+=3){const A=l[p[x+0]],R=l[p[x+1]],O=l[p[x+2]];(A.x-R.x)*(O.y-R.y)-(O.x-R.x)*(A.y-R.y)>0&&([p[x+1],p[x+2]]=[p[x+2],p[x+1]])}return{vertices:l,indices:p}}function HD(u){const i=function(R,O){const L=[],B=WebGL2RenderingContext;if(R.json.textures)for(const U of R.json.textures){const q={magFilter:B.LINEAR,minFilter:B.NEAREST,wrapS:B.REPEAT,wrapT:B.REPEAT};U.sampler!==void 0&&Object.assign(q,R.json.samplers[U.sampler]),L.push({image:O[U.source],sampler:q,uploaded:!1})}return L}(u,u.images),l=function(R,O){const L=[];for(const B of R.json.meshes){const U=[];for(const q of B.primitives)U.push(eS(q,R,O));L.push(U)}return L}(u,i),{scenes:p,scene:g,nodes:b}=u.json,x=p?p[g||0].nodes:b,A=[];for(const R of x)A.push(tS(b[R],u,l));return function(R,O,L){const B={},U=new Set;for(let q=0;q<R.length;q++){const Y=L[O[q]];if(!Y.extras)continue;const ne=Y.extras["mapbox:footprint:version"],ae=Y.extras["mapbox:footprint:id"];(ne||ae)&&U.add(q),ne==="1.0.0"&&ae&&(B[ae]=q)}for(let q=0;q<R.length;q++){if(U.has(q))continue;const Y=R[q],ne=L[O[q]];if(!ne.extras)continue;let ae=null;Y.id in B&&(ae=jD(R[B[Y.id]].meshes,Y.matrix)),ae||(ae=s_(ne)),ae&&(Y.footprint=WM(ae))}if(U.size>0){const q=Array.from(U.values()).sort((Y,ne)=>Y-ne);for(let Y=q.length-1;Y>=0;Y--)R.splice(q[Y],1)}}(A,x,u.json.nodes),A}function nS(u){u.heightmap=new Float32Array(4096),u.heightmap.fill(-1);const i=u.vertexArray.float32,l=u.aabb.min[0]-1,p=u.aabb.min[1]-1,g=$s/(u.aabb.max[0]-l+2),b=$s/(u.aabb.max[1]-p+2);for(let x=0;x<i.length;x+=3){const A=i[x+2],R=(i[x+0]-l)*g|0,O=(i[x+1]-p)*b|0;A>u.heightmap[O*$s+R]&&(u.heightmap[O*$s+R]=A)}}function o_(u,i){const l={};l.indexArray=new mo,l.indexArray.reserve(4*u.length),l.vertexArray=new su,l.vertexArray.reserve(10*u.length),l.colorArray=new Eo,l.vertexArray.reserve(10*u.length);let p=0;for(const x of u){const A=Math.min(10,Math.max(4,1.3*x.height))*i,R=[-x.normal[1],x.normal[0],0],O=Math.min(.29,.1*x.width/x.depth),L=x.width-2*x.depth*i*(O+.01),B=Ot([],x.pos,R,L/2),U=Ot([],x.pos,R,-L/2),q=[B[0],B[1],B[2]+x.height],Y=[U[0],U[1],U[2]+x.height],ne=Ot([],x.normal,R,O);Fe(ne,ne,A);const ae=Ot([],x.normal,R,-O);Fe(ae,ae,A),St(ne,B,ne),St(ae,U,ae),B[2]+=.1,U[2]+=.1,l.vertexArray.emplaceBack(ne[0],ne[1],ne[2]),l.vertexArray.emplaceBack(ae[0],ae[1],ae[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]),l.vertexArray.emplaceBack(U[0],U[1],U[2]),l.vertexArray.emplaceBack(q[0],q[1],q[2]),l.vertexArray.emplaceBack(Y[0],Y[1],Y[2]),l.vertexArray.emplaceBack(B[0],B[1],B[2]),l.vertexArray.emplaceBack(U[0],U[1],U[2]),l.vertexArray.emplaceBack(ne[0],ne[1],ne[2]),l.vertexArray.emplaceBack(ae[0],ae[1],ae[2]);const he=L/A/2;l.colorArray.emplaceBack(-he-O,-1,he,.8),l.colorArray.emplaceBack(he+O,-1,he,.8),l.colorArray.emplaceBack(-he,0,he,1.3),l.colorArray.emplaceBack(he,0,he,1.3),l.colorArray.emplaceBack(he+O,-.8,he,.7),l.colorArray.emplaceBack(he+O,-.8,he,.7),l.colorArray.emplaceBack(0,0,he,1.3),l.colorArray.emplaceBack(0,0,he,1.3),l.colorArray.emplaceBack(he+O,-1.2,he,.8),l.colorArray.emplaceBack(he+O,-1.2,he,.8),l.indexArray.emplaceBack(6+p,4+p,8+p),l.indexArray.emplaceBack(7+p,9+p,5+p),l.indexArray.emplaceBack(0+p,1+p,2+p),l.indexArray.emplaceBack(1+p,3+p,2+p),p+=10}const g={defined:!0};g.emissiveFactor=Mi.black;const b={};return b.baseColorFactor=Mi.white,g.pbrMetallicRoughness=b,l.material=g,l.aabb=new Vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),l}dp.performDecoding=function(u,i){const l=new Uint8Array(u);return Promise.all(i.tasks.map(p=>{const{layerName:g,firstByte:b,lastByte:x,pixelFormat:A,blockShape:R,blockIndex:O,filters:L,codec:B}=p,U=l.subarray(b,x+1),q=new Uint32Array(R[0]*R[1]*R[2]);let Y;if(B!=="gzip_data")throw new Cc(`Unhandled codec: ${B}`);return Y=function(ne,ae){if(!globalThis.DecompressionStream&&ae==="gzip_data")return Promise.resolve(((re=function(Le){Le[0]==31&&Le[1]==139&&Le[2]==8||Wl(6,"invalid gzip data");var nt=Le[3],Qe=10;4&nt&&(Qe+=2+(Le[10]|Le[11]<<8));for(var st=(nt>>3&1)+(nt>>4&1);st>0;st-=!Le[Qe++]);return Qe+(2&nt)}(Ae=ne))+8>Ae.length&&Wl(6,"invalid gzip data"),function(Le,nt,Qe,st){var dt=Le.length;if(!dt||nt.f&&!nt.l)return Qe||new ql(0);var a=!Qe,h=a||nt.i!=2,v=nt.i;a&&(Qe=new ql(3*dt));var S,I,k=function(Es){var zr=Qe.length;if(Es>zr){var Cr=new ql(Math.max(2*zr,Es));Cr.set(Qe),Qe=Cr}},K=nt.f||0,ee=nt.p||0,me=nt.b||0,De=nt.l,it=nt.d,yt=nt.m,ct=nt.n,ut=8*dt;do{if(!De){K=Ac(Le,ee,1);var Ct=Ac(Le,ee+1,3);if(ee+=3,!Ct){var mn=Le[(Ce=4+((ee+7)/8|0))-4]|Le[Ce-3]<<8,tn=Ce+mn;if(tn>dt){v&&Wl(0);break}h&&k(me+mn),Qe.set(Le.subarray(Ce,tn),me),nt.b=me+=mn,nt.p=ee=8*tn,nt.f=K;continue}if(Ct==1)De=QE,it=jM,yt=9,ct=5;else if(Ct==2){var Qt=Ac(Le,ee,31)+257,Je=Ac(Le,ee+10,15)+4,rt=Qt+Ac(Le,ee+5,31)+1;ee+=14;for(var lt=new ql(rt),kt=new ql(19),Zt=0;Zt<Je;++Zt)kt[cw[Zt]]=Ac(Le,ee+3*Zt,7);ee+=3*Je;var On=KE(kt),An=(1<<On)-1,Yn=Hb(kt,On);for(Zt=0;Zt<rt;){var Ce,Me=Yn[Ac(Le,ee,An)];if(ee+=15&Me,(Ce=Me>>4)<16)lt[Zt++]=Ce;else{var wt=0,Wt=0;for(Ce==16?(Wt=3+Ac(Le,ee,3),ee+=2,wt=lt[Zt-1]):Ce==17?(Wt=3+Ac(Le,ee,7),ee+=3):Ce==18&&(Wt=11+Ac(Le,ee,127),ee+=7);Wt--;)lt[Zt++]=wt}}var un=lt.subarray(0,Qt),hn=lt.subarray(Qt);yt=KE(un),ct=KE(hn),De=Hb(un,yt),it=Hb(hn,ct)}else Wl(1);if(ee>ut){v&&Wl(0);break}}h&&k(me+131072);for(var En=(1<<yt)-1,Zn=(1<<ct)-1,xi=ee;;xi=ee){var wi=(wt=De[bv(Le,ee)&En])>>4;if((ee+=15&wt)>ut){v&&Wl(0);break}if(wt||Wl(2),wi<256)Qe[me++]=wi;else{if(wi==256){xi=ee,De=null;break}var ci=wi-254;wi>264&&(ci=Ac(Le,ee,(1<<(Ti=vv[Zt=wi-257]))-1)+Ub[Zt],ee+=Ti);var nr=it[bv(Le,ee)&Zn],Ar=nr>>4;if(nr||Wl(3),ee+=15&nr,hn=uw[Ar],Ar>3){var Ti=lw[Ar];hn+=bv(Le,ee)&(1<<Ti)-1,ee+=Ti}if(ee>ut){v&&Wl(0);break}h&&k(me+131072);var is=me+ci;if(me<hn){var Pr=0-hn,Ji=Math.min(hn,is);for(Pr+me<0&&Wl(3);me<Ji;++me)Qe[me]=(void 0)[Pr+me]}for(;me<is;++me)Qe[me]=Qe[me-hn]}}nt.l=De,nt.p=xi,nt.b=me,nt.f=K,De&&(K=1,nt.m=yt,nt.d=it,nt.n=ct)}while(!K);return me!=Qe.length&&a?(S=Qe,((I=me)==null||I>S.length)&&(I=S.length),new ql(S.subarray(0,I))):Qe.subarray(0,me)}(Ae.subarray(re,-8),{i:2},new ql(((he=Ae)[(Se=he.length)-4]|he[Se-3]<<8|he[Se-2]<<16|he[Se-1]<<24)>>>0))));var he,Se,Ae,re;const ye=GM[ae];if(!ye)throw new Error(`Unhandled codec: ${ae}`);const Oe=new globalThis.DecompressionStream(ye);return new Response(new Blob([ne]).stream().pipeThrough(Oe)).arrayBuffer().then(Le=>new Uint8Array(Le))}(U,B).then(ne=>(function(ae,he){ae.readFields(ow,he)}(new jh(ne),q),new qM[A](q.buffer))),Y.then(ne=>{for(let ae=L.length-1;ae>=0;ae--)switch(L[ae]){case"delta_filter":qE(ne,R);break;case"zigzag_filter":WE(ne);break;case"bitshuffle_filter":aw(ne,A);break;default:throw new Cc(`Unhandled filter "${L[ae]}"`)}return{layerName:g,blockIndex:O,data:ne}}).catch(ne=>{throw ne})}))},vn(hw,"MRTDecodingBatch",{omit:["_onCancel","_onComplete"]}),vn(dp,"MapboxRasterTile"),vn(Gb,"MapboxRasterLayer",{omit:["_blocksInProgress"]});class xv{constructor(i){this._stringToNumber={},this._numberToString=[];for(let l=0;l<i.length;l++){const p=i[l];this._stringToNumber[p]=l,this._numberToString[l]=p}}encode(i){return this._stringToNumber[i]}decode(i){return this._numberToString[i]}}const $D=["id","tile","layer","source","sourceLayer","state"];class a_{constructor(i,l,p,g,b){this.type="Feature",this._vectorTileFeature=i,this._z=l,this._x=p,this._y=g,this.properties=i.properties,this.id=b}clone(){const i=new a_(this._vectorTileFeature,this._z,this._x,this._y,this.id);return this.state&&(i.state=Object.assign({},this.state)),this.layer&&(i.layer=Object.assign({},this.layer)),this.source&&(i.source=this.source),this.sourceLayer&&(i.sourceLayer=this.sourceLayer),i}get geometry(){return this._geometry===void 0&&(this._geometry=this._vectorTileFeature.toGeoJSON(this._x,this._y,this._z).geometry),this._geometry}set geometry(i){this._geometry=i}toJSON(){const i={type:"Feature",state:void 0,geometry:this.geometry,properties:this.properties};for(const l of $D)this[l]!==void 0&&(i[l]=this[l]);return i}}class vu{constructor(i,l){this.tileID=i,this.x=i.canonical.x,this.y=i.canonical.y,this.z=i.canonical.z,this.grid=new Pu(sn,16,0),this.featureIndexArray=new wy,this.promoteId=l,this.is3DTile=!1,this.serializedLayersCache=new Map}insert(i,l,p,g,b,x=0,A=0){const R=this.featureIndexArray.length;this.featureIndexArray.emplaceBack(p,g,b,x);const O=this.grid;for(let L=0;L<l.length;L++){const B=l[L],U=[1/0,1/0,-1/0,-1/0];for(let q=0;q<B.length;q++){const Y=B[q];U[0]=Math.min(U[0],Y.x),U[1]=Math.min(U[1],Y.y),U[2]=Math.max(U[2],Y.x),U[3]=Math.max(U[3],Y.y)}A!==0&&(U[0]-=A,U[1]-=A,U[2]+=A,U[3]+=A),U[0]<sn&&U[1]<sn&&U[2]>=0&&U[3]>=0&&O.insert(R,U[0],U[1],U[2],U[3])}}loadVTLayers(){if(!this.vtLayers){this.vtLayers=new li.VectorTile(new vc(this.rawTileData)).layers,this.sourceLayerCoder=new xv(this.vtLayers?Object.keys(this.vtLayers).sort():["_geojsonTileLayer"]),this.vtFeatures={};for(const i in this.vtLayers)this.vtFeatures[i]=[]}return this.vtLayers}query(i,l){const{tilespaceGeometry:p,transform:g,tileTransform:b,pixelPosMatrix:x,availableImages:A,worldview:R}=l;this.loadVTLayers(),this.serializedLayersCache.clear();const O=p.bufferedTilespaceBounds,L=this.grid.query(O.min.x,O.min.y,O.max.x,O.max.y,(Y,ne,ae,he)=>Yp(p.bufferedTilespaceGeometry,Y,ne,ae,he));L.sort(GD);let B=null;g.elevation&&L.length>0&&(B=Tl.create(g.elevation,this.tileID));const U={};let q;for(let Y=0;Y<L.length;Y++){const ne=L[Y];if(ne===q)continue;q=ne;const ae=this.featureIndexArray.get(ne);let he=null;this.is3DTile?this.loadMatchingModelFeature(U,ae,i,p,g,R):this.loadMatchingFeature(U,ae,i,A,R,(Se,Ae,re,ye=0)=>(he||(he=fn(Se,this.tileID.canonical,b)),Ae.queryIntersectsFeature(p,Se,re,he,this.z,g,x,B,ye)))}return U}loadMatchingFeature(i,l,p,g,b,x){const{featureIndex:A,bucketIndex:R,sourceLayerIndex:O,layoutVertexArrayOffset:L}=l,B=this.bucketLayerIDs[R],U=p.layers,q=Object.keys(U);if(q.length&&!Jn(q,B))return;const Y=p.sourceCache,ne=this.sourceLayerCoder.decode(O),ae=this.vtLayers[ne].feature(A),he=this.getId(ae,ne);for(let Se=0;Se<B.length;Se++){const Ae=B[Se];if(!U[Ae])continue;const{styleLayer:re,targets:ye}=U[Ae];let Oe={};he!==void 0&&(Oe=Y.getFeatureState(re.sourceLayer,he));const Le=!x||x(ae,re,Oe,L);if(!Le)continue;const nt=new a_(ae,this.z,this.x,this.y,he);nt.tile=this.tileID.canonical,nt.state=Oe;let Qe=this.serializedLayersCache.get(Ae);Qe||(Qe=re.serialize(),Qe.id=Ae,this.serializedLayersCache.set(Ae,Qe)),nt.source=Qe.source,nt.sourceLayer=Qe["source-layer"],nt.layer=vt({},Qe),nt.layer.paint=bu(Qe.paint,re.paint,ae,Oe,g),nt.layer.layout=bu(Qe.layout,re.layout,ae,Oe,g);let st=!1;for(const dt of ye){this.updateFeatureProperties(nt,dt);const{filter:a}=dt;if(a){if(ae.properties=nt.properties,a.needGeometry){const h=pn(ae,!0);if(!a.filter(new $i(this.tileID.overscaledZ,{worldview:b}),h,this.tileID.canonical))continue}else if(!a.filter(new $i(this.tileID.overscaledZ,{worldview:b}),ae))continue}st=!0,dt.targetId&&this.addFeatureVariant(nt,dt)}st&&this.appendToResult(i,Ae,A,nt,Le)}}loadMatchingModelFeature(i,l,p,g,b,x){const{featureIndex:A,bucketIndex:R}=l,O=this.bucketLayerIDs[R],L=p.layers,B=Object.keys(L);if(!B.length||Jn(B,O))for(let U=0;U<O.length;U++){const q=O[U],{styleLayer:Y,targets:ne}=L[q];if(Y.type!=="model")continue;const ae=g.tile,he=ae.getBucket(Y);if(!(he&&he instanceof Pa))continue;const Se=zE(he,A,g,b);if(!Se)continue;const{z:Ae,x:re,y:ye}=ae.tileID.canonical,{feature:Oe,intersectionZ:Le,position:nt}=Se;let Qe={};Oe.id!==void 0&&(Qe=p.sourceCache.getFeatureState(Y.sourceLayer,Oe.id));const st=new a_({},Ae,re,ye,Oe.id);st.tile=this.tileID.canonical,st.state=Qe,st.properties=Oe.properties,st.geometry={type:"Point",coordinates:[nt.lng,nt.lat]};let dt=this.serializedLayersCache.get(q);dt||(dt=Y.serialize(),dt.id=q,this.serializedLayersCache.set(q,dt)),st.source=dt.source,st.sourceLayer=dt["source-layer"],st.layer=vt({},dt);let a=!1;for(const h of ne){this.updateFeatureProperties(st,h);const{filter:v}=h;if(v){if(Oe.properties=st.properties,v.needGeometry){if(!v.filter(new $i(this.tileID.overscaledZ,{worldview:x}),Oe,this.tileID.canonical))continue}else if(!v.filter(new $i(this.tileID.overscaledZ,{worldview:x}),Oe))continue}a=!0,h.targetId&&this.addFeatureVariant(st,h)}a&&this.appendToResult(i,q,A,st,Le)}}updateFeatureProperties(i,l,p){if(l.properties){const g={};for(const b in l.properties){const x=l.properties[b].evaluate({zoom:this.z},i._vectorTileFeature,i.state,i.tile,p);x!=null&&(g[b]=x)}i.properties=g}}addFeatureVariant(i,l,p){const g={target:l.target,namespace:l.namespace,uniqueFeatureID:l.uniqueFeatureID};l.properties&&(g.properties=i.properties),i.variants=i.variants||{},i.variants[l.targetId]=i.variants[l.targetId]||[],i.variants[l.targetId].push(g)}appendToResult(i,l,p,g,b){let x=i[l];x===void 0&&(x=i[l]=[]),x.push({featureIndex:p,feature:g,intersectionZ:b})}lookupSymbolFeatures(i,l,p,g,b,x){const A={};this.loadVTLayers();for(const R of i)this.loadMatchingFeature(A,{bucketIndex:l,sourceLayerIndex:p,featureIndex:R,layoutVertexArrayOffset:0},g,b,x);return A}loadFeature(i){const{featureIndex:l,sourceLayerIndex:p}=i;this.loadVTLayers();const g=this.sourceLayerCoder.decode(p),b=this.vtFeatures[g];if(b[l])return b[l];const x=this.vtLayers[g].feature(l);return b[l]=x,x}hasLayer(i){for(const l of this.bucketLayerIDs)for(const p of l)if(i===p)return!0;return!1}getId(i,l){let p=i.id;if(this.promoteId){const g=Array.isArray(this.promoteId)||typeof this.promoteId!="object"?this.promoteId:this.promoteId[l];if(g!=null)if(Array.isArray(g)){if(!this.promoteIdExpression){const b=Mu(g);if(b.result!=="success"){const x=b.value.map(A=>`${A.key}: ${A.message}`).join(", ");return void ii(`Failed to create expression for promoteId: ${x}`)}this.promoteIdExpression=b.value}this.promoteIdExpression._evaluator||(this.promoteIdExpression._evaluator=new ah),p=this.promoteIdExpression.evaluate({zoom:0},i)}else p=i.properties[g];typeof p=="boolean"&&(p=Number(p))}return p}}function bu(u,i,l,p,g){return Sn(u,(b,x)=>{const A=i instanceof Cf?i.get(x):null;return A&&A.evaluate?A.evaluate(l,p,void 0,g):A})}function GD(u,i){return i-u}vn(vu,"FeatureIndex",{omit:["rawTileData","sourceLayerCoder"]});const Wd=[Int8Array,Uint8Array,Uint8ClampedArray,Int16Array,Uint16Array,Int32Array,Uint32Array,Float32Array,Float64Array];class Tm{static from(i){if(!(i instanceof ArrayBuffer))throw new Error("Data must be an instance of ArrayBuffer.");const[l,p]=new Uint8Array(i,0,2);if(l!==219)throw new Error("Data does not appear to be in a KDBush format.");const g=p>>4;if(g!==1)throw new Error(`Got v${g} data when expected v1.`);const b=Wd[15&p];if(!b)throw new Error("Unrecognized array type.");const[x]=new Uint16Array(i,2,1),[A]=new Uint32Array(i,4,1);return new Tm(A,x,b,i)}constructor(i,l=64,p=Float64Array,g){if(isNaN(i)||i<0)throw new Error(`Unpexpected numItems value: ${i}.`);this.numItems=+i,this.nodeSize=Math.min(Math.max(+l,2),65535),this.ArrayType=p,this.IndexArrayType=i<65536?Uint16Array:Uint32Array;const b=Wd.indexOf(this.ArrayType),x=2*i*this.ArrayType.BYTES_PER_ELEMENT,A=i*this.IndexArrayType.BYTES_PER_ELEMENT,R=(8-A%8)%8;if(b<0)throw new Error(`Unexpected typed array class: ${p}.`);g&&g instanceof ArrayBuffer?(this.data=g,this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+A+R,2*i),this._pos=2*i,this._finished=!0):(this.data=new ArrayBuffer(8+x+A+R),this.ids=new this.IndexArrayType(this.data,8,i),this.coords=new this.ArrayType(this.data,8+A+R,2*i),this._pos=0,this._finished=!1,new Uint8Array(this.data,0,2).set([219,16+b]),new Uint16Array(this.data,2,1)[0]=l,new Uint32Array(this.data,4,1)[0]=i)}add(i,l){const p=this._pos>>1;return this.ids[p]=p,this.coords[this._pos++]=i,this.coords[this._pos++]=l,p}finish(){const i=this._pos>>1;if(i!==this.numItems)throw new Error(`Added ${i} items when expected ${this.numItems}.`);return wv(this.ids,this.coords,this.nodeSize,0,this.numItems-1,0),this._finished=!0,this}range(i,l,p,g){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:b,coords:x,nodeSize:A}=this,R=[0,b.length-1,0],O=[];for(;R.length;){const L=R.pop()||0,B=R.pop()||0,U=R.pop()||0;if(B-U<=A){for(let ae=U;ae<=B;ae++){const he=x[2*ae],Se=x[2*ae+1];he>=i&&he<=p&&Se>=l&&Se<=g&&O.push(b[ae])}continue}const q=U+B>>1,Y=x[2*q],ne=x[2*q+1];Y>=i&&Y<=p&&ne>=l&&ne<=g&&O.push(b[q]),(L===0?i<=Y:l<=ne)&&(R.push(U),R.push(q-1),R.push(1-L)),(L===0?p>=Y:g>=ne)&&(R.push(q+1),R.push(B),R.push(1-L))}return O}within(i,l,p){if(!this._finished)throw new Error("Data not yet indexed - call index.finish().");const{ids:g,coords:b,nodeSize:x}=this,A=[0,g.length-1,0],R=[],O=p*p;for(;A.length;){const L=A.pop()||0,B=A.pop()||0,U=A.pop()||0;if(B-U<=x){for(let ae=U;ae<=B;ae++)Em(b[2*ae],b[2*ae+1],i,l)<=O&&R.push(g[ae]);continue}const q=U+B>>1,Y=b[2*q],ne=b[2*q+1];Em(Y,ne,i,l)<=O&&R.push(g[q]),(L===0?i-p<=Y:l-p<=ne)&&(A.push(U),A.push(q-1),A.push(1-L)),(L===0?i+p>=Y:l+p>=ne)&&(A.push(q+1),A.push(B),A.push(1-L))}return R}}function wv(u,i,l,p,g,b){if(g-p<=l)return;const x=p+g>>1;Tv(u,i,x,p,g,b),wv(u,i,l,p,x-1,1-b),wv(u,i,l,x+1,g,1-b)}function Tv(u,i,l,p,g,b){for(;g>p;){if(g-p>600){const O=g-p+1,L=l-p+1,B=Math.log(O),U=.5*Math.exp(2*B/3),q=.5*Math.sqrt(B*U*(O-U)/O)*(L-O/2<0?-1:1);Tv(u,i,l,Math.max(p,Math.floor(l-L*U/O+q)),Math.min(g,Math.floor(l+(O-L)*U/O+q)),b)}const x=i[2*l+b];let A=p,R=g;for(l_(u,i,p,l),i[2*g+b]>x&&l_(u,i,p,g);A<R;){for(l_(u,i,A,R),A++,R--;i[2*A+b]<x;)A++;for(;i[2*R+b]>x;)R--}i[2*p+b]===x?l_(u,i,p,R):(R++,l_(u,i,R,g)),R<=l&&(p=R+1),l<=R&&(g=R-1)}}function l_(u,i,l,p){Ev(u,l,p),Ev(i,2*l,2*p),Ev(i,2*l+1,2*p+1)}function Ev(u,i,l){const p=u[i];u[i]=u[l],u[l]=p}function Em(u,i,l,p){const g=u-l,b=i-p;return g*g+b*b}s.$=fo,s.A=Wc,s.B=Ln,s.C=ru,s.D=Qf,s.E=Yc,s.F=2,s.G=Fh,s.H=xb,s.I=ra,s.J=oh,s.K=class extends rp{},s.L=ic,s.M=Vr,s.N=wf,s.O=pg,s.P=Lt,s.Q=xf,s.R=Gc,s.S=Ef,s.T=rr,s.U=fy,s.V=rp,s.W=yh,s.X=Mu,s.Y=eu,s.Z=Ea,s._=Eu,s.a=function(u){return Ws.API_CDN_URL_REGEX.test(u)},s.a$=Et,s.a0=Zc,s.a1=py,s.a2=ad,s.a3=ay,s.a4=function(u){const i=u.value;let l=[];if(!i)return l;const p=oh(i);return p!=="string"?(l=l.concat([new rp(u.key,i,`string expected, "${p}" found`)]),l):(X1(i,!0)||(l=l.concat([new rp(u.key,i,`invalid url "${i}"`)])),l)},s.a5=pt,s.a6=B0,s.a7=Lr,s.a8=Gt,s.a9=class{constructor(u){this.specification=u}possiblyEvaluate(u,i){return cr(u.expression.evaluate(i))}interpolate(u,i,l){return{x:$n(u.x,i.x,l),y:$n(u.y,i.y,l),z:$n(u.z,i.z,l),azimuthal:$n(u.azimuthal,i.azimuthal,l),polar:$n(u.polar,i.polar,l)}}},s.aA=Nr,s.aB=C,s.aC=uu,s.aD=je,s.aE=Tt,s.aF=function(u,i){const l={};for(let p=0;p<i.length;p++){const g=i[p];g in u&&(l[g]=u[g])}return l},s.aG=Pe,s.aH=Ue,s.aI=class{constructor(u){this.entries={},this.scheduler=u}request(u,i,l,p){const g=this.entries[u]=this.entries[u]||{callbacks:[]};if(g.result){const[b,x]=g.result;return this.scheduler?this.scheduler.add(()=>{p(b,x)},i):p(b,x),()=>{}}return g.callbacks.push(p),g.cancel||(g.cancel=l((b,x)=>{g.result=[b,x];for(const A of g.callbacks)this.scheduler?this.scheduler.add(()=>{A(b,x)},i):A(b,x);setTimeout(()=>delete this.entries[u],3e3)})),()=>{g.result||(g.callbacks=g.callbacks.filter(b=>b!==p),g.callbacks.length||(g.cancel(),delete this.entries[u]))}}},s.aJ=function(u,i,l){const p=JSON.stringify(u.request);return u.data&&(this.deduped.entries[p]={result:[null,u.data]}),this.deduped.request(p,{type:"parseTile",isSymbolTile:u.isSymbolTile,zoom:u.tileZoom},g=>{const b=qc(u.request,(x,A,R,O)=>{x?g(x):A&&g(null,{vectorTile:l?void 0:new li.VectorTile(new vc(A)),rawData:A,cacheControl:R,expires:O})});return()=>{b.cancel(),g()}},i)},s.aK=function(u){bp++,bp>$a&&(u.getActor().send("enforceCacheSizeLimit",na),bp=0)},s.aL=function(u){return u<=1?1:Math.pow(2,Math.floor(Math.log(u)/Math.LN2))},s.aM=Da,s.aN=CE,s.aO=DE,s.aP=AE,s.aQ=function(u,i){const l=document.createElement("video");l.muted=!0,l.onloadstart=function(){i(null,l)};for(let p=0;p<u.length;p++){const g=document.createElement("source");B_(u[p])||(l.crossOrigin="Anonymous"),g.src=u[p],l.appendChild(g)}return{cancel:()=>{}}},s.aR=rv,s.aS=function(u){return fetch(u).then(i=>i.arrayBuffer()).then(i=>ZC(i,0,u))},s.aT=HD,s.aU=class{constructor(u,i,l,p){this.id=u,this.position=i!=null?new ge(i[0],i[1]):new ge(0,0),this.orientation=l??[0,0,0],this.nodes=p,this.uploaded=!1,this.aabb=new Vi([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),this.matrix=[]}_applyTransformations(u,i){if(ie(u.matrix,i,u.matrix),u.meshes)for(const l of u.meshes){const p=Vi.applyTransformFast(l.aabb,u.matrix);this.aabb.encapsulate(p)}if(u.children)for(const l of u.children)this._applyTransformations(l,u.matrix)}computeBoundsAndApplyParent(){const u=X([]);for(const i of this.nodes)this._applyTransformations(i,u)}computeModelMatrix(u,i,l,p,g,b,x=!1){LE(this.matrix,this,u.transform,this.position,i,l,p,g,b,x)}upload(u){if(!this.uploaded){for(const i of this.nodes)_m(i,u);for(const i of this.nodes)yo(i);this.uploaded=!0}}destroy(){for(const u of this.nodes)wl(u)}},s.aV=_n,s.aW=tv,s.aX=et,s.aY=_t,s.aZ=Rf,s.a_=mo,s.aa=$i,s.ab=Np,s.ac=ot,s.ad=Tn,s.ae=ze,s.af=at,s.ag=Cf,s.ah=Mh,s.ai=$n,s.aj=sn,s.ak=Xc,s.al=bi,s.am=Mi,s.an=class{constructor(u){this.specification=u}possiblyEvaluate(u,i){return function([l,p]){const g=cr([1,l,p]);return{x:g.x,y:g.y,z:g.z}}(u.expression.evaluate(i))}interpolate(u,i,l){return{x:$n(u.x,i.x,l),y:$n(u.y,i.y,l),z:$n(u.z,i.z,l)}}},s.ao=function(u,i,l=0,p=!0){const g=new Lt(l,l),b=u.sub(g),x=i.add(g),A=[b,new Lt(x.x,b.y),x,new Lt(b.x,x.y)];return p&&A.push(b.clone()),A},s.ap=function(u,i){const l=[];for(let p=0;p<u.length;p++){const g=bt(p-1,-1,u.length-1),b=bt(p+1,-1,u.length-1),x=u[p],A=u[b],R=u[g].sub(x).unit(),O=A.sub(x).unit(),L=O.angleWithSep(R.x,R.y),B=R.add(O).unit().mult(-1*i/Math.sin(L/2));l.push(x.add(B))}return l},s.aq=F1,s.ar=Yp,s.as=function(u,i,l=0){return zt(((i.x-l)*u.scale-u.x)*sn,(i.y*u.scale-u.y)*sn,ft(i.z,i.y))},s.at=ni,s.au=dn,s.av=Tr,s.aw=sE,s.ax=function(u){let i=1/0,l=1/0,p=-1/0,g=-1/0;for(const b of u)i=Math.min(i,b.x),l=Math.min(l,b.y),p=Math.max(p,b.x),g=Math.max(g,b.y);return{min:new Lt(i,l),max:new Lt(p,g)}},s.ay=He,s.az=ie,s.b=function(u){return Ws.API_FONTS_REGEX.test(u)},s.b$=function(u,i,l){l*=.5;var p=i[0],g=i[1],b=i[2],x=i[3],A=Math.sin(l),R=Math.cos(l);return u[0]=p*R+g*A,u[1]=g*R-p*A,u[2]=b*R+x*A,u[3]=x*R-b*A,u},s.b0=Aa,s.b1=Db,s.b2=function(){nu.isLoading()||nu.isLoaded()||cd()!=="deferred"||z0()},s.b3=my,s.b4=pn,s.b5=a_,s.b6=Ei,s.b7=im,s.b8=VT,s.b9=fn,s.bA=function(u,i){const{x:l,y:p}=u.point,g=hC(l,p,u.worldSize/u._pixelsPerMercatorPixel,0,0);return ie(g,g,r1(Td(i)))},s.bB=P,s.bC=function(u){return u[0]=0,u[1]=0,u[2]=0,u},s.bD=function(u,i){return Math.hypot(i[0]-u[0],i[1]-u[1],i[2]-u[2])},s.bE=Ot,s.bF=Mn,s.bG=Ht,s.bH=lm,s.bI=Oa,s.bJ=P1,s.bK=function(u,i,l,p,g){const b=5*i+2;u.float32[b+0]=l,u.float32[b+1]=p,u.float32[b+2]=g},s.bL=Ab,s.bM=T1,s.bN=Qa,s.bO=xs,s.bP=HT,s.bQ=kE,s.bR=$T,s.bS=GT,s.bT=xc,s.bU=Ky,s.bV=z1,s.bW=Tm,s.bX=bt,s.bY=Fe,s.bZ=_r,s.b_=dr,s.ba=uc,s.bb=Up,s.bc=PT,s.bd=Yr,s.be=Jt,s.bf=jd,s.bg=function(u,i){const l=Mh(i.zoom);if(l===0)return Td(u);const p=Ry(u),g=K0(p),b=je(p.getWest())*i.worldSize,x=je(p.getEast())*i.worldSize,A=Ue(p.getNorth())*i.worldSize,R=Ue(p.getSouth())*i.worldSize,O=[b,A,0],L=[x,A,0],B=[b,R,0],U=[x,R,0],q=te([],i.globeMatrix);return Tn(O,O,q),Tn(L,L,q),Tn(B,B,q),Tn(U,U,q),g[0]=jf(g[0],B,l),g[1]=jf(g[1],U,l),g[2]=jf(g[2],L,l),g[3]=jf(g[3],O,l),Vi.fromPoints(g)},s.bh=i1,s.bi=te,s.bj=Oy,s.bk=jf,s.bl=xg,s.bm=aC,s.bn=be,s.bo=we,s.bp=dp,s.bq=vc,s.br=qc,s.bs=function(u,i){const l=[];for(const p in u)p in i||l.push(p);return l},s.bt=Ze,s.bu=["type","source","source-layer","minzoom","maxzoom","filter","layout"],s.bv=$r,s.bw=function(u){var i=new D(16);return i[0]=u[0],i[1]=u[1],i[2]=u[2],i[3]=u[3],i[4]=u[4],i[5]=u[5],i[6]=u[6],i[7]=u[7],i[8]=u[8],i[9]=u[9],i[10]=u[10],i[11]=u[11],i[12]=u[12],i[13]=u[13],i[14]=u[14],i[15]=u[15],i},s.bx=X,s.by=Xe,s.bz=J,s.c=wu,s.c$=nm,s.c0=di,s.c1=xr,s.c2=function(u,i){return u[0]=-i[0],u[1]=-i[1],u[2]=-i[2],u[3]=i[3],u},s.c3=Te,s.c4=function(u,i,l,p,g){var b,x=1/Math.tan(i/2);return u[0]=x/l,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=x,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[11]=-1,u[12]=0,u[13]=0,u[15]=0,g!=null&&g!==1/0?(u[10]=(g+p)*(b=1/(p-g)),u[14]=2*g*p*b):(u[10]=-1,u[14]=-2*p),u},s.c5=function(u,i,l,p,g,b,x){var A=1/(i-l),R=1/(p-g),O=1/(b-x);return u[0]=-2*A,u[1]=0,u[2]=0,u[3]=0,u[4]=0,u[5]=-2*R,u[6]=0,u[7]=0,u[8]=0,u[9]=0,u[10]=2*O,u[11]=0,u[12]=(i+l)*A,u[13]=(g+p)*R,u[14]=(x+b)*O,u[15]=1,u},s.c6=We,s.c7=function(u,i,l){u[4*i+0]=l[0],u[4*i+1]=l[1],u[4*i+2]=l[2],u[4*i+3]=l[3]},s.c8=Ag,s.c9=Cg,s.cA=Mb,s.cB=oe,s.cC=RE,s.cD=function(u){const i=RE(u,!0);return P([],[i[0],i[1],i[4],i[5]])},s.cE=Ie,s.cF=mr,s.cG=Re,s.cH=function(u){const{x:i,y:l}=u.point,{lng:p,lat:g}=u._center;return hC(i,l,u.worldSize,p,g)},s.cI=Ft,s.cJ=gt,s.cK=Uf,s.cL=M,s.cM=function(u,i,l){let p=0;for(let g=0;g<2;++g)u[g]>0&&(p+=(u[g]-0)*(u[g]-0)),i[g]<0&&(p+=(0-i[g])*(0-i[g]));return p},s.cN=function(u){return u*u*u*u*u},s.cO=qe,s.cP=45,s.cQ=Dg,s.cR=function(u,i,l){const p=Math.sqrt(u*u+i*i+l*l),g=p>0?Math.acos(l/p)*Ls:0;let b=u!==0||i!==0?Math.atan2(-i,-u)*Ls+90:0;return b<0&&(b+=360),[p,b,g]},s.cS=zt,s.cT=cr,s.cU=Dt,s.cV=St,s.cW=Vi,s.cX=mt,s.cY=function(u){return[Math.pow(u[0],1/2.2),Math.pow(u[1],1/2.2),Math.pow(u[2],1/2.2)]},s.cZ=X1,s.c_=function(u,i){return u.readFields(Lb,{icons:[]},i)},s.ca=bs,s.cb=lu,s.cc=zf,s.cd=ge,s.ce=$1,s.cf=function(){var u=new D(4);return D!=Float32Array&&(u[1]=0,u[2]=0),u[0]=1,u[3]=1,u},s.cg=function(u,i,l){var p=i[0],g=i[1],b=i[2],x=i[3],A=Math.sin(l),R=Math.cos(l);return u[0]=p*R+b*A,u[1]=g*R+x*A,u[2]=p*-A+b*R,u[3]=g*-A+x*R,u},s.ch=function(u,i){return u[0]===i[0]&&u[1]===i[1]&&u[2]===i[2]&&u[3]===i[3]},s.ci=Bt,s.cj=function(u){return Math.hypot(u[0],u[1],u[2],u[3])},s.ck=ro,s.cl=Kn,s.cm=oC,s.cn=vr,s.co=OE,s.cp=Ig,s.cq=n1,s.cr=function(u,i,l,p,g,b,x,A,R){if(R.name==="globe")return n1(u,i,new Ig(l,p,g),!1);const O=tv({z:l,x:p,y:g},R);return new Vi([(b+O.x/O.scale)*i,i*(O.y/O.scale),x],[(b+O.x2/O.scale)*i,i*(O.y2/O.scale),A])},s.cs=function(u,i,l){return u[0]=Math.min(i[0],l[0]),u[1]=Math.min(i[1],l[1]),u[2]=Math.min(i[2],l[2]),u[3]=Math.min(i[3],l[3]),u},s.ct=function(u,i,l){return u[0]=Math.max(i[0],l[0]),u[1]=Math.max(i[1],l[1]),u[2]=Math.max(i[2],l[2]),u[3]=Math.max(i[3],l[3]),u},s.cu=function(u){const i=Math.round((u+45+360)%360/90)%4;return fe[i]},s.cv=Mt,s.cw=jr,s.cx=N,s.cy=function(u){const i=X(new Float64Array(16));ie(i,u.pixelMatrix,u.globeMatrix);const l=[0,W,0],p=[0,Q,0];return Tn(l,l,i),Tn(p,p,i),[l[0]>0&&l[0]<=u.width&&l[1]>0&&l[1]<=u.height&&!Mg(u,new ge(u.center.lat,90)),p[0]>0&&p[0]<=u.width&&p[1]>0&&p[1]<=u.height&&!Mg(u,new ge(u.center.lat,-90))]},s.cz=function(u,i){const{scale:l}=u.tileTransform,p=l*sn/(u.tileSize*Math.pow(2,i.zoom-u.tileID.overscaledZ+u.tileID.canonical.z));return function(g,b,x){var A=b[1],R=b[2],O=b[3],L=x[0],B=x[1];return g[0]=b[0]*L,g[1]=A*L,g[2]=R*B,g[3]=O*B,g}(new Float32Array(4),i.inverseAdjustmentMatrix,[p,p])},s.d=function(u){return Ws.API_TILEJSON_REGEX.test(u)},s.d$=by,s.d0=Bu,s.d1=N1,s.d2=uf,s.d3=ld,s.d4=ya,s.d5=Kh,s.d6=Vn,s.d7=function(u){const i=u.indexOf(vg);return i>=0?u.slice(0,i):u},s.d8=function(u){return u.indexOf(vg)>=0},s.d9=function(u){const i=u.lastIndexOf(vg);return i>=0?u.slice(i+1):""},s.dA=NT,s.dB=os,s.dC=zs,s.dD=256,s.dE=function(u,i){const l=[0,0,0];return Tn(l,l,i1(Td(i.canonical))),Tn(l,l,u),l},s.dF=u=>({u_matrix:new zf(u),u_texsize:new lu(u),u_pixels_to_tile_units:new Rg(u),u_device_pixel_ratio:new bs(u),u_width_scale:new bs(u),u_floor_width_scale:new bs(u),u_image:new Ag(u),u_units_to_pixels:new lu(u),u_tile_units_to_pixels:new bs(u),u_alpha_discard_threshold:new bs(u),u_trim_offset:new lu(u),u_trim_fade_range:new lu(u),u_trim_color:new Dg(u),u_emissive_strength:new bs(u),u_zbias_factor:new bs(u),u_tile_to_meter:new bs(u),u_ground_shadow_factor:new Cg(u),u_pattern_transition:new bs(u)}),s.dG=u=>({u_matrix:new zf(u),u_pixels_to_tile_units:new Rg(u),u_device_pixel_ratio:new bs(u),u_width_scale:new bs(u),u_floor_width_scale:new bs(u),u_units_to_pixels:new lu(u),u_dash_image:new Ag(u),u_gradient_image:new Ag(u),u_image_height:new bs(u),u_texsize:new lu(u),u_tile_units_to_pixels:new bs(u),u_alpha_discard_threshold:new bs(u),u_trim_offset:new lu(u),u_trim_fade_range:new lu(u),u_trim_color:new Dg(u),u_emissive_strength:new bs(u),u_zbias_factor:new bs(u),u_tile_to_meter:new bs(u),u_ground_shadow_factor:new Cg(u)}),s.dH=u=>({u_camera_to_center_distance:new bs(u),u_extrude_scale:new Rg(u),u_device_pixel_ratio:new bs(u),u_matrix:new zf(u),u_inv_rot_matrix:new zf(u),u_merc_center:new lu(u),u_tile_id:new Cg(u),u_zoom_transition:new bs(u),u_up_dir:new Cg(u),u_emissive_strength:new bs(u)}),s.dI=ou,s.dJ=O1,s.dK=a1,s.dL=(u,i,l,p,g,b)=>{const x=u.transform,A=x.projection.name==="globe";let R;if(b.paint.get("circle-pitch-alignment")==="map")if(A){const L=NT(x.zoom,i.canonical)*x._pixelsPerMercatorPixel;R=Float32Array.from([L,0,0,L])}else R=x.calculatePixelsToTileUnitsMatrix(l);else R=new Float32Array([x.pixelsToGLUnits[0],0,0,x.pixelsToGLUnits[1]]);const O={u_camera_to_center_distance:u.transform.getCameraToCenterDistance(x.projection),u_matrix:u.translatePosMatrix(i.projMatrix,l,b.paint.get("circle-translate"),b.paint.get("circle-translate-anchor")),u_device_pixel_ratio:Ho.devicePixelRatio,u_extrude_scale:R,u_inv_rot_matrix:Wo,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0],u_emissive_strength:b.paint.get("circle-emissive-strength")};if(A){O.u_inv_rot_matrix=p,O.u_merc_center=g,O.u_tile_id=[i.canonical.x,i.canonical.y,1<<i.canonical.z],O.u_zoom_transition=Mh(x.zoom);const L=g[0]*sn,B=g[1]*sn;O.u_up_dir=x.projection.upVector(new Ig(0,0,0),L,B)}return O},s.dM=D1,s.dN=Hi,s.dO=(u,i,l,p,g,b,x,A,R,O)=>{const L=u.transform,B=L.pitch<15?vl(.07,.7,He((14-L.zoom)/5,0,1)):.07,U=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none";return{u_matrix:jg(u,i,l,p),u_texsize:i.imageAtlasTexture?i.imageAtlasTexture.size:[0,0],u_pixels_to_tile_units:L.calculatePixelsToTileUnitsMatrix(i),u_device_pixel_ratio:g,u_width_scale:b,u_floor_width_scale:x,u_image:0,u_tile_units_to_pixels:iD(i,L),u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_alpha_discard_threshold:0,u_trim_offset:A,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(U?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:B,u_tile_to_meter:Dt(i.tileID.canonical,0),u_ground_shadow_factor:R,u_pattern_transition:O}},s.dP=(u,i,l,p,g,b,x,A,R,O)=>{const L=u.transform,B=L.calculatePixelsToTileUnitsMatrix(i),U=l.paint.get("line-trim-color-use-theme").constantOr("default")==="none",q=L.pitch<15?vl(.07,.7,He((14-L.zoom)/5,0,1)):.07;return{u_matrix:jg(u,i,l,p),u_pixels_to_tile_units:B,u_device_pixel_ratio:b,u_width_scale:x,u_floor_width_scale:A,u_units_to_pixels:[1/L.pixelsToGLUnits[0],1/L.pixelsToGLUnits[1]],u_dash_image:0,u_gradient_image:1,u_image_height:g,u_texsize:jy(l)&&i.lineAtlasTexture?i.lineAtlasTexture.size:[0,0],u_tile_units_to_pixels:iD(i,u.transform),u_alpha_discard_threshold:0,u_trim_offset:R,u_trim_fade_range:l.paint.get("line-trim-fade-range"),u_trim_color:l.paint.get("line-trim-color").toPremultipliedRenderColor(U?null:l.lut).toArray01(),u_emissive_strength:l.paint.get("line-emissive-strength"),u_zbias_factor:q,u_tile_to_meter:Dt(i.tileID.canonical,0),u_ground_shadow_factor:O}},s.dQ=Kt,s.dR=kg,s.dS=ft,s.dT=MT,s.dU=Wf,s.dV=mb,s.dW=qf,s.dX=450,s.dY=7,s.dZ=sv,s.d_=Oi,s.da=function(u){const i=[],l=u.id;return l===void 0&&i.push({message:`layers.${l}: missing required property "id"`}),u.render===void 0&&i.push({message:`layers.${l}: missing required method "render"`}),u.renderingMode&&u.renderingMode!=="2d"&&u.renderingMode!=="3d"&&i.push({message:`layers.${l}: property "renderingMode" must be either "2d" or "3d"`}),i},s.db=function(u,i,l,p){return u.type==="custom"?new ED(u,i):new Jg[u.type](u,i,l,p)},s.dc=Gn,s.dd=function(u){const i=u.indexOf(vg);return i>=0?u.slice(i+1):""},s.de=class extends a_{constructor(u,i){super(u._vectorTileFeature,u._z,u._x,u._y,u.id),u.state&&(this.state=Object.assign({},u.state)),this.target=i.target,this.namespace=i.namespace,i.properties&&(this.properties=i.properties),this.target&&("featuresetId"in this.target&&!this.target.importId||"layerId"in this.target)&&(this.source=u.source,this.sourceLayer=u.sourceLayer,this.layer=u.layer)}toJSON(){const u=super.toJSON();return u.target=this.target,u.namespace=this.namespace,u}},s.df=Bp,s.dg=va,s.dh=function(u){return u({pluginStatus:ua,pluginURL:ku}),Bp.on("pluginStateChange",u),u},s.di=Gp,s.dj=class extends au{constructor(u){super(u),this.current=ls}set(u,i,l){if(this.fetchUniformLocation(u,i)){for(let p=0;p<9;p++)if(l[p]!==this.current[p]){this.current=l,this.gl.uniformMatrix3fv(this.location,!1,l);break}}}},s.dk=ve,s.dl=function(u,i,l){const p=Mh(l.zoom),g=u.style.map._antialias,b=u.terrain&&u.terrain.exaggeration()>0;return p===0&&!g&&!b},s.dm=function(u){const i=u.pixelsPerMeter,l=i/We(1,u.center.lat),p=X(new Float64Array(16));return we(p,p,[u.point.x,u.point.y,0]),Ie(p,p,[l,l,i]),Float32Array.from(p)},s.dn=Ry,s.dp=function(u){const i=Mt-5;u=He(u,-80.051129,i)/i*90;const l=Math.pow(Math.abs(Math.sin(bi(u))),3);return Math.round(l*(Z.length-1))},s.dq=function(u,i,l,p){const g=i.getNorth(),b=i.getSouth(),x=i.getWest(),A=i.getEast(),R=1<<u.z,O=A-x,L=g-b,B=O/H,U=-L/Z[l],q=[0,B,0,U,0,0,g,x,0];if(u.z>0){const Y=180/p;$(q,q,[Y/O+1,0,0,0,Y/L+1,0,-.5*Y/B,.5*Y/U,1])}return q[2]=R,q[5]=u.x,q[8]=u.y,q},s.dr=Td,s.ds=function(u,i,l){const p=X(new Float64Array(16)),g=(i/(1<<u)-.5)*Math.PI*2;return Ne(p,l.globeMatrix,g),Float32Array.from(p)},s.dt=class{isDataAvailableAtPoint(u){const i=this._source();if(this.isUsingMockSource()||!i||u.y<0||u.y>1)return!1;const l=i.getSource().maxzoom,p=1<<l,g=Math.floor(u.x),b=Math.floor((u.x-g)*p),x=Math.floor(u.y*p),A=this.findDEMTileFor(new Da(l,g,l,b,x));return!(!A||!A.dem)}getAtPointOrZero(u,i=0){return this.getAtPoint(u,i)||0}getAtPoint(u,i,l=!0){if(this.isUsingMockSource())return null;i==null&&(i=null);const p=this._source();if(!p||u.y<0||u.y>1)return i;const g=p.getSource().maxzoom,b=1<<g,x=Math.floor(u.x),A=u.x-x,R=new Da(g,x,g,Math.floor(A*b),Math.floor(u.y*b)),O=this.findDEMTileFor(R);if(!O||!O.dem)return i;const L=O.dem,B=1<<O.tileID.canonical.z,U=(A*B-O.tileID.canonical.x)*L.dim,q=(u.y*B-O.tileID.canonical.y)*L.dim,Y=Math.floor(U),ne=Math.floor(q);return(l?this.exaggeration():1)*$n($n(L.get(Y,ne),L.get(Y,ne+1),q-ne),$n(L.get(Y+1,ne),L.get(Y+1,ne+1),q-ne),U-Y)}getAtTileOffset(u,i,l){const p=1<<u.canonical.z;return this.getAtPointOrZero(new ot(u.wrap+(u.canonical.x+i/sn)/p,(u.canonical.y+l/sn)/p))}getAtTileOffsetFunc(u,i,l,p){return g=>{const b=this.getAtTileOffset(u,g.x,g.y),x=p.upVector(u.canonical,g.x,g.y);return Fe(x,x,b*p.upVectorScale(u.canonical,i,l).metersToTile),x}}getForTilePoints(u,i,l,p){if(this.isUsingMockSource())return!1;const g=Tl.create(this,u,p);return!!g&&(i.forEach(b=>{b[2]=this.exaggeration()*g.getElevationAt(b[0],b[1],l)}),!0)}getMinMaxForTile(u){if(this.isUsingMockSource())return null;const i=this.findDEMTileFor(u);if(!i||!i.dem)return null;const l=i.dem.tree,p=i.tileID,g=1<<u.canonical.z-p.canonical.z;let b=u.canonical.x/g-p.canonical.x,x=u.canonical.y/g-p.canonical.y,A=0;for(let R=0;R<u.canonical.z-p.canonical.z&&!l.leaves[A];R++){b*=2,x*=2;const O=2*Math.floor(x)+Math.floor(b);A=l.childOffsets[A]+O,b%=1,x%=1}return{min:this.exaggeration()*l.minimums[A],max:this.exaggeration()*l.maximums[A]}}getMinElevationBelowMSL(){throw new Error("Pure virtual method called.")}raycast(u,i,l){throw new Error("Pure virtual method called.")}pointCoordinate(u){throw new Error("Pure virtual method called.")}_source(){throw new Error("Pure virtual method called.")}isUsingMockSource(){throw new Error("Pure virtual method called.")}exaggeration(){throw new Error("Pure virtual method called.")}findDEMTileFor(u){throw new Error("Pure virtual method called.")}get visibleDemTiles(){throw new Error("Getter must be implemented in subclass.")}getMinMaxForVisibleTiles(){const u=this.visibleDemTiles;if(u.length===0)return null;let i=!1,l=Number.MAX_VALUE,p=Number.MIN_VALUE;for(const g of u){const b=this.getMinMaxForTile(g.tileID);b&&(l=Math.min(l,b.min),p=Math.max(p,b.max),i=!0)}return i?{min:l,max:p}:null}},s.du=_c,s.dv=Dy,s.dw=function(u,i){return[Math.pow(u[0],2.2)*i,Math.pow(u[1],2.2)*i,Math.pow(u[2],2.2)*i]},s.dx=z,s.dy=function(u,i){var l=Math.sin(i),p=Math.cos(i);return u[0]=p,u[1]=l,u[2]=0,u[3]=-l,u[4]=p,u[5]=0,u[6]=0,u[7]=0,u[8]=1,u},s.dz=Cn,s.e=Ws,s.e$=xv,s.e0=256,s.e1=r1,s.e2=su,s.e3=Ne,s.e4=function(u,i){return u[0]=i[0],u[1]=i[1],u[2]=i[2],u[3]=i[4],u[4]=i[5],u[5]=i[6],u[6]=i[8],u[7]=i[9],u[8]=i[10],u},s.e5=Ah,s.e6=Ch,s.e7=iy,s.e8=function(u,i,l,p,g){return He((u-i)/(l-i)*(g-p)+p,p,g)},s.e9=ks,s.eA=function(u,i,l){return u[0]=i[0]/l[0],u[1]=i[1]/l[1],u[2]=i[2]/l[2],u},s.eB=er,s.eC=se,s.eD=ln,s.eE=function(u,i,l,p){return u[0]=i,u[1]=l,u[2]=p,u},s.eF=function([u,i,l]){const p=Math.hypot(u,i,l),g=Math.atan2(u,l),b=.5*Math.PI-Math.acos(-i/p);return new ge(gt(g),gt(b))},s.eG=ss,s.eH=Y1,s.eI=function(u){const i=u.navigator?u.navigator.userAgent:null;return!!function(l){if(fr==null){const p=l.navigator?l.navigator.userAgent:null;fr=!!l.safari||!(!p||!(/\b(iPad|iPhone|iPod)\b/.test(p)||p.match("Safari")&&!p.match("Chrome")))}return fr}(u)&&!(!i||!(i.match("Version/15.4")||i.match("Version/15.5")||i.match(/CPU (OS|iPhone OS) (15_4|15_5) like Mac OS X/)))},s.eJ=function(u,i){na=u,$a=i},s.eK=Mg,s.eL=LT,s.eM=function(u){const i=[0,0,0],l=X(new Float64Array(16));return ie(l,u.pixelMatrix,u.globeMatrix),Tn(i,i,l),new Lt(i[0],i[1])},s.eN=function(){const u=zh;u&&(u.isPreloaded()&&u.numActive()===1?(u.release(Pd),zh=null):console.warn("Could not clear WebWorkers since there are active Map instances that still reference it. The pre-warmed WebWorker pool can only be cleared when all map instances have been removed with map.remove()"))},s.eO=function(){nm().acquire(Pd)},s.eP=cd,s.eQ=function(u,i,l=!1){if(ua===ca.deferred||ua===ca.loading||ua===ca.loaded)throw new Error("setRTLTextPlugin cannot be called multiple times.");ku=Ho.resolveURL(u),ua=ca.deferred,gg=i,zp(),l||z0()},s.eR=function(u){Kf=Ho.resolveURL(u),By||(By=new Qf(nm(),new Yc)),By.broadcast("setMeshoptUrl",Kf)},s.eS=HC,s.eT=function(u){gb=Ho.resolveURL(u),By||(By=new Qf(nm(),new Yc)),By.broadcast("setDracoUrl",gb)},s.eU=jC,s.eV=Zf,s.eW=function(u){const i=Rl();if(!i)return;const l=i.delete(Mr);u&&l.then(()=>u()).catch(u)},s.eX=Xf,s.eY=vn,s.eZ=Ed,s.e_=xl,s.ea=function(u,i){var l=i[0],p=i[1],g=i[2],b=i[3],x=i[4],A=i[5],R=i[6],O=i[7],L=i[8],B=L*x-A*O,U=-L*b+A*R,q=O*b-x*R,Y=l*B+p*U+g*q;return Y?(u[0]=B*(Y=1/Y),u[1]=(-L*p+g*O)*Y,u[2]=(A*p-g*x)*Y,u[3]=U*Y,u[4]=(L*l-g*R)*Y,u[5]=(-A*l+g*b)*Y,u[6]=q*Y,u[7]=(-O*l+p*R)*Y,u[8]=(x*l-p*b)*Y,u):null},s.eb=wn,s.ec=jt,s.ed=kb,s.ee=function(u,i){if(u===i){var l=i[1],p=i[2],g=i[3],b=i[6],x=i[7],A=i[11];u[1]=i[4],u[2]=i[8],u[3]=i[12],u[4]=l,u[6]=i[9],u[7]=i[13],u[8]=p,u[9]=b,u[11]=i[14],u[12]=g,u[13]=x,u[14]=A}else u[0]=i[0],u[1]=i[4],u[2]=i[8],u[3]=i[12],u[4]=i[1],u[5]=i[5],u[6]=i[9],u[7]=i[13],u[8]=i[2],u[9]=i[6],u[10]=i[10],u[11]=i[14],u[12]=i[3],u[13]=i[7],u[14]=i[11],u[15]=i[15];return u},s.ef=Ee,s.eg=[1,1,1],s.eh=class{constructor(u,i,l,p){this.context=u,this.format=p,this.size=l,this.texture=u.gl.createTexture();const[g,b,x]=this.size,{gl:A}=u;A.bindTexture(A.TEXTURE_3D,this.texture),u.pixelStoreUnpackFlipY.set(!1),u.pixelStoreUnpack.set(1),u.pixelStoreUnpackPremultiplyAlpha.set(!1),A.texImage3D(A.TEXTURE_3D,0,this.format,g,b,x,0,mm(this.format),Yg(this.format),i.data)}bind(u,i){const{context:l}=this,{gl:p}=l;p.bindTexture(p.TEXTURE_3D,this.texture),u!==this.minFilter&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MAG_FILTER,u),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_MIN_FILTER,u),this.minFilter=u),i!==this.wrapS&&(p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_S,i),p.texParameteri(p.TEXTURE_3D,p.TEXTURE_WRAP_T,i),this.wrapS=i)}destroy(){const{gl:u}=this.context;u.deleteTexture(this.texture),this.texture=null}},s.ei=Tl,s.ej=function(u,i,l,p){var g=new D(4);return g[0]=u,g[1]=i,g[2]=l,g[3]=p,g},s.ek=Li,s.el=function(u,i,l,p){var g=i[0],b=i[1],x=i[2],A=i[3];return u[0]=g+p*(l[0]-g),u[1]=b+p*(l[1]-b),u[2]=x+p*(l[2]-x),u[3]=A+p*(l[3]-A),u},s.em=gm,s.en=Eh,s.eo=_d,s.ep=function(u,i,l,p,g,b,x,A,R,O,L,B,U,q,Y,ne){var ae=new D(16);return ae[0]=u,ae[1]=i,ae[2]=l,ae[3]=p,ae[4]=g,ae[5]=b,ae[6]=x,ae[7]=A,ae[8]=R,ae[9]=O,ae[10]=L,ae[11]=B,ae[12]=U,ae[13]=q,ae[14]=Y,ae[15]=ne,ae},s.eq=ue,s.er=Eg,s.es=gd,s.et=class{constructor(){this._updateTime=0,this._sourceIds=[],this._activeRegions=[],this._prevRegions=[],this._globalClipBounds={min:new Lt(1/0,1/0),max:new Lt(-1/0,-1/0)}}clear(){this._activeRegions.length>0&&++this._updateTime,this._activeRegions=[],this._prevRegions=[]}get updateTime(){return this._updateTime}getReplacementRegionsForTile(u,i=!1){const l=_1(new Lt(0,0),new Lt(sn,sn),u),p=[];if(i&&!g1(l,this._globalClipBounds))return p;for(const g of this._activeRegions){if(g.hiddenByOverlap||!g1(l,g))continue;const b=hu(g.min,g.max,u);p.push({min:b.min,max:b.max,sourceId:this._sourceIds[g.priority],footprint:g.footprint,footprintTileId:g.tileId,order:g.order,clipMask:g.clipMask,clipScope:g.clipScope})}return p}setSources(u){this._setSources(u.map(i=>({getSourceId:()=>i.cache.id,getFootprints:()=>{const l=[];for(const p of i.cache.getVisibleCoordinates()){const g=i.cache.getTile(p).buckets[i.layer];g&&g.updateFootprints(p.toUnwrapped(),l)}return l},getOrder:()=>i.order,getClipMask:()=>i.clipMask,getClipScope:()=>i.clipScope})))}_addSource(u){const i=u.getFootprints();if(i.length===0)return;const l=u.getOrder(),p=u.getClipMask(),g=u.getClipScope();for(const b of i){if(!b.footprint)continue;const x=_1(b.footprint.min,b.footprint.max,b.id);this._activeRegions.push({min:x.min,max:x.max,hiddenByOverlap:!1,priority:this._sourceIds.length,tileId:b.id,footprint:b.footprint,order:l,clipMask:p,clipScope:g})}this._sourceIds.push(u.getSourceId())}_computeReplacement(){this._activeRegions.sort((i,l)=>i.priority-l.priority||cb(i.min,l.min)||cb(i.max,l.max)||i.order-l.order||i.clipMask-l.clipMask||function(p,g){const b=(x,A)=>x+A;return p.length-g.length||p.reduce(b,"").localeCompare(g.reduce(b,""))}(i.clipScope,l.clipScope));let u=this._activeRegions.length!==this._prevRegions.length;if(!u){let i=0;for(;!u&&i!==this._activeRegions.length;){const l=this._activeRegions[i],p=this._prevRegions[i];u=l.priority!==p.priority||!m1(l,p)||l.order!==p.order||l.clipMask!==p.clipMask||!$r(l.clipScope,p.clipScope),++i}}if(u){++this._updateTime;for(const l of this._activeRegions)l.order!==lb&&(this._globalClipBounds.min.x=Math.min(this._globalClipBounds.min.x,l.min.x),this._globalClipBounds.min.y=Math.min(this._globalClipBounds.min.y,l.min.y),this._globalClipBounds.max.x=Math.max(this._globalClipBounds.max.x,l.max.x),this._globalClipBounds.max.y=Math.max(this._globalClipBounds.max.y,l.max.y));const i=l=>{const p=this._activeRegions;if(l>=p.length)return l;const g=p[l].priority;for(;l<p.length&&p[l].priority===g;)++l;return l};if(this._sourceIds.length>1){let l=0,p=i(l);for(;l!==p;){let g=l;const b=l;for(;g!==p;){const x=this._activeRegions[g];x.hiddenByOverlap=!1;for(let A=0;A<b;A++){const R=this._activeRegions[A];if(!R.hiddenByOverlap&&x.order===lb&&g1(x,R)&&(x.hiddenByOverlap=DC(x.footprint,x.tileId,R.footprint,R.tileId),x.hiddenByOverlap))break}++g}l=p,p=i(l)}}}}_setSources(u){[this._prevRegions,this._activeRegions]=[this._activeRegions,[]],this._sourceIds=[];for(let i=u.length-1;i>=0;i--)this._addSource(u[i]);this._computeReplacement()}},s.eu=lb,s.ev=class{constructor(u){this._createGrid(u),this._createPoles(u)}destroy(){this._poleIndexBuffer.destroy(),this._gridBuffer.destroy(),this._gridIndexBuffer.destroy(),this._poleNorthVertexBuffer.destroy(),this._poleSouthVertexBuffer.destroy();for(const u of this._poleSegments)u.destroy();for(const u of this._gridSegments)u.withSkirts.destroy(),u.withoutSkirts.destroy()}_fillGridMeshWithLods(u,i){const l=new uc,p=new mo,g=[],b=u+1+2,x=i[0]+1,A=i[0]+1+(1+i.length),R=(O,L,B)=>{let U=O===b-1?O-2:O===0?O:O-1;return U+=B?24575:0,[U,L]};for(let O=0;O<b;++O)l.emplaceBack(...R(O,0,!0));for(let O=0;O<x;++O)for(let L=0;L<b;++L)l.emplaceBack(...R(L,O,(L===0||L===b-1)&&!0));for(let O=0;O<i.length;++O){const L=i[O];for(let B=0;B<b;++B)l.emplaceBack(...R(B,L,!0))}for(let O=0;O<i.length;++O){const L=p.length,B=i[O]+1+2,U=new mo;for(let ne=0;ne<B-1;ne++){const ae=ne===B-2,he=ae?b*(A-i.length+O-ne):b;for(let Se=0;Se<b-1;Se++){const Ae=ne*b+Se;ne===0||ae||Se===0||Se===b-2?(U.emplaceBack(Ae+1,Ae,Ae+he),U.emplaceBack(Ae+he,Ae+he+1,Ae+1)):(p.emplaceBack(Ae+1,Ae,Ae+he),p.emplaceBack(Ae+he,Ae+he+1,Ae+1))}}const q=Yr.simpleSegment(0,L,l.length,p.length-L);for(let ne=0;ne<U.uint16.length;ne+=3)p.emplaceBack(U.uint16[ne],U.uint16[ne+1],U.uint16[ne+2]);const Y=Yr.simpleSegment(0,L,l.length,p.length-L);g.push({withoutSkirts:q,withSkirts:Y})}return{vertices:l,indices:p,segments:g}}_createGrid(u){const i=this._fillGridMeshWithLods(H,Z);this._gridSegments=i.segments,this._gridBuffer=u.createVertexBuffer(i.vertices,PT.members),this._gridIndexBuffer=u.createIndexBuffer(i.indices,!0)}_createPoles(u){const i=new mo;for(let x=0;x<=H;x++)i.emplaceBack(0,x+1,x+2);this._poleIndexBuffer=u.createIndexBuffer(i,!0);const l=new Ah,p=new Ah,g=new Ah,b=new Ah;this._poleSegments=[];for(let x=0,A=0;x<M;x++){const R=360/(1<<x);l.emplaceBack(0,-C,0,.5,0),p.emplaceBack(0,-C,0,.5,1),g.emplaceBack(0,-C,0,.5,.5),b.emplaceBack(0,-C,0,.5,.5);for(let O=0;O<=H;O++){let L=O/H,B=0;const U=$n(0,R,L),[q,Y,ne]=ce(o1,dC,U,C);l.emplaceBack(q,Y,ne,L,B),p.emplaceBack(q,Y,ne,L,1-B);const ae=bi(U);L=.5+.5*Math.sin(ae),B=.5+.5*Math.cos(ae),g.emplaceBack(q,Y,ne,L,B),b.emplaceBack(q,Y,ne,L,1-B)}this._poleSegments.push(Yr.simpleSegment(A,0,66,64)),A+=66}this._poleNorthVertexBuffer=u.createVertexBuffer(l,e1,!1),this._poleSouthVertexBuffer=u.createVertexBuffer(p,e1,!1),this._texturedPoleNorthVertexBuffer=u.createVertexBuffer(g,e1,!1),this._texturedPoleSouthVertexBuffer=u.createVertexBuffer(b,e1,!1)}getGridBuffers(u,i){return[this._gridBuffer,this._gridIndexBuffer,i?this._gridSegments[u].withSkirts:this._gridSegments[u].withoutSkirts]}getPoleBuffers(u,i){return[i?this._texturedPoleNorthVertexBuffer:this._poleNorthVertexBuffer,i?this._texturedPoleSouthVertexBuffer:this._poleSouthVertexBuffer,this._poleIndexBuffer,this._poleSegments[u]]}},s.ew=Be,s.ex=function(){return!!document.fullscreenElement||!!document.webkitFullscreenElement},s.ey=tt,s.ez=ht,s.f=function(u){return btoa(encodeURIComponent(u).replace(/%([0-9A-F]{2})/g,(i,l)=>String.fromCharCode(+("0x"+l))))},s.f0=vu,s.f1=iE,s.f2=mi,s.f3="hd_road_elevation",s.f4=gl,s.f5=Sn,s.f6=Dd,s.f7=Wy,s.f8=Yo,s.f9=function(u,i,l,p,g,b,x,A=1,R,O,L){u.createArrays(),u.tilePixelRatio=sn/(512*u.overscaling),u.compareText={},u.iconsNeedLinear=!1;const B=u.layers[0].layout,U=u.layers[0]._unevaluatedLayout._values,q={};q.scaleFactor=A,q.textSizeScaleRange=B.get("text-size-scale-range"),q.iconSizeScaleRange=B.get("icon-size-scale-range");const[Y,ne]=q.textSizeScaleRange,[ae,he]=q.iconSizeScaleRange;q.textScaleFactor=He(q.scaleFactor,Y,ne),q.iconScaleFactor=He(q.scaleFactor,ae,he);const Se=U["text-size"],Ae=U["icon-size"];if(u.textSizeData.kind==="composite"){const{minZoom:Qe,maxZoom:st}=u.textSizeData;q.compositeTextSizes=[Se.possiblyEvaluate(new $i(Qe,{worldview:L}),b),Se.possiblyEvaluate(new $i(st,{worldview:L}),b)]}if(u.iconSizeData.kind==="composite"){const{minZoom:Qe,maxZoom:st}=u.iconSizeData;q.compositeIconSizes=[Ae.possiblyEvaluate(new $i(Qe,{worldview:L}),b),Ae.possiblyEvaluate(new $i(st,{worldview:L}),b)]}q.layoutTextSize=Se.possiblyEvaluate(new $i(x+1,{worldview:L}),b),q.layoutIconSize=Ae.possiblyEvaluate(new $i(x+1,{worldview:L}),b),q.textMaxSize=Se.possiblyEvaluate(new $i(18,{worldview:L}),b);const re=B.get("symbol-placement"),ye=B.get("text-rotation-alignment")==="map"&&re!=="point",Oe=B.get("text-size");let Le=!1;const nt=[];for(const Qe of u.features){const st=B.get("text-font").evaluate(Qe,{},b).join(","),dt=Oe.evaluate(Qe,{},b)*q.textScaleFactor,a=q.layoutTextSize.evaluate(Qe,{},b)*q.textScaleFactor,h=q.layoutIconSize.evaluate(Qe,{},b)*q.iconScaleFactor,v={horizontal:{},vertical:void 0},S=Qe.text;let I,k=[0,0];if(S){const Je=S.toString(),rt=B.get("text-letter-spacing").evaluate(Qe,{},b)*xs,lt=B.get("text-line-height").evaluate(Qe,{},b)*xs,kt=k0(Je)?rt:0,Zt=B.get("text-anchor").evaluate(Qe,{},b),On=B.get("text-variable-anchor");if(!On){const wt=B.get("text-radial-offset").evaluate(Qe,{},b);if(wt)k=Ky(Zt,[wt*xs,Qy]);else{const Wt=B.get("text-offset").evaluate(Qe,{},b);k=[Wt[0]*xs,Wt[1]*xs]}}let An=ye?"center":B.get("text-justify").evaluate(Qe,{},b);const Yn=re==="point",Ce=Yn?B.get("text-max-width").evaluate(Qe,{},b)*xs:1/0,Me=wt=>{u.allowVerticalPlacement&&Sf(Je)&&(v.vertical=bc(S,i,l,g,st,Ce,lt,Zt,wt,kt,k,Oa.vertical,!0,a,dt,R))};if(!ye&&On){const wt=An==="auto"?On.map(un=>z1(un)):[An];let Wt=!1;for(let un=0;un<wt.length;un++){const hn=wt[un];if(!v.horizontal[hn])if(Wt)v.horizontal[hn]=v.horizontal[0];else{const En=bc(S,i,l,g,st,Ce,lt,"center",hn,kt,k,Oa.horizontal,!1,a,dt,R);En&&(v.horizontal[hn]=En,Wt=En.positionedLines.length===1)}}Me("left")}else{if(An==="auto"&&(An=z1(Zt)),Yn||B.get("text-writing-mode").indexOf("horizontal")>=0||!Sf(Je)){const wt=bc(S,i,l,g,st,Ce,lt,Zt,An,kt,k,Oa.horizontal,!1,a,dt,R);wt&&(v.horizontal[An]=wt)}Me(Yn?"left":An)}}let K,ee,me,De,it,yt,ct=!1;const ut=B.get("icon-text-fit").evaluate(Qe,{},b);if(Qe.icon&&Qe.icon.hasPrimary()){const Je=pu(Qe.icon,u.iconSizeData,U["icon-size"],b,u.zoom,Qe,R,q.iconScaleFactor,L);K=Je.iconPrimary,me=Je.iconSecondary;const rt=K.toString();if(ee=p.get(rt),ee&&(it=B.get("icon-offset").evaluate(Qe,{},b),yt=B.get("icon-anchor").evaluate(Qe,{},b),I=hE(g.get(rt),me?g.get(me.toString()):void 0,it,yt),ct=ee.sdf,u.sdfIcons===void 0?u.sdfIcons=ee.sdf:u.sdfIcons!==ee.sdf&&ii("Style sheet warning: Cannot mix SDF and non-SDF icons in one buffer"),(ee.pixelRatio!==u.pixelRatio||B.get("icon-rotate").constantOr(1)!==0)&&(u.iconsNeedLinear=!0)),me){const lt=me.toString();De=p.get(lt)}}Le=Le||!(!Qe.icon||!Qe.icon.hasSecondary());const Ct=Tb(v.horizontal)||v.vertical;u.iconsInText||(u.iconsInText=!!Ct&&Ct.iconsInText);const mn=a*q.textScaleFactor/xs,{defaultShapedIcon:tn,verticallyShapedIcon:Qt}=_D(u,I,B,Qe,b,v,mn,it,ut);ut!=="none"&&I&&(uD(I)||fE(I))&&(qg(0,ee,K,I,tn,ut,O,p,g),qg(0,De,me,I,tn,ut,O,p,g),Qt&&(qg(0,ee,K,I,Qt,ut,O,p,g),qg(0,De,me,I,Qt,ut,O,p,g))),I=tn,nt.push({feature:Qe,shapedTextOrientations:v,shapedText:Ct,shapedIcon:I,iconPrimary:K,iconSecondary:me,iconOffset:it,iconAnchor:yt,verticallyShapedIcon:Qt,layoutTextSize:a,layoutIconSize:h,textOffset:k,isSDFIcon:ct,iconTextFit:ut})}return{featureData:nt,sizes:q,hasAnySecondaryIcon:Le,textAlongLine:ye,symbolPlacement:re}},s.fa=wb,s.fb=function(u,i,l,p,g,b,x,A,R,O){const{featureData:L,hasAnySecondaryIcon:B,sizes:U,textAlongLine:q,symbolPlacement:Y}=i;for(const ne of L){const{shapedIcon:ae,verticallyShapedIcon:he,feature:Se,shapedTextOrientations:Ae,shapedText:re,layoutTextSize:ye,textOffset:Oe,isSDFIcon:Le,iconPrimary:nt,iconSecondary:Qe,iconTextFit:st,iconOffset:dt}=ne;Ia(ae,O.iconPositions,nt,Qe),Ia(he,O.iconPositions,nt,Qe),fa(Ae,O.iconPositions),Ul(nt,Qe,O.iconPositions),(re||ae)&&_E(u,Se,Ae,ae,he,R,U,ye,0,Oe,Le,p,g,x,A,B,st,dt,q,Y)}l&&u.generateCollisionDebugBuffers(b,u.collisionBoxArray,U.textScaleFactor)},s.fc=li,s.fd=qd,s.fe=Ii,s.ff=si,s.fg=tl,s.fh=Pn,s.fi=function(u){let i=0;if(new Uint32Array(u,0,1)[0]!==$C){const l=new Uint32Array(u,0,7),[,,p,g,b,x]=l;i=l.byteLength+g+b+x+b,(p!==u.byteLength||i>=u.byteLength)&&ii("Invalid b3dm header information.")}return ZC(u,i)},s.fj=function(u,i){const l=HD(u);for(const p of l){for(const g of p.meshes)nS(g);p.lights&&(p.lightMeshIndex=p.meshes.length,p.meshes.push(o_(p.lights,i)))}return l},s.fk=Pa,s.fl=Ai,s.fm=E1,s.fn=nu,s.fo=ca,s.fp=function(u){Xh(),ll!=null&&ll.then(i=>{i.keys().then(l=>{for(let p=0;p<l.length-u;p++)i.delete(l[p]).catch(g=>ii(g.message))}).catch(l=>ii(l.message))}).catch(i=>ii(i.message))},s.g=function(u,i){return va(vt(u,{method:"GET"}),i)},s.h=vt,s.i=function(u){return Ws.API_STYLE_REGEX.test(u)&&!wu(u)},s.j=function(u){return u.indexOf("mapbox:")===0},s.k=ja,s.l=xp,s.m=function(u){return decodeURIComponent(atob(u).split("").map(i=>"%"+("00"+i.charCodeAt(0).toString(16)).slice(-2)).join(""))},s.n=function(u,i){return va(vt(u,{type:"json"}),i)},s.o=so,s.p=function(u,i){return va(vt(u,{method:"POST"}),i)},s.q=Ho,s.r=go,s.s=function(u){try{const i=self[u];return i.setItem("_mapbox_test_",1),i.removeItem("_mapbox_test_"),!0}catch{return!1}},s.t=Ha,s.u=function(){return function u(i){return i?(i^Math.random()*(16>>i/4)).toString(16):([1e7]+-[1e3]+-4e3+-8e3+-1e11).replace(/[018]/g,u)}()},s.v=function(u){return!!u&&/^[0-9a-f]{8}-[0-9a-f]{4}-[4][0-9a-f]{3}-[89ab][0-9a-f]{3}-[0-9a-f]{12}$/i.test(u)},s.w=ii,s.x=function(){return zy||(zy=new Xf),zy},s.y=$d,s.z=th}),d(["./shared"],function(s){function T(gt){const fe=gt?gt.url.toString():void 0;return fe?performance.getEntriesByName(fe):[]}function D(gt){if(typeof gt=="number"||typeof gt=="boolean"||typeof gt=="string"||gt==null)return JSON.stringify(gt);if(Array.isArray(gt)){let ve="[";for(const Be of gt)ve+=`${D(Be)},`;return`${ve}]`}let fe="{";for(const ve of Object.keys(gt).sort())fe+=`${ve}:${D(gt[ve])},`;return`${fe}}`}function P(gt){let fe="";for(const ve of s.bu)fe+=`/${D(gt[ve])}`;return fe}class z{constructor(fe){this.keyCache={},this._layers={},this._layerConfigs={},fe&&this.replace(fe)}replace(fe,ve){this._layerConfigs={},this._layers={},this.update(fe,[],ve)}update(fe,ve,Be){this._options=Be;for(const He of fe)this._layerConfigs[He.id]=He,(this._layers[He.id]=s.db(He,this.scope,null,this._options)).compileFilter(Be),this.keyCache[He.id]&&delete this.keyCache[He.id];for(const He of ve)delete this.keyCache[He],delete this._layerConfigs[He],delete this._layers[He];this.familiesBySource={};const tt=function(He,at){const bt={};for(let vt=0;vt<He.length;vt++){const It=He[vt];let Et=at&&at[It.id];Et||(It.type==="symbol"?Et=It.id:(Et=P(It),It.type==="line"&&It.paint&&function _n(Sn){return typeof Sn=="string"&&Sn==="line-progress"||(Array.isArray(Sn)?Sn.some(_n):!(!Sn||typeof Sn!="object")&&Object.values(Sn).some(_n))}(It.paint["line-width"])&&(Et+=`/${D(It.paint["line-width"])}`))),at&&(at[It.id]=Et);let Kt=bt[Et];Kt||(Kt=bt[Et]=[]),Kt.push(It)}const Ze=[];for(const vt in bt)Ze.push(bt[vt]);return Ze}(Object.values(this._layerConfigs),this.keyCache);for(const He of tt){const at=He.map(Kt=>this._layers[Kt.id]),bt=at[0];if(bt.visibility==="none")continue;const Ze=bt.source||"";let vt=this.familiesBySource[Ze];vt||(vt=this.familiesBySource[Ze]={});const It=bt.sourceLayer||"_geojsonTileLayer";let Et=vt[It];Et||(Et=vt[It]=[]),Et.push(at)}}}const F=1*s.e_;class ${constructor(fe){const ve={},Be=[];for(const bt in fe){const Ze=fe[bt],vt=ve[bt]={};for(const It in Ze.glyphs){const Et=Ze.glyphs[+It];if(!Et||Et.bitmap.width===0||Et.bitmap.height===0)continue;const Kt=Et.metrics.localGlyph?F:1,_n={x:0,y:0,w:Et.bitmap.width+2*Kt,h:Et.bitmap.height+2*Kt};Be.push(_n),vt[It]=_n}}const{w:tt,h:He}=s.H(Be),at=new s.eZ({width:tt||1,height:He||1});for(const bt in fe){const Ze=fe[bt];for(const vt in Ze.glyphs){const It=Ze.glyphs[+vt];if(!It||It.bitmap.width===0||It.bitmap.height===0)continue;const Et=ve[bt][vt],Kt=It.metrics.localGlyph?F:1;s.eZ.copy(It.bitmap,at,{x:0,y:0},{x:Et.x+Kt,y:Et.y+Kt},It.bitmap)}}this.image=at,this.positions=ve}}s.eY($,"GlyphAtlas");class J{constructor(fe){this.tileID=new s.aM(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.tileZoom=fe.tileZoom,this.uid=fe.uid,this.zoom=fe.zoom,this.lut=fe.lut,this.canonical=fe.tileID.canonical,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.scope=fe.scope,this.overscaling=this.tileID.overscaleFactor(),this.showCollisionBoxes=fe.showCollisionBoxes,this.collectResourceTiming=!!fe.request&&fe.request.collectResourceTiming,this.promoteId=fe.promoteId,this.isSymbolTile=fe.isSymbolTile,this.tileTransform=s.aW(fe.tileID.canonical,fe.projection),this.projection=fe.projection,this.worldview=fe.worldview,this.localizableLayerIds=fe.localizableLayerIds,this.brightness=fe.brightness,this.extraShadowCaster=!!fe.extraShadowCaster,this.tessellationStep=fe.tessellationStep,this.scaleFactor=fe.scaleFactor,this.worldview=fe.worldview}parse(fe,ve,Be,tt,He,at){this.status="parsing",this.data=fe,this.collisionBoxArray=new s.b0;const bt=new s.e$(Object.keys(fe.layers).sort()),Ze=new s.f0(this.tileID,this.promoteId);Ze.bucketLayerIDs=[];const vt={},It=new s.f1(256,256),Et={featureIndex:Ze,iconDependencies:new Map,patternDependencies:new Map,glyphDependencies:{},lineAtlas:It,availableImages:Be,brightness:this.brightness,scaleFactor:this.scaleFactor,elevationFeatures:void 0},Kt=[],_n=ve.familiesBySource[this.source];for(const Gn in _n){const Vn=fe.layers[Gn];if(!Vn)continue;let Jn=!1,oi=!1,ii=!1;for(const Ai of _n[Gn])Ai[0].type==="symbol"?Jn=!0:oi=!0,Ai[0].is3D()&&Ai[0].type!=="model"&&(ii=!0);if(this.extraShadowCaster&&!ii||this.isSymbolTile===!0&&!Jn||this.isSymbolTile===!1&&!oi)continue;Vn.version===1&&s.w(`Vector tile source "${this.source}" layer "${Gn}" does not use vector tile spec v2 and therefore may have some rendering errors.`);const Xi=bt.encode(Gn),tr=[];let cr=!1;for(let Ai=0,Ei=0;Ai<Vn.length;Ai++){const fr=Vn.feature(Ai),xr=Ze.getId(fr,Gn);if(this.localizableLayerIds&&this.localizableLayerIds.has(Gn)){const Ir=fr.properties?fr.properties.worldview:null;if(this.worldview&&typeof Ir=="string")if(Ir==="all")fr.properties.$localized=!0;else{if(!Ir.split(",").includes(this.worldview))continue;fr.properties.$localized=!0,fr.properties.worldview=this.worldview}}!cr&&fr.properties&&fr.properties.hasOwnProperty(s.f2)&&(cr=!0),tr.push({feature:fr,id:xr,index:Ei,sourceLayerIndex:Xi}),Ei++}cr&&!Et.elevationFeatures&&fe.layers.hasOwnProperty(s.f3)&&(Et.elevationFeatures=s.f4.parseFrom(fe.layers[s.f3],this.canonical));for(const Ai of _n[Gn]){const Ei=Ai[0];if(this.extraShadowCaster&&(!Ei.is3D()||Ei.type==="model")||this.isSymbolTile!==void 0&&Ei.type==="symbol"!==this.isSymbolTile||Ei.minzoom&&this.zoom<Math.floor(Ei.minzoom)||Ei.maxzoom&&this.zoom>=Ei.maxzoom||Ei.visibility==="none")continue;X(Ai,this.zoom,Et.brightness,Be,this.worldview);const fr=vt[Ei.id]=Ei.createBucket({index:Ze.bucketLayerIDs.length,layers:Ai,zoom:this.zoom,lut:this.lut,canonical:this.canonical,pixelRatio:this.pixelRatio,overscaling:this.overscaling,collisionBoxArray:this.collisionBoxArray,sourceLayerIndex:Xi,sourceID:this.source,projection:this.projection.spec,tessellationStep:this.tessellationStep,styleDefinedModelURLs:tt,worldview:this.worldview});Ze.bucketLayerIDs.push(Ai.map(Ir=>s.C(Ir.id,Ir.scope)));let xr=fr.prepare?fr.prepare():null;xr!=null?(xr=xr.then(()=>fr.populate(tr,Et,this.tileID.canonical,this.tileTransform)),Kt.push(xr)):fr.populate(tr,Et,this.tileID.canonical,this.tileTransform)}}const Sn=()=>{let Gn,Vn,Jn,oi,ii,Xi;It.trim();const tr={type:"maybePrepare",isSymbolTile:this.isSymbolTile,zoom:this.zoom},cr=()=>{if(Gn)return this.status="done",at(Gn);if(this.extraShadowCaster)this.status="done",at(null,{buckets:Object.values(vt).filter(Ei=>!Ei.isEmpty()),featureIndex:Ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:Et.brightness,glyphMap:null,iconMap:null,glyphPositions:null});else if(Vn&&Jn&&oi){const Ei=new $(Vn),fr=new Map;for(const[qs,os]of Jn.entries()){const{imagePosition:zs}=s.f7(qs,os,s.f8);fr.set(qs,zs)}const xr={};for(const qs in vt){const os=vt[qs];os instanceof s.b1&&(X(os.layers,this.zoom,Et.brightness,Be,this.worldview),xr[qs]=s.f9(os,Vn,Ei.positions,Jn,fr,this.tileID.canonical,this.tileZoom,this.scaleFactor,this.pixelRatio,ii,this.worldview))}const Ir={iconsPending:!0,patternsPending:!0};this.rasterizeIfNeeded(He,Jn,ii,()=>{Ir.iconsPending=!1,Ai(xr,Ei,Ir)}),this.rasterizeIfNeeded(He,oi,Xi,()=>{Ir.patternsPending=!1,Ai(xr,Ei,Ir)})}},Ai=(Ei,fr,xr,Ir)=>{if(xr.iconsPending||xr.patternsPending)return;const qs=new s.fa(Jn,oi,this.lut);for(const os in vt){const zs=vt[os];if(os in Ei)s.fb(zs,Ei[os],this.showCollisionBoxes,Be,this.tileID.canonical,this.tileZoom,this.projection,this.brightness,Jn,qs);else if(zs.hasPattern&&(zs instanceof s.b7||zs instanceof s.b8||zs instanceof s.dU)){X(zs.layers,this.zoom,Et.brightness,Be,this.worldview);const Ua=Object.fromEntries(qs.patternPositions);zs.addFeatures(Et,this.tileID.canonical,Ua,Be,this.tileTransform,this.brightness)}}this.status="done",at(null,{buckets:Object.values(vt).filter(os=>!os.isEmpty()),featureIndex:Ze,collisionBoxArray:this.collisionBoxArray,glyphAtlasImage:fr.image,lineAtlas:It,imageAtlas:qs,brightness:Et.brightness})};if(!this.extraShadowCaster){const Ei=s.f5(Et.glyphDependencies,Ir=>Object.keys(Ir).map(Number));Object.keys(Ei).length?He.send("getGlyphs",{uid:this.uid,stacks:Ei,scope:this.scope},(Ir,qs)=>{Gn||(Gn=Ir,Vn=qs,cr())},void 0,!1,tr):Vn={};const fr=Array.from(Et.iconDependencies.keys()).map(Ir=>s.I.parse(Ir));fr.length?He.send("getImages",{images:fr,source:this.source,scope:this.scope,tileID:this.tileID,type:"icons"},(Ir,qs)=>{Gn||(Gn=Ir,Jn=new Map,ii=this.updateImageMapAndGetImageTaskQueue(Jn,qs,Et.iconDependencies),cr())},void 0,!1,tr):(Jn=new Map,ii=new Map);const xr=Array.from(Et.patternDependencies.keys()).map(Ir=>s.I.parse(Ir));xr.length?He.send("getImages",{images:xr,source:this.source,scope:this.scope,tileID:this.tileID,type:"patterns"},(Ir,qs)=>{Gn||(Gn=Ir,oi=new Map,Xi=this.updateImageMapAndGetImageTaskQueue(oi,qs,Et.patternDependencies),cr())},void 0,!1,tr):(oi=new Map,Xi=new Map)}if(Et.elevationFeatures&&Et.elevationFeatures.length>0){const Ei=[];for(const xr of Object.values(vt))if(xr instanceof s.b8){const Ir=xr.getUnevaluatedPortalGraph();Ir&&Ei.push(Ir)}const fr=s.f6.evaluate(Ei);for(const xr of Object.values(vt))if(xr instanceof s.b8){const Ir=fe.layers[bt.decode(xr.sourceLayerIndex)];xr.setEvaluatedPortalGraph(fr,Ir,this.tileID.canonical,Et.availableImages,Et.brightness)}}cr()};Kt.length>0?Promise.allSettled(Kt).then(Sn).catch(at):Sn()}rasterizeIfNeeded(fe,ve,Be,tt){Array.from(ve.values()).some(He=>He.usvg)?this.rasterize(fe,ve,Be,tt):tt()}updateImageMapAndGetImageTaskQueue(fe,ve,Be){const tt=new Map;for(const He of ve.keys()){const at=Be.get(He)||[];for(const bt of at){const Ze=bt.toString(),vt=ve.get(bt.id.toString());vt.usvg?tt.has(Ze)||(tt.set(Ze,bt),fe.set(Ze,Object.assign({},vt))):fe.set(Ze,vt)}}return tt}rasterize(fe,ve,Be,tt){this.rasterizeTask=fe.send("rasterizeImages",{scope:this.scope,tasks:Be},(He,at)=>{if(!He)for(const[bt,Ze]of at.entries()){const vt=Object.assign(ve.get(bt),{data:Ze});ve.set(bt,vt)}tt()})}cancelRasterize(){this.rasterizeTask&&this.rasterizeTask.cancel()}}function X(gt,fe,ve,Be,tt){const He=new s.aa(fe,{brightness:ve,worldview:tt});for(const at of gt)at.recalculate(He,Be)}class te extends s.E{constructor(fe,ve,Be,tt,He,at,bt){super(),this.actor=fe,this.layerIndex=ve,this.availableImages=Be,this.availableModels=tt,this.loadVectorData=at||s.aJ,this.loading={},this.loaded={},this.deduped=new s.aI(fe.scheduler),this.isSpriteLoaded=He,this.scheduler=fe.scheduler,this.brightness=bt}loadTile(fe,ve){const Be=fe.uid,tt=fe&&fe.request,He=tt&&tt.collectResourceTiming,at=this.loading[Be]=new J(fe);at.abort=this.loadVectorData(fe,(bt,Ze)=>{const vt=!this.loading[Be];if(delete this.loading[Be],at.cancelRasterize(),vt||bt||!Ze)return at.status="done",vt||(this.loaded[Be]=at),ve(bt);const It=Ze.rawData,Et={};Ze.expires&&(Et.expires=Ze.expires),Ze.cacheControl&&(Et.cacheControl=Ze.cacheControl),at.vectorTile=Ze.vectorTile||new s.fc.VectorTile(new s.bq(It));const Kt=()=>{at.parse(at.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,(_n,Sn)=>{if(_n||!Sn)return ve(_n);const Gn={};if(He){const Vn=T(tt);Vn.length>0&&(Gn.resourceTiming=JSON.parse(JSON.stringify(Vn)))}ve(null,s.h({rawTileData:It.slice(0)},Sn,Et,Gn))})};this.isSpriteLoaded?Kt():this.once("isSpriteLoaded",()=>{this.scheduler?this.scheduler.add(Kt,{type:"parseTile",isSymbolTile:fe.isSymbolTile,zoom:fe.tileZoom}):Kt()}),this.loaded=this.loaded||{},this.loaded[Be]=at})}reloadTile(fe,ve){const Be=this.loaded,tt=fe.uid;if(Be&&Be[tt]){const He=Be[tt];He.scaleFactor=fe.scaleFactor,He.showCollisionBoxes=fe.showCollisionBoxes,He.projection=fe.projection,He.brightness=fe.brightness,He.tileTransform=s.aW(fe.tileID.canonical,fe.projection),He.extraShadowCaster=fe.extraShadowCaster,He.lut=fe.lut,He.worldview=fe.worldview;const at=(bt,Ze)=>{const vt=He.reloadCallback;vt&&(delete He.reloadCallback,He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,vt)),ve(bt,Ze)};He.status==="parsing"?He.reloadCallback=at:He.status==="done"&&(He.vectorTile?He.parse(He.vectorTile,this.layerIndex,this.availableImages,this.availableModels,this.actor,at):at())}else ve(null,void 0)}abortTile(fe,ve){const Be=fe.uid,tt=this.loading[Be];tt&&(tt.abort&&tt.abort(),delete this.loading[Be]),ve()}removeTile(fe,ve){const Be=this.loaded,tt=fe.uid;Be&&Be[tt]&&delete Be[tt],ve()}}class ie{loadTile(fe,ve){const{uid:Be,encoding:tt,rawImageData:He,padding:at}=fe,bt=ImageBitmap&&He instanceof ImageBitmap?this.getImageData(He,at):He;ve(null,new s.fd(Be,bt,tt,at<1))}reloadTile(fe,ve){ve(null,null)}abortTile(fe,ve){ve()}removeTile(fe,ve){ve()}getImageData(fe,ve){this.offscreenCanvas&&this.offscreenCanvasContext||(this.offscreenCanvas=new OffscreenCanvas(fe.width,fe.height),this.offscreenCanvasContext=this.offscreenCanvas.getContext("2d",{willReadFrequently:!0})),this.offscreenCanvas.width=fe.width,this.offscreenCanvas.height=fe.height,this.offscreenCanvasContext.drawImage(fe,0,0,fe.width,fe.height);const Be=this.offscreenCanvasContext.getImageData(-ve,-ve,fe.width+2*ve,fe.height+2*ve);return this.offscreenCanvasContext.clearRect(0,0,this.offscreenCanvas.width,this.offscreenCanvas.height),Be}}s.bp.setPbf(s.bq);class we{constructor(fe){this._mrt=new s.bp(fe.partial?30:1/0),this._isHeaderLoaded=!1,this.uid=fe.uid,this.tileID=fe.tileID,this.source=fe.source}parse(fe,ve){const Be=this._mrt;this.status="parsing",this._entireBuffer=fe;try{Be.parseHeader(fe),this._isHeaderLoaded=!0;const tt=[];for(const He in Be.layers){const at=Be.getLayer(He),bt=at.getDataRange(at.getBandList()),Ze=Be.createDecodingTask(bt),vt=fe.slice(bt.firstByte,bt.lastByte+1),It=s.bp.performDecoding(vt,Ze).then(Et=>Ze.complete(null,Et)).catch(Et=>Ze.complete(Et,null));tt.push(It)}Promise.allSettled(tt).then(()=>ve(null,Be)).catch(He=>ve(He))}catch(tt){ve(tt)}}}class Ie{constructor(fe){this.actor=fe,this.loading={},this.loaded={}}loadTile(fe,ve){const Be=fe.uid,tt=fe.request,He=this.loading[Be]=new we(fe),{cancel:at}=s.br(tt,(bt,Ze,vt,It)=>{const Et=!this.loading[Be];if(delete this.loading[Be],Et||bt||!Ze)return He.status="done",Et||(this.loaded[Be]=He),ve(bt);He.parse(Ze,(Kt,_n)=>{if(Kt||!_n)return ve(Kt);ve(null,_n,vt,It)}),this.loaded[Be]=He});He.abort=at}reloadTile(fe,ve){ve(null,void 0)}abortTile(fe,ve){const Be=fe.uid,tt=this.loading[Be];tt&&(tt.abort&&tt.abort(),delete this.loading[Be]),ve()}removeTile(fe,ve){const Be=fe.uid;this.loaded[Be]&&delete this.loaded[Be],ve()}decodeRasterArray(fe,ve){s.bp.performDecoding(fe.buffer,fe.task).then(Be=>ve(null,Be)).catch(Be=>ve(Be))}}const Re=s.fc.VectorTileFeature.prototype.toGeoJSON;class Ne{constructor(fe){this._feature=fe,this.extent=s.aj,this.type=fe.type,this.properties=fe.tags,"id"in fe&&!isNaN(fe.id)&&(this.id=parseInt(fe.id,10))}loadGeometry(){if(this._feature.type===1){const fe=[];for(const ve of this._feature.geometry)fe.push([new s.P(ve[0],ve[1])]);return fe}{const fe=[];for(const ve of this._feature.geometry){const Be=[];for(const tt of ve)Be.push(new s.P(tt[0],tt[1]));fe.push(Be)}return fe}}toGeoJSON(fe,ve,Be){return Re.call(this,fe,ve,Be)}}class Xe{constructor(fe){this.layers={_geojsonTileLayer:this},this.name="_geojsonTileLayer",this.extent=s.aj,this.length=fe.length,this._features=fe}feature(fe){return new Ne(this._features[fe])}}class be{constructor(fe,ve){this.name=fe,this.extent=s.aj,this.length=ve.length,this._features=ve}feature(fe){return new Ne(this._features[fe])}}class _e extends Xe{constructor(fe){super([]),this.layers={};for(const ve in fe)this.layers[ve]=new be(ve,fe[ve])}}const Te=64/4096,oe=128;class Ee{constructor(){this.features=new Map}clear(){this.features.clear()}load(fe=[],ve){for(const Be of fe){const tt=Be.id;if(tt==null)continue;let He=this.features.get(tt);He&&this.updateCache(He,ve),Be.geometry?(He=ze(Be),this.updateCache(He,ve),this.features.set(tt,He)):this.features.delete(tt),this.updateCache(He,ve)}}updateCache(fe,ve){for(const{canonical:Be,uid:tt}of Object.values(ve)){const{z:He,x:at,y:bt}=Be;$e(fe,Math.pow(2,He),at,bt)&&delete ve[tt]}}getTile(fe,ve,Be){const tt=Math.pow(2,fe),He=[];for(const at of this.features.values())$e(at,tt,ve,Be)&&He.push(Ft(at,tt,ve,Be));return{features:He}}getFeatures(){return[...this.features.values()]}}function $e({minX:gt,minY:fe,maxX:ve,maxY:Be},tt,He,at){return gt<(He+1+Te)/tt&&fe<(at+1+Te)/tt&&ve>(He-Te)/tt&&Be>(at-Te)/tt}function ze(gt){const{id:fe,geometry:ve,properties:Be}=gt;if(!ve)return;if(ve.type==="GeometryCollection")throw new Error("GeometryCollection not supported in dynamic mode.");const{type:tt,coordinates:He}=ve,at={id:fe,type:1,geometry:[],tags:Be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0},bt=at.geometry;if(tt==="Point")zt(He,bt,at);else if(tt==="MultiPoint")for(const Ze of He)zt(Ze,bt,at);else if(tt==="LineString")at.type=2,St(He,bt,at);else if(tt==="MultiLineString")at.type=2,mt(He,bt,at);else if(tt==="Polygon")at.type=3,mt(He,bt,at,!0);else{if(tt!=="MultiPolygon")throw new Error("Input data is not a valid GeoJSON object.");at.type=3;for(const Ze of He)mt(Ze,bt,at,!0)}return at}function zt([gt,fe],ve,Be){const tt=s.aD(gt);let He=s.aH(fe);He=He<0?0:He>1?1:He,ve.push(tt,He),Be.minX=Math.min(Be.minX,tt),Be.minY=Math.min(Be.minY,He),Be.maxX=Math.max(Be.maxX,tt),Be.maxY=Math.max(Be.maxY,He)}function St(gt,fe,ve,Be=!1,tt=!1){const He=[];for(const at of gt)zt(at,He,ve);fe.push(He),Be&&function(at,bt){let Ze=0;for(let vt=0,It=at.length,Et=It-2;vt<It;Et=vt,vt+=2)Ze+=(at[vt]-at[Et])*(at[vt+1]+at[Et+1]);if(Ze>0===bt)for(let vt=0,It=at.length;vt<It/2;vt+=2){const Et=at[vt],Kt=at[vt+1];at[vt]=at[It-2-vt],at[vt+1]=at[It-1-vt],at[It-2-vt]=Et,at[It-1-vt]=Kt}}(He,tt)}function mt(gt,fe,ve,Be=!1){for(let tt=0;tt<gt.length;tt++)St(gt[tt],fe,ve,Be,tt===0)}function Ft(gt,fe,ve,Be){const{id:tt,type:He,geometry:at,tags:bt}=gt,Ze=[];if(He===1)(function(vt,It,Et,Kt,_n){for(let Sn=0;Sn<vt.length;Sn+=2){const Gn=Math.round(s.aj*(vt[Sn+0]*It-Et)),Vn=Math.round(s.aj*(vt[Sn+1]*It-Kt));_n.push([Gn,Vn])}})(at,fe,ve,Be,Ze);else for(const vt of at)rn(vt,fe,ve,Be,Ze);return{id:tt,type:He,geometry:Ze,tags:bt}}function rn(gt,fe,ve,Be,tt){const at=s.aj+oe;let bt;for(let Ze=0;Ze<gt.length-2;Ze+=2){let vt=Math.round(s.aj*(gt[Ze+0]*fe-ve)),It=Math.round(s.aj*(gt[Ze+1]*fe-Be)),Et=Math.round(s.aj*(gt[Ze+2]*fe-ve)),Kt=Math.round(s.aj*(gt[Ze+3]*fe-Be));const _n=Et-vt,Sn=Kt-It;vt<-128&&Et<-128||(vt<-128?(It+=Math.round(Sn*((-128-vt)/_n)),vt=-128):Et<-128&&(Kt=It+Math.round(Sn*((-128-vt)/_n)),Et=-128),It<-128&&Kt<-128||(It<-128?(vt+=Math.round(_n*((-128-It)/Sn)),It=-128):Kt<-128&&(Et=vt+Math.round(_n*((-128-It)/Sn)),Kt=-128),vt>=at&&Et>=at||(vt>=at?(It+=Math.round(Sn*((at-vt)/_n)),vt=at):Et>=at&&(Kt=It+Math.round(Sn*((at-vt)/_n)),Et=at),It>=at&&Kt>=at||(It>=at?(vt+=Math.round(_n*((at-It)/Sn)),It=at):Kt>=at&&(Et=vt+Math.round(_n*((at-It)/Sn)),Kt=at),bt&&vt===bt[bt.length-1][0]&&It===bt[bt.length-1][1]||(bt=[[vt,It]],tt.push(bt)),bt.push([Et,Kt])))))}}var Xt,Fe,Ot,Ut={exports:{}},ln=function(){if(Ot)return Ut.exports;Ot=1;var gt=s.fg(),fe=function(){if(Fe)return Xt;Fe=1;var It=s.fe(),Et=s.ff().VectorTileFeature;function Kt(Sn,Gn){this.options=Gn||{},this.features=Sn,this.length=Sn.length}function _n(Sn,Gn){this.id=typeof Sn.id=="number"?Sn.id:void 0,this.type=Sn.type,this.rawGeometry=Sn.type===1?[Sn.geometry]:Sn.geometry,this.properties=Sn.tags,this.extent=Gn||4096}return Xt=Kt,Kt.prototype.feature=function(Sn){return new _n(this.features[Sn],this.options.extent)},_n.prototype.loadGeometry=function(){var Sn=this.rawGeometry;this.geometry=[];for(var Gn=0;Gn<Sn.length;Gn++){for(var Vn=Sn[Gn],Jn=[],oi=0;oi<Vn.length;oi++)Jn.push(new It(Vn[oi][0],Vn[oi][1]));this.geometry.push(Jn)}return this.geometry},_n.prototype.bbox=function(){this.geometry||this.loadGeometry();for(var Sn=this.geometry,Gn=1/0,Vn=-1/0,Jn=1/0,oi=-1/0,ii=0;ii<Sn.length;ii++)for(var Xi=Sn[ii],tr=0;tr<Xi.length;tr++){var cr=Xi[tr];Gn=Math.min(Gn,cr.x),Vn=Math.max(Vn,cr.x),Jn=Math.min(Jn,cr.y),oi=Math.max(oi,cr.y)}return[Gn,Jn,Vn,oi]},_n.prototype.toGeoJSON=Et.prototype.toGeoJSON,Xt}();function ve(It){var Et=new gt;return function(Kt,_n){for(var Sn in Kt.layers)_n.writeMessage(3,Be,Kt.layers[Sn])}(It,Et),Et.finish()}function Be(It,Et){var Kt;Et.writeVarintField(15,It.version||1),Et.writeStringField(1,It.name||""),Et.writeVarintField(5,It.extent||4096);var _n={keys:[],values:[],keycache:{},valuecache:{}};for(Kt=0;Kt<It.length;Kt++)_n.feature=It.feature(Kt),Et.writeMessage(2,tt,_n);var Sn=_n.keys;for(Kt=0;Kt<Sn.length;Kt++)Et.writeStringField(3,Sn[Kt]);var Gn=_n.values;for(Kt=0;Kt<Gn.length;Kt++)Et.writeMessage(4,vt,Gn[Kt])}function tt(It,Et){var Kt=It.feature;Kt.id!==void 0&&Et.writeVarintField(1,Kt.id),Et.writeMessage(2,He,It),Et.writeVarintField(3,Kt.type),Et.writeMessage(4,Ze,Kt)}function He(It,Et){var Kt=It.feature,_n=It.keys,Sn=It.values,Gn=It.keycache,Vn=It.valuecache;for(var Jn in Kt.properties){var oi=Kt.properties[Jn],ii=Gn[Jn];if(oi!==null){ii===void 0&&(_n.push(Jn),Gn[Jn]=ii=_n.length-1),Et.writeVarint(ii);var Xi=typeof oi;Xi!=="string"&&Xi!=="boolean"&&Xi!=="number"&&(oi=JSON.stringify(oi));var tr=Xi+":"+oi,cr=Vn[tr];cr===void 0&&(Sn.push(oi),Vn[tr]=cr=Sn.length-1),Et.writeVarint(cr)}}}function at(It,Et){return(Et<<3)+(7&It)}function bt(It){return It<<1^It>>31}function Ze(It,Et){for(var Kt=It.loadGeometry(),_n=It.type,Sn=0,Gn=0,Vn=Kt.length,Jn=0;Jn<Vn;Jn++){var oi=Kt[Jn],ii=1;_n===1&&(ii=oi.length),Et.writeVarint(at(1,ii));for(var Xi=_n===3?oi.length-1:oi.length,tr=0;tr<Xi;tr++){tr===1&&_n!==1&&Et.writeVarint(at(2,Xi-1));var cr=oi[tr].x-Sn,Ai=oi[tr].y-Gn;Et.writeVarint(bt(cr)),Et.writeVarint(bt(Ai)),Sn+=cr,Gn+=Ai}_n===3&&Et.writeVarint(at(7,1))}}function vt(It,Et){var Kt=typeof It;Kt==="string"?Et.writeStringField(1,It):Kt==="boolean"?Et.writeBooleanField(7,It):Kt==="number"&&(It%1!=0?Et.writeDoubleField(3,It):It<0?Et.writeSVarintField(6,It):Et.writeVarintField(5,It))}return Ut.exports=ve,Ut.exports.fromVectorTileJs=ve,Ut.exports.fromGeojsonVt=function(It,Et){Et=Et||{};var Kt={};for(var _n in It)Kt[_n]=new fe(It[_n].features,Et),Kt[_n].name=_n,Kt[_n].version=Et.version,Kt[_n].extent=Et.extent;return ve({layers:Kt})},Ut.exports.GeoJSONWrapper=fe,Ut.exports}(),wn=s.fh(ln);const dn={minZoom:0,maxZoom:16,minPoints:2,radius:40,extent:512,nodeSize:64,log:!1,generateId:!1,reduce:null,map:gt=>gt},Ht=Math.fround||(Mn=new Float32Array(1),gt=>(Mn[0]=+gt,Mn[0]));var Mn;const yn=3,Tn=5,Cn=6;class Kn{constructor(fe){this.options=Object.assign(Object.create(dn),fe),this.trees=new Array(this.options.maxZoom+1),this.stride=this.options.reduce?7:6,this.clusterProps=[]}load(fe){const{log:ve,minZoom:Be,maxZoom:tt}=this.options;ve&&console.time("total time");const He=`prepare ${fe.length} points`;ve&&console.time(He),this.points=fe;const at=[];for(let Ze=0;Ze<fe.length;Ze++){const vt=fe[Ze];if(!vt.geometry)continue;const[It,Et]=vt.geometry.coordinates,Kt=Ht(er(It)),_n=Ht(_r(Et));at.push(Kt,_n,1/0,Ze,-1,1),this.options.reduce&&at.push(0)}let bt=this.trees[tt+1]=this._createTree(at);ve&&console.timeEnd(He);for(let Ze=tt;Ze>=Be;Ze--){const vt=+Date.now();bt=this.trees[Ze]=this._createTree(this._cluster(bt,Ze)),ve&&console.log("z%d: %d clusters in %dms",Ze,bt.numItems,+Date.now()-vt)}return ve&&console.timeEnd("total time"),this}getClusters(fe,ve){let Be=((fe[0]+180)%360+360)%360-180;const tt=Math.max(-90,Math.min(90,fe[1]));let He=fe[2]===180?180:((fe[2]+180)%360+360)%360-180;const at=Math.max(-90,Math.min(90,fe[3]));if(fe[2]-fe[0]>=360)Be=-180,He=180;else if(Be>He){const Et=this.getClusters([Be,tt,180,at],ve),Kt=this.getClusters([-180,tt,He,at],ve);return Et.concat(Kt)}const bt=this.trees[this._limitZoom(ve)],Ze=bt.range(er(Be),_r(at),er(He),_r(tt)),vt=bt.data,It=[];for(const Et of Ze){const Kt=this.stride*Et;It.push(vt[Kt+Tn]>1?Bt(vt,Kt,this.clusterProps):this.points[vt[Kt+yn]])}return It}getChildren(fe){const ve=this._getOriginId(fe),Be=this._getOriginZoom(fe),tt="No cluster with the specified id.",He=this.trees[Be];if(!He)throw new Error(tt);const at=He.data;if(ve*this.stride>=at.length)throw new Error(tt);const bt=this.options.radius/(this.options.extent*Math.pow(2,Be-1)),Ze=He.within(at[ve*this.stride],at[ve*this.stride+1],bt),vt=[];for(const It of Ze){const Et=It*this.stride;at[Et+4]===fe&&vt.push(at[Et+Tn]>1?Bt(at,Et,this.clusterProps):this.points[at[Et+yn]])}if(vt.length===0)throw new Error(tt);return vt}getLeaves(fe,ve,Be){const tt=[];return this._appendLeaves(tt,fe,ve=ve||10,Be=Be||0,0),tt}getTile(fe,ve,Be){const tt=this.trees[this._limitZoom(fe)],He=Math.pow(2,fe),{extent:at,radius:bt}=this.options,Ze=bt/at,vt=(Be-Ze)/He,It=(Be+1+Ze)/He,Et={features:[]};return this._addTileFeatures(tt.range((ve-Ze)/He,vt,(ve+1+Ze)/He,It),tt.data,ve,Be,He,Et),ve===0&&this._addTileFeatures(tt.range(1-Ze/He,vt,1,It),tt.data,He,Be,He,Et),ve===He-1&&this._addTileFeatures(tt.range(0,vt,Ze/He,It),tt.data,-1,Be,He,Et),Et.features.length?Et:null}getClusterExpansionZoom(fe){let ve=this._getOriginZoom(fe)-1;for(;ve<=this.options.maxZoom;){const Be=this.getChildren(fe);if(ve++,Be.length!==1)break;fe=Be[0].properties.cluster_id}return ve}_appendLeaves(fe,ve,Be,tt,He){const at=this.getChildren(ve);for(const bt of at){const Ze=bt.properties;if(Ze&&Ze.cluster?He+Ze.point_count<=tt?He+=Ze.point_count:He=this._appendLeaves(fe,Ze.cluster_id,Be,tt,He):He<tt?He++:fe.push(bt),fe.length===Be)break}return He}_createTree(fe){const ve=new s.bW(fe.length/this.stride|0,this.options.nodeSize,Float32Array);for(let Be=0;Be<fe.length;Be+=this.stride)ve.add(fe[Be],fe[Be+1]);return ve.finish(),ve.data=fe,ve}_addTileFeatures(fe,ve,Be,tt,He,at){for(const bt of fe){const Ze=bt*this.stride,vt=ve[Ze+Tn]>1;let It,Et,Kt;if(vt)It=ni(ve,Ze,this.clusterProps),Et=ve[Ze],Kt=ve[Ze+1];else{const Gn=this.points[ve[Ze+yn]];It=Gn.properties;const[Vn,Jn]=Gn.geometry.coordinates;Et=er(Vn),Kt=_r(Jn)}const _n={type:1,geometry:[[Math.round(this.options.extent*(Et*He-Be)),Math.round(this.options.extent*(Kt*He-tt))]],tags:It};let Sn;Sn=vt||this.options.generateId?ve[Ze+yn]:this.points[ve[Ze+yn]].id,Sn!==void 0&&(_n.id=Sn),at.features.push(_n)}}_limitZoom(fe){return Math.max(this.options.minZoom,Math.min(Math.floor(+fe),this.options.maxZoom+1))}_cluster(fe,ve){const{radius:Be,extent:tt,reduce:He,minPoints:at}=this.options,bt=Be/(tt*Math.pow(2,ve)),Ze=fe.data,vt=[],It=this.stride;for(let Et=0;Et<Ze.length;Et+=It){if(Ze[Et+2]<=ve)continue;Ze[Et+2]=ve;const Kt=Ze[Et],_n=Ze[Et+1],Sn=fe.within(Ze[Et],Ze[Et+1],bt),Gn=Ze[Et+Tn];let Vn=Gn;for(const Jn of Sn){const oi=Jn*It;Ze[oi+2]>ve&&(Vn+=Ze[oi+Tn])}if(Vn>Gn&&Vn>=at){let Jn,oi=Kt*Gn,ii=_n*Gn,Xi=-1;const tr=(Et/It<<5)+(ve+1)+this.points.length;for(const cr of Sn){const Ai=cr*It;if(Ze[Ai+2]<=ve)continue;Ze[Ai+2]=ve;const Ei=Ze[Ai+Tn];oi+=Ze[Ai]*Ei,ii+=Ze[Ai+1]*Ei,Ze[Ai+4]=tr,He&&(Jn||(Jn=this._map(Ze,Et,!0),Xi=this.clusterProps.length,this.clusterProps.push(Jn)),He(Jn,this._map(Ze,Ai)))}Ze[Et+4]=tr,vt.push(oi/Vn,ii/Vn,1/0,tr,-1,Vn),He&&vt.push(Xi)}else{for(let Jn=0;Jn<It;Jn++)vt.push(Ze[Et+Jn]);if(Vn>1)for(const Jn of Sn){const oi=Jn*It;if(!(Ze[oi+2]<=ve)){Ze[oi+2]=ve;for(let ii=0;ii<It;ii++)vt.push(Ze[oi+ii])}}}}return vt}_getOriginId(fe){return fe-this.points.length>>5}_getOriginZoom(fe){return(fe-this.points.length)%32}_map(fe,ve,Be){if(fe[ve+Tn]>1){const at=this.clusterProps[fe[ve+Cn]];return Be?Object.assign({},at):at}const tt=this.points[fe[ve+yn]].properties,He=this.options.map(tt);return Be&&He===tt?Object.assign({},He):He}}function Bt(gt,fe,ve){return{type:"Feature",id:gt[fe+yn],properties:ni(gt,fe,ve),geometry:{type:"Point",coordinates:[(Be=gt[fe],360*(Be-.5)),Li(gt[fe+1])]}};var Be}function ni(gt,fe,ve){const Be=gt[fe+Tn],tt=Be>=1e4?`${Math.round(Be/1e3)}k`:Be>=1e3?Math.round(Be/100)/10+"k":Be,He=gt[fe+Cn],at=He===-1?{}:Object.assign({},ve[He]);return Object.assign(at,{cluster:!0,cluster_id:gt[fe+yn],point_count:Be,point_count_abbreviated:tt})}function er(gt){return gt/360+.5}function _r(gt){const fe=Math.sin(gt*Math.PI/180),ve=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ve<0?0:ve>1?1:ve}function Li(gt){const fe=(180-360*gt)*Math.PI/180;return 360*Math.atan(Math.exp(fe))/Math.PI-90}function jr(gt,fe,ve,Be){let tt=Be;const He=fe+(ve-fe>>1);let at,bt=ve-fe;const Ze=gt[fe],vt=gt[fe+1],It=gt[ve],Et=gt[ve+1];for(let Kt=fe+3;Kt<ve;Kt+=3){const _n=ss(gt[Kt],gt[Kt+1],Ze,vt,It,Et);if(_n>tt)at=Kt,tt=_n;else if(_n===tt){const Sn=Math.abs(Kt-He);Sn<bt&&(at=Kt,bt=Sn)}}tt>Be&&(at-fe>3&&jr(gt,fe,at,Be),gt[at+2]=tt,ve-at>3&&jr(gt,at,ve,Be))}function ss(gt,fe,ve,Be,tt,He){let at=tt-ve,bt=He-Be;if(at!==0||bt!==0){const Ze=((gt-ve)*at+(fe-Be)*bt)/(at*at+bt*bt);Ze>1?(ve=tt,Be=He):Ze>0&&(ve+=at*Ze,Be+=bt*Ze)}return at=gt-ve,bt=fe-Be,at*at+bt*bt}function Nr(gt,fe,ve,Be){const tt={id:gt??null,type:fe,geometry:ve,tags:Be,minX:1/0,minY:1/0,maxX:-1/0,maxY:-1/0};if(fe==="Point"||fe==="MultiPoint"||fe==="LineString")ti(tt,ve);else if(fe==="Polygon")ti(tt,ve[0]);else if(fe==="MultiLineString")for(const He of ve)ti(tt,He);else if(fe==="MultiPolygon")for(const He of ve)ti(tt,He[0]);return tt}function ti(gt,fe){for(let ve=0;ve<fe.length;ve+=3)gt.minX=Math.min(gt.minX,fe[ve]),gt.minY=Math.min(gt.minY,fe[ve+1]),gt.maxX=Math.max(gt.maxX,fe[ve]),gt.maxY=Math.max(gt.maxY,fe[ve+1])}function dr(gt,fe,ve,Be){if(!fe.geometry)return;const tt=fe.geometry.coordinates;if(tt&&tt.length===0)return;const He=fe.geometry.type,at=Math.pow(ve.tolerance/((1<<ve.maxZoom)*ve.extent),2);let bt=[],Ze=fe.id;if(ve.promoteId?Ze=fe.properties[ve.promoteId]:ve.generateId&&(Ze=Be||0),He==="Point")di(tt,bt);else if(He==="MultiPoint")for(const vt of tt)di(vt,bt);else if(He==="LineString")ks(tt,bt,at,!1);else if(He==="MultiLineString"){if(ve.lineMetrics){for(const vt of tt)bt=[],ks(vt,bt,at,!1),gt.push(Nr(Ze,"LineString",bt,fe.properties));return}fs(tt,bt,at,!1)}else if(He==="Polygon")fs(tt,bt,at,!0);else{if(He!=="MultiPolygon"){if(He==="GeometryCollection"){for(const vt of fe.geometry.geometries)dr(gt,{id:Ze,geometry:vt,properties:fe.properties},ve,Be);return}throw new Error("Input data is not a valid GeoJSON object.")}for(const vt of tt){const It=[];fs(vt,It,at,!0),bt.push(It)}}gt.push(Nr(Ze,He,bt,fe.properties))}function di(gt,fe){fe.push(Uo(gt[0]),Kr(gt[1]),0)}function ks(gt,fe,ve,Be){let tt,He,at=0;for(let Ze=0;Ze<gt.length;Ze++){const vt=Uo(gt[Ze][0]),It=Kr(gt[Ze][1]);fe.push(vt,It,0),Ze>0&&(at+=Be?(tt*It-vt*He)/2:Math.sqrt(Math.pow(vt-tt,2)+Math.pow(It-He,2))),tt=vt,He=It}const bt=fe.length-3;fe[2]=1,jr(fe,0,bt,ve),fe[bt+2]=1,fe.size=Math.abs(at),fe.start=0,fe.end=fe.size}function fs(gt,fe,ve,Be){for(let tt=0;tt<gt.length;tt++){const He=[];ks(gt[tt],He,ve,Be),fe.push(He)}}function Uo(gt){return gt/360+.5}function Kr(gt){const fe=Math.sin(gt*Math.PI/180),ve=.5-.25*Math.log((1+fe)/(1-fe))/Math.PI;return ve<0?0:ve>1?1:ve}function ir(gt,fe,ve,Be,tt,He,at,bt){if(Be/=fe,He>=(ve/=fe)&&at<Be)return gt;if(at<ve||He>=Be)return null;const Ze=[];for(const vt of gt){const It=vt.geometry;let Et=vt.type;const Kt=tt===0?vt.minX:vt.minY,_n=tt===0?vt.maxX:vt.maxY;if(Kt>=ve&&_n<Be){Ze.push(vt);continue}if(_n<ve||Kt>=Be)continue;let Sn=[];if(Et==="Point"||Et==="MultiPoint")Po(It,Sn,ve,Be,tt);else if(Et==="LineString")ro(It,Sn,ve,Be,tt,!1,bt.lineMetrics);else if(Et==="MultiLineString")Or(It,Sn,ve,Be,tt,!1);else if(Et==="Polygon")Or(It,Sn,ve,Be,tt,!0);else if(Et==="MultiPolygon")for(const Gn of It){const Vn=[];Or(Gn,Vn,ve,Be,tt,!0),Vn.length&&Sn.push(Vn)}if(Sn.length){if(bt.lineMetrics&&Et==="LineString"){for(const Gn of Sn)Ze.push(Nr(vt.id,Et,Gn,vt.tags));continue}Et!=="LineString"&&Et!=="MultiLineString"||(Sn.length===1?(Et="LineString",Sn=Sn[0]):Et="MultiLineString"),Et!=="Point"&&Et!=="MultiPoint"||(Et=Sn.length===3?"Point":"MultiPoint"),Ze.push(Nr(vt.id,Et,Sn,vt.tags))}}return Ze.length?Ze:null}function Po(gt,fe,ve,Be,tt){for(let He=0;He<gt.length;He+=3){const at=gt[He+tt];at>=ve&&at<=Be&&ps(fe,gt[He],gt[He+1],gt[He+2])}}function ro(gt,fe,ve,Be,tt,He,at){let bt=jo(gt);const Ze=tt===0?Ns:Hr;let vt,It,Et=gt.start;for(let Vn=0;Vn<gt.length-3;Vn+=3){const Jn=gt[Vn],oi=gt[Vn+1],ii=gt[Vn+2],Xi=gt[Vn+3],tr=gt[Vn+4],cr=tt===0?Jn:oi,Ai=tt===0?Xi:tr;let Ei=!1;at&&(vt=Math.sqrt(Math.pow(Jn-Xi,2)+Math.pow(oi-tr,2))),cr<ve?Ai>ve&&(It=Ze(bt,Jn,oi,Xi,tr,ve),at&&(bt.start=Et+vt*It)):cr>Be?Ai<Be&&(It=Ze(bt,Jn,oi,Xi,tr,Be),at&&(bt.start=Et+vt*It)):ps(bt,Jn,oi,ii),Ai<ve&&cr>=ve&&(It=Ze(bt,Jn,oi,Xi,tr,ve),Ei=!0),Ai>Be&&cr<=Be&&(It=Ze(bt,Jn,oi,Xi,tr,Be),Ei=!0),!He&&Ei&&(at&&(bt.end=Et+vt*It),fe.push(bt),bt=jo(gt)),at&&(Et+=vt)}let Kt=gt.length-3;const _n=gt[Kt],Sn=gt[Kt+1],Gn=tt===0?_n:Sn;Gn>=ve&&Gn<=Be&&ps(bt,_n,Sn,gt[Kt+2]),Kt=bt.length-3,He&&Kt>=3&&(bt[Kt]!==bt[0]||bt[Kt+1]!==bt[1])&&ps(bt,bt[0],bt[1],bt[2]),bt.length&&fe.push(bt)}function jo(gt){const fe=[];return fe.size=gt.size,fe.start=gt.start,fe.end=gt.end,fe}function Or(gt,fe,ve,Be,tt,He){for(const at of gt)ro(at,fe,ve,Be,tt,He,!1)}function ps(gt,fe,ve,Be){gt.push(fe,ve,Be)}function Ns(gt,fe,ve,Be,tt,He){const at=(He-fe)/(Be-fe);return ps(gt,He,ve+(tt-ve)*at,1),at}function Hr(gt,fe,ve,Be,tt,He){const at=(He-ve)/(tt-ve);return ps(gt,fe+(Be-fe)*at,He,1),at}function Xs(gt,fe){const ve=[];for(let Be=0;Be<gt.length;Be++){const tt=gt[Be],He=tt.type;let at;if(He==="Point"||He==="MultiPoint"||He==="LineString")at=ho(tt.geometry,fe);else if(He==="MultiLineString"||He==="Polygon"){at=[];for(const bt of tt.geometry)at.push(ho(bt,fe))}else if(He==="MultiPolygon"){at=[];for(const bt of tt.geometry){const Ze=[];for(const vt of bt)Ze.push(ho(vt,fe));at.push(Ze)}}ve.push(Nr(tt.id,He,at,tt.tags))}return ve}function ho(gt,fe){const ve=[];ve.size=gt.size,gt.start!==void 0&&(ve.start=gt.start,ve.end=gt.end);for(let Be=0;Be<gt.length;Be+=3)ve.push(gt[Be]+fe,gt[Be+1],gt[Be+2]);return ve}function Ge(gt,fe){if(gt.transformed)return gt;const ve=1<<gt.z,Be=gt.x,tt=gt.y;for(const He of gt.features){const at=He.geometry,bt=He.type;if(He.geometry=[],bt===1)for(let Ze=0;Ze<at.length;Ze+=2)He.geometry.push(xt(at[Ze],at[Ze+1],fe,ve,Be,tt));else for(let Ze=0;Ze<at.length;Ze++){const vt=[];for(let It=0;It<at[Ze].length;It+=2)vt.push(xt(at[Ze][It],at[Ze][It+1],fe,ve,Be,tt));He.geometry.push(vt)}}return gt.transformed=!0,gt}function xt(gt,fe,ve,Be,tt,He){return[Math.round(ve*(gt*Be-tt)),Math.round(ve*(fe*Be-He))]}function Pn(gt,fe,ve,Be,tt){const He=fe===tt.maxZoom?0:tt.tolerance/((1<<fe)*tt.extent),at={features:[],numPoints:0,numSimplified:0,numFeatures:gt.length,source:null,x:ve,y:Be,z:fe,transformed:!1,minX:2,minY:1,maxX:-1,maxY:0};for(const bt of gt)jn(at,bt,He,tt);return at}function jn(gt,fe,ve,Be){const tt=fe.geometry,He=fe.type,at=[];if(gt.minX=Math.min(gt.minX,fe.minX),gt.minY=Math.min(gt.minY,fe.minY),gt.maxX=Math.max(gt.maxX,fe.maxX),gt.maxY=Math.max(gt.maxY,fe.maxY),He==="Point"||He==="MultiPoint")for(let bt=0;bt<tt.length;bt+=3)at.push(tt[bt],tt[bt+1]),gt.numPoints++,gt.numSimplified++;else if(He==="LineString")Wn(at,tt,gt,ve,!1,!1);else if(He==="MultiLineString"||He==="Polygon")for(let bt=0;bt<tt.length;bt++)Wn(at,tt[bt],gt,ve,He==="Polygon",bt===0);else if(He==="MultiPolygon")for(let bt=0;bt<tt.length;bt++){const Ze=tt[bt];for(let vt=0;vt<Ze.length;vt++)Wn(at,Ze[vt],gt,ve,!0,vt===0)}if(at.length){let bt=fe.tags||null;if(He==="LineString"&&Be.lineMetrics){bt={};for(const vt in fe.tags)bt[vt]=fe.tags[vt];bt.mapbox_clip_start=tt.start/tt.size,bt.mapbox_clip_end=tt.end/tt.size}const Ze={geometry:at,type:He==="Polygon"||He==="MultiPolygon"?3:He==="LineString"||He==="MultiLineString"?2:1,tags:bt};fe.id!==null&&(Ze.id=fe.id),gt.features.push(Ze)}}function Wn(gt,fe,ve,Be,tt,He){const at=Be*Be;if(Be>0&&fe.size<(tt?at:Be))return void(ve.numPoints+=fe.length/3);const bt=[];for(let Ze=0;Ze<fe.length;Ze+=3)(Be===0||fe[Ze+2]>at)&&(ve.numSimplified++,bt.push(fe[Ze],fe[Ze+1])),ve.numPoints++;tt&&function(Ze,vt){let It=0;for(let Et=0,Kt=Ze.length,_n=Kt-2;Et<Kt;_n=Et,Et+=2)It+=(Ze[Et]-Ze[_n])*(Ze[Et+1]+Ze[_n+1]);if(It>0===vt)for(let Et=0,Kt=Ze.length;Et<Kt/2;Et+=2){const _n=Ze[Et],Sn=Ze[Et+1];Ze[Et]=Ze[Kt-2-Et],Ze[Et+1]=Ze[Kt-1-Et],Ze[Kt-2-Et]=_n,Ze[Kt-1-Et]=Sn}}(bt,He),gt.push(bt)}const zi={maxZoom:14,indexMaxZoom:5,indexMaxPoints:1e5,tolerance:3,extent:4096,buffer:64,lineMetrics:!1,promoteId:null,generateId:!1,debug:0};class Ri{constructor(fe,ve){const Be=(ve=this.options=function(He,at){for(const bt in at)He[bt]=at[bt];return He}(Object.create(zi),ve)).debug;if(Be&&console.time("preprocess data"),ve.maxZoom<0||ve.maxZoom>24)throw new Error("maxZoom should be in the 0-24 range");if(ve.promoteId&&ve.generateId)throw new Error("promoteId and generateId cannot be used together.");let tt=function(He,at){const bt=[];if(He.type==="FeatureCollection")for(let Ze=0;Ze<He.features.length;Ze++)dr(bt,He.features[Ze],at,Ze);else dr(bt,He.type==="Feature"?He:{geometry:He},at);return bt}(fe,ve);this.tiles={},this.tileCoords=[],Be&&(console.timeEnd("preprocess data"),console.log("index: maxZoom: %d, maxPoints: %d",ve.indexMaxZoom,ve.indexMaxPoints),console.time("generate tiles"),this.stats={},this.total=0),tt=function(He,at){const bt=at.buffer/at.extent;let Ze=He;const vt=ir(He,1,-1-bt,bt,0,-1,2,at),It=ir(He,1,1-bt,2+bt,0,-1,2,at);return(vt||It)&&(Ze=ir(He,1,-bt,1+bt,0,-1,2,at)||[],vt&&(Ze=Xs(vt,1).concat(Ze)),It&&(Ze=Ze.concat(Xs(It,-1)))),Ze}(tt,ve),tt.length&&this.splitTile(tt,0,0,0),Be&&(tt.length&&console.log("features: %d, points: %d",this.tiles[0].numFeatures,this.tiles[0].numPoints),console.timeEnd("generate tiles"),console.log("tiles generated:",this.total,JSON.stringify(this.stats)))}splitTile(fe,ve,Be,tt,He,at,bt){const Ze=[fe,ve,Be,tt],vt=this.options,It=vt.debug;for(;Ze.length;){tt=Ze.pop(),Be=Ze.pop(),ve=Ze.pop(),fe=Ze.pop();const Et=1<<ve,Kt=Ii(ve,Be,tt);let _n=this.tiles[Kt];if(!_n&&(It>1&&console.time("creation"),_n=this.tiles[Kt]=Pn(fe,ve,Be,tt,vt),this.tileCoords.push({z:ve,x:Be,y:tt}),It)){It>1&&(console.log("tile z%d-%d-%d (features: %d, points: %d, simplified: %d)",ve,Be,tt,_n.numFeatures,_n.numPoints,_n.numSimplified),console.timeEnd("creation"));const Ei=`z${ve}`;this.stats[Ei]=(this.stats[Ei]||0)+1,this.total++}if(_n.source=fe,He==null){if(ve===vt.indexMaxZoom||_n.numPoints<=vt.indexMaxPoints)continue}else{if(ve===vt.maxZoom||ve===He)continue;if(He!=null){const Ei=He-ve;if(Be!==at>>Ei||tt!==bt>>Ei)continue}}if(_n.source=null,fe.length===0)continue;It>1&&console.time("clipping");const Sn=.5*vt.buffer/vt.extent,Gn=.5-Sn,Vn=.5+Sn,Jn=1+Sn;let oi=null,ii=null,Xi=null,tr=null,cr=ir(fe,Et,Be-Sn,Be+Vn,0,_n.minX,_n.maxX,vt),Ai=ir(fe,Et,Be+Gn,Be+Jn,0,_n.minX,_n.maxX,vt);fe=null,cr&&(oi=ir(cr,Et,tt-Sn,tt+Vn,1,_n.minY,_n.maxY,vt),ii=ir(cr,Et,tt+Gn,tt+Jn,1,_n.minY,_n.maxY,vt),cr=null),Ai&&(Xi=ir(Ai,Et,tt-Sn,tt+Vn,1,_n.minY,_n.maxY,vt),tr=ir(Ai,Et,tt+Gn,tt+Jn,1,_n.minY,_n.maxY,vt),Ai=null),It>1&&console.timeEnd("clipping"),Ze.push(oi||[],ve+1,2*Be,2*tt),Ze.push(ii||[],ve+1,2*Be,2*tt+1),Ze.push(Xi||[],ve+1,2*Be+1,2*tt),Ze.push(tr||[],ve+1,2*Be+1,2*tt+1)}}getTile(fe,ve,Be){fe=+fe,ve=+ve,Be=+Be;const tt=this.options,{extent:He,debug:at}=tt;if(fe<0||fe>24)return null;const bt=1<<fe,Ze=Ii(fe,ve=ve+bt&bt-1,Be);if(this.tiles[Ze])return Ge(this.tiles[Ze],He);at>1&&console.log("drilling down to z%d-%d-%d",fe,ve,Be);let vt,It=fe,Et=ve,Kt=Be;for(;!vt&&It>0;)It--,Et>>=1,Kt>>=1,vt=this.tiles[Ii(It,Et,Kt)];return vt&&vt.source?(at>1&&(console.log("found parent tile z%d-%d-%d",It,Et,Kt),console.time("drilling down")),this.splitTile(vt.source,It,Et,Kt,fe,ve,Be),at>1&&console.timeEnd("drilling down"),this.tiles[Ze]?Ge(this.tiles[Ze],He):null):null}}function Ii(gt,fe,ve){return 32*((1<<gt)*ve+fe)+gt}function Lt(gt,fe){const ve=gt.tileID.canonical;if(!this._geoJSONIndex)return void fe(null,null);const Be=this._geoJSONIndex.getTile(ve.z,ve.x,ve.y);if(!Be)return void fe(null,null);const tt=Ze=>Ze.tags&&"3d_elevation_id"in Ze.tags&&"source"in Ze.tags&&Ze.tags.source==="elevation",He=Be.features.filter(Ze=>tt(Ze));let at;if(He.length>0){const Ze=Be.features.filter(vt=>!tt(vt));at=new _e({_geojsonTileLayer:Ze,hd_road_elevation:He})}else at=new Xe(Be.features);let bt=wn(at);bt.byteOffset===0&&bt.byteLength===bt.buffer.byteLength||(bt=new Uint8Array(bt)),fe(null,{vectorTile:at,rawData:bt.buffer})}class $r extends te{constructor(fe,ve,Be,tt,He,at,bt){super(fe,ve,Be,tt,He,Lt,bt),at&&(this.loadGeoJSON=at),this._dynamicIndex=new Ee}loadData(fe,ve){const Be=fe&&fe.request,tt=Be&&Be.collectResourceTiming;this.loadGeoJSON(fe,(He,at)=>{if(He||!at)return ve(He);if(typeof at!="object")return ve(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));{try{if(fe.filter){const Ze=s.X(fe.filter,{type:"boolean","property-type":"data-driven",overridable:!1,transition:!1});if(Ze.result==="error")throw new Error(Ze.value.map(vt=>`${vt.key}: ${vt.message}`).join(", "));at.features=at.features.filter(vt=>Ze.value.evaluate({zoom:0},vt))}fe.dynamic?(at.type==="Feature"&&(at={type:"FeatureCollection",features:[at]}),fe.append||(this._dynamicIndex.clear(),this.loaded={}),this._dynamicIndex.load(at.features,this.loaded),fe.cluster&&(at.features=this._dynamicIndex.getFeatures())):this.loaded={},this._geoJSONIndex=fe.cluster?new Kn(function({superclusterOptions:Ze,clusterProperties:vt}){if(!vt||!Ze)return Ze;const It={},Et={},Kt={accumulated:null,zoom:0},_n={properties:null},Sn=Object.keys(vt);for(const Gn of Sn){const[Vn,Jn]=vt[Gn],oi=s.X(Jn),ii=s.X(typeof Vn=="string"?[Vn,["accumulated"],["get",Gn]]:Vn);It[Gn]=oi.value,Et[Gn]=ii.value}return Ze.map=Gn=>{_n.properties=Gn;const Vn={};for(const Jn of Sn)Vn[Jn]=It[Jn].evaluate(Kt,_n);return Vn},Ze.reduce=(Gn,Vn)=>{_n.properties=Vn;for(const Jn of Sn)Kt.accumulated=Gn[Jn],Gn[Jn]=Et[Jn].evaluate(Kt,_n)},Ze}(fe)).load(at.features):fe.dynamic?this._dynamicIndex:function(Ze,vt){return new Ri(Ze,vt)}(at,fe.geojsonVtOptions)}catch(Ze){return ve(Ze)}const bt={};if(tt){const Ze=T(Be);Ze&&(bt.resourceTiming={},bt.resourceTiming[fe.source]=JSON.parse(JSON.stringify(Ze)))}ve(null,bt)}})}reloadTile(fe,ve){const Be=this.loaded;return Be&&Be[fe.uid]?fe.partial?ve(null,void 0):super.reloadTile(fe,ve):this.loadTile(fe,ve)}loadGeoJSON(fe,ve){if(fe.request)s.n(fe.request,ve);else{if(typeof fe.data!="string")return ve(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`));try{return ve(null,JSON.parse(fe.data))}catch{return ve(new Error(`Input data given to '${fe.source}' is not a valid GeoJSON object.`))}}}getClusterExpansionZoom(fe,ve){try{ve(null,this._geoJSONIndex.getClusterExpansionZoom(fe.clusterId))}catch(Be){ve(Be)}}getClusterChildren(fe,ve){try{ve(null,this._geoJSONIndex.getChildren(fe.clusterId))}catch(Be){ve(Be)}}getClusterLeaves(fe,ve){try{ve(null,this._geoJSONIndex.getLeaves(fe.clusterId,fe.limit,fe.offset))}catch(Be){ve(Be)}}}class _i{constructor(fe,ve,Be){this.tileID=new s.aM(fe.tileID.overscaledZ,fe.tileID.wrap,fe.tileID.canonical.z,fe.tileID.canonical.x,fe.tileID.canonical.y),this.tileZoom=fe.tileZoom,this.uid=fe.uid,this.zoom=fe.zoom,this.canonical=fe.tileID.canonical,this.pixelRatio=fe.pixelRatio,this.tileSize=fe.tileSize,this.source=fe.source,this.overscaling=this.tileID.overscaleFactor(),this.projection=fe.projection,this.brightness=ve,this.worldview=Be}parse(fe,ve,Be,tt){this.status="parsing";const He=new s.aM(Be.tileID.overscaledZ,Be.tileID.wrap,Be.tileID.canonical.z,Be.tileID.canonical.x,Be.tileID.canonical.y),at=[],bt=ve.familiesBySource[Be.source],Ze=new s.f0(He,Be.promoteId);Ze.bucketLayerIDs=[],Ze.is3DTile=!0,s.fi(fe).then(vt=>{if(!vt)return tt(new Error("Could not parse tile"));const It=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("MAPBOX_mesh_features")||vt.json.asset.extras&&vt.json.asset.extras.MAPBOX_mesh_features,Et=vt.json.extensionsUsed&&vt.json.extensionsUsed.includes("EXT_meshopt_compression"),Kt=new s.aa(this.zoom,{brightness:this.brightness,worldview:this.worldview});for(const _n in bt)for(const Sn of bt[_n]){const Gn=Sn[0];Ze.bucketLayerIDs.push(Sn.map(oi=>s.C(oi.id,oi.scope))),Gn.recalculate(Kt,[]);const Vn=s.fj(vt,1/s.cU(Be.tileID.canonical)),Jn=new s.fk(Sn,Vn,He,It,Et,this.brightness,Ze,this.worldview);It||(Jn.needsUpload=!0),at.push(Jn),Jn.evaluate(Gn)}this.status="done",tt(null,{buckets:at,featureIndex:Ze,collisionBoxArray:null,glyphAtlasImage:null,lineAtlas:null,imageAtlas:null,brightness:null})}).catch(vt=>tt(new Error(vt.message)))}}class Ls{constructor(fe,ve,Be,tt,He,at,bt,Ze){this.actor=fe,this.layerIndex=ve,this.availableImages=Be,this.availableModels=tt,this.brightness=bt,this.loading={},this.loaded={},this.worldview=Ze}loadTile(fe,ve){const Be=fe.uid,tt=this.loading[Be]=new _i(fe,this.brightness,this.worldview);s.br(fe.request,(He,at)=>{const bt=!this.loading[Be];return delete this.loading[Be],bt||He?(tt.status="done",bt||(this.loaded[Be]=tt),ve(He)):at&&at.byteLength!==0?void tt.parse(at,this.layerIndex,fe,(Ze,vt)=>{tt.status="done",this.loaded=this.loaded||{},this.loaded[Be]=tt,Ze||!vt?ve(Ze):ve(null,vt)}):(tt.status="done",this.loaded[Be]=tt,ve())})}reloadTile(fe,ve){const Be=this.loaded,tt=fe.uid;if(Be&&Be[tt]){const He=Be[tt];He.projection=fe.projection,He.brightness=fe.brightness;const at=(bt,Ze)=>{He.reloadCallback&&(delete He.reloadCallback,this.loadTile(fe,ve)),ve(bt,Ze)};He.status==="parsing"?He.reloadCallback=at:He.status==="done"&&this.loadTile(fe,ve)}}abortTile(fe,ve){const Be=fe.uid;this.loading[Be]&&delete this.loading[Be],ve()}removeTile(fe,ve){const Be=this.loaded,tt=fe.uid;Be&&Be[tt]&&delete Be[tt],ve()}}class bi{constructor(fe){this.self=fe,this.actor=new s.fm(fe,this),this.layerIndexes={},this.availableImages={},this.availableModels={},this.isSpriteLoaded={},this.imageRasterizer=new s.y,this.rtlPluginParsingListeners=[],this.projections={},this.defaultProjection=s.ce({name:"mercator"}),this.workerSourceTypes={vector:te,geojson:$r,"raster-dem":ie,"raster-array":Ie,"batched-model":Ls},this.workerSources={},this.self.registerWorkerSource=(ve,Be)=>{if(this.workerSourceTypes[ve])throw new Error(`Worker source with name "${ve}" already registered.`);this.workerSourceTypes[ve]=Be},this.self.registerRTLTextPlugin=ve=>{if(s.fn.isParsed())throw new Error("RTL text plugin already registered.");s.fn.setState({pluginStatus:s.fo.parsed,pluginURL:s.fn.getPluginURL()}),s.fn.applyArabicShaping=ve.applyArabicShaping,s.fn.processBidirectionalText=ve.processBidirectionalText,s.fn.processStyledBidirectionalText=ve.processStyledBidirectionalText;for(const Be of this.rtlPluginParsingListeners)Be(null,!0);this.rtlPluginParsingListeners=[]}}clearCaches(fe,ve,Be){delete this.layerIndexes[fe],delete this.availableImages[fe],delete this.availableModels[fe],delete this.workerSources[fe],Be()}checkIfReady(fe,ve,Be){Be()}setReferrer(fe,ve){this.referrer=ve}spriteLoaded(fe,ve){this.isSpriteLoaded[fe]||(this.isSpriteLoaded[fe]={});const{scope:Be,isLoaded:tt}=ve;if(this.isSpriteLoaded[fe][Be]=tt,this.workerSources[fe]&&this.workerSources[fe][Be])for(const He in this.workerSources[fe][Be]){const at=this.workerSources[fe][Be][He];for(const bt in at){const Ze=at[bt];Ze instanceof te&&(Ze.isSpriteLoaded=tt,Ze.fire(new s.A("isSpriteLoaded")))}}}setImages(fe,ve,Be){this.availableImages[fe]||(this.availableImages[fe]={});const{scope:tt,images:He}=ve;if(this.availableImages[fe][tt]=He,this.workerSources[fe]&&this.workerSources[fe][tt]){for(const at in this.workerSources[fe][tt]){const bt=this.workerSources[fe][tt][at];for(const Ze in bt)bt[Ze].availableImages=He}Be()}else Be()}setModels(fe,{scope:ve,models:Be},tt){if(this.availableModels[fe]||(this.availableModels[fe]={}),this.availableModels[fe][ve]=Be,this.workerSources[fe]&&this.workerSources[fe][ve]){for(const He in this.workerSources[fe][ve]){const at=this.workerSources[fe][ve][He];for(const bt in at)at[bt].availableModels=Be}tt()}else tt()}setProjection(fe,ve){this.projections[fe]=s.ce(ve)}setBrightness(fe,ve,Be){this.brightness=ve,Be()}setWorldview(fe,ve,Be){this.worldview=ve,Be()}setLayers(fe,ve,Be){this.getLayerIndex(fe,ve.scope).replace(ve.layers,ve.options),Be()}updateLayers(fe,ve,Be){this.getLayerIndex(fe,ve.scope).update(ve.layers,ve.removedIds,ve.options),Be()}loadTile(fe,ve,Be){ve.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,ve.type,ve.source,ve.scope).loadTile(ve,Be)}decodeRasterArray(fe,ve,Be){this.getWorkerSource(fe,ve.type,ve.source,ve.scope).decodeRasterArray(ve,Be)}reloadTile(fe,ve,Be){ve.projection=this.projections[fe]||this.defaultProjection,this.getWorkerSource(fe,ve.type,ve.source,ve.scope).reloadTile(ve,Be)}abortTile(fe,ve,Be){this.getWorkerSource(fe,ve.type,ve.source,ve.scope).abortTile(ve,Be)}removeTile(fe,ve,Be){this.getWorkerSource(fe,ve.type,ve.source,ve.scope).removeTile(ve,Be)}removeSource(fe,ve,Be){if(!(this.workerSources[fe]&&this.workerSources[fe][ve.scope]&&this.workerSources[fe][ve.scope][ve.type]&&this.workerSources[fe][ve.scope][ve.type][ve.source]))return;const tt=this.workerSources[fe][ve.scope][ve.type][ve.source];delete this.workerSources[fe][ve.scope][ve.type][ve.source],tt.removeSource!==void 0?tt.removeSource(ve,Be):Be()}loadWorkerSource(fe,ve,Be){try{this.self.importScripts(ve.url),Be()}catch(tt){Be(tt.toString())}}syncRTLPluginState(fe,ve,Be){if(s.fn.isParsed())Be(null,!0);else if(s.fn.isParsing())this.rtlPluginParsingListeners.push(Be);else try{s.fn.setState(ve);const tt=s.fn.getPluginURL();!s.fn.isLoaded()||s.fn.isParsed()||s.fn.isParsing()||tt==null||(s.fn.setState({pluginStatus:s.fo.parsing,pluginURL:s.fn.getPluginURL()}),this.self.importScripts(tt),s.fn.isParsed()?Be(null,!0):this.rtlPluginParsingListeners.push(Be))}catch(tt){Be(tt.toString())}}setDracoUrl(fe,ve){this.dracoUrl=ve}getAvailableImages(fe,ve){this.availableImages[fe]||(this.availableImages[fe]={});let Be=this.availableImages[fe][ve];return Be||(Be=[]),Be}getAvailableModels(fe,ve){this.availableModels[fe]||(this.availableModels[fe]={});let Be=this.availableModels[fe][ve];return Be||(Be={}),Be}getLayerIndex(fe,ve){this.layerIndexes[fe]||(this.layerIndexes[fe]={});let Be=this.layerIndexes[fe][ve];return Be||(Be=this.layerIndexes[fe][ve]=new z,Be.scope=ve),Be}getWorkerSource(fe,ve,Be,tt){const He=this.workerSources;return He[fe]||(He[fe]={}),He[fe][tt]||(He[fe][tt]={}),He[fe][tt][ve]||(He[fe][tt][ve]={}),this.isSpriteLoaded[fe]||(this.isSpriteLoaded[fe]={}),He[fe][tt][ve][Be]||(He[fe][tt][ve][Be]=new this.workerSourceTypes[ve]({send:(at,bt,Ze,vt,It,Et)=>this.actor.send(at,bt,Ze,fe,It,Et),scheduler:this.actor.scheduler},this.getLayerIndex(fe,tt),this.getAvailableImages(fe,tt),this.getAvailableModels(fe,tt),this.isSpriteLoaded[fe][tt],void 0,this.brightness,this.worldview)),He[fe][tt][ve][Be]}rasterizeImagesWorker(fe,ve,Be){const tt=new Map;for(const[He,{image:at,imageVariant:bt}]of ve.tasks.entries()){const Ze=this.imageRasterizer.rasterize(bt,at,ve.scope,fe);tt.set(He,Ze)}Be(void 0,tt)}removeRasterizedImages(fe,ve,Be){this.imageRasterizer.removeImagesFromCacheByIds(ve.imageIds,ve.scope,fe),Be()}enforceCacheSizeLimit(fe,ve){s.fp(ve)}getWorkerPerformanceMetrics(fe,ve,Be){Be(void 0,void 0)}}return s.fl(self)&&(self.worker=new bi(self)),bi}),d(["./shared"],function(s){var T="3.13.0";const D={create:"create",load:"load",fullLoad:"fullLoad"},P={mark(_){performance.mark(_)},measure(_,o,f){performance.measure(_,o,f)}};function z(_){const o=_.name.split("?")[0];return s.a(o)&&o.includes("mapbox-gl.js")?"javascript":s.a(o)&&o.includes("mapbox-gl.css")?"css":s.b(o)?"fontRange":s.c(o)?"sprite":s.i(o)?"style":s.d(o)?"tilejson":"other"}var F,$={},J=function(){if(F)return $;function _(y){return!o(y)}function o(y){return typeof window>"u"||typeof document>"u"?"not a browser":function(){if(!("Worker"in window&&"Blob"in window&&"URL"in window))return!1;var E,C,M=new Blob([""],{type:"text/javascript"}),N=URL.createObjectURL(M);try{C=new Worker(N),E=!0}catch{E=!1}return C&&C.terminate(),URL.revokeObjectURL(N),E}()?function(){var E=document.createElement("canvas");E.width=E.height=1;var C=E.getContext("2d");if(!C)return!1;var M=C.getImageData(0,0,1,1);return M&&M.width===E.width}()?(f[w=y&&y.failIfMajorPerformanceCaveat]===void 0&&(f[w]=function(E){var C,M=function(N){var j=document.createElement("canvas"),H=Object.create(_.webGLContextAttributes);return H.failIfMajorPerformanceCaveat=N,j.getContext("webgl2",H)}(E);if(!M)return!1;try{C=M.createShader(M.VERTEX_SHADER)}catch{return!1}return!(!C||M.isContextLost())&&(M.shaderSource(C,"void main() {}"),M.compileShader(C),M.getShaderParameter(C,M.COMPILE_STATUS)===!0)}(w)),f[w]?document.documentMode?"insufficient ECMAScript 6 support":void 0:"insufficient WebGL2 support"):"insufficient Canvas/getImageData support":"insufficient worker support";var w}F=1,$.supported=_,$.notSupportedReason=o;var f={};return _.webGLContextAttributes={antialias:!1,alpha:!0,stencil:!0,depth:!0},$}();function X(_,o,f){const y=document.createElement(_);return o!=null&&(y.className=o),f&&f.appendChild(y),y}function te(_,o,f){const y=document.createElementNS("http://www.w3.org/2000/svg",_);for(const w of Object.keys(o))y.setAttributeNS(null,w,String(o[w]));return f&&f.appendChild(y),y}const ie=typeof document<"u"?document.documentElement&&document.documentElement.style:null,we=ie&&ie.userSelect!==void 0?"userSelect":"WebkitUserSelect";let Ie;function Re(){ie&&we&&(Ie=ie[we],ie[we]="none")}function Ne(){ie&&we&&(ie[we]=Ie)}function Xe(_){_.preventDefault(),_.stopPropagation(),window.removeEventListener("click",Xe,!0)}function be(){window.addEventListener("click",Xe,!0),window.setTimeout(()=>{window.removeEventListener("click",Xe,!0)},0)}function _e(_,o){const f=_.getBoundingClientRect();return Ee(_,f,o)}function Te(_,o){const f=_.getBoundingClientRect(),y=[];for(let w=0;w<o.length;w++)y.push(Ee(_,f,o[w]));return y}function oe(_){return/firefox/i.test(navigator.userAgent)&&/macintosh/i.test(navigator.userAgent)&&_.button===2&&_.ctrlKey?0:_.button}function Ee(_,o,f){const y=_.offsetWidth===o.width?1:_.offsetWidth/o.width;return new s.P((f.clientX-o.left)*y,(f.clientY-o.top)*y)}const $e="01",ze="NO_ACCESS_TOKEN";class zt{constructor(o,f,y){this._transformRequestFn=o,this._customAccessToken=f,this._silenceAuthErrors=!!y,this._createSkuToken()}_createSkuToken(){const o=function(){let f="";for(let y=0;y<10;y++)f+="0123456789abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ"[Math.floor(62*Math.random())];return{token:["1",$e,f].join(""),tokenExpiresAt:Date.now()+432e5}}();this._skuToken=o.token,this._skuTokenExpiresAt=o.tokenExpiresAt}_isSkuTokenExpired(){return Date.now()>this._skuTokenExpiresAt}transformRequest(o,f){return this._transformRequestFn&&this._transformRequestFn(o,f)||{url:o}}normalizeStyleURL(o,f){if(!s.j(o))return o;const y=mt(o);return y.params.push(`sdk=js-${T}`),y.path=`/styles/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||f)}normalizeGlyphsURL(o,f){if(!s.j(o))return o;const y=mt(o);return y.path=`/fonts/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||f)}normalizeModelURL(o,f){if(!s.j(o))return o;const y=mt(o);return y.path=`/models/v1${y.path}`,this._makeAPIURL(y,this._customAccessToken||f)}normalizeSourceURL(o,f,y,w){if(!s.j(o))return o;const E=mt(o);return E.path=`/v4/${E.authority}.json`,E.params.push("secure"),y&&E.params.push(`language=${y}`),w&&E.params.push(`worldview=${w}`),this._makeAPIURL(E,this._customAccessToken||f)}normalizeIconsetURL(o,f){const y=mt(o);return s.j(o)?(y.path=`/styles/v1${y.path}/iconset.pbf`,this._makeAPIURL(y,this._customAccessToken||f)):Ft(y)}normalizeSpriteURL(o,f,y,w){const E=mt(o);return s.j(o)?(E.path=`/styles/v1${E.path}/sprite${f}${y}`,this._makeAPIURL(E,this._customAccessToken||w)):(E.path+=`${f}${y}`,Ft(E))}normalizeTileURL(o,f,y){if(this._isSkuTokenExpired()&&this._createSkuToken(),o&&!s.j(o))return o;const w=mt(o);w.path=w.path.replace(/(\.(png|jpg)\d*)(?=$)/,`${f||y&&w.authority!=="raster"&&y===512?"@2x":""}${s.l.supported?".webp":"$1"}`),w.authority==="raster"?w.path=`/${s.e.RASTER_URL_PREFIX}${w.path}`:w.authority==="rasterarrays"?w.path=`/${s.e.RASTERARRAYS_URL_PREFIX}${w.path}`:w.authority==="3dtiles"?w.path=`/${s.e.TILES3D_URL_PREFIX}${w.path}`:(w.path=w.path.replace(/^.+\/v4\//,"/"),w.path=`/${s.e.TILE_URL_VERSION}${w.path}`);const E=this._customAccessToken||function(C){for(const M of C){const N=M.match(/^access_token=(.*)$/);if(N)return N[1]}return null}(w.params)||s.e.ACCESS_TOKEN;return s.e.REQUIRE_ACCESS_TOKEN&&E&&this._skuToken&&w.params.push(`sku=${this._skuToken}`),this._makeAPIURL(w,E)}canonicalizeTileURL(o,f){const y=mt(o);if(!y.path.match(/^(\/v4\/|\/(raster|rasterarrays)\/v1\/)/)||!y.path.match(/\.[\w]+$/))return o;let w="mapbox://";y.path.match(/^\/raster\/v1\//)?w+=`raster/${y.path.replace(`/${s.e.RASTER_URL_PREFIX}/`,"")}`:y.path.match(/^\/rasterarrays\/v1\//)?w+=`rasterarrays/${y.path.replace(`/${s.e.RASTERARRAYS_URL_PREFIX}/`,"")}`:w+=`tiles/${y.path.replace(`/${s.e.TILE_URL_VERSION}/`,"")}`;let E=y.params;return f&&(E=E.filter(C=>!C.match(/^access_token=/))),E.length&&(w+=`?${E.join("&")}`),w}canonicalizeTileset(o,f){const y=!!f&&s.j(f),w=[];for(const E of o.tiles||[])s.k(E)?w.push(this.canonicalizeTileURL(E,y)):w.push(E);return w}_makeAPIURL(o,f){const y="See https://docs.mapbox.com/api/overview/#access-tokens-and-token-scopes",w=mt(s.e.API_URL);if(o.protocol=w.protocol,o.authority=w.authority,o.protocol==="http"){const E=o.params.indexOf("secure");E>=0&&o.params.splice(E,1)}if(w.path!=="/"&&(o.path=`${w.path}${o.path}`),!s.e.REQUIRE_ACCESS_TOKEN)return Ft(o);if(f=f||s.e.ACCESS_TOKEN,!this._silenceAuthErrors){if(!f)throw new Error(`An API access token is required to use Mapbox GL. ${y}`);if(f[0]==="s")throw new Error(`Use a public access token (pk.*) with Mapbox GL, not a secret access token (sk.*). ${y}`)}return o.params=o.params.filter(E=>E.indexOf("access_token")===-1),o.params.push(`access_token=${f||""}`),Ft(o)}}const St=/^(\w+):\/\/([^/?]*)(\/[^?]+)?\??(.+)?/;function mt(_){const o=_.match(St);if(!o)throw new Error("Unable to parse URL object");return{protocol:o[1],authority:o[2],path:o[3]||"/",params:o[4]?o[4].split("&"):[]}}function Ft(_){const o=_.params.length?`?${_.params.join("&")}`:"";return`${_.protocol}://${_.authority}${_.path}${o}`}const rn="mapbox.eventData";function Xt(_){if(!_)return null;const o=_.split(".");if(!o||o.length!==3)return null;try{return JSON.parse(s.m(o[1]))}catch{return null}}class Fe{constructor(o){this.type=o,this.anonId=null,this.eventData={},this.queue=[],this.pendingRequest=null}getStorageKey(o){const f=Xt(s.e.ACCESS_TOKEN);let y="";return y=f&&f.u?s.f(f.u):s.e.ACCESS_TOKEN||"",o?`${rn}.${o}:${y}`:`${rn}:${y}`}fetchEventData(){const o=s.s("localStorage"),f=this.getStorageKey(),y=this.getStorageKey("uuid");if(o)try{const w=localStorage.getItem(f);w&&(this.eventData=JSON.parse(w));const E=localStorage.getItem(y);E&&(this.anonId=E)}catch{s.w("Unable to read from LocalStorage")}}saveEventData(){const o=s.s("localStorage"),f=this.getStorageKey(),y=this.getStorageKey("uuid"),w=this.anonId;if(o&&w)try{localStorage.setItem(y,w),Object.keys(this.eventData).length>=1&&localStorage.setItem(f,JSON.stringify(this.eventData))}catch{s.w("Unable to write to LocalStorage")}}processRequests(o){}postEvent(o,f,y,w){if(!s.e.EVENTS_URL)return;const E=mt(s.e.EVENTS_URL);E.params.push(`access_token=${w||s.e.ACCESS_TOKEN||""}`);const C={event:this.type,created:new Date(o).toISOString()},M=f?s.h(C,f):C,N={url:Ft(E),headers:{"Content-Type":"text/plain"},body:JSON.stringify([M])};this.pendingRequest=s.p(N,j=>{this.pendingRequest=null,y(j),this.saveEventData(),this.processRequests(w)})}queueRequest(o,f){this.queue.push(o),this.processRequests(f)}}const Ot=new class extends Fe{constructor(_){super("appUserTurnstile"),this._customAccessToken=_}postTurnstileEvent(_,o){s.e.EVENTS_URL&&s.e.ACCESS_TOKEN&&Array.isArray(_)&&_.some(f=>s.j(f)||s.k(f))&&this.queueRequest(Date.now(),o)}processRequests(_){if(this.pendingRequest||this.queue.length===0)return;this.anonId&&this.eventData.lastSuccess&&this.eventData.tokenU||this.fetchEventData();const o=Xt(s.e.ACCESS_TOKEN),f=o?o.u:s.e.ACCESS_TOKEN;let y=f!==this.eventData.tokenU;s.v(this.anonId)||(this.anonId=s.u(),y=!0);const w=this.queue.shift();if(this.eventData.lastSuccess){const E=new Date(this.eventData.lastSuccess),C=new Date(w),M=(w-this.eventData.lastSuccess)/864e5;y=y||M>=1||M<-1||E.getDate()!==C.getDate()}else y=!0;y?this.postEvent(w,{sdkIdentifier:"mapbox-gl-js",sdkVersion:T,skuId:$e,"enabled.telemetry":!1,userId:this.anonId},E=>{E||(this.eventData.lastSuccess=w,this.eventData.tokenU=f)},_):this.processRequests()}},Ut=Ot.postTurnstileEvent.bind(Ot),ln=new class extends Fe{constructor(){super("map.load"),this.success={},this.skuToken=""}postMapLoadEvent(_,o,f,y){this.skuToken=o,this.errorCb=y,s.e.EVENTS_URL&&(f||s.e.ACCESS_TOKEN?this.queueRequest({id:_,timestamp:Date.now()},f):this.errorCb(new Error(ze)))}processRequests(_){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:f}=this.queue.shift();o&&this.success[o]||(this.anonId||this.fetchEventData(),s.v(this.anonId)||(this.anonId=s.u()),this.postEvent(f,{sdkIdentifier:"mapbox-gl-js",sdkVersion:T,skuId:$e,skuToken:this.skuToken,userId:this.anonId},y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},_))}remove(){this.errorCb=null}},wn=ln.postMapLoadEvent.bind(ln),dn=new class extends Fe{constructor(){super("style.load"),this.eventIdPerMapInstanceMap=new Map,this.mapInstanceIdMap=new WeakMap}getMapInstanceId(_){let o=this.mapInstanceIdMap.get(_);return o||(o=s.u(),this.mapInstanceIdMap.set(_,o)),o}getEventId(_){const o=this.eventIdPerMapInstanceMap.get(_)||0;return this.eventIdPerMapInstanceMap.set(_,o+1),o}postStyleLoadEvent(_,o){const{map:f,style:y,importedStyles:w}=o;if(!s.e.EVENTS_URL||!_&&!s.e.ACCESS_TOKEN)return;const E=this.getMapInstanceId(f),C={mapInstanceId:E,eventId:this.getEventId(E),style:y};w.length&&(C.importedStyles=w),this.queueRequest({timestamp:Date.now(),payload:C},_)}processRequests(_){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,payload:f}=this.queue.shift();this.postEvent(o,f,()=>{},_)}},Ht=dn.postStyleLoadEvent.bind(dn),Mn=new class extends Fe{constructor(){super("gljs.performance")}postPerformanceEvent(_,o){s.e.EVENTS_URL&&(_||s.e.ACCESS_TOKEN)&&this.queueRequest({timestamp:Date.now(),performanceData:o},_)}processRequests(_){if(this.pendingRequest||this.queue.length===0)return;const{timestamp:o,performanceData:f}=this.queue.shift(),y=function(w){const E=performance.getEntriesByType("resource"),C=performance.getEntriesByType("mark"),M=function(Q){const ce={};if(Q){for(const se in Q)if(se!=="other")for(const ue of Q[se]){const pe=`${se}ResolveRangeMin`,ge=`${se}ResolveRangeMax`,Pe=`${se}RequestCount`,Ve=`${se}RequestCachedCount`;ce[pe]=Math.min(ce[pe]||1/0,ue.startTime),ce[ge]=Math.max(ce[ge]||-1/0,ue.responseEnd);const Ye=qe=>{ce[qe]===void 0&&(ce[qe]=0),++ce[qe]};ue.transferSize!==void 0&&ue.transferSize===0&&Ye(Ve),Ye(Pe)}}return ce}(function(Q,ce){const se={};if(Q)for(const ue of Q){const pe=ce(ue);se[pe]===void 0&&(se[pe]=[]),se[pe].push(ue)}return se}(E,z)),N=window.devicePixelRatio,j=navigator.connection||navigator.mozConnection||navigator.webkitConnection,H=j?j.effectiveType:void 0,Z={counters:[],metadata:[],attributes:[]},W=(Q,ce,se)=>{se!=null&&Q.push({name:ce,value:se.toString()})};for(const Q in M)W(Z.counters,Q,M[Q]);if(w.interactionRange[0]!==1/0&&w.interactionRange[1]!==-1/0&&(W(Z.counters,"interactionRangeMin",w.interactionRange[0]),W(Z.counters,"interactionRangeMax",w.interactionRange[1])),C)for(const Q of Object.keys(D)){const ce=D[Q],se=C.find(ue=>ue.name===ce);se&&W(Z.counters,ce,se.startTime)}return W(Z.counters,"visibilityHidden",w.visibilityHidden),W(Z.attributes,"style",function(Q){if(Q)for(const ce of Q){const se=ce.name.split("?")[0];if(s.i(se)){const ue=se.split("/").slice(-2);if(ue.length===2)return`mapbox://styles/${ue[0]}/${ue[1]}`}}}(E)),W(Z.attributes,"terrainEnabled",w.terrainEnabled?"true":"false"),W(Z.attributes,"fogEnabled",w.fogEnabled?"true":"false"),W(Z.attributes,"projection",w.projection),W(Z.attributes,"zoom",w.zoom),W(Z.metadata,"devicePixelRatio",N),W(Z.metadata,"connectionEffectiveType",H),W(Z.metadata,"navigatorUserAgent",navigator.userAgent),W(Z.metadata,"screenWidth",window.screen.width),W(Z.metadata,"screenHeight",window.screen.height),W(Z.metadata,"windowWidth",window.innerWidth),W(Z.metadata,"windowHeight",window.innerHeight),W(Z.metadata,"mapWidth",w.width/N),W(Z.metadata,"mapHeight",w.height/N),W(Z.metadata,"webglRenderer",w.renderer),W(Z.metadata,"webglVendor",w.vendor),W(Z.metadata,"sdkVersion",T),W(Z.metadata,"sdkIdentifier","mapbox-gl-js"),Z}(f);for(const w of y.metadata);for(const w of y.counters);for(const w of y.attributes);this.postEvent(o,y,()=>{},_)}},yn=Mn.postPerformanceEvent.bind(Mn),Tn=new class extends Fe{constructor(){super("map.auth"),this.success={},this.skuToken=""}getSession(_,o,f,y){if(!s.e.API_URL||!s.e.SESSION_PATH)return;const w=mt(s.e.API_URL+s.e.SESSION_PATH);w.params.push(`sku=${o||""}`),w.params.push(`access_token=${y||s.e.ACCESS_TOKEN||""}`);const E={url:Ft(w),headers:{"Content-Type":"text/plain"}};this.pendingRequest=s.g(E,C=>{this.pendingRequest=null,f(C),this.saveEventData(),this.processRequests(y)})}getSessionAPI(_,o,f,y){this.skuToken=o,this.errorCb=y,s.e.SESSION_PATH&&s.e.API_URL&&(f||s.e.ACCESS_TOKEN?this.queueRequest({id:_,timestamp:Date.now()},f):this.errorCb(new Error(ze)))}processRequests(_){if(this.pendingRequest||this.queue.length===0)return;const{id:o,timestamp:f}=this.queue.shift();o&&this.success[o]||this.getSession(f,this.skuToken,y=>{y?this.errorCb(y):o&&(this.success[o]=!0)},_)}remove(){this.errorCb=null}},Cn=Tn.getSessionAPI.bind(Tn),Kn=new Set;function Bt(_,o){o?Kn.add(_):Kn.delete(_)}class ni{constructor(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps=new Set,this._updatedImages={}}isDirty(){return this._changed}setDirty(){this._changed=!0}getUpdatedSourceCaches(){return this._updatedSourceCaches}updateSourceCache(o,f){this._updatedSourceCaches[o]=f,this.setDirty()}discardSourceCacheUpdate(o){delete this._updatedSourceCaches[o]}updateLayer(o){const f=o.scope;this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._updatedLayers[f].add(o.id),this.setDirty()}removeLayer(o){const f=o.scope;this._removedLayers[f]=this._removedLayers[f]||{},this._updatedLayers[f]=this._updatedLayers[f]||new Set,this._removedLayers[f][o.id]=o,this._updatedLayers[f].delete(o.id),this._updatedPaintProps.delete(o.fqid),this.setDirty()}getRemovedLayer(o){return this._removedLayers[o.scope]?this._removedLayers[o.scope][o.id]:null}discardLayerRemoval(o){this._removedLayers[o.scope]&&delete this._removedLayers[o.scope][o.id]}getLayerUpdatesByScope(){const o={};for(const f in this._updatedLayers)o[f]=o[f]||{},o[f].updatedIds=Array.from(this._updatedLayers[f].values());for(const f in this._removedLayers)o[f]=o[f]||{},o[f].removedIds=Object.keys(this._removedLayers[f]);return o}getUpdatedPaintProperties(){return this._updatedPaintProps}updatePaintProperties(o){this._updatedPaintProps.add(o.fqid),this.setDirty()}getUpdatedImages(o){return this._updatedImages[o]?Array.from(this._updatedImages[o].values()):[]}updateImage(o,f){this._updatedImages[f]=this._updatedImages[f]||new Set,this._updatedImages[f].add(s.I.toString(o)),this.setDirty()}resetUpdatedImages(o){this._updatedImages[o]&&this._updatedImages[o].clear()}reset(){this._changed=!1,this._updatedLayers={},this._removedLayers={},this._updatedSourceCaches={},this._updatedPaintProps.clear(),this._updatedImages={}}}function er(_){const{userImage:o}=_;return!!(o&&o.render&&o.render())&&(_.data.replace(new Uint8Array(o.data.buffer)),!0)}class _r extends s.E{constructor(o){super(),this.imageProviders=new Map,this.images=new Map,this.updatedImages=new Map,this.callbackDispatchedThisFrame=new Map,this.loaded=new Map,this.requestors=[],this.patterns=new Map,this.patternsInFlight=new Set,this.atlasImage=new Map,this.atlasTexture=new Map,this.dirty=!0,this.spriteFormat=o,o!=="raster"&&s.t()&&(this.imageRasterizerDispatcher=new s.D(s.x(),this,"Image Rasterizer Worker",1))}addScope(o){this.loaded.set(o,!1),this.imageProviders.set(o,new Map),this.images.set(o,new Map),this.updatedImages.set(o,new Set),this.callbackDispatchedThisFrame.set(o,new Set),this.patterns.set(o,new Map),this.atlasImage.set(o,new s.r({width:1,height:1}))}removeScope(o){this.loaded.delete(o),this.imageProviders.delete(o),this.images.delete(o),this.updatedImages.delete(o),this.callbackDispatchedThisFrame.delete(o),this.patterns.delete(o),this.atlasImage.delete(o);const f=this.atlasTexture.get(o);f&&(f.destroy(),this.atlasTexture.delete(o))}addImageProvider(o,f){this.imageProviders.has(f)||this.imageProviders.set(f,new Map),this.imageProviders.get(f).set(o.id,o)}removeImageProvider(o,f){this.imageProviders.has(f)&&this.imageProviders.get(f).delete(o)}getPendingImageProviders(){const o=[];for(const f of this.imageProviders.values())for(const y of f.values())y.hasPendingRequests()&&o.push(y);return o}get imageRasterizer(){return this._imageRasterizer||(this._imageRasterizer=new s.y),this._imageRasterizer}isLoaded(){for(const o of this.loaded.keys())if(!this.loaded.get(o))return!1;return!0}setLoaded(o,f){if(this.loaded.get(f)!==o&&(this.loaded.set(f,o),o)){for(const{ids:y,callback:w}of this.requestors)this._notify(y,f,w);this.requestors=[]}}hasImage(o,f){return!!this.getImage(o,f)}getImage(o,f){return this.images.get(f).get(o.toString())}addImage(o,f,y){this._validate(o,y)&&this.images.get(f).set(o.toString(),y)}_validate(o,f){let y=!0;return this._validateStretch(f.stretchX,f.data&&f.data.width)||(this.fire(new s.z(new Error(`Image "${o.name}" has invalid "stretchX" value`))),y=!1),this._validateStretch(f.stretchY,f.data&&f.data.height)||(this.fire(new s.z(new Error(`Image "${o.name}" has invalid "stretchY" value`))),y=!1),this._validateContent(f.content,f)||(this.fire(new s.z(new Error(`Image "${o.name}" has invalid "content" value`))),y=!1),y}_validateStretch(o,f){if(!o)return!0;let y=0;for(const w of o){if(w[0]<y||w[1]<w[0]||f<w[1])return!1;y=w[1]}return!0}_validateContent(o,f){return o?o.length!==4||!f.usvg&&(o[0]<0||f.data.width<o[0]||o[1]<0||f.data.height<o[1]||o[2]<0||f.data.width<o[2]||o[3]<0||f.data.height<o[3])?!1:!(o[2]<o[0]||o[3]<o[1]):!0}updateImage(o,f,y){const w=this.images.get(f).get(o.toString());y.version=w.version+1,this.images.get(f).set(o.toString(),y),this.updatedImages.get(f).add(o),this.removeFromImageRasterizerCache(o,f)}clearUpdatedImages(o){this.updatedImages.get(o).clear()}removeFromImageRasterizerCache(o,f){this.spriteFormat!=="raster"&&(s.t()?this.imageRasterizerDispatcher.getActor().send("removeRasterizedImages",{imageIds:[o],scope:f}):this.imageRasterizer.removeImagesFromCacheByIds([o],f))}removeImage(o,f){const y=this.images.get(f),w=y.get(o.toString());y.delete(o.toString()),this.patterns.get(f).delete(o.toString()),this.removeFromImageRasterizerCache(o,f),w.userImage&&w.userImage.onRemove&&w.userImage.onRemove()}listImages(o){return Array.from(this.images.get(o).keys()).map(f=>s.I.from(f))}getImages(o,f,y){const w=[],E=[],C=this.imageProviders.get(f);for(const H of o){if(!H.iconsetId){w.push(H);continue}const Z=C.get(H.iconsetId);Z&&(this.getImage(H,f)?E.push(H):Z.addPendingRequest(H))}if(w.length===0)return void this._notify(E,f,y);let M=!0;const N=!!this.loaded.get(f),j=this.images.get(f);if(!N)for(const H of w)j.has(H.toString())||(M=!1);N||M?this._notify(w,f,y):this.requestors.push({ids:w,scope:f,callback:y})}rasterizeImages(o,f){const y=new Map,{tasks:w,scope:E}=o;for(const[C,M]of w.entries()){const N=this.getImage(M.id,E);N&&y.set(C,{image:N,imageVariant:M})}this._rasterizeImages(E,y,f)}_rasterizeImages(o,f,y){if(s.t())this.imageRasterizerDispatcher.getActor().send("rasterizeImagesWorker",{tasks:f,scope:o},y);else{const w=new Map;for(const[E,{image:C,imageVariant:M}]of f.entries())w.set(E,this.imageRasterizer.rasterize(M,C,o,0));y(void 0,w)}}getUpdatedImages(o){return this.updatedImages.get(o)||new Set}_notify(o,f,y){const w=this.images.get(f),E=new Map;for(const C of o){if(!w.get(C.toString())){if(C.iconsetId)continue;this.fire(new s.A("styleimagemissing",{id:C.name}))}const M=w.get(C.toString());if(!M){s.w(`Image "${C.name}" could not be loaded. Please make sure you have added the image with map.addImage() or a "sprite" property in your style. You can provide missing images by listening for the "styleimagemissing" map event.`);continue}const N={data:M.usvg?null:M.data.clone(),pixelRatio:M.pixelRatio,sdf:M.sdf,usvg:M.usvg,version:M.version,stretchX:M.stretchX,stretchY:M.stretchY,content:M.content,hasRenderCallback:!!(M.userImage&&M.userImage.render)};M.usvg&&Object.assign(N,{width:M.icon.usvg_tree.width,height:M.icon.usvg_tree.height}),E.set(s.I.toString(C),N)}y(null,E)}getPixelSize(o){const{width:f,height:y}=this.atlasImage.get(o);return{width:f,height:y}}getPattern(o,f,y){const w=o.toString(),E=this.patterns.get(f),C=E.get(w),M=this.getImage(o,f);if(!M)return null;if(C){if(C.position.version===M.version)return C.position;C.position.version=M.version}else{if(M.usvg&&!M.data){const N=this.getPatternInFlightId(w,f);if(this.patternsInFlight.has(N))return null;this.patternsInFlight.add(N);const j=new s.B(o).scaleSelf(s.q.devicePixelRatio),H=new Map([[j.toString(),{image:M,imageVariant:j}]]);return this._rasterizeImages(f,H,(Z,W)=>this.storePatternImage(j,f,M,y,W)),null}this.storePattern(o,f,M)}return this._updatePatternAtlas(f,y),E.get(w).position}getPatternInFlightId(o,f){return s.C(o,f)}hasPatternsInFlight(){return this.patternsInFlight.size!==0}storePatternImage(o,f,y,w,E){const C=o.toString(),M=E?E.get(C):void 0;M&&(y.data=M,this.storePattern(o.id,f,y),this._updatePatternAtlas(f,w),this.patternsInFlight.delete(this.getPatternInFlightId(o.id.toString(),f)))}storePattern(o,f,y){const w={w:y.data.width+2*s.F,h:y.data.height+2*s.F,x:0,y:0},E=new s.G(w,y,s.F);this.patterns.get(f).set(o.toString(),{bin:w,position:E})}bind(o,f){const y=o.gl;let w=this.atlasTexture.get(f);w?this.dirty&&(w.update(this.atlasImage.get(f)),this.dirty=!1):(w=new s.T(o,this.atlasImage.get(f),y.RGBA8),this.atlasTexture.set(f,w)),w.bind(y.LINEAR,y.CLAMP_TO_EDGE)}_updatePatternAtlas(o,f){const y=this.patterns.get(o),w=Array.from(y.values()).map(({bin:j})=>j),{w:E,h:C}=s.H(w),M=this.atlasImage.get(o);M.resize({width:E||1,height:C||1});const N=this.images.get(o);for(const[j,{bin:H,position:Z}]of y.entries()){let W=Z.padding;const Q=H.x+W,ce=H.y+W,se=N.get(j).data,ue=se.width,pe=se.height;W=W>1?W-1:W,s.r.copy(se,M,{x:0,y:0},{x:Q,y:ce},{width:ue,height:pe},f),s.r.copy(se,M,{x:0,y:pe-W},{x:Q,y:ce-W},{width:ue,height:W},f),s.r.copy(se,M,{x:0,y:0},{x:Q,y:ce+pe},{width:ue,height:W},f),s.r.copy(se,M,{x:ue-W,y:0},{x:Q-W,y:ce},{width:W,height:pe},f),s.r.copy(se,M,{x:0,y:0},{x:Q+ue,y:ce},{width:W,height:pe},f),s.r.copy(se,M,{x:ue-W,y:pe-W},{x:Q-W,y:ce-W},{width:W,height:W},f),s.r.copy(se,M,{x:0,y:pe-W},{x:Q+ue,y:ce-W},{width:W,height:W},f),s.r.copy(se,M,{x:0,y:0},{x:Q+ue,y:ce+pe},{width:W,height:W},f),s.r.copy(se,M,{x:ue-W,y:0},{x:Q-W,y:ce+pe},{width:W,height:W},f)}this.dirty=!0}beginFrame(){for(const o of this.images.keys())this.callbackDispatchedThisFrame.set(o,new Set)}dispatchRenderCallbacks(o,f){const y=this.images.get(f);for(const w of o){if(this.callbackDispatchedThisFrame.get(f).has(w.toString()))continue;this.callbackDispatchedThisFrame.get(f).add(w.toString());const E=y.get(w.toString());er(E)&&this.updateImage(w,f,E)}}}function Li(_){const o=_.key,f=_.value,y=_.valueSpec||{},w=_.objectElementValidators||{},E=_.style,C=_.styleSpec;let M=[];const N=s.J(f);if(N!=="object")return[new s.V(o,f,`object expected, ${N} found`)];for(const j in f){const H=j.split(".")[0];let Z;w[H]?Z=w[H]:y[H]?Z=xt:w["*"]?Z=w["*"]:y["*"]&&(Z=xt),Z?M=M.concat(Z({key:(o&&`${o}.`)+j,value:f[j],valueSpec:y[H]||y["*"],style:E,styleSpec:C,object:f,objectKey:j},f)):M.push(new s.K(o,f[j],`unknown property "${j}"`))}for(const j in y)w[j]||y[j].required&&y[j].default===void 0&&f[j]===void 0&&M.push(new s.V(o,f,`missing required property "${j}"`));return M}function jr(_){const o=_.value,f=_.valueSpec,y=_.style,w=_.styleSpec,E=_.key,C=_.arrayElementValidator||xt;if(s.J(o)!=="array")return[new s.V(E,o,`array expected, ${s.J(o)} found`)];if(f.length&&o.length!==f.length)return[new s.V(E,o,`array length ${f.length} expected, length ${o.length} found`)];if(f["min-length"]&&o.length<f["min-length"])return[new s.V(E,o,`array length at least ${f["min-length"]} expected, length ${o.length} found`)];let M={type:f.value,values:f.values,minimum:f.minimum,maximum:f.maximum,function:void 0};w.$version<7&&(M.function=f.function),s.J(f.value)==="object"&&(M=f.value);let N=[];for(let j=0;j<o.length;j++)N=N.concat(C({array:o,arrayIndex:j,value:o[j],valueSpec:M,style:y,styleSpec:w,key:`${E}[${j}]`},!0));return N}function ss(_){const o=_.key,f=_.value,y=_.valueSpec;let w=s.J(f);if(w==="number"&&f!=f&&(w="NaN"),w!=="number")return[new s.V(o,f,`number expected, ${w} found`)];if("minimum"in y){let E=y.minimum;if(s.J(y.minimum)==="array"&&(E=y.minimum[_.arrayIndex]),f<E)return[new s.V(o,f,`${f} is less than the minimum value ${E}`)]}if("maximum"in y){let E=y.maximum;if(s.J(y.maximum)==="array"&&(E=y.maximum[_.arrayIndex]),f>E)return[new s.V(o,f,`${f} is greater than the maximum value ${E}`)]}return[]}function Nr(_){const o=_.valueSpec,f=s.M(_.value.type);let y,w,E,C={};const M=f!=="categorical"&&_.value.property===void 0,N=!M,j=s.J(_.value.stops)==="array"&&s.J(_.value.stops[0])==="array"&&s.J(_.value.stops[0][0])==="object",H=Li({key:_.key,value:_.value,valueSpec:_.styleSpec.function,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{stops:function(Q){if(f==="identity")return[new s.V(Q.key,Q.value,'identity function may not have a "stops" property')];let ce=[];const se=Q.value;return ce=ce.concat(jr({key:Q.key,value:se,valueSpec:Q.valueSpec,style:Q.style,styleSpec:Q.styleSpec,arrayElementValidator:Z})),s.J(se)==="array"&&se.length===0&&ce.push(new s.V(Q.key,se,"array must have at least one stop")),ce},default:function(Q){return xt({key:Q.key,value:Q.value,valueSpec:o,style:Q.style,styleSpec:Q.styleSpec})}}});return f==="identity"&&M&&H.push(new s.V(_.key,_.value,'missing required property "property"')),f==="identity"||_.value.stops||H.push(new s.V(_.key,_.value,'missing required property "stops"')),f==="exponential"&&_.valueSpec.expression&&!s.N(_.valueSpec)&&H.push(new s.V(_.key,_.value,"exponential functions not supported")),_.styleSpec.$version>=8&&(N&&!s.O(_.valueSpec)?H.push(new s.V(_.key,_.value,"property functions not supported")):M&&!s.Q(_.valueSpec)&&H.push(new s.V(_.key,_.value,"zoom functions not supported"))),f!=="categorical"&&!j||_.value.property!==void 0||H.push(new s.V(_.key,_.value,'"property" property is required')),H;function Z(Q){let ce=[];const se=Q.value,ue=Q.key;if(s.J(se)!=="array")return[new s.V(ue,se,`array expected, ${s.J(se)} found`)];if(se.length!==2)return[new s.V(ue,se,`array length 2 expected, length ${se.length} found`)];if(j){if(s.J(se[0])!=="object")return[new s.V(ue,se,`object expected, ${s.J(se[0])} found`)];if(se[0].zoom===void 0)return[new s.V(ue,se,"object stop key must have zoom")];if(se[0].value===void 0)return[new s.V(ue,se,"object stop key must have value")];const pe=s.M(se[0].zoom);if(typeof pe!="number")return[new s.V(ue,se[0].zoom,"stop zoom values must be numbers")];if(E&&E>pe)return[new s.V(ue,se[0].zoom,"stop zoom values must appear in ascending order")];pe!==E&&(E=pe,w=void 0,C={}),ce=ce.concat(Li({key:`${ue}[0]`,value:se[0],valueSpec:{zoom:{}},style:Q.style,styleSpec:Q.styleSpec,objectElementValidators:{zoom:ss,value:W}}))}else ce=ce.concat(W({key:`${ue}[0]`,value:se[0],style:Q.style,styleSpec:Q.styleSpec},se));return s.S(s.U(se[1]))?ce.concat([new s.V(`${ue}[1]`,se[1],"expressions are not allowed in function stops.")]):ce.concat(xt({key:`${ue}[1]`,value:se[1],valueSpec:o,style:Q.style,styleSpec:Q.styleSpec}))}function W(Q,ce){const se=s.J(Q.value),ue=s.M(Q.value),pe=Q.value!==null?Q.value:ce;if(y){if(se!==y)return[new s.V(Q.key,pe,`${se} stop domain type must match previous stop domain type ${y}`)]}else y=se;if(se!=="number"&&se!=="string"&&se!=="boolean"&&typeof ue!="number"&&typeof ue!="string"&&typeof ue!="boolean")return[new s.V(Q.key,pe,"stop domain value must be a number, string, or boolean")];if(se!=="number"&&f!=="categorical"){let ge=`number expected, ${se} found`;return s.O(o)&&f===void 0&&(ge+='\nIf you intended to use a categorical function, specify `"type": "categorical"`.'),[new s.V(Q.key,pe,ge)]}return f!=="categorical"||se!=="number"||typeof ue=="number"&&isFinite(ue)&&Math.floor(ue)===ue?f!=="categorical"&&se==="number"&&typeof ue=="number"&&typeof w=="number"&&w!==void 0&&ue<w?[new s.V(Q.key,pe,"stop domain values must appear in ascending order")]:(w=ue,f==="categorical"&&ue in C?[new s.V(Q.key,pe,"stop domain values must be unique")]:(C[ue]=!0,[])):[new s.V(Q.key,pe,`integer expected, found ${String(ue)}`)]}}function ti(_){const o=(_.expressionContext==="property"?s.W:s.X)(s.U(_.value),_.valueSpec);if(o.result==="error")return o.value.map(y=>new s.V(`${_.key}${y.key}`,_.value,y.message));const f=o.value.expression||o.value._styleExpression.expression;if(_.expressionContext==="property"&&_.propertyKey==="text-font"&&!f.outputDefined())return[new s.V(_.key,_.value,`Invalid data expression for "${_.propertyKey}". Output values must be contained as literals within the expression.`)];if(_.expressionContext==="property"&&_.propertyType==="layout"&&!s.Y(f))return[new s.V(_.key,_.value,'"feature-state" data expressions are not supported with layout properties.')];if(_.expressionContext==="filter")return dr(f,_);if(_.expressionContext&&_.expressionContext.indexOf("cluster")===0){if(!s.Z(f,["zoom","feature-state"]))return[new s.V(_.key,_.value,'"zoom" and "feature-state" expressions are not supported with cluster properties.')];if(_.expressionContext==="cluster-initial"&&!s._(f))return[new s.V(_.key,_.value,"Feature data expressions are not supported with initial expression part of cluster properties.")]}return[]}function dr(_,o){const f=new Set(["zoom","feature-state","pitch","distance-from-center"]);if(o.valueSpec&&o.valueSpec.expression)for(const w of o.valueSpec.expression.parameters)f.delete(w);if(f.size===0)return[];const y=[];return _ instanceof s.$&&f.has(_.name)?[new s.V(o.key,o.value,`["${_.name}"] expression is not supported in a filter for a ${o.object.type} layer with id: ${o.object.id}`)]:(_.eachChild(w=>{y.push(...dr(w,o))}),y)}function di(_){const o=_.key,f=_.value,y=_.valueSpec,w=[];return Array.isArray(y.values)?y.values.indexOf(s.M(f))===-1&&w.push(new s.V(o,f,`expected one of [${y.values.join(", ")}], ${JSON.stringify(f)} found`)):Object.keys(y.values).indexOf(s.M(f))===-1&&w.push(new s.V(o,f,`expected one of [${Object.keys(y.values).join(", ")}], ${JSON.stringify(f)} found`)),w}function ks(_){return s.a1(s.U(_.value))?ti(s.L({},_,{expressionContext:"filter",valueSpec:_.styleSpec[`filter_${_.layerType||"fill"}`]})):fs(_)}function fs(_){const o=_.value,f=_.key;if(s.J(o)!=="array")return[new s.V(f,o,`array expected, ${s.J(o)} found`)];const y=_.styleSpec;let w,E=[];if(o.length<1)return[new s.V(f,o,"filter array must have at least 1 element")];switch(E=E.concat(di({key:`${f}[0]`,value:o[0],valueSpec:y.filter_operator,style:_.style,styleSpec:_.styleSpec})),s.M(o[0])){case"<":case"<=":case">":case">=":o.length>=2&&s.M(o[1])==="$type"&&E.push(new s.V(f,o,`"$type" cannot be use with operator "${o[0]}"`));case"==":case"!=":o.length!==3&&E.push(new s.V(f,o,`filter array for operator "${o[0]}" must have 3 elements`));case"in":case"!in":o.length>=2&&(w=s.J(o[1]),w!=="string"&&E.push(new s.V(`${f}[1]`,o[1],`string expected, ${w} found`)));for(let C=2;C<o.length;C++)w=s.J(o[C]),s.M(o[1])==="$type"?E=E.concat(di({key:`${f}[${C}]`,value:o[C],valueSpec:y.geometry_type,style:_.style,styleSpec:_.styleSpec})):w!=="string"&&w!=="number"&&w!=="boolean"&&E.push(new s.V(`${f}[${C}]`,o[C],`string, number, or boolean expected, ${w} found`));break;case"any":case"all":case"none":for(let C=1;C<o.length;C++)E=E.concat(fs({key:`${f}[${C}]`,value:o[C],style:_.style,styleSpec:_.styleSpec}));break;case"has":case"!has":w=s.J(o[1]),o.length!==2?E.push(new s.V(f,o,`filter array for "${o[0]}" operator must have 2 elements`)):w!=="string"&&E.push(new s.V(`${f}[1]`,o[1],`string expected, ${w} found`))}return E}function Uo(_,o){const f=_.key,y=_.style,w=_.layer,E=_.styleSpec,C=_.value,M=_.objectKey,N=E[`${o}_${_.layerType}`];if(!N)return[];const j=M.match(/^(.*)-use-theme$/);if(o==="paint"&&j&&N[j[1]])return s.S(C)?[].concat(xt({key:_.key,value:C,valueSpec:{type:"string",expression:{interpolated:!1,parameters:["zoom","feature"]},"property-type":"data-driven"},style:y,styleSpec:E,expressionContext:"property",propertyType:o,propertyKey:M})):xt({key:f,value:C,valueSpec:{type:"string"},style:y,styleSpec:E});const H=M.match(/^(.*)-transition$/);if(o==="paint"&&H&&N[H[1]]&&N[H[1]].transition)return xt({key:f,value:C,valueSpec:E.transition,style:y,styleSpec:E});const Z=_.valueSpec||N[M];if(!Z)return[new s.K(f,C,`unknown property "${M}"`)];let W;if(s.J(C)==="string"&&s.O(Z)&&!Z.tokens&&(W=/^{([^}]+)}$/.exec(C))){const ce=`\`{ "type": "identity", "property": ${W?JSON.stringify(W[1]):'"_"'} }\``;return[new s.V(f,C,`"${M}" does not support interpolation syntax
Use an identity property function instead: ${ce}.`)]}const Q=[];if(_.layerType==="symbol")M!=="text-field"||!y||y.glyphs||y.imports||Q.push(new s.V(f,C,'use of "text-field" requires a style "glyphs" property')),M==="text-font"&&s.a2(s.U(C))&&s.M(C.type)==="identity"&&Q.push(new s.V(f,C,'"text-font" does not support identity functions'));else if(_.layerType==="model"&&o==="paint"&&w&&w.layout&&w.layout.hasOwnProperty("model-id")&&s.O(Z)&&(s.a3(Z)||s.Q(Z))){const ce=s.W(s.U(C),Z),se=ce.value.expression||ce.value._styleExpression.expression;se&&!s.Z(se,["measure-light"])&&(M==="model-emissive-strength"&&s._(se)&&s.Y(se)||Q.push(new s.V(f,C,`${M} does not support measure-light expressions when the model layer source is vector tile or GeoJSON.`)))}return Q.concat(xt({key:_.key,value:C,valueSpec:Z,style:y,styleSpec:E,expressionContext:"property",propertyType:o,propertyKey:M}))}function Kr(_){return Uo(_,"paint")}function ir(_){return Uo(_,"layout")}function Po(_){let o=[];const f=_.value,y=_.key,w=_.style,E=_.styleSpec;f.type||f.ref||o.push(new s.V(y,f,'either "type" or "ref" is required'));let C=s.M(f.type);const M=s.M(f.ref);if(f.id){const N=s.M(f.id);for(let j=0;j<_.arrayIndex;j++){const H=w.layers[j];s.M(H.id)===N&&o.push(new s.V(y,f.id,`duplicate layer id "${f.id}", previously used at line ${H.id.__line__}`))}}if("ref"in f){let N;["type","source","source-layer","filter","layout"].forEach(j=>{j in f&&o.push(new s.V(y,f[j],`"${j}" is prohibited for ref layers`))}),w.layers.forEach(j=>{s.M(j.id)===M&&(N=j)}),N?N.ref?o.push(new s.V(y,f.ref,"ref cannot reference another ref layer")):C=s.M(N.type):typeof M=="string"&&o.push(new s.V(y,f.ref,`ref layer "${M}" not found`))}else if(C!=="background"&&C!=="sky"&&C!=="slot")if(f.source){const N=w.sources&&w.sources[f.source],j=N&&s.M(N.type);N?j==="vector"&&C==="raster"?o.push(new s.V(y,f.source,`layer "${f.id}" requires a raster source`)):j==="raster"&&C!=="raster"?o.push(new s.V(y,f.source,`layer "${f.id}" requires a vector source`)):j!=="vector"||f["source-layer"]?j==="raster-dem"&&C!=="hillshade"?o.push(new s.V(y,f.source,"raster-dem source can only be used with layer type 'hillshade'.")):j!=="raster-array"||["raster","raster-particle"].includes(C)?C==="line"&&f.paint&&(f.paint["line-gradient"]||f.paint["line-trim-offset"])&&j==="geojson"&&!N.lineMetrics?o.push(new s.V(y,f,`layer "${f.id}" specifies a line-gradient, which requires the GeoJSON source to have \`lineMetrics\` enabled.`)):C==="raster-particle"&&j!=="raster-array"&&o.push(new s.V(y,f.source,`layer "${f.id}" requires a 'raster-array' source.`)):o.push(new s.V(y,f.source,"raster-array source can only be used with layer type 'raster'.")):o.push(new s.V(y,f,`layer "${f.id}" must specify a "source-layer"`)):o.push(new s.V(y,f.source,`source "${f.source}" not found`))}else o.push(new s.V(y,f,'missing required property "source"'));return o=o.concat(Li({key:y,value:f,valueSpec:E.layer,style:_.style,styleSpec:_.styleSpec,objectElementValidators:{"*":()=>[],type:()=>xt({key:`${y}.type`,value:f.type,valueSpec:E.layer.type,style:_.style,styleSpec:_.styleSpec,object:f,objectKey:"type"}),filter:N=>ks(s.L({layerType:C},N)),layout:N=>Li({layer:f,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":j=>ir(s.L({layerType:C},j))}}),paint:N=>Li({layer:f,key:N.key,value:N.value,valueSpec:{},style:N.style,styleSpec:N.styleSpec,objectElementValidators:{"*":j=>Kr(s.L({layerType:C,layer:f},j))}})}})),o}function ro(_){const o=_.value,f=_.key,y=s.J(o);return y!=="string"?[new s.V(f,o,`string expected, ${y} found`)]:[]}const jo={promoteId:function _({key:o,value:f}){if(s.J(f)==="string")return ro({key:o,value:f});if(Array.isArray(f)){const y=[],w=s.U(f),E=s.X(w);return E.result==="error"&&E.value.forEach(C=>{y.push(new s.V(`${o}${C.key}`,null,`${C.message}`))}),s.Z(E.value.expression,["zoom","heatmap-density","line-progress","raster-value","sky-radial-progress","accumulated","is-supported-script","pitch","distance-from-center","measure-light","raster-particle-speed"])||y.push(new s.V(`${o}`,null,"promoteId expression should be only feature dependent")),y}{const y=[];for(const w in f)y.push(..._({key:`${o}.${w}`,value:f[w]}));return y}}};function Or(_){const o=_.value,f=_.key,y=_.styleSpec,w=_.style;if(!o.type)return[new s.V(f,o,'"type" is required')];const E=s.M(o.type);let C=[];switch(["vector","raster","raster-dem","raster-array"].includes(E)&&(o.url||o.tiles||C.push(new s.K(f,o,'Either "url" or "tiles" is required.'))),E){case"vector":case"raster":case"raster-dem":case"raster-array":return C=C.concat(Li({key:f,value:o,valueSpec:y[`source_${E.replace("-","_")}`],style:_.style,styleSpec:y,objectElementValidators:jo})),C;case"geojson":if(C=Li({key:f,value:o,valueSpec:y.source_geojson,style:w,styleSpec:y,objectElementValidators:jo}),o.cluster)for(const M in o.clusterProperties){const[N,j]=o.clusterProperties[M],H=typeof N=="string"?[N,["accumulated"],["get",M]]:N;C.push(...ti({key:`${f}.${M}.map`,value:j,expressionContext:"cluster-map"})),C.push(...ti({key:`${f}.${M}.reduce`,value:H,expressionContext:"cluster-reduce"}))}return C;case"video":return Li({key:f,value:o,valueSpec:y.source_video,style:w,styleSpec:y});case"image":return Li({key:f,value:o,valueSpec:y.source_image,style:w,styleSpec:y});case"canvas":return[new s.V(f,null,"Please use runtime APIs to add canvas sources, rather than including them in stylesheets.","source.canvas")];default:return di({key:`${f}.type`,value:o.type,valueSpec:{values:ps(y)}})}}function ps(_){return _.source.reduce((o,f)=>{const y=_[f];return y.type.type==="enum"&&(o=o.concat(Object.keys(y.type.values))),o},[])}function Ns(_){const o=_.value,f=_.styleSpec,y=f.light,w=_.style;let E=[];const C=s.J(o);if(o===void 0)return E;if(C!=="object")return E=E.concat([new s.V("light",o,`object expected, ${C} found`)]),E;for(const M in o){const N=M.match(/^(.*)-transition$/),j=M.match(/^(.*)-use-theme$/);E=E.concat(j&&y[j[1]]?xt({key:M,value:o[M],valueSpec:{type:"string"},style:w,styleSpec:f}):N&&y[N[1]]&&y[N[1]].transition?xt({key:M,value:o[M],valueSpec:f.transition,style:w,styleSpec:f}):y[M]?xt({key:M,value:o[M],valueSpec:y[M],style:w,styleSpec:f}):[new s.V(M,o[M],`unknown property "${M}"`)])}return E}function Hr(_){const o=_.value;let f=[];if(!o)return f;const y=s.J(o);if(y!=="object")return f=f.concat([new s.V("light-3d",o,`object expected, ${y} found`)]),f;const w=_.styleSpec,E=w["light-3d"],C=_.key,M=_.style,N=_.style.lights;for(const Z of["type","id"])if(!(Z in o))return f=f.concat([new s.V("light-3d",o,`missing property ${Z} on light`)]),f;if(o.type&&N)for(let Z=0;Z<_.arrayIndex;Z++){const W=s.M(o.type),Q=N[Z];s.M(Q.type)===W&&f.push(new s.V(C,o.id,`duplicate light type "${o.type}", previously defined at line ${Q.id.__line__}`))}const j=`properties_light_${o.type}`;if(!(j in w))return f=f.concat([new s.V("light-3d",o,`Invalid light type ${o.type}`)]),f;const H=w[j];for(const Z in o)if(Z==="properties"){const W=o[Z],Q=s.J(W);if(Q!=="object")return f=f.concat([new s.V("properties",W,`object expected, ${Q} found`)]),f;for(const ce in W){const se=ce.match(/^(.*)-transition$/),ue=ce.match(/^(.*)-use-theme$/);f=f.concat(ue&&H[ue[1]]?xt({key:Z,value:W[ce],valueSpec:{type:"string"},style:M,styleSpec:w}):se&&H[se[1]]&&H[se[1]].transition?xt({key:Z,value:o[Z],valueSpec:w.transition,style:M,styleSpec:w}):H[ce]?xt({key:ce,value:W[ce],valueSpec:H[ce],style:M,styleSpec:w}):[new s.K(_.key,W[ce],`unknown property "${ce}"`)])}}else f=f.concat(E[Z]?xt({key:Z,value:o[Z],valueSpec:E[Z],style:M,styleSpec:w}):[new s.K(Z,o[Z],`unknown property "${Z}"`)]);return f}function Xs(_){const o=_.value,f=_.key,y=_.style,w=_.styleSpec,E=w.terrain;let C=[];const M=s.J(o);if(o===void 0||M==="null")return C;if(M!=="object")return C=C.concat([new s.V("terrain",o,`object expected, ${M} found`)]),C;for(const N in o){const j=N.match(/^(.*)-transition$/),H=N.match(/^(.*)-use-theme$/);C=C.concat(H&&E[H[1]]?xt({key:N,value:o[N],valueSpec:{type:"string"},style:y,styleSpec:w}):j&&E[j[1]]&&E[j[1]].transition?xt({key:N,value:o[N],valueSpec:w.transition,style:y,styleSpec:w}):E[N]?xt({key:N,value:o[N],valueSpec:E[N],style:y,styleSpec:w}):[new s.K(N,o[N],`unknown property "${N}"`)])}if(o.source){const N=y.sources&&y.sources[o.source],j=N&&s.M(N.type);N?j!=="raster-dem"&&C.push(new s.V(f,o.source,`terrain cannot be used with a source of type ${String(j)}, it only be used with a "raster-dem" source type`)):C.push(new s.V(f,o.source,`source "${o.source}" not found`))}else C.push(new s.V(f,o,'terrain is missing required property "source"'));return C}function ho(_){const o=_.value,f=_.style,y=_.styleSpec,w=y.fog;let E=[];const C=s.J(o);if(o===void 0)return E;if(C!=="object")return E=E.concat([new s.V("fog",o,`object expected, ${C} found`)]),E;for(const M in o){const N=M.match(/^(.*)-transition$/),j=M.match(/^(.*)-use-theme$/);E=E.concat(j&&w[j[1]]?xt({key:M,value:o[M],valueSpec:{type:"string"},style:f,styleSpec:y}):N&&w[N[1]]&&w[N[1]].transition?xt({key:M,value:o[M],valueSpec:y.transition,style:f,styleSpec:y}):w[M]?xt({key:M,value:o[M],valueSpec:w[M],style:f,styleSpec:y}):[new s.K(M,o[M],`unknown property "${M}"`)])}return E}const Ge={"*":()=>[],array:jr,boolean:function(_){const o=_.value,f=_.key,y=s.J(o);return y!=="boolean"?[new s.V(f,o,`boolean expected, ${y} found`)]:[]},number:ss,color:function(_){const o=_.key,f=_.value,y=s.J(f);return y!=="string"?[new s.V(o,f,`color expected, ${y} found`)]:s.a0.parseCSSColor(f)===null?[new s.V(o,f,`color expected, "${f}" found`)]:[]},enum:di,filter:ks,function:Nr,layer:Po,object:Li,source:Or,model:s.a4,light:Ns,"light-3d":Hr,terrain:Xs,fog:ho,string:ro,formatted:function(_){return ro(_).length===0?[]:ti(_)},resolvedImage:function(_){return ro(_).length===0?[]:ti(_)},projection:function(_){const o=_.value,f=_.styleSpec,y=f.projection,w=_.style;let E=[];const C=s.J(o);if(C==="object")for(const M in o)E=E.concat(xt({key:M,value:o[M],valueSpec:y[M],style:w,styleSpec:f}));else C!=="string"&&(E=E.concat([new s.V("projection",o,`object or string expected, ${C} found`)]));return E},import:function(_){const{value:o,styleSpec:f}=_,{data:y,...w}=o;Object.defineProperty(w,"__line__",{value:o.__line__,enumerable:!1});let E=Li(s.L({},_,{value:w,valueSpec:f.import}));return s.M(w.id)===""&&E.push(new s.V(`${_.key}.id`,w,"import id can't be an empty string")),y&&(E=E.concat(jn(y,f,{key:`${_.key}.data`}))),E},iconset:function(_){const o=_.value,f=_.key,y=_.styleSpec,w=_.style;if(!o.type)return[new s.V(f,o,'"type" is required')];const E=s.M(o.type);let C=[];if(C=C.concat(Li({key:f,value:o,valueSpec:y[`iconset_${E}`],style:w,styleSpec:y})),E==="source"&&o.source){const M=w.sources&&w.sources[o.source],N=M&&s.M(M.type);M?N!=="raster-array"&&C.push(new s.V(f,o.source,`iconset cannot be used with a source of type ${String(N)}, it only be used with a "raster-array" source type`)):C.push(new s.V(f,o.source,`source "${o.source}" not found`))}return C}};function xt(_,o=!1){const f=_.value,y=_.valueSpec,w=_.styleSpec;if(y.expression&&s.a2(s.M(f)))return Nr(_);if(y.expression&&s.S(s.U(f)))return ti(_);if(y.type&&Ge[y.type]){const E=Ge[y.type](_);return o===!0&&E.length>0&&s.J(_.value)==="array"?ti(_):E}return Li(s.L({},_,{valueSpec:y.type?w[y.type]:y}))}function Pn(_){const o=_.value,f=_.key,y=ro(_);return y.length||(o.indexOf("{fontstack}")===-1&&y.push(new s.V(f,o,'"glyphs" url must include a "{fontstack}" token')),o.indexOf("{range}")===-1&&y.push(new s.V(f,o,'"glyphs" url must include a "{range}" token'))),y}function jn(_,o=s.a5,f={}){return xt({key:f.key||"",value:_,valueSpec:o.$root,styleSpec:o,style:_,objectElementValidators:{glyphs:Pn,"*":()=>[]}})}function Wn(_,o=s.a5){return tt(jn(_,o))}const zi=_=>tt(Or(_)),Ri=_=>tt(Ns(_)),Ii=_=>tt(Hr(_)),Lt=_=>tt(Xs(_)),$r=_=>tt(ho(_)),_i=_=>tt(function(o){const f=o.value,y=o.style,w=o.styleSpec,E=w.snow;let C=[];const M=s.J(f);if(f===void 0)return C;if(M!=="object")return C=C.concat([new s.V("snow",f,`object expected, ${M} found`)]),C;for(const N in f){const j=N.match(/^(.*)-transition$/);C=C.concat(j&&E[j[1]]&&E[j[1]].transition?xt({key:N,value:f[N],valueSpec:w.transition,style:y,styleSpec:w}):E[N]?xt({key:N,value:f[N],valueSpec:E[N],style:y,styleSpec:w}):[new s.K(N,f[N],`unknown property "${N}"`)])}return C}(_)),Ls=_=>tt(function(o){const f=o.value,y=o.style,w=o.styleSpec,E=w.rain;let C=[];const M=s.J(f);if(f===void 0)return C;if(M!=="object")return C=C.concat([new s.V("rain",f,`object expected, ${M} found`)]),C;for(const N in f){const j=N.match(/^(.*)-transition$/);C=C.concat(j&&E[j[1]]&&E[j[1]].transition?xt({key:N,value:f[N],valueSpec:w.transition,style:y,styleSpec:w}):E[N]?xt({key:N,value:f[N],valueSpec:E[N],style:y,styleSpec:w}):[new s.K(N,f[N],`unknown property "${N}"`)])}return C}(_)),bi=_=>tt(Po(_)),gt=_=>tt(ks(_)),fe=_=>tt(Kr(_)),ve=_=>tt(ir(_)),Be=_=>tt(s.a4(_));function tt(_){return _.slice().sort((o,f)=>o.line&&f.line?o.line-f.line:0)}function He(_,o){let f=!1;if(o&&o.length)for(const y of o)y instanceof s.K?s.w(y.message):(_.fire(new s.z(new Error(y.message))),f=!0);return f}let at;class bt extends s.E{constructor(o,f="flat"){super(),this._transitionable=new s.a6(at||(at=new s.a7({anchor:new s.a8(s.a5.light.anchor),position:new s.a9(s.a5.light.position),color:new s.a8(s.a5.light.color),intensity:new s.a8(s.a5.light.intensity)}))),this.setLight(o,f),this._transitioning=this._transitionable.untransitioned()}getLight(){return this._transitionable.serialize()}setLight(o,f,y={}){this._validate(Ri,o,y)||(this._transitionable.setTransitionOrValue(o),this.id=f)}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,y){return(!y||y.validate!==!1)&&He(this,o.call(Wn,s.h({value:f,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let Ze=class extends s.E{constructor(_,o,f,y,w){super(),this.scope=f,this._transitionable=new s.a6(new s.a7({source:new s.a8(s.a5.terrain.source),exaggeration:new s.a8(s.a5.terrain.exaggeration)}),f,y),this._transitionable.setTransitionOrValue(_,y),this._transitioning=this._transitionable.untransitioned(),this.drapeRenderMode=o,this.worldview=w}get(){return this._transitionable.serialize()}set(_,o){this._transitionable.setTransitionOrValue(_,o)}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}getExaggeration(_){return this._transitioning.possiblyEvaluate(new s.aa(_,{worldview:this.worldview})).get("exaggeration")}getAttenuationRange(){if(!this.isZoomDependent())return null;const _=this._transitionable._values.exaggeration;if(!_)return null;const o=_.value.expression;if(!o)return null;let f=-1,y=-1,w=1;for(const E of o.zoomStops)w=o.evaluate(new s.aa(E,{worldview:this.worldview})),w>.01?(f=E,y=-1):y=E;return w<.01&&f>0&&y>f?[f,y]:null}isZoomDependent(){const _=this._transitionable._values.exaggeration;return _!=null&&_.value!=null&&_.value.expression!=null&&_.value.expression instanceof s.ab}};const vt=45,It=65,Et=.05;function Kt(_,o,f,y){const w=s.af(vt,It,f),[E,C]=_n(_,y);let M=1-Math.min(1,Math.exp((o-E)/(C-E)*-6));return M*=M*M,M=Math.min(1,1.00747*M),M*w*_.alpha}function _n(_,o){const f=.5/Math.tan(.5*o);return[_.range[0]+f,_.range[1]+f]}function Sn(_,o,f,y,w){const E=s.ad([],[o,f,y],w.mercatorFogMatrix);return Kt(_,s.ae(E),w.pitch,w._fov)}function Gn(_,o,f,y,w,E,C){const M=[[f,y,0],[w,y,0],[w,E,0],[f,E,0]];let N=Number.MAX_VALUE,j=-Number.MAX_VALUE;for(const H of M){const Z=s.ad([],H,o),W=s.ae(Z);N=Math.min(N,W),j=Math.max(j,W)}return[Kt(_,N,C.pitch,C._fov),Kt(_,j,C.pitch,C._fov)]}class Vn extends s.E{constructor(o,f,y,w){super();const E=new s.a7({range:new s.a8(s.a5.fog.range),color:new s.a8(s.a5.fog.color),"color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"high-color":new s.a8(s.a5.fog["high-color"]),"high-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"space-color":new s.a8(s.a5.fog["space-color"]),"space-color-use-theme":new s.a8({type:"string","property-type":"data-constant",default:"default"}),"horizon-blend":new s.a8(s.a5.fog["horizon-blend"]),"star-intensity":new s.a8(s.a5.fog["star-intensity"]),"vertical-range":new s.a8(s.a5.fog["vertical-range"])});this._transitionable=new s.a6(E,y,new Map(w)),this.set(o,w),this._transitioning=this._transitionable.untransitioned(),this._transform=f,this.properties=new s.ag(E),this.scope=y}get state(){const o=this._transform,f=o.projection.name==="globe",y=s.ah(o.zoom),w=this.properties.get("range"),E=[.5,3];return{range:f?[s.ai(E[0],w[0],y),s.ai(E[1],w[1],y)]:w,horizonBlend:this.properties.get("horizon-blend"),alpha:this.properties.get("color").a}}get(){return this._transitionable.serialize()}set(o,f,y={}){if(this._validate($r,o,y))return;const w=s.h({},o);for(const E of Object.keys(s.a5.fog))w[E]===void 0&&(w[E]=s.a5.fog[E].default);this._options=w,this._transitionable.setTransitionOrValue(this._options,f)}getOpacity(o){if(!this._transform.projection.supportsFog)return 0;const f=this.properties&&this.properties.get("color")||1;return(this._transform.projection.name==="globe"?1:s.af(vt,It,o))*f.a}getOpacityAtLatLng(o,f){return this._transform.projection.supportsFog?function(y,w,E){const C=s.ac.fromLngLat(w),M=E.elevation?E.elevation.getAtPointOrZero(C):0;return Sn(y,C.x,C.y,M,E)}(this.state,o,f):0}getOpacityForTile(o){if(!this._transform.projection.supportsFog)return[1,1];const f=this._transform.calculateFogTileMatrix(o.toUnwrapped());return Gn(this.state,f,0,0,s.aj,s.aj,this._transform)}getOpacityForBounds(o,f,y,w,E){return this._transform.projection.supportsFog?Gn(this.state,o,f,y,w,E,this._transform):[1,1]}getFovAdjustedRange(o){return this._transform.projection.supportsFog?_n(this.state,o):[0,1]}isVisibleOnFrustum(o){if(!this._transform.projection.supportsFog)return!1;const f=[4,5,6,7];for(const y of f){const w=o.points[y];let E;if(w[2]>=0)E=w;else{const C=o.points[y-4];E=s.ak(C,w,C[2]/(C[2]-w[2]))}if(Sn(this.state,E[0],E[1],0,this._transform)>=Et)return!0}return!1}updateConfig(o){this._transitionable.setTransitionOrValue(this._options,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}_validate(o,f,y){return(!y||y.validate!==!1)&&He(this,o.call(Wn,s.h({value:f,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}}let Jn,oi,ii,Xi,tr=class extends s.E{constructor(_,o,f,y){super();const w=Jn||(Jn=new s.a7({density:new s.a8(s.a5.snow.density),intensity:new s.a8(s.a5.snow.intensity),color:new s.a8(s.a5.snow.color),opacity:new s.a8(s.a5.snow.opacity),vignette:new s.a8(s.a5.snow.vignette),"vignette-color":new s.a8(s.a5.snow["vignette-color"]),"center-thinning":new s.a8(s.a5.snow["center-thinning"]),direction:new s.a8(s.a5.snow.direction),"flake-size":new s.a8(s.a5.snow["flake-size"])}));this._transitionable=new s.a6(w,f,new Map(y)),this.set(_,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ag(w),this.scope=f}get state(){const _=this.properties.get("opacity"),o=this.properties.get("color"),f=this.properties.get("direction"),y=s.al(f[0]),w=-Math.max(s.al(f[1]),.01),E=[Math.cos(y)*Math.cos(w),Math.sin(y)*Math.cos(w),Math.sin(w)],C=this.properties.get("vignette"),M=this.properties.get("vignette-color");return M.a=C,{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.am(o.r,o.g,o.b,o.a*_),direction:E,centerThinning:this.properties.get("center-thinning"),flakeSize:this.properties.get("flake-size"),vignetteColor:M}}get(){return this._transitionable.serialize()}set(_,o,f={}){if(this._validate(_i,_,f))return;const y=s.h({},_);for(const w of Object.keys(s.a5.snow))y[w]===void 0&&(y[w]=s.a5.snow[w].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(_){this._transitionable.setTransitionOrValue(this._options,new Map(_))}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}_validate(_,o,f){return(!f||f.validate!==!1)&&He(this,_.call(Wn,s.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}},cr=class extends s.E{constructor(_,o,f,y){super();const w=oi||(oi=new s.a7({density:new s.a8(s.a5.rain.density),intensity:new s.a8(s.a5.rain.intensity),color:new s.a8(s.a5.rain.color),opacity:new s.a8(s.a5.rain.opacity),vignette:new s.a8(s.a5.rain.vignette),"vignette-color":new s.a8(s.a5.rain["vignette-color"]),"center-thinning":new s.a8(s.a5.rain["center-thinning"]),direction:new s.a8(s.a5.rain.direction),"droplet-size":new s.a8(s.a5.rain["droplet-size"]),"distortion-strength":new s.a8(s.a5.rain["distortion-strength"])}));this._transitionable=new s.a6(w,f,new Map(y)),this.set(_,y),this._transitioning=this._transitionable.untransitioned(),this.properties=new s.ag(w),this.scope=f}get state(){const _=this.properties.get("opacity"),o=this.properties.get("color"),f=this.properties.get("direction"),y=s.al(f[0]),w=-Math.max(s.al(f[1]),.01),E=[Math.cos(y)*Math.cos(w),Math.sin(y)*Math.cos(w),Math.sin(w)],C=this.properties.get("vignette-color");return C.a=this.properties.get("vignette"),{density:this.properties.get("density"),intensity:this.properties.get("intensity"),color:new s.am(o.r,o.g,o.b,o.a*_),direction:E,centerThinning:this.properties.get("center-thinning"),dropletSize:this.properties.get("droplet-size"),distortionStrength:this.properties.get("distortion-strength"),vignetteColor:C}}get(){return this._transitionable.serialize()}set(_,o,f={}){if(this._validate(Ls,_,f))return;const y=s.h({},_);for(const w of Object.keys(s.a5.rain))y[w]===void 0&&(y[w]=s.a5.rain[w].default);this._options=y,this._transitionable.setTransitionOrValue(this._options,o)}updateConfig(_){this._transitionable.setTransitionOrValue(this._options,new Map(_))}updateTransitions(_){this._transitioning=this._transitionable.transitioned(_,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(_){this.properties=this._transitioning.possiblyEvaluate(_)}_validate(_,o,f){return(!f||f.validate!==!1)&&He(this,_.call(Wn,s.h({value:o,style:{glyphs:!0,sprite:!0},styleSpec:s.a5})))}};class Ai extends s.E{constructor(o,f,y,w){super(),this.scope=y,this._options=o,this.properties=new s.ag(f),this._transitionable=new s.a6(f,y,new Map(w)),this._transitionable.setTransitionOrValue(o.properties),this._transitioning=this._transitionable.untransitioned()}updateConfig(o){this._transitionable.setTransitionOrValue(this._options.properties,new Map(o))}updateTransitions(o){this._transitioning=this._transitionable.transitioned(o,this._transitioning)}hasTransition(){return this._transitioning.hasTransition()}recalculate(o){this.properties=this._transitioning.possiblyEvaluate(o)}get(){return this._options.properties=this._transitionable.serialize(),this._options}set(o,f){this._options=o,this._transitionable.setTransitionOrValue(o.properties,f)}shadowsEnabled(){return!!this.properties&&this.properties.get("cast-shadows")===!0}}class Ei{constructor(o,f,y,w){this.screenBounds=o,this.cameraPoint=f,this._screenRaycastCache={},this._cameraRaycastCache={},this.isAboveHorizon=y,this.screenGeometry=this.bufferedScreenGeometry(0),this.screenGeometryMercator=this._bufferedScreenMercator(0,w)}static createFromScreenPoints(o,f){let y,w;if(o instanceof s.P||typeof o[0]=="number"){const E=s.P.convert(o);y=[E],w=f.isPointAboveHorizon(E)}else{const E=s.P.convert(o[0]),C=s.P.convert(o[1]),M=E.add(C)._div(2);y=[E,C],w=s.ao(E,C).every(N=>f.isPointAboveHorizon(N))&&f.isPointAboveHorizon(M)}return new Ei(y,f.getCameraPoint(),w,f)}isPointQuery(){return this.screenBounds.length===1}bufferedScreenGeometry(o){return s.ao(this.screenBounds[0],this.screenBounds.length===1?this.screenBounds[0]:this.screenBounds[1],o)}bufferedCameraGeometry(o){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],w=s.ao(f,y,0,!1);return this.cameraPoint.y>y.y&&(this.cameraPoint.x>f.x&&this.cameraPoint.x<y.x?w.splice(3,0,this.cameraPoint):this.cameraPoint.x>=y.x?w[2]=this.cameraPoint:this.cameraPoint.x<=f.x&&(w[3]=this.cameraPoint)),s.ap(w,o)}bufferedCameraGeometryGlobe(o){const f=this.screenBounds[0],y=this.screenBounds.length===1?this.screenBounds[0].add(new s.P(1,1)):this.screenBounds[1],w=s.ao(f,y,o),E=this.cameraPoint.clone();switch(3*((E.y>f.y)+(E.y>y.y))+((E.x>f.x)+(E.x>y.x))){case 0:w[0]=E,w[4]=E.clone();break;case 1:w.splice(1,0,E);break;case 2:w[1]=E;break;case 3:w.splice(4,0,E);break;case 5:w.splice(2,0,E);break;case 6:w[3]=E;break;case 7:w.splice(3,0,E);break;case 8:w[2]=E}return w}containsTile(o,f,y,w=0){const E=o.queryPadding/f._pixelsPerMercatorPixel+1,C=y?this._bufferedCameraMercator(E,f):this._bufferedScreenMercator(E,f);let M=o.tileID.wrap+(C.unwrapped?w:0);const N=C.polygon.map(ue=>s.aq(o.tileTransform,ue,M));if(!s.ar(N,0,0,s.aj,s.aj))return;M=o.tileID.wrap+(this.screenGeometryMercator.unwrapped?w:0);const j=this.screenGeometryMercator.polygon.map(ue=>s.as(o.tileTransform,ue,M)),H=j.map(ue=>new s.P(ue[0],ue[1])),Z=f.getFreeCameraOptions().position||new s.ac(0,0,0),W=s.as(o.tileTransform,Z,M),Q=j.map(ue=>{const pe=s.at(ue,ue,W);return s.au(pe,pe),new s.av(W,pe)}),ce=s.aw(o,1,f.zoom)*f._pixelsPerMercatorPixel;return{queryGeometry:this,tilespaceGeometry:H,tilespaceRays:Q,bufferedTilespaceGeometry:N,bufferedTilespaceBounds:(se=s.ax(N),se.min.x=s.ay(se.min.x,0,s.aj),se.min.y=s.ay(se.min.y,0,s.aj),se.max.x=s.ay(se.max.x,0,s.aj),se.max.y=s.ay(se.max.y,0,s.aj),se),tile:o,tileID:o.tileID,pixelToTileUnitsFactor:ce};var se}_bufferedScreenMercator(o,f){const y=Ir(o);if(this._screenRaycastCache[y])return this._screenRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedScreenGeometry(o),f):{polygon:this.bufferedScreenGeometry(o).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._screenRaycastCache[y]=w,w}}_bufferedCameraMercator(o,f){const y=Ir(o);if(this._cameraRaycastCache[y])return this._cameraRaycastCache[y];{let w;return w=f.projection.name==="globe"?this._projectAndResample(this.bufferedCameraGeometryGlobe(o),f):{polygon:this.bufferedCameraGeometry(o).map(E=>f.pointCoordinate3D(E)),unwrapped:!0},this._cameraRaycastCache[y]=w,w}}_projectAndResample(o,f){const y=function(E,C){const M=s.az([],C.pixelMatrix,C.globeMatrix),N=[0,-s.aB,0,1],j=[0,s.aB,0,1],H=[0,0,0,1];s.aA(N,N,M),s.aA(j,j,M),s.aA(H,H,M);const Z=new s.P(N[0]/N[3],N[1]/N[3]),W=new s.P(j[0]/j[3],j[1]/j[3]),Q=s.aC(E,Z)&&N[3]<H[3],ce=s.aC(E,W)&&j[3]<H[3];if(!Q&&!ce)return null;const se=function(je,Ue,We){for(let et=1;et<je.length;et++){const _t=xr(Ue.pointCoordinate3D(je[et-1]).x),ft=xr(Ue.pointCoordinate3D(je[et]).x);if(We<0){if(_t<ft)return{idx:et,t:-_t/(ft-1-_t)}}else if(ft<_t)return{idx:et,t:(1-_t)/(ft+1-_t)}}return null}(E,C,Q?-1:1);if(!se)return null;const{idx:ue,t:pe}=se;let ge=ue>1?fr(E.slice(0,ue),C):[],Pe=ue<E.length?fr(E.slice(ue),C):[];ge=ge.map(je=>new s.P(xr(je.x),je.y)),Pe=Pe.map(je=>new s.P(xr(je.x),je.y));const Ve=[...ge];Ve.length===0&&Ve.push(Pe[Pe.length-1]);const Ye=s.ai(Ve[Ve.length-1].y,(Pe.length===0?ge[0]:Pe[0]).y,pe);let qe;return qe=Q?[new s.P(0,Ye),new s.P(0,0),new s.P(1,0),new s.P(1,Ye)]:[new s.P(1,Ye),new s.P(1,1),new s.P(0,1),new s.P(0,Ye)],Ve.push(...qe),Pe.length===0?Ve.push(ge[0]):Ve.push(...Pe),{polygon:Ve.map(je=>new s.ac(je.x,je.y)),unwrapped:!1}}(o,f);if(y)return y;const w=function(E,C){let M=!1,N=-1/0,j=0;for(let Z=0;Z<E.length-1;Z++)E[Z].x>N&&(N=E[Z].x,j=Z);for(let Z=0;Z<E.length-1;Z++){const W=(j+Z)%(E.length-1),Q=E[W],ce=E[W+1];Math.abs(Q.x-ce.x)>.5&&(Q.x<ce.x?(Q.x+=1,W===0&&(E[E.length-1].x+=1)):(ce.x+=1,W+1===E.length-1&&(E[0].x+=1)),M=!0)}const H=s.aD(C.center.lng);return M&&H<Math.abs(H-1)&&E.forEach(Z=>{Z.x-=1}),{polygon:E,unwrapped:M}}(fr(o,f).map(E=>new s.P(xr(E.x),E.y)),f);return{polygon:w.polygon.map(E=>new s.ac(E.x,E.y)),unwrapped:w.unwrapped}}}function fr(_,o){return s.aE(_,f=>{const y=o.pointCoordinate3D(f);f.x=y.x,f.y=y.y},1/256)}function xr(_){return _<0?1+_%1:_%1}function Ir(_){return 100*_|0}function qs(_,o,f,y,w){const E=function(M,N){if(M)return w(M);if(N){if(_.url&&N.tiles&&_.tiles&&delete _.tiles,N.variants){if(!Array.isArray(N.variants))return w(new Error("variants must be an array"));for(const H of N.variants){if(H==null||typeof H!="object"||H.constructor!==Object)return w(new Error("variant must be an object"));if(!Array.isArray(H.capabilities))return w(new Error("capabilities must be an array"));if(H.capabilities.length===1&&H.capabilities[0]==="meshopt"){N=s.h(N,H);break}}}const j=s.aF(s.h({},N,_),["tilejson","tiles","minzoom","maxzoom","attribution","mapbox_logo","bounds","extra_bounds","scheme","tileSize","encoding","vector_layers","raster_layers","worldview_options","worldview_default","worldview"]);j.tiles=o.canonicalizeTileset(j,_.url),w(null,j)}},C=function(M,N,j){if(!M)return null;if(!N&&!j)return M;j=j||M.worldview_default;const H=Object.values(M.language||{});if(H.length===0)return null;const Z=Object.values(M.worldview||{});if(Z.length===0)return null;const W=H.every(ce=>ce===N),Q=Z.every(ce=>ce===j);return W&&Q?M:N in(M.language_options||{})||j in(M.worldview_options||{})?null:M.language_options&&M.worldview_options?M:null}(_.data,f,y);return C?s.q.frame(()=>E(null,C)):_.url?s.n(o.transformRequest(o.normalizeSourceURL(_.url,null,f,y),s.R.Source),E):s.q.frame(()=>{const{data:M,...N}=_;E(null,N)})}function os(_,o){const f=Math.pow(2,o.z),y=Math.floor(s.aD(_.getWest())*f),w=Math.floor(s.aH(_.getNorth())*f),E=Math.ceil(s.aD(_.getEast())*f),C=Math.ceil(s.aH(_.getSouth())*f);return o.x>=y&&o.x<E&&o.y>=w&&o.y<C}class zs{constructor(o,f,y){this.bounds=o?s.aG.convert(this.validateBounds(o)):null,this.minzoom=f||0,this.maxzoom=y||24}validateBounds(o){return Array.isArray(o)&&o.length===4?[Math.max(-180,o[0]),Math.max(-90,o[1]),Math.min(180,o[2]),Math.min(90,o[3])]:[-180,-90,180,90]}addExtraBounds(o){if(o){this.extraBounds||(this.extraBounds=[]);for(const f of o)this.extraBounds.push(s.aG.convert(this.validateBounds(f)))}}contains(o){if(o.z>this.maxzoom||o.z<this.minzoom||this.bounds&&!os(this.bounds,o))return!1;if(!this.extraBounds)return!0;for(const f of this.extraBounds)if(os(f,o))return!0;return!1}static fromTileJSON(o){if(!o.bounds&&!o.extra_bounds)return null;const f=new zs(o.bounds,o.minzoom,o.maxzoom);return f.addExtraBounds(o.extra_bounds),f}}class Ua extends s.E{constructor(o,f,y,w){if(super(),this.id=o,this.dispatcher=y,this.type="vector",this.minzoom=0,this.maxzoom=22,this.scheme="xyz",this.tileSize=512,this.reparseOverscaled=!0,this.isTileClipped=!0,this._loaded=!1,s.h(this,s.aF(f,["url","scheme","tileSize","promoteId"])),this._options=s.h({type:"vector"},f),this._collectResourceTiming=!!f.collectResourceTiming,this.tileSize!==512)throw new Error("vector tile sources must have a tileSize of 512");this.setEventedParent(w),this._tileWorkers={},this._deduped=new s.aI}load(o){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const f=Array.isArray(this.map._language)?this.map._language.join():this.map._language,y=this.map.getWorldview();this._tileJSONRequest=qs(this._options,this.map._requestManager,f,y,(w,E)=>{if(this._tileJSONRequest=null,this._loaded=!0,w)f&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${f}`),y&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${y}`),this.fire(new s.z(w));else if(E){if(s.h(this,E),this.hasWorldviews=!!E.worldview_options,E.worldview_default&&(this.worldviewDefault=E.worldview_default),E.vector_layers){this.vectorLayers=E.vector_layers,this.vectorLayerIds=[],this.localizableLayerIds=new Set;for(const C of E.vector_layers)this.vectorLayerIds.push(C.id),E.worldview&&E.worldview[C.source]&&this.localizableLayerIds.add(C.id)}this.tileBounds=zs.fromTileJSON(E),Ut(E.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}o&&o(w)})}loaded(){return this._loaded}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return s.h({},this._options)}loadTile(o,f){const y=o.tileID.canonical.url(this.tiles,this.scheme),w=this.map._requestManager.normalizeTileURL(y),E=this.map._requestManager.transformRequest(w,s.R.Tile),C=this.map.style?this.map.style.getLut(this.scope):null,M=C?{image:C.image.clone()}:null,N={request:E,data:void 0,uid:o.uid,tileID:o.tileID,tileZoom:o.tileZoom,zoom:o.tileID.overscaledZ,maxZoom:this.maxzoom,lut:M,tileSize:this.tileSize*o.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,isSymbolTile:o.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:o.isExtraShadowCaster,tessellationStep:this.map._tessellationStep,scaleFactor:this.map.getScaleFactor(),worldview:this.map.getWorldview()||this.worldviewDefault};if(this.hasWorldviews&&s.j(y)&&(N.localizableLayerIds=this.localizableLayerIds),N.request.collectResourceTiming=this._collectResourceTiming,o.actor&&o.state!=="expired")o.state==="loading"?o.reloadCallback=f:o.request=o.actor.send("reloadTile",N,j.bind(this));else if(o.actor=this._tileWorkers[w]=this._tileWorkers[w]||this.dispatcher.getActor(),this.dispatcher.ready)o.request=o.actor.send("loadTile",N,j.bind(this),void 0,!0);else{const H=s.aJ.call({deduped:this._deduped},N,(Z,W)=>{Z||!W?j.call(this,Z):(N.data={cacheControl:W.cacheControl,expires:W.expires,rawData:W.rawData.slice(0)},o.actor&&o.actor.send("loadTile",N,j.bind(this),void 0,!0))},!0);o.request={cancel:H}}function j(H,Z){return delete o.request,o.aborted?f(null):H&&H.status!==404?f(H):(Z&&Z.resourceTiming&&(o.resourceTiming=Z.resourceTiming),this.map._refreshExpiredTiles&&Z&&o.setExpiryData(Z),o.loadVectorData(Z,this.map.painter),s.aK(this.dispatcher),f(null),void(o.reloadCallback&&(this.loadTile(o,o.reloadCallback),o.reloadCallback=null)))}}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,f){o.actor&&o.actor.send("removeTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope}),o.destroy()}hasTransition(){return!1}afterUpdate(){this._tileWorkers={}}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class Ws extends s.E{constructor(o,f,y,w){super(),this.id=o,this.dispatcher=y,this.setEventedParent(w),this.type="raster",this.minzoom=0,this.maxzoom=22,this.roundZoom=!0,this.scheme="xyz",this.tileSize=512,this._loaded=!1,this._options=s.h({type:"raster"},f),s.h(this,s.aF(f,["url","scheme","tileSize"]))}load(o){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const f=this.map.getWorldview();this._tileJSONRequest=qs(this._options,this.map._requestManager,null,f,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,y?this.fire(new s.z(y)):w&&(s.h(this,w),w.raster_layers&&(this.rasterLayers=w.raster_layers,this.rasterLayerIds=this.rasterLayers.map(E=>E.id)),this.tileBounds=zs.fromTileJSON(w),Ut(w.tiles),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),o&&o(y)})}loaded(){return this._loaded}onAdd(o){this.map=o,this.load()}reload(){this.cancelTileJSONRequest();const o=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(o))}setTiles(o){return this._options.tiles=o,this.reload(),this}setUrl(o){return this.url=o,this._options.url=o,this.reload(),this}onRemove(o){this.cancelTileJSONRequest()}serialize(){return s.h({},this._options)}hasTile(o){return!this.tileBounds||this.tileBounds.contains(o.canonical)}loadTile(o,f){const y=s.q.devicePixelRatio>=2,w=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),y,this.tileSize);o.request=s.o(this.map._requestManager.transformRequest(w,s.R.Tile),(E,C,M,N)=>(delete o.request,o.aborted?(o.state="unloaded",f(null)):E?(o.state="errored",f(E)):C?(this.map._refreshExpiredTiles&&o.setExpiryData({cacheControl:M,expires:N}),o.setTexture(C,this.map.painter),o.state="loaded",s.aK(this.dispatcher),void f(null)):f(null)))}abortTile(o,f){o.request&&(o.request.cancel(),delete o.request),f&&f()}unloadTile(o,f){o.texture&&o.texture instanceof s.T?(o.destroy(!0),o.texture&&o.texture instanceof s.T&&this.map.painter.saveTileTexture(o.texture)):o.destroy(),f&&f()}hasTransition(){return!1}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}}class ja extends Ws{constructor(o,f,y,w){super(o,f,y,w),this.type="raster-array",this.maxzoom=22,this.partial=!0,this._options=s.h({type:"raster-array"},f)}triggerRepaint(o){const f=this.map.painter._terrain,y=this.map.style.getSourceCache(this.id);f&&f.enabled&&y&&f._clearRenderCacheForTile(y.id,o.tileID),this.map.triggerRepaint()}loadTile(o,f){const y=this.map._requestManager.normalizeTileURL(o.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize),w=this.map._requestManager.transformRequest(y,s.R.Tile),E={request:w,uid:o.uid,tileID:o.tileID,type:this.type,source:this.id,scope:this.scope,partial:this.partial};o.source=this.id,o.scope=this.scope,o.requestParams=w,o.actor||(o.actor=this.dispatcher.getActor());const C=(M,N,j,H)=>{if(delete o.request,o.aborted)return o.state="unloaded",f(null);if(M)return M.name==="AbortError"?void 0:(o.state="errored",f(M));if(this.map._refreshExpiredTiles&&N&&o.setExpiryData({cacheControl:j,expires:H}),this.partial)o.state="empty";else{if(!N)return f(null);o.state="loaded",o._isHeaderLoaded=!0,o._mrt=N}f(null)};o.request=this.partial?o.fetchHeader(void 0,C.bind(this)):o.actor.send("loadTile",E,C.bind(this),void 0,!0)}abortTile(o){o.request&&(o.request.cancel(),delete o.request),o.actor&&o.actor.send("abortTile",{uid:o.uid,type:this.type,source:this.id,scope:this.scope})}unloadTile(o,f){const y=o.texture;y&&y instanceof s.T?(o.destroy(!0),this.map.painter.saveTileTexture(y)):(o.destroy(),o.flushQueues(),o._isHeaderLoaded=!1,delete o._mrt,delete o.textureDescriptor),o.fbo&&(o.fbo.destroy(),delete o.fbo),delete o.request,delete o.requestParams,delete o.neighboringTiles,o.state="unloaded"}prepareTile(o,f,y){o._isHeaderLoaded&&(o.state!=="empty"&&(o.state="reloading"),o.fetchBand(f,y,(w,E)=>{if(w)return o.state="errored",this.fire(new s.z(w)),void this.triggerRepaint(o);E&&(o._isHeaderLoaded=!0,o.setTexture(E,this.map.painter),o.state="loaded",this.triggerRepaint(o))}))}getInitialBand(o){if(!this.rasterLayers)return 0;const f=this.rasterLayers.find(({id:E})=>E===o),y=f&&f.fields,w=y&&y.bands&&y.bands;return w?w[0]:0}getTextureDescriptor(o,f,y){if(!o)return;const w=f.sourceLayer||this.rasterLayerIds&&this.rasterLayerIds[0];if(!w)return;let E=null;f instanceof s.aN?E=f.paint.get("raster-array-band"):f instanceof s.aO&&(E=f.paint.get("raster-particle-array-band"));const C=E||this.getInitialBand(w);if(C!=null)if(o.textureDescriptor){if(!o.updateNeeded(w,C)||y)return Object.assign({},o.textureDescriptor,{texture:o.texture})}else this.prepareTile(o,w,C)}getImages(o,f){const y=new Map;for(const w of o)for(const E of f){const[C,M]=E.split("/"),N=w.getLayer(C);if(!N||!N.hasBand(M)||!N.hasDataForBand(M))continue;const{bytes:j,tileSize:H,buffer:Z}=N.getBandView(M),W=H+2*Z,Q={data:new s.r({width:W,height:W},j),pixelRatio:2,sdf:!1,usvg:!1,version:0};y.set(E,Q)}return y}}const wu={vector:Ua,raster:Ws,"raster-dem":class extends Ws{constructor(_,o,f,y){super(_,o,f,y),this.type="raster-dem",this.maxzoom=22,this._options=s.h({type:"raster-dem"},o),this.encoding=o.encoding||"mapbox"}loadTile(_,o){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme),!1,this.tileSize);function y(w,E){w&&(_.state="errored",o(w)),E&&(_.dem=E,_.dem.onDeserialize(),_.needsHillshadePrepare=!0,_.needsDEMTextureUpload=!0,_.state="loaded",o(null))}_.request=s.o(this.map._requestManager.transformRequest(f,s.R.Tile),(function(w,E,C,M){if(delete _.request,_.aborted)_.state="unloaded",o(null);else if(w)_.state="errored",o(w);else if(E){this.map._refreshExpiredTiles&&_.setExpiryData({cacheControl:C,expires:M});const N=ImageBitmap&&E instanceof ImageBitmap&&s.t(),j=1-(E.width-s.aL(E.width))/2;j<1||_.neighboringTiles||(_.neighboringTiles=this._getNeighboringTiles(_.tileID));const H=N?E:s.q.getImageData(E,j),Z={uid:_.uid,tileID:_.tileID,source:this.id,type:this.type,scope:this.scope,rawImageData:H,encoding:this.encoding,padding:j};_.actor&&_.state!=="expired"||(_.actor=this.dispatcher.getActor(),_.actor.send("loadTile",Z,y.bind(this),void 0,!0))}}).bind(this))}_getNeighboringTiles(_){const o=_.canonical,f=Math.pow(2,o.z),y=(o.x-1+f)%f,w=o.x===0?_.wrap-1:_.wrap,E=(o.x+1+f)%f,C=o.x+1===f?_.wrap+1:_.wrap,M={};return M[new s.aM(_.overscaledZ,w,o.z,y,o.y).key]={backfilled:!1},M[new s.aM(_.overscaledZ,C,o.z,E,o.y).key]={backfilled:!1},o.y>0&&(M[new s.aM(_.overscaledZ,w,o.z,y,o.y-1).key]={backfilled:!1},M[new s.aM(_.overscaledZ,_.wrap,o.z,o.x,o.y-1).key]={backfilled:!1},M[new s.aM(_.overscaledZ,C,o.z,E,o.y-1).key]={backfilled:!1}),o.y+1<f&&(M[new s.aM(_.overscaledZ,w,o.z,y,o.y+1).key]={backfilled:!1},M[new s.aM(_.overscaledZ,_.wrap,o.z,o.x,o.y+1).key]={backfilled:!1},M[new s.aM(_.overscaledZ,C,o.z,E,o.y+1).key]={backfilled:!1}),M}},"raster-array":ja,geojson:class extends s.E{constructor(_,o,f,y){super(),this.id=_,this.type="geojson",this.minzoom=0,this.maxzoom=18,this.tileSize=512,this.isTileClipped=!0,this.reparseOverscaled=!0,this._loaded=!1,this.actor=f.getActor(),this.setEventedParent(y),this._data=o.data,this._options=s.h({},o),this._collectResourceTiming=o.collectResourceTiming,o.maxzoom!==void 0&&(this.maxzoom=o.maxzoom),o.minzoom!==void 0&&(this.minzoom=o.minzoom),o.type&&(this.type=o.type),o.attribution&&(this.attribution=o.attribution),this.promoteId=o.promoteId;const w=s.aj/this.tileSize;this.workerOptions=s.h({source:this.id,scope:this.scope,cluster:o.cluster||!1,geojsonVtOptions:{buffer:(o.buffer!==void 0?o.buffer:128)*w,tolerance:(o.tolerance!==void 0?o.tolerance:.375)*w,extent:s.aj,maxZoom:this.maxzoom,lineMetrics:o.lineMetrics||!1,generateId:o.generateId||!1},superclusterOptions:{maxZoom:o.clusterMaxZoom!==void 0?o.clusterMaxZoom:this.maxzoom-1,minPoints:Math.max(2,o.clusterMinPoints||2),extent:s.aj,radius:(o.clusterRadius!==void 0?o.clusterRadius:50)*w,log:!1,generateId:o.generateId||!1},clusterProperties:o.clusterProperties,filter:o.filter,dynamic:o.dynamic},o.workerOptions)}onAdd(_){this.map=_,this.setData(this._data)}setData(_){return this._data=_,this._updateWorkerData(),this}updateData(_){if(!this._options.dynamic)return this.fire(new s.z(new Error("Can't call updateData on a GeoJSON source with dynamic set to false.")));if(typeof _!="string"&&(_.type==="Feature"&&(_={type:"FeatureCollection",features:[_]}),_.type!=="FeatureCollection"))return this.fire(new s.z(new Error("Data to update should be a feature or a feature collection.")));if(this._coalesce&&typeof _!="string"&&typeof this._data!="string"&&this._data.type==="FeatureCollection"){const o=new Map;for(const f of this._data.features)o.set(f.id,f);for(const f of _.features)o.set(f.id,f);this._data.features=[...o.values()]}else this._data=_;return this._updateWorkerData(!0),this}getClusterExpansionZoom(_,o){return this.actor.send("geojson.getClusterExpansionZoom",{clusterId:_,source:this.id,scope:this.scope},o),this}getClusterChildren(_,o){return this.actor.send("geojson.getClusterChildren",{clusterId:_,source:this.id,scope:this.scope},o),this}getClusterLeaves(_,o,f,y){return this.actor.send("geojson.getClusterLeaves",{source:this.id,scope:this.scope,clusterId:_,limit:o,offset:f},y),this}_updateWorkerData(_=!1){if(this._pendingLoad)return void(this._coalesce=!0);this.fire(new s.A("dataloading",{dataType:"source"})),this._loaded=!1;const o=s.h({append:_},this.workerOptions);o.scope=this.scope;const f=this._data;typeof f=="string"?(o.request=this.map._requestManager.transformRequest(s.q.resolveURL(f),s.R.Source),o.request.collectResourceTiming=this._collectResourceTiming):o.data=JSON.stringify(f),this._pendingLoad=this.actor.send(`${this.type}.loadData`,o,(y,w)=>{if(this._loaded=!0,this._pendingLoad=null,y)this.fire(new s.z(y));else{const E={dataType:"source",sourceDataType:this._metadataFired?"content":"metadata"};this._collectResourceTiming&&w&&w.resourceTiming&&w.resourceTiming[this.id]&&(E.resourceTiming=w.resourceTiming[this.id]),_&&(this._partialReload=!0),this.fire(new s.A("data",E)),this._partialReload=!1,this._metadataFired=!0}this._coalesce&&(this._updateWorkerData(_),this._coalesce=!1)})}loaded(){return this._loaded}reload(){const _=s.C(this.id,this.scope);this.map.style.clearSource(_),this._updateWorkerData()}loadTile(_,o){const f=_.actor?"reloadTile":"loadTile";_.actor=this.actor;const y=this.map.style?this.map.style.getLut(this.scope):null,w=y?{image:y.image.clone()}:null,E=this._partialReload,C={type:this.type,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,maxZoom:this.maxzoom,tileSize:this.tileSize,source:this.id,lut:w,scope:this.scope,pixelRatio:s.q.devicePixelRatio,showCollisionBoxes:this.map.showCollisionBoxes,promoteId:this.promoteId,brightness:this.map.style&&this.map.style.getBrightness()||0,extraShadowCaster:_.isExtraShadowCaster,scaleFactor:this.map.getScaleFactor(),partial:E,worldview:this.map.getWorldview()};_.request=this.actor.send(f,C,(M,N)=>E&&!N?(_.state="loaded",o(null)):(delete _.request,_.destroy(),_.aborted?o(null):M?o(M):(_.loadVectorData(N,this.map.painter,f==="reloadTile"),o(null))),void 0,f==="loadTile")}abortTile(_){_.request&&(_.request.cancel(),delete _.request),_.aborted=!0}unloadTile(_,o){this.actor.send("removeTile",{uid:_.uid,type:this.type,source:this.id,scope:this.scope}),_.destroy()}onRemove(_){this._pendingLoad&&this._pendingLoad.cancel()}serialize(){return s.h({},this._options,{type:this.type,data:this._data})}hasTransition(){return!1}},video:class extends s.aP{constructor(_,o,f,y){super(_,o,f,y),this.roundZoom=!0,this.type="video",this.options=o}load(){this._loaded=!1;const _=this.options;this.urls=[];for(const o of _.urls)this.urls.push(this.map._requestManager.transformRequest(o,s.R.Source).url);s.aQ(this.urls,(o,f)=>{this._loaded=!0,o?this.fire(new s.z(o)):f&&(this.video=f,this.video.loop=!0,this.video.setAttribute("playsinline",""),this.video.addEventListener("playing",()=>{this.map.triggerRepaint()}),this.map&&this.video.play(),this._finishLoading())})}pause(){this.video&&this.video.pause()}play(){this.video&&this.video.play()}seek(_){if(this.video){const o=this.video.seekable;_<o.start(0)||_>o.end(0)?this.fire(new s.z(new s.V(`sources.${this.id}`,null,`Playback for this video can be set only between the ${o.start(0)} and ${o.end(0)}-second mark.`))):this.video.currentTime=_}}getVideo(){return this.video}onAdd(_){this.map||(this.map=_,this.load(),this.video&&(this.video.play(),this.setCoordinates(this.coordinates)))}prepare(){if(Object.keys(this.tiles).length===0||this.video.readyState<2)return;const _=this.map.painter.context,o=_.gl;this.texture?this.video.paused||(this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),o.texSubImage2D(o.TEXTURE_2D,0,0,0,o.RGBA,o.UNSIGNED_BYTE,this.video)):(this.texture=new s.T(_,this.video,o.RGBA8),this.texture.bind(o.LINEAR,o.CLAMP_TO_EDGE),this.width=this.video.videoWidth,this.height=this.video.videoHeight),this._prepareData(_)}serialize(){return{type:"video",urls:this.urls,coordinates:this.coordinates}}hasTransition(){return this.video&&!this.video.paused}},image:s.aP,model:class extends s.E{constructor(_,o,f,y){super(),this.id=_,this.type="model",this.models=[],this._loaded=!1,this._options=o}load(){const _=[];for(const o in this._options.models){const f=this._options.models[o],y=s.aS(this.map._requestManager.transformRequest(f.uri,s.R.Model).url).then(w=>{if(!w)return;const E=s.aT(w),C=new s.aU(o,f.position,f.orientation,E);C.computeBoundsAndApplyParent(),this.models.push(C)}).catch(w=>{this.fire(new s.z(new Error(`Could not load model ${o} from ${f.uri}: ${w.message}`)))});_.push(y)}Promise.allSettled(_).then(()=>{this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"}))}).catch(o=>{this._loaded=!0,this.fire(new s.z(new Error(`Could not load models: ${o.message}`)))})}onAdd(_){this.map=_,this.load()}hasTransition(){return!1}loaded(){return this._loaded}getModels(){return this.models}loadTile(_,o){}serialize(){return this._options}},"batched-model":class extends s.E{constructor(_,o,f,y){super(),this.type="batched-model",this.id=_,this.tileSize=512,this._options=o,this.tiles=this._options.tiles,this.maxzoom=o.maxzoom||19,this.minzoom=o.minzoom||0,this.roundZoom=!0,this.usedInConflation=!0,this.dispatcher=f,this.reparseOverscaled=!1,this.scheme="xyz",this._loaded=!1,this.setEventedParent(y)}onAdd(_){this.map=_,this.load()}reload(){this.cancelTileJSONRequest();const _=s.C(this.id,this.scope);this.load(()=>this.map.style.clearSource(_))}cancelTileJSONRequest(){this._tileJSONRequest&&(this._tileJSONRequest.cancel(),this._tileJSONRequest=null)}load(_){this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"}));const o=Array.isArray(this.map._language)?this.map._language.join():this.map._language,f=this.map.getWorldview();this._tileJSONRequest=qs(this._options,this.map._requestManager,o,f,(y,w)=>{this._tileJSONRequest=null,this._loaded=!0,y?(o&&console.warn(`Ensure that your requested language string is a valid BCP-47 code or list of codes. Found: ${o}`),f&&f.length!==2&&console.warn(`Requested worldview strings must be a valid ISO alpha-2 code. Found: ${f}`),this.fire(new s.z(y))):w&&(s.h(this,w),w.bounds&&(this.tileBounds=new zs(w.bounds,this.minzoom,this.maxzoom)),Ut(w.tiles,this.map._requestManager._customAccessToken),this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))),_&&_(y)})}hasTransition(){return!1}hasTile(_){return!this.tileBounds||this.tileBounds.contains(_.canonical)}loaded(){return this._loaded}loadTile(_,o){const f=this.map._requestManager.normalizeTileURL(_.tileID.canonical.url(this.tiles,this.scheme)),y={request:this.map._requestManager.transformRequest(f,s.R.Tile),data:void 0,uid:_.uid,tileID:_.tileID,tileZoom:_.tileZoom,zoom:_.tileID.overscaledZ,tileSize:this.tileSize*_.tileID.overscaleFactor(),type:this.type,source:this.id,scope:this.scope,showCollisionBoxes:this.map.showCollisionBoxes,isSymbolTile:_.isSymbolTile,brightness:this.map.style&&this.map.style.getBrightness()||0,pixelRatio:s.q.devicePixelRatio,promoteId:this.promoteId};if(_.actor&&_.state!=="expired")if(_.state==="loading")_.reloadCallback=o;else{if(_.buckets){const E=Object.values(_.buckets);for(const C of E)C.dirty=!0;return void(_.state="loaded")}_.request=_.actor.send("reloadTile",y,w.bind(this))}else _.actor=this.dispatcher.getActor(),_.request=_.actor.send("loadTile",y,w.bind(this),void 0,!0);function w(E,C){return _.aborted?o(null):E&&E.status!==404?o(E):(this.map._refreshExpiredTiles&&C&&_.setExpiryData(C),_.loadModelData(C,this.map.painter),_.state="loaded",void o(null))}}serialize(){return s.h({},this._options)}},canvas:class extends s.aP{constructor(_,o,f,y){super(_,o,f,y),o.coordinates?Array.isArray(o.coordinates)&&o.coordinates.length===4&&!o.coordinates.some(w=>!Array.isArray(w)||w.length!==2||w.some(E=>typeof E!="number"))||this.fire(new s.z(new s.V(`sources.${_}`,null,'"coordinates" property must be an array of 4 longitude/latitude array pairs'))):this.fire(new s.z(new s.V(`sources.${_}`,null,'missing required property "coordinates"'))),o.animate&&typeof o.animate!="boolean"&&this.fire(new s.z(new s.V(`sources.${_}`,null,'optional "animate" property must be a boolean value'))),o.canvas?typeof o.canvas=="string"||o.canvas instanceof HTMLCanvasElement||this.fire(new s.z(new s.V(`sources.${_}`,null,'"canvas" must be either a string representing the ID of the canvas element from which to read, or an HTMLCanvasElement instance'))):this.fire(new s.z(new s.V(`sources.${_}`,null,'missing required property "canvas"'))),this.options=o,this.animate=o.animate===void 0||o.animate}load(){this._loaded=!0,this.canvas||(this.canvas=this.options.canvas instanceof HTMLCanvasElement?this.options.canvas:document.getElementById(this.options.canvas)),this.width=this.canvas.width,this.height=this.canvas.height,this._hasInvalidDimensions()?this.fire(new s.z(new Error("Canvas dimensions cannot be less than or equal to zero."))):(this.play=function(){this._playing=!0,this.map.triggerRepaint()},this.pause=function(){this._playing&&(this.prepare(),this._playing=!1)},this._finishLoading())}getCanvas(){return this.canvas}onAdd(_){this.map=_,this.load(),this.canvas&&this.animate&&this.play()}onRemove(_){this.pause()}prepare(){let _=!1;if(this.canvas.width!==this.width&&(this.width=this.canvas.width,_=!0),this.canvas.height!==this.height&&(this.height=this.canvas.height,_=!0),this._hasInvalidDimensions()||Object.keys(this.tiles).length===0)return;const o=this.map.painter.context;this.texture?!_&&!this._playing||this.texture instanceof s.aR||this.texture.update(this.canvas,{premultiply:!0}):this.texture=new s.T(o,this.canvas,o.gl.RGBA8,{premultiply:!0}),this._prepareData(o)}serialize(){return{type:"canvas",coordinates:this.coordinates}}hasTransition(){return this._playing}_hasInvalidDimensions(){for(const _ of[this.canvas.width,this.canvas.height])if(isNaN(_)||_<=0)return!0;return!1}},custom:class extends s.E{constructor(_,o,f,y){super(),this.id=_,this.type="custom",this._dataType="raster",this._dispatcher=f,this._implementation=o,this.setEventedParent(y),this.scheme="xyz",this.minzoom=0,this.maxzoom=22,this.tileSize=512,this._loaded=!1,this.roundZoom=!0,this._implementation||this.fire(new s.z(new Error(`Missing implementation for ${this.id} custom source`))),this._implementation.loadTile||this.fire(new s.z(new Error(`Missing loadTile implementation for ${this.id} custom source`))),this._implementation.bounds&&(this.tileBounds=new zs(this._implementation.bounds,this.minzoom,this.maxzoom)),o.update=this._update.bind(this),o.clearTiles=this._clearTiles.bind(this),o.coveringTiles=this._coveringTiles.bind(this),s.h(this,s.aF(o,["dataType","scheme","minzoom","maxzoom","tileSize","attribution","minTileCacheSize","maxTileCacheSize"]))}serialize(){return s.aF(this,["type","scheme","minzoom","maxzoom","tileSize","attribution"])}load(){this._loaded=!0,this.fire(new s.A("data",{dataType:"source",sourceDataType:"metadata"})),this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}loaded(){return this._loaded}onAdd(_){this.map=_,this._loaded=!1,this.fire(new s.A("dataloading",{dataType:"source"})),this._implementation.onAdd&&this._implementation.onAdd(_),this.load()}onRemove(_){this._implementation.onRemove&&this._implementation.onRemove(_)}hasTile(_){if(this._implementation.hasTile){const{x:o,y:f,z:y}=_.canonical;return this._implementation.hasTile({x:o,y:f,z:y})}return!this.tileBounds||this.tileBounds.contains(_.canonical)}loadTile(_,o){const{x:f,y,z:w}=_.tileID.canonical,E=new AbortController;_.request=Promise.resolve(this._implementation.loadTile({x:f,y,z:w},{signal:E.signal})).then((function(C){return delete _.request,_.aborted?(_.state="unloaded",o(null)):C===void 0?(_.state="errored",o(null)):C===null?(this.loadTileData(_,{width:this.tileSize,height:this.tileSize,data:null}),_.state="loaded",o(null)):function(M){return M instanceof ImageData||M instanceof HTMLCanvasElement||M instanceof ImageBitmap||M instanceof HTMLImageElement}(C)?(this.loadTileData(_,C),_.state="loaded",void o(null)):(_.state="errored",o(new Error(`Can't infer data type for ${this.id}, only raster data supported at the moment`)))}).bind(this)).catch(C=>{C.name!=="AbortError"&&(_.state="errored",o(C))}),_.request.cancel=()=>E.abort()}loadTileData(_,o){_.setTexture(o,this.map.painter)}unloadTile(_,o){if(_.texture&&_.texture instanceof s.T?(_.destroy(!0),_.texture&&_.texture instanceof s.T&&this.map.painter.saveTileTexture(_.texture)):_.destroy(),this._implementation.unloadTile){const{x:f,y,z:w}=_.tileID.canonical;this._implementation.unloadTile({x:f,y,z:w})}o&&o()}abortTile(_,o){_.request&&_.request.cancel&&(_.request.cancel(),delete _.request),o&&o()}hasTransition(){return!1}_coveringTiles(){return this.map.transform.coveringTiles({tileSize:this.tileSize,minzoom:this.minzoom,maxzoom:this.maxzoom,roundZoom:this.roundZoom}).map(_=>({x:_.canonical.x,y:_.canonical.y,z:_.canonical.z}))}_clearTiles(){const _=s.C(this.id,this.scope);this.map.style.clearSource(_)}_update(){this.fire(new s.A("data",{dataType:"source",sourceDataType:"content"}))}}},Zu=function(_,o,f,y){const w=new wu[o.type](_,o,f,y);if(w.id!==_)throw new Error(`Expected Source id to be ${_} instead of ${w.id}`);return s.aV(["load","abort","unload","serialize","prepare"],w),w};function Hc(_,o,f=""){return`${f}:${o.id||""}:${o.layer.id}:${function(y){if("layerId"in y)return`layer:${y.layerId}`;{const{featuresetId:w,importId:E}=y;return`featureset:${w}${E?`:import:${E}`:""}`}}(_.target)}`}function Jl(_,o,f,y=""){if(_.uniqueFeatureID){const w=Hc(_,o,y);if(f.has(w))return!0;f.add(w)}return!1}function Xu(_,o,f,y,w=!1){const E=o.sourceCache.transform,C=o.sourceCache.tilesIn(_,o.has3DLayers,w);C.sort(Ha);const M=[];for(const N of C){const j=N.tile.queryRenderedFeatures(o,N,f,y,E,w);Object.keys(j).length&&M.push({wrappedTileID:N.tile.tileID.wrapped().key,queryResults:j})}return M.length===0?{}:function(N){const j={},H={};for(const Z of N){const W=Z.queryResults,Q=Z.wrappedTileID,ce=H[Q]=H[Q]||{};for(const se in W){const ue=W[se],pe=ce[se]=ce[se]||{},ge=j[se]=j[se]||[];for(const Pe of ue)pe[Pe.featureIndex]||(pe[Pe.featureIndex]=!0,ge.push(Pe))}}return j}(M)}function Qu(_,o,f,y,w,E){const C={},M=y.queryRenderedSymbols(_),N=[];for(const j of Object.keys(M).map(Number))N.push(w[j]);N.sort(Ha);for(const j of N){const H=j.featureIndex.lookupSymbolFeatures(M[j.bucketInstanceId],j.bucketIndex,j.sourceLayerIndex,o,f,E);for(const Z in H){const W=C[Z]=C[Z]||[],Q=H[Z];Q.sort((ce,se)=>{const ue=j.featureSortOrder;if(ue){const pe=ue.indexOf(ce.featureIndex);return ue.indexOf(se.featureIndex)-pe}return se.featureIndex-ce.featureIndex});for(const ce of Q)W.push(ce)}}return C}function Dl(_,o){const f=_.getRenderableIds().map(E=>_.getTileByID(E)),y=[],w={};for(let E=0;E<f.length;E++){const C=f[E],M=C.tileID.canonical.key;w[M]||(w[M]=!0,C.querySourceFeatures(y,o))}return y}function Ha(_,o){const f=_.tileID,y=o.tileID;return f.overscaledZ-y.overscaledZ||f.canonical.y-y.canonical.y||f.wrap-y.wrap||f.canonical.x-y.canonical.x}function Ho(_,o){const f={};if(!o)return f;for(const y of _){const w=y.layerIds.map(E=>o.getLayer(E)).filter(Boolean);if(w.length!==0){y.layers=w,y.stateDependentLayerIds&&(y.stateDependentLayers=y.stateDependentLayerIds.map(E=>w.filter(C=>C.id===E)[0]));for(const E of w)f[E.fqid]=y}}return f}const To=32,ya=33,Mr=new Uint16Array(8184);for(let _=0;_<2046;_++){let o=_+2,f=0,y=0,w=0,E=0,C=0,M=0;for(1&o?w=E=C=To:f=y=M=To;(o>>=1)>1;){const j=f+w>>1,H=y+E>>1;1&o?(w=f,E=y,f=C,y=M):(f=w,y=E,w=C,E=M),C=j,M=H}const N=4*_;Mr[N+0]=f,Mr[N+1]=y,Mr[N+2]=w,Mr[N+3]=E}const na=new Uint16Array(2178),$a=new Uint8Array(1089),ec=new Uint16Array(1089);function ll(_){return _===0?-.03125:_===32?.03125:0}const $c={type:2,extent:s.aj,loadGeometry:()=>[[new s.P(0,0),new s.P(s.aj+1,0),new s.P(s.aj+1,s.aj+1),new s.P(0,s.aj+1),new s.P(0,0)]]};class Rl{constructor(o,f,y,w,E,C){this.tileID=o,this.uid=s.a$(),this.uses=0,this.tileSize=f,this.tileZoom=y,this.buckets={},this.expirationTime=null,this.queryPadding=0,this.hasSymbolBuckets=!1,this.hasRTLText=!1,this.dependencies={},this.isRaster=E,w&&w.style&&(this._lastUpdatedBrightness=w.style.getBrightness()),this.expiredRequestCount=0,this.state="loading",w&&w.transform&&(this.projection=w.transform.projection),this.worldview=C}registerFadeDuration(o){const f=o+this.timeAdded;f<s.q.now()||this.fadeEndTime&&f<this.fadeEndTime||(this.fadeEndTime=f)}wasRequested(){return this.state==="errored"||this.state==="loaded"||this.state==="reloading"}get tileTransform(){return this._tileTransform||(this._tileTransform=s.aW(this.tileID.canonical,this.projection)),this._tileTransform}loadVectorData(o,f,y){if(this.unloadVectorData(),this.state="loaded",o){o.featureIndex&&(this.latestFeatureIndex=o.featureIndex,o.rawTileData?(this.latestRawTileData=o.rawTileData,this.latestFeatureIndex.rawTileData=o.rawTileData):this.latestRawTileData&&(this.latestFeatureIndex.rawTileData=this.latestRawTileData)),this.collisionBoxArray=o.collisionBoxArray,this.buckets=Ho(o.buckets,f.style),this.hasSymbolBuckets=!1;for(const w in this.buckets){const E=this.buckets[w];if(E instanceof s.b1){if(this.hasSymbolBuckets=!0,!y)break;E.justReloaded=!0}}if(this.hasRTLText=!1,this.hasSymbolBuckets)for(const w in this.buckets){const E=this.buckets[w];if(E instanceof s.b1&&E.hasRTLText){this.hasRTLText=!0,s.b2();break}}this.queryPadding=0;for(const w in this.buckets){const E=this.buckets[w],C=f.style.getOwnLayer(w);if(!C)continue;const M=C.queryRadius(E);this.queryPadding=Math.max(this.queryPadding,M)}o.imageAtlas&&(this.imageAtlas=o.imageAtlas),o.glyphAtlasImage&&(this.glyphAtlasImage=o.glyphAtlasImage),o.lineAtlas&&(this.lineAtlas=o.lineAtlas),this._lastUpdatedBrightness=o.brightness}else this.collisionBoxArray=new s.b0}unloadVectorData(){if(this.hasData()){for(const o in this.buckets)this.buckets[o].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&this.imageAtlasTexture.destroy(),this.glyphAtlasTexture&&this.glyphAtlasTexture.destroy(),this.lineAtlasTexture&&this.lineAtlasTexture.destroy(),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),this.latestFeatureIndex=null,this.state="unloaded"}}loadModelData(o,f,y){o&&(o.resourceTiming&&(this.resourceTiming=o.resourceTiming),this.buckets=Object.assign({},this.buckets,Ho(o.buckets,f.style)),o.featureIndex&&(this.latestFeatureIndex=o.featureIndex))}getBucket(o){return this.buckets[o.fqid]}upload(o){for(const w in this.buckets){const E=this.buckets[w];E.uploadPending()&&E.upload(o)}const f=o.gl,y=this.imageAtlas;y&&!y.uploaded&&(this.imageAtlasTexture=new s.T(o,y.image,f.RGBA8,{useMipmap:!!y.patternPositions.size}),this.imageAtlas.uploaded=!0),this.glyphAtlasImage&&(this.glyphAtlasTexture=new s.T(o,this.glyphAtlasImage,f.R8),this.glyphAtlasImage=null),this.lineAtlas&&!this.lineAtlas.uploaded&&(this.lineAtlasTexture=new s.T(o,this.lineAtlas.image,f.R8),this.lineAtlas.uploaded=!0)}prepare(o,f,y){if(this.imageAtlas&&this.imageAtlasTexture&&this.imageAtlas.patchUpdatedImages(o,this.imageAtlasTexture,y),!f||!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData)return;const w=f.style.getBrightness();(this._lastUpdatedBrightness||w)&&(this._lastUpdatedBrightness&&w&&Math.abs(this._lastUpdatedBrightness-w)<.001||(this.updateBuckets(f,this._lastUpdatedBrightness!==w),this._lastUpdatedBrightness=w))}queryRenderedFeatures(o,f,y,w,E,C){if(!this.latestFeatureIndex||!this.latestFeatureIndex.rawTileData&&!this.latestFeatureIndex.is3DTile)return{};const M=function(N,j){const H=s.bn([],[.5*N.width,.5*-N.height,1]);return s.bo(H,H,[1,-1,0]),s.az(H,H,N.calculateProjMatrix(j.toUnwrapped())),Float32Array.from(H)}(E,this.tileID);return this.latestFeatureIndex.query(o,{tilespaceGeometry:f,pixelPosMatrix:M,transform:w,availableImages:y,tileTransform:this.tileTransform,worldview:this.worldview})}querySourceFeatures(o,f){const y=this.latestFeatureIndex;if(!y||!y.rawTileData)return;const w=y.loadVTLayers(),E=f?f.sourceLayer:"",C=w._geojsonTileLayer||w[E];if(!C)return;const M=s.b3(f&&f.filter),{z:N,x:j,y:H}=this.tileID.canonical,Z={z:N,x:j,y:H};for(let W=0;W<C.length;W++){const Q=C.feature(W);if(M.needGeometry){const ue=s.b4(Q,!0);if(!M.filter(new s.aa(this.tileID.overscaledZ,{worldview:this.worldview}),ue,this.tileID.canonical))continue}else if(!M.filter(new s.aa(this.tileID.overscaledZ,{worldview:this.worldview}),Q))continue;const ce=y.getId(Q,E),se=new s.b5(Q,N,j,H,ce);se.tile=Z,o.push(se)}}loaded(){return this.state==="loaded"||this.state==="errored"}hasData(){return this.state==="loaded"||this.state==="reloading"||this.state==="expired"}patternsLoaded(){return!!this.imageAtlas&&!!this.imageAtlas.patternPositions.size}setExpiryData(o){const f=this.expirationTime;if(o.cacheControl){const y=s.b6(o.cacheControl);y["max-age"]&&(this.expirationTime=Date.now()+1e3*y["max-age"])}else o.expires&&(this.expirationTime=new Date(o.expires).getTime());if(this.expirationTime){const y=Date.now();let w=!1;if(this.expirationTime>y)w=!1;else if(f)if(this.expirationTime<f)w=!0;else{const E=this.expirationTime-f;E?this.expirationTime=y+Math.max(E,3e4):w=!0}else w=!0;w?(this.expiredRequestCount++,this.state="expired"):this.expiredRequestCount=0}}getExpiryTimeout(){if(this.expirationTime)return this.expiredRequestCount?1e3*(1<<Math.min(this.expiredRequestCount-1,31)):Math.min(this.expirationTime-new Date().getTime(),Math.pow(2,31)-1)}refreshFeatureState(o){this.latestFeatureIndex&&(this.latestFeatureIndex.rawTileData||this.latestFeatureIndex.is3DTile)&&o&&this.updateBuckets(o)}updateBuckets(o,f){if(!this.latestFeatureIndex||!o.style)return;const y=this.latestFeatureIndex.loadVTLayers(),w=o.style.listImages(),E=o.style.getBrightness();for(const C in this.buckets){if(!o.style.hasLayer(C))continue;const M=this.buckets[C],N=M.layers[0],j=N.sourceLayer||"_geojsonTileLayer",H=y[j],Z=o.style.getLayerSourceCache(N);let W={};Z&&(W=Z._state.getState(j,void 0));const Q=this.imageAtlas?Object.fromEntries(this.imageAtlas.patternPositions):{},ce=Object.keys(W).length>0&&!f;ce&&!M.stateDependentLayers.length&&!f||M.update(W,H,w,Q,ce?M.stateDependentLayers:M.layers,f,E),(M instanceof s.b7||M instanceof s.b8)&&o._terrain&&o._terrain.enabled&&Z&&M.uploadPending()&&o._terrain._clearRenderCacheForTile(Z.id,this.tileID);const se=o&&o.style&&o.style.getOwnLayer(C);se&&(this.queryPadding=Math.max(this.queryPadding,se.queryRadius(M)))}}holdingForFade(){return this.symbolFadeHoldUntil!==void 0}symbolFadeFinished(){return!this.symbolFadeHoldUntil||this.symbolFadeHoldUntil<s.q.now()}clearFadeHold(){this.symbolFadeHoldUntil=void 0}setHoldDuration(o){this.symbolFadeHoldUntil=s.q.now()+o}setTexture(o,f){const y=f.context,w=y.gl;this.texture=this.texture||f.getTileTexture(o.width),this.texture&&this.texture instanceof s.T?this.texture.update(o):(this.texture=new s.T(y,o,w.RGBA8,{useMipmap:!0}),this.texture.bind(w.LINEAR,w.CLAMP_TO_EDGE))}setDependencies(o,f){const y={};for(const w of f)y[w]=!0;this.dependencies[o]=y}hasDependency(o,f){for(const y of o){const w=this.dependencies[y];if(w){for(const E of f)if(w[E])return!0}}return!1}clearQueryDebugViz(){}_makeDebugTileBoundsBuffers(o,f){if(!f||f.name==="mercator"||this._tileDebugBuffer)return;const y=s.b9($c,this.tileID.canonical,this.tileTransform)[0],w=new s.ba,E=new s.bb;for(let C=0;C<y.length;C++){const{x:M,y:N}=y[C];w.emplaceBack(M,N),E.emplaceBack(C)}E.emplaceBack(0),this._tileDebugIndexBuffer=o.createIndexBuffer(E),this._tileDebugBuffer=o.createVertexBuffer(w,s.bc.members),this._tileDebugSegments=s.bd.simpleSegment(0,0,w.length,E.length)}_makeTileBoundsBuffers(o,f){if(this._tileBoundsBuffer||!f||f.name==="mercator")return;const y=s.b9($c,this.tileID.canonical,this.tileTransform)[0];let w,E;if(this.isRaster){const C=function(M,N){const j=s.aW(M,N),H=Math.pow(2,M.z);for(let ue=0;ue<ya;ue++)for(let pe=0;pe<ya;pe++){const ge=s.aX((M.x+(pe+ll(pe))/To)/H),Pe=s.aY((M.y+(ue+ll(ue))/To)/H),Ve=N.project(ge,Pe),Ye=ue*ya+pe;na[2*Ye+0]=Math.round((Ve.x*j.scale-j.x)*s.aj),na[2*Ye+1]=Math.round((Ve.y*j.scale-j.y)*s.aj)}$a.fill(0),ec.fill(0);for(let ue=2045;ue>=0;ue--){const pe=4*ue,ge=Mr[pe+0],Pe=Mr[pe+1],Ve=Mr[pe+2],Ye=Mr[pe+3],qe=ge+Ve>>1,je=Pe+Ye>>1,Ue=qe+je-Pe,We=je+ge-qe,et=Pe*ya+ge,_t=Ye*ya+Ve,ft=je*ya+qe,Mt=Math.hypot((na[2*et+0]+na[2*_t+0])/2-na[2*ft+0],(na[2*et+1]+na[2*_t+1])/2-na[2*ft+1])>=16;$a[ft]=$a[ft]||(Mt?1:0),ue<1022&&($a[ft]=$a[ft]||$a[(Pe+We>>1)*ya+(ge+Ue>>1)]||$a[(Ye+We>>1)*ya+(Ve+Ue>>1)])}const Z=new s.aZ,W=new s.a_;let Q=0;function ce(ue,pe){const ge=pe*ya+ue;return ec[ge]===0&&(Z.emplaceBack(na[2*ge+0],na[2*ge+1],ue*s.aj/To,pe*s.aj/To),ec[ge]=++Q),ec[ge]-1}function se(ue,pe,ge,Pe,Ve,Ye){const qe=ue+ge>>1,je=pe+Pe>>1;if(Math.abs(ue-Ve)+Math.abs(pe-Ye)>1&&$a[je*ya+qe])se(Ve,Ye,ue,pe,qe,je),se(ge,Pe,Ve,Ye,qe,je);else{const Ue=ce(ue,pe),We=ce(ge,Pe),et=ce(Ve,Ye);W.emplaceBack(Ue,We,et)}}return se(0,0,To,To,To,0),se(To,To,0,0,0,To),{vertices:Z,indices:W}}(this.tileID.canonical,f);w=C.vertices,E=C.indices}else{w=new s.aZ,E=new s.a_;for(const{x:M,y:N}of y)w.emplaceBack(M,N,0,0);const C=s.be(w.int16.subarray(0,4*w.length),void 0,4);for(let M=0;M<C.length;M+=3)E.emplaceBack(C[M],C[M+1],C[M+2])}this._tileBoundsBuffer=o.createVertexBuffer(w,s.bf.members),this._tileBoundsIndexBuffer=o.createIndexBuffer(E),this._tileBoundsSegments=s.bd.simpleSegment(0,0,w.length,E.length)}_makeGlobeTileDebugBuffers(o,f){const y=f.projection;if(!y||y.name!=="globe"||f.freezeTileCoverage)return;const w=this.tileID.canonical,E=s.bg(w,f),C=s.bh(E),M=s.ah(f.zoom);let N;M>0&&(N=s.bi(new Float64Array(16),f.globeMatrix)),this._makeGlobeTileDebugBorderBuffer(o,w,f,C,N,M),this._makeGlobeTileDebugTextBuffer(o,w,f,C,N,M)}_globePoint(o,f,y,w,E,C,M){let N=s.bj(o,f,y);if(C){const j=1<<y.z,H=s.aD(w.center.lng),Z=s.aH(w.center.lat),W=(y.x+.5)/j-H;let Q=0;W>.5?Q=-1:W<-.5&&(Q=1);let ce=(o/s.aj+y.x)/j+Q,se=(f/s.aj+y.y)/j;ce=(ce-H)*w._pixelsPerMercatorPixel+H,se=(se-Z)*w._pixelsPerMercatorPixel+Z;const ue=[ce*w.worldSize,se*w.worldSize,0];s.ad(ue,ue,C),N=s.bk(N,ue,M)}return s.ad(N,N,E)}_makeGlobeTileDebugBorderBuffer(o,f,y,w,E,C){const M=new s.ba,N=new s.bb,j=new s.bl,H=(W,Q,ce,se,ue)=>{const pe=(ce-W)/(ue-1),ge=(se-Q)/(ue-1),Pe=M.length;for(let Ve=0;Ve<ue;Ve++){const Ye=W+Ve*pe,qe=Q+Ve*ge;M.emplaceBack(Ye,qe);const je=this._globePoint(Ye,qe,f,y,w,E,C);j.emplaceBack(je[0],je[1],je[2]),N.emplaceBack(Pe+Ve)}},Z=s.aj;H(0,0,Z,0,16),H(Z,0,Z,Z,16),H(Z,Z,0,Z,16),H(0,Z,0,0,16),this._tileDebugIndexBuffer=o.createIndexBuffer(N),this._tileDebugBuffer=o.createVertexBuffer(M,s.bc.members),this._globeTileDebugBorderBuffer=o.createVertexBuffer(j,s.bm.members),this._tileDebugSegments=s.bd.simpleSegment(0,0,M.length,N.length)}_makeGlobeTileDebugTextBuffer(o,f,y,w,E,C){const M=s.aj/4,N=new s.ba,j=new s.a_,H=new s.bl,Z=25;j.reserve(32),N.reserve(Z),H.reserve(Z);const W=(Q,ce)=>Z*Q+ce;for(let Q=0;Q<Z;Q++){const ce=Q*M;for(let se=0;se<Z;se++){const ue=se*M;N.emplaceBack(ue,ce);const pe=this._globePoint(ue,ce,f,y,w,E,C);H.emplaceBack(pe[0],pe[1],pe[2])}}for(let Q=0;Q<4;Q++)for(let ce=0;ce<4;ce++){const se=W(Q,ce),ue=W(Q,ce+1),pe=W(Q+1,ce),ge=W(Q+1,ce+1);j.emplaceBack(se,ue,pe),j.emplaceBack(pe,ue,ge)}this._tileDebugTextIndexBuffer=o.createIndexBuffer(j),this._tileDebugTextBuffer=o.createVertexBuffer(N,s.bc.members),this._globeTileDebugTextBuffer=o.createVertexBuffer(H,s.bm.members),this._tileDebugTextSegments=s.bd.simpleSegment(0,0,Z,32)}destroy(o=!1){for(const f in this.buckets)this.buckets[f].destroy();this.buckets={},this.imageAtlas&&(this.imageAtlas=null),this.lineAtlas&&(this.lineAtlas=null),this.imageAtlasTexture&&(this.imageAtlasTexture.destroy(),delete this.imageAtlasTexture),this.glyphAtlasTexture&&(this.glyphAtlasTexture.destroy(),delete this.glyphAtlasTexture),this.lineAtlasTexture&&(this.lineAtlasTexture.destroy(),delete this.lineAtlasTexture),this._tileBoundsBuffer&&(this._tileBoundsBuffer.destroy(),this._tileBoundsIndexBuffer.destroy(),this._tileBoundsSegments.destroy(),this._tileBoundsBuffer=null),this._tileDebugBuffer&&(this._tileDebugBuffer.destroy(),this._tileDebugSegments.destroy(),this._tileDebugBuffer=null),this._tileDebugIndexBuffer&&(this._tileDebugIndexBuffer.destroy(),this._tileDebugIndexBuffer=null),this._globeTileDebugBorderBuffer&&(this._globeTileDebugBorderBuffer.destroy(),this._globeTileDebugBorderBuffer=null),this._tileDebugTextBuffer&&(this._tileDebugTextBuffer.destroy(),this._tileDebugTextSegments.destroy(),this._tileDebugTextIndexBuffer.destroy(),this._tileDebugTextBuffer=null),this._globeTileDebugTextBuffer&&(this._globeTileDebugTextBuffer.destroy(),this._globeTileDebugTextBuffer=null),!o&&this.texture&&this.texture instanceof s.T&&(this.texture.destroy(),delete this.texture),this.hillshadeFBO&&(this.hillshadeFBO.destroy(),delete this.hillshadeFBO),this.dem&&delete this.dem,this.neighboringTiles&&delete this.neighboringTiles,this.demTexture&&(this.demTexture.destroy(),delete this.demTexture),this.rasterParticleState&&(this.rasterParticleState.destroy(),delete this.rasterParticleState),this.latestFeatureIndex=null,this.state="unloaded"}}s.bp.setPbf(s.bq);class Xh extends Rl{constructor(o,f,y,w,E){super(o,f,y,w,E),this._workQueue=[],this._fetchQueue=[],this._isHeaderLoaded=!1}getLayers(){return this._mrt?Object.values(this._mrt.layers):[]}getLayer(o){return this._mrt&&this._mrt.getLayer(o)}setTexture(o,f){const y=f.context,w=y.gl;this.texture=this.texture||f.getTileTexture(o.width),this.texture&&this.texture instanceof s.T?this.texture.update(o,{premultiply:!1}):this.texture=new s.T(y,o,w.RGBA8,{premultiply:!1})}flushQueues(){for(;this._workQueue.length;)this._workQueue.pop()();for(;this._fetchQueue.length;)this._fetchQueue.pop()()}fetchHeader(o=16384,f){const y=this._mrt=new s.bp(30),w=Object.assign({},this.requestParams,{headers:{Range:"bytes=0-"+(o-1)}});return this.entireBuffer=null,this.request=s.br(w,(E,C,M,N)=>{if(E)f(E);else try{const j=y.getHeaderLength(C);if(j>o)return void(this.request=this.fetchHeader(j,f));y.parseHeader(C),this._isHeaderLoaded=!0;let H=0;for(const Z of Object.values(y.layers))H=Math.max(H,Z.dataIndex[Z.dataIndex.length-1].lastByte);C.byteLength>=H&&(this.entireBuffer=C),f(null,this.entireBuffer||C,M,N)}catch(j){f(j)}}),this.request}fetchBand(o,f,y){const w=this._mrt;if(!this._isHeaderLoaded||!w)return void y(new Error("Tile header is not ready"));const E=this.actor;if(!E)return void y(new Error("Can't fetch tile band without an actor"));let C;const M=(Z,W)=>{C.complete(Z,W),Z?y(Z):(this.updateTextureDescriptor(o,f),y(null,this.textureDescriptor&&this.textureDescriptor.img))},N=(Z,W)=>{if(Z)return y(Z);const Q=E.send("decodeRasterArray",{type:"raster-array",source:this.source,scope:this.scope,tileID:this.tileID,uid:this.uid,buffer:W,task:C},M,void 0,!0);this._workQueue.push(()=>{Q&&Q.cancel(),C.cancel()})},j=w.getLayer(o);if(!j)return void y(new Error(`Unknown sourceLayer "${o}"`));if(j.hasDataForBand(f))return this.updateTextureDescriptor(o,f),void y(null,this.textureDescriptor?this.textureDescriptor.img:null);const H=j.getDataRange([f]);if(C=w.createDecodingTask(H),!C||C.tasks.length)if(this.flushQueues(),this.entireBuffer)N(null,this.entireBuffer.slice(H.firstByte,H.lastByte+1));else{const Z=Object.assign({},this.requestParams,{headers:{Range:`bytes=${H.firstByte}-${H.lastByte}`}}),W=s.br(Z,N);this._fetchQueue.push(()=>{W.cancel(),C.cancel()})}else y(null)}updateNeeded(o,f){return(!this.textureDescriptor||this.textureDescriptor.band!==f||this.textureDescriptor.layer!==o)&&this.state!=="errored"}updateTextureDescriptor(o,f){if(!this._mrt)return;const y=this._mrt.getLayer(o);if(!y||!y.hasBand(f)||!y.hasDataForBand(f))return;const{bytes:w,tileSize:E,buffer:C,offset:M,scale:N}=y.getBandView(f),j=E+2*C,H=new s.r({width:j,height:j},w),Z=this.texture;Z&&Z instanceof s.T&&Z.update(H,{premultiply:!1}),this.textureDescriptor={layer:o,band:f,img:H,buffer:C,offset:M,tileSize:E,format:y.pixelFormat,mix:[N,256*N,65536*N,16777216*N]}}}class bp{constructor(o,f){this.max=o,this.onRemove=f,this.reset()}reset(){for(const o in this.data)for(const f of this.data[o])f.timeout&&clearTimeout(f.timeout),this.onRemove(f.value);return this.data={},this.order=[],this}add(o,f,y){const w=o.wrapped().key;this.data[w]===void 0&&(this.data[w]=[]);const E={value:f,timeout:void 0};if(y!==void 0&&(E.timeout=setTimeout(()=>{this.remove(o,E)},y)),this.data[w].push(E),this.order.push(w),this.order.length>this.max){const C=this._getAndRemoveByKey(this.order[0]);C&&this.onRemove(C)}return this}has(o){return o.wrapped().key in this.data}getAndRemove(o){return this.has(o)?this._getAndRemoveByKey(o.wrapped().key):null}_getAndRemoveByKey(o){const f=this.data[o].shift();return f.timeout&&clearTimeout(f.timeout),this.data[o].length===0&&delete this.data[o],this.order.splice(this.order.indexOf(o),1),f.value}getByKey(o){const f=this.data[o];return f?f[0].value:null}get(o){return this.has(o)?this.data[o.wrapped().key][0].value:null}remove(o,f){if(!this.has(o))return this;const y=o.wrapped().key,w=f===void 0?0:this.data[y].indexOf(f),E=this.data[y][w];return this.data[y].splice(w,1),E.timeout&&clearTimeout(E.timeout),this.data[y].length===0&&delete this.data[y],this.onRemove(E.value),this.order.splice(this.order.indexOf(y),1),this}setMaxSize(o){for(this.max=o;this.order.length>this.max;){const f=this._getAndRemoveByKey(this.order[0]);f&&this.onRemove(f)}return this}filter(o){const f=[];for(const y in this.data)for(const w of this.data[y])o(w.value)||f.push(w);for(const y of f)this.remove(y.value.tileID,y)}}class xp{constructor(){this.state={},this.stateChanges={},this.deletedStates={}}updateState(o,f,y){const w=String(f);if(this.stateChanges[o]=this.stateChanges[o]||{},this.stateChanges[o][w]=this.stateChanges[o][w]||{},s.h(this.stateChanges[o][w],y),this.deletedStates[o]===null){this.deletedStates[o]={};for(const E in this.state[o])E!==w&&(this.deletedStates[o][E]=null)}else if(this.deletedStates[o]&&this.deletedStates[o][w]===null){this.deletedStates[o][w]={};for(const E in this.state[o][w])y[E]||(this.deletedStates[o][w][E]=null)}else for(const E in y)this.deletedStates[o]&&this.deletedStates[o][w]&&this.deletedStates[o][w][E]===null&&delete this.deletedStates[o][w][E]}removeFeatureState(o,f,y){if(this.deletedStates[o]===null)return;const w=String(f);if(this.deletedStates[o]=this.deletedStates[o]||{},y&&f!==void 0)this.deletedStates[o][w]!==null&&(this.deletedStates[o][w]=this.deletedStates[o][w]||{},this.deletedStates[o][w][y]=null);else if(f!==void 0)if(this.stateChanges[o]&&this.stateChanges[o][w])for(y in this.deletedStates[o][w]={},this.stateChanges[o][w])this.deletedStates[o][w][y]=null;else this.deletedStates[o][w]=null;else this.deletedStates[o]=null}getState(o,f){const y=this.state[o]||{},w=this.stateChanges[o]||{},E=this.deletedStates[o];if(E===null)return{};if(f!==void 0){const M=String(f),N=s.h({},y[M],w[M]);if(E){const j=E[f];if(j===null)return{};for(const H in j)delete N[H]}return N}const C=s.h({},y,w);if(E)for(const M in E)delete C[M];return C}initializeTileState(o,f){o.refreshFeatureState(f)}coalesceChanges(o,f){const y={};for(const w in this.stateChanges){this.state[w]=this.state[w]||{};const E={};for(const C in this.stateChanges[w])this.state[w][C]||(this.state[w][C]={}),s.h(this.state[w][C],this.stateChanges[w][C]),E[C]=this.state[w][C];y[w]=E}for(const w in this.deletedStates){this.state[w]=this.state[w]||{};const E={};if(this.deletedStates[w]===null)for(const C in this.state[w])E[C]={},this.state[w][C]={};else for(const C in this.deletedStates[w]){if(this.deletedStates[w][C]===null)this.state[w][C]={};else if(this.state[w][C])for(const M of Object.keys(this.deletedStates[w][C]))delete this.state[w][C][M];E[C]=this.state[w][C]}y[w]=y[w]||{},s.h(y[w],E)}if(this.stateChanges={},this.deletedStates={},Object.keys(y).length!==0)for(const w in o)o[w].refreshFeatureState(f)}}class Bs extends s.E{constructor(o,f,y){super(),this.id=o,this._onlySymbols=y,f.on("data",w=>{w.dataType==="source"&&w.sourceDataType==="metadata"&&(this._sourceLoaded=!0),this._sourceLoaded&&!this._paused&&w.dataType==="source"&&w.sourceDataType==="content"&&(this.reload(),this.transform&&this.update(this.transform))}),f.on("error",()=>{this._sourceErrored=!0}),this._source=f,this._tiles={},this._cache=new bp(0,this._unloadTile.bind(this)),this._timers={},this._cacheTimers={},this._minTileCacheSize=f.minTileCacheSize,this._maxTileCacheSize=f.maxTileCacheSize,this._loadedParentTiles={},this.castsShadows=!1,this.tileCoverLift=0,this._coveredTiles={},this._shadowCasterTiles={},this._state=new xp,this._isRaster=this._source.type==="raster"||this._source.type==="raster-dem"||this._source.type==="raster-array"||this._source.type==="custom"&&this._source._dataType==="raster"}onAdd(o){this.map=o,this._minTileCacheSize=this._minTileCacheSize===void 0&&o?o._minTileCacheSize:this._minTileCacheSize,this._maxTileCacheSize=this._maxTileCacheSize===void 0&&o?o._maxTileCacheSize:this._maxTileCacheSize}loaded(){if(this._sourceErrored)return!0;if(!this._sourceLoaded||!this._source.loaded())return!1;for(const o in this._tiles)if(!this._tiles[o].loaded())return!1;return!0}getSource(){return this._source}pause(){this._paused=!0}resume(){if(!this._paused)return;const o=this._shouldReloadOnResume;this._paused=!1,this._shouldReloadOnResume=!1,o&&this.reload(),this.transform&&this.update(this.transform)}_loadTile(o,f){return o.isSymbolTile=this._onlySymbols,o.isExtraShadowCaster=this._shadowCasterTiles[o.tileID.key],this._source.loadTile(o,f)}_unloadTile(o){if(this._source.unloadTile)return this._source.unloadTile(o)}_abortTile(o){if(this._source.abortTile)return this._source.abortTile(o)}serialize(){return this._source.serialize()}prepare(o){this._source.prepare&&this._source.prepare(),this._state.coalesceChanges(this._tiles,this.map?this.map.painter:null);for(const f in this._tiles){const y=this._tiles[f];y.upload(o),y.prepare(this.map.style.imageManager,this.map?this.map.painter:null,this._source.scope)}}getIds(){return Object.values(this._tiles).map(o=>o.tileID).sort(ia).map(o=>o.key)}getRenderableIds(o,f){const y=[];for(const w in this._tiles)this._isIdRenderable(+w,o,f)&&y.push(this._tiles[w]);return o?y.sort((w,E)=>{const C=w.tileID,M=E.tileID,N=new s.P(C.canonical.x,C.canonical.y)._rotate(this.transform.angle),j=new s.P(M.canonical.x,M.canonical.y)._rotate(this.transform.angle);return C.overscaledZ-M.overscaledZ||j.y-N.y||j.x-N.x}).map(w=>w.tileID.key):y.map(w=>w.tileID).sort(ia).map(w=>w.key)}hasRenderableParent(o){const f=this.findLoadedParent(o,0);return!!f&&this._isIdRenderable(f.tileID.key)}_isIdRenderable(o,f,y){return this._tiles[o]&&this._tiles[o].hasData()&&!this._coveredTiles[o]&&(f||!this._tiles[o].holdingForFade())&&(y||!this._shadowCasterTiles[o])}reload(){if(this._paused)this._shouldReloadOnResume=!0;else{this._cache.reset();for(const o in this._tiles)this._tiles[o].state!=="errored"&&this._reloadTile(+o,"reloading")}}_reloadTile(o,f){const y=this._tiles[o];y&&(y.state!=="loading"&&(y.state=f),this._loadTile(y,this._tileLoaded.bind(this,y,o,f)))}_tileLoaded(o,f,y,w){if(w)if(o.state="errored",w.status!==404)this._source.fire(new s.z(w,{tile:o}));else{if(this._source.fire(new s.A("data",{dataType:"source",sourceDataType:"error",sourceId:this._source.id,tile:o})),!(o.tileID.key in this._loadedParentTiles))return;if(this._source.type==="raster-dem"&&this.usedForTerrain&&this.map.painter.terrain){const E=this.map.painter.terrain;this.update(this.transform,E.getScaledDemTileSize(),!0),E.resetTileLookupCache(this.id)}else this.update(this.transform)}else o.timeAdded=s.q.now(),y==="expired"&&(o.refreshedUponExpiration=!0),this._setTileReloadTimer(f,o),this._source.type==="raster-dem"&&o.dem&&this._backfillDEM(o),this._state.initializeTileState(o,this.map?this.map.painter:null),this._source.fire(new s.A("data",{dataType:"source",tile:o,coord:o.tileID,sourceCacheId:this.id}))}_backfillDEM(o){const f=this.getRenderableIds();for(let w=0;w<f.length;w++){const E=f[w];if(o.neighboringTiles&&o.neighboringTiles[E]){const C=this.getTileByID(E);y(o,C),y(C,o)}}function y(w,E){if(!w.dem||w.dem.borderReady)return;w.needsHillshadePrepare=!0,w.needsDEMTextureUpload=!0;let C=E.tileID.canonical.x-w.tileID.canonical.x;const M=E.tileID.canonical.y-w.tileID.canonical.y,N=Math.pow(2,w.tileID.canonical.z),j=E.tileID.key;C===0&&M===0||Math.abs(M)>1||(Math.abs(C)>1&&(Math.abs(C+N)===1?C+=N:Math.abs(C-N)===1&&(C-=N)),E.dem&&w.dem&&(w.dem.backfillBorder(E.dem,C,M),w.neighboringTiles&&w.neighboringTiles[j]&&(w.neighboringTiles[j].backfilled=!0)))}}getTile(o){return this.getTileByID(o.key)}getTileByID(o){return this._tiles[o]}_retainLoadedChildren(o,f,y,w){for(const E in this._tiles){let C=this._tiles[E];if(w[E]||!C.hasData()||C.tileID.overscaledZ<=f||C.tileID.overscaledZ>y)continue;let M=C.tileID;for(;C&&C.tileID.overscaledZ>f+1;){const j=C.tileID.scaledTo(C.tileID.overscaledZ-1);C=this._tiles[j.key],C&&C.hasData()&&(M=j)}let N=M;for(;N.overscaledZ>f;)if(N=N.scaledTo(N.overscaledZ-1),o[N.key]){w[M.key]=M;break}}}findLoadedParent(o,f){if(o.key in this._loadedParentTiles){const y=this._loadedParentTiles[o.key];return y&&y.tileID.overscaledZ>=f?y:null}for(let y=o.overscaledZ-1;y>=f;y--){const w=o.scaledTo(y),E=this._getLoadedTile(w);if(E)return E}}_getLoadedTile(o){const f=this._tiles[o.key];return f&&f.hasData()?f:this._cache.getByKey(this._source.reparseOverscaled?o.wrapped().key:o.canonical.key)}updateCacheSize(o,f){f=f||this._source.tileSize;const y=Math.ceil(o.width/f)+1,w=Math.ceil(o.height/f)+1,E=Math.floor(y*w*5),C=typeof this._minTileCacheSize=="number"?Math.max(this._minTileCacheSize,E):E,M=typeof this._maxTileCacheSize=="number"?Math.min(this._maxTileCacheSize,C):C;this._cache.setMaxSize(M)}handleWrapJump(o){const f=Math.round((o-(this._prevLng===void 0?o:this._prevLng))/360);if(this._prevLng=o,f){const y={};for(const w in this._tiles){const E=this._tiles[w];E.tileID=E.tileID.unwrapTo(E.tileID.wrap+f),y[E.tileID.key]=E}this._tiles=y;for(const w in this._timers)clearTimeout(this._timers[w]),delete this._timers[w];for(const w in this._tiles)this._setTileReloadTimer(+w,this._tiles[w])}}update(o,f,y,w,E){if(this.transform=o,!this._sourceLoaded||this._paused||this.transform.freezeTileCoverage||this.usedForTerrain&&!y)return;this.updateCacheSize(o,f),this.transform.projection.name!=="globe"&&this.handleWrapJump(this.transform.center.lng),this._shadowCasterTiles={},this._coveredTiles={};const C=this._source.type==="batched-model";let M,N=this._source.maxzoom;const j=this.map&&this.map.painter?this.map.painter._terrain:null;if(j&&j.sourceCache===this&&j.attenuationRange()){const W=j.attenuationRange()[0],Q=Math.floor(W)-Math.log2(j.getDemUpscale());N>Q&&(N=Q)}if(this.used||this.usedForTerrain){if(this._source.tileID)M=o.getVisibleUnwrappedCoordinates(this._source.tileID).map(W=>new s.aM(W.canonical.z,W.wrap,W.canonical.z,W.canonical.x,W.canonical.y));else if(this.tileCoverLift!==0){const W=o.clone();W.tileCoverLift=this.tileCoverLift,M=W.coveringTiles({tileSize:f||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.minzoom<=1&&o.projection.name==="globe"&&(M.push(new s.aM(1,0,1,0,0)),M.push(new s.aM(1,0,1,1,0)),M.push(new s.aM(1,0,1,0,1)),M.push(new s.aM(1,0,1,1,1)))}else if(M=o.coveringTiles({tileSize:f||this._source.tileSize,minzoom:this._source.minzoom,maxzoom:N,roundZoom:this._source.roundZoom&&!y,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain,calculateQuadrantVisibility:C}),this._source.hasTile){const W=this._source.hasTile.bind(this._source);M=M.filter(Q=>W(Q))}}else M=[];if(M.length>0&&this.transform.projection.name!=="globe"&&!this.usedForTerrain&&!Qh(this._source.type)){const W=o.coveringZoomLevel({tileSize:f||this._source.tileSize,roundZoom:this._source.roundZoom&&!y}),Q=Math.min(W,this._source.maxzoom);if(C){const ce=o.extendTileCover(M,Q);for(const se of ce)M.push(se)}else if(E){const ce=o.extendTileCover(M,Q,this.transform._camera.forward());for(const se of ce)M.push(se)}else if(this.castsShadows&&w){const ce=o.extendTileCover(M,Q,w);for(const se of ce)this._shadowCasterTiles[se.key]=!0,M.push(se)}}const H=this._updateRetainedTiles(M);if(Qh(this._source.type)&&M.length!==0){const W={},Q={},ce=Object.keys(H);for(const ue of ce){const pe=H[ue],ge=this._tiles[ue];if(!ge||ge.fadeEndTime&&ge.fadeEndTime<=s.q.now())continue;const Pe=this.findLoadedParent(pe,Math.max(pe.overscaledZ-Bs.maxOverzooming,this._source.minzoom));Pe&&(this._addTile(Pe.tileID),W[Pe.tileID.key]=Pe.tileID),Q[ue]=pe}const se=M[M.length-1].overscaledZ;for(const ue in this._tiles){const pe=this._tiles[ue];if(H[ue]||!pe.hasData())continue;let ge=pe.tileID;for(;ge.overscaledZ>se;){ge=ge.scaledTo(ge.overscaledZ-1);const Pe=this._tiles[ge.key];if(Pe&&Pe.hasData()&&Q[ge.key]){H[ue]=pe.tileID;break}}}for(const ue in W)H[ue]||(this._coveredTiles[ue]=!0,H[ue]=W[ue])}for(const W in H)this._tiles[W].clearFadeHold();const Z=s.bs(this._tiles,H);for(const W of Z){const Q=this._tiles[W];Q.hasSymbolBuckets&&!Q.holdingForFade()?Q.setHoldDuration(this.map._fadeDuration):Q.hasSymbolBuckets&&!Q.symbolFadeFinished()||this._removeTile(+W)}this._updateLoadedParentTileCache(),this._onlySymbols&&this._source.afterUpdate&&this._source.afterUpdate()}releaseSymbolFadeTiles(){for(const o in this._tiles)this._tiles[o].holdingForFade()&&this._removeTile(+o)}_updateRetainedTiles(o){const f={};if(o.length===0)return f;const y={},w=o.reduce((j,H)=>Math.min(j,H.overscaledZ),1/0),E=o[0].overscaledZ,C=Math.max(E-Bs.maxOverzooming,this._source.minzoom),M=Math.max(E+Bs.maxUnderzooming,this._source.minzoom),N={};for(const j of o){const H=this._addTile(j);f[j.key]=j,H.hasData()||w<this._source.maxzoom&&(N[j.key]=j)}this._retainLoadedChildren(N,w,M,f);for(const j of o){let H=this._tiles[j.key];if(H.hasData())continue;if(j.canonical.z>=this._source.maxzoom){const W=j.children(this._source.maxzoom)[0],Q=this.getTile(W);if(Q&&Q.hasData()){f[W.key]=W;continue}}else{const W=j.children(this._source.maxzoom);if(f[W[0].key]&&f[W[1].key]&&f[W[2].key]&&f[W[3].key])continue}let Z=H.wasRequested();for(let W=j.overscaledZ-1;W>=C;--W){const Q=j.scaledTo(W);if(y[Q.key]||(y[Q.key]=!0,H=this.getTile(Q),!H&&Z&&(H=this._addTile(Q)),H&&(f[Q.key]=Q,Z=H.wasRequested(),H.hasData())))break}}return f}_updateLoadedParentTileCache(){this._loadedParentTiles={};for(const o in this._tiles){const f=[];let y,w=this._tiles[o].tileID;for(;w.overscaledZ>0;){if(w.key in this._loadedParentTiles){y=this._loadedParentTiles[w.key];break}f.push(w.key);const E=w.scaledTo(w.overscaledZ-1);if(y=this._getLoadedTile(E),y)break;w=E}for(const E of f)this._loadedParentTiles[E]=y}}_addTile(o){let f=this._tiles[o.key];if(f)return f.isExtraShadowCaster!==!0||this._shadowCasterTiles[o.key]||this._reloadTile(o.key,"reloading"),f;f=this._cache.getAndRemove(o),f&&(this._setTileReloadTimer(o.key,f),f.tileID=o,this._state.initializeTileState(f,this.map?this.map.painter:null),this._cacheTimers[o.key]&&(clearTimeout(this._cacheTimers[o.key]),delete this._cacheTimers[o.key],this._setTileReloadTimer(o.key,f)));const y=!!f;if(!y){const w=this.map?this.map.painter:null,E=this._source.tileSize*o.overscaleFactor();f=this._source.type==="raster-array"?new Xh(o,E,this.transform.tileZoom,w,this._isRaster):new Rl(o,E,this.transform.tileZoom,w,this._isRaster,this._source.worldview),this._loadTile(f,this._tileLoaded.bind(this,f,o.key,f.state))}return f.uses++,this._tiles[o.key]=f,y||this._source.fire(new s.A("dataloading",{tile:f,coord:f.tileID,dataType:"source"})),f}_setTileReloadTimer(o,f){o in this._timers&&(clearTimeout(this._timers[o]),delete this._timers[o]);const y=f.getExpiryTimeout();y&&(this._timers[o]=setTimeout(()=>{this._reloadTile(o,"expired"),delete this._timers[o]},y))}_removeTile(o){const f=this._tiles[o];f&&(f.uses--,delete this._tiles[o],this._timers[o]&&(clearTimeout(this._timers[o]),delete this._timers[o]),f.uses>0||(f.hasData()&&f.state!=="reloading"||f.state==="empty"?this._cache.add(f.tileID,f,f.getExpiryTimeout()):(f.aborted=!0,this._abortTile(f),this._unloadTile(f))))}clearTiles(){this._shouldReloadOnResume=!1,this._paused=!1;for(const o in this._tiles)this._removeTile(+o);this._source._clear&&this._source._clear(),this._cache.reset(),this.map&&this.usedForTerrain&&this.map.painter.terrain&&this.map.painter.terrain.resetTileLookupCache(this.id)}tilesIn(o,f,y){const w=[],E=this.transform;if(!E)return w;const C=E.projection.name==="globe",M=s.aD(E.center.lng);for(const N in this._tiles){const j=this._tiles[N];if(y&&j.clearQueryDebugViz(),j.holdingForFade())continue;let H;if(C){const Z=j.tileID.canonical;if(Z.z===0){const W=[Math.abs(s.ay(M,...Ku(Z,-1))-M),Math.abs(s.ay(M,...Ku(Z,1))-M)];H=[0,2*W.indexOf(Math.min(...W))-1]}else{const W=[Math.abs(s.ay(M,...Ku(Z,-1))-M),Math.abs(s.ay(M,...Ku(Z,0))-M),Math.abs(s.ay(M,...Ku(Z,1))-M)];H=[W.indexOf(Math.min(...W))-1]}}else H=[0];for(const Z of H){const W=o.containsTile(j,E,f,Z);W&&w.push(W)}}return w}getShadowCasterCoordinates(){return this._getRenderableCoordinates(!1,!0)}getVisibleCoordinates(o){return this._getRenderableCoordinates(o)}_getRenderableCoordinates(o,f){const y=this.getRenderableIds(o,f).map(E=>this._tiles[E].tileID),w=this.transform.projection.name==="globe";for(const E of y)E.projMatrix=this.transform.calculateProjMatrix(E.toUnwrapped()),E.expandedProjMatrix=w?this.transform.calculateProjMatrix(E.toUnwrapped(),!1,!0):E.projMatrix;return y}sortCoordinatesByDistance(o){const f=o.slice(),y=this.transform._camera.position,w=this.transform._camera.forward(),E={};for(const C of f){const M=1/(1<<C.canonical.z);E[C.key]=((C.canonical.x+.5)*M+C.wrap-y[0])*w[0]+((C.canonical.y+.5)*M-y[1])*w[1]-y[2]*w[2]}return f.sort((C,M)=>E[C.key]-E[M.key]),f}hasTransition(){if(this._source.hasTransition())return!0;if(Qh(this._source.type))for(const o in this._tiles){const f=this._tiles[o];if(f.fadeEndTime!==void 0&&f.fadeEndTime>=s.q.now())return!0}return!1}setFeatureState(o,f,y){this._state.updateState(o=o||"_geojsonTileLayer",f,y)}removeFeatureState(o,f,y){this._state.removeFeatureState(o=o||"_geojsonTileLayer",f,y)}getFeatureState(o,f){return this._state.getState(o=o||"_geojsonTileLayer",f)}setDependencies(o,f,y){const w=this._tiles[o];w&&w.setDependencies(f,y)}reloadTilesForDependencies(o,f){for(const y in this._tiles)this._tiles[y].hasDependency(o,f)&&this._reloadTile(+y,"reloading");this._cache.filter(y=>!y.hasDependency(o,f))}_preloadTiles(o,f){if(!this._sourceLoaded){const N=()=>{this._sourceLoaded&&(this._source.off("data",N),this._preloadTiles(o,f))};return void this._source.on("data",N)}const y=new Map,w=Array.isArray(o)?o:[o],E=this.map.painter.terrain,C=this.usedForTerrain&&E?E.getScaledDemTileSize():this._source.tileSize;for(const N of w){const j=N.coveringTiles({tileSize:C,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom&&!this.usedForTerrain,reparseOverscaled:this._source.reparseOverscaled,isTerrainDEM:this.usedForTerrain});for(const H of j)y.set(H.key,H);this.usedForTerrain&&N.updateElevation(!1)}const M=Array.from(y.values());s.bt(M,(N,j)=>{const H=new Rl(N,this._source.tileSize*N.overscaleFactor(),this.transform.tileZoom,this.map.painter,this._isRaster,this._source.worldview);this._loadTile(H,Z=>{this._source.type==="raster-dem"&&H.dem&&this._backfillDEM(H),j(Z,H)})},f)}}function ia(_,o){const f=Math.abs(2*_.wrap)-+(_.wrap<0),y=Math.abs(2*o.wrap)-+(o.wrap<0);return _.overscaledZ-o.overscaledZ||y-f||o.canonical.y-_.canonical.y||o.canonical.x-_.canonical.x}function Qh(_){return _==="raster"||_==="image"||_==="video"||_==="custom"}function Ku(_,o){const f=1<<_.z;return[_.x/f+o,(_.x+1)/f+o]}Bs.maxOverzooming=10,Bs.maxUnderzooming=3;class Qm{constructor(o){this.style=o,this.layersGotHidden=!1,this.layers=[]}processLayersChanged(){this.layers=[];const o=!1,f=!1;for(const y in this.style._mergedLayers){const w=this.style._mergedLayers[y];if(w.type==="fill-extrusion"||w.type==="building")this.layers.push({layer:w,visible:o,visibilityChanged:f});else if(w.type==="model"){const E=this.style.getLayerSource(w);E&&E.type==="batched-model"&&this.layers.push({layer:w,visible:o,visibilityChanged:f})}}}onNewFrame(o){this.layersGotHidden=!1;for(const f of this.layers){const y=f.layer;let w=!1;y.type==="fill-extrusion"?w=!y.isHidden(o)&&y.paint.get("fill-extrusion-opacity")>0:y.type==="building"?w=!y.isHidden(o)&&y.paint.get("building-opacity")>0:y.type==="model"&&(w=!y.isHidden(o)&&y.paint.get("model-opacity").constantOr(1)>0),this.layersGotHidden=this.layersGotHidden||!w&&f.visible,f.visible=w}}updateZOffset(o,f){this.currentBuildingBuckets=[];for(const w of this.layers){const E=w.layer,C=this.style.getLayerSourceCache(E);let M=1;E.type==="fill-extrusion"?M=w.visible?E.paint.get("fill-extrusion-vertical-scale"):0:E.type==="building"&&(M=w.visible?E.paint.get("building-vertical-scale"):0);let N=C?C.getTile(f):null;if(!N&&C&&f.canonical.z>C.getSource().minzoom){let j=f.scaledTo(Math.min(C.getSource().maxzoom,f.overscaledZ-1));for(;j.overscaledZ>=C.getSource().minzoom&&(N=C.getTile(j),!N&&j.overscaledZ!==0);)j=j.scaledTo(j.overscaledZ-1)}this.currentBuildingBuckets.push({bucket:N?N.getBucket(E):null,tileID:N?N.tileID:f,verticalScale:M})}o.hasAnyZOffset=!1;let y=!1;for(let w=0;w<o.symbolInstances.length;w++){const E=o.symbolInstances.get(w),C=E.zOffset,M=this._getHeightAtTileOffset(f,E.tileAnchorX,E.tileAnchorY);E.zOffset=M!==Number.NEGATIVE_INFINITY?M:C,y||C===E.zOffset||(y=!0),o.hasAnyZOffset||E.zOffset===0||(o.hasAnyZOffset=!0)}y&&(o.zOffsetBuffersNeedUpload=!0,o.zOffsetSortDirty=!0)}_mapCoordToOverlappingTile(o,f,y,w){let E=f,C=y;if(o.canonical.z!==w.canonical.z){const M=w.canonical,N=1/(1<<o.canonical.z-M.z);E=(f+o.canonical.x*s.aj)*N-M.x*s.aj|0,C=(y+o.canonical.y*s.aj)*N-M.y*s.aj|0}return{tileX:E,tileY:C}}_getHeightAtTileOffset(o,f,y){let w,E;for(let C=0;C<this.layers.length;++C){const M=this.layers[C].layer;if(M.type!=="fill-extrusion"&&M.type!=="building")continue;const{bucket:N,tileID:j,verticalScale:H}=this.currentBuildingBuckets[C];if(!N)continue;const{tileX:Z,tileY:W}=this._mapCoordToOverlappingTile(o,f,y,j),Q=N.getHeightAtTileCoord(Z,W);Q&&Q.height!==void 0&&(Q.hidden?w=Q.height:E=Math.max(Q.height*H,E||0))}if(E!==void 0)return E;for(let C=0;C<this.layers.length;++C){const M=this.layers[C];if(M.layer.type!=="model"||!M.visible)continue;const{bucket:N,tileID:j}=this.currentBuildingBuckets[C];if(!N)continue;const{tileX:H,tileY:Z}=this._mapCoordToOverlappingTile(o,f,y,j),W=N.getHeightAtTileCoord(H,Z);if(W&&!W.hidden)return W.height===void 0&&w!==void 0?Math.min(W.maxHeight,w)*W.verticalScale:W.height?W.height*W.verticalScale:Number.NEGATIVE_INFINITY}return this.layersGotHidden?0:Number.NEGATIVE_INFINITY}}function Ju(_,o){const f={};for(const y in _)y!=="ref"&&(f[y]=_[y]);return s.bu.forEach(y=>{y in o&&(f[y]=o[y])}),f}function Gc(_){_=_.slice();const o=Object.create(null);for(let f=0;f<_.length;f++)o[_[f].id]=_[f];for(let f=0;f<_.length;f++)"ref"in _[f]&&(_[f]=Ju(_[f],o[_[f].ref]));return _}const Si={setStyle:"setStyle",addLayer:"addLayer",removeLayer:"removeLayer",setPaintProperty:"setPaintProperty",setLayoutProperty:"setLayoutProperty",setSlot:"setSlot",setFilter:"setFilter",addSource:"addSource",removeSource:"removeSource",setGeoJSONSourceData:"setGeoJSONSourceData",setLayerZoomRange:"setLayerZoomRange",setLayerProperty:"setLayerProperty",setCenter:"setCenter",setZoom:"setZoom",setBearing:"setBearing",setPitch:"setPitch",setSprite:"setSprite",setGlyphs:"setGlyphs",setTransition:"setTransition",setLight:"setLight",setTerrain:"setTerrain",setFog:"setFog",setSnow:"setSnow",setRain:"setRain",setCamera:"setCamera",setLights:"setLights",setProjection:"setProjection",addImport:"addImport",removeImport:"removeImport",updateImport:"updateImport",addIconset:"addIconset",removeIconset:"removeIconset"};function uf(_,o,f){f.push({command:Si.addSource,args:[_,o[_]]})}function va(_,o,f){o.push({command:Si.removeSource,args:[_]}),f[_]=!0}function qc(_,o,f,y){va(_,f,y),uf(_,o,f)}function B_(_,o,f){let y;for(y in _[f])if(_[f].hasOwnProperty(y)&&y!=="data"&&!s.bv(_[f][y],o[f][y]))return!1;for(y in o[f])if(o[f].hasOwnProperty(y)&&y!=="data"&&!s.bv(_[f][y],o[f][y]))return!1;return!0}function Ol(_,o,f,y,w,E){let C;for(C in o=o||{},_=_||{})_.hasOwnProperty(C)&&(s.bv(_[C],o[C])||f.push({command:E,args:[y,C,o[C],w]}));for(C in o)o.hasOwnProperty(C)&&!_.hasOwnProperty(C)&&(s.bv(_[C],o[C])||f.push({command:E,args:[y,C,o[C],w]}))}function Ga(_){return _.id}function tc(_,o){return _[o.id]=o,_}class so{constructor(o,f){this.reset(o,f)}reset(o,f){this.points=o||[],this._distances=[0];for(let y=1;y<this.points.length;y++)this._distances[y]=this._distances[y-1]+this.points[y].dist(this.points[y-1]);this.length=this._distances[this._distances.length-1],this.padding=Math.min(f||0,.5*this.length),this.paddedLength=this.length-2*this.padding}lerp(o){if(this.points.length===1)return this.points[0];o=s.ay(o,0,1);let f=1,y=this._distances[f];const w=o*this.paddedLength+this.padding;for(;y<w&&f<this._distances.length;)y=this._distances[++f];const E=f-1,C=this._distances[E],M=y-C,N=M>0?(w-C)/M:0;return this.points[E].mult(1-N).add(this.points[f].mult(N))}}class eh{constructor(o,f,y){const w=this.boxCells=[],E=this.circleCells=[];this.xCellCount=Math.ceil(o/y),this.yCellCount=Math.ceil(f/y);for(let C=0;C<this.xCellCount*this.yCellCount;C++)w.push([]),E.push([]);this.circleKeys=[],this.boxKeys=[],this.bboxes=[],this.circles=[],this.width=o,this.height=f,this.xScale=this.xCellCount/o,this.yScale=this.yCellCount/f,this.boxUid=0,this.circleUid=0}keysLength(){return this.boxKeys.length+this.circleKeys.length}insert(o,f,y,w,E){this._forEachCell(f,y,w,E,this._insertBoxCell,this.boxUid++),this.boxKeys.push(o),this.bboxes.push(f),this.bboxes.push(y),this.bboxes.push(w),this.bboxes.push(E)}insertCircle(o,f,y,w){this._forEachCell(f-w,y-w,f+w,y+w,this._insertCircleCell,this.circleUid++),this.circleKeys.push(o),this.circles.push(f),this.circles.push(y),this.circles.push(w)}_insertBoxCell(o,f,y,w,E,C){this.boxCells[E].push(C)}_insertCircleCell(o,f,y,w,E,C){this.circleCells[E].push(C)}_query(o,f,y,w,E,C){if(y<0||o>this.width||w<0||f>this.height)return!E&&[];const M=[];if(o<=0&&f<=0&&this.width<=y&&this.height<=w){if(E)return!0;for(let N=0;N<this.boxKeys.length;N++)M.push({key:this.boxKeys[N],x1:this.bboxes[4*N],y1:this.bboxes[4*N+1],x2:this.bboxes[4*N+2],y2:this.bboxes[4*N+3]});for(let N=0;N<this.circleKeys.length;N++){const j=this.circles[3*N],H=this.circles[3*N+1],Z=this.circles[3*N+2];M.push({key:this.circleKeys[N],x1:j-Z,y1:H-Z,x2:j+Z,y2:H+Z})}return C?M.filter(C):M}return this._forEachCell(o,f,y,w,this._queryCell,M,{hitTest:E,seenUids:{box:{},circle:{}}},C),E?M.length>0:M}_queryCircle(o,f,y,w,E){const C=o-y,M=o+y,N=f-y,j=f+y;if(M<0||C>this.width||j<0||N>this.height)return!w&&[];const H=[];return this._forEachCell(C,N,M,j,this._queryCellCircle,H,{hitTest:w,circle:{x:o,y:f,radius:y},seenUids:{box:{},circle:{}}},E),w?H.length>0:H}query(o,f,y,w,E){return this._query(o,f,y,w,!1,E)}hitTest(o,f,y,w,E){return this._query(o,f,y,w,!0,E)}hitTestCircle(o,f,y,w){return this._queryCircle(o,f,y,!0,w)}_queryCell(o,f,y,w,E,C,M,N){const j=M.seenUids,H=this.boxCells[E];if(H!==null){const W=this.bboxes;for(const Q of H)if(!j.box[Q]){j.box[Q]=!0;const ce=4*Q;if(o<=W[ce+2]&&f<=W[ce+3]&&y>=W[ce+0]&&w>=W[ce+1]&&(!N||N(this.boxKeys[Q]))){if(M.hitTest)return C.push(!0),!0;C.push({key:this.boxKeys[Q],x1:W[ce],y1:W[ce+1],x2:W[ce+2],y2:W[ce+3]})}}}const Z=this.circleCells[E];if(Z!==null){const W=this.circles;for(const Q of Z)if(!j.circle[Q]){j.circle[Q]=!0;const ce=3*Q;if(this._circleAndRectCollide(W[ce],W[ce+1],W[ce+2],o,f,y,w)&&(!N||N(this.circleKeys[Q]))){if(M.hitTest)return C.push(!0),!0;{const se=W[ce],ue=W[ce+1],pe=W[ce+2];C.push({key:this.circleKeys[Q],x1:se-pe,y1:ue-pe,x2:se+pe,y2:ue+pe})}}}}}_queryCellCircle(o,f,y,w,E,C,M,N){const j=M.circle,H=M.seenUids,Z=this.boxCells[E];if(Z!==null){const Q=this.bboxes;for(const ce of Z)if(!H.box[ce]){H.box[ce]=!0;const se=4*ce;if(this._circleAndRectCollide(j.x,j.y,j.radius,Q[se+0],Q[se+1],Q[se+2],Q[se+3])&&(!N||N(this.boxKeys[ce])))return C.push(!0),!0}}const W=this.circleCells[E];if(W!==null){const Q=this.circles;for(const ce of W)if(!H.circle[ce]){H.circle[ce]=!0;const se=3*ce;if(this._circlesCollide(Q[se],Q[se+1],Q[se+2],j.x,j.y,j.radius)&&(!N||N(this.circleKeys[ce])))return C.push(!0),!0}}}_forEachCell(o,f,y,w,E,C,M,N){const j=this._convertToXCellCoord(o),H=this._convertToYCellCoord(f),Z=this._convertToXCellCoord(y),W=this._convertToYCellCoord(w);for(let Q=j;Q<=Z;Q++)for(let ce=H;ce<=W;ce++)if(E.call(this,o,f,y,w,this.xCellCount*ce+Q,C,M,N))return}_convertToXCellCoord(o){return Math.max(0,Math.min(this.xCellCount-1,Math.floor(o*this.xScale)))}_convertToYCellCoord(o){return Math.max(0,Math.min(this.yCellCount-1,Math.floor(o*this.yScale)))}_circlesCollide(o,f,y,w,E,C){const M=w-o,N=E-f,j=y+C;return j*j>M*M+N*N}_circleAndRectCollide(o,f,y,w,E,C,M){const N=(C-w)/2,j=Math.abs(o-(w+N));if(j>N+y)return!1;const H=(M-E)/2,Z=Math.abs(f-(E+H));if(Z>H+y)return!1;if(j<=N||Z<=H)return!0;const W=j-N,Q=Z-H;return W*W+Q*Q<=y*y}}const nc={unknown:0,flipRequired:1,flipNotRequired:2},hf=Math.tan(85*Math.PI/180);function Gr(_,o,f,y,w,E,C){const M=s.bz();if(f)if(E.name==="globe"){const N=s.bA(w,o);s.az(M,M,N)}else{const N=s.bB([],C);M[0]=N[0],M[1]=N[1],M[4]=N[2],M[5]=N[3],y||s.by(M,M,w.angle)}else s.az(M,w.labelPlaneMatrix,_);return M}function wp(_,o,f,y,w,E,C){const M=Gr(_,o,f,y,w,E,C);return E.name==="globe"&&f||(M[2]=M[6]=M[10]=M[14]=0),M}function Tp(_,o,f,y,w,E,C){if(f){if(E.name==="globe"){const M=Gr(_,o,f,y,w,E,C);return s.bi(M,M),s.az(M,_,M),M}{const M=s.bw(_),N=s.bx([]);return N[0]=C[0],N[1]=C[1],N[4]=C[2],N[5]=C[3],s.az(M,M,N),y||s.by(M,M,-w.angle),M}}return w.glCoordMatrix}function qa(_,o,f,y){const w=[_,o,f,1];f?s.aA(w,w,y):Mi(w,w,y);const E=w[3];return w[0]/=E,w[1]/=E,w[2]/=E,w}function Kh(_,o){return Math.min(.5+_/o*.5,1.5)}function Wc(_,o){const f=_[0]/_[3],y=_[1]/_[3];return f>=-o[0]&&f<=o[0]&&y>=-o[1]&&y<=o[1]}function th(_,o,f,y,w,E,C,M,N,j){const H=f.transform,Z=y?_.textSizeData:_.iconSizeData,W=s.bH(Z,f.transform.zoom),Q=H.projection.name==="globe",ce=[256/f.width*2+1,256/f.height*2+1],se=y?_.text.dynamicLayoutVertexArray:_.icon.dynamicLayoutVertexArray;se.clear();let ue=null;Q&&(ue=y?_.text.globeExtVertexArray:_.icon.globeExtVertexArray);const pe=_.lineVertexArray,ge=y?_.text.placedSymbolArray:_.icon.placedSymbolArray,Pe=f.transform.width/f.transform.height;let Ve,Ye=!1;for(let qe=0;qe<ge.length;qe++){const je=ge.get(qe),{numGlyphs:Ue,writingMode:We}=je;if(We!==s.bI.vertical||Ye||Ve===s.bI.horizontal||(Ye=!0),Ve=We,(je.hidden||We===s.bI.vertical)&&!Ye){Zc(Ue,se);continue}Ye=!1;const et=new s.P(je.tileAnchorX,je.tileAnchorY);let{x:_t,y:ft,z:Mt}=H.projection.projectTilePoint(et.x,et.y,j.canonical);if(N){const[bn,fn,pn]=N(et);_t+=bn,ft+=fn,Mt+=pn}const Rt=[_t,ft,Mt,1];if(s.aA(Rt,Rt,o),!Wc(Rt,ce)){Zc(Ue,se);continue}const jt=Rt[3],ht=Kh(f.transform.getCameraToCenterDistance(H.projection),jt),Dt=s.bJ(Z,W,je),ot=C?Dt/ht:Dt*ht,At=qa(_t,ft,Mt,w);if(At[3]<=0){Zc(Ue,se);continue}let Tt={};const Nt=s.al(_.layers[0].layout.get("text-max-angle")),Yt=Math.cos(Nt),Pt=C?null:N,qt=Yc(je,ot,!1,M,o,w,E,_.glyphOffsetArray,pe,se,ue,At,et,Tt,Pe,Pt,H.projection,j,C,Yt);Ye=qt.useVertical,Pt&&qt.needsFlipping&&(Tt={}),(qt.notEnoughRoom||Ye||qt.needsFlipping&&Yc(je,ot,!0,M,o,w,E,_.glyphOffsetArray,pe,se,ue,At,et,Tt,Pe,Pt,H.projection,j,C,Yt).notEnoughRoom)&&Zc(Ue,se)}y?(_.text.dynamicLayoutVertexBuffer.updateData(se),ue&&_.text.globeExtVertexBuffer&&_.text.globeExtVertexBuffer.updateData(ue)):(_.icon.dynamicLayoutVertexBuffer.updateData(se),ue&&_.icon.globeExtVertexBuffer&&_.icon.globeExtVertexBuffer.updateData(ue))}function nh(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue){const{lineStartIndex:pe,glyphStartIndex:ge,segment:Pe}=M,Ve=ge+M.numGlyphs,Ye=pe+M.lineLength,qe=o.getoffsetX(ge),je=o.getoffsetX(Ve-1),Ue=rh(_*qe,f,y,w,E,C,Pe,pe,Ye,N,j,H,Z,W,!0,Q,ce,se,ue);if(!Ue)return null;const We=rh(_*je,f,y,w,E,C,Pe,pe,Ye,N,j,H,Z,W,!0,Q,ce,se,ue);return We?{first:Ue,last:We}:null}function Wa(_,o,f,y){return _===s.bI.horizontal&&Math.abs(y)>Math.abs(f)?{useVertical:!0}:_===s.bI.vertical?y>0?{needsFlipping:!0}:null:o!==nc.unknown&&function(w,E){return w===0||Math.abs(E/w)>hf}(f,y)?o===nc.flipRequired?{needsFlipping:!0}:null:f<0?{needsFlipping:!0}:null}function Yc(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge,Pe){const Ve=o/24,Ye=_.lineOffsetX*Ve,qe=_.lineOffsetY*Ve,{lineStartIndex:je,glyphStartIndex:Ue,numGlyphs:We,segment:et,writingMode:_t,flipState:ft}=_,Mt=je+_.lineLength,Rt=jt=>{if(H){const[At,Tt,Nt]=jt.up,Yt=j.length;s.bK(H,Yt+0,At,Tt,Nt),s.bK(H,Yt+1,At,Tt,Nt),s.bK(H,Yt+2,At,Tt,Nt),s.bK(H,Yt+3,At,Tt,Nt)}const[ht,Dt,ot]=jt.point;s.bL(j,ht,Dt,ot,jt.angle)};if(We>1){const jt=nh(Ve,M,Ye,qe,f,Z,W,_,N,E,Q,se,!1,ue,pe,ge,Pe);if(!jt)return{notEnoughRoom:!0};if(y&&!f){let[ht,Dt,ot]=jt.first.point,[At,Tt,Nt]=jt.last.point;[ht,Dt]=qa(ht,Dt,ot,C),[At,Tt]=qa(At,Tt,Nt,C);const Yt=Wa(_t,ft,(At-ht)*ce,Tt-Dt);if(_.flipState=Yt&&Yt.needsFlipping?nc.flipRequired:nc.flipNotRequired,Yt)return Yt}Rt(jt.first);for(let ht=Ue+1;ht<Ue+We-1;ht++){const Dt=rh(Ve*M.getoffsetX(ht),Ye,qe,f,Z,W,et,je,Mt,N,E,Q,se,!1,!1,ue,pe,ge,Pe);if(!Dt)return j.length-=4*(ht-Ue),{notEnoughRoom:!0};Rt(Dt)}Rt(jt.last)}else{if(y&&!f){const ht=qa(W.x,W.y,0,w),Dt=je+et+1,ot=new s.P(N.getx(Dt),N.gety(Dt)),At=qa(ot.x,ot.y,0,w),Tt=At[3]>0?At:ih(W,ot,ht,1,w,void 0,ue,pe.canonical),Nt=Wa(_t,ft,(Tt[0]-ht[0])*ce,Tt[1]-ht[1]);if(_.flipState=Nt&&Nt.needsFlipping?nc.flipRequired:nc.flipNotRequired,Nt)return Nt}const jt=rh(Ve*M.getoffsetX(Ue),Ye,qe,f,Z,W,et,je,Mt,N,E,Q,se,!1,!1,ue,pe,ge,Pe);if(!jt)return{notEnoughRoom:!0};Rt(jt)}return{}}function ra(_,o,f,y,w){const{x:E,y:C,z:M}=y.projectTilePoint(_.x,_.y,o);if(!w)return qa(E,C,M,f);const[N,j,H]=w(_);return qa(E+N,C+j,M+H,f)}function ih(_,o,f,y,w,E,C,M){const N=ra(_.sub(o)._unit()._add(_),M,w,C,E);return s.at(N,f,N),s.au(N,N),s.bE(N,f,N,y)}function rh(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge){const Pe=y?_-o:_+o;let Ve=Pe>0?1:-1,Ye=0;y&&(Ve*=-1,Ye=Math.PI),Ve<0&&(Ye+=Math.PI);let qe=M+C+(Ve>0?0:1)|0,je=w,Ue=w,We=0,et=0;const _t=Math.abs(Pe),ft=[],Mt=[];let Rt=E,jt=Rt,ht=s.bC([]);const Dt=()=>ih(jt,Rt,Ue,_t-We+1,H,W,se,ue.canonical);for(;We+et<=_t;){if(qe+=Ve,qe<M||qe>=N)return null;if(Ue=je,jt=Rt,ft.push(Ue),Q&&Mt.push(jt),Rt=new s.P(j.getx(qe),j.gety(qe)),je=Z[qe],!je){const pn=ra(Rt,ue.canonical,H,se,W);je=pn[3]>0?Z[qe]=pn:Dt()}We+=et;const bn=s.at([],je,Ue),fn=s.bD(Ue,je);if(f&&fn>0&&et>0&&s.bG(ht,bn)/(et*fn)<ge)return null;et=fn,ht=bn}ce&&W&&(Z[qe]&&(je=Dt(),et=s.bD(Ue,je),ht=s.at([],je,Ue)),Z[qe]=je);const ot=(_t-We)/et,At=Rt.sub(jt)._mult(ot)._add(jt),Tt=s.bE([],Ue,ht,ot);let Nt=[0,0,1],Yt=ht[0],Pt=ht[1];if(pe&&(Nt=se.upVector(ue.canonical,At.x,At.y),Nt[0]!==0||Nt[1]!==0||Nt[2]!==1)){const bn=[Nt[2],0,-Nt[0]],fn=s.bF([],Nt,bn);s.au(bn,bn),s.au(fn,fn),Yt=s.bG(ht,bn),Pt=s.bG(ht,fn)}if(f){const bn=s.bF([],Nt,ht);s.au(bn,bn),s.bE(Tt,Tt,bn,f*Ve)}const qt=Ye+Math.atan2(Pt,Yt);return ft.push(Tt),Q&&Mt.push(At),{point:Tt,angle:qt,path:ft,tilePath:Mt,up:Nt}}function Zc(_,o){const f=o.length,y=f+4*_;o.resize(y),o.float32.fill(-1/0,4*f,4*y)}function Mi(_,o,f){const y=o[0],w=o[1];return _[0]=f[0]*y+f[4]*w+f[12],_[1]=f[1]*y+f[5]*w+f[13],_[3]=f[3]*y+f[7]*w+f[15],_}const cl=100;class Tu{constructor(o,f,y=new eh(o.width+200,o.height+200,25),w=new eh(o.width+200,o.height+200,25)){this.transform=o,this.grid=y,this.ignoredGrid=w,this.pitchfactor=Math.cos(o._pitch)*o.cameraToCenterDistance,this.screenRightBoundary=o.width+cl,this.screenBottomBoundary=o.height+cl,this.gridRightBoundary=o.width+200,this.gridBottomBoundary=o.height+200,this.fogState=f}placeCollisionBox(o,f,y,w,E,C,M,N){let j=y.projectedAnchorX,H=y.projectedAnchorY,Z=y.projectedAnchorZ;const W=y.elevation,Q=y.tileID,ce=o.getProjection();if(W&&Q){const[qe,je,Ue]=ce.upVector(Q.canonical,y.tileAnchorX,y.tileAnchorY),We=ce.upVectorScale(Q.canonical,this.transform.center.lat,this.transform.worldSize).metersToTile;j+=qe*W*We,H+=je*W*We,Z+=Ue*W*We}const se=this.projectAndGetPerspectiveRatio(M,j,H,Z,y.tileID,ce.name==="globe"||!!W||this.transform.pitch>0,ce),ue=C*se.perspectiveRatio,pe=(y.x1*f+w.x-y.padding)*ue+se.point.x,ge=(y.y1*f+w.y-y.padding)*ue+se.point.y,Pe=(y.x2*f+w.x+y.padding)*ue+se.point.x,Ve=(y.y2*f+w.y+y.padding)*ue+se.point.y,Ye=se.perspectiveRatio<=.55||se.occluded;return!this.isInsideGrid(pe,ge,Pe,Ve)||!E&&this.grid.hitTest(pe,ge,Pe,Ve,N)||Ye?{box:[],offscreen:!1,occluded:se.occluded}:{box:[pe,ge,Pe,Ve],offscreen:this.isOffscreen(pe,ge,Pe,Ve),occluded:!1}}placeCollisionCircles(o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se){const ue=[],pe=this.transform.elevation,ge=o.getProjection(),Pe=pe?pe.getAtTileOffsetFunc(se,this.transform.center.lat,this.transform.worldSize,ge):null,Ve=new s.P(y.tileAnchorX,y.tileAnchorY);let{x:Ye,y:qe,z:je}=ge.projectTilePoint(Ve.x,Ve.y,se.canonical);if(Pe){const[Nt,Yt,Pt]=Pe(Ve);Ye+=Nt,qe+=Yt,je+=Pt}const Ue=ge.name==="globe",We=this.projectAndGetPerspectiveRatio(M,Ye,qe,je,se,Ue||!!pe||this.transform.pitch>0,ge),{perspectiveRatio:et}=We,_t=(Z?C/et:C*et)/s.bO,ft=qa(Ye,qe,je,N),Mt=y.lineOffsetX*_t,Rt=y.lineOffsetY*_t,jt=s.al(o.layers[0].layout.get("text-max-angle")),ht=Math.cos(jt),Dt=We.signedDistanceFromCamera>0?nh(_t,E,Mt,Rt,!1,ft,Ve,y,w,N,{},pe&&!Z?Pe:null,Z&&!!pe,ge,se,Z,ht):null;let ot=!1,At=!1,Tt=!0;if(Dt&&!We.occluded){const Nt=.5*Q*et+ce,Yt=new s.P(-100,-100),Pt=new s.P(this.screenRightBoundary,this.screenBottomBoundary),qt=new so,{first:bn,last:fn}=Dt,pn=bn.path.length;let Rn=[];for(let Xn=pn-1;Xn>=1;Xn--)Rn.push(bn.path[Xn]);for(let Xn=1;Xn<fn.path.length;Xn++)Rn.push(fn.path[Xn]);const Nn=2.5*Nt;j&&(Rn=Rn.map(([Xn,ai,Bi],pr)=>(Pe&&!Ue&&(Bi=Pe(pr<pn-1?bn.tilePath[pn-1-pr]:fn.tilePath[pr-pn+2])[2]),qa(Xn,ai,Bi,j))),Rn.some(Xn=>Xn[3]<=0)&&(Rn=[]));let Bn=[];if(Rn.length>0){let Xn=1/0,ai=-1/0,Bi=1/0,pr=-1/0;for(const Gi of Rn)Xn=Math.min(Xn,Gi[0]),Bi=Math.min(Bi,Gi[1]),ai=Math.max(ai,Gi[0]),pr=Math.max(pr,Gi[1]);ai>=Yt.x&&Xn<=Pt.x&&pr>=Yt.y&&Bi<=Pt.y&&(Bn=[Rn.map(Gi=>new s.P(Gi[0],Gi[1]))],(Xn<Yt.x||ai>Pt.x||Bi<Yt.y||pr>Pt.y)&&(Bn=s.bM(Bn,Yt.x,Yt.y,Pt.x,Pt.y)))}for(const Xn of Bn){qt.reset(Xn,.25*Nt);let ai=0;ai=qt.length<=.5*Nt?1:Math.ceil(qt.paddedLength/Nn)+1;for(let Bi=0;Bi<ai;Bi++){const pr=Bi/Math.max(ai-1,1),Gi=qt.lerp(pr),qi=Gi.x+cl,cs=Gi.y+cl;ue.push(qi,cs,Nt,0);const si=qi-Nt,li=cs-Nt,mi=qi+Nt,yr=cs+Nt;if(Tt=Tt&&this.isOffscreen(si,li,mi,yr),At=At||this.isInsideGrid(si,li,mi,yr),!f&&this.grid.hitTestCircle(qi,cs,Nt,W)&&(ot=!0,!H))return{circles:[],offscreen:!1,collisionDetected:ot,occluded:!1}}}}return{circles:!H&&ot||!At?[]:ue,offscreen:Tt,collisionDetected:ot,occluded:We.occluded}}queryRenderedSymbols(o){if(o.length===0||this.grid.keysLength()===0&&this.ignoredGrid.keysLength()===0)return{};const f=[];let y=1/0,w=1/0,E=-1/0,C=-1/0;for(const H of o){const Z=new s.P(H.x+cl,H.y+cl);y=Math.min(y,Z.x),w=Math.min(w,Z.y),E=Math.max(E,Z.x),C=Math.max(C,Z.y),f.push(Z)}const M=this.grid.query(y,w,E,C).concat(this.ignoredGrid.query(y,w,E,C)),N={},j={};for(const H of M){const Z=H.key;if(N[Z.bucketInstanceId]===void 0&&(N[Z.bucketInstanceId]={}),N[Z.bucketInstanceId][Z.featureIndex])continue;const W=[new s.P(H.x1,H.y1),new s.P(H.x2,H.y1),new s.P(H.x2,H.y2),new s.P(H.x1,H.y2)];s.bN(f,W)&&(N[Z.bucketInstanceId][Z.featureIndex]=!0,j[Z.bucketInstanceId]===void 0&&(j[Z.bucketInstanceId]=[]),j[Z.bucketInstanceId].push(Z.featureIndex))}return j}insertCollisionBox(o,f,y,w,E){(f?this.ignoredGrid:this.grid).insert({bucketInstanceId:y,featureIndex:w,collisionGroupID:E},o[0],o[1],o[2],o[3])}insertCollisionCircles(o,f,y,w,E){const C=f?this.ignoredGrid:this.grid,M={bucketInstanceId:y,featureIndex:w,collisionGroupID:E};for(let N=0;N<o.length;N+=4)C.insertCircle(M,o[N],o[N+1],o[N+2])}projectAndGetPerspectiveRatio(o,f,y,w,E,C,M){const N=[f,y,w,1];let j=!1;w||this.transform.pitch>0?(s.aA(N,N,o),this.fogState&&E&&M.name!=="globe"&&(j=function(W,Q,ce,se,ue,pe){const ge=pe.calculateFogTileMatrix(ue),Pe=[Q,ce,se];return s.ad(Pe,Pe,ge),Kt(W,s.ae(Pe),pe.pitch,pe._fov)}(this.fogState,f,y,w,E.toUnwrapped(),this.transform)>.9)):Mi(N,N,o);const H=N[3];return{point:new s.P((N[0]/H+1)/2*this.transform.width+cl,(-N[1]/H+1)/2*this.transform.height+cl),perspectiveRatio:Math.min(.5+this.transform.getCameraToCenterDistance(M)/H*.5,1.5),signedDistanceFromCamera:H,occluded:C&&N[2]>H||j}}isOffscreen(o,f,y,w){return y<cl||o>=this.screenRightBoundary||w<cl||f>this.screenBottomBoundary}isInsideGrid(o,f,y,w){return y>=0&&o<this.gridRightBoundary&&w>=0&&f<this.gridBottomBoundary}getViewportMatrix(){const o=s.bx([]);return s.bo(o,o,[-100,-100,0]),o}}function Ep(_,o,f){const y=o.createTileMatrix(_,_.worldSize,f.toUnwrapped());return s.az(new Float32Array(16),_.projMatrix,y)}function $n(_,o,f){if(o.projection.name===f.projection.name)return _.projMatrix;const y=f.clone();return y.setProjection(o.projection),Ep(y,o.getProjection(),_)}function Xc(_,o,f){return o.name===f.projection.name?_.projMatrix:Ep(f,o,_)}class sh{constructor(o,f,y,w){this.opacity=o?Math.max(0,Math.min(1,o.opacity+(o.placed?f:-f))):w&&y?1:0,this.placed=y}isHidden(){return this.opacity===0&&!this.placed}}class ic{constructor(o,f,y,w,E,C=!1){this.text=new sh(o?o.text:null,f,y,E),this.icon=new sh(o?o.icon:null,f,w,E),this.clipped=C}isHidden(){return this.text.isHidden()&&this.icon.isHidden()}}class $o{constructor(o,f,y,w=!1){this.text=o,this.icon=f,this.skipFade=y,this.clipped=w}}class Il{constructor(){this.invProjMatrix=s.bz(),this.viewportMatrix=s.bz(),this.circles=[]}}class Ya{constructor(o,f,y,w,E){this.bucketInstanceId=o,this.featureIndex=f,this.sourceLayerIndex=y,this.bucketIndex=w,this.tileID=E}}class xn{constructor(o){this.crossSourceCollisions=o,this.maxGroupID=0,this.collisionGroups={}}get(o){if(this.crossSourceCollisions)return{ID:0,predicate:null};if(!this.collisionGroups[o]){const f=++this.maxGroupID;this.collisionGroups[o]={ID:f,predicate:y=>y.collisionGroupID===f}}return this.collisionGroups[o]}}function gi(_,o,f,y,w){const{horizontalAlign:E,verticalAlign:C}=s.bT(_),M=-(E-.5)*o,N=-(C-.5)*f,j=s.bU(_,y);return new s.P(M+j[0]*w,N+j[1]*w)}function Di(_,o,f,y,w){const E=new s.P(_,o);return f&&E._rotate(y?w:-w),E}class Fs{constructor(o,f,y,w,E,C){this.transform=o.clone(),this.projection=o.projection.name,this.collisionIndex=new Tu(this.transform,E),this.buildingIndex=C,this.placements={},this.opacities={},this.variableOffsets={},this.stale=!1,this.commitTime=0,this.fadeDuration=f,this.retainedQueryData={},this.collisionGroups=new xn(y),this.collisionCircleArrays={},this.prevPlacement=w,w&&(w.prevPlacement=void 0),this.placedOrientations={}}getBucketParts(o,f,y,w,E=1){const C=y.getBucket(f),M=y.latestFeatureIndex;if(!C||!M||f.fqid!==C.layerIds[0])return;const N=C.layers[0].layout,j=C.layers[0].paint,H=y.collisionBoxArray,Z=Math.pow(2,this.transform.zoom-y.tileID.overscaledZ),W=y.tileSize/s.aj,Q=y.tileID.toUnwrapped();this.transform.setProjection(C.projection);const ce=(se=y.tileID,ue=C.getProjection(),pe=this.transform,ue.name===this.projection?pe.calculateProjMatrix(se.toUnwrapped()):Ep(pe,ue,se));var se,ue,pe;const ge=N.get("text-pitch-alignment")==="map",Pe=N.get("text-rotation-alignment")==="map";f.compileFilter(f.options);const Ve=f.dynamicFilter(),Ye=f.dynamicFilterNeedsFeature(),qe=this.transform.calculatePixelsToTileUnitsMatrix(y),je=wp(ce,y.tileID.canonical,ge,Pe,this.transform,C.getProjection(),qe);let Ue=null;if(ge){const Dt=Tp(ce,y.tileID.canonical,ge,Pe,this.transform,C.getProjection(),qe);Ue=s.az([],this.transform.labelPlaneMatrix,Dt)}let We=null;Ve&&y.latestFeatureIndex&&(We={unwrappedTileID:Q,dynamicFilter:Ve,dynamicFilterNeedsFeature:Ye}),this.retainedQueryData[C.bucketInstanceId]=new Ya(C.bucketInstanceId,M,C.sourceLayerIndex,C.index,y.tileID);const[et,_t]=C.layers[0].layout.get("text-size-scale-range"),ft=s.ay(E,et,_t),[Mt,Rt]=N.get("icon-size-scale-range"),jt=s.ay(E,Mt,Rt),ht={bucket:C,layout:N,paint:j,posMatrix:ce,textLabelPlaneMatrix:je,labelToScreenMatrix:Ue,clippingData:We,scale:Z,textPixelRatio:W,holdingForFade:y.holdingForFade(),collisionBoxArray:H,partiallyEvaluatedTextSize:s.bH(C.textSizeData,this.transform.zoom,ft),partiallyEvaluatedIconSize:s.bH(C.iconSizeData,this.transform.zoom,jt),collisionGroup:this.collisionGroups.get(C.sourceID),latestFeatureIndex:y.latestFeatureIndex};if(w)for(const Dt of C.sortKeyRanges){const{sortKey:ot,symbolInstanceStart:At,symbolInstanceEnd:Tt}=Dt;o.push({sortKey:ot,symbolInstanceStart:At,symbolInstanceEnd:Tt,parameters:ht})}else o.push({symbolInstanceStart:0,symbolInstanceEnd:C.symbolInstances.length,parameters:ht})}attemptAnchorPlacement(o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge){const{textOffset0:Pe,textOffset1:Ve,crossTileID:Ye}=W,qe=[Pe,Ve],je=gi(o,y,w,qe,E),Ue=this.collisionIndex.placeCollisionBox(ce,E,f,Di(je.x,je.y,C,M,this.transform.angle),Z,N,j,H.predicate);if(ue){const We=ce.getSymbolInstanceIconSize(ge,this.transform.zoom,W.placedIconSymbolIndex);if(this.collisionIndex.placeCollisionBox(ce,We,ue,Di(je.x,je.y,C,M,this.transform.angle),Z,N,j,H.predicate).box.length===0)return}if(Ue.box.length>0){let We;return this.prevPlacement&&this.prevPlacement.variableOffsets[Ye]&&this.prevPlacement.placements[Ye]&&this.prevPlacement.placements[Ye].text&&(We=this.prevPlacement.variableOffsets[Ye].anchor),this.variableOffsets[Ye]={textOffset:qe,width:y,height:w,anchor:o,textScale:E,prevAnchor:We},this.markUsedJustification(ce,o,W,se),ce.allowVerticalPlacement&&(this.markUsedOrientation(ce,se,W),this.placedOrientations[Ye]=se),{shift:je,placedGlyphBoxes:Ue}}}placeLayerBucketPart(o,f,y,w,E=1){const{bucket:C,layout:M,paint:N,posMatrix:j,textLabelPlaneMatrix:H,labelToScreenMatrix:Z,clippingData:W,textPixelRatio:Q,holdingForFade:ce,collisionBoxArray:se,partiallyEvaluatedTextSize:ue,partiallyEvaluatedIconSize:pe,collisionGroup:ge,latestFeatureIndex:Pe}=o.parameters,Ve=M.get("text-optional"),Ye=M.get("icon-optional"),qe=M.get("text-allow-overlap"),je=M.get("icon-allow-overlap"),Ue=M.get("text-rotation-alignment")==="map",We=M.get("text-pitch-alignment")==="map",et=N.get("symbol-z-offset"),_t=M.get("symbol-elevation-reference")==="sea",[ft,Mt]=M.get("text-size-scale-range"),[Rt,jt]=M.get("icon-size-scale-range"),ht=s.ay(E,ft,Mt),Dt=s.ay(E,Rt,jt);this.transform.setProjection(C.projection);let ot=qe&&(je||!C.hasIconData()||Ye),At=je&&(qe||!C.hasTextData()||Ve);const Tt=!et.isConstant();!C.collisionArrays&&se&&C.deserializeCollisionBoxes(se),y&&w&&C.updateCollisionDebugBuffers(this.transform.zoom,se,ht,Dt);const Nt=(Pt,qt,bn)=>{const{crossTileID:fn,numVerticalGlyphVertices:pn}=Pt;let Rn=null;if(W&&W.dynamicFilterNeedsFeature||Tt){const mr=this.retainedQueryData[C.bucketInstanceId];Rn=Pe.loadFeature({featureIndex:Pt.featureIndex,bucketIndex:mr.bucketIndex,sourceLayerIndex:mr.sourceLayerIndex,layoutVertexArrayOffset:0})}if(W&&!(0,W.dynamicFilter)({zoom:this.transform.zoom,pitch:this.transform.pitch},Rn,this.retainedQueryData[C.bucketInstanceId].tileID.canonical,new s.P(Pt.tileAnchorX,Pt.tileAnchorY),this.transform.calculateDistanceTileData(W.unwrappedTileID)))return this.placements[fn]=new $o(!1,!1,!1,!0),void f.add(fn);const Nn=et.evaluate(Rn,{});if(f.has(fn))return;if(ce)return void(this.placements[fn]=new $o(!1,!1,!1));let Bn=!1,Xn=!1,ai=!0,Bi=!1,pr=!1,Gi=null,qi={box:null,offscreen:null,occluded:null},cs={box:null},si=null,li=null,mi=null,yr=0,Us=0,Wi=0;bn.textFeatureIndex?yr=bn.textFeatureIndex:Pt.useRuntimeCollisionCircles&&(yr=Pt.featureIndex),bn.verticalTextFeatureIndex&&(Us=bn.verticalTextFeatureIndex);const ji=mr=>{mr.tileID=this.retainedQueryData[C.bucketInstanceId].tileID;const Er=this.transform.elevation;mr.elevation=_t?Nn:Nn+(Er?Er.getAtTileOffset(mr.tileID,mr.tileAnchorX,mr.tileAnchorY):0),mr.elevation+=Pt.zOffset},Zr=bn.textBox;if(Zr){ji(Zr);const mr=Fi=>{let ts=s.bI.horizontal;if(C.allowVerticalPlacement&&!Fi&&this.prevPlacement){const No=this.prevPlacement.placedOrientations[fn];No&&(this.placedOrientations[fn]=No,ts=No,this.markUsedOrientation(C,ts,Pt))}return ts},Er=(Fi,ts)=>{if(C.allowVerticalPlacement&&pn>0&&bn.verticalTextBox){for(const No of C.writingModes)if(No===s.bI.vertical?(qi=ts(),cs=qi):qi=Fi(),qi&&qi.box&&qi.box.length)break}else qi=Fi()};if(M.get("text-variable-anchor")){let Fi=M.get("text-variable-anchor");if(this.prevPlacement&&this.prevPlacement.variableOffsets[fn]){const vr=this.prevPlacement.variableOffsets[fn];Fi.indexOf(vr.anchor)>0&&(Fi=Fi.filter(Vi=>Vi!==vr.anchor),Fi.unshift(vr.anchor))}const ts=(vr,Vi,js)=>{const Ca=C.getSymbolInstanceTextSize(ue,Pt,this.transform.zoom,qt),gl=(vr.x2-vr.x1)*Ca+2*vr.padding,fc=(vr.y2-vr.y1)*Ca+2*vr.padding,Fl=Pt.hasIconTextFit&&!je?Vi:null;Fl&&ji(Fl);let Qa={box:[],offscreen:!1,occluded:!1};const vd=qe?2*Fi.length:Fi.length;for(let pc=0;pc<vd;++pc){const bd=this.attemptAnchorPlacement(Fi[pc%Fi.length],vr,gl,fc,Ca,Ue,We,Q,j,ge,pc>=Fi.length,Pt,qt,C,js,Fl,ue,pe);if(bd&&(Qa=bd.placedGlyphBoxes,Qa&&Qa.box&&Qa.box.length)){Bn=!0,Gi=bd.shift;break}}return Qa};Er(()=>ts(Zr,bn.iconBox,s.bI.horizontal),()=>{const vr=bn.verticalTextBox;return vr&&ji(vr),C.allowVerticalPlacement&&!(qi&&qi.box&&qi.box.length)&&pn>0&&vr?ts(vr,bn.verticalIconBox,s.bI.vertical):{box:null,offscreen:null,occluded:null}}),qi&&(Bn=qi.box,ai=qi.offscreen,Bi=qi.occluded);const No=mr(!(!qi||!qi.box));if(!Bn&&this.prevPlacement){const vr=this.prevPlacement.variableOffsets[fn];vr&&(this.variableOffsets[fn]=vr,this.markUsedJustification(C,vr.anchor,Pt,No))}}else{const Fi=(ts,No)=>{const vr=C.getSymbolInstanceTextSize(ue,Pt,this.transform.zoom,qt,E),Vi=this.collisionIndex.placeCollisionBox(C,vr,ts,new s.P(0,0),qe,Q,j,ge.predicate);return Vi&&Vi.box&&Vi.box.length&&(this.markUsedOrientation(C,No,Pt),this.placedOrientations[fn]=No),Vi};Er(()=>Fi(Zr,s.bI.horizontal),()=>{const ts=bn.verticalTextBox;return C.allowVerticalPlacement&&pn>0&&ts?(ji(ts),Fi(ts,s.bI.vertical)):{box:null,offscreen:null,occluded:null}}),mr(!!(qi&&qi.box&&qi.box.length))}}if(si=qi,Bn=si&&si.box&&si.box.length>0,ai=si&&si.offscreen,Bi=si&&si.occluded,Pt.useRuntimeCollisionCircles){const mr=C.text.placedSymbolArray.get(Pt.centerJustifiedTextSymbolIndex>=0?Pt.centerJustifiedTextSymbolIndex:Pt.verticalPlacedTextSymbolIndex),Er=s.bJ(C.textSizeData,ue,mr),Fi=M.get("text-padding");li=this.collisionIndex.placeCollisionCircles(C,qe,mr,C.lineVertexArray,C.glyphOffsetArray,Er,j,H,Z,y,We,ge.predicate,Pt.collisionCircleDiameter*Er/s.bO,Fi,this.retainedQueryData[C.bucketInstanceId].tileID),Bn=qe||li.circles.length>0&&!li.collisionDetected,ai=ai&&li.offscreen,Bi=li.occluded}if(bn.iconFeatureIndex&&(Wi=bn.iconFeatureIndex),bn.iconBox){const mr=Er=>{ji(Er);const Fi=Pt.hasIconTextFit&&Gi?Di(Gi.x,Gi.y,Ue,We,this.transform.angle):new s.P(0,0),ts=C.getSymbolInstanceIconSize(pe,this.transform.zoom,Pt.placedIconSymbolIndex);return this.collisionIndex.placeCollisionBox(C,ts,Er,Fi,je,Q,j,ge.predicate)};cs&&cs.box&&cs.box.length&&bn.verticalIconBox?(mi=mr(bn.verticalIconBox),Xn=mi.box.length>0):(mi=mr(bn.iconBox),Xn=mi.box.length>0),ai=ai&&mi.offscreen,pr=mi.occluded}const Ci=Ve||Pt.numHorizontalGlyphVertices===0&&pn===0,As=Ye||Pt.numIconVertices===0;if(Ci||As?As?Ci||(Xn=Xn&&Bn):Bn=Xn&&Bn:Xn=Bn=Xn&&Bn,Bn&&si&&si.box&&this.collisionIndex.insertCollisionBox(si.box,M.get("text-ignore-placement"),C.bucketInstanceId,cs&&cs.box&&Us?Us:yr,ge.ID),Xn&&mi&&this.collisionIndex.insertCollisionBox(mi.box,M.get("icon-ignore-placement"),C.bucketInstanceId,Wi,ge.ID),li&&(Bn&&this.collisionIndex.insertCollisionCircles(li.circles,M.get("text-ignore-placement"),C.bucketInstanceId,yr,ge.ID),y)){const mr=C.bucketInstanceId;let Er=this.collisionCircleArrays[mr];Er===void 0&&(Er=this.collisionCircleArrays[mr]=new Il);for(let Fi=0;Fi<li.circles.length;Fi+=4)Er.circles.push(li.circles[Fi+0]),Er.circles.push(li.circles[Fi+1]),Er.circles.push(li.circles[Fi+2]),Er.circles.push(li.collisionDetected?1:0)}const Tr=C.projection.name!=="globe";ot=ot&&(Tr||!Bi),At=At&&(Tr||!pr),this.placements[fn]=new $o(Bn||ot,Xn||At,ai||C.justReloaded),f.add(fn)},Yt=this.retainedQueryData[C.bucketInstanceId].tileID;if(C.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(C,Yt),C.elevationType==="road"&&C.updateRoadElevation(Yt.canonical),C.updateZOffset(),C.sortFeaturesByY){const Pt=C.getSortedSymbolIndexes(this.transform.angle);for(let qt=Pt.length-1;qt>=0;--qt){const bn=Pt[qt];Nt(C.symbolInstances.get(bn),bn,C.collisionArrays[bn])}C.hasAnyZOffset&&s.w(`${C.layerIds[0]} layer symbol-z-elevate: symbols are not sorted by elevation if symbol-z-order is evaluated to viewport-y`)}else if(C.hasAnyZOffset){const Pt=C.getSortedIndexesByZOffset();for(let qt=0;qt<Pt.length;++qt){const bn=Pt[qt];Nt(C.symbolInstances.get(bn),bn,C.collisionArrays[bn])}}else for(let Pt=o.symbolInstanceStart;Pt<o.symbolInstanceEnd;Pt++)Nt(C.symbolInstances.get(Pt),Pt,C.collisionArrays[Pt]);if(y&&C.bucketInstanceId in this.collisionCircleArrays){const Pt=this.collisionCircleArrays[C.bucketInstanceId];s.bi(Pt.invProjMatrix,j),Pt.viewportMatrix=this.collisionIndex.getViewportMatrix()}C.justReloaded=!1}markUsedJustification(o,f,y,w){const{leftJustifiedTextSymbolIndex:E,centerJustifiedTextSymbolIndex:C,rightJustifiedTextSymbolIndex:M,verticalPlacedTextSymbolIndex:N,crossTileID:j}=y,H=s.bV(f),Z=w===s.bI.vertical?N:H==="left"?E:H==="center"?C:H==="right"?M:-1;E>=0&&(o.text.placedSymbolArray.get(E).crossTileID=Z>=0&&E!==Z?0:j),C>=0&&(o.text.placedSymbolArray.get(C).crossTileID=Z>=0&&C!==Z?0:j),M>=0&&(o.text.placedSymbolArray.get(M).crossTileID=Z>=0&&M!==Z?0:j),N>=0&&(o.text.placedSymbolArray.get(N).crossTileID=Z>=0&&N!==Z?0:j)}markUsedOrientation(o,f,y){const w=f===s.bI.horizontal||f===s.bI.horizontalOnly?f:0,E=f===s.bI.vertical?f:0,{leftJustifiedTextSymbolIndex:C,centerJustifiedTextSymbolIndex:M,rightJustifiedTextSymbolIndex:N,verticalPlacedTextSymbolIndex:j}=y,H=o.text.placedSymbolArray;C>=0&&(H.get(C).placedOrientation=w),M>=0&&(H.get(M).placedOrientation=w),N>=0&&(H.get(N).placedOrientation=w),j>=0&&(H.get(j).placedOrientation=E)}commit(o){this.commitTime=o,this.zoomAtLastRecencyCheck=this.transform.zoom;const f=this.prevPlacement;let y=!1;this.prevZoomAdjustment=f?f.zoomAdjustment(this.transform.zoom):0;const w=f?f.symbolFadeChange(o):1,E=f?f.opacities:{},C=f?f.variableOffsets:{},M=f?f.placedOrientations:{};for(const N in this.placements){const j=this.placements[N],H=E[N];H?(this.opacities[N]=new ic(H,w,j.text,j.icon,null,j.clipped),y=y||j.text!==H.text.placed||j.icon!==H.icon.placed):(this.opacities[N]=new ic(null,w,j.text,j.icon,j.skipFade,j.clipped),y=y||j.text||j.icon)}for(const N in E){const j=E[N];if(!this.opacities[N]){const H=new ic(j,w,!1,!1);H.isHidden()||(this.opacities[N]=H,y=y||j.text.placed||j.icon.placed)}}for(const N in C)this.variableOffsets[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.variableOffsets[N]=C[N]);for(const N in M)this.placedOrientations[N]||!this.opacities[N]||this.opacities[N].isHidden()||(this.placedOrientations[N]=M[N]);y?this.lastPlacementChangeTime=o:typeof this.lastPlacementChangeTime!="number"&&(this.lastPlacementChangeTime=f?f.lastPlacementChangeTime:o)}updateLayerOpacities(o,f,y,w){const E=new Set;for(const C of f){const M=C.getBucket(o);M&&C.latestFeatureIndex&&o.fqid===M.layerIds[0]&&(this.updateBucketOpacities(M,E,C,C.collisionBoxArray,y,w,C.tileID,o.scope),M.elevationType==="offset"&&this.buildingIndex&&this.buildingIndex.updateZOffset(M,C.tileID),M.elevationType==="road"&&M.updateRoadElevation(C.tileID.canonical),M.updateZOffset())}}updateBucketOpacities(o,f,y,w,E,C,M,N){o.hasTextData()&&o.text.opacityVertexArray.clear(),o.hasIconData()&&o.icon.opacityVertexArray.clear(),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexArray.clear(),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexArray.clear();const j=o.layers[0].layout,H=o.layers[0].paint,Z=!!o.layers[0].dynamicFilter(),W=new ic(null,0,!1,!1,!0),Q=j.get("text-allow-overlap"),ce=j.get("icon-allow-overlap"),se=j.get("text-variable-anchor"),ue=j.get("text-rotation-alignment")==="map",pe=j.get("text-pitch-alignment")==="map",ge=H.get("symbol-z-offset"),Pe=j.get("symbol-elevation-reference")==="sea",Ve=!ge.isConstant(),Ye=new ic(null,0,Q&&(ce||!o.hasIconData()||j.get("icon-optional")),ce&&(Q||!o.hasTextData()||j.get("text-optional")),!0);!o.collisionArrays&&w&&(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData())&&o.deserializeCollisionBoxes(w);const qe=(Ue,We,et)=>{for(let _t=0;_t<We/4;_t++)Ue.opacityVertexArray.emplaceBack(et)};let je=0;C&&o.updateReplacement(M,C);for(let Ue=0;Ue<o.symbolInstances.length;Ue++){const We=o.symbolInstances.get(Ue),{numHorizontalGlyphVertices:et,numVerticalGlyphVertices:_t,crossTileID:ft,numIconVertices:Mt,tileAnchorX:Rt,tileAnchorY:jt}=We;let ht=null;const Dt=this.retainedQueryData[o.bucketInstanceId];Ve&&We&&Dt&&(ht=y.latestFeatureIndex.loadFeature({featureIndex:We.featureIndex,bucketIndex:Dt.bucketIndex,sourceLayerIndex:Dt.sourceLayerIndex,layoutVertexArrayOffset:0}));const ot=ge.evaluate(ht,{}),At=f.has(ft);let Tt=this.opacities[ft];At?Tt=W:Tt||(Tt=Ye,this.opacities[ft]=Tt),f.add(ft);const Nt=et>0||_t>0,Yt=Mt>0,Pt=this.placedOrientations[ft],qt=Pt===s.bI.vertical,bn=Pt===s.bI.horizontal||Pt===s.bI.horizontalOnly;!Nt&&!Yt||Tt.isHidden()||je++;let fn=!1;if((Nt||Yt)&&C)for(const pn of o.activeReplacements){if(s.bP(pn,E,s.bQ.Symbol,N)||pn.min.x>Rt||Rt>pn.max.x||pn.min.y>jt||jt>pn.max.y)continue;const Rn=s.bR(Rt,jt,M.canonical,pn.footprintTileId.canonical);if(fn=s.bS(Rn,pn.footprint),fn)break}if(Nt){const pn=fn?V:Za(Tt.text);qe(o.text,et,qt?V:pn),qe(o.text,_t,bn?V:pn);const Rn=Tt.text.isHidden(),{leftJustifiedTextSymbolIndex:Nn,centerJustifiedTextSymbolIndex:Bn,rightJustifiedTextSymbolIndex:Xn,verticalPlacedTextSymbolIndex:ai}=We,Bi=o.text.placedSymbolArray,pr=Rn||qt?1:0;Nn>=0&&(Bi.get(Nn).hidden=pr),Bn>=0&&(Bi.get(Bn).hidden=pr),Xn>=0&&(Bi.get(Xn).hidden=pr),ai>=0&&(Bi.get(ai).hidden=Rn||bn?1:0);const Gi=this.variableOffsets[ft];Gi&&this.markUsedJustification(o,Gi.anchor,We,Pt);const qi=this.placedOrientations[ft];qi&&(this.markUsedJustification(o,"left",We,qi),this.markUsedOrientation(o,qi,We))}if(Yt){const pn=fn?V:Za(Tt.icon),{placedIconSymbolIndex:Rn,verticalPlacedIconSymbolIndex:Nn}=We,Bn=o.icon.placedSymbolArray,Xn=Tt.icon.isHidden()?1:0;Rn>=0&&(qe(o.icon,Mt,qt?V:pn),Bn.get(Rn).hidden=Xn),Nn>=0&&(qe(o.icon,We.numVerticalIconVertices,bn?V:pn),Bn.get(Nn).hidden=Xn)}if(o.hasIconCollisionBoxData()||o.hasTextCollisionBoxData()){const pn=o.collisionArrays[Ue];if(pn){let Rn=new s.P(0,0),Nn=!0;if(pn.textBox||pn.verticalTextBox){if(se){const Xn=this.variableOffsets[ft];Xn?(Rn=gi(Xn.anchor,Xn.width,Xn.height,Xn.textOffset,Xn.textScale),ue&&Rn._rotate(pe?this.transform.angle:-this.transform.angle)):Nn=!1}Z&&(Nn=!Tt.clipped),pn.textBox&&ul(o.textCollisionBox.collisionVertexArray,Tt.text.placed,!Nn||qt,ot,Pe,Rn.x,Rn.y),pn.verticalTextBox&&ul(o.textCollisionBox.collisionVertexArray,Tt.text.placed,!Nn||bn,ot,Pe,Rn.x,Rn.y)}const Bn=Nn&&!!(!bn&&pn.verticalIconBox);pn.iconBox&&ul(o.iconCollisionBox.collisionVertexArray,Tt.icon.placed,Bn,ot,Pe,We.hasIconTextFit?Rn.x:0,We.hasIconTextFit?Rn.y:0),pn.verticalIconBox&&ul(o.iconCollisionBox.collisionVertexArray,Tt.icon.placed,!Bn,ot,Pe,We.hasIconTextFit?Rn.x:0,We.hasIconTextFit?Rn.y:0)}}}if(o.fullyClipped=je===0,o.sortFeatures(this.transform.angle),this.retainedQueryData[o.bucketInstanceId]&&(this.retainedQueryData[o.bucketInstanceId].featureSortOrder=o.featureSortOrder),o.hasTextData()&&o.text.opacityVertexBuffer&&o.text.opacityVertexBuffer.updateData(o.text.opacityVertexArray),o.hasIconData()&&o.icon.opacityVertexBuffer&&o.icon.opacityVertexBuffer.updateData(o.icon.opacityVertexArray),o.hasIconCollisionBoxData()&&o.iconCollisionBox.collisionVertexBuffer&&o.iconCollisionBox.collisionVertexBuffer.updateData(o.iconCollisionBox.collisionVertexArray),o.hasTextCollisionBoxData()&&o.textCollisionBox.collisionVertexBuffer&&o.textCollisionBox.collisionVertexBuffer.updateData(o.textCollisionBox.collisionVertexArray),o.bucketInstanceId in this.collisionCircleArrays){const Ue=this.collisionCircleArrays[o.bucketInstanceId];o.placementInvProjMatrix=Ue.invProjMatrix,o.placementViewportMatrix=Ue.viewportMatrix,o.collisionCircleArray=Ue.circles,delete this.collisionCircleArrays[o.bucketInstanceId]}}symbolFadeChange(o){return this.fadeDuration===0?1:(o-this.commitTime)/this.fadeDuration+this.prevZoomAdjustment}zoomAdjustment(o){return Math.max(0,(this.transform.zoom-o)/1.5)}hasTransitions(o){return this.stale||o-this.lastPlacementChangeTime<this.fadeDuration}stillRecent(o,f){const y=this.zoomAtLastRecencyCheck===f?1-this.zoomAdjustment(f):1;return this.zoomAtLastRecencyCheck=f,this.commitTime+this.fadeDuration*y>o}setStale(){this.stale=!0}}function ul(_,o,f,y,w,E,C){_.emplaceBack(o?1:0,f?1:0,E||0,C||0,y,w?1:0),_.emplaceBack(o?1:0,f?1:0,E||0,C||0,y,w?1:0),_.emplaceBack(o?1:0,f?1:0,E||0,C||0,y,w?1:0),_.emplaceBack(o?1:0,f?1:0,E||0,C||0,y,w?1:0)}const fi=Math.pow(2,25),Jh=Math.pow(2,24),Qc=Math.pow(2,17),ba=Math.pow(2,16),Wr=Math.pow(2,9),ys=Math.pow(2,8),Km=Math.pow(2,1);function Za(_){if(_.opacity===0&&!_.placed)return 0;if(_.opacity===1&&_.placed)return 4294967295;const o=_.placed?1:0,f=Math.floor(127*_.opacity);return f*fi+o*Jh+f*Qc+o*ba+f*Wr+o*ys+f*Km+o}const V=0;class le{constructor(o){this._sortAcrossTiles=o.layout.get("symbol-z-order")!=="viewport-y"&&o.layout.get("symbol-sort-key").constantOr(1)!==void 0,this._currentTileIndex=0,this._currentPartIndex=0,this._seenCrossTileIDs=new Set,this._bucketParts=[]}continuePlacement(o,f,y,w,E,C){const M=this._bucketParts;for(;this._currentTileIndex<o.length;)if(f.getBucketParts(M,w,o[this._currentTileIndex],this._sortAcrossTiles,C),this._currentTileIndex++,E())return!0;for(this._sortAcrossTiles&&(this._sortAcrossTiles=!1,M.sort((N,j)=>N.sortKey-j.sortKey));this._currentPartIndex<M.length;){const N=M[this._currentPartIndex];if(f.placeLayerBucketPart(N,this._seenCrossTileIDs,y,N.symbolInstanceStart===0,C),this._currentPartIndex++,E())return!0}return!1}}class xe{constructor(o,f,y,w,E,C,M,N,j){this.placement=new Fs(o,E,C,M,N,j),this._currentPlacementIndex=f.length-1,this._forceFullPlacement=y,this._showCollisionBoxes=w,this._done=!1}isDone(){return this._done}continuePlacement(o,f,y,w,E){const C=s.q.now(),M=()=>{const N=s.q.now()-C;return!this._forceFullPlacement&&N>2};for(;this._currentPlacementIndex>=0;){const N=f[o[this._currentPlacementIndex]],j=this.placement.collisionIndex.transform.zoom;if(N.type==="symbol"&&(!N.minzoom||N.minzoom<=j)&&(!N.maxzoom||N.maxzoom>j)){const H=N,Z=H.layout.get("symbol-z-elevate"),W=H.layout.get("symbol-sort-key").constantOr(1)!==void 0,Q=H.layout.get("symbol-z-order"),ce=Q==="viewport-y"||Q==="auto"&&!(Q!=="viewport-y"&&W),se=H.layout.get("text-allow-overlap")||H.layout.get("icon-allow-overlap")||H.layout.get("text-ignore-placement")||H.layout.get("icon-ignore-placement"),ue=ce&&se,pe=this._inProgressLayer=this._inProgressLayer||new le(H),ge=s.C(N.source,N.scope);if(pe.continuePlacement(Z||ue?w[ge]:y[ge],this.placement,this._showCollisionBoxes,N,M,E))return;delete this._inProgressLayer}this._currentPlacementIndex--}this._done=!0}commit(o){return this.placement.commit(o),this.placement}}const Ke=512/s.aj/2;class Vt{constructor(o,f,y){this.tileID=o,this.bucketInstanceId=y,this.index=new s.bW(f.length,16,Int32Array),this.keys=[],this.crossTileIDs=[];const w=o.canonical.x*s.aj,E=o.canonical.y*s.aj;for(let C=0;C<f.length;C++){const{key:M,crossTileID:N,tileAnchorX:j,tileAnchorY:H}=f.get(C),Z=Math.floor((w+j)*Ke),W=Math.floor((E+H)*Ke);this.index.add(Z,W),this.keys.push(M),this.crossTileIDs.push(N)}this.index.finish()}findMatches(o,f,y){const w=this.tileID.canonical.z<f.canonical.z?1:Math.pow(2,this.tileID.canonical.z-f.canonical.z),E=Ke/Math.pow(2,f.canonical.z-this.tileID.canonical.z),C=f.canonical.x*s.aj,M=f.canonical.y*s.aj;for(let N=0;N<o.length;N++){const j=o.get(N);if(j.crossTileID)continue;const{key:H,tileAnchorX:Z,tileAnchorY:W}=j,Q=Math.floor((C+Z)*E),ce=Math.floor((M+W)*E),se=this.index.range(Q-w,ce-w,Q+w,ce+w).sort((ue,pe)=>ue-pe);for(const ue of se){const pe=this.crossTileIDs[ue];if(this.keys[ue]===H&&!y.has(pe)){y.add(pe),j.crossTileID=pe;break}}}}}class $t{constructor(){this.maxCrossTileID=0}generate(){return++this.maxCrossTileID}}class Ln{constructor(){this.indexes={},this.usedCrossTileIDs={},this.lng=0}handleWrapJump(o){const f=Math.round((o-this.lng)/360);if(f!==0)for(const y in this.indexes){const w=this.indexes[y],E={};for(const C in w){const M=w[C];M.tileID=M.tileID.unwrapTo(M.tileID.wrap+f),E[M.tileID.key]=M}this.indexes[y]=E}this.lng=o}addBucket(o,f,y){if(this.indexes[o.overscaledZ]&&this.indexes[o.overscaledZ][o.key]){if(this.indexes[o.overscaledZ][o.key].bucketInstanceId===f.bucketInstanceId)return!1;this.removeBucketCrossTileIDs(o.overscaledZ,this.indexes[o.overscaledZ][o.key])}for(let E=0;E<f.symbolInstances.length;E++)f.symbolInstances.get(E).crossTileID=0;this.usedCrossTileIDs[o.overscaledZ]||(this.usedCrossTileIDs[o.overscaledZ]=new Set);const w=this.usedCrossTileIDs[o.overscaledZ];for(const E in this.indexes){const C=this.indexes[E];if(Number(E)>o.overscaledZ)for(const M in C){const N=C[M];N.tileID.isChildOf(o)&&N.findMatches(f.symbolInstances,o,w)}else{const M=C[o.scaledTo(Number(E)).key];M&&M.findMatches(f.symbolInstances,o,w)}}for(let E=0;E<f.symbolInstances.length;E++){const C=f.symbolInstances.get(E);C.crossTileID||(C.crossTileID=y.generate(),w.add(C.crossTileID))}return this.indexes[o.overscaledZ]===void 0&&(this.indexes[o.overscaledZ]={}),this.indexes[o.overscaledZ][o.key]=new Vt(o,f.symbolInstances,f.bucketInstanceId),!0}removeBucketCrossTileIDs(o,f){for(const y of f.crossTileIDs)this.usedCrossTileIDs[o].delete(y)}removeStaleBuckets(o){let f=!1;for(const y in this.indexes){const w=this.indexes[y];for(const E in w)o[w[E].bucketInstanceId]||(this.removeBucketCrossTileIDs(y,w[E]),delete w[E],f=!0)}return f}}class Hi{constructor(){this.layerIndexes={},this.crossTileIDs=new $t,this.maxBucketInstanceId=0,this.bucketsInCurrentPlacement={}}addLayer(o,f,y,w){let E=this.layerIndexes[o.fqid];E===void 0&&(E=this.layerIndexes[o.fqid]=new Ln);let C=!1;const M={};w.name!=="globe"&&E.handleWrapJump(y);for(const N of f){const j=N.getBucket(o);j&&o.fqid===j.layerIds[0]&&(j.bucketInstanceId||(j.bucketInstanceId=++this.maxBucketInstanceId),E.addBucket(N.tileID,j,this.crossTileIDs)&&(C=!0),M[j.bucketInstanceId]=!0)}return E.removeStaleBuckets(M)&&(C=!0),C}pruneUnusedLayers(o){const f={};o.forEach(y=>{f[y]=!0});for(const y in this.layerIndexes)f[y]||delete this.layerIndexes[y]}}const Ss=771;class kn{constructor(o,f,y,w){this.blendFunction=o,this.blendColor=f.toNonPremultipliedRenderColor(null),this.mask=y,this.blendEquation=w}}kn.Replace=[1,0,1,0],kn.disabled=new kn(kn.Replace,s.am.transparent,[!1,!1,!1,!1]),kn.unblended=new kn(kn.Replace,s.am.transparent,[!0,!0,!0,!0]),kn.alphaBlended=new kn([1,Ss,1,Ss],s.am.transparent,[!0,!0,!0,!0]),kn.alphaBlendedNonPremultiplied=new kn([770,Ss,770,Ss],s.am.transparent,[!0,!0,!0,!0]),kn.multiply=new kn([774,0,774,0],s.am.transparent,[!0,!0,!0,!0]);class an{constructor(o,f,y){this.func=o,this.mask=f,this.range=y}}an.ReadOnly=!1,an.ReadWrite=!0,an.disabled=new an(519,an.ReadOnly,[0,1]);const Jr=7680;class Hn{constructor(o,f,y,w,E,C){this.test=o,this.ref=f,this.mask=y,this.fail=w,this.depthFail=E,this.pass=C}}Hn.disabled=new Hn({func:519,mask:0},0,0,Jr,Jr,Jr);const Ki=1029,xa=2305;class Un{constructor(o,f,y){this.enable=o,this.mode=f,this.frontFace=y}}function rc(_,o){const f=s.c1(_,3);s.c3(_,o),s.c7(_,3,f)}function df(_,o){const f=s.b_([]);return s.b$(f,f,-o),s.c0(f,f,-_),f}function oh(_,o){const f=[_[0],_[1],0],y=[o[0],o[1],0];if(s.ae(f)>=1e-15){const C=s.au([],f);s.bY(y,C,s.bG(y,C)),o[0]=y[0],o[1]=y[1]}const w=s.bF([],o,_);if(s.bZ(w)<1e-15)return null;const E=Math.atan2(-w[1],w[0]);return df(Math.atan2(Math.sqrt(_[0]*_[0]+_[1]*_[1]),-_[2]),E)}Un.disabled=new Un(!1,Ki,xa),Un.backCCW=new Un(!0,Ki,xa),Un.backCW=new Un(!0,Ki,2304),Un.frontCW=new Un(!0,1028,2304),Un.frontCCW=new Un(!0,1028,xa);class Sp{constructor(o,f){this.position=o,this.orientation=f}get position(){return this._position}set position(o){if(o){const f=o instanceof s.ac?o:new s.ac(o[0],o[1],o[2]);this._renderWorldCopies&&(f.x=s.bX(f.x,0,1)),this._position=f}else this._position=null}lookAtPoint(o,f){if(this.orientation=null,!this.position)return;const y=this.position,w=this._elevation?this._elevation.getAtPointOrZero(s.ac.fromLngLat(o)):0,E=s.ac.fromLngLat(o,w),C=[E.x-y.x,E.y-y.y,E.z-y.z];f||(f=[0,0,1]),f[2]=Math.abs(f[2]),this.orientation=oh(C,f)}setPitchBearing(o,f){this.orientation=df(s.al(o),s.al(-f))}}class wa{constructor(o,f){this._transform=s.bx([]),this.orientation=f,this.position=o}get mercatorPosition(){const o=this.position;return new s.ac(o[0],o[1],o[2])}get position(){const o=s.c1(this._transform,3);return[o[0],o[1],o[2]]}set position(o){var f;o&&s.c7(this._transform,3,[(f=o)[0],f[1],f[2],1])}get orientation(){return this._orientation}set orientation(o){this._orientation=o||s.b_([]),o&&rc(this._transform,this._orientation)}getPitchBearing(){const o=this.forward(),f=this.right();return{bearing:Math.atan2(-f[1],f[0]),pitch:Math.atan2(Math.sqrt(o[0]*o[0]+o[1]*o[1]),-o[2])}}setPitchBearing(o,f){this._orientation=df(o,f),rc(this._transform,this._orientation)}forward(){const o=s.c1(this._transform,2);return[-o[0],-o[1],-o[2]]}up(){const o=s.c1(this._transform,1);return[-o[0],-o[1],-o[2]]}right(){const o=s.c1(this._transform,0);return[o[0],o[1],o[2]]}getCameraToWorld(o,f){const y=new Float64Array(16);return s.bi(y,this.getWorldToCamera(o,f)),y}getCameraToWorldMercator(){return this._transform}getWorldToCameraPosition(o,f,y){const w=this.position;s.bY(w,w,-o);const E=new Float64Array(16);return s.bn(E,[y,y,y]),s.bo(E,E,w),E[10]*=f,E}getWorldToCamera(o,f){const y=new Float64Array(16),w=new Float64Array(4),E=this.position;return s.c2(w,this._orientation),s.bY(E,E,-o),s.c3(y,w),s.bo(y,y,E),y[1]*=-1,y[5]*=-1,y[9]*=-1,y[13]*=-1,y[8]*=f,y[9]*=f,y[10]*=f,y[11]*=f,y}getCameraToClipPerspective(o,f,y,w){const E=new Float64Array(16);return s.c4(E,o,f,y,w),E}getCameraToClipOrthographic(o,f,y,w,E,C){const M=new Float64Array(16);return s.c5(M,o,f,y,w,E,C),M}getDistanceToElevation(o,f=!1){const y=o===0?0:s.c6(o,f?s.aY(this.position[1]):this.position[1]),w=this.forward();return(y-this.position[2])/w[2]}clone(){return new wa([...this.position],[...this.orientation])}}const sa={BaseColor:5,MetallicRoughness:6,Normal:7,Occlusion:8,Emission:9,LUT:10,ShadowMap0:11};class ah{constructor(o=0,f=0,y=0,w=0){if(isNaN(o)||o<0||isNaN(f)||f<0||isNaN(y)||y<0||isNaN(w)||w<0)throw new Error("Invalid value for edge-insets, top, bottom, left and right must all be numbers");this.top=o,this.bottom=f,this.left=y,this.right=w}interpolate(o,f,y){return f.top!=null&&o.top!=null&&(this.top=s.ai(o.top,f.top,y)),f.bottom!=null&&o.bottom!=null&&(this.bottom=s.ai(o.bottom,f.bottom,y)),f.left!=null&&o.left!=null&&(this.left=s.ai(o.left,f.left,y)),f.right!=null&&o.right!=null&&(this.right=s.ai(o.right,f.right,y)),this}getCenter(o,f){const y=s.ay((this.left+o-this.right)/2,0,o),w=s.ay((this.top+f-this.bottom)/2,0,f);return new s.P(y,w)}equals(o){return this.top===o.top&&this.bottom===o.bottom&&this.left===o.left&&this.right===o.right}clone(){return new ah(this.top,this.bottom,this.left,this.right)}toJSON(){return{top:this.top,bottom:this.bottom,left:this.left,right:this.right}}}const fo=15;class Ap{constructor(o,f,y,w,E,C,M){this.tileSize=512,this._renderWorldCopies=E===void 0||E,this._minZoom=o||0,this._maxZoom=f||22,this._minPitch=y??0,this._maxPitch=w??60,this.setProjection(C),this.setMaxBounds(M),this.width=0,this.height=0,this._center=new s.cd(0,0),this.zoom=0,this.angle=0,this._fov=.6435011087932844,this._pitch=0,this._nearZ=0,this._farZ=0,this._unmodified=!0,this._edgeInsets=new ah,this._projMatrixCache={},this._alignedProjMatrixCache={},this._fogTileMatrixCache={},this._expandedProjMatrixCache={},this._distanceTileDataCache={},this._camera=new wa,this._centerAltitude=0,this._averageElevation=0,this.cameraElevationReference="ground",this._pixelsPerMercatorPixel=1,this.globeRadius=0,this.globeCenterInViewSpace=[0,0,0],this._tileCoverLift=0,this.freezeTileCoverage=!1,this._horizonShift=.1,this._orthographicProjectionAtLowPitch=!1,this._allowWorldUnderZoom=!1}clone(){const o=new Ap(this._minZoom,this._maxZoom,this._minPitch,this.maxPitch,this._renderWorldCopies,this.getProjection(),this.maxBounds);return o._elevation=this._elevation,o._centerAltitude=this._centerAltitude,o._centerAltitudeValidForExaggeration=this._centerAltitudeValidForExaggeration,o.tileSize=this.tileSize,o.mercatorFromTransition=this.mercatorFromTransition,o.width=this.width,o.height=this.height,o.cameraElevationReference=this.cameraElevationReference,o._center=this._center,o._setZoom(this.zoom),o._seaLevelZoom=this._seaLevelZoom,o.angle=this.angle,o._fov=this._fov,o._pitch=this._pitch,o._nearZ=this._nearZ,o._farZ=this._farZ,o._averageElevation=this._averageElevation,o._orthographicProjectionAtLowPitch=this._orthographicProjectionAtLowPitch,o._unmodified=this._unmodified,o._edgeInsets=this._edgeInsets.clone(),o._camera=this._camera.clone(),o._calcMatrices(),o.freezeTileCoverage=this.freezeTileCoverage,o.frustumCorners=this.frustumCorners,o._allowWorldUnderZoom=this._allowWorldUnderZoom,o}get isOrthographic(){return this.projection.name!=="globe"&&this._orthographicProjectionAtLowPitch&&this.pitch<fo}get elevation(){return this._elevation}set elevation(o){this._elevation!==o&&(this._elevation=o,this._updateCameraOnTerrain(),this._calcMatrices())}get depthOcclusionForSymbolsAndCircles(){return this.projection.name!=="globe"&&!this.isOrthographic}updateElevation(o,f=!1){const y=this._elevation&&this._elevation.exaggeration()!==this._centerAltitudeValidForExaggeration;(this._seaLevelZoom==null||y)&&this._updateCameraOnTerrain(),(o||y)&&this._constrainCamera(f),this._calcMatrices()}getProjection(){return s.aF(this.projection,["name","center","parallels"])}setProjection(o){this.projectionOptions=o||{name:"mercator"};const f=this.projection?this.getProjection():void 0;this.projection=s.ce(this.projectionOptions);const y=this.getProjection(),w=!s.bv(f,y);return w&&this._calcMatrices(),this.mercatorFromTransition=!1,w}setOrthographicProjectionAtLowPitch(o){return this._orthographicProjectionAtLowPitch!==o&&(this._orthographicProjectionAtLowPitch=o,this._calcMatrices(),!0)}setMercatorFromTransition(){const o=this.projection.name;this.mercatorFromTransition=!0,this.projectionOptions={name:"mercator"},this.projection=s.ce({name:"mercator"});const f=o!==this.projection.name;return f&&this._calcMatrices(),f}get minZoom(){return this._minZoom}set minZoom(o){this._minZoom!==o&&(this._minZoom=o,this.zoom=Math.max(this.zoom,o))}get maxZoom(){return this._maxZoom}set maxZoom(o){this._maxZoom!==o&&(this._maxZoom=o,this.zoom=Math.min(this.zoom,o))}get minPitch(){return this._minPitch}set minPitch(o){this._minPitch!==o&&(this._minPitch=o,this.pitch=Math.max(this.pitch,o))}get maxPitch(){return this._maxPitch}set maxPitch(o){this._maxPitch!==o&&(this._maxPitch=o,this.pitch=Math.min(this.pitch,o))}get renderWorldCopies(){return this._renderWorldCopies&&this.projection.supportsWorldCopies===!0}set renderWorldCopies(o){o===void 0?o=!0:o===null&&(o=!1),this._renderWorldCopies=o}get worldSize(){return this.tileSize*this.scale}get cameraWorldSizeForFog(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get cameraWorldSize(){const o=Math.max(this._camera.getDistanceToElevation(this._averageElevation,!0),Number.EPSILON);return this._worldSizeFromZoom(this._zoomFromMercatorZ(o))}get pixelsPerMeter(){return this.projection.pixelsPerMeter(this.center.lat,this.worldSize)}get cameraPixelsPerMeter(){return s.c6(1,this.center.lat)*this.cameraWorldSizeForFog}get centerOffset(){return this.centerPoint._sub(this.size._div(2))}get size(){return new s.P(this.width,this.height)}get bearing(){return s.bX(this.rotation,-180,180)}set bearing(o){this.rotation=o}get rotation(){return-this.angle/Math.PI*180}set rotation(o){const f=-o*Math.PI/180;this.angle!==f&&(this._unmodified=!1,this.angle=f,this._calcMatrices(),this.rotationMatrix=s.cf(),s.cg(this.rotationMatrix,this.rotationMatrix,this.angle))}get pitch(){return this._pitch/Math.PI*180}set pitch(o){const f=s.ay(o,this.minPitch,this.maxPitch)/180*Math.PI;this._pitch!==f&&(this._unmodified=!1,this._pitch=f,this._calcMatrices())}get aspect(){return this.width/this.height}get fov(){return this._fov/Math.PI*180}set fov(o){o=Math.max(.01,Math.min(60,o)),this._fov!==o&&(this._unmodified=!1,this._fov=s.al(o),this._calcMatrices())}get fovX(){return this._fov}get fovY(){const o=1/Math.tan(.5*this.fovX);return 2*Math.atan(1/this.aspect/o)}get averageElevation(){return this._averageElevation}set averageElevation(o){this._averageElevation=o,this._calcFogMatrices(),this._distanceTileDataCache={}}get zoom(){return this._zoom}set zoom(o){const f=Math.min(Math.max(o,this.minZoom),this.maxZoom);this._zoom!==f&&(this._unmodified=!1,this._setZoom(f),this._updateSeaLevelZoom(),this._constrain(),this._calcMatrices())}_setZoom(o){this._zoom=o,this.scale=this.zoomScale(o),this.tileZoom=Math.floor(o),this.zoomFraction=o-this.tileZoom}get tileCoverLift(){return this._tileCoverLift}set tileCoverLift(o){this._tileCoverLift!==o&&(this._tileCoverLift=o)}_updateCameraOnTerrain(){const o=this.elevation?this.elevation.getAtPoint(this.locationCoordinate(this.center),Number.NEGATIVE_INFINITY):Number.NEGATIVE_INFINITY,f=this.elevation&&o===Number.NEGATIVE_INFINITY&&this.elevation.visibleDemTiles.length>0&&this.elevation.exaggeration()>0&&this._centerAltitudeValidForExaggeration;if(!this._elevation||o===Number.NEGATIVE_INFINITY&&(!f||!this._centerAltitude))return this._centerAltitude=0,this._seaLevelZoom=null,void(this._centerAltitudeValidForExaggeration=void 0);const y=this._elevation;f||this._centerAltitude&&this._centerAltitudeValidForExaggeration&&y.exaggeration()&&this._centerAltitudeValidForExaggeration!==y.exaggeration()?(this._centerAltitude=this._centerAltitude/this._centerAltitudeValidForExaggeration*y.exaggeration(),this._centerAltitudeValidForExaggeration=y.exaggeration()):(this._centerAltitude=o||0,this._centerAltitudeValidForExaggeration=y.exaggeration()),this._updateSeaLevelZoom()}_updateSeaLevelZoom(){if(this._centerAltitudeValidForExaggeration===void 0)return;const o=Math.max(0,(this.pixelsPerMeter*this._centerAltitude+this.cameraToCenterDistance)/this.worldSize);this._seaLevelZoom=this._zoomFromMercatorZ(o)}sampleAverageElevation(){if(!this._elevation)return 0;const o=this._elevation,f=[[.5,.2],[.3,.5],[.5,.5],[.7,.5],[.5,.8]],y=this.horizonLineFromTop();let w=0,E=0;for(let C=0;C<f.length;C++){const M=new s.P(f[C][0]*this.width,y+f[C][1]*(this.height-y)),N=o.pointCoordinate(M);if(!N)continue;const j=1/Math.hypot(N[0]-this._camera.position[0],N[1]-this._camera.position[1]);w+=N[3]*j,E+=j}return E===0?NaN:w/E}get center(){return this._center}set center(o){o.lat===this._center.lat&&o.lng===this._center.lng||(this._unmodified=!1,this._center=o,this._terrainEnabled()&&(this.cameraElevationReference==="ground"?this._updateCameraOnTerrain():this._updateZoomFromElevation()),this._constrain(),this._calcMatrices())}_updateZoomFromElevation(){if(this._seaLevelZoom==null||!this._elevation)return;const o=this._seaLevelZoom,f=this._elevation.getAtPointOrZero(this.locationCoordinate(this.center)),y=this.pixelsPerMeter/this.worldSize*f,w=this._mercatorZfromZoom(o),E=this._mercatorZfromZoom(this._maxZoom),C=Math.max(w-y,E);this._setZoom(this._zoomFromMercatorZ(C))}get padding(){return this._edgeInsets.toJSON()}set padding(o){this._edgeInsets.equals(o)||(this._unmodified=!1,this._edgeInsets.interpolate(this._edgeInsets,o,1),this._calcMatrices())}computeZoomRelativeTo(o){const f=this.rayIntersectionCoordinate(this.pointRayIntersection(this.centerPoint,o.toAltitude()));let y;y=o.z<this._camera.position[2]?[f.x,f.y,f.z]:[o.x,o.y,o.z];const w=s.ae(s.at([],this._camera.position,y));return s.ay(this._zoomFromMercatorZ(w),this._minZoom,this._maxZoom)}setFreeCameraOptions(o){if(!this.height||!o.position&&!o.orientation)return;this._updateCameraState();let f=!1;if(o.orientation&&!s.ch(o.orientation,this._camera.orientation)&&(f=this._setCameraOrientation(o.orientation)),o.position){const y=[o.position.x,o.position.y,o.position.z];s.ci(y,this._camera.position)||(this._setCameraPosition(y),f=!0)}f&&(this._updateStateFromCamera(),this.recenterOnTerrain())}getFreeCameraOptions(){this._updateCameraState();const o=this._camera.position,f=new Sp;return f.position=new s.ac(o[0],o[1],o[2]),f.orientation=this._camera.orientation,f._elevation=this.elevation,f._renderWorldCopies=this.renderWorldCopies,f}_setCameraOrientation(o){if(!s.cj(o))return!1;s.ck(o,o);const f=s.cl([],[0,0,-1],o),y=s.cl([],[0,-1,0],o);if(y[2]<0)return!1;const w=oh(f,y);return!!w&&(this._camera.orientation=w,!0)}_setCameraPosition(o){const f=this.zoomScale(this.minZoom)*this.tileSize,y=this.zoomScale(this.maxZoom)*this.tileSize,w=this.cameraToCenterDistance;o[2]=s.ay(o[2],w/y,w/f),this._camera.position=o}get centerPoint(){return this._edgeInsets.getCenter(this.width,this.height)}get fovAboveCenter(){return this._fov*(.5+this.centerOffset.y/this.height)}isPaddingEqual(o){return this._edgeInsets.equals(o)}interpolatePadding(o,f,y){this._unmodified=!1,this._edgeInsets.interpolate(o,f,y),this._constrain(),this._calcMatrices()}coveringZoomLevel(o){const f=(o.roundZoom?Math.round:Math.floor)(this.zoom+this.scaleZoom(this.tileSize/o.tileSize));return Math.max(0,f)}getVisibleUnwrappedCoordinates(o){const f=[new s.cm(0,o)];if(this.renderWorldCopies){const y=this.pointCoordinate(new s.P(0,0)),w=this.pointCoordinate(new s.P(this.width,0)),E=this.pointCoordinate(new s.P(this.width,this.height)),C=this.pointCoordinate(new s.P(0,this.height)),M=Math.floor(Math.min(y.x,w.x,E.x,C.x)),N=Math.floor(Math.max(y.x,w.x,E.x,C.x)),j=1;for(let H=M-j;H<=N+j;H++)H!==0&&f.push(new s.cm(H,o))}return f}isLODDisabled(o){return(!o||this.pitch<=60)&&this._edgeInsets.top<=this._edgeInsets.bottom&&!this._elevation&&!this.projection.isReprojectedInTileSpace}extendTileCover(o,f,y){let w=[];const E=y!=null,C=!E;if(C&&this.zoom<f||E&&y[0]===0&&y[1]===0)return w;const M=new Set,N=(H,Z,W,Q,ce)=>{const se=s.cK(Z,H,W,Q,ce);M.has(se)||(w.push(new s.aM(H,Z,W,Q,ce)),M.add(se))};for(let H=0;H<o.length;H++){const Z=o[H];if(C&&Z.canonical.z!==f)continue;const W=Z.canonical,Q=Z.overscaledZ,ce=Z.wrap,se=1<<W.z,ue=W.x+1<se,pe=W.x>0,ge=W.y+1<se,Pe=W.y>0,Ve=Z.wrap-(pe?0:1),Ye=Z.wrap+(ue?0:1),qe=pe?W.x-1:se-1,je=ue?W.x+1:0;if(E)y[0]<0?(N(Q,Ye,W.z,je,W.y),y[1]<0&&ge&&(N(Q,ce,W.z,W.x,W.y+1),N(Q,Ye,W.z,je,W.y+1)),y[1]>0&&Pe&&(N(Q,ce,W.z,W.x,W.y-1),N(Q,Ye,W.z,je,W.y-1))):y[0]>0?(N(Q,Ve,W.z,qe,W.y),y[1]<0&&ge&&(N(Q,ce,W.z,W.x,W.y+1),N(Q,Ve,W.z,qe,W.y+1)),y[1]>0&&Pe&&(N(Q,ce,W.z,W.x,W.y-1),N(Q,Ve,W.z,qe,W.y-1))):y[1]<0&&ge?N(Q,ce,W.z,W.x,W.y+1):Pe&&N(Q,ce,W.z,W.x,W.y-1);else{const Ue=Z.visibleQuadrants;1&Ue&&(N(Q,Ve,W.z,qe,W.y),Pe&&(N(Q,ce,W.z,W.x,W.y-1),N(Q,Ve,W.z,qe,W.y-1))),2&Ue&&(N(Q,Ye,W.z,je,W.y),Pe&&(N(Q,ce,W.z,W.x,W.y-1),N(Q,Ye,W.z,je,W.y-1))),4&Ue&&(N(Q,Ve,W.z,qe,W.y),ge&&(N(Q,ce,W.z,W.x,W.y+1),N(Q,Ve,W.z,qe,W.y+1))),8&Ue&&(N(Q,Ye,W.z,je,W.y),ge&&(N(Q,ce,W.z,W.x,W.y+1),N(Q,Ye,W.z,je,W.y+1)))}}const j=[];for(const H of w)w.some(Z=>H.isChildOf(Z))||j.push(H);if(w=j.filter(H=>!o.some(Z=>!!(H.overscaledZ<f&&Z.isChildOf(H))||H.equals(Z)||H.isChildOf(Z))),C){const H=1<<f,Z=this.projection.name==="globe"?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),W=[H*Z.x,H*Z.y],Q=4,ce=Q*Q;w=w.filter(se=>{const ue=se.canonical.x+.5-W[0],pe=se.canonical.y+.5-W[1];return ue*ue+pe*pe<ce})}return w}coveringTiles(o){let f=this.coveringZoomLevel(o);const y=f,w=this.elevation&&this.elevation.exaggeration(),E=w&&!o.isTerrainDEM,C=this.projection.name==="mercator";if(o.minzoom!==void 0&&f<o.minzoom)return[];o.maxzoom!==void 0&&f>o.maxzoom&&(f=o.maxzoom);const M=this.locationCoordinate(this.center),N=this.center.lat,j=1<<f,H=[j*M.x,j*M.y,0],Z=this.projection.name==="globe",W=!Z,Q=s.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,f,W),ce=Z?this._camera.mercatorPosition:this.pointCoordinate(this.getCameraPoint()),se=j*s.c6(1,this.center.lat),ue=this._camera.position[2]/s.c6(1,this.center.lat),pe=[j*ce.x,j*ce.y,ue*(W?1:se)],ge=Z||w,Pe=this.cameraToCenterDistance/o.tileSize*(o.roundZoom?1:.502),Ve=this.isLODDisabled(!0)?f:0;let Ye;if(this._elevation&&o.isTerrainDEM)Ye=1e4*this._elevation.exaggeration();else if(this._elevation){const ot=this._elevation.getMinMaxForVisibleTiles();Ye=ot?ot.max:this._centerAltitude}else Ye=this._centerAltitude;const qe=o.isTerrainDEM?-Ye:this._elevation?this._elevation.getMinElevationBelowMSL():0,je=this.projection.isReprojectedInTileSpace?s.co(this):1,Ue=ot=>{const Tt=new s.ac(ot.x+25e-6,ot.y,ot.z),Nt=new s.ac(ot.x,ot.y+25e-6,ot.z),Yt=ot.toLngLat(),Pt=Tt.toLngLat(),qt=Nt.toLngLat(),bn=this.locationCoordinate(Yt),fn=this.locationCoordinate(Pt),pn=this.locationCoordinate(qt),Rn=Math.hypot(fn.x-bn.x,fn.y-bn.y),Nn=Math.hypot(pn.x-bn.x,pn.y-bn.y);return Math.sqrt(Rn*Nn)*je/25e-6},We=ot=>{const At=Ye,Tt=qe;return{aabb:s.cr(this,j,0,0,0,ot,Tt,At,this.projection),zoom:0,x:0,y:0,minZ:Tt,maxZ:At,wrap:ot,fullyVisible:!1}},et=[];let _t=[];const ft=f,Mt=o.reparseOverscaled?y:f,Rt=(ue-this._centerAltitude)*se,jt=ot=>{if(!this._elevation||!ot.tileID||!C)return;const At=this._elevation.getMinMaxForTile(ot.tileID),Tt=ot.aabb;At?(Tt.min[2]=At.min,Tt.max[2]=At.max,Tt.center[2]=(Tt.min[2]+Tt.max[2])/2):(ot.shouldSplit=Dt(ot),ot.shouldSplit||(Tt.min[2]=Tt.max[2]=Tt.center[2]=this._centerAltitude))},ht=(ot,At)=>{if(.707*At<ot)return 1;const Tt=At/ot;return Tt/(1.4144271570014144+(Math.pow(1.1,Tt-1.4144271570014144+1)-1)/(1.1-1)-1)},Dt=ot=>{if(ot.zoom<Ve)return!0;if(ot.zoom===ft)return!1;if(ot.shouldSplit!=null)return ot.shouldSplit;const At=ot.aabb.distanceX(pe),Tt=ot.aabb.distanceY(pe);let Nt=Rt,Yt=1;if(Z){Nt=ot.aabb.distanceZ(pe);const Nn=Math.pow(2,ot.zoom),Bn=s.aY((ot.y+1)/Nn),Xn=s.aY(ot.y/Nn),ai=Math.min(Math.max(N,Bn),Xn),Bi=s.cO(ai)/s.cO(N);if(Yt=ai===N?1/Math.max(1,this._mercatorScaleRatio-.3):Math.min(1,Bi/this._mercatorScaleRatio),this.zoom<=s.cL&&ot.zoom===ft-1&&Bi>=.9)return!0}else if(E&&(Nt=ot.aabb.distanceZ(pe)*se),this.projection.isReprojectedInTileSpace&&y<=5){const Nn=Math.pow(2,ot.zoom),Bn=Ue(new s.ac((ot.x+.5)/Nn,(ot.y+.5)/Nn));Yt=Bn>.85?1:Bn}if(!C){const Nn=Math.sqrt(At*At+Tt*Tt+Nt*Nt);let Bn=(1<<ft-ot.zoom)*Pe*Yt;return Bn*=ht(Math.max(Nt,Rt),Nn),Nn<Bn}let Pt=Number.MAX_VALUE,qt=0;const bn=ot.aabb.getCorners(),fn=[];for(const Nn of bn){s.at(fn,Nn,pe),Z||(E?fn[2]*=se:fn[2]=Rt);const Bn=s.bG(fn,this._camera.forward());Bn<Pt&&(Pt=Bn,qt=Math.abs(fn[2]))}let pn=(1<<ft-ot.zoom)*Pe*Yt;if(pn*=ht(Math.max(qt,Rt),Pt),Pt<pn)return!0;const Rn=ot.aabb.closestPoint(H);return Rn[0]===H[0]&&Rn[1]===H[1]};if(this.renderWorldCopies)for(let ot=1;ot<=3;ot++)et.push(We(-ot)),et.push(We(ot));for(et.push(We(0));et.length>0;){const ot=et.pop(),At=ot.x,Tt=ot.y;let Nt=ot.fullyVisible;const Yt=()=>this.projection.name==="globe"&&(ot.y===0||ot.y===(1<<ot.zoom)-1);if(!Nt){let Pt=ge?ot.aabb.intersects(Q):ot.aabb.intersectsFlat(Q);if(Pt===0&&Yt()){const qt=new s.cp(ot.zoom,At,Tt);Pt=s.cq(this,j,qt,!0).intersects(Q)}if(Pt===0)continue;Nt=Pt===2}if(ot.zoom!==ft&&Dt(ot))for(let Pt=0;Pt<4;Pt++){const qt=(At<<1)+Pt%2,bn=(Tt<<1)+(Pt>>1),fn={aabb:C?ot.aabb.quadrant(Pt):s.cr(this,j,ot.zoom+1,qt,bn,ot.wrap,ot.minZ,ot.maxZ,this.projection),zoom:ot.zoom+1,x:qt,y:bn,wrap:ot.wrap,fullyVisible:Nt,tileID:void 0,shouldSplit:void 0,minZ:ot.minZ,maxZ:ot.maxZ};E&&!Z&&(fn.tileID=new s.aM(ot.zoom+1===ft?Mt:ot.zoom+1,ot.wrap,ot.zoom+1,qt,bn),jt(fn)),et.push(fn)}else{const Pt=ot.zoom===ft?Mt:ot.zoom;if(o.minzoom&&o.minzoom>Pt)continue;let qt=0;if(!Nt){let Rn=ge?ot.aabb.intersectsPrecise(Q):ot.aabb.intersectsPreciseFlat(Q);if(Rn===0&&Yt()){const Nn=new s.cp(ot.zoom,At,Tt);Rn=s.cq(this,j,Nn,!0).intersectsPrecise(Q)}if(Rn===0)continue;if(o.calculateQuadrantVisibility)if(Q.containsPoint(ot.aabb.center))qt=15;else for(let Nn=0;Nn<4;Nn++)ot.aabb.quadrant(Nn).intersects(Q)!==0&&(qt|=1<<Nn)}const bn=H[0]-(.5+At+(ot.wrap<<ot.zoom))*(1<<f-ot.zoom),fn=H[1]-.5-Tt,pn=ot.tileID?ot.tileID:new s.aM(Pt,ot.wrap,ot.zoom,At,Tt);o.calculateQuadrantVisibility&&(pn.visibleQuadrants=qt),_t.push({tileID:pn,distanceSq:bn*bn+fn*fn})}}if(this.fogCullDistSq){const ot=this.fogCullDistSq,At=this.horizonLineFromTop();_t=_t.filter(Tt=>{const Nt=[0,0,0,1],Yt=[s.aj,s.aj,0,1],Pt=this.calculateFogTileMatrix(Tt.tileID.toUnwrapped());s.aA(Nt,Nt,Pt),s.aA(Yt,Yt,Pt);const qt=s.cs([],Nt,Yt),bn=s.ct([],Nt,Yt),fn=s.cM(qt,bn);if(fn===0)return!0;let pn=!1;const Rn=this._elevation;if(Rn&&fn>ot&&At!==0){const Nn=this.calculateProjMatrix(Tt.tileID.toUnwrapped());let Bn;o.isTerrainDEM||(Bn=Rn.getMinMaxForTile(Tt.tileID)),Bn||(Bn={min:qe,max:Ye});const Xn=s.cu(this.rotation),ai=[Xn[0]*s.aj,Xn[1]*s.aj,Bn.max];s.ad(ai,ai,Nn),pn=(1-ai[1])*this.height*.5<At}return fn<ot||pn})}return _t.sort((ot,At)=>ot.distanceSq-At.distanceSq).map(ot=>ot.tileID)}resize(o,f){this.width=o,this.height=f,this.pixelsToGLUnits=[2/o,-2/f],this._constrain(),this._calcMatrices()}get unmodified(){return this._unmodified}zoomScale(o){return Math.pow(2,o)}scaleZoom(o){return Math.log(o)/Math.LN2}project(o){const f=s.ay(o.lat,-85.051129,s.cv),y=this.projection.project(o.lng,f);return new s.P(y.x*this.worldSize,y.y*this.worldSize)}unproject(o){return this.projection.unproject(o.x/this.worldSize,o.y/this.worldSize)}get point(){return this.project(this.center)}get pointMerc(){return this.point._div(this.worldSize)}get pixelsPerMeterRatio(){return this.pixelsPerMeter/s.c6(1,this.center.lat)/this.worldSize}setLocationAtPoint(o,f){let y,w;const E=this.centerPoint;if(this.projection.name==="globe"){const M=this.worldSize;y=(f.x-E.x)/M,w=(f.y-E.y)/M}else{const M=this.pointCoordinate(f),N=this.pointCoordinate(E);y=M.x-N.x,w=M.y-N.y}const C=this.locationCoordinate(o);this.setLocation(new s.ac(C.x-y,C.y-w))}setLocation(o){this.center=this.coordinateLocation(o),this.projection.wrap&&(this.center=this.center.wrap())}locationPoint(o,f){return this.projection.locationPoint(this,o,f)}locationPoint3D(o,f){return this.projection.locationPoint(this,o,f,!0)}pointLocation(o){return this.coordinateLocation(this.pointCoordinate(o))}pointLocation3D(o,f){return this.coordinateLocation(this.pointCoordinate3D(o,f))}locationCoordinate(o,f){const y=f?s.c6(f,o.lat):void 0,w=this.projection.project(o.lng,o.lat);return new s.ac(w.x,w.y,y)}coordinateLocation(o){return this.projection.unproject(o.x,o.y)}pointRayIntersection(o,f){const y=f??this._centerAltitude,w=[o.x,o.y,0,1],E=[o.x,o.y,1,1];s.aA(w,w,this.pixelMatrixInverse),s.aA(E,E,this.pixelMatrixInverse);const C=E[3];s.cw(w,w,1/w[3]),s.cw(E,E,1/C);const M=w[2],N=E[2];return{p0:w,p1:E,t:M===N?0:(y-M)/(N-M)}}screenPointToMercatorRay(o){const f=[o.x,o.y,0,1],y=[o.x,o.y,1,1];return s.aA(f,f,this.pixelMatrixInverse),s.aA(y,y,this.pixelMatrixInverse),s.cw(f,f,1/f[3]),s.cw(y,y,1/y[3]),f[2]=s.c6(f[2],this._center.lat)*this.worldSize,y[2]=s.c6(y[2],this._center.lat)*this.worldSize,s.cw(f,f,1/this.worldSize),s.cw(y,y,1/this.worldSize),new s.av([f[0],f[1],f[2]],s.au([],s.at([],y,f)))}rayIntersectionCoordinate(o){const{p0:f,p1:y,t:w}=o,E=s.c6(f[2],this._center.lat),C=s.c6(y[2],this._center.lat);return new s.ac(s.ai(f[0],y[0],w)/this.worldSize,s.ai(f[1],y[1],w)/this.worldSize,s.ai(E,C,w))}pointCoordinate(o,f=this._centerAltitude){return this.projection.pointCoordinate(this,o.x,o.y,f)}pointCoordinate3D(o,f){if(!this.elevation)return this.pointCoordinate(o,f);let y=this.projection.pointCoordinate3D(this,o.x,o.y);if(y)return new s.ac(y[0],y[1],y[2]);let w=0,E=this.horizonLineFromTop();if(o.y>E)return this.pointCoordinate(o,f);const C=.02*E,M=o.clone();for(let N=0;N<10&&E-w>C;N++){M.y=s.ai(w,E,.66);const j=this.projection.pointCoordinate3D(this,M.x,M.y);j?(E=M.y,y=j):w=M.y}return y?new s.ac(y[0],y[1],y[2]):this.pointCoordinate(o)}isPointAboveHorizon(o){return this.projection.isPointAboveHorizon(this,o)}isPointOnSurface(o){if(o.y<0||o.y>this.height||o.x<0||o.x>this.width)return!1;if(this.elevation||this.zoom>=s.cx)return!this.isPointAboveHorizon(o);const f=this.pointCoordinate(o);return f.y>=0&&f.y<=1}_coordinatePoint(o,f){const y=f&&this.elevation?this.elevation.getAtPointOrZero(o,this._centerAltitude):this._centerAltitude,w=[o.x*this.worldSize,o.y*this.worldSize,y+o.toAltitude(),1];return s.aA(w,w,this.pixelMatrix),w[3]>0?new s.P(w[0]/w[3],w[1]/w[3]):new s.P(Number.MAX_VALUE,Number.MAX_VALUE)}_getBoundsNonRectangular(){const{top:o,left:f}=this._edgeInsets,y=this.height-this._edgeInsets.bottom,w=this.width-this._edgeInsets.right,E=this.pointLocation3D(new s.P(f,o)),C=this.pointLocation3D(new s.P(w,o)),M=this.pointLocation3D(new s.P(w,y)),N=this.pointLocation3D(new s.P(f,y));let j=Math.min(E.lng,C.lng,M.lng,N.lng),H=Math.max(E.lng,C.lng,M.lng,N.lng),Z=Math.min(E.lat,C.lat,M.lat,N.lat),W=Math.max(E.lat,C.lat,M.lat,N.lat);const Q=Math.pow(2,-this.zoom)/16*270,ce=this.projection.name==="globe"?1:4,se=(ue,pe,ge,Pe,Ve)=>{const Ye=(ue+ge)/2,qe=(pe+Pe)/2,je=new s.P(Ye,qe),{lng:Ue,lat:We}=this.pointLocation3D(je),et=Math.max(0,j-Ue,Z-We,Ue-H,We-W);j=Math.min(j,Ue),H=Math.max(H,Ue),Z=Math.min(Z,We),W=Math.max(W,We),(Ve<ce||et>Q)&&(se(ue,pe,Ye,qe,Ve+1),se(Ye,qe,ge,Pe,Ve+1))};if(se(f,o,w,o,1),se(w,o,w,y,1),se(w,y,f,y,1),se(f,y,f,o,1),this.projection.name==="globe"){const[ue,pe]=s.cy(this);ue?(W=90,H=180,j=-180):pe&&(Z=-90,H=180,j=-180)}return new s.aG(new s.cd(j,Z),new s.cd(H,W))}_getBoundsRectangular(o,f){const{top:y,left:w}=this._edgeInsets,E=this.height-this._edgeInsets.bottom,C=this.width-this._edgeInsets.right,M=new s.P(w,y),N=new s.P(C,y),j=new s.P(C,E),H=new s.P(w,E);let Z=this.pointCoordinate(M,o),W=this.pointCoordinate(N,o);const Q=this.pointCoordinate(j,f),ce=this.pointCoordinate(H,f),se=(ue,pe)=>(pe.y-ue.y)/(pe.x-ue.x);return Z.y>1&&W.y>=0?Z=new s.ac((1-ce.y)/se(ce,Z)+ce.x,1):Z.y<0&&W.y<=1&&(Z=new s.ac(-ce.y/se(ce,Z)+ce.x,0)),W.y>1&&Z.y>=0?W=new s.ac((1-Q.y)/se(Q,W)+Q.x,1):W.y<0&&Z.y<=1&&(W=new s.ac(-Q.y/se(Q,W)+Q.x,0)),new s.aG().extend(this.coordinateLocation(Z)).extend(this.coordinateLocation(W)).extend(this.coordinateLocation(ce)).extend(this.coordinateLocation(Q))}_getBoundsRectangularTerrain(){const o=this.elevation;if(!o.visibleDemTiles.length||o.isUsingMockSource())return this._getBoundsRectangular(0,0);const f=o.visibleDemTiles.reduce((y,w)=>{if(w.dem){const E=w.dem.tree;y.min=Math.min(y.min,E.minimums[0]),y.max=Math.max(y.max,E.maximums[0])}return y},{min:Number.MAX_VALUE,max:0});return this._getBoundsRectangular(f.min*o.exaggeration(),f.max*o.exaggeration())}getBounds(){return this.projection.name==="mercator"||this.projection.name==="equirectangular"?this._terrainEnabled()?this._getBoundsRectangularTerrain():this._getBoundsRectangular(0,0):this._getBoundsNonRectangular()}horizonLineFromTop(o=!0){const f=this.height/2/Math.tan(this._fov/2)/Math.tan(Math.max(this._pitch,.1))-this.centerOffset.y,y=this.height/2-f*(1-this._horizonShift);return o?Math.max(0,y):y}getMaxBounds(){return this.maxBounds}setMaxBounds(o){this.maxBounds=o,this.minLat=-85.051129,this.maxLat=s.cv,this.minLng=-180,this.maxLng=180,o&&(this.minLat=o.getSouth(),this.maxLat=o.getNorth(),this.minLng=o.getWest(),this.maxLng=o.getEast(),this.maxLng<this.minLng&&(this.maxLng+=360)),this.worldMinX=s.aD(this.minLng)*this.tileSize,this.worldMaxX=s.aD(this.maxLng)*this.tileSize,this.worldMinY=s.aH(this.maxLat)*this.tileSize,this.worldMaxY=s.aH(this.minLat)*this.tileSize,this._constrain()}calculatePosMatrix(o,f){return this.projection.createTileMatrix(this,f,o)}calculateDistanceTileData(o){const f=o.key,y=this._distanceTileDataCache;if(y[f])return y[f];const w=o.canonical,E=1/this.height,C=this.cameraWorldSize,M=C/this.zoomScale(w.z),N=(w.x+Math.pow(2,w.z)*o.wrap)*M,j=w.y*M,H=this.point;H.x*=C/this.worldSize,H.y*=C/this.worldSize;const Z=this.angle,W=Math.sin(-Z),Q=-Math.cos(-Z);return y[f]={bearing:[W,Q],center:[(H.x-N)*E,(H.y-j)*E],scale:M/s.aj*E},y[f]}calculateFogTileMatrix(o){const f=o.key,y=this._fogTileMatrixCache;if(y[f])return y[f];const w=this.projection.createTileMatrix(this,this.cameraWorldSizeForFog,o);return s.az(w,this.worldToFogMatrix,w),y[f]=new Float32Array(w),y[f]}calculateProjMatrix(o,f=!1,y=!1){const w=o.key;let E;if(E=y?this._expandedProjMatrixCache:f?this._alignedProjMatrixCache:this._projMatrixCache,E[w])return E[w];const C=this.calculatePosMatrix(o,this.worldSize);let M;return M=this.projection.isReprojectedInTileSpace?this.mercatorMatrix:y?this.expandedFarZProjMatrix:f?this.alignedProjMatrix:this.projMatrix,s.az(C,M,C),E[w]=new Float32Array(C),E[w]}calculatePixelsToTileUnitsMatrix(o){const f=o.tileID.key,y=this._pixelsToTileUnitsCache;if(y[f])return y[f];const w=s.cz(o,this);return y[f]=w,y[f]}customLayerMatrix(){return this.mercatorMatrix.slice()}globeToMercatorMatrix(){if(this.projection.name==="globe"){const o=1/this.worldSize,f=s.bn([],[o,o,o]);return s.az(f,f,this.globeMatrix),f}}recenterOnTerrain(){if(!this._elevation||this.projection.name==="globe")return;const o=this._elevation;this._updateCameraState();const f=s.c6(1,this._center.lat)*this.worldSize,y=this._computeCameraPosition(f),w=this._camera.forward(),E=s.c6(1,this._center.lat);y[2]/=E,w[2]/=E,s.au(w,w);const C=o.raycast(y,w,o.exaggeration());if(C){const M=s.bE([],y,w,C),N=new s.ac(M[0],M[1],s.c6(M[2],s.aY(M[1]))),j=(N.z+s.ae([N.x-y[0],N.y-y[1],N.z-y[2]*E]))*this._pixelsPerMercatorPixel;this._seaLevelZoom=this._zoomFromMercatorZ(j),this._centerAltitude=N.toAltitude(),this._center=this.coordinateLocation(N),this._updateZoomFromElevation(),this._constrain(),this._calcMatrices()}}_constrainCamera(o=!1){if(!this._elevation)return;const f=this._elevation,y=s.c6(1,this._center.lat)*this.worldSize,w=this._computeCameraPosition(y),E=f.getAtPointOrZero(new s.ac(...w)),C=this.pixelsPerMeter/this.worldSize*E,M=this._minimumHeightOverTerrain(),N=w[2]-C;if(N<=M)if(N<0||o){const j=this.locationCoordinate(this._center,this._centerAltitude),H=[w[0],w[1],j.z-w[2]],Z=s.ae(H);H[2]-=(M-N)/this._pixelsPerMercatorPixel;const W=s.ae(H);if(W===0)return;s.bY(H,H,Z/W*this._pixelsPerMercatorPixel),this._camera.position=[w[0],w[1],j.z*this._pixelsPerMercatorPixel-H[2]],this._updateStateFromCamera()}else this._isCameraConstrained=!0}_constrain(){if(!this.center||!this.width||!this.height||this._constraining)return;this._constraining=!0;const o=this.projection.name==="globe"||this.mercatorFromTransition;if(this.projection.isReprojectedInTileSpace||o){const W=this.center;return W.lat=s.ay(W.lat,this.minLat,this.maxLat),(this.maxBounds||!this.renderWorldCopies&&!o)&&(W.lng=s.ay(W.lng,this.minLng,this.maxLng)),this.center=W,void(this._constraining=!1)}const f=this._unmodified,{x:y,y:w}=this.point;let E=0,C=y,M=w;const N=this.width/2,j=this.height/2,H=this.worldMinY*this.scale,Z=this.worldMaxY*this.scale;if(w-j<H&&(M=H+j),w+j>Z&&(M=Z-j),Z-H<this.height&&(E=Math.max(E,this.height/(Z-H)),M=(Z+H)/2),this.maxBounds||!this._renderWorldCopies||!this.projection.wrap){const W=this.worldMinX*this.scale,Q=this.worldMaxX*this.scale,ce=this.worldSize/2-(W+Q)/2;C=(y+ce+this.worldSize)%this.worldSize-ce,C-N<W&&(C=W+N),C+N>Q&&(C=Q-N),Q-W<this.width&&(E=Math.max(E,this.width/(Q-W)),C=(Q+W)/2)}C===y&&M===w||this._allowWorldUnderZoom||(this.center=this.unproject(new s.P(C,M))),E&&!this._allowWorldUnderZoom&&(this.zoom+=this.scaleZoom(E)),this._constrainCamera(),this._unmodified=f,this._constraining=!1}_minZoomForBounds(){let o=Math.max(0,this.scaleZoom(Math.max(0,this.height)/(this.worldMaxY-this.worldMinY)));return this.maxBounds&&(o=Math.max(o,this.scaleZoom(this.width/(this.worldMaxX-this.worldMinX)))),o}_maxCameraBoundsDistance(){return this._mercatorZfromZoom(this._minZoomForBounds())}_calcMatrices(){if(!this.height)return;const o=this.centerOffset,f=this.projection.name==="globe",y=this.pixelsPerMeter;this.projection.name==="globe"&&(this._mercatorScaleRatio=s.c6(1,this.center.lat)/s.c6(1,s.cP));const w=s.cA(this.projection,this.zoom,this.width,this.height,1024);this._pixelsPerMercatorPixel=this.projection.pixelSpaceConversion(this.center.lat,this.worldSize,w),this.cameraToCenterDistance=.5/Math.tan(.5*this._fov)*this.height*this._pixelsPerMercatorPixel,this._updateCameraState(),this._farZ=this.projection.farthestPixelDistance(this),this._nearZ=this.height/50;const E=this.projection.zAxisUnit==="meters"?y:1,C=this._camera.getWorldToCamera(this.worldSize,E);let M;const N=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,this._farZ);if(N[8]=2*-o.x/this.width,N[9]=2*o.y/this.height,this.isOrthographic){let We=.5*this.height/Math.tan(this._fov/2)*1*Math.tan(.5*this._fov),et=We*this.aspect,_t=-et,ft=-We;et-=o.x,_t-=o.x,We+=o.y,ft+=o.y,M=this._camera.getCameraToClipOrthographic(_t,et,ft,We,this._nearZ,this._farZ),((Mt,Rt,jt,ht)=>{for(let Dt=0;Dt<16;Dt++)Mt[Dt]=s.ai(Rt[Dt],jt[Dt],ht)})(M,M,N,s.cN(this.pitch>=fo?1:this.pitch/fo))}else M=N;const j=s.cB([],N,C);let H=s.cB([],M,C);if(this.projection.isReprojectedInTileSpace){const We=this.locationCoordinate(this.center),et=s.bx([]);s.bo(et,et,[We.x*this.worldSize,We.y*this.worldSize,0]),s.az(et,et,s.cC(this)),s.bo(et,et,[-We.x*this.worldSize,-We.y*this.worldSize,0]),s.az(H,H,et),s.az(j,j,et),this.inverseAdjustmentMatrix=s.cD(this)}else this.inverseAdjustmentMatrix=[1,0,0,1];if(this.mercatorMatrix=s.cE([],H,[this.worldSize,this.worldSize,this.worldSize/E,1]),this.projMatrix=H,this.invProjMatrix=s.bi(new Float64Array(16),this.projMatrix),f){const We=this._camera.getCameraToClipPerspective(this._fov,this.width/this.height,this._nearZ,1/0);We[8]=2*-o.x/this.width,We[9]=2*o.y/this.height,this.expandedFarZProjMatrix=s.cB([],We,C)}else this.expandedFarZProjMatrix=this.projMatrix;const Z=s.bi([],M);this.frustumCorners=s.cF.fromInvProjectionMatrix(Z,this.horizonLineFromTop(),this.height),this.cameraFrustum=s.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,0,!f);const W=new Float32Array(16);s.bx(W),s.cE(W,W,[1,-1,1]),s.cG(W,W,this._pitch),s.by(W,W,this.angle);const Q=s.c4(new Float32Array(16),this._fov,this.width/this.height,this._nearZ,this._farZ);this.starsProjMatrix=s.bw(Q);const ce=(Math.PI/2-this._pitch)*(this.height/this._fov)*this._horizonShift;Q[8]=2*-o.x/this.width,Q[9]=2*(o.y+ce)/this.height,this.skyboxMatrix=s.az(W,Q,W);const se=this.point,ue=se.x,pe=se.y,ge=this.width%2/2,Pe=this.height%2/2,Ve=Math.cos(this.angle),Ye=Math.sin(this.angle),qe=ue-Math.round(ue)+Ve*ge+Ye*Pe,je=pe-Math.round(pe)+Ve*Pe+Ye*ge,Ue=new Float64Array(H);if(s.bo(Ue,Ue,[qe>.5?qe-1:qe,je>.5?je-1:je,0]),this.alignedProjMatrix=Ue,H=s.bz(),s.cE(H,H,[this.width/2,-this.height/2,1]),s.bo(H,H,[1,-1,0]),this.labelPlaneMatrix=H,H=s.bz(),s.cE(H,H,[1,-1,1]),s.bo(H,H,[-1,-1,0]),s.cE(H,H,[2/this.width,2/this.height,1]),this.glCoordMatrix=H,this.pixelMatrix=s.az(new Float64Array(16),this.labelPlaneMatrix,j),this._calcFogMatrices(),this._distanceTileDataCache={},H=s.bi(new Float64Array(16),this.pixelMatrix),!H)throw new Error("failed to invert matrix");if(this.pixelMatrixInverse=H,this.projection.name==="globe"||this.mercatorFromTransition){this.globeMatrix=s.cH(this);const We=[this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]];this.globeCenterInViewSpace=s.ad(We,We,C),this.globeRadius=this.worldSize/2/Math.PI-1}else this.globeMatrix=H;this._projMatrixCache={},this._alignedProjMatrixCache={},this._pixelsToTileUnitsCache={},this._expandedProjMatrixCache={}}_calcFogMatrices(){this._fogTileMatrixCache={};const o=this.cameraWorldSizeForFog,f=this.cameraPixelsPerMeter,y=this._camera.position,w=1/this.height/this._pixelsPerMercatorPixel,E=[o,o,f];s.bY(E,E,w),s.bY(y,y,-1),s.cI(y,y,E);const C=s.bz();s.bo(C,C,y),s.cE(C,C,E),this.mercatorFogMatrix=C,this.worldToFogMatrix=this._camera.getWorldToCameraPosition(o,f,w)}_computeCameraPosition(o){const f=(o=o||this.pixelsPerMeter)/this.pixelsPerMeter,y=this._camera.forward(),w=this.point,E=this._mercatorZfromZoom(this._seaLevelZoom?this._seaLevelZoom:this._zoom)*f-o/this.worldSize*this._centerAltitude;return[w.x/this.worldSize-y[0]*E,w.y/this.worldSize-y[1]*E,o/this.worldSize*this._centerAltitude-y[2]*E]}_updateCameraState(){this.height&&(this._camera.setPitchBearing(this._pitch,this.angle),this._camera.position=this._computeCameraPosition())}_translateCameraConstrained(o){const f=this._maxCameraBoundsDistance()*Math.cos(this._pitch),y=this._camera.position[2],w=o[2];let E=1;this.projection.wrap&&(this.center=this.center.wrap()),w>0&&(E=Math.min((f-y)/w,1)),this._camera.position=s.bE([],this._camera.position,o,E),this._updateStateFromCamera()}_updateStateFromCamera(){const o=this._camera.position,f=this._camera.forward(),{pitch:y,bearing:w}=this._camera.getPitchBearing(),E=s.c6(this._centerAltitude,this.center.lat)*this._pixelsPerMercatorPixel,C=this._mercatorZfromZoom(this._maxZoom)*Math.cos(s.al(this._maxPitch)),M=Math.max((o[2]-E)/Math.cos(y),C),N=this._zoomFromMercatorZ(M);s.bE(o,o,f,M),this._pitch=s.ay(y,s.al(this.minPitch),s.al(this.maxPitch)),this.angle=s.bX(w,-Math.PI,Math.PI),this._setZoom(s.ay(N,this._minZoom,this._maxZoom)),this._updateSeaLevelZoom(),this._center=this.coordinateLocation(new s.ac(o[0],o[1],o[2])),this._unmodified=!1,this._constrain(),this._calcMatrices()}_worldSizeFromZoom(o){return Math.pow(2,o)*this.tileSize}_mercatorZfromZoom(o){return this.cameraToCenterDistance/this._worldSizeFromZoom(o)}_minimumHeightOverTerrain(){const o=Math.min(this._seaLevelZoom!=null?this._seaLevelZoom:this._zoom,this._maxZoom)+4;return this._mercatorZfromZoom(o)}_zoomFromMercatorZ(o){return this.scaleZoom(this.cameraToCenterDistance/(Math.max(0,o)*this.tileSize))}zoomFromMercatorZAdjusted(o){let f=0,y=s.cx,w=0,E=1/0;for(;y-f>1e-6&&y>f;){const C=f+.5*(y-f),M=this.tileSize*Math.pow(2,C),N=this.getCameraToCenterDistance(this.projection,C,M),j=this.scaleZoom(N/(Math.max(0,o)*this.tileSize)),H=Math.abs(C-j);H<E&&(E=H,w=C),C<j?f=C:y=C}return w}_terrainEnabled(){return!(!this._elevation||!this.projection.supportsTerrain&&(s.w("Terrain is not yet supported with alternate projections. Use mercator or globe to enable terrain."),1))}anyCornerOffEdge(o,f){const y=Math.min(o.x,f.x),w=Math.max(o.x,f.x),E=Math.min(o.y,f.y),C=Math.max(o.y,f.y);if(E<this.horizonLineFromTop(!1))return!0;if(this.projection.name!=="mercator")return!1;const M=[new s.P(y,E),new s.P(w,C),new s.P(y,C),new s.P(w,E)],N=this.renderWorldCopies?-3:0,j=this.renderWorldCopies?4:1;for(const H of M){const Z=this.pointRayIntersection(H);if(Z.t<0)return!0;const W=this.rayIntersectionCoordinate(Z);if(W.x<N||W.y<0||W.x>j||W.y>1)return!0}return!1}isHorizonVisible(){return this.pitch+s.cJ(this.fovAboveCenter)>88||this.anyCornerOffEdge(new s.P(0,0),new s.P(this.width,this.height))}zoomDeltaToMovement(o,f){const y=s.ae(s.at([],this._camera.position,o)),w=this._zoomFromMercatorZ(y)+f;return y-this._mercatorZfromZoom(w)}getCameraPoint(){if(this.projection.name==="globe"){const o=function([f,y,w],E){const C=[f,y,w,1];s.aA(C,C,E);const M=C[3]=Math.max(C[3],1e-6);return C[0]/=M,C[1]/=M,C[2]/=M,C}([this.globeMatrix[12],this.globeMatrix[13],this.globeMatrix[14]],this.pixelMatrix);return new s.P(o[0],o[1])}{const o=Math.tan(this._pitch)*(this.cameraToCenterDistance||1);return this.centerPoint.add(new s.P(0,o))}}getCameraToCenterDistance(o,f=this.zoom,y=this.worldSize){const w=s.cA(o,f,this.width,this.height,1024),E=o.pixelSpaceConversion(this.center.lat,y,w);let C=.5/Math.tan(.5*this._fov)*this.height*E;return this.isOrthographic&&(C=s.ai(1,C,s.cN(this.pitch>=fo?1:this.pitch/fo))),C}getWorldToCameraMatrix(){const o=this._camera.getWorldToCamera(this.worldSize,this.projection.zAxisUnit==="meters"?this.pixelsPerMeter:1);return this.projection.name==="globe"&&s.az(o,o,this.globeMatrix),o}getFrustum(o){return s.cn.fromInvProjectionMatrix(this.invProjMatrix,this.worldSize,o,this.projection.zAxisUnit==="meters")}}const oa=(_,o)=>{if(o>0&&_.terrain&&s.w("Cutoff is currently disabled on terrain"),o<=0||_.terrain)return{shouldRenderCutoff:!1,uniformValues:{u_cutoff_params:[0,0,0,1]}};const f=_.transform,y=Math.max(Math.abs(f._zoom-(_.minCutoffZoom-1)),1),w=f.isLODDisabled(!1)?s.af(60,45,f.pitch):s.af(30,15,f.pitch),E=f._farZ-f._nearZ,C=o*f.height,M=((1-(N=w))*f.cameraToCenterDistance+N*(f._farZ+C))*y;var N;return{shouldRenderCutoff:w<1,uniformValues:{u_cutoff_params:[f._nearZ,f._farZ,(M-f._nearZ)/E,(M-C-f._nearZ)/E]}}},Vs={cascadeCount:2,normalOffset:3,shadowMapResolution:2048};class ff{constructor(o,f){this.aabb=o,this.lastCascade=f}}class f0{add(o,f){const y=this.receivers[o.key];y!==void 0?(y.aabb.min[0]=Math.min(y.aabb.min[0],f.min[0]),y.aabb.min[1]=Math.min(y.aabb.min[1],f.min[1]),y.aabb.min[2]=Math.min(y.aabb.min[2],f.min[2]),y.aabb.max[0]=Math.max(y.aabb.max[0],f.max[0]),y.aabb.max[1]=Math.max(y.aabb.max[1],f.max[1]),y.aabb.max[2]=Math.max(y.aabb.max[2],f.max[2])):this.receivers[o.key]=new ff(f,null)}clear(){this.receivers={}}get(o){return this.receivers[o.key]}computeRequiredCascades(o,f,y){const w=s.cW.fromPoints(o.points);let E=0;for(const C in this.receivers){const M=this.receivers[C];if(!M||!w.intersectsAabb(M.aabb))continue;M.aabb.min=w.closestPoint(M.aabb.min),M.aabb.max=w.closestPoint(M.aabb.max);const N=M.aabb.getCorners();for(let j=0;j<y.length;j++){let H=!0;for(const Z of N){const W=[Z[0]*f,Z[1]*f,Z[2]];if(s.ad(W,W,y[j].matrix),W[0]<-1||W[0]>1||W[1]<-1||W[1]>1){H=!1;break}}if(M.lastCascade=j,E=Math.max(E,j),H)break}}return E+1}}class Jm{constructor(o){this.painter=o,this._enabled=!1,this._shadowLayerCount=0,this._numCascadesToRender=0,this._cascades=[],this._groundShadowTiles=[],this._receivers=new f0,this._depthMode=new an(o.context.gl.LEQUAL,an.ReadWrite,[0,1]),this._uniformValues={u_light_matrix_0:new Float32Array(16),u_light_matrix_1:new Float32Array(16),u_shadow_intensity:0,u_fade_range:[0,0],u_shadow_normal_offset:[1,1,1],u_shadow_texel_size:1,u_shadow_map_resolution:1,u_shadow_direction:[0,0,1],u_shadow_bias:[36e-5,.0012,.012],u_shadowmap_0:0,u_shadowmap_1:0},this._forceDisable=!1,this.useNormalOffset=!1,o.tp.registerParameter(this,["Shadows"],"_forceDisable",{label:"forceDisable"},()=>{this.painter.style.map.triggerRepaint()}),o.tp.registerParameter(Vs,["Shadows"],"cascadeCount",{min:1,max:2,step:1}),o.tp.registerParameter(Vs,["Shadows"],"normalOffset",{min:0,max:10,step:.05}),o.tp.registerParameter(Vs,["Shadows"],"shadowMapResolution",{min:32,max:2048,step:32}),o.tp.registerBinding(this,["Shadows"],"_numCascadesToRender",{readonly:!0,label:"numCascadesToRender"})}destroy(){for(const o of this._cascades)o.texture.destroy(),o.framebuffer.destroy();this._cascades=[]}updateShadowParameters(o,f){const y=this.painter;if(this._enabled=!1,this._shadowLayerCount=0,this._receivers.clear(),!f||!f.properties)return;const w=f.properties.get("shadow-intensity");if(!f.shadowsEnabled()||w<=0||(this._shadowLayerCount=y.style.order.reduce((ce,se)=>{const ue=y.style._mergedLayers[se];return ce+(ue.hasShadowPass()&&!ue.isHidden(o.zoom)?1:0)},0),this._enabled=this._shadowLayerCount>0,!this.enabled))return;const E=y.context,C=Vs.shadowMapResolution,M=Vs.shadowMapResolution;if(this._cascades.length===0||Vs.shadowMapResolution!==this._cascades[0].texture.size[0]){this._cascades=[];for(let ce=0;ce<Vs.cascadeCount;++ce){const se=y._shadowMapDebug,ue=E.gl,pe=E.createFramebuffer(C,M,se,"texture"),ge=new s.T(E,{width:C,height:M,data:null},ue.DEPTH_COMPONENT16);if(pe.depthAttachment.set(ge.texture),se){const Pe=new s.T(E,{width:C,height:M,data:null},ue.RGBA8);pe.colorAttachment.set(Pe.texture)}this._cascades.push({framebuffer:pe,texture:ge,matrix:[],far:0,boundingSphereRadius:0,frustum:new s.cn,scale:0})}}this.shadowDirection=sc(f);let N=0;if(o.elevation){const ce=o.elevation,se=[1e4,-1e4];ce.visibleDemTiles.filter(ue=>ue.dem).forEach(ue=>{const pe=ue.dem.tree;se[0]=Math.min(se[0],pe.minimums[0]),se[1]=Math.max(se[1],pe.maximums[0])}),se[0]!==1e4&&(N=(se[1]-se[0])*ce.exaggeration())}const j=1.5*o.cameraToCenterDistance,H=3*j,Z=new Float64Array(16);for(let ce=0;ce<this._cascades.length;++ce){const se=this._cascades[ce];let ue=o.height/50,pe=1;Vs.cascadeCount===1?pe=H:ce===0?pe=j:(ue=j,pe=H);const[ge,Pe]=lh(o,this.shadowDirection,ue,pe,Vs.shadowMapResolution,N);se.scale=o.scale,se.matrix=ge,se.boundingSphereRadius=Pe,s.bi(Z,se.matrix),se.frustum=s.cn.fromInvProjectionMatrix(Z,1,0,!0),se.far=pe}const W=this._cascades.length-1;this._uniformValues.u_fade_range=[.75*this._cascades[W].far,this._cascades[W].far],this._uniformValues.u_shadow_intensity=w,this._uniformValues.u_shadow_direction=[this.shadowDirection[0],this.shadowDirection[1],this.shadowDirection[2]],this._uniformValues.u_shadow_texel_size=1/Vs.shadowMapResolution,this._uniformValues.u_shadow_map_resolution=Vs.shadowMapResolution,this._uniformValues.u_shadowmap_0=sa.ShadowMap0,this._uniformValues.u_shadowmap_1=sa.ShadowMap0+1,this._groundShadowTiles=y.transform.coveringTiles({tileSize:512,renderWorldCopies:!0});const Q=y.transform.elevation;for(const ce of this._groundShadowTiles){let se={min:0,max:0};if(Q){const ue=Q.getMinMaxForTile(ce);ue&&(se=ue)}this.addShadowReceiver(ce.toUnwrapped(),se.min,se.max)}}get enabled(){return this._enabled&&!this._forceDisable}set enabled(o){this._enabled=o}drawShadowPass(o,f){if(!this.enabled)return;const y=this.painter,w=y.context;this._numCascadesToRender=this._receivers.computeRequiredCascades(y.transform.getFrustum(0),y.transform.worldSize,this._cascades),w.viewport.set([0,0,Vs.shadowMapResolution,Vs.shadowMapResolution]);for(let E=0;E<this._numCascadesToRender;++E){y.currentShadowCascade=E,w.bindFramebuffer.set(this._cascades[E].framebuffer.framebuffer),w.clear({color:s.am.white,depth:1});for(const C of o.order){const M=o._mergedLayers[C];if(!M.hasShadowPass()||M.isHidden(y.transform.zoom))continue;const N=o.getLayerSourceCache(M),j=N?f[N.id]:void 0;(M.type==="model"||j&&j.length)&&y.renderLayer(y,N,M,j)}}y.currentShadowCascade=0}drawGroundShadows(){if(!this.enabled)return;const o=this.painter,f=o.style,y=o.context,w=y.gl,E=f.directionalLight,C=f.ambientLight;if(!E||!C)return;const M=[],N=oa(o,o.longestCutoffRange);N.shouldRenderCutoff&&M.push("RENDER_CUTOFF"),M.push("RENDER_SHADOWS","DEPTH_TEXTURE"),this.useNormalOffset&&M.push("NORMAL_OFFSET");const j=as(f,E,C),H=new an(w.LEQUAL,an.ReadOnly,o.depthRangeFor3D),Z=new Hn({func:w.EQUAL,mask:255},0,255,w.KEEP,w.KEEP,w.KEEP);for(const W of this._groundShadowTiles){const Q=W.toUnwrapped(),ce=o.isTileAffectedByFog(W),se=o.getOrCreateProgram("groundShadow",{defines:M,overrideFog:ce});this.setupShadows(Q,se),o.uploadCommonUniforms(y,se,Q,null,N);const ue={u_matrix:o.transform.calculateProjMatrix(Q),u_ground_shadow_factor:j};se.draw(o,w.TRIANGLES,H,Z,kn.multiply,Un.disabled,ue,"ground_shadow",o.tileExtentBuffer,o.quadTriangleIndexBuffer,o.tileExtentSegments,null,o.transform.zoom,null,null)}}getShadowPassColorMode(){return this.painter._shadowMapDebug?kn.unblended:kn.disabled}getShadowPassDepthMode(){return this._depthMode}getShadowCastingLayerCount(){return this._shadowLayerCount}calculateShadowPassMatrixFromTile(o){const f=this.painter.transform,y=f.calculatePosMatrix(o,f.worldSize);return s.az(y,this._cascades[this.painter.currentShadowCascade].matrix,y),Float32Array.from(y)}calculateShadowPassMatrixFromMatrix(o){return s.az(o,this._cascades[this.painter.currentShadowCascade].matrix,o),Float32Array.from(o)}setupShadows(o,f,y,w=0){if(!this.enabled)return;const E=this.painter.transform,C=this.painter.context,M=C.gl,N=this._uniformValues,j=new Float64Array(16),H=E.calculatePosMatrix(o,E.worldSize);for(let Z=0;Z<this._cascades.length;Z++)s.az(j,this._cascades[Z].matrix,H),N[Z===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(j),C.activeTexture.set(M.TEXTURE0+sa.ShadowMap0+Z),this._cascades[Z].texture.bindExtraParam(M.LINEAR,M.LINEAR,M.CLAMP_TO_EDGE,M.CLAMP_TO_EDGE,M.GREATER);if(this.useNormalOffset=!!y,this.useNormalOffset){const Z=s.cU(o.canonical),W=2/E.tileSize*s.aj/Vs.shadowMapResolution,Q=W*this._cascades[0].boundingSphereRadius,ce=W*this._cascades[this._cascades.length-1].boundingSphereRadius,se=(y==="vector-tile"?1:3)/Math.pow(2,w-o.canonical.z-(1-E.zoom+Math.floor(E.zoom)));N.u_shadow_normal_offset=[Z,Q*se,ce*se],N.u_shadow_bias=[6e-5,.0012,.012]}else N.u_shadow_bias=[36e-5,.0012,.012];f.setShadowUniformValues(C,N)}setupShadowsFromMatrix(o,f,y=!1){if(!this.enabled)return;const w=this.painter.context,E=w.gl,C=this._uniformValues,M=new Float64Array(16);for(let N=0;N<Vs.cascadeCount;N++)s.az(M,this._cascades[N].matrix,o),C[N===0?"u_light_matrix_0":"u_light_matrix_1"]=Float32Array.from(M),w.activeTexture.set(E.TEXTURE0+sa.ShadowMap0+N),this._cascades[N].texture.bindExtraParam(E.LINEAR,E.LINEAR,E.CLAMP_TO_EDGE,E.CLAMP_TO_EDGE,E.GREATER);if(this.useNormalOffset=y,y){const N=Vs.normalOffset;C.u_shadow_normal_offset=[1,N,N],C.u_shadow_bias=[6e-5,.0012,.012]}else C.u_shadow_bias=[36e-5,.0012,.012];f.setShadowUniformValues(w,C)}getShadowUniformValues(){return this._uniformValues}getCurrentCascadeFrustum(){return this._cascades[this.painter.currentShadowCascade].frustum}computeSimplifiedTileShadowVolume(o,f,y,w){if(w[2]>=0)return{};const E=function(N,j,H){const Z=H/(1<<N.canonical.z);return new s.cW([N.canonical.x*Z+N.wrap*H,N.canonical.y*Z+N.wrap*H,0],[(N.canonical.x+1)*Z+N.wrap*H,(N.canonical.y+1)*Z+N.wrap*H,j])}(o,f,y).getCorners(),C=f/-w[2];w[0]<0?(s.cV(E[0],E[0],[w[0]*C,0,0]),s.cV(E[3],E[3],[w[0]*C,0,0])):w[0]>0&&(s.cV(E[1],E[1],[w[0]*C,0,0]),s.cV(E[2],E[2],[w[0]*C,0,0])),w[1]<0?(s.cV(E[0],E[0],[0,w[1]*C,0]),s.cV(E[1],E[1],[0,w[1]*C,0])):w[1]>0&&(s.cV(E[2],E[2],[0,w[1]*C,0]),s.cV(E[3],E[3],[0,w[1]*C,0]));const M={};return M.vertices=E,M.planes=[Kc(E[1],E[0],E[4]),Kc(E[2],E[1],E[5]),Kc(E[3],E[2],E[6]),Kc(E[0],E[3],E[7])],M}addShadowReceiver(o,f,y){this._receivers.add(o,s.cW.fromTileIdAndHeight(o,f,y))}getMaxCascadeForTile(o){const f=this._receivers.get(o);return f&&f.lastCascade?f.lastCascade:0}}function Kc(_,o,f){const y=s.at([],f,o),w=s.at([],_,o),E=s.bF([],y,w),C=s.ae(E);return C===0?[0,0,1,0]:(s.bY(E,E,1/C),[E[0],E[1],E[2],-s.bG(E,o)])}function sc(_){const o=_.properties.get("direction"),f=s.cR(o.x,o.y,o.z);f[2]=s.ay(f[2],0,75);const y=s.cT([f[0],f[1],f[2]]);return s.cS(y.x,y.y,y.z)}function as(_,o,f){const y=o.properties.get("color-use-theme")==="none",w=o.properties.get("color"),E=o.properties.get("intensity"),C=o.properties.get("direction"),M=[C.x,C.y,C.z],N=f.properties.get("color-use-theme")==="none",j=f.properties.get("color"),H=f.properties.get("intensity"),Z=Math.max(s.bG([0,0,1],M),0),W=[0,0,0];s.bY(W,j.toPremultipliedRenderColor(N?null:_.getLut(o.scope)).toArray01Linear().slice(0,3),H);const Q=[0,0,0];return s.bY(Q,w.toPremultipliedRenderColor(y?null:_.getLut(f.scope)).toArray01Linear().slice(0,3),Z*E),s.cY([W[0]>0?W[0]/(W[0]+Q[0]):0,W[1]>0?W[1]/(W[1]+Q[1]):0,W[2]>0?W[2]/(W[2]+Q[2]):0])}function lh(_,o,f,y,w,E){const C=_.zoom,M=_.scale,N=_.worldSize,j=1/N,H=_.aspect,Z=Math.sqrt(1+H*H)*Math.tan(.5*_.fovX),W=Z*Z,Q=y-f,ce=y+f;let se,ue;W>Q/ce?(se=y,ue=y*Z):(se=.5*ce*(1+W),ue=.5*Math.sqrt(Q*Q+2*(y*y+f*f)*W+ce*ce*W*W));const pe=_.projection.pixelsPerMeter(_.center.lat,N),ge=_._camera.getCameraToWorldMercator(),Pe=[0,0,-se*j];s.ad(Pe,Pe,ge);let Ve=ue*j;const Ye=_._edgeInsets;if(!(Ye.left===0&&Ye.top===0&&Ye.right===0&&Ye.bottom===0||Ye.left===Ye.right&&Ye.top===Ye.bottom)){const Nt=_._camera.getWorldToCamera(_.worldSize,_.projection.zAxisUnit==="meters"?pe:1),Yt=_._camera.getCameraToClipPerspective(_._fov,_.width/_.height,f,y);Yt[8]=2*-_.centerOffset.x/_.width,Yt[9]=2*_.centerOffset.y/_.height;const Pt=new Float64Array(16);s.cB(Pt,Yt,Nt);const qt=new Float64Array(16);s.bi(qt,Pt);const bn=s.cn.fromInvProjectionMatrix(qt,N,C,!0);for(const fn of bn.points){const pn=((qe=fn)[0]/=M,qe[1]/=M,qe[2]=s.c6(qe[2],_._center.lat),qe);Ve=Math.max(Ve,s.bZ(s.cX([],Pe,pn)))}}var qe;Ve*=w/(w-1);const je=Math.acos(o[2]),Ue=Math.atan2(-o[0],-o[1]),We=new wa;We.position=Pe,We.setPitchBearing(je,Ue);const et=We.getWorldToCamera(N,pe),_t=Ve*N,ft=Math.min(_._mercatorZfromZoom(17)*N*-2,-2*_t),Mt=We.getCameraToClipOrthographic(-_t,_t,-_t,_t,ft,(_t+E*pe)/o[2]),Rt=new Float64Array(16);s.az(Rt,Mt,et);const jt=s.cS(Math.floor(1e6*Pe[0])/1e6*N,Math.floor(1e6*Pe[1])/1e6*N,0),ht=.5*w,Dt=[0,0,0];s.ad(Dt,jt,Rt),s.bY(Dt,Dt,ht);const ot=[Math.floor(Dt[0]),Math.floor(Dt[1]),Math.floor(Dt[2])],At=[0,0,0];s.at(At,Dt,ot),s.bY(At,At,-1/ht);const Tt=new Float64Array(16);return s.bx(Tt),s.bo(Tt,Tt,At),s.az(Rt,Tt,Rt),[Rt,_t]}class p0 extends s.E{constructor(o){super(),this.requestManager=o,this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}loadModel(o,f){return s.aS(this.requestManager.transformRequest(f,s.R.Model).url).then(y=>{if(!y)return;const w=s.aT(y),E=new s.aU(o,void 0,void 0,w);return E.computeBoundsAndApplyParent(),E}).catch(y=>{if(y&&y.status===404)return null;this.fire(new s.z(new Error(`Could not load model ${o} from ${f}: ${y.message}`)))})}load(o,f,y={forceReload:!1}){this.models[f]||(this.models[f]={});const w=Object.keys(o),E=[],C=[];for(const M of w){const N=o[M];this.hasURLBeenRequested(N)&&!y.forceReload||(this.modelByURL[N]={modelId:M,scope:f},E.push(this.loadModel(M,N)),C.push(M)),this.models[f][M]||(this.models[f][M]={model:null,numReferences:1})}this.numModelsLoading[f]=(this.numModelsLoading[f]||0)+C.length,Promise.allSettled(E).then(M=>{for(let N=0;N<M.length;N++){const{status:j}=M[N];if(j==="rejected")continue;const{value:H}=M[N];this.models[f][C[N]]||(this.models[f][C[N]]={model:null,numReferences:1}),this.models[f][C[N]].model=H}this.numModelsLoading[f]-=C.length,this.fire(new s.A("data",{dataType:"style"}))}).catch(M=>{this.fire(new s.z(new Error(`Could not load models: ${M.message}`)))})}isLoaded(){for(const o in this.numModelsLoading)if(this.numModelsLoading[o]>0)return!1;return!0}hasModel(o,f,y={exactIdMatch:!1}){return!!(y.exactIdMatch?this.getModel(o,f):this.getModelByURL(this.modelUris[f][o]))}getModel(o,f){return this.models[f]||(this.models[f]={}),this.models[f][o]?this.models[f][o].model:void 0}getModelByURL(o){if(!o)return null;const f=this.modelByURL[o];return f?this.models[f.scope][f.modelId].model:null}hasModelBeenAdded(o,f){return this.models[f]&&this.models[f][o]!==void 0}getModelURIs(o){return this.modelUris[o]||{}}addModel(o,f,y){this.models[y]||(this.models[y]={}),this.modelUris[y]||(this.modelUris[y]={});const w=this.requestManager.normalizeModelURL(f);if((this.hasModel(o,y,{exactIdMatch:!0})||this.hasModelBeenAdded(o,y))&&this.modelUris[y][o]===w)this.models[y][o].numReferences++;else if(this.hasURLBeenRequested(w)){const{scope:E,modelId:C}=this.modelByURL[w];this.models[E][C].numReferences++}else this.modelUris[y][o]=w,this.load({[o]:this.modelUris[y][o]},y)}addModelURLs(o,f){this.models[f]||(this.models[f]={}),this.modelUris[f]||(this.modelUris[f]={});const y=this.modelUris[f];for(const w in o)y[w]=this.requestManager.normalizeModelURL(o[w])}reloadModels(o){this.load(this.modelUris[o],o,{forceReload:!0})}addModelsFromBucket(o,f){this.models[f]||(this.models[f]={}),this.modelUris[f]||(this.modelUris[f]={});const y={};for(const w of o)this.hasModel(w,f,{exactIdMatch:!0})||this.hasURLBeenRequested(w)?this.models[f][w].numReferences++:this.modelUris[f][w]&&!this.hasURLBeenRequested(w)?y[w]=this.modelUris[f][w]:!this.hasURLBeenRequested(w)&&s.cZ(w,!1)&&(this.modelUris[f][w]=this.requestManager.normalizeModelURL(w),y[w]=this.modelUris[f][w]);this.load(y,f)}hasURLBeenRequested(o){return this.modelByURL[o]!==void 0}removeModel(o,f,y=!1){if(this.models[f]&&this.models[f][o]&&(this.models[f][o].numReferences--,this.models[f][o].numReferences===0)){const w=this.modelUris[f][o];y||delete this.modelUris[f][o],delete this.modelByURL[w];const E=this.models[f][o].model;if(!E)return;delete this.models[f][o],E.destroy()}}destroy(){for(const o of Object.keys(this.models))for(const f of Object.keys(this.models[o])){const y=this.models[o][f].model;delete this.models[o][f],y&&y.destroy()}this.models={"":{}},this.modelUris={"":{}},this.modelByURL={},this.numModelsLoading={}}listModels(o){return this.models[o]||(this.models[o]={}),Object.keys(this.models[o])}upload(o,f){this.models[f]||(this.models[f]={});for(const y in this.models[f])this.models[f][y].model&&this.models[f][y].model.upload(o.context)}}const Cp=new s.a7({data:new s.a8(s.a5.colorTheme.data)}),ch={"mbx-indoor-active-floorplans":{default:["literal",[]]},"mbx-indoor-underground":{default:["literal",!1]},"mbx-indoor-loaded-levels":{default:["literal",[]]},"mbx-indoor-level-height":{default:["literal",{}]},"mbx-indoor-level-base":{default:["literal",{}]},"mbx-indoor-level-selected":{default:["literal",{}]},"mbx-indoor-level-overlapped":{default:["literal",{}]}};function Ml(_){return _=_||{},Object.assign(_,ch)}class uh extends s.E{constructor(o){super(),this.mergeFloors=!0,this._scope=void 0,this._queryFeatureSetId=void 0,this._buildingEntryFeatureSetId=void 0,this._selectedFloorplan=void 0,this._indoorData=void 0,this._floorplanStates={},s.aV(["_onLoad","_onMove","_checkFloorplanVisible"],this),this._map=o,this._checkFloorplanVisible(),this._map.on("load",this._onLoad),this._map.on("move",this._onMove)}destroy(){this._map.indoor.off("load",this._onLoad),this._map.indoor.off("move",this._onMove),this._map=void 0}_onLoad(){this._map.style.forEachFragmentStyle(o=>{o.stylesheet.indoor&&(this._queryFeatureSetId?this.fire(new s.z(new Error("Multiple indoor map styles detected, simultaneous usage is not allowed currently."))):(this._queryFeatureSetId=o.stylesheet.indoor.floorplanFeaturesetId,this._buildingEntryFeatureSetId=o.stylesheet.indoor.buildingFeaturesetId,this._scope=o.scope))}),this._queryFeatureSetId&&this._buildingEntryFeatureSetId&&this._map.addInteraction("mbx-indoor-buildingclick",{type:"click",target:{featuresetId:this._buildingEntryFeatureSetId,importId:this._scope},handler:o=>(o.feature&&o.feature.properties.floorplan&&this.selectFloorplan(o.feature.properties.floorplan),!0)}),this._checkFloorplanVisible()}_onMove(){this._checkFloorplanVisible()}_checkFloorplanVisible(){if(!this._queryFeatureSetId||!this._map.isStyleLoaded())return;const o=()=>{this._indoorData=void 0,this._selectedFloorplan=void 0,this._map.setConfigProperty(this._scope,"mbx-indoor-underground",!1),this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[]]),this.fire(new s.A("floorplangone"))};if(this._map.transform.zoom<13)return void o();const f={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=this._map.transform.width,w=this._map.transform.height,E=y*(2/3),C=w*(2/3),M=.5*(y-E),N=.5*(w-C),j=[new s.P(M,N),new s.P(M+E,N+C)],H=this._map.queryRenderedFeatures(j,f);H.length>0?this._selectedFloorplan&&H[0].properties.id===this._selectedFloorplan.properties.id||(this._selectedFloorplan=H[0],this._floorplanSelected()):o()}_floorplanSelected(){this._indoorData=JSON.parse(this._selectedFloorplan.properties["indoor-data"]),this._indoorData.id=this._selectedFloorplan.properties.id,this._floorplanStates[this._indoorData.id]=this._floorplanStates[this._indoorData.id]||{},this._map.setConfigProperty(this._scope,"mbx-indoor-active-floorplans",["literal",[this._indoorData.id]]);const o=this._floorplanStates[this._indoorData.id].selectedBuilding,f=o?this._indoorData.buildings.find(M=>M.id===o):this._indoorData.buildings.length>0?this._indoorData.buildings[0]:null,y=this._floorplanStates[this._indoorData.id].selectedLevel,w=this._indoorData.levels.find(M=>M.id===y),E=this._indoorData.levels.find(M=>!(!f||!f.levels)&&Number(M.levelOrder)===0&&f.levels.includes(M.id)),C=w?w.id:E?E.id:void 0;this.fire(new s.A("floorplanselected",{buildings:this._indoorData.buildings,levels:this._indoorData.levels,selectedLevelId:C})),f&&this._buildingSelected(f,!1),C&&this._levelSelected(C)}_buildingSelected(o,f){if(!o||!o.id)return void console.warn("IndoorManager: Building or building id is undefined");f&&o.extent&&this._map.fitBounds(o.extent,{pitch:this._map.getPitch(),bearing:this._map.getBearing()}),this._floorplanStates[this._indoorData.id].selectedBuilding=o?o.id:void 0;const y=this._indoorData.levels.filter(w=>o.levels.includes(w.id));this.fire(new s.A("buildingselected",{buildingId:o.id,levels:y}))}_levelSelected(o){const f=this._indoorData.levels.find(y=>y.id===o);f?(this._updateLevels(f,!0),this.fire(new s.A("levelselected",{levelId:f.id}))):console.warn(`IndoorManager: Level with ID ${o} not found in the current floorplan.`)}_updateLevels(o,f){if(!o||!o.id)throw new Error("IndoorManager: Selected level or level ID is undefined");function y(j){const H=j.indexOf("/floor/");if(H===-1)return j;const Z=H+7,W=j.indexOf("/",Z);return W===-1?j.slice(Z):j.slice(Z,W)}this._floorplanStates[this._indoorData.id].selectedLevel=o.id;const w=[],E={},C={},M={},N={};for(const j of this._indoorData.levels){if(w.push(j.id),E[j.id]=j.levelOrder>=0?3*Math.abs(j.levelOrder+1):3*Math.abs(j.levelOrder),C[j.id]=j.levelOrder>=0?3*j.levelOrder:0,this.mergeFloors){const H=y(o.id),Z=y(j.id);M[j.id]=Z===H?"true":"false"}else M[j.id]=j.id===o.id?"true":"false";N[j.id]=j.levelOrder<o.levelOrder?"true":"false"}this._map.setConfigProperty(this._scope,"mbx-indoor-loaded-levels",["literal",w]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-height",["literal",E]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-base",["literal",C]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-selected",["literal",M]),this._map.setConfigProperty(this._scope,"mbx-indoor-level-overlapped",["literal",N]),this._map.setConfigProperty(this._scope,"mbx-indoor-underground",o.levelOrder<0)}selectFloorplan(o){const f={target:{featuresetId:this._queryFeatureSetId,importId:this._scope}},y=[new s.P(0,0),new s.P(this._map.transform.width,this._map.transform.height)],w=this._map.queryRenderedFeatures(y,f);if(w.length>0){for(const E of w)if(JSON.parse(E.properties["indoor-data"]).id===o){this._selectedFloorplan=E,this._floorplanSelected();break}}}selectBuilding(o){const f=this._indoorData.buildings.find(y=>y.id===o);this._buildingSelected(f,!0)}selectLevel(o){this._levelSelected(o)}}function F_(_){if(!_.metadata||!_.metadata.content_area)return;const o=s.q.devicePixelRatio,{left:f,top:y,width:w,height:E}=_.metadata.content_area,C=f*o,M=y*o;return[C,M,C+w*o,M+E*o]}function Dp(_){if(_)return _.map(([o,f])=>[o*s.q.devicePixelRatio,f*s.q.devicePixelRatio])}class V_{constructor(o,f,y){this.id=o,this.scope=f,this.sourceCache=y,this.pendingRequests=new Set,this.missingRequests=new Set}addPendingRequest(o){this.missingRequests.has(o.name)||this.pendingRequests.has(o.name)||this.pendingRequests.add(o.name)}hasPendingRequests(){return this.pendingRequests.size>0}resolvePendingRequests(){const o=new Map;if(!this.sourceCache.loaded())return o;const f=this.sourceCache.getVisibleCoordinates();if(f.length===0)return o;const y=this.sourceCache.getSource();if(!(y instanceof ja))return o;const w=f.map(C=>this.sourceCache.getTile(C)),E=y.getImages(w,Array.from(this.pendingRequests));for(const[C,M]of E)o.set(s.I.from({name:C,iconsetId:this.id}),M),this.pendingRequests.delete(C);for(const C of this.pendingRequests)this.missingRequests.add(C);return this.pendingRequests.clear(),o}}const hh=(_,o)=>He(_,o&&o.filter(f=>f.identifier!=="source.canvas")),U_=s.aF(Si,["addLayer","removeLayer","setLights","setPaintProperty","setLayoutProperty","setSlot","setFilter","addSource","removeSource","setLayerZoomRange","setLight","setTransition","setGeoJSONSourceData","setTerrain","setFog","setSnow","setRain","setProjection","setCamera","addImport","removeImport","updateImport","addIconset","removeIconset"]),Jc=s.aF(Si,["setCenter","setZoom","setBearing","setPitch"]),Pl=new Set(["background","sky","slot","custom"]),Rp={version:8,layers:[],sources:{}},m0={duration:300,delay:0};class Go extends s.E{constructor(o,f={}){super(),this.map=o,this.scope=f.scope||"",this.globalId=null,this.fragments=[],this.importDepth=f.importDepth||0,this.importsCache=f.importsCache||new Map,this.resolvedImports=f.resolvedImports||new Set,this.transition=s.h({},m0),this._buildingIndex=new Qm(this),this.crossTileSymbolIndex=new Hi,this._mergedOrder=[],this._drapedFirstOrder=[],this._mergedLayers={},this._mergedSourceCaches={},this._mergedOtherSourceCaches={},this._mergedSymbolSourceCaches={},this._clipLayerPresent=!1,this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this._changes=f.styleChanges||new ni,this.dispatcher=f.dispatcher?f.dispatcher:new s.D(s.c$(),this),f.imageManager?this.imageManager=f.imageManager:(this.imageManager=new _r(this.map._spriteFormat),this.imageManager.setEventedParent(this)),this.imageManager.addScope(this.scope),this.glyphManager=f.glyphManager?f.glyphManager:new s.d0(o._requestManager,f.localFontFamily?s.d1.all:f.localIdeographFontFamily?s.d1.ideographs:s.d1.none,f.localFontFamily||f.localIdeographFontFamily),f.modelManager?this.modelManager=f.modelManager:(this.modelManager=new p0(o._requestManager),this.modelManager.setEventedParent(this)),this._layers={},this._sourceCaches={},this._otherSourceCaches={},this._symbolSourceCaches={},this._loaded=!1,this._precompileDone=!1,this._shouldPrecompile=!1,this._availableImages=[],this._availableModels={},this._order=[],this._markersNeedUpdate=!1,this.options=f.configOptions?f.configOptions:new Map,this._configDependentLayers=f.configDependentLayers?f.configDependentLayers:new Set,this._config=f.config,this._styleColorTheme={lut:null,lutLoading:!1,lutLoadingCorrelationID:0,colorTheme:null,colorThemeOverride:f.colorThemeOverride},this._styleColorThemeForScope={},this._initialConfig=f.initialConfig,this.dispatcher.broadcast("setReferrer",s.d2());const y=this;this._rtlTextPluginCallback=Go.registerForPluginStateChange(w=>{y.dispatcher.broadcast("syncRTLPluginState",{pluginStatus:w.pluginStatus,pluginURL:w.pluginURL},(E,C)=>{if(s.d3(E),C&&C.every(M=>M))for(const M in y._sourceCaches){const N=y._sourceCaches[M],j=N.getSource().type;j!=="vector"&&j!=="geojson"||N.reload()}})}),this.on("data",w=>{if(w.dataType!=="source"||w.sourceDataType!=="metadata")return;const E=this.getOwnSource(w.sourceId);if(E&&E.vectorLayerIds)for(const C in this._layers){const M=this._layers[C];M.source===E.id&&this._validateLayer(M)}})}load(o){return o?(typeof o=="string"?this.loadURL(o):this.loadJSON(o),this):this}_getGlobalId(o){if(!o)return null;if(typeof o=="string"){if(s.j(o))return o;const f=s.d4(o);if(!f.startsWith("http"))try{return new URL(f,location.href).toString()}catch{return f}return f}return`json://${s.d5(JSON.stringify(o))}`}_diffStyle(o,f,y){this.globalId=this._getGlobalId(o);const w=(E,C)=>{try{C(null,this.setState(E,y))}catch(M){C(M,!1)}};if(typeof o=="string"){const E=this.map._requestManager.normalizeStyleURL(o),C=this.map._requestManager.transformRequest(E,s.R.Style);s.n(C,(M,N)=>{M?this.fire(new s.z(M)):N&&w(N,f)})}else typeof o=="object"&&w(o,f)}loadURL(o,f={}){this.fire(new s.A("dataloading",{dataType:"style"}));const y=typeof f.validate=="boolean"?f.validate:!s.j(o);this.globalId=this._getGlobalId(o),o=this.map._requestManager.normalizeStyleURL(o,f.accessToken),this.resolvedImports.add(o);const w=this.importsCache.get(o);if(w)return this._load(w,y);const E=this.map._requestManager.transformRequest(o,s.R.Style);this._request=s.n(E,(C,M)=>{if(this._request=null,C)this.fire(new s.z(C));else if(M)return this.importsCache.set(o,M),this._load(M,y)})}loadJSON(o,f={}){this.fire(new s.A("dataloading",{dataType:"style"})),this.globalId=this._getGlobalId(o),this._request=s.q.frame(()=>{this._request=null,this._load(o,f.validate!==!1)})}loadEmpty(){this.fire(new s.A("dataloading",{dataType:"style"})),this._load(Rp,!1)}_loadImports(o,f,y){if(this.importDepth>=4)return s.w("Style doesn't support nesting deeper than 5"),Promise.resolve();const w=[];for(const E of o){const C=this._createFragmentStyle(E),M=new Promise(H=>{C.once("style.import.load",H),C.once("error",H)}).then(()=>this.mergeAll());if(w.push(M),this.resolvedImports.has(E.url)){C.loadEmpty();continue}const N=E.data||this.importsCache.get(E.url);N?(C.loadJSON(N,{validate:f}),this._isInternalStyle(N)&&(C.globalId=null)):E.url?C.loadURL(E.url,{validate:f}):C.loadEmpty();const j={style:C,id:E.id,config:E.config};if(y){const H=this.fragments.findIndex(({id:Z})=>Z===y);this.fragments=this.fragments.slice(0,H).concat(j).concat(this.fragments.slice(H))}else this.fragments.push(j)}return Promise.allSettled(w)}getImportGlobalIds(o=this,f=new Set){for(const y of o.fragments)y.style.globalId&&f.add(y.style.globalId),this.getImportGlobalIds(y.style,f);return[...f.values()]}_createFragmentStyle(o){const f=this.scope?s.C(o.id,this.scope):o.id;let y;const w=this._initialConfig&&this._initialConfig[f];(o.config||w)&&(y=s.h({},o.config,w));const E=new Go(this.map,{scope:f,styleChanges:this._changes,importDepth:this.importDepth+1,importsCache:this.importsCache,resolvedImports:new Set(this.resolvedImports),dispatcher:this.dispatcher,imageManager:this.imageManager,glyphManager:this.glyphManager,modelManager:this.modelManager,config:y,configOptions:this.options,colorThemeOverride:o["color-theme"],configDependentLayers:this._configDependentLayers});return E.setEventedParent(this.map,{style:E}),E}_reloadImports(){this.mergeAll(),this._updateMapProjection(),this.updateConfigDependencies(),this.map._triggerCameraUpdate(this.camera),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),this._shouldPrecompile=this.map._precompilePrograms&&this.isRootStyle()}_isInternalStyle(o){return this.isRootStyle()&&(o.fragment||!!o.schema&&o.fragment!==!1)}_load(o,f){const y=o.indoor?Ml(o.schema):o.schema;if(this._isInternalStyle(o)){const C=s.h({},Rp,{imports:[{id:"basemap",data:o,url:""}]});return void this._load(C,f)}if(this.updateConfig(this._config,y),f&&hh(this,Wn(o)))return;this._loaded=!0,this.stylesheet=s.d6(o);const w=()=>{for(const j in o.sources)this.addSource(j,o.sources[j],{validate:!1,isInitialLoad:!0});if(o.iconsets)for(const j in o.iconsets)this.addIconset(j,o.iconsets[j]);o.sprite?this._loadIconset(o.sprite):(this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0})),this.setGlyphsUrl(o.glyphs);const C=Gc(this.stylesheet.layers);if(this._order=C.map(j=>j.id),this.stylesheet.light&&s.w("The `light` root property is deprecated, prefer using `lights` with `flat` light type instead."),this.stylesheet.lights)if(this.stylesheet.lights.length===1&&this.stylesheet.lights[0].type==="flat"){const j=this.stylesheet.lights[0];this.light=new bt(j.properties,j.id)}else this.setLights(this.stylesheet.lights);this.light||(this.light=new bt(this.stylesheet.light)),this._layers={};for(const j of C){const H=s.db(j,this.scope,this._styleColorTheme.lut,this.options);H.configDependencies.size!==0&&this._configDependentLayers.add(H.fqid),H.setEventedParent(this,{layer:{id:H.id}}),this._layers[H.id]=H;const Z=this.getOwnLayerSourceCache(H),W=!!this.directionalLight&&this.directionalLight.shadowsEnabled();Z&&H.canCastShadows()&&W&&(Z.castsShadows=!0)}this.stylesheet.featuresets&&this.setFeaturesetSelectors(this.stylesheet.featuresets),this.stylesheet.models&&this.addModelURLs(this.stylesheet.models);const M=this.stylesheet.terrain;M&&(this.checkCanvasFingerprintNoise(),this.disableElevatedTerrain||this.terrainSetForDrapingOnly()||this._createTerrain(M,1)),this.stylesheet.fog&&this._createFog(this.stylesheet.fog),this.stylesheet.snow&&this._createSnow(this.stylesheet.snow),this.stylesheet.rain&&this._createRain(this.stylesheet.rain),this.stylesheet.transition&&this.setTransition(this.stylesheet.transition),this.fire(new s.A("data",{dataType:"style"}));const N=this.isRootStyle();o.imports?this._loadImports(o.imports,f).then(()=>{this._reloadImports(),this.fire(new s.A(N?"style.load":"style.import.load"))}).catch(j=>{this.fire(new s.z(new Error("Failed to load imports",j))),this.fire(new s.A(N?"style.load":"style.import.load"))}):(this._reloadImports(),this.fire(new s.A(N?"style.load":"style.import.load")))};this._styleColorTheme.colorTheme=this.stylesheet["color-theme"];const E=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(E){const C=this._evaluateColorThemeData(E);this._loadColorTheme(C).then(()=>{w()}).catch(M=>{s.w(`Couldn't load color theme from the stylesheet: ${M}`),w()})}else this._styleColorTheme.lut=null,w()}isRootStyle(){return this.importDepth===0}mergeAll(){let o,f,y,w,E,C,M,N,j,H;const Z={};this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(W=>{if(W.stylesheet){if(W.light!=null&&(o=W.light),W.stylesheet.lights)for(const Q of W.stylesheet.lights)Q.type==="ambient"&&W.ambientLight!=null&&(f=W.ambientLight),Q.type==="directional"&&W.directionalLight!=null&&(y=W.directionalLight);w=this._prioritizeTerrain(w,W.terrain,W.stylesheet.terrain),W.stylesheet.fog&&W.fog!=null&&(E=W.fog),W.stylesheet.snow&&W.snow!=null&&(C=W.snow),W.stylesheet.rain&&W.rain!=null&&(M=W.rain),W.stylesheet.camera!=null&&(H=W.stylesheet.camera),W.stylesheet.projection!=null&&(N=W.stylesheet.projection),W.stylesheet.transition!=null&&(j=W.stylesheet.transition),Z[W.scope]=W._styleColorTheme}}),this.light=o,this.ambientLight=f,this.directionalLight=y,this.fog=E,this.snow=C,this.rain=M,this._styleColorThemeForScope=Z,w===null?delete this.terrain:this.terrain=w,this.camera=H||{"camera-projection":"perspective"},this.projection=N||{name:"mercator"},this.transition=s.h({},m0,j),this.mergeSources(),this.mergeLayers()}forEachFragmentStyle(o){const f=y=>{for(const w of y.fragments)f(w.style);o(y)};f(this)}_prioritizeTerrain(o,f,y){const w=o&&o.drapeRenderMode===0;return y===null?f&&f.drapeRenderMode===0?f:w?o:null:f!=null&&(!o||w||f&&f.drapeRenderMode===1)?f:o}mergeTerrain(){let o;this.terrain&&this.terrain.scope!==this.scope&&delete this.terrain,this.forEachFragmentStyle(f=>{o=this._prioritizeTerrain(o,f.terrain,f.stylesheet.terrain)}),o===null?delete this.terrain:this.terrain=o}mergeProjection(){let o;this.forEachFragmentStyle(f=>{f.stylesheet.projection!=null&&(o=f.stylesheet.projection)}),this.projection=o||{name:"mercator"}}mergeSources(){const o={},f={},y={};this.forEachFragmentStyle(w=>{for(const E in w._sourceCaches){const C=s.C(E,w.scope);o[C]=w._sourceCaches[E]}for(const E in w._otherSourceCaches){const C=s.C(E,w.scope);f[C]=w._otherSourceCaches[E]}for(const E in w._symbolSourceCaches){const C=s.C(E,w.scope);y[C]=w._symbolSourceCaches[E]}}),this._mergedSourceCaches=o,this._mergedOtherSourceCaches=f,this._mergedSymbolSourceCaches=y}mergeLayers(){const o={},f=[],y={};this._mergedSlots=[],this._has3DLayers=!1,this._hasCircleLayers=!1,this._hasSymbolLayers=!1,this.forEachFragmentStyle(E=>{for(const C of E._order){const M=E._layers[C];if(M.type==="slot"){const N=s.d7(C);if(o[N])continue;o[N]=[]}M.slot&&o[M.slot]?o[M.slot].push(M):f.push(M)}}),this._mergedOrder=[];const w=(E=[])=>{for(const C of E)if(C.type==="slot"){const M=s.d7(C.id);o[M]&&w(o[M]),this._mergedSlots.push(M)}else{const M=s.C(C.id,C.scope);this._mergedOrder.push(M),y[M]=C,C.is3D(!!this.terrain)&&(this._has3DLayers=!0),C.type==="circle"&&(this._hasCircleLayers=!0),C.type==="symbol"&&(this._hasSymbolLayers=!0),C.type==="clip"&&(this._clipLayerPresent=!0)}};w(f),this._mergedOrder.sort((E,C)=>{const M=y[E],N=y[C];return M.hasInitialOcclusionOpacityProperties?N.is3D(!!this.terrain)?1:0:M.is3D(!!this.terrain)&&N.hasInitialOcclusionOpacityProperties?-1:0}),this._mergedLayers=y,this.updateDrapeFirstLayers(),this._buildingIndex.processLayersChanged()}terrainSetForDrapingOnly(){return!!this.terrain&&this.terrain.drapeRenderMode===0}getCamera(){return this.stylesheet.camera}setCamera(o){return this.stylesheet.camera=s.h({},this.stylesheet.camera,o),this.camera=this.stylesheet.camera,this}_evaluateColorThemeData(o){return o.data?function(f,y,w,E){const C=s.h({},y);for(const N of Object.keys(s.a5.colorTheme))C[N]===void 0&&(C[N]=s.a5.colorTheme[N].default);const M=new s.a6(Cp,f,new Map(w));return M.setTransitionOrValue(C,w),M.untransitioned().possiblyEvaluate(new s.aa(0,{worldview:void 0}))}(this.scope,o,this.options).get("data"):null}_loadColorTheme(o){this._styleColorTheme.lutLoading=!0,this._styleColorTheme.lutLoadingCorrelationID+=1;const f=this._styleColorTheme.lutLoadingCorrelationID;return new Promise((y,w)=>{const E="data:image/png;base64,";if(!o||o.length===0)return this._styleColorTheme.lut=null,this._styleColorTheme.lutLoading=!1,void y();let C=o;C.startsWith(E)||(C=E+C);const M=s.I.from("mapbox-reserved-lut"),N=new Image;N.src=C,N.onerror=()=>{this._styleColorTheme.lutLoading=!1,w(new Error("Failed to load image data"))},N.onload=()=>{if(this._styleColorTheme.lutLoadingCorrelationID!==f)return void y();this._styleColorTheme.lutLoading=!1;const{width:j,height:H,data:Z}=s.q.getImageData(N);if(H>32)return void w(new Error("The height of the image must be less than or equal to 32 pixels."));if(j!==H*H)return void w(new Error("The width of the image must be equal to the height squared."));this.getImage(M)&&this.removeImage(M),this.addImage(M,{data:new s.r({width:j,height:H},Z),pixelRatio:1,sdf:!1,usvg:!1,version:0});const W=this.imageManager.getImage(M,this.scope);W?(this._styleColorTheme.lut={image:W.data,data:o},y()):w(new Error("Missing LUT image."))}})}getLut(o){const f=this._styleColorThemeForScope[o];return f?f.lut:null}setProjection(o){o?this.stylesheet.projection=o:delete this.stylesheet.projection,this.mergeProjection(),this._updateMapProjection()}applyProjectionUpdate(){this._loaded&&(this.dispatcher.broadcast("setProjection",this.map.transform.projectionOptions),this.map.transform.projection.requiresDraping?(this.getTerrain()||this.stylesheet.terrain)&&!this.disableElevatedTerrain||this.setTerrainForDraping():this.terrainSetForDrapingOnly()&&this.setTerrain(null,0))}_updateMapProjection(){this.isRootStyle()&&(this.map._useExplicitProjection?this.applyProjectionUpdate():this.map._prioritizeAndUpdateProjection(null,this.projection))}_loadSprite(o){this._spriteRequest=function(f,y,w){let E,C,M;const N=s.q.devicePixelRatio>1?"@2x":"";let j=s.n(y.transformRequest(y.normalizeSpriteURL(f,N,".json"),s.R.SpriteJSON),(W,Q)=>{j=null,M||(M=W,E=Q,Z())}),H=s.o(y.transformRequest(y.normalizeSpriteURL(f,N,".png"),s.R.SpriteImage),(W,Q)=>{H=null,M||(M=W,C=Q,Z())});function Z(){if(M)w(M);else if(E&&C){const W=s.q.getImageData(C),Q={};for(const ce in E){const{width:se,height:ue,x:pe,y:ge,sdf:Pe,pixelRatio:Ve,stretchX:Ye,stretchY:qe,content:je}=E[ce],Ue=new s.r({width:se,height:ue});s.r.copy(W,Ue,{x:pe,y:ge},{x:0,y:0},{width:se,height:ue},null),Q[ce]={data:Ue,pixelRatio:Ve,sdf:Pe,stretchX:Ye,stretchY:qe,content:je,usvg:!1}}w(null,Q)}}return{cancel(){j&&(j.cancel(),j=null),H&&(H.cancel(),H=null)}}}(o,this.map._requestManager,(f,y)=>{if(this._spriteRequest=null,f)this.fire(new s.z(f));else if(y){const w=new Map;for(const E in y)w.set(s.I.from(E),y[E]);this.addImages(w)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))})}addIconset(o,f){if(f.type==="sprite")return void this._loadSprite(f.url);const y=this.getOwnSourceCache(f.source);if(!y)return void this.fire(new s.z(new Error(`Source "${f.source}" as specified by iconset "${o}" does not exist and cannot be used as an iconset source`)));const w=y.getSource();if(w.type!=="raster-array")return void this.fire(new s.z(new Error(`Source "${f.source}" as specified by iconset "${o}" is not a "raster-array" source and cannot be used as an iconset source`)));w.partial=!1;const E=new V_(o,this.scope,y);this.imageManager.addImageProvider(E,this.scope)}removeIconset(o){this.imageManager.removeImageProvider(o,this.scope)}_loadIconset(o){if(!s.j(o)&&this.map._spriteFormat!=="icon_set"||this.map._spriteFormat==="raster")return void this._loadSprite(o);const f=this.map._spriteFormat==="auto";var y,w;this._spriteRequest=(w=(E,C)=>{if(this._spriteRequest=null,E)f?this._loadSprite(o):this.fire(new s.z(E));else if(C){const M=new Map;for(const N in C)M.set(s.I.from(N),C[N]);this.addImages(M)}this.imageManager.setLoaded(!0,this.scope),this.dispatcher.broadcast("spriteLoaded",{scope:this.scope,isLoaded:!0}),this.fire(new s.A("data",{dataType:"style"}))},s.br((y=this.map._requestManager).transformRequest(y.normalizeIconsetURL(o),s.R.Iconset),(E,C)=>{if(E)return void w(E);const M={},N=s.c_(new s.bq(C));for(const j of N.icons){const H={version:1,pixelRatio:s.q.devicePixelRatio,content:F_(j),stretchX:j.metadata?Dp(j.metadata.stretch_x_areas):void 0,stretchY:j.metadata?Dp(j.metadata.stretch_y_areas):void 0,sdf:!1,usvg:!0,icon:j};M[j.name]=H}w(null,M)}))}_validateLayer(o){const f=this.getOwnSource(o.source);if(!f)return;const y=o.sourceLayer;y&&(f.type==="geojson"||f.vectorLayerIds&&f.vectorLayerIds.indexOf(y)===-1)&&this.fire(new s.z(new Error(`Source layer "${y}" does not exist on source "${f.id}" as specified by style layer "${o.id}"`)))}loaded(){if(!this._loaded||Object.keys(this._changes.getUpdatedSourceCaches()).length)return!1;for(const o in this._sourceCaches)if(!this._sourceCaches[o].loaded())return!1;if(!this.imageManager.isLoaded()||this.imageManager.hasPatternsInFlight()||!this.modelManager.isLoaded()||this._styleColorTheme.lutLoading)return!1;for(const{style:o}of this.fragments)if(!o.loaded())return!1;return!0}_serializeImports(){if(this.stylesheet.imports)return this.stylesheet.imports.map((o,f)=>{const y=this.fragments[f];return y&&y.style&&(o.data=y.style.serialize()),o})}_serializeSources(){const o={};for(const f in this._sourceCaches){const y=this._sourceCaches[f].getSource();o[y.id]||(o[y.id]=y.serialize())}return o}_serializeLayers(o){const f=[];for(const y of o){const w=this._layers[y];w&&w.type!=="custom"&&f.push(w.serialize())}return f}hasLightTransitions(){return!(!this.light||!this.light.hasTransition())||!(!this.ambientLight||!this.ambientLight.hasTransition())||!(!this.directionalLight||!this.directionalLight.hasTransition())}hasFogTransition(){return!!this.fog&&this.fog.hasTransition()}hasSnowTransition(){return!!this.snow&&this.snow.hasTransition()}hasRainTransition(){return!!this.rain&&this.rain.hasTransition()}hasTransitions(){if(this.hasLightTransitions()||this.hasFogTransition()||this.hasSnowTransition()||this.hasRainTransition())return!0;for(const o in this._sourceCaches)if(this._sourceCaches[o].hasTransition())return!0;for(const o in this._layers)if(this._layers[o].hasTransition())return!0;return!1}get order(){return this.terrain?this._drapedFirstOrder:this._mergedOrder}_getOrder(o){return o?this.order:this._mergedOrder}isLayerDraped(o){return!!this.terrain&&o.isDraped(this.getLayerSourceCache(o))}_checkLoaded(){if(!this._loaded)throw new Error("Style is not done loading")}_checkLayer(o){const f=this.getOwnLayer(o);if(f)return f;this.fire(new s.z(new Error(`The layer '${o}' does not exist in the map's style.`)))}_checkSource(o){const f=this.getOwnSource(o);if(f)return f;this.fire(new s.z(new Error(`The source '${o}' does not exist in the map's style.`)))}precompilePrograms(o,f){const y=this.map.painter;if(y)for(let w=o.minzoom||0;w<(o.maxzoom||25.5);w++){const E=o.getProgramIds();if(E)for(const C of E){const M=o.getDefaultProgramParams(C,f.zoom,this._styleColorTheme.lut);M&&(y.style=this,this.fog&&(y._fogVisible=!0,M.overrideFog=!0,y.getOrCreateProgram(C,M)),y._fogVisible=!1,M.overrideFog=!1,y.getOrCreateProgram(C,M),(this.stylesheet.terrain||this.stylesheet.projection&&this.stylesheet.projection.name==="globe")&&(M.overrideRtt=!0,y.getOrCreateProgram(C,M)))}}}update(o){if(!this._loaded)return;this.ambientLight&&this.ambientLight.recalculate(o),this.directionalLight&&this.directionalLight.recalculate(o);const f=this.calculateLightsBrightness();o.brightness=f||0,f!==this._brightness&&(this._brightness=f,this.dispatcher.broadcast("setBrightness",f)),o.worldview!==this._worldview&&(this._worldview=o.worldview,this.dispatcher.broadcast("setWorldview",this._worldview));const y=this._changes.isDirty();let w=!1;if(this._changes.isDirty()){const M=this._changes.getLayerUpdatesByScope();for(const N in M){const{updatedIds:j,removedIds:H}=M[N];(j||H)&&(this._updateWorkerLayers(N,j,H),w=!0)}this.updateSourceCaches(),this._updateTilesForChangedImages(),this.updateLayers(o),this.light&&this.light.updateTransitions(o),this.ambientLight&&this.ambientLight.updateTransitions(o),this.directionalLight&&this.directionalLight.updateTransitions(o),this.fog&&this.fog.updateTransitions(o),this.snow&&this.snow.updateTransitions(o),this.rain&&this.rain.updateTransitions(o),this._changes.reset()}const E={};for(const M in this._mergedSourceCaches){const N=this._mergedSourceCaches[M];E[M]=N.used,N.used=!1,N.tileCoverLift=0}for(const M of this._mergedOrder){const N=this._mergedLayers[M];if(N.recalculate(o,this._availableImages),!N.isHidden(o.zoom)){const j=this.getLayerSourceCache(N);j&&(j.used=!0,j.tileCoverLift=Math.max(j.tileCoverLift,N.tileCoverLift()))}!this._precompileDone&&this._shouldPrecompile&&("requestIdleCallback"in window?requestIdleCallback(()=>{this.precompilePrograms(N,o)}):this.precompilePrograms(N,o))}this._shouldPrecompile&&(this._precompileDone=!0),this.terrain&&w&&this.mergeLayers();const C=this.imageManager.getPendingImageProviders();for(const M of C)M.sourceCache.used=!0;for(const M in E){const N=this._mergedSourceCaches[M];E[M]!==N.used&&N.getSource().fire(new s.A("data",{sourceDataType:"visibility",dataType:"source",sourceId:N.getSource().id}))}this.light&&this.light.recalculate(o),this.terrain&&this.terrain.recalculate(o),this.fog&&this.fog.recalculate(o),this.snow&&this.snow.recalculate(o),this.rain&&this.rain.recalculate(o),this.z=o.zoom,this._markersNeedUpdate&&(this._updateMarkersOpacity(),this._markersNeedUpdate=!1),this.imageManager.clearUpdatedImages(this.scope),y&&this.fire(new s.A("data",{dataType:"style"}))}updateImageProviders(){const o=this.imageManager.getPendingImageProviders();for(const f of o){const y=f.resolvePendingRequests(),w=this.getFragmentStyle(f.scope);w&&w.addImages(y)}}_updateTilesForChangedImages(){const o={};for(const f in this._mergedSourceCaches){const y=this._mergedSourceCaches[f].getSource().scope;o[y]=o[y]||this._changes.getUpdatedImages(y),o[y].length!==0&&this._mergedSourceCaches[f].reloadTilesForDependencies(["icons","patterns"],o[y])}for(const f in o)this._changes.resetUpdatedImages(f)}_updateWorkerLayers(o,f,y){const w=this.getFragmentStyle(o);w&&this.dispatcher.broadcast("updateLayers",{layers:f?w._serializeLayers(f):[],scope:o,removedIds:y||[],options:w.options})}setState(o,f){if(this._checkLoaded(),hh(this,Wn(o)))return!1;(o=s.d6(o)).layers=Gc(o.layers);const y=function(C,M){if(!C)return[{command:Si.setStyle,args:[M]}];let N=[];try{if(!s.bv(C.version,M.version))return[{command:Si.setStyle,args:[M]}];if(s.bv(C.center,M.center)||N.push({command:Si.setCenter,args:[M.center]}),s.bv(C.zoom,M.zoom)||N.push({command:Si.setZoom,args:[M.zoom]}),s.bv(C.bearing,M.bearing)||N.push({command:Si.setBearing,args:[M.bearing]}),s.bv(C.pitch,M.pitch)||N.push({command:Si.setPitch,args:[M.pitch]}),s.bv(C.sprite,M.sprite)||N.push({command:Si.setSprite,args:[M.sprite]}),s.bv(C.glyphs,M.glyphs)||N.push({command:Si.setGlyphs,args:[M.glyphs]}),s.bv(C.imports,M.imports)||function(Q=[],ce=[],se){ce=ce||[];const ue=(Q=Q||[]).map(Ga),pe=ce.map(Ga),ge=Q.reduce(tc,{}),Pe=ce.reduce(tc,{}),Ve=ue.slice();let Ye,qe,je,Ue;for(Ye=0,qe=0;Ye<ue.length;Ye++)je=ue[Ye],Pe.hasOwnProperty(je)?qe++:(se.push({command:Si.removeImport,args:[je]}),Ve.splice(Ve.indexOf(je,qe),1));for(Ye=0,qe=0;Ye<pe.length;Ye++)je=pe[pe.length-1-Ye],Ve[Ve.length-1-Ye]!==je&&(ge.hasOwnProperty(je)?(se.push({command:Si.removeImport,args:[je]}),Ve.splice(Ve.lastIndexOf(je,Ve.length-qe),1)):qe++,Ue=Ve[Ve.length-Ye],se.push({command:Si.addImport,args:[Pe[je],Ue]}),Ve.splice(Ve.length-Ye,0,je));for(const We of ce){const et=ge[We.id];et&&(delete et.data,s.bv(et,We)||se.push({command:Si.updateImport,args:[We.id,We]}))}}(C.imports,M.imports,N),s.bv(C.transition,M.transition)||N.push({command:Si.setTransition,args:[M.transition]}),s.bv(C.light,M.light)||N.push({command:Si.setLight,args:[M.light]}),s.bv(C.fog,M.fog)||N.push({command:Si.setFog,args:[M.fog]}),s.bv(C.snow,M.snow)||N.push({command:Si.setSnow,args:[M.snow]}),s.bv(C.rain,M.rain)||N.push({command:Si.setRain,args:[M.rain]}),s.bv(C.projection,M.projection)||N.push({command:Si.setProjection,args:[M.projection]}),s.bv(C.lights,M.lights)||N.push({command:Si.setLights,args:[M.lights]}),s.bv(C.camera,M.camera)||N.push({command:Si.setCamera,args:[M.camera]}),s.bv(C.iconsets,M.iconsets)||function(Q,ce,se){let ue;for(ue in ce=ce||{},Q=Q||{})Q.hasOwnProperty(ue)&&(ce.hasOwnProperty(ue)||se.push({command:Si.removeIconset,args:[ue]}));for(ue in ce){if(!ce.hasOwnProperty(ue))continue;const pe=ce[ue];Q.hasOwnProperty(ue)?s.bv(Q[ue],pe)||(se.push({command:Si.removeIconset,args:[ue]}),se.push({command:Si.addIconset,args:[ue,pe]})):se.push({command:Si.addIconset,args:[ue,pe]})}}(C.iconsets,M.iconsets,N),!s.bv(C["color-theme"],M["color-theme"]))return[{command:Si.setStyle,args:[M]}];const j={},H=[];(function(Q,ce,se,ue){let pe;for(pe in ce=ce||{},Q=Q||{})Q.hasOwnProperty(pe)&&(ce.hasOwnProperty(pe)||va(pe,se,ue));for(pe in ce){if(!ce.hasOwnProperty(pe))continue;const ge=ce[pe];Q.hasOwnProperty(pe)?s.bv(Q[pe],ge)||(Q[pe].type==="geojson"&&ge.type==="geojson"&&B_(Q,ce,pe)?se.push({command:Si.setGeoJSONSourceData,args:[pe,ge.data]}):qc(pe,ce,se,ue)):uf(pe,ce,se)}})(C.sources,M.sources,H,j);const Z=[];C.layers&&C.layers.forEach(Q=>{Q.source&&j[Q.source]?N.push({command:Si.removeLayer,args:[Q.id]}):Z.push(Q)});let W=C.terrain;W&&j[W.source]&&(N.push({command:Si.setTerrain,args:[void 0]}),W=void 0),N=N.concat(H),s.bv(W,M.terrain)||N.push({command:Si.setTerrain,args:[M.terrain]}),function(Q,ce,se){ce=ce||[];const ue=(Q=Q||[]).map(Ga),pe=ce.map(Ga),ge=Q.reduce(tc,{}),Pe=ce.reduce(tc,{}),Ve=ue.slice(),Ye=Object.create(null);let qe,je,Ue,We,et,_t,ft;for(qe=0,je=0;qe<ue.length;qe++)Ue=ue[qe],Pe.hasOwnProperty(Ue)?je++:(se.push({command:Si.removeLayer,args:[Ue]}),Ve.splice(Ve.indexOf(Ue,je),1));for(qe=0,je=0;qe<pe.length;qe++)Ue=pe[pe.length-1-qe],Ve[Ve.length-1-qe]!==Ue&&(ge.hasOwnProperty(Ue)?(se.push({command:Si.removeLayer,args:[Ue]}),Ve.splice(Ve.lastIndexOf(Ue,Ve.length-je),1)):je++,_t=Ve[Ve.length-qe],se.push({command:Si.addLayer,args:[Pe[Ue],_t]}),Ve.splice(Ve.length-qe,0,Ue),Ye[Ue]=!0);for(qe=0;qe<pe.length;qe++)if(Ue=pe[qe],We=ge[Ue],et=Pe[Ue],!Ye[Ue]&&!s.bv(We,et))if(s.bv(We.source,et.source)&&s.bv(We["source-layer"],et["source-layer"])&&s.bv(We.type,et.type)){for(ft in Ol(We.layout,et.layout,se,Ue,null,Si.setLayoutProperty),Ol(We.paint,et.paint,se,Ue,null,Si.setPaintProperty),s.bv(We.slot,et.slot)||se.push({command:Si.setSlot,args:[Ue,et.slot]}),s.bv(We.filter,et.filter)||se.push({command:Si.setFilter,args:[Ue,et.filter]}),s.bv(We.minzoom,et.minzoom)&&s.bv(We.maxzoom,et.maxzoom)||se.push({command:Si.setLayerZoomRange,args:[Ue,et.minzoom,et.maxzoom]}),We)We.hasOwnProperty(ft)&&ft!=="layout"&&ft!=="paint"&&ft!=="filter"&&ft!=="metadata"&&ft!=="minzoom"&&ft!=="maxzoom"&&ft!=="slot"&&(ft.indexOf("paint.")===0?Ol(We[ft],et[ft],se,Ue,ft.slice(6),Si.setPaintProperty):s.bv(We[ft],et[ft])||se.push({command:Si.setLayerProperty,args:[Ue,ft,et[ft]]}));for(ft in et)et.hasOwnProperty(ft)&&!We.hasOwnProperty(ft)&&ft!=="layout"&&ft!=="paint"&&ft!=="filter"&&ft!=="metadata"&&ft!=="minzoom"&&ft!=="maxzoom"&&ft!=="slot"&&(ft.indexOf("paint.")===0?Ol(We[ft],et[ft],se,Ue,ft.slice(6),Si.setPaintProperty):s.bv(We[ft],et[ft])||se.push({command:Si.setLayerProperty,args:[Ue,ft,et[ft]]}))}else se.push({command:Si.removeLayer,args:[Ue]}),_t=Ve[Ve.lastIndexOf(Ue)+1],se.push({command:Si.addLayer,args:[et,_t]})}(Z,M.layers,N)}catch(j){console.warn("Unable to compute style diff:",j),N=[{command:Si.setStyle,args:[M]}]}return N}(this.serialize(),o).filter(C=>!(C.command in Jc));if(y.length===0)return!1;const w=y.filter(C=>!(C.command in U_));if(w.length>0)throw new Error(`Unimplemented: ${w.map(C=>C.command).join(", ")}.`);const E=[];return y.forEach(C=>{E.push(this[C.command](...C.args))}),f&&Promise.all(E).then(f).catch(f),this.stylesheet=o,this.mergeAll(),this.dispatcher.broadcast("setLayers",{layers:this._serializeLayers(this._order),scope:this.scope,options:this.options}),!0}_updateWorkerImages(){this._availableImages=this.imageManager.listImages(this.scope),this.dispatcher.broadcast("setImages",{scope:this.scope,images:this._availableImages})}_updateWorkerModels(){this._availableModels=this.modelManager.getModelURIs(this.scope),this.dispatcher.broadcast("setModels",{scope:this.scope,models:this._availableModels})}addImages(o){for(const[f,y]of o.entries()){if(this.getImage(f))return this.fire(new s.z(new Error(`An image with the name "${f.name}" already exists.`)));this.imageManager.addImage(f,this.scope,y),this._changes.updateImage(f,this.scope)}return this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this}addImage(o,f){return this.getImage(o)?this.fire(new s.z(new Error(`An image with the name "${o.name}" already exists.`))):(this.imageManager.addImage(o,this.scope,f),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this)}updateImage(o,f,y=!1){this.imageManager.updateImage(o,this.scope,f),y&&(this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})))}getImage(o){return this.imageManager.getImage(o,this.scope)}removeImage(o){return this.getImage(o)?(this.imageManager.removeImage(o,this.scope),this._changes.updateImage(o,this.scope),this._updateWorkerImages(),this.fire(new s.A("data",{dataType:"style"})),this):this.fire(new s.z(new Error("No image with this name exists.")))}listImages(){return this._checkLoaded(),this._availableImages.slice()}addModelURLs(o){return this.modelManager.addModelURLs(o,this.scope),this._updateWorkerModels(),this.fire(new s.A("data",{dataType:"style"})),this}addModel(o,f,y={}){return this._checkLoaded(),this._validate(Be,`models.${o}`,f,null,y)||(this.modelManager.addModel(o,f,this.scope),this.fire(new s.A("data",{dataType:"style"}))),this}hasModel(o){return this.modelManager.hasModel(o,this.scope)}removeModel(o){return this.hasModel(o)?(this.modelManager.removeModel(o,this.scope),this.fire(new s.A("data",{dataType:"style"})),this):this.fire(new s.z(new Error("No model with this ID exists.")))}listModels(){return this._checkLoaded(),this.modelManager.listModels(this.scope)}addSource(o,f,y={}){if(this._checkLoaded(),this.getOwnSource(o)!==void 0)throw new Error(`There is already a source with ID "${o}".`);if(!f.type)throw new Error(`The type property must be defined, but only the following properties were given: ${Object.keys(f).join(", ")}.`);if(["vector","raster","geojson","video","image"].indexOf(f.type)>=0&&this._validate(zi,`sources.${o}`,f,null,y))return;this.map&&this.map._collectResourceTiming&&(f.collectResourceTiming=!0);const w=Zu(o,f,this.dispatcher,this);w.scope=this.scope,w.setEventedParent(this,()=>({isSourceLoaded:this._isSourceCacheLoaded(w.id),source:w.serialize(),sourceId:w.id}));const E=C=>{const M=(C?"symbol:":"other:")+w.id,N=s.C(M,this.scope),j=this._sourceCaches[M]=new Bs(N,w,C);(C?this._symbolSourceCaches:this._otherSourceCaches)[w.id]=j,j.onAdd(this.map)};E(!1),f.type!=="vector"&&f.type!=="geojson"||E(!0),w.onAdd&&w.onAdd(this.map),y.isInitialLoad||(this.mergeSources(),this._changes.setDirty())}removeSource(o){this._checkLoaded();const f=this.getOwnSource(o);if(!f)throw new Error("There is no source with this ID");for(const w in this._layers)if(this._layers[w].source===o)return this.fire(new s.z(new Error(`Source "${o}" cannot be removed while layer "${w}" is using it.`)));if(this.terrain&&this.terrain.scope===this.scope&&this.terrain.get().source===o)return this.fire(new s.z(new Error(`Source "${o}" cannot be removed while terrain is using it.`)));if(this.stylesheet.iconsets){const w=Object.entries(this.stylesheet.iconsets).find(([E,C])=>C.type==="source"&&C.source===o);if(w)return this.fire(new s.z(new Error(`Source "${o}" cannot be removed while iconset "${w[0]}" is using it.`)))}const y=this.getOwnSourceCaches(o);for(const w of y){const E=s.d7(w.id);delete this._sourceCaches[E],this._changes.discardSourceCacheUpdate(w.id),w.fire(new s.A("data",{sourceDataType:"metadata",dataType:"source",sourceId:w.getSource().id})),w.setEventedParent(null),w.clearTiles()}return delete this._otherSourceCaches[o],delete this._symbolSourceCaches[o],this.mergeSources(),f.setEventedParent(null),f.onRemove&&f.onRemove(this.map),this._changes.setDirty(),this}setGeoJSONSourceData(o,f){this._checkLoaded(),this.getOwnSource(o).setData(f),this._changes.setDirty()}getOwnSource(o){const f=this.getOwnSourceCache(o);return f&&f.getSource()}getOwnSources(){const o=[];for(const f in this._otherSourceCaches){const y=this.getOwnSourceCache(f);y&&o.push(y.getSource())}return o}areTilesLoaded(){const o=this._mergedSourceCaches;for(const f in o){const y=o[f]._tiles;for(const w in y){const E=y[w];if(E.state!=="loaded"&&E.state!=="errored")return!1}}return!0}setLights(o){if(this._checkLoaded(),!o)return delete this.ambientLight,void delete this.directionalLight;const f=this._getTransitionParameters();for(const E of o){if(this._validate(Ii,"lights",E))return;switch(E.type){case"ambient":if(this.ambientLight){const C=this.ambientLight;C.set(E),C.updateTransitions(f)}else this.ambientLight=new Ai(E,ii||(ii=new s.a7({color:new s.a8(s.a5.properties_light_ambient.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_ambient.intensity)})),this.scope,this.options);break;case"directional":if(this.directionalLight){const C=this.directionalLight;C.set(E),C.updateTransitions(f)}else this.directionalLight=new Ai(E,Xi||(Xi=new s.a7({direction:new s.an(s.a5.properties_light_directional.direction),color:new s.a8(s.a5.properties_light_directional.color),"color-use-theme":new s.a8({type:"string",default:"default","property-type":"data-constant"}),intensity:new s.a8(s.a5.properties_light_directional.intensity),"cast-shadows":new s.a8(s.a5.properties_light_directional["cast-shadows"]),"shadow-quality":new s.a8(s.a5.properties_light_directional["shadow-quality"]),"shadow-intensity":new s.a8(s.a5.properties_light_directional["shadow-intensity"])})),this.scope,this.options)}}const y=Object.assign(f,{worldview:this.map.getWorldview()}),w=new s.aa(this.z||0,y);this.ambientLight&&this.ambientLight.recalculate(w),this.directionalLight&&this.directionalLight.recalculate(w),this._brightness=this.calculateLightsBrightness(),this.dispatcher.broadcast("setBrightness",this._brightness)}calculateLightsBrightness(){const o=this.directionalLight,f=this.ambientLight;if(!o||!f)return;const y=W=>.2126*(W[0]<=.03928?W[0]/12.92:Math.pow((W[0]+.055)/1.055,2.4))+.7152*(W[1]<=.03928?W[1]/12.92:Math.pow((W[1]+.055)/1.055,2.4))+.0722*(W[2]<=.03928?W[2]/12.92:Math.pow((W[2]+.055)/1.055,2.4)),w=o.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),E=o.properties.get("intensity"),C=o.properties.get("direction"),M=1-s.cR(C.x,C.y,C.z)[2]/90,N=y(w)*E*M,j=f.properties.get("color").toNonPremultipliedRenderColor(null).toArray01(),H=f.properties.get("intensity"),Z=y(j)*H;return Number(((N+Z)/2).toFixed(6))}getBrightness(){return this._brightness}getLights(){if(!this.enable3dLights())return null;const o=[];return this.directionalLight&&o.push(this.directionalLight.get()),this.ambientLight&&o.push(this.ambientLight.get()),o}enable3dLights(){return!!this.ambientLight&&!!this.directionalLight}getFragmentStyle(o){if(o==null||o===""&&this.isRootStyle())return this;if(s.d8(o)){const f=s.d9(o),y=this.fragments.find(({id:E})=>E===f);if(!y)return;const w=s.d7(o);return y.style.getFragmentStyle(w)}{const f=this.fragments.find(({id:y})=>y===o);return f?f.style:void 0}}setFeaturesetSelectors(o){if(!o)return;const f={},y=(w,E="")=>`${w}::${E}`;this._featuresetSelectors={};for(const w in o){const E=this._featuresetSelectors[w]=[];for(const C of o[w].selectors){if(C.featureNamespace){const N=this.getOwnLayer(C.layer);if(!N){s.w(`Layer is undefined for selector: ${C.layer}`);continue}const j=y(N.source,N.sourceLayer);if(j in f&&f[j]!==C.featureNamespace){s.w(`"featureNamespace ${C.featureNamespace} of featureset ${w}'s selector is not associated to the same source, skip this selector`);continue}f[j]=C.featureNamespace}let M;if(C.properties)for(const N in C.properties){const j=s.X(C.properties[N]);j.result==="success"&&(M=M||{},M[N]=j.value)}E.push({layerId:C.layer,namespace:C.featureNamespace,properties:M,uniqueFeatureID:C._uniqueFeatureID})}}}getFeaturesetDescriptors(o){const f=this.getFragmentStyle(o);if(!f||!f.stylesheet.featuresets)return[];const y=[];for(const w in f.stylesheet.featuresets)y.push({featuresetId:w,importId:f.scope?f.scope:void 0});return y}getFeaturesetLayers(o,f){const y=this.getFragmentStyle(f),w=y.stylesheet.featuresets;if(!w||!w[o])return this.fire(new s.z(new Error(`The featureset '${o}' does not exist in the map's style and cannot be queried.`))),[];const E=[];for(const C of w[o].selectors){const M=y.getOwnLayer(C.layer);M&&E.push(M)}return E}getConfigProperty(o,f){const y=this.getFragmentStyle(o);if(!y)return null;const w=s.C(f,y.scope),E=y.options.get(w),C=E?E.value||E.default:null;return C?C.serialize():null}setConfigProperty(o,f,y){const w=this.getFragmentStyle(o);if(!w)return;const E=w.stylesheet.indoor?Ml(w.stylesheet.schema):w.stylesheet.schema;if(!E||!E[f])return;const C=s.X(y);if(C.result!=="success")return void hh(this,C.value);const M=C.value.expression,N=s.C(f,w.scope),j=w.options.get(N);if(!j)return;let H;const{minValue:Z,maxValue:W,stepValue:Q,type:ce,values:se}=E[f],ue=s.X(E[f].default);ue.result==="success"&&(H=ue.value.expression),H?(this.options.set(N,Object.assign({},j,{value:M,default:H,minValue:Z,maxValue:W,stepValue:Q,type:ce,values:se})),this.updateConfigDependencies(f)):this.fire(new s.z(new Error(`No schema defined for the config option "${f}" in the "${o}" fragment.`)))}getConfig(o){const f=this.getFragmentStyle(o);if(!f)return null;const y=f.stylesheet.schema;if(!y)return null;const w={};for(const E in y){const C=s.C(E,f.scope),M=f.options.get(C),N=M?M.value||M.default:null;w[E]=N?N.serialize():null}return w}setConfig(o,f){const y=this.getFragmentStyle(o);y&&(y.updateConfig(f,y.stylesheet.schema),this.updateConfigDependencies())}getSchema(o){const f=this.getFragmentStyle(o);return f?f.stylesheet.schema:null}setSchema(o,f){const y=this.getFragmentStyle(o);y&&(y.stylesheet.schema=f,y.updateConfig(y._config,f),this.updateConfigDependencies())}updateConfig(o,f){if(this._config=o,o||f)if(f)for(const y in f){let w,E;const C=s.X(f[y].default);if(C.result==="success"&&(w=C.value.expression),o&&o[y]!==void 0){const W=s.X(o[y]);W.result==="success"&&(E=W.value.expression)}const{minValue:M,maxValue:N,stepValue:j,type:H,values:Z}=f[y];if(w){const W=s.C(y,this.scope);this.options.set(W,{default:w,value:E,minValue:M,maxValue:N,stepValue:j,type:H,values:Z})}else this.fire(new s.z(new Error(`No schema defined for config option "${y}".`)))}else this.fire(new s.z(new Error("Attempting to set config for a style without schema.")))}updateConfigDependencies(o){for(const f of this._configDependentLayers){const y=this.getLayer(f);if(y){if(o&&!y.configDependencies.has(o))continue;y.possiblyEvaluateVisibility(),this._updateLayer(y)}}this.ambientLight&&this.ambientLight.updateConfig(this.options),this.directionalLight&&this.directionalLight.updateConfig(this.options),this.fog&&this.fog.updateConfig(this.options),this.snow&&this.snow.updateConfig(this.options),this.rain&&this.rain.updateConfig(this.options),this.forEachFragmentStyle(f=>{const y=f._styleColorTheme.colorThemeOverride?f._styleColorTheme.colorThemeOverride:f._styleColorTheme.colorTheme;if(y){const w=f._evaluateColorThemeData(y);(!f._styleColorTheme.lut&&w!==""||f._styleColorTheme.lut&&w!==f._styleColorTheme.lut.data)&&f.setColorTheme(y)}}),this._changes.setDirty()}addLayer(o,f,y={}){this._checkLoaded();const w=o.id;if(this._layers[w])return void this.fire(new s.z(new Error(`Layer with id "${w}" already exists on this map`)));let E;if(o.type==="custom"){if(hh(this,s.da(o)))return;E=s.db(o,this.scope,this._styleColorTheme.lut,this.options)}else{if(typeof o.source=="object"&&(this.addSource(w,o.source),o=s.d6(o),o=s.h(o,{source:w})),this._validate(bi,`layers.${w}`,o,{arrayIndex:-1},y))return;E=s.db(o,this.scope,this._styleColorTheme.lut,this.options),this._validateLayer(E),E.setEventedParent(this,{layer:{id:w}})}E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid);let C=this._order.length;if(f){const H=this._order.indexOf(f);if(H===-1)return void this.fire(new s.z(new Error(`Layer with id "${f}" does not exist on this map.`)));E.slot===this._layers[f].slot?C=H:s.w(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(C,0,w),this._layerOrderChanged=!0,this._layers[w]=E;const M=this.getOwnLayerSourceCache(E),N=!!this.directionalLight&&this.directionalLight.shadowsEnabled();M&&E.canCastShadows()&&N&&(M.castsShadows=!0);const j=this._changes.getRemovedLayer(E);if(j&&E.source&&M&&E.type!=="custom"){this._changes.discardLayerRemoval(E);const H=s.C(E.source,E.scope);j.type!==E.type?this._changes.updateSourceCache(H,"clear"):(this._changes.updateSourceCache(H,"reload"),M.pause())}this._updateLayer(E),E.onAdd&&E.onAdd(this.map),E.scope=this.scope,this.mergeLayers()}moveLayer(o,f){this._checkLoaded();const y=this._checkLayer(o);if(!y||o===f)return;const w=this._order.indexOf(o);this._order.splice(w,1);let E=this._order.length;if(f){const C=this._order.indexOf(f);if(C===-1)return void this.fire(new s.z(new Error(`Layer with id "${f}" does not exist on this map.`)));y.slot===this._layers[f].slot?E=C:s.w(`Layer with id "${f}" has a different slot. Layers can only be rearranged within the same slot.`)}this._order.splice(E,0,o),this._changes.setDirty(),this._layerOrderChanged=!0,this.mergeLayers()}removeLayer(o){this._checkLoaded();const f=this._checkLayer(o);if(!f)return;f.setEventedParent(null);const y=this._order.indexOf(o);this._order.splice(y,1),delete this._layers[o],this._changes.setDirty(),this._layerOrderChanged=!0,this._configDependentLayers.delete(f.fqid),this._changes.removeLayer(f);const w=this.getOwnLayerSourceCache(f);if(w&&w.castsShadows){let E=!1;for(const C in this._layers)if(this._layers[C].source===f.source&&this._layers[C].canCastShadows()){E=!0;break}w.castsShadows=E}f.onRemove&&f.onRemove(this.map),this.mergeLayers()}getOwnLayer(o){return this._layers[o]}hasLayer(o){return o in this._mergedLayers}hasLayerType(o){for(const f in this._layers)if(this._layers[f].type===o)return!0;return!1}setLayerZoomRange(o,f,y){this._checkLoaded();const w=this._checkLayer(o);w&&(w.minzoom===f&&w.maxzoom===y||(f!=null&&(w.minzoom=f),y!=null&&(w.maxzoom=y),this._updateLayer(w)))}getSlots(){return this._checkLoaded(),this._mergedSlots}setSlot(o,f){this._checkLoaded();const y=this._checkLayer(o);y&&y.slot!==f&&(y.slot=f,this._updateLayer(y))}setFilter(o,f,y={}){this._checkLoaded();const w=this._checkLayer(o);if(w&&!s.bv(w.filter,f))return f==null?(w.filter=void 0,void this._updateLayer(w)):void(this._validate(gt,`layers.${w.id}.filter`,f,{layerType:w.type},y)||(w.filter=s.d6(f),this._updateLayer(w)))}getFilter(o){const f=this._checkLayer(o);if(f)return s.d6(f.filter)}setLayoutProperty(o,f,y,w={}){this._checkLoaded();const E=this._checkLayer(o);if(E&&!s.bv(E.getLayoutProperty(f),y)){if(y!=null&&(!w||w.validate!==!1)&&hh(E,ve.call(Wn,{key:`layers.${o}.layout.${f}`,layerType:E.type,objectKey:f,value:y,styleSpec:s.a5,style:{glyphs:!0,sprite:!0}})))return;E.setLayoutProperty(f,y),E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),this._updateLayer(E)}}getLayoutProperty(o,f){const y=this._checkLayer(o);if(y)return y.getLayoutProperty(f)}setPaintProperty(o,f,y,w={}){this._checkLoaded();const E=this._checkLayer(o);if(!E||s.bv(E.getPaintProperty(f),y)||y!=null&&(!w||w.validate!==!1)&&hh(E,fe.call(Wn,{key:`layers.${o}.paint.${f}`,layerType:E.type,objectKey:f,value:y,styleSpec:s.a5})))return;const C=E.setPaintProperty(f,y);E.configDependencies.size!==0&&this._configDependentLayers.add(E.fqid),C&&this._updateLayer(E),this._changes.updatePaintProperties(E)}getPaintProperty(o,f){const y=this._checkLayer(o);if(y)return y.getPaintProperty(f)}setFeatureState(o,f){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:N,importId:j}=o.target,H=this.getFragmentStyle(j),Z=H.getFeaturesetLayers(N);for(const{source:W,sourceLayer:Q}of Z)H.setFeatureState({id:o.id,source:W,sourceLayer:Q},f)}else if("layerId"in o.target){const{layerId:N}=o.target,j=this.getLayer(N);this.setFeatureState({id:o.id,source:j.source,sourceLayer:j.sourceLayer},f)}return}const y=o.source,w=o.sourceLayer,E=this._checkSource(y);if(!E)return;const C=E.type;if(C==="geojson"&&w)return void this.fire(new s.z(new Error("GeoJSON sources cannot have a sourceLayer parameter.")));if(C==="vector"&&!w)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));o.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided.")));const M=this.getOwnSourceCaches(y);for(const N of M)N.setFeatureState(w,o.id,f)}removeFeatureState(o,f){if(this._checkLoaded(),"target"in o){if("featuresetId"in o.target){const{featuresetId:N,importId:j}=o.target,H=this.getFragmentStyle(j),Z=H.getFeaturesetLayers(N);for(const{source:W,sourceLayer:Q}of Z)H.removeFeatureState({id:o.id,source:W,sourceLayer:Q},f)}else if("layerId"in o.target){const{layerId:N}=o.target,j=this.getLayer(N);this.removeFeatureState({id:o.id,source:j.source,sourceLayer:j.sourceLayer},f)}return}const y=o.source,w=this._checkSource(y);if(!w)return;const E=w.type,C=E==="vector"?o.sourceLayer:void 0;if(E==="vector"&&!C)return void this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")));if(f&&typeof o.id!="string"&&typeof o.id!="number")return void this.fire(new s.z(new Error("A feature id is required to remove its specific state property.")));const M=this.getOwnSourceCaches(y);for(const N of M)N.removeFeatureState(C,o.id,f)}getFeatureState(o){if(this._checkLoaded(),"target"in o){let E;if("featuresetId"in o.target){const{featuresetId:C,importId:M}=o.target,N=this.getFragmentStyle(M),j=N.getFeaturesetLayers(C);for(const{source:H,sourceLayer:Z}of j){const W=N.getFeatureState({id:o.id,source:H,sourceLayer:Z});if(W&&!E)E=W;else if(!s.bv(E,W))return void this.fire(new s.z(new Error("The same feature id exists in multiple sources in the featureset, but their feature states are not consistent through the sources.")))}}else if("layerId"in o.target){const{layerId:C}=o.target,M=this.getLayer(C);E=this.getFeatureState({id:o.id,source:M.source,sourceLayer:M.sourceLayer})}return E}const f=o.source,y=o.sourceLayer,w=this._checkSource(f);if(w){if(w.type!=="vector"||y)return o.id===void 0&&this.fire(new s.z(new Error("The feature id parameter must be provided."))),this.getOwnSourceCaches(f)[0].getFeatureState(y,o.id);this.fire(new s.z(new Error("The sourceLayer parameter must be provided for vector source types.")))}}setTransition(o){return this.stylesheet.transition=s.h({},this.stylesheet.transition,o),this.transition=this.stylesheet.transition,this}getTransition(){return s.h({},this.stylesheet.transition)}serialize(){this._checkLoaded();const o=this.getTerrain(),f=o&&this.terrain&&this.terrain.scope===this.scope?o:this.stylesheet.terrain;return s.dc({version:this.stylesheet.version,name:this.stylesheet.name,metadata:this.stylesheet.metadata,fragment:this.stylesheet.fragment,iconsets:this.stylesheet.iconsets,imports:this._serializeImports(),schema:this.stylesheet.schema,camera:this.stylesheet.camera,light:this.stylesheet.light,lights:this.stylesheet.lights,terrain:f,fog:this.stylesheet.fog,snow:this.stylesheet.snow,rain:this.stylesheet.rain,center:this.stylesheet.center,"color-theme":this.stylesheet["color-theme"],zoom:this.stylesheet.zoom,bearing:this.stylesheet.bearing,pitch:this.stylesheet.pitch,sprite:this.stylesheet.sprite,glyphs:this.stylesheet.glyphs,transition:this.stylesheet.transition,projection:this.stylesheet.projection,sources:this._serializeSources(),layers:this._serializeLayers(this._order)},y=>y!==void 0)}_updateFilteredLayers(o){for(const f of Object.values(this._mergedLayers))o(f)&&this._updateLayer(f)}_updateLayer(o){this._changes.updateLayer(o);const f=this.getLayerSourceCache(o),y=s.C(o.source,o.scope),w=this._changes.getUpdatedSourceCaches();o.source&&!w[y]&&f&&f.getSource().type!=="raster"&&(this._changes.updateSourceCache(y,"reload"),f.pause()),o.invalidateCompiledFilter()}_flattenAndSortRenderedFeatures(o){const f=M=>this._mergedLayers[M].is3D(!!this.terrain),y=this.order,w={},E=[];for(let M=y.length-1;M>=0;M--){const N=y[M];if(f(N)){w[N]=M;for(const j of o){const H=j[N];if(H)for(const Z of H)E.push(Z)}}}E.sort((M,N)=>N.intersectionZ-M.intersectionZ);const C=[];for(let M=y.length-1;M>=0;M--){const N=y[M];if(f(N))for(let j=E.length-1;j>=0;j--){const H=E[j].feature;if(H.layer&&w[H.layer.id]<M)break;C.push(H),E.pop()}else for(const j of o){const H=j[N];if(H)for(const Z of H)C.push(Z.feature)}}return C}queryRenderedFeatures(o,f,y){let w;f&&!Array.isArray(f)&&f.filter&&(this._validate(gt,"queryRenderedFeatures.filter",f.filter,null,f),w=s.b3(f.filter));const E={},C=H=>{if(Pl.has(H.type))return;const Z=this.getOwnLayerSourceCache(H),W=E[Z.id]=E[Z.id]||{sourceCache:Z,layers:{},has3DLayers:!1};H.is3D(!!this.terrain)&&(W.has3DLayers=!0),W.layers[H.fqid]=W.layers[H.fqid]||{styleLayer:H,targets:[]},W.layers[H.fqid].targets.push({filter:w})};if(f&&f.layers){if(!Array.isArray(f.layers))return this.fire(new s.z(new Error("parameters.layers must be an Array."))),[];for(const H of f.layers){const Z=this._layers[H];if(!Z)return this.fire(new s.z(new Error(`The layer '${H}' does not exist in the map's style and cannot be queried for features.`))),[];C(Z)}}else for(const H in this._layers)C(this._layers[H]);const M=this._queryRenderedFeatures(o,E,y),N=this._flattenAndSortRenderedFeatures(M),j=[];for(const H of N)s.dd(H.layer.id)===this.scope&&j.push(H);return j}queryRenderedFeatureset(o,f,y){let w;f&&!Array.isArray(f)&&f.filter&&(this._validate(gt,"queryRenderedFeatures.filter",f.filter,null,f),w=s.b3(f.filter));const E="mock",C=[];if(f&&f.target)C.push(Object.assign({},f,{targetId:E,filter:w}));else{const H=this.getFeaturesetDescriptors();for(const Z of H)C.push({targetId:E,filter:w,target:Z});for(const{style:Z}of this.fragments){const W=Z.getFeaturesetDescriptors();for(const Q of W)C.push({targetId:E,filter:w,target:Q})}}const M=this.queryRenderedTargets(o,C,y),N=[],j=new Set;for(const H of M)for(const Z of H.variants[E])Jl(Z,H,j)||N.push(new s.de(H,Z));return N}queryRenderedTargets(o,f,y){const w={},E=(M,N,j,H)=>{const Z=w[N.id]=w[N.id]||{sourceCache:N,layers:{},has3DLayers:!1};if(Z.layers[M.fqid]=Z.layers[M.fqid]||{styleLayer:M,targets:[]},M.is3D(!!this.terrain)&&(Z.has3DLayers=!0),!H)return j.uniqueFeatureID=!1,void Z.layers[M.fqid].targets.push(j);Z.layers[M.fqid].targets.push(Object.assign({},j,{namespace:H.namespace,properties:H.properties,uniqueFeatureID:H.uniqueFeatureID}))};for(const M of f)if("featuresetId"in M.target){const{featuresetId:N,importId:j}=M.target,H=this.getFragmentStyle(j);if(!H||!H._featuresetSelectors)continue;const Z=H._featuresetSelectors[N];if(!Z){this.fire(new s.z(new Error(`The featureset '${N}' does not exist in the map's style and cannot be queried for features.`)));continue}for(const W of Z){const Q=H.getOwnLayer(W.layerId);Q&&!Pl.has(Q.type)&&E(Q,H.getOwnLayerSourceCache(Q),M,W)}}else if("layerId"in M.target){const{layerId:N}=M.target,j=this.getLayer(N);if(!j||Pl.has(j.type))continue;E(j,this.getLayerSourceCache(j),M)}const C=this._queryRenderedFeatures(o,w,y);return this._flattenAndSortRenderedFeatures(C)}_queryRenderedFeatures(o,f,y){const w=[],E=!!this.map._showQueryGeometry,C=Ei.createFromScreenPoints(o,y);for(const M in f){const N=Xu(C,f[M],this._availableImages,y,E);Object.keys(N).length&&w.push(N)}if(this.placement)for(const M in f){if(!f[M].sourceCache._onlySymbols)continue;const N=Qu(C.screenGeometry,f[M],this._availableImages,this.placement.collisionIndex,this.placement.retainedQueryData,this.map.getWorldview());Object.keys(N).length&&w.push(N)}return w}querySourceFeatures(o,f){const y=f&&f.filter;y&&this._validate(gt,"querySourceFeatures.filter",y,null,f);let w=[];const E=this.getOwnSourceCaches(o);for(const C of E)w=w.concat(Dl(C,f));return w}addSourceType(o,f,y){return Go.getSourceType(o)?y(new Error(`A source type called "${o}" already exists.`)):(Go.setSourceType(o,f),f.workerSourceURL?void this.dispatcher.broadcast("loadWorkerSource",{name:o,url:f.workerSourceURL},y):y(null,null))}getFlatLight(){return this.light.getLight()}setFlatLight(o,f,y={}){this._checkLoaded();const w=this.light.getLight();let E=!1;for(const M in o)if(!s.bv(o[M],w[M])){E=!0;break}if(!E)return;const C=this._getTransitionParameters();this.light.setLight(o,f,y),this.light.updateTransitions(C)}getTerrain(){return this.terrain&&this.terrain.drapeRenderMode===1?this.terrain.get():null}setTerrainForDraping(){this.setTerrain({source:"",exaggeration:0},0)}checkCanvasFingerprintNoise(){this.disableElevatedTerrain===void 0&&(this.disableElevatedTerrain=s.q.hasCanvasFingerprintNoise(),this.disableElevatedTerrain&&s.w("Terrain and hillshade are disabled because of Canvas2D limitations when fingerprinting protection is enabled (e.g. in private browsing mode)."))}setTerrain(o,f=1){if(this._checkLoaded(),!o)return this.terrainSetForDrapingOnly()||(delete this.terrain,this.map.transform.projection.requiresDraping&&this.setTerrainForDraping()),f===0&&delete this.terrain,o===null?this.stylesheet.terrain=null:delete this.stylesheet.terrain,this._force3DLayerUpdate(),void(this._markersNeedUpdate=!0);this.checkCanvasFingerprintNoise();let y=o;const w=o.source==null;if(f===1){if(this.disableElevatedTerrain)return;if(typeof y.source=="object"){const M="terrain-dem-src";this.addSource(M,y.source),y=s.d6(y),y=s.h(y,{source:M})}const E=s.h({},y),C={};if(this.terrain&&w){E.source=this.terrain.get().source;const M=this.terrain?this.getFragmentStyle(this.terrain.scope):null;M&&(C.style=M.serialize())}if(this._validate(Lt,"terrain",E,C))return}if(!this.terrain||this.terrain.scope!==this.scope&&!w||this.terrain&&f!==this.terrain.drapeRenderMode){if(!y)return;this._createTerrain(y,f),this.fire(new s.A("data",{dataType:"style"}))}else{const E=this.terrain,C=E.get();for(const M of Object.keys(s.a5.terrain))!y.hasOwnProperty(M)&&s.a5.terrain[M].default&&(y[M]=s.a5.terrain[M].default);for(const M in o)if(!s.bv(o[M],C[M])){E.set(o,this.options),this.stylesheet.terrain=o;const N=this._getTransitionParameters({duration:0});E.updateTransitions(N),this.fire(new s.A("data",{dataType:"style"}));break}}this.mergeTerrain(),this.updateDrapeFirstLayers(),this._markersNeedUpdate=!0}_createFog(o){const f=this.fog=new Vn(o,this.map.transform,this.scope,this.options);this.stylesheet.fog=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}_createSnow(o){const f=this.snow=new tr(o,this.map.transform,this.scope,this.options);this.stylesheet.snow=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}_createRain(o){const f=this.rain=new cr(o,this.map.transform,this.scope,this.options);this.stylesheet.rain=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}_updateMarkersOpacity(){this.map._markers.length!==0&&this.map._requestDomTask(()=>{for(const o of this.map._markers)o._evaluateOpacity()})}getFog(){return this.fog?this.fog.get():null}setFog(o){if(this._checkLoaded(),!o)return delete this.fog,delete this.stylesheet.fog,void(this._markersNeedUpdate=!0);if(this.fog){const f=this.fog;if(!s.bv(f.get(),o)){f.set(o,this.options),this.stylesheet.fog=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}}else this._createFog(o);this._markersNeedUpdate=!0}getSnow(){return this.snow?this.snow.get():null}setSnow(o){if(this._checkLoaded(),!o)return delete this.snow,void delete this.stylesheet.snow;if(this.snow){const f=this.snow;if(!s.bv(f.get(),o)){f.set(o,this.options),this.stylesheet.snow=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}}else this._createSnow(o);this._markersNeedUpdate=!0}getRain(){return this.rain?this.rain.get():null}setRain(o){if(this._checkLoaded(),!o)return delete this.rain,void delete this.stylesheet.rain;if(this.rain){const f=this.rain;if(!s.bv(f.get(),o)){f.set(o,this.options),this.stylesheet.rain=f.get();const y=this._getTransitionParameters({duration:0});f.updateTransitions(y)}}else this._createRain(o);this._markersNeedUpdate=!0}_reloadColorTheme(){const o=()=>{for(const w in this._layers)this._layers[w].lut=this._styleColorTheme.lut;for(const w in this._sourceCaches)this._sourceCaches[w].clearTiles()},f=this._styleColorTheme.colorThemeOverride?this._styleColorTheme.colorThemeOverride:this._styleColorTheme.colorTheme;if(!f)return this._styleColorTheme.lut=null,void o();const y=this._evaluateColorThemeData(f);this._loadColorTheme(y).then(()=>{this.fire(new s.A("colorthemeset")),o()}).catch(w=>{s.w(`Couldn't set color theme: ${w}`)})}setColorTheme(o){this._checkLoaded(),this._styleColorTheme.colorThemeOverride&&s.w("Note: setColorTheme is called on a style with a color-theme override, the passed color-theme won't be visible."),this._styleColorTheme.colorTheme=o,this._reloadColorTheme()}setImportColorTheme(o,f){const y=this.getFragmentStyle(o);y&&(y._styleColorTheme.colorThemeOverride=f,y._reloadColorTheme())}_getTransitionParameters(o){return{now:s.q.now(),transition:s.h(this.transition,o)}}updateDrapeFirstLayers(){if(!this.terrain)return;const o=[],f=[];for(const y of this._mergedOrder)this.isLayerDraped(this._mergedLayers[y])?o.push(y):f.push(y);this._drapedFirstOrder=[],this._drapedFirstOrder.push(...o),this._drapedFirstOrder.push(...f)}_createTerrain(o,f){const y=this.terrain=new Ze(o,f,this.scope,this.options,this.map.getWorldview());f===1&&(this.stylesheet.terrain=o),this.mergeTerrain(),this.updateDrapeFirstLayers(),this._force3DLayerUpdate();const w=this._getTransitionParameters({duration:0});y.updateTransitions(w)}_force3DLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="fill-extrusion"&&this._updateLayer(f)}}_forceSymbolLayerUpdate(){for(const o in this._layers){const f=this._layers[o];f.type==="symbol"&&this._updateLayer(f)}}_validate(o,f,y,w,E={}){if(E&&E.validate===!1)return!1;const C=s.h({},this.serialize());return hh(this,o.call(Wn,s.h({key:f,style:C,value:y,styleSpec:s.a5},w)))}_remove(){this._request&&(this._request.cancel(),this._request=null),this._spriteRequest&&(this._spriteRequest.cancel(),this._spriteRequest=null),s.df.off("pluginStateChange",this._rtlTextPluginCallback);for(const o in this._mergedLayers)this._mergedLayers[o].setEventedParent(null);for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles(),this._mergedSourceCaches[o].setEventedParent(null);this.imageManager.removeScope(this.scope),this.setEventedParent(null),delete this.fog,delete this.snow,delete this.rain,delete this.terrain,delete this.ambientLight,delete this.directionalLight,this.isRootStyle()&&(this.imageManager.setEventedParent(null),this.modelManager.setEventedParent(null),this.modelManager.destroy(),this.dispatcher.remove())}clearSource(o){const f=this.getSourceCaches(o);for(const y of f)y.clearTiles()}clearSources(){for(const o in this._mergedSourceCaches)this._mergedSourceCaches[o].clearTiles()}reloadSource(o){const f=this.getSourceCaches(o);for(const y of f)y.resume(),y.reload()}reloadSources(){for(const o of this.getSources())o.reload&&o.reload()}reloadModels(){this.modelManager.reloadModels(""),this.forEachFragmentStyle(o=>{o.modelManager.reloadModels(o.scope)})}updateSources(o){let f;this.directionalLight&&(f=sc(this.directionalLight));const y=new Set;for(const w in this._mergedLayers){const E=this._mergedLayers[w];E.hasElevation()&&!y.has(E.source)&&y.add(E.source)}for(const w in this._mergedSourceCaches){const E=this._mergedSourceCaches[w],C=y.has(E._source.id);E.update(o,void 0,void 0,f,C)}}_generateCollisionBoxes(){for(const o in this._sourceCaches){const f=this._sourceCaches[o];f.resume(),f.reload()}}_updatePlacement(o,f,y,w,E,C,M=!1){let N=!1,j=!1;const H={},Z={};for(const W of this._mergedOrder){const Q=this._mergedLayers[W];if(Q.type!=="symbol")continue;const ce=s.C(Q.source,Q.scope);let se=H[ce];if(!se){const pe=this.getLayerSourceCache(Q);if(!pe)continue;const ge=pe.getRenderableIds(!0).map(Pe=>pe.getTileByID(Pe));Z[ce]=ge.slice(),se=H[ce]=ge.sort((Pe,Ve)=>Ve.tileID.overscaledZ-Pe.tileID.overscaledZ||(Pe.tileID.isLessThan(Ve.tileID)?-1:1))}const ue=this.crossTileSymbolIndex.addLayer(Q,se,f.center.lng,f.projection);N=N||ue}if(this.crossTileSymbolIndex.pruneUnusedLayers(this._mergedOrder),M=M||this._layerOrderChanged||w===0,this._layerOrderChanged&&this.fire(new s.A("neworder")),(M||!this.pauseablePlacement||this.pauseablePlacement.isDone()&&!this.placement.stillRecent(s.q.now(),f.zoom))&&(this.pauseablePlacement=new xe(f,this._mergedOrder,M,y,w,E,this.placement,this.fog&&f.projection.supportsFog?this.fog.state:null,this._buildingIndex),this._layerOrderChanged=!1),this.pauseablePlacement.isDone()?this.placement.setStale():(this.pauseablePlacement.continuePlacement(this._mergedOrder,this._mergedLayers,H,Z,this.map.painter.scaleFactor),this.pauseablePlacement.isDone()&&(this.placement=this.pauseablePlacement.commit(s.q.now()),j=!0),N&&this.pauseablePlacement.placement.setStale()),j||N){this._buildingIndex.onNewFrame(f.zoom);for(let W=0;W<this._mergedOrder.length;W++){const Q=this._mergedLayers[this._mergedOrder[W]];if(Q.type!=="symbol")continue;const ce=this.isLayerClipped(Q);this.placement.updateLayerOpacities(Q,H[s.C(Q.source,Q.scope)],W,ce?C:null)}}return{needsRerender:!this.pauseablePlacement.isDone()||this.placement.hasTransitions(s.q.now())}}_releaseSymbolFadeTiles(){for(const o in this._sourceCaches)this._sourceCaches[o].releaseSymbolFadeTiles()}addImport(o,f){this._checkLoaded();const y=this.stylesheet.imports=this.stylesheet.imports||[];if(y.findIndex(({id:E})=>E===o.id)!==-1)return void this.fire(new s.z(new Error(`Import with id '${o.id}' already exists in the map's style.`)));if(!f)return y.push(o),this._loadImports([o],!0);const w=y.findIndex(({id:E})=>E===f);return w===-1&&this.fire(new s.z(new Error(`Import with id "${f}" does not exist on this map.`))),this.stylesheet.imports=y.slice(0,w).concat(o).concat(y.slice(w)),this._loadImports([o],!0,f)}updateImport(o,f){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(o);return w===-1?this:typeof f=="string"?(this.setImportUrl(o,f),this):(f.url&&f.url!==y[w].url&&this.setImportUrl(o,f.url),s.bv(f.config,y[w].config)||this.setImportConfig(o,f.config,f.data.schema),s.bv(f.data,y[w].data)||this.setImportData(o,f.data),this)}moveImport(o,f){this._checkLoaded();let y=this.stylesheet.imports||[];const w=this.getImportIndex(o);if(w===-1)return this;const E=this.getImportIndex(f);if(E===-1)return this;const C=y[w],M=this.fragments[w];return y=y.filter(({id:N})=>N!==o),this.fragments=this.fragments.filter(({id:N})=>N!==o),this.stylesheet.imports=y.slice(0,E).concat(C).concat(y.slice(E)),this.fragments=this.fragments.slice(0,E).concat(M).concat(this.fragments.slice(E)),this.mergeLayers(),this}setImportUrl(o,f){this._checkLoaded();const y=this.stylesheet.imports||[],w=this.getImportIndex(o);if(w===-1)return this;y[w].url=f;const E=this.fragments[w];return E.style=this._createFragmentStyle(y[w]),E.style.on("style.import.load",()=>this.mergeAll()),E.style.loadURL(f),this}setImportData(o,f){this._checkLoaded();const y=this.getImportIndex(o),w=this.stylesheet.imports||[];return y===-1?this:f?(this.fragments[y].style.setState(f),this._reloadImports(),this):(delete w[y].data,this.setImportUrl(o,w[y].url))}setImportConfig(o,f,y){this._checkLoaded();const w=this.getImportIndex(o),E=this.stylesheet.imports||[];if(w===-1)return this;f?E[w].config=f:delete E[w].config;const C=this.fragments[w];y&&C.style.stylesheet&&(C.style.stylesheet.schema=y);const M=C.style.stylesheet&&C.style.stylesheet.schema;return C.config=f,C.style.updateConfig(f,M),this.updateConfigDependencies(),this}removeImport(o){this._checkLoaded();const f=this.stylesheet.imports||[],y=this.getImportIndex(o);y!==-1&&(f.splice(y,1),this.fragments[y].style._remove(),this.fragments.splice(y,1),this._reloadImports())}getImportIndex(o){const f=(this.stylesheet.imports||[]).findIndex(y=>y.id===o);return f===-1&&this.fire(new s.z(new Error(`Import '${o}' does not exist in the map's style and cannot be updated.`))),f}getLayer(o){return this._mergedLayers[o]}getSources(){const o=[];for(const f in this._mergedOtherSourceCaches){const y=this._mergedOtherSourceCaches[f];y&&o.push(y.getSource())}return o}getSource(o,f){const y=this.getSourceCache(o,f);return y&&y.getSource()}getLayerSource(o){const f=this.getLayerSourceCache(o);return f&&f.getSource()}getSourceCache(o,f){const y=s.C(o,f);return this._mergedOtherSourceCaches[y]}getLayerSourceCache(o){const f=s.C(o.source,o.scope);return o.type==="symbol"?this._mergedSymbolSourceCaches[f]:this._mergedOtherSourceCaches[f]}getSourceCaches(o){if(o==null)return Object.values(this._mergedSourceCaches);const f=[];return this._mergedOtherSourceCaches[o]&&f.push(this._mergedOtherSourceCaches[o]),this._mergedSymbolSourceCaches[o]&&f.push(this._mergedSymbolSourceCaches[o]),f}updateSourceCaches(){const o=this._changes.getUpdatedSourceCaches();for(const f in o){const y=o[f];y==="reload"?this.reloadSource(f):y==="clear"&&this.clearSource(f)}}updateLayers(o){const f=this._changes.getUpdatedPaintProperties();for(const y of f){const w=this.getLayer(y);w&&w.updateTransitions(o)}}getGlyphsUrl(){return this.stylesheet.glyphs}setGlyphsUrl(o){this.stylesheet.glyphs=o,this.glyphManager.setURL(o,this.scope)}getImages(o,f,y){this.imageManager.getImages(f.images,f.scope,y),this._updateTilesForChangedImages();const w=C=>{if(C){const M=f.images.map(N=>s.I.toString(N));C.setDependencies(f.tileID.key,f.type,M)}},E=s.C(f.source,f.scope);w(this._mergedOtherSourceCaches[E]),w(this._mergedSymbolSourceCaches[E])}rasterizeImages(o,f,y){this.imageManager.rasterizeImages(f,y)}getGlyphs(o,f,y){this.glyphManager.getGlyphs(f.stacks,f.scope,y)}getResource(o,f,y){return s.dg(f,y)}getOwnSourceCache(o){return this._otherSourceCaches[o]}getOwnLayerSourceCache(o){return o.type==="symbol"?this._symbolSourceCaches[o.source]:this._otherSourceCaches[o.source]}getOwnSourceCaches(o){const f=[];return this._otherSourceCaches[o]&&f.push(this._otherSourceCaches[o]),this._symbolSourceCaches[o]&&f.push(this._symbolSourceCaches[o]),f}_isSourceCacheLoaded(o){const f=this.getOwnSourceCaches(o);return f.length===0?(this.fire(new s.z(new Error(`There is no source with ID '${o}'`))),!1):f.every(y=>y.loaded())}has3DLayers(){return this._has3DLayers}hasSymbolLayers(){return this._hasSymbolLayers}hasCircleLayers(){return this._hasCircleLayers}isLayerClipped(o,f){if(!this._clipLayerPresent&&o.type!=="fill-extrusion"&&o.type!=="building")return!1;const y=o.type==="fill-extrusion"&&o.sourceLayer==="building",w=o.type==="building";if(o.is3D(!!this.terrain)){if(y||w||f&&f.type==="batched-model"||o.type==="model")return!0}else if(o.type==="symbol")return!0;return!1}_clearWorkerCaches(){this.dispatcher.broadcast("clearCaches")}destroy(){this._clearWorkerCaches(),this.fragments.forEach(o=>{o.style._remove()}),this.terrainSetForDrapingOnly()&&(delete this.terrain,delete this.stylesheet.terrain)}}Go.getSourceType=function(_){return wu[_]},Go.setSourceType=function(_,o){wu[_]=o},Go.registerForPluginStateChange=s.dh;var eg=`
#define EPSILON 0.0000001
#define PI 3.141592653589793
#ifdef RENDER_CUTOFF
float cutoff_opacity(vec4 cutoff_params,float depth) {float near=cutoff_params.x;float far=cutoff_params.y;float cutoffStart=cutoff_params.z;float cutoffEnd=cutoff_params.w;float linearDepth=(depth-near)/(far-near);return clamp((linearDepth-cutoffStart)/(cutoffEnd-cutoffStart),0.0,1.0);}
#endif`,tg=`
out vec4 glFragColor;highp float unpack_depth(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}highp vec4 pack_depth(highp float ndc_z) {highp float depth=ndc_z*0.5+0.5;const highp vec4 bit_shift=vec4(255.0*255.0*255.0,255.0*255.0,255.0,1.0);const highp vec4 bit_mask =vec4(0.0,1.0/255.0,1.0/255.0,1.0/255.0);highp vec4 res=fract(depth*bit_shift);res-=res.xxyz*bit_mask;return res;}
#ifdef INDICATOR_CUTOUT
uniform vec3 u_indicator_cutout_centers;uniform vec4 u_indicator_cutout_params;
#endif
vec4 applyCutout(vec4 color,float height) {
#ifdef INDICATOR_CUTOUT
float verticalFadeRange=u_indicator_cutout_centers.z*0.25;float holeMinOpacity=mix(1.0,u_indicator_cutout_params.x,smoothstep(u_indicator_cutout_centers.z,u_indicator_cutout_centers.z+verticalFadeRange,height));float holeRadius=max(u_indicator_cutout_params.y,0.0);float holeAspectRatio=u_indicator_cutout_params.z;float fadeStart=u_indicator_cutout_params.w;float distA=distance(vec2(gl_FragCoord.x,gl_FragCoord.y*holeAspectRatio),vec2(u_indicator_cutout_centers[0],u_indicator_cutout_centers[1]*holeAspectRatio));return color*min(smoothstep(fadeStart,holeRadius,distA)+holeMinOpacity,1.0);
#else
return color;
#endif
}
#ifdef DEBUG_WIREFRAME
#define HANDLE_WIREFRAME_DEBUG \\
glFragColor=vec4(0.7,0.0,0.0,0.7); \\
gl_FragDepth=gl_FragCoord.z-0.0001;
#else
#define HANDLE_WIREFRAME_DEBUG
#endif
#ifdef RENDER_CUTOFF
uniform highp vec4 u_cutoff_params;in float v_cutoff_opacity;
#endif
vec4 textureLodCustom(sampler2D image,highp vec2 pos,highp vec2 lod_coord) {highp vec2 size=vec2(textureSize(image,0));highp vec2 dx=dFdx(lod_coord.xy*size);highp vec2 dy=dFdy(lod_coord.xy*size);highp float delta_max_sqr=max(dot(dx,dx),dot(dy,dy));highp float lod=0.5*log2(delta_max_sqr);return textureLod(image,pos,lod);}vec4 applyLUT(highp sampler3D lut,vec4 col) {vec3 size=vec3(textureSize(lut,0));vec3 uvw=(col.rbg*float(size-1.0)+0.5)/size;return vec4(texture(lut,uvw).rgb,col.a);}vec3 applyLUT(highp sampler3D lut,vec3 col) {return applyLUT(lut,vec4(col,1.0)).rgb;}`,Op=`
#define EXTENT 8192.0
#define RAD_TO_DEG 180.0/PI
#define DEG_TO_RAD PI/180.0
#define GLOBE_RADIUS EXTENT/PI/2.0
float wrap(float n,float min,float max) {float d=max-min;float w=mod(mod(n-min,d)+d,d)+min;return (w==min) ? max : w;}
#ifdef PROJECTION_GLOBE_VIEW
vec3 mercator_tile_position(mat4 matrix,vec2 tile_anchor,vec3 tile_id,vec2 mercator_center) {
#ifndef PROJECTED_POS_ON_VIEWPORT
float tiles=tile_id.z;vec2 mercator=(tile_anchor/EXTENT+tile_id.xy)/tiles;mercator-=mercator_center;mercator.x=wrap(mercator.x,-0.5,0.5);vec4 mercator_tile=vec4(mercator.xy*EXTENT,EXTENT/(2.0*PI),1.0);mercator_tile=matrix*mercator_tile;return mercator_tile.xyz;
#else
return vec3(0.0);
#endif
}vec3 mix_globe_mercator(vec3 globe,vec3 mercator,float t) {return mix(globe,mercator,t);}mat3 globe_mercator_surface_vectors(vec3 pos_normal,vec3 up_dir,float zoom_transition) {vec3 normal=zoom_transition==0.0 ? pos_normal : normalize(mix(pos_normal,up_dir,zoom_transition));vec3 xAxis=normalize(vec3(normal.z,0.0,-normal.x));vec3 yAxis=normalize(cross(normal,xAxis));return mat3(xAxis,yAxis,normal);}
#endif
vec2 unpack_float(const float packedValue) {int packedIntValue=int(packedValue);int v0=packedIntValue/256;return vec2(v0,packedIntValue-v0*256);}vec2 unpack_opacity(const float packedOpacity) {int intOpacity=int(packedOpacity)/2;return vec2(float(intOpacity)/127.0,mod(packedOpacity,2.0));}vec4 decode_color(const vec2 encodedColor) {return vec4(
unpack_float(encodedColor[0])/255.0,unpack_float(encodedColor[1])/255.0
);}float unpack_mix_vec2(const vec2 packedValue,const float t) {return mix(packedValue[0],packedValue[1],t);}vec4 unpack_mix_color(const vec4 packedColors,const float t) {vec4 minColor=decode_color(vec2(packedColors[0],packedColors[1]));vec4 maxColor=decode_color(vec2(packedColors[2],packedColors[3]));return mix(minColor,maxColor,t);}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const vec2 units_to_pixels,const vec2 pos) {vec2 offset=mod(mod(mod(pixel_coord_upper,pattern_size)*256.0,pattern_size)*256.0+pixel_coord_lower,pattern_size);return (units_to_pixels*pos+offset)/pattern_size;}vec2 get_pattern_pos(const vec2 pixel_coord_upper,const vec2 pixel_coord_lower,const vec2 pattern_size,const float tile_units_to_pixels,const vec2 pos) {return get_pattern_pos(pixel_coord_upper,pixel_coord_lower,pattern_size,vec2(tile_units_to_pixels),pos);}float mercatorXfromLng(float lng) {return (180.0+lng)/360.0;}float mercatorYfromLat(float lat) {return (180.0-(RAD_TO_DEG*log(tan(PI/4.0+lat/2.0*DEG_TO_RAD))))/360.0;}vec3 latLngToECEF(vec2 latLng) {latLng=DEG_TO_RAD*latLng;float cosLat=cos(latLng[0]);float sinLat=sin(latLng[0]);float cosLng=cos(latLng[1]);float sinLng=sin(latLng[1]);float sx=cosLat*sinLng*GLOBE_RADIUS;float sy=-sinLat*GLOBE_RADIUS;float sz=cosLat*cosLng*GLOBE_RADIUS;return vec3(sx,sy,sz);}
#ifdef RENDER_CUTOFF
uniform vec4 u_cutoff_params;out float v_cutoff_opacity;
#endif
const vec4 AWAY=vec4(-1000.0,-1000.0,-1000.0,1);const float skirtOffset=24575.0;vec3 decomposeToPosAndSkirt(vec2 posWithComposedSkirt)
{float skirt=float(posWithComposedSkirt.x >=skirtOffset);vec2 pos=posWithComposedSkirt-vec2(skirt*skirtOffset,0.0);return vec3(pos,skirt);}`,pf="in highp vec3 a_pos_3f;uniform lowp mat4 u_matrix;out highp vec3 v_uv;void main() {const mat3 half_neg_pi_around_x=mat3(1.0,0.0, 0.0,0.0,0.0,-1.0,0.0,1.0, 0.0);v_uv=half_neg_pi_around_x*a_pos_3f;vec4 pos=u_matrix*vec4(a_pos_3f,1.0);gl_Position=pos.xyww;}",mf=`
#define ELEVATION_SCALE 7.0
#define ELEVATION_OFFSET 450.0
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_tl_up;uniform vec3 u_tile_tr_up;uniform vec3 u_tile_br_up;uniform vec3 u_tile_bl_up;uniform float u_tile_up_scale;vec3 elevationVector(vec2 pos) {vec2 uv=pos/EXTENT;vec3 up=normalize(mix(
mix(u_tile_tl_up,u_tile_tr_up,uv.xxx),mix(u_tile_bl_up,u_tile_br_up,uv.xxx),uv.yyy));return up*u_tile_up_scale;}
#else
vec3 elevationVector(vec2 pos) { return vec3(0,0,1); }
#endif
#ifdef TERRAIN
uniform highp sampler2D u_dem;uniform highp sampler2D u_dem_prev;uniform vec2 u_dem_tl;uniform vec2 u_dem_tl_prev;uniform float u_dem_scale;uniform float u_dem_scale_prev;uniform float u_dem_size;uniform float u_dem_lerp;uniform float u_exaggeration;uniform float u_meter_to_dem;uniform mat4 u_label_plane_matrix_inv;vec4 tileUvToDemSample(vec2 uv,float dem_size,float dem_scale,vec2 dem_tl) {vec2 pos=dem_size*(uv*dem_scale+dem_tl)+1.0;vec2 f=fract(pos);return vec4((pos-f+0.5)/(dem_size+2.0),f);}float currentElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale+u_dem_tl)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale,u_dem_tl);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(dd,0)).r;float bl=texture(u_dem,pos+vec2(0,dd)).r;float br=texture(u_dem,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}float prevElevation(vec2 apos) {
#ifdef TERRAIN_DEM_FLOAT_FORMAT
vec2 pos=(u_dem_size*(apos/8192.0*u_dem_scale_prev+u_dem_tl_prev)+1.5)/(u_dem_size+2.0);return u_exaggeration*texture(u_dem_prev,pos).r;
#else
float dd=1.0/(u_dem_size+2.0);vec4 r=tileUvToDemSample(apos/8192.0,u_dem_size,u_dem_scale_prev,u_dem_tl_prev);vec2 pos=r.xy;vec2 f=r.zw;float tl=texture(u_dem_prev,pos).r;float tr=texture(u_dem_prev,pos+vec2(dd,0)).r;float bl=texture(u_dem_prev,pos+vec2(0,dd)).r;float br=texture(u_dem_prev,pos+vec2(dd,dd)).r;return u_exaggeration*mix(mix(tl,tr,f.x),mix(bl,br,f.x),f.y);
#endif
}
#ifdef TERRAIN_VERTEX_MORPHING
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
float nextElevation=currentElevation(apos);float prevElevation=prevElevation(apos);return mix(prevElevation,nextElevation,u_dem_lerp);}
#else
float elevation(vec2 apos) {
#ifdef ZERO_EXAGGERATION
return 0.0;
#endif
return currentElevation(apos);}
#endif
vec4 fourSample(vec2 pos,vec2 off) {float tl=texture(u_dem,pos).r;float tr=texture(u_dem,pos+vec2(off.x,0.0)).r;float bl=texture(u_dem,pos+vec2(0.0,off.y)).r;float br=texture(u_dem,pos+off).r;return vec4(tl,tr,bl,br);}float flatElevation(vec2 pack) {vec2 apos=floor(pack/8.0);vec2 span=10.0*(pack-apos*8.0);vec2 uvTex=(apos-vec2(1.0,1.0))/8190.0;float size=u_dem_size+2.0;float dd=1.0/size;vec2 pos=u_dem_size*(uvTex*u_dem_scale+u_dem_tl)+1.0;vec2 f=fract(pos);pos=(pos-f+0.5)*dd;vec4 h=fourSample(pos,vec2(dd));float z=mix(mix(h.x,h.y,f.x),mix(h.z,h.w,f.x),f.y);vec2 w=floor(0.5*(span*u_meter_to_dem-1.0));vec2 d=dd*w;h=fourSample(pos-d,2.0*d+vec2(dd));vec4 diff=abs(h.xzxy-h.ywzw);vec2 slope=min(vec2(0.25),u_meter_to_dem*0.5*(diff.xz+diff.yw)/(2.0*w+vec2(1.0)));vec2 fix=slope*span;float base=z+max(fix.x,fix.y);return u_exaggeration*base;}float elevationFromUint16(float word) {return u_exaggeration*(word/ELEVATION_SCALE-ELEVATION_OFFSET);}
#else
float elevation(vec2 pos) { return 0.0; }
#endif
#ifdef DEPTH_OCCLUSION
uniform highp sampler2D u_depth;uniform highp vec2 u_depth_size_inv;uniform highp vec2 u_depth_range_unpack;uniform highp float u_occluder_half_size;uniform highp float u_occlusion_depth_offset;
#ifdef DEPTH_D24
float unpack_depth(float depth) {return depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}vec4 unpack_depth4(vec4 depth) {return depth*u_depth_range_unpack.x+vec4(u_depth_range_unpack.y);}
#else
highp float unpack_depth_rgba(vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded(vec4 frag) {vec3 coord=frag.xyz/frag.w;
#ifdef DEPTH_D24
float depth=unpack_depth(texture(u_depth,(coord.xy+1.0)*0.5).r);
#else
float depth=unpack_depth_rgba(texture(u_depth,(coord.xy+1.0)*0.5));
#endif
return coord.z+u_occlusion_depth_offset > depth;}highp vec4 getCornerDepths(vec2 coord) {highp vec3 df=vec3(u_occluder_half_size*u_depth_size_inv,0.0);highp vec2 uv=0.5*coord.xy+0.5;
#ifdef DEPTH_D24
highp vec4 depth=vec4(
texture(u_depth,uv-df.xz).r,texture(u_depth,uv+df.xz).r,texture(u_depth,uv-df.zy).r,texture(u_depth,uv+df.zy).r
);depth=unpack_depth4(depth);
#else
highp vec4 depth=vec4(
unpack_depth_rgba(texture(u_depth,uv-df.xz)),unpack_depth_rgba(texture(u_depth,uv+df.xz)),unpack_depth_rgba(texture(u_depth,uv-df.zy)),unpack_depth_rgba(texture(u_depth,uv+df.zy))
);
#endif
return depth;}highp float occlusionFadeMultiSample(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec2 uv=0.5*coord.xy+0.5;int NX=3;int NY=4;highp vec2 df=u_occluder_half_size*u_depth_size_inv;highp vec2 oneStep=2.0*u_occluder_half_size*u_depth_size_inv/vec2(NX-1,NY-1);highp float res=0.0;for (int y=0; y < NY;++y) {for (int x=0; x < NX;++x) {
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depth,uv-df+vec2(float(x)*oneStep.x,float(y)*oneStep.y)));
#endif
res+=1.0-clamp(300.0*(coord.z+u_occlusion_depth_offset-depth),0.0,1.0);}}res=clamp(2.0*res/float(NX*NY)-0.5,0.0,1.0);return res;}highp float occlusionFade(vec4 frag) {highp vec3 coord=frag.xyz/frag.w;highp vec4 depth=getCornerDepths(coord.xy);return dot(vec4(0.25),vec4(1.0)-clamp(300.0*(vec4(coord.z+u_occlusion_depth_offset)-depth),0.0,1.0));}
#else
bool isOccluded(vec4 frag) { return false; }highp float occlusionFade(vec4 frag) { return 1.0; }highp float occlusionFadeMultiSample(vec4 frag) { return 1.0; }
#endif//DEPTH_OCCLUSION`,j_=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump mat4 u_fog_matrix;out vec3 v_fog_pos;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}vec3 fog_position(vec3 pos) {return (u_fog_matrix*vec4(pos,1.0)).xyz;}vec3 fog_position(vec2 pos) {return fog_position(vec3(pos,0.0));}float fog(vec3 pos) {float depth=length(pos);float opacity=fog_opacity(fog_range(depth));return opacity*fog_horizon_blending(pos/depth);}
#endif`,gf=`#ifdef FOG
uniform mediump vec4 u_fog_color;uniform mediump vec2 u_fog_range;uniform mediump float u_fog_horizon_blend;uniform mediump vec2 u_fog_vertical_limit;uniform mediump float u_fog_temporal_offset;in vec3 v_fog_pos;uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform highp vec2 u_viewport;uniform float u_globe_transition;uniform int u_is_globe;float fog_range(float depth) {return (depth-u_fog_range[0])/(u_fog_range[1]-u_fog_range[0]);}float fog_horizon_blending(vec3 camera_dir) {float t=max(0.0,camera_dir.z/u_fog_horizon_blend);return u_fog_color.a*exp(-3.0*t*t);}float fog_opacity(float t) {const float decay=6.0;float falloff=1.0-min(1.0,exp(-decay*t));falloff*=falloff*falloff;return u_fog_color.a*min(1.0,1.00747*falloff);}float globe_glow_progress() {highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float sdf=length(closest_point-u_globe_pos)/u_globe_radius;return sdf+PI*0.5;}float fog_opacity(vec3 pos) {float depth=length(pos);return fog_opacity(fog_range(depth));}vec3 fog_apply(vec3 color,vec3 pos,float opacity_limit) {float depth=length(pos);float opacity;if (u_is_globe==1) {float glow_progress=globe_glow_progress();float t=mix(glow_progress,depth,u_globe_transition);opacity=fog_opacity(fog_range(t));} else {opacity=fog_opacity(fog_range(depth));opacity*=fog_horizon_blending(pos/depth);}return mix(color,u_fog_color.rgb,min(opacity,opacity_limit));}vec3 fog_apply(vec3 color,vec3 pos) {return fog_apply(color,pos,1.0);}vec4 fog_apply_from_vert(vec4 color,float fog_opac) {float alpha=EPSILON+color.a;color.rgb=mix(color.rgb/alpha,u_fog_color.rgb,fog_opac)*alpha;return color;}vec3 fog_apply_sky_gradient(vec3 camera_ray,vec3 sky_color) {float horizon_blend=fog_horizon_blending(normalize(camera_ray));return mix(sky_color,u_fog_color.rgb,horizon_blend);}vec4 fog_apply_premultiplied(vec4 color,vec3 pos) {float alpha=EPSILON+color.a;color.rgb=fog_apply(color.rgb/alpha,pos)*alpha;return color;}vec4 fog_apply_premultiplied(vec4 color,vec3 pos,float heightMeters) {float verticalProgress=(u_fog_vertical_limit.x > 0.0 || u_fog_vertical_limit.y > 0.0) ? smoothstep(u_fog_vertical_limit.x,u_fog_vertical_limit.y,heightMeters) : 0.0;float opacityLimit=1.0-smoothstep(0.9,1.0,fog_opacity(pos));return mix(fog_apply_premultiplied(color,pos),color,min(verticalProgress,opacityLimit));}vec3 fog_dither(vec3 color) {return color;}vec4 fog_dither(vec4 color) {return vec4(fog_dither(color.rgb),color.a);}
#endif`,hl=`#ifdef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;const vec4 NODATA=vec4(1);ivec4 _raTexLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}vec2 _raTexLinearMix(highp vec2 fxy,highp vec4 colorMix,highp float colorOffset,highp vec4 t00,highp vec4 t10,highp vec4 t01,highp vec4 t11) {vec2 c00=t00==NODATA ? vec2(0) : vec2(colorOffset+dot(t00,colorMix),1);vec2 c10=t10==NODATA ? vec2(0) : vec2(colorOffset+dot(t10,colorMix),1);vec2 c01=t01==NODATA ? vec2(0) : vec2(colorOffset+dot(t01,colorMix),1);vec2 c11=t11==NODATA ? vec2(0) : vec2(colorOffset+dot(t11,colorMix),1);return mix(mix(c01,c11,fxy.x),mix(c00,c10,fxy.x),fxy.y);}vec2 raTexture2D_image0_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image0,c.yz,0),texelFetch(u_image0,c.xz,0),texelFetch(u_image0,c.yw,0),texelFetch(u_image0,c.xw,0)
);}vec2 raTexture2D_image1_linear(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec2 fxy;ivec4 c=_raTexLinearCoord(texCoord,texResolution,fxy);return _raTexLinearMix(fxy,colorMix,colorOffset,texelFetch(u_image1,c.yz,0),texelFetch(u_image1,c.xz,0),texelFetch(u_image1,c.yw,0),texelFetch(u_image1,c.xw,0)
);}vec2 raTexture2D_image0_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image0,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}vec2 raTexture2D_image1_nearest(highp vec2 texCoord,highp vec2 texResolution,highp vec4 colorMix,highp float colorOffset) {vec4 t=texelFetch(u_image1,ivec2(texCoord*texResolution),0);return t==NODATA ? vec2(0) : vec2(colorOffset+dot(t,colorMix),1);}
#endif`,ng=`#ifdef RASTER_ARRAY
uniform sampler2D u_velocity;uniform mediump vec2 u_velocity_res;uniform mediump float u_max_speed;const vec4 NO_DATA=vec4(1);const vec2 INVALID_VELOCITY=vec2(-1);uniform highp vec2 u_uv_offset;uniform highp float u_data_offset;uniform highp vec2 u_data_scale;ivec4 rasterArrayLinearCoord(highp vec2 texCoord,highp vec2 texResolution,out highp vec2 fxy) {texCoord=texCoord*texResolution-0.5;fxy=fract(texCoord);texCoord-=fxy;return ivec4(texCoord.xxyy+vec2(1.5,0.5).xyxy);}highp vec2 lookup_velocity(highp vec2 uv) {uv=u_uv_offset.x+u_uv_offset.y*uv;highp vec2 fxy;ivec4 c=rasterArrayLinearCoord(uv,u_velocity_res,fxy);highp vec4 tl=texelFetch(u_velocity,c.yz,0);highp vec4 tr=texelFetch(u_velocity,c.xz,0);highp vec4 bl=texelFetch(u_velocity,c.yw,0);highp vec4 br=texelFetch(u_velocity,c.xw,0);if (tl==NO_DATA) {return INVALID_VELOCITY;}if (tr==NO_DATA) {return INVALID_VELOCITY;}if (bl==NO_DATA) {return INVALID_VELOCITY;}if (br==NO_DATA) {return INVALID_VELOCITY;}highp vec4 t=mix(mix(bl,br,fxy.x),mix(tl,tr,fxy.x),fxy.y);highp vec2 velocity=u_data_offset+vec2(dot(t.rg,u_data_scale),dot(t.ba,u_data_scale));velocity.y=-velocity.y;velocity/=max(u_max_speed,length(velocity));return velocity;}
#endif
uniform highp float u_particle_pos_scale;uniform highp vec2 u_particle_pos_offset;highp vec4 pack_pos_to_rgba(highp vec2 p) {highp vec2 v=(p+u_particle_pos_offset)/u_particle_pos_scale;highp vec4 r=vec4(v.x,fract(v.x*255.0),v.y,fract(v.y*255.0));return vec4(r.x-r.y/255.0,r.y,r.z-r.w/255.0,r.w);}highp vec2 unpack_pos_from_rgba(highp vec4 v) {v=floor(v*255.0+0.5)/255.0;highp vec2 p=vec2(v.x+(v.y/255.0),v.z+(v.w/255.0));return u_particle_pos_scale*p-u_particle_pos_offset;}`,sn=`#ifdef RENDER_SHADOWS
uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_normal_offset;vec3 shadow_normal_offset(vec3 normal) {float tileInMeters=u_shadow_normal_offset[0];vec3 n=vec3(-normal.xy,tileInMeters*normal.z);float dotScale=min(1.0-dot(normal,u_shadow_direction),1.0)*0.5+0.5;return n*dotScale;}vec3 shadow_normal_offset_model(vec3 normal) {vec3 transformed_normal=vec3(-normal.xy,normal.z);float NDotL=dot(normalize(transformed_normal),u_shadow_direction);float dotScale=min(1.0-NDotL,1.0)*0.5+0.5;return normal*dotScale;}float shadow_normal_offset_multiplier0() {return u_shadow_normal_offset[1];}float shadow_normal_offset_multiplier1() {return u_shadow_normal_offset[2];}
#endif//RENDER_SHADOWS`,ig=`#ifdef RENDER_SHADOWS
precision highp sampler2DShadow;uniform sampler2DShadow u_shadowmap_0;uniform sampler2DShadow u_shadowmap_1;uniform float u_shadow_intensity;uniform float u_shadow_map_resolution;uniform float u_shadow_texel_size;uniform highp vec3 u_shadow_normal_offset;uniform vec2 u_fade_range;uniform mediump vec3 u_shadow_direction;uniform highp vec3 u_shadow_bias;float shadow_sample(sampler2DShadow shadowmap,highp vec3 pos,highp float bias) {highp vec3 coord=vec3(pos.xy*0.5+0.5,pos.z*0.5+0.5-bias);return texture(shadowmap,coord);}float shadow_occlusion(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,highp float bias) {light_view_pos0.xyz/=light_view_pos0.w;
#ifdef SHADOWS_SINGLE_CASCADE
vec2 abs_bounds=abs(light_view_pos0.xy);if (abs_bounds.x >=1.0 || abs_bounds.y >=1.0) {return 0.0;}return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);
#else
light_view_pos1.xyz/=light_view_pos1.w;vec4 abs_bounds=abs(vec4(light_view_pos0.xy,light_view_pos1.xy));if (abs_bounds.x < 1.0 && abs_bounds.y < 1.0) {return shadow_sample(u_shadowmap_0,light_view_pos0.xyz,bias);}if (abs_bounds.z >=1.0 || abs_bounds.w >=1.0) {return 0.0;}float occlusion1=shadow_sample(u_shadowmap_1,light_view_pos1.xyz,bias);return clamp(mix(occlusion1,0.0,smoothstep(u_fade_range.x,u_fade_range.y,view_depth)),0.0,1.0);
#endif
}highp float calculate_shadow_bias(float NDotL) {
#ifdef NORMAL_OFFSET
return 0.5*u_shadow_bias.x;
#else
return 0.5*(u_shadow_bias.x+clamp(u_shadow_bias.y*tan(acos(NDotL)),0.0,u_shadow_bias.z));
#endif
}float shadowed_light_factor_normal(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_opacity(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth,float shadow_opacity) {float NDotL=dot(N,u_shadow_direction);float bias=calculate_shadow_bias(NDotL);float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias)*shadow_opacity;return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}float shadowed_light_factor_normal_unbiased(vec3 N,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float NDotL=dot(N,u_shadow_direction);float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return mix(0.0,(1.0-(u_shadow_intensity*occlusion))*NDotL,step(0.0,NDotL));}highp vec2 compute_receiver_plane_depth_bias(highp vec3 pos_dx,highp vec3 pos_dy)
{highp vec2 biasUV=vec2(
pos_dy.y*pos_dx.z-pos_dx.y*pos_dy.z,pos_dx.x*pos_dy.z-pos_dy.x*pos_dx.z);biasUV*=1.0/((pos_dx.x*pos_dy.y)-(pos_dx.y*pos_dy.x));return biasUV;}float shadowed_light_factor_plane_bias(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {highp vec3 light_view_pos0_xyz=light_view_pos0.xyz/light_view_pos0.w*0.5+0.5;highp vec3 light_view_pos0_ddx=dFdx(light_view_pos0_xyz);highp vec3 light_view_pos0_ddy=dFdy(light_view_pos0_xyz);highp vec2 plane_depth_bias=compute_receiver_plane_depth_bias(light_view_pos0_ddx,light_view_pos0_ddy);highp float bias=dot(vec2(u_shadow_texel_size,u_shadow_texel_size),plane_depth_bias)+0.0001;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadowed_light_factor(highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=0.0;float occlusion=shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);return 1.0-(u_shadow_intensity*occlusion);}float shadow_occlusion(float ndotl,highp vec4 light_view_pos0,highp vec4 light_view_pos1,float view_depth) {float bias=calculate_shadow_bias(ndotl);return shadow_occlusion(light_view_pos0,light_view_pos1,view_depth,bias);}
#endif`;const ed=[];Ta(eg,ed),Ta(Op,ed),Ta(tg,ed);const kl={"_prelude_fog.vertex.glsl":j_,"_prelude_terrain.vertex.glsl":mf,"_prelude_shadow.vertex.glsl":sn,"_prelude_fog.fragment.glsl":gf,"_prelude_shadow.fragment.glsl":ig,"_prelude_lighting.glsl":`
#ifdef LIGHTING_3D_MODE
uniform mediump vec3 u_lighting_ambient_color;uniform mediump vec3 u_lighting_directional_dir;uniform mediump vec3 u_lighting_directional_color;uniform mediump vec3 u_ground_radiance;float calculate_ambient_directional_factor(vec3 normal) {float NdotL=dot(normal,u_lighting_directional_dir);const float factor_reduction_max=0.3;float dir_luminance=dot(u_lighting_directional_color,vec3(0.2126,0.7152,0.0722));float directional_factor_min=1.0-factor_reduction_max*min(dir_luminance,1.0);float ambient_directional_factor=mix(directional_factor_min,1.0,min((NdotL+1.0),1.0));const float vertical_factor_min=0.92;float vertical_factor=mix(vertical_factor_min,1.0,normal.z*0.5+0.5);return vertical_factor*ambient_directional_factor;}vec3 linearProduct(vec3 srgbIn,vec3 k) {return srgbIn*pow(k,vec3(1./2.2));}vec3 apply_lighting(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return linearProduct(color,ambient_contrib+directional_contrib);}vec4 apply_lighting(vec4 color,vec3 normal,float dir_factor) {return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting(vec3 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return apply_lighting(color.rgb,normal,dir_factor);}vec4 apply_lighting(vec4 color,vec3 normal) {float dir_factor=max(dot(normal,u_lighting_directional_dir),0.0);return vec4(apply_lighting(color.rgb,normal,dir_factor),color.a);}vec3 apply_lighting_ground(vec3 color) {return color*u_ground_radiance;}vec4 apply_lighting_ground(vec4 color) {return vec4(apply_lighting_ground(color.rgb),color.a);}float calculate_NdotL(vec3 normal) {const float ext=0.70710678118;return (clamp(dot(normal,u_lighting_directional_dir),-ext,1.0)+ext)/(1.0+ext);}vec4 apply_lighting_with_emission_ground(vec4 color,float emissive_strength) {return mix(apply_lighting_ground(color),color,emissive_strength);}vec3 compute_flood_lighting(vec3 flood_light_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=flood_light_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);float occlusion_ramp=smoothstep(0.0,0.2,1.0-occlusion);return mix(fully_occluded_color,flood_light_color,occlusion_ramp);}vec3 compute_emissive_draped(vec3 unlit_color,float fully_occluded_factor,float occlusion,vec3 ground_shadow_factor) {vec3 fully_occluded_color=unlit_color*mix(ground_shadow_factor,vec3(1.0),fully_occluded_factor);return mix(fully_occluded_color,unlit_color,1.0-occlusion);}
#endif//LIGHTING_3D_MODE`,"_prelude_raster_array.glsl":hl,"_prelude_raster_particle.glsl":ng},oc={};yi("",mf),yi(gf,j_),yi(ig,sn),yi(hl,""),yi(ng,"");const dh=yi(tg,Op),Nl=eg;var td={background:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec4 u_color;uniform float u_opacity;
#ifdef LIGHTING_3D_MODE
in vec4 v_color;
#endif
void main() {vec4 out_color;
#ifdef LIGHTING_3D_MODE
out_color=v_color;
#else
out_color=u_color;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_lighting.glsl"
in vec2 a_pos;uniform mat4 u_matrix;
#ifdef LIGHTING_3D_MODE
uniform mediump vec4 u_color;out vec4 v_color;uniform float u_emissive_strength;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0,1);
#ifdef LIGHTING_3D_MODE
v_color=apply_lighting_with_emission_ground(u_color,u_emissive_strength);
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),backgroundPattern:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_pattern_tl;uniform vec2 u_pattern_br;uniform vec2 u_texsize;uniform float u_opacity;uniform float u_emissive_strength;uniform sampler2D u_image;in highp vec2 v_pos;void main() {highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(u_pattern_tl/u_texsize,u_pattern_br/u_texsize,imagecoord);vec4 out_color=textureLodCustom(u_image,pos,v_pos);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pattern_size;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform vec2 u_pattern_units_to_pixels;in vec2 a_pos;out highp vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,u_pattern_size,u_pattern_units_to_pixels,a_pos);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),building:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in highp vec3 v_normal;in highp float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
uniform lowp float u_opacity;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 apply_lighting_linear(vec3 color,vec3 normal,float dir_factor) {float ambient_directional_factor=calculate_ambient_directional_factor(normal);vec3 ambient_contrib=ambient_directional_factor*u_lighting_ambient_color;vec3 directional_contrib=u_lighting_directional_color*dir_factor;return color*(ambient_contrib+directional_contrib);}void main() {vec4 color=vec4(v_color.rgb,1.0);vec3 normal=normalize(v_normal);vec3 xy_flipped_normal=vec3(-normal.xy,normal.z);float shadowed_lighting_factor=0.0;
#ifdef RENDER_SHADOWS
shadowed_lighting_factor=shadowed_light_factor_normal(xy_flipped_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
shadowed_lighting_factor=dot(normal,u_lighting_directional_dir);
#endif
color.rgb=apply_lighting_linear(color.rgb,xy_flipped_normal,shadowed_lighting_factor);color.rgb=mix(color.rgb,v_color.rgb,v_color.a);
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,v_height));
#endif
color.rgb=linearTosRGB(color.rgb);color*=u_opacity;
#ifdef RENDER_CUTOFF
color*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_height);
#endif
glFragColor=color; 
#ifdef DEBUG_SHOW_NORMALS
color.rgb=xy_flipped_normal*0.5+vec3(0.5,0.5,0.5);color.a=1.0;glFragColor=color;
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;in vec3 a_normal_3f;out vec4 v_color;out highp vec3 v_normal;out highp float v_height;uniform mat4 u_matrix;uniform mat4 u_normal_matrix;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define-attribute-vertex-shader-only highp vec2 part_color_emissive
void main() {
#pragma mapbox: initialize-attribute-custom highp vec2 part_color_emissive
vec4 color_emissive=decode_color(part_color_emissive);v_color=vec4(sRGBToLinear(color_emissive.rgb),color_emissive.a);v_normal=vec3(u_normal_matrix*vec4(a_normal_3f,0.0));vec3 pos=a_pos_3f;v_height=pos.z;gl_Position=u_matrix*vec4(pos,1.0);
#ifdef RENDER_SHADOWS
vec3 shadow_pos=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset_model(v_normal);shadow_pos+=offset*shadow_normal_offset_multiplier0();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shadow_pos,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(shadow_pos,1.0);v_depth_shadows=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),buildingDepth:yi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,"in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;void main() {gl_Position=u_matrix*vec4(a_pos_3f,1.0);v_depth=gl_Position.z/gl_Position.w;}"),circle:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec3 v_data;in float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
uniform float u_emissive_strength;void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=v_data.xy;float blur_positive=blur < 0.0 ? 0.0 : 1.0;lowp float antialiasblur=v_data.z;float extrude_length=length(extrude)+antialiasblur*(1.0-blur_positive);float antialiased_blur=-max(abs(blur),antialiasblur);float antialiase_blur_opacity=smoothstep(0.0,antialiasblur,extrude_length-1.0);float opacity_t=blur_positive==1.0 ? 
smoothstep(0.0,-antialiased_blur,1.0-extrude_length) : 
smoothstep(antialiased_blur,0.0,extrude_length-1.0)-antialiase_blur_opacity;float color_t=stroke_width < 0.01 ? 0.0 : smoothstep(
antialiased_blur,0.0,extrude_length-radius/(radius+stroke_width)
);vec4 out_color=mix(color*opacity,stroke_color*stroke_opacity,color_t);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#endif
#ifdef FOG
out_color=fog_apply_premultiplied(out_color,v_fog_pos);
#endif
glFragColor=out_color*(v_visibility*opacity_t);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define NUM_VISIBILITY_RINGS 2
#define INV_SQRT2 0.70710678
#define ELEVATION_BIAS 0.0001
#define NUM_SAMPLES_PER_RING 16
uniform mat4 u_matrix;uniform mat2 u_extrude_scale;uniform lowp float u_device_pixel_ratio;uniform highp float u_camera_to_center_distance;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
#ifdef ELEVATED_ROADS
in float a_circle_z_offset;
#endif
out vec3 v_data;out float v_visibility;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump float radius
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp vec4 stroke_color
#pragma mapbox: define mediump float stroke_width
#pragma mapbox: define lowp float stroke_opacity
vec2 calc_offset(vec2 extrusion,float radius,float stroke_width, float view_scale) {return extrusion*(radius+stroke_width)*u_extrude_scale*view_scale;}float cantilevered_elevation(vec2 pos,float radius,float stroke_width,float view_scale) {vec2 c1=pos+calc_offset(vec2(-1,-1),radius,stroke_width,view_scale);vec2 c2=pos+calc_offset(vec2(1,-1),radius,stroke_width,view_scale);vec2 c3=pos+calc_offset(vec2(1,1),radius,stroke_width,view_scale);vec2 c4=pos+calc_offset(vec2(-1,1),radius,stroke_width,view_scale);float h1=elevation(c1)+ELEVATION_BIAS;float h2=elevation(c2)+ELEVATION_BIAS;float h3=elevation(c3)+ELEVATION_BIAS;float h4=elevation(c4)+ELEVATION_BIAS;return max(h4,max(h3,max(h1,h2)));}float circle_elevation(vec2 pos) {
#if defined(TERRAIN)
return elevation(pos)+ELEVATION_BIAS;
#else
return 0.0;
#endif
}vec4 project_vertex(vec2 extrusion,vec4 world_center,vec4 projected_center,float radius,float stroke_width, float view_scale,mat3 surface_vectors) {vec2 sample_offset=calc_offset(extrusion,radius,stroke_width,view_scale);
#ifdef PITCH_WITH_MAP
#ifdef PROJECTION_GLOBE_VIEW
return u_matrix*( world_center+vec4(sample_offset.x*surface_vectors[0]+sample_offset.y*surface_vectors[1],0) );
#else
return u_matrix*( world_center+vec4(sample_offset,0,0) );
#endif
#else
return projected_center+vec4(sample_offset,0,0);
#endif
}float get_sample_step() {
#ifdef PITCH_WITH_MAP
return 2.0*PI/float(NUM_SAMPLES_PER_RING);
#else
return PI/float(NUM_SAMPLES_PER_RING);
#endif
}void main(void) {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump float radius
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp vec4 stroke_color
#pragma mapbox: initialize mediump float stroke_width
#pragma mapbox: initialize lowp float stroke_opacity
vec2 extrude=vec2(mod(a_pos,2.0)*2.0-1.0);vec2 circle_center=floor(a_pos*0.5);vec4 world_center;mat3 surface_vectors;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(circle_center)*circle_elevation(circle_center);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*circle_elevation(circle_center);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,circle_center,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;vec3 pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);world_center=vec4(pos,1);
#else 
surface_vectors=mat3(1.0);float height=circle_elevation(circle_center);world_center=vec4(circle_center,height,1);
#endif
#ifdef ELEVATED_ROADS
world_center.z+=a_circle_z_offset+ELEVATION_BIAS;
#endif
vec4 projected_center=u_matrix*world_center;float view_scale=0.0;
#ifdef PITCH_WITH_MAP
#ifdef SCALE_WITH_MAP
view_scale=1.0;
#else
view_scale=projected_center.w/u_camera_to_center_distance;
#endif
#else
#ifdef SCALE_WITH_MAP
view_scale=u_camera_to_center_distance;
#else
view_scale=projected_center.w;
#endif
#endif
gl_Position=project_vertex(extrude,world_center,projected_center,radius,stroke_width,view_scale,surface_vectors);float visibility=0.0;
#ifdef TERRAIN
float step=get_sample_step();vec4 occlusion_world_center;vec4 occlusion_projected_center;
#ifdef PITCH_WITH_MAP
float cantilevered_height=cantilevered_elevation(circle_center,radius,stroke_width,view_scale);occlusion_world_center=vec4(circle_center,cantilevered_height,1);occlusion_projected_center=u_matrix*occlusion_world_center;
#else
occlusion_world_center=world_center;occlusion_projected_center=projected_center;
#endif
for(int ring=0; ring < NUM_VISIBILITY_RINGS; ring++) {float scale=(float(ring)+1.0)/float(NUM_VISIBILITY_RINGS);for(int i=0; i < NUM_SAMPLES_PER_RING; i++) {vec2 extrusion=vec2(cos(step*float(i)),-sin(step*float(i)))*scale;vec4 frag_pos=project_vertex(extrusion,occlusion_world_center,occlusion_projected_center,radius,stroke_width,view_scale,surface_vectors);visibility+=float(!isOccluded(frag_pos));}}visibility/=float(NUM_VISIBILITY_RINGS)*float(NUM_SAMPLES_PER_RING);
#else
visibility=1.0;
#endif
#ifdef PROJECTION_GLOBE_VIEW
visibility=1.0;
#endif
v_visibility=visibility;lowp float antialiasblur=1.0/u_device_pixel_ratio/(radius+stroke_width);v_data=vec3(extrude.x,extrude.y,antialiasblur);
#ifdef FOG
v_fog_pos=fog_position(world_center.xyz);
#endif
}`),clippingMask:yi("void main() {glFragColor=vec4(1.0);}","in vec2 a_pos;uniform mat4 u_matrix;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);}"),heatmap:yi(`#include "_prelude_fog.fragment.glsl"
uniform highp float u_intensity;in vec2 v_extrude;
#pragma mapbox: define highp float weight
#define GAUSS_COEF 0.3989422804014327
void main() {
#pragma mapbox: initialize highp float weight
float d=-0.5*3.0*3.0*dot(v_extrude,v_extrude);float val=weight*u_intensity*GAUSS_COEF*exp(d);glFragColor=vec4(val,1.0,1.0,1.0);
#ifdef FOG
if (u_is_globe==0) {glFragColor.r*=pow(1.0-fog_opacity(v_fog_pos),2.0);}
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform float u_extrude_scale;uniform float u_opacity;uniform float u_intensity;in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;
#endif
out vec2 v_extrude;
#pragma mapbox: define highp float weight
#pragma mapbox: define mediump float radius
const highp float ZERO=1.0/255.0/16.0;
#define GAUSS_COEF 0.3989422804014327
void main(void) {
#pragma mapbox: initialize highp float weight
#pragma mapbox: initialize mediump float radius
vec2 unscaled_extrude=vec2(mod(a_pos,2.0)*2.0-1.0);float S=sqrt(-2.0*log(ZERO/weight/u_intensity/GAUSS_COEF))/3.0;v_extrude=S*unscaled_extrude;vec2 extrude=v_extrude*radius*u_extrude_scale;vec2 tilePos=floor(a_pos*0.5);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 pos_normal_3=a_pos_normal_3/16384.0;mat3 surface_vectors=globe_mercator_surface_vectors(pos_normal_3,u_up_dir,u_zoom_transition);vec3 surface_extrusion=extrude.x*surface_vectors[0]+extrude.y*surface_vectors[1];vec3 globe_elevation=elevationVector(tilePos)*elevation(tilePos);vec3 globe_pos=a_pos_3+surface_extrusion+globe_elevation;vec3 mercator_elevation=u_up_dir*u_tile_up_scale*elevation(tilePos);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,tilePos,u_tile_id,u_merc_center)+surface_extrusion+mercator_elevation;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#else
pos=vec3(tilePos+extrude,elevation(tilePos));
#endif
gl_Position=u_matrix*vec4(pos,1);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),heatmapTexture:yi(`uniform sampler2D u_image;uniform sampler2D u_color_ramp;uniform float u_opacity;in vec2 v_pos;void main() {float t=texture(u_image,v_pos).r;vec4 color=texture(u_color_ramp,vec2(t,0.5));glFragColor=color*u_opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(0.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,"in vec2 a_pos;out vec2 v_pos;void main() {gl_Position=vec4(a_pos,0,1);v_pos=a_pos*0.5+0.5;}"),collisionBox:yi("in float v_placed;in float v_notUsed;void main() {vec4 red =vec4(1.0,0.0,0.0,1.0);vec4 blue=vec4(0.0,0.0,1.0,0.5);glFragColor =mix(red,blue,step(0.5,v_placed))*0.5;glFragColor*=mix(1.0,0.1,step(0.5,v_notUsed));}",`#include "_prelude_terrain.vertex.glsl"
in vec3 a_pos;in vec2 a_anchor_pos;in vec2 a_extrude;in vec2 a_placed;in vec2 a_shift;in vec2 a_elevation_from_sea;in float a_size_scale;in vec2 a_padding;in float a_auto_z_offset;uniform mat4 u_matrix;uniform vec2 u_extrude_scale;uniform float u_camera_to_center_distance;out float v_placed;out float v_notUsed;void main() {float feature_elevation=a_elevation_from_sea.x+a_auto_z_offset;float terrain_elevation=(a_elevation_from_sea.y==1.0 ? 0.0 : elevation(a_anchor_pos));vec4 projectedPoint=u_matrix*vec4(a_pos+elevationVector(a_anchor_pos)*(feature_elevation+terrain_elevation),1);highp float camera_to_anchor_distance=projectedPoint.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,1.5);gl_Position=projectedPoint;gl_Position.xy+=(a_extrude*a_size_scale+a_shift+a_padding)*u_extrude_scale*gl_Position.w*collision_perspective_ratio;v_placed=a_placed.x;v_notUsed=a_placed.y;}`),collisionCircle:yi("in float v_radius;in vec2 v_extrude;in float v_perspective_ratio;in float v_collision;void main() {float alpha=0.5*min(v_perspective_ratio,1.0);float stroke_radius=0.9*max(v_perspective_ratio,1.0);float distance_to_center=length(v_extrude);float distance_to_edge=abs(distance_to_center-v_radius);float opacity_t=smoothstep(-stroke_radius,0.0,-distance_to_edge);vec4 color=mix(vec4(0.0,0.0,1.0,0.5),vec4(1.0,0.0,0.0,1.0),v_collision);glFragColor=color*alpha*opacity_t;}",`in vec2 a_pos_2f;in float a_radius;in vec2 a_flags;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform vec2 u_viewport_size;uniform float u_camera_to_center_distance;out float v_radius;out vec2 v_extrude;out float v_perspective_ratio;out float v_collision;vec3 toTilePosition(vec2 screenPos) {vec4 rayStart=u_inv_matrix*vec4(screenPos,-1.0,1.0);vec4 rayEnd  =u_inv_matrix*vec4(screenPos, 1.0,1.0);rayStart.xyz/=rayStart.w;rayEnd.xyz  /=rayEnd.w;highp float t=(0.0-rayStart.z)/(rayEnd.z-rayStart.z);return mix(rayStart.xyz,rayEnd.xyz,t);}void main() {vec2 quadCenterPos=a_pos_2f;float radius=a_radius;float collision=a_flags.x;float vertexIdx=a_flags.y;vec2 quadVertexOffset=vec2(
mix(-1.0,1.0,float(vertexIdx >=2.0)),mix(-1.0,1.0,float(vertexIdx >=1.0 && vertexIdx <=2.0)));vec2 quadVertexExtent=quadVertexOffset*radius;vec3 tilePos=toTilePosition(quadCenterPos);vec4 clipPos=u_matrix*vec4(tilePos,1.0);highp float camera_to_anchor_distance=clipPos.w;highp float collision_perspective_ratio=clamp(
0.5+0.5*(u_camera_to_center_distance/camera_to_anchor_distance),0.0,4.0);float padding_factor=1.2;v_radius=radius;v_extrude=quadVertexExtent*padding_factor;v_perspective_ratio=collision_perspective_ratio;v_collision=collision;gl_Position=vec4(clipPos.xyz/clipPos.w,1.0)+vec4(quadVertexExtent*padding_factor/u_viewport_size*2.0,0.0,0.0);}`),debug:yi("uniform highp vec4 u_color;uniform sampler2D u_overlay;in vec2 v_uv;void main() {vec4 overlay_color=texture(u_overlay,v_uv);glFragColor=mix(u_color,overlay_color,overlay_color.a);}",`#include "_prelude_terrain.vertex.glsl"
in vec2 a_pos;
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;
#endif
out vec2 v_uv;uniform mat4 u_matrix;uniform float u_overlay_scale;void main() {float h=elevation(a_pos);v_uv=a_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
gl_Position=u_matrix*vec4(a_pos_3+elevationVector(a_pos)*h,1);
#else
gl_Position=u_matrix*vec4(a_pos*u_overlay_scale,h,1);
#endif
}`),elevatedStructuresDepth:yi(`void main() {
#ifndef DEPTH_TEXTURE
glFragColor=vec4(0.);
#endif
}`,"in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform float u_depth_bias;void main() {gl_Position=u_matrix*vec4(a_pos,a_height,1);gl_Position.z=gl_Position.z+u_depth_bias;}"),elevatedStructuresDepthReconstruct:yi(`#ifdef DEPTH_RECONSTRUCTION
in float v_height;
#endif
void main() {
#ifdef DEPTH_RECONSTRUCTION
if (v_height >=0.0)
discard;
#endif
glFragColor=vec4(1.0,0.0,0.0,1.0);}`,`in vec2 a_pos;in float a_height;uniform mat4 u_matrix;uniform vec3 u_camera_pos;uniform highp float u_depth_bias;uniform lowp float u_height_scale;uniform lowp float u_reset_depth;
#ifdef DEPTH_RECONSTRUCTION
out float v_height;
#endif
void main() {vec3 vpos=vec3(a_pos,a_height*u_height_scale);
#ifdef DEPTH_RECONSTRUCTION
if (u_camera_pos.z > vpos.z) {vpos-=(u_camera_pos-vpos)*(vpos.z/(u_camera_pos.z-vpos.z));}v_height=a_height;
#endif
gl_Position=u_matrix*vec4(vpos,1);gl_Position.z=u_reset_depth==1.0 ? gl_Position.w : gl_Position.z+u_depth_bias;}`),elevatedStructures:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in vec3 v_normal;in float v_height;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth;
#endif
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}vec3 compute_view_dependent_emissive_color(float ndotl,float emissive_strength,vec3 color)
{color=sRGBToLinear(color);color=color*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);color=linearTosRGB(color.rgb);return color;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
vec3 color=structure_color.xyz;
#ifdef LIGHTING_3D_MODE
vec3 normal=normalize(v_normal);vec3 transformed_normal=vec3(-normal.xy,normal.z);float ndotl=calculate_NdotL(transformed_normal);float emissive_strength=u_emissive_strength;emissive_strength=0.0;vec3 emissive_color=compute_view_dependent_emissive_color(ndotl,emissive_strength,color.xyz);
#ifdef RENDER_SHADOWS
float shadowed_lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth);color.rgb=apply_lighting(color.rgb,transformed_normal,shadowed_lighting_factor);
#else
color=apply_lighting(color,transformed_normal);
#endif
color=mix(color,emissive_color,emissive_strength);if (v_height < 0.0) {float penetration=max(v_height+7.5,0.0);float occlusion=1.0-1.0/PI*acos(1.0-penetration/4.0);color=color*(1.0-pow(occlusion,2.0)*0.3);}
#endif
#ifdef FOG
color=fog_apply(color,v_fog_pos);
#endif
vec4 out_color=vec4(color,1.0);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_height);
#endif
glFragColor=out_color;HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;in float a_height;in vec3 a_pos_normal_3;uniform mat4 u_matrix;out vec3 v_normal;out float v_height;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth;
#endif
#pragma mapbox: define highp vec4 structure_color
void main() {
#pragma mapbox: initialize highp vec4 structure_color
v_normal=a_pos_normal_3/16384.0;v_height=a_height;vec3 pos=vec3(a_pos,a_height);gl_Position=u_matrix*vec4(pos,1);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(-v_normal.xy,v_normal.z));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fill:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
vec4 out_color=color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=opacity;
#ifdef INDICATOR_CUTOUT
if (v_z_offset >=0.0) {out_color=applyCutout(out_color,v_z_offset);}
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=z_offset;
#endif
}`),fillOutline:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
float dist=length(v_pos-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=outline_color;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
uniform mat4 u_matrix;uniform vec2 u_world;out highp vec2 v_pos;
#pragma mapbox: define highp vec4 outline_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 outline_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize highp float z_offset
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillOutlinePattern:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
in highp vec2 v_pos;in highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);float dist=length(v_pos_world-gl_FragCoord.xy);float alpha=1.0-smoothstep(0.0,1.0,dist);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*(alpha*opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_world;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;out highp vec2 v_pos_world;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);v_pos_world=(gl_Position.xy/gl_Position.w+1.0)/2.0*u_world;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillPattern:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in highp vec2 v_pos;uniform float u_emissive_strength;
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
glFragColor=out_color*opacity;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_tile_units_to_pixels;in vec2 a_pos;
#ifdef ELEVATED_ROADS
in float a_road_z_offset;out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
out highp vec2 v_pos;
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp vec4 pattern
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define lowp float pixel_ratio
#pragma mapbox: define highp float z_offset
void main() {
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump vec4 pattern
#pragma mapbox: initialize lowp float pixel_ratio
#pragma mapbox: initialize highp float z_offset
#ifdef FILL_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;
#ifdef ELEVATED_ROADS
z_offset+=a_road_z_offset;v_road_z_offset=z_offset;
#endif
float hidden=float(opacity==0.0);gl_Position=mix(u_matrix*vec4(a_pos,z_offset,1),AWAY,hidden);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,a_pos);
#ifdef RENDER_SHADOWS
vec3 shd_pos0=vec3(a_pos,z_offset);vec3 shd_pos1=vec3(a_pos,z_offset);
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),fillExtrusion:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
in vec4 v_color;in vec4 v_flat;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;
#endif
uniform lowp float u_opacity;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec2 v_ao;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
in vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
in highp vec3 v_normal;
#endif
uniform vec3 u_flood_light_color;uniform highp float u_vertical_scale;uniform float u_flood_light_intensity;uniform vec3 u_ground_shadow_factor;
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
in float v_flood_radius;in float v_has_floodlight;
#endif
in float v_height;
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float emissive_strength
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
vec3 normal=normalize(v_normal);
#endif
float z;vec4 color=v_color;
#ifdef ZERO_ROOF_RADIUS
z=float(normal.z > 0.00001);
#ifdef LIGHTING_3D_MODE
normal=mix(normal,vec3(0.0,0.0,1.0),z);
#else
color=mix(v_color,v_roof_color,z);
#endif
#endif
float h=max(0.0,v_height);float ao_shade=1.0;
#ifdef FAUX_AO
float intensity=u_ao[0];float h_floors=h/(u_ao[1]*u_vertical_scale);float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);ao_shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;
#ifdef ZERO_ROOF_RADIUS
concave*=(1.0-z);
#endif
float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);ao_shade*=mix(1.0,x_shade*x_shade*x_shade,concave);
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
color.rgb*=mix(ao_shade,1.0,v_has_floodlight);
#else
color.rgb*=ao_shade;
#endif
#else
color.rgb*=ao_shade;
#endif
#endif
#ifdef LIGHTING_3D_MODE
float flood_radiance=0.0;
#ifdef FLOOD_LIGHT
flood_radiance=(1.0-min(h/v_flood_radius,1.0))*u_flood_light_intensity*v_has_floodlight;
#endif
#ifdef RENDER_SHADOWS
#ifdef FLOOD_LIGHT
float ndotl_unclamped=dot(normal,u_shadow_direction);float ndotl=max(0.0,ndotl_unclamped);float occlusion=ndotl_unclamped < 0.0 ? 1.0 : shadow_occlusion(ndotl,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 litColor=apply_lighting(color.rgb,normal,(1.0-u_shadow_intensity*occlusion)*ndotl);vec3 floodLitColor=compute_flood_lighting(u_flood_light_color*u_opacity,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=mix(litColor,floodLitColor,flood_radiance);
#else
float shadowed_lighting_factor;
#ifdef RENDER_CUTOFF
shadowed_lighting_factor=shadowed_light_factor_normal_opacity(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,v_cutoff_opacity);if (v_cutoff_opacity==0.0) {discard;}
#else
shadowed_lighting_factor=shadowed_light_factor_normal(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);
#endif
color.rgb=apply_lighting(color.rgb,normal,shadowed_lighting_factor);
#endif
#else
color.rgb=apply_lighting(color.rgb,normal);
#ifdef FLOOD_LIGHT
color.rgb=mix(color.rgb,u_flood_light_color*u_opacity,flood_radiance);
#endif
#endif
color.rgb=mix(color.rgb,v_flat.rgb,emissive_strength);color*=u_opacity;
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos,h));
#endif
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,h);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_edge_radius;uniform float u_width_scale;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
uniform highp float u_vertical_scale;out vec4 v_color;out vec4 v_flat;
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
out vec4 v_roof_color;
#endif
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
out highp vec3 v_normal;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec2 v_ao;
#endif
#if defined(LIGHTING_3D_MODE) && defined(FLOOD_LIGHT)
out float v_flood_radius;out float v_has_floodlight;
#endif
out float v_height;vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define highp float flood_light_wall_radius
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp float emissive_strength
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize highp float flood_light_wall_radius
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp float emissive_strength
base*=u_vertical_scale;height*=u_vertical_scale;vec4 pos_nx=floor(a_pos_normal_ed*0.5);vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));
#if defined(ZERO_ROOF_RADIUS) || defined(RENDER_SHADOWS) || defined(LIGHTING_3D_MODE)
v_normal=normal;
#endif
base=max(0.0,base);float attr_height=height;height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=0.0;float c_ele=0.0;vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
h=t > 0.0 ? height : base;pos=vec3(pos_nx.xy,h);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*h);vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,pos.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*pos.z;pos=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
float cutoff=1.0;vec3 scaled_pos=pos;
#ifdef RENDER_CUTOFF
vec3 centroid_random=vec3(centroid_pos.xy,centroid_pos.x+centroid_pos.y+1.0);vec3 ground_pos=centroid_pos.x==0.0 ? pos.xyz : (centroid_random/8.0);vec4 ground=u_matrix*vec4(ground_pos.xy,ele,1.0);cutoff=cutoff_opacity(u_cutoff_params,ground.z);if (centroid_pos.y !=0.0 && centroid_pos.x !=0.0) {vec3 g=floor(ground_pos);vec3 mod_=centroid_random-g*8.0;float seed=min(1.0,0.1*(min(3.5,max(mod_.x+mod_.y,0.2*attr_height))*0.35+mod_.z));if (cutoff < 0.8-seed) {cutoff=0.0;}}float cutoff_scale=cutoff;v_cutoff_opacity=cutoff;scaled_pos.z=mix(c_ele,h,cutoff_scale);
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (cutoff==0.0 && centroid_pos.x !=0.0) || (color.a==0.0));
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);scaled_pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;scaled_pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
gl_Position=mix(u_matrix*vec4(scaled_pos,1),AWAY,hidden);h=h-ele;v_height=h;
#ifdef RENDER_SHADOWS
vec3 shd_pos0=pos;vec3 shd_pos1=pos;
#ifdef NORMAL_OFFSET
vec3 offset=shadow_normal_offset(normal);shd_pos0+=offset*shadow_normal_offset_multiplier0();shd_pos1+=offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);
#endif
float NdotL=0.0;float colorvalue=0.0;
#ifndef LIGHTING_3D_MODE
colorvalue=color.r*0.2126+color.g*0.7152+color.b*0.0722;vec4 ambientlight=vec4(0.03,0.03,0.03,1.0);color+=ambientlight;NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),NdotL);if (normal.y !=0.0) {float r=0.84;r=mix(0.7,0.98,1.0-u_lightintensity);NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#endif
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec2(mix(concave,-concave,start),y_ground);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
#ifdef FLOOD_LIGHT
float is_wall=1.0-float(t > 0.0 && top_up_ny.y > 0.0);v_has_floodlight=float(flood_light_wall_radius > 0.0 && is_wall > 0.0);v_flood_radius=flood_light_wall_radius*u_vertical_scale;
#endif
v_color=vec4(color.rgb,1.0);float ndotl=calculate_NdotL(normal);v_flat.rgb=sRGBToLinear(color.rgb);v_flat.rgb=v_flat.rgb*(ndotl+(1.0-min(ndotl*57.29,1.0))*emissive_strength);v_flat=vec4(linearTosRGB(v_flat.rgb),1.0);
#else
v_color=vec4(0.0,0.0,0.0,1.0);v_color.rgb+=clamp(color.rgb*NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_color*=u_opacity;
#endif
#if defined(ZERO_ROOF_RADIUS) && !defined(LIGHTING_3D_MODE)
float roofNdotL=clamp(u_lightpos.z,0.0,1.0);roofNdotL=mix((1.0-u_lightintensity),max((1.0-colorvalue+u_lightintensity),1.0),roofNdotL);v_roof_color=vec4(0.0,0.0,0.0,1.0);v_roof_color.rgb+=clamp(color.rgb*roofNdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_roof_color*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
}`),fillExtrusionDepth:yi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_edge_radius;uniform float u_width_scale;uniform float u_vertical_scale;
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp float line_width
#pragma mapbox: define highp vec4 color
out highp float v_depth;void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp float line_width
#pragma mapbox: initialize highp vec4 color
base*=u_vertical_scale;height*=u_vertical_scale;vec3 pos_nx=floor(a_pos_normal_ed.xyz*0.5);mediump vec3 top_up_ny=a_pos_normal_ed.xyz-2.0*pos_nx;base=max(0.0,base);height=max(0.0,top_up_ny.y==0.0 && top_up_ny.x==1.0 ? height-u_edge_radius : height);float t=top_up_ny.x;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
vec3 pos;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;float ele=elevation(pos_nx.xy);float c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);float h=t > 0.0 ? max(h_base,h_height) : h_base;pos=vec3(pos_nx.xy,h);
#else
pos=vec3(pos_nx.xy,t > 0.0 ? height : base);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);pos.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;pos.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(pos,1),AWAY,hidden);v_depth=gl_Position.z/gl_Position.w;}`),fillExtrusionPattern:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform vec2 u_texsize;uniform sampler2D u_image;
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
#ifdef FAUX_AO
uniform lowp vec2 u_ao;in vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
in vec3 v_normal;
#endif
in highp vec2 v_pos;in vec4 v_lighting;uniform lowp float u_opacity;
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;highp vec2 imagecoord=mod(v_pos,1.0);highp vec2 pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,imagecoord);highp vec2 lod_pos=mix(pattern_tl/u_texsize,pattern_br/u_texsize,v_pos);vec4 out_color=textureLodCustom(u_image,pos,lod_pos);
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl/u_texsize,pattern_b_br/u_texsize,imagecoord);vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);out_color=out_color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting(out_color,normalize(v_normal))*u_opacity;
#else
out_color=out_color*v_lighting;
#endif
#ifdef FAUX_AO
float intensity=u_ao[0];float h=max(0.0,v_ao.z);float h_floors=h/u_ao[1];float y_shade=1.0-0.9*intensity*min(v_ao.y,1.0);float shade=(1.0-0.08*intensity)*(y_shade+(1.0-y_shade)*(1.0-pow(1.0-min(h_floors/16.0,1.0),16.0)))+0.08*intensity*min(h_floors/160.0,1.0);float concave=v_ao.x*v_ao.x;float x_shade=mix(1.0,mix(0.6,0.75,min(h_floors/30.0,1.0)),intensity)+0.1*intensity*min(h,1.0);shade*=mix(1.0,x_shade*x_shade*x_shade,concave);out_color.rgb=out_color.rgb*shade;
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,height);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#include "_prelude_lighting.glsl"
uniform mat4 u_matrix;uniform vec2 u_pixel_coord_upper;uniform vec2 u_pixel_coord_lower;uniform float u_height_factor;uniform float u_tile_units_to_pixels;uniform float u_vertical_gradient;uniform lowp float u_opacity;uniform float u_width_scale;uniform vec3 u_lightcolor;uniform lowp vec3 u_lightpos;uniform lowp float u_lightintensity;in vec4 a_pos_normal_ed;in vec2 a_centroid_pos;
#ifdef RENDER_WALL_MODE
in vec3 a_join_normal_inside;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_pos_3;in vec3 a_pos_normal_3;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_tile_id;uniform float u_zoom_transition;uniform vec3 u_up_dir;uniform float u_height_lift;
#endif
#ifdef TERRAIN
uniform int u_height_type;uniform int u_base_type;
#endif
out highp vec2 v_pos;out vec4 v_lighting;
#ifdef FAUX_AO
uniform lowp vec2 u_ao;out vec3 v_ao;
#endif
#ifdef LIGHTING_3D_MODE
out vec3 v_normal;
#endif
#pragma mapbox: define highp float base
#pragma mapbox: define highp float height
#pragma mapbox: define highp vec4 color
#pragma mapbox: define mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define highp float pixel_ratio
#pragma mapbox: define highp float line_width
void main() {
#pragma mapbox: initialize highp float base
#pragma mapbox: initialize highp float height
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize mediump vec4 pattern
#ifdef FILL_EXTRUSION_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize highp float pixel_ratio
#pragma mapbox: initialize highp float line_width
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec4 pos_nx=floor(a_pos_normal_ed*0.5);mediump vec4 top_up_ny_start=a_pos_normal_ed-2.0*pos_nx;mediump vec3 top_up_ny=top_up_ny_start.xyz;float x_normal=pos_nx.z/8192.0;vec3 normal=top_up_ny.y==1.0 ? vec3(0.0,0.0,1.0) : normalize(vec3(x_normal,(2.0*top_up_ny.z-1.0)*(1.0-abs(x_normal)),0.0));float edgedistance=a_pos_normal_ed.w;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;base=max(0.0,base);height=max(0.0,height);float t=top_up_ny.x;float z=t > 0.0 ? height : base;vec2 centroid_pos=vec2(0.0);
#if defined(HAS_CENTROID) || defined(TERRAIN)
centroid_pos=a_centroid_pos;
#endif
float ele=0.0;float h=z;vec3 p;float c_ele;
#ifdef TERRAIN
bool is_flat_height=centroid_pos.x !=0.0 && u_height_type==1;bool is_flat_base=centroid_pos.x !=0.0 && u_base_type==1;ele=elevation(pos_nx.xy);c_ele=is_flat_height || is_flat_base ? (centroid_pos.y==0.0 ? elevationFromUint16(centroid_pos.x) : flatElevation(centroid_pos)) : ele;float h_height=is_flat_height ? max(c_ele+height,ele+base+2.0) : ele+height;float h_base=is_flat_base ? max(c_ele+base,ele+base) : ele+(base==0.0 ?-5.0 : base);h=t > 0.0 ? max(h_base,h_height) : h_base;p=vec3(pos_nx.xy,h);
#else
p=vec3(pos_nx.xy,z);
#endif
#ifdef PROJECTION_GLOBE_VIEW
float lift=float((t+base) > 0.0)*u_height_lift;h+=lift;vec3 globe_normal=normalize(mix(a_pos_normal_3/16384.0,u_up_dir,u_zoom_transition));vec3 globe_pos=a_pos_3+globe_normal*(u_tile_up_scale*(p.z+lift));vec3 merc_pos=mercator_tile_position(u_inv_rot_matrix,p.xy,u_tile_id,u_merc_center)+u_up_dir*u_tile_up_scale*p.z;p=mix_globe_mercator(globe_pos,merc_pos,u_zoom_transition);
#endif
#ifdef RENDER_WALL_MODE
vec2 wall_offset=u_width_scale*line_width*(a_join_normal_inside.xy/EXTENT);p.xy+=(1.0-a_join_normal_inside.z)*wall_offset*0.5;p.xy-=a_join_normal_inside.z*wall_offset*0.5;
#endif
float hidden=float((centroid_pos.x==0.0 && centroid_pos.y==1.0) || (color.a==0.0));gl_Position=mix(u_matrix*vec4(p,1),AWAY,hidden);vec2 pos=normal.z==1.0
? pos_nx.xy
: vec2(edgedistance,z*u_height_factor);v_pos=get_pattern_pos(u_pixel_coord_upper,u_pixel_coord_lower,display_size,u_tile_units_to_pixels,pos);v_lighting=vec4(0.0,0.0,0.0,1.0);float NdotL=0.0;
#ifdef LIGHTING_3D_MODE
NdotL=calculate_NdotL(normal);
#else
NdotL=clamp(dot(normal,u_lightpos),0.0,1.0);NdotL=mix((1.0-u_lightintensity),max((0.5+u_lightintensity),1.0),NdotL);
#endif
if (normal.y !=0.0) {float r=0.84;
#ifndef LIGHTING_3D_MODE
r=mix(0.7,0.98,1.0-u_lightintensity);
#endif
NdotL*=(
(1.0-u_vertical_gradient)+(u_vertical_gradient*clamp((t+base)*pow(height/150.0,0.5),r,1.0)));}
#ifdef FAUX_AO
float concave=pos_nx.w-floor(pos_nx.w*0.5)*2.0;float start=top_up_ny_start.w;float y_ground=1.0-clamp(t+base,0.0,1.0);float top_height=height;
#ifdef TERRAIN
top_height=mix(max(c_ele+height,ele+base+2.0),ele+height,float(centroid_pos.x==0.0))-ele;y_ground+=y_ground*5.0/max(3.0,top_height);
#endif
v_ao=vec3(mix(concave,-concave,start),y_ground,h-ele);NdotL*=(1.0+0.05*(1.0-top_up_ny.y)*u_ao[0]);
#ifdef PROJECTION_GLOBE_VIEW
top_height+=u_height_lift;
#endif
gl_Position.z-=(0.0000006*(min(top_height,500.)+2.0*min(base,500.0)+60.0*concave+3.0*start))*gl_Position.w;
#endif
#ifdef LIGHTING_3D_MODE
v_normal=normal;
#else
v_lighting.rgb+=clamp(NdotL*u_lightcolor,mix(vec3(0.0),vec3(0.3),1.0-u_lightcolor),vec3(1.0));v_lighting*=u_opacity;
#endif
#ifdef FOG
v_fog_pos=fog_position(p);
#endif
}`),groundShadow:yi(`#include "_prelude_shadow.fragment.glsl"
precision highp float;uniform vec3 u_ground_shadow_factor;in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#ifdef FOG
in float v_fog_opacity;
#endif
void main() {float light=shadowed_light_factor_plane_bias(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);vec3 shadow=mix(u_ground_shadow_factor,vec3(1.0),light);
#ifdef RENDER_CUTOFF
shadow=mix(vec3(1.0),shadow,cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w));
#endif
#ifdef FOG
shadow=mix(shadow,vec3(1.0),v_fog_opacity);
#endif
#ifdef INDICATOR_CUTOUT
shadow=mix(shadow,vec3(1.0),1.0-applyCutout(vec4(1.0),0.0).r);
#endif
glFragColor=vec4(shadow,1.0);}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;in vec2 a_pos;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;
#ifdef FOG
out float v_fog_opacity;
#endif
void main() {gl_Position=u_matrix*vec4(a_pos,0.0,1.0);v_pos_light_view_0=u_light_matrix_0*vec4(a_pos,0.0,1.0);v_pos_light_view_1=u_light_matrix_1*vec4(a_pos,0.0,1.0);
#ifdef FOG
v_fog_pos=fog_position(a_pos);v_fog_opacity=fog(v_fog_pos);
#endif
}`),fillExtrusionGroundEffect:yi(`uniform highp float u_ao_pass;uniform highp float u_opacity;uniform highp float u_flood_light_intensity;uniform highp vec3 u_flood_light_color;uniform highp float u_attenuation;uniform sampler2D u_fb;uniform float u_fb_size;
#ifdef SDF_SUBPASS
in highp vec2 v_pos;in highp vec4 v_line_segment;in highp float v_flood_light_radius_tile;in highp vec2 v_ao;float line_df(highp vec2 a,highp vec2 b,highp vec2 p) {highp vec2 ba=b-a;highp vec2 pa=p-a;highp float r=clamp(dot(pa,ba)/dot(ba,ba),0.0,1.0);return length(pa-r*ba);}
#ifdef FOG
in highp float v_fog;
#endif
#endif
void main() {
#ifdef CLEAR_SUBPASS
vec4 color=vec4(1.0);
#ifdef CLEAR_FROM_TEXTURE
color=texture(u_fb,gl_FragCoord.xy/vec2(u_fb_size));
#endif
glFragColor=color;
#else
#ifdef SDF_SUBPASS
highp float d=line_df(v_line_segment.xy,v_line_segment.zw,v_pos);highp float effect_radius=mix(v_flood_light_radius_tile,v_ao.y,u_ao_pass);d/=effect_radius;d=min(d,1.0);d=1.0-pow(1.0-d,u_attenuation);highp float effect_intensity=mix(u_flood_light_intensity,v_ao.x,u_ao_pass);highp float fog=1.0;
#ifdef FOG
fog=v_fog;
#endif
#ifdef RENDER_CUTOFF
fog*=v_cutoff_opacity;
#endif
glFragColor=vec4(vec3(0.0),mix(1.0,d,effect_intensity*u_opacity*fog));
#else
vec4 color=mix(vec4(u_flood_light_color,1.0),vec4(vec3(0.0),1.0),u_ao_pass);
#ifdef OVERDRAW_INSPECTOR
color=vec4(1.0);
#endif
glFragColor=color;
#endif
HANDLE_WIREFRAME_DEBUG;
#endif
}`,`#include "_prelude_fog.vertex.glsl"
in highp vec4 a_pos_end;in highp float a_angular_offset_factor;in highp float a_hidden_by_landmark;
#ifdef SDF_SUBPASS
out highp vec2 v_pos;out highp vec4 v_line_segment;out highp float v_flood_light_radius_tile;out highp vec2 v_ao;
#ifdef FOG
out highp float v_fog;
#endif
#endif
uniform highp float u_flood_light_intensity;uniform highp mat4 u_matrix;uniform highp float u_ao_pass;uniform highp float u_meter_to_tile;uniform highp float u_edge_radius;uniform highp float u_dynamic_offset;uniform highp vec2 u_ao;
#pragma mapbox: define highp float flood_light_ground_radius
const float TANGENT_CUTOFF=4.0;const float NORM=32767.0;void main() {
#pragma mapbox: initialize highp float flood_light_ground_radius
vec2 p=a_pos_end.xy;vec2 q=floor(a_pos_end.zw*0.5);vec2 start_bottom=a_pos_end.zw-q*2.0;float fl_ground_radius=flood_light_ground_radius;fl_ground_radius=abs(flood_light_ground_radius);float direction=flood_light_ground_radius < 0.0 ?-1.0 : 1.0;float flood_radius_tile=fl_ground_radius*u_meter_to_tile;vec2 v=normalize(q-p);float ao_radius=u_ao.y/3.5;float effect_radius=mix(flood_radius_tile,ao_radius,u_ao_pass)+u_edge_radius;float angular_offset_factor=a_angular_offset_factor/NORM*TANGENT_CUTOFF;float angular_offset=direction*angular_offset_factor*effect_radius;float top=1.0-start_bottom.y;float side=(0.5-start_bottom.x)*2.0;vec2 extrusion_parallel=v*side*mix(u_dynamic_offset,angular_offset,top);vec2 perp=vec2(v.y,-v.x);vec2 extrusion_perp=direction*perp*effect_radius*top;vec3 pos=vec3(mix(q,p,start_bottom.x),0.0);pos.xy+=extrusion_parallel+extrusion_perp;
#ifdef SDF_SUBPASS
v_pos=pos.xy;v_line_segment=vec4(p,q)+perp.xyxy*u_edge_radius;v_flood_light_radius_tile=flood_radius_tile;v_ao=vec2(u_ao.x,ao_radius);
#ifdef FOG
v_fog_pos=fog_position(pos);v_fog=1.0-fog(v_fog_pos);
#endif
#endif
float hidden_by_landmark=0.0;
#ifdef HAS_CENTROID
hidden_by_landmark=a_hidden_by_landmark;
#endif
float isFloodlit=float(fl_ground_radius > 0.0 && u_flood_light_intensity > 0.0);float hidden=mix(1.0-isFloodlit,isFloodlit,u_ao_pass);hidden+=hidden_by_landmark;gl_Position=mix(u_matrix*vec4(pos,1.0),AWAY,float(hidden > 0.0));
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
}`),hillshadePrepare:yi(`precision highp float;uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_dimension;uniform float u_zoom;float getElevation(vec2 coord) {return texture(u_image,coord).r/4.0;}void main() {vec2 epsilon=1.0/u_dimension;float a=getElevation(v_pos+vec2(-epsilon.x,-epsilon.y));float b=getElevation(v_pos+vec2(0,-epsilon.y));float c=getElevation(v_pos+vec2(epsilon.x,-epsilon.y));float d=getElevation(v_pos+vec2(-epsilon.x,0));float e=getElevation(v_pos+vec2(epsilon.x,0));float f=getElevation(v_pos+vec2(-epsilon.x,epsilon.y));float g=getElevation(v_pos+vec2(0,epsilon.y));float h=getElevation(v_pos+vec2(epsilon.x,epsilon.y));float exaggerationFactor=u_zoom < 2.0 ? 0.4 : u_zoom < 4.5 ? 0.35 : 0.3;float exaggeration=u_zoom < 15.0 ? (u_zoom-15.0)*exaggerationFactor : 0.0;vec2 deriv=vec2(
(c+e+e+h)-(a+d+d+f),(f+g+g+h)-(a+b+b+c)
)/pow(2.0,exaggeration+(19.2562-u_zoom));glFragColor=clamp(vec4(
deriv.x/2.0+0.5,deriv.y/2.0+0.5,1.0,1.0),0.0,1.0);}`,"uniform mat4 u_matrix;uniform vec2 u_dimension;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);highp vec2 epsilon=1.0/u_dimension;float scale=(u_dimension.x-2.0)/u_dimension.x;v_pos=(a_texture_pos/8192.0)*scale+epsilon;}"),hillshade:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image;in vec2 v_pos;uniform vec2 u_latrange;uniform vec2 u_light;uniform vec4 u_shadow;uniform vec4 u_highlight;uniform vec4 u_accent;uniform float u_emissive_strength;void main() {vec4 pixel=texture(u_image,v_pos);vec2 deriv=((pixel.rg*2.0)-1.0);float scaleFactor=cos(radians((u_latrange[0]-u_latrange[1])*(1.0-v_pos.y)+u_latrange[1]));float slope=atan(1.25*length(deriv)/scaleFactor);float aspect=deriv.x !=0.0 ? atan(deriv.y,-deriv.x) : PI/2.0*(deriv.y > 0.0 ? 1.0 :-1.0);float intensity=u_light.x;float azimuth=u_light.y+PI;float base=1.875-intensity*1.75;float maxValue=0.5*PI;float scaledSlope=intensity !=0.5 ? ((pow(base,slope)-1.0)/(pow(base,maxValue)-1.0))*maxValue : slope;float accent=cos(scaledSlope);vec4 accent_color=(1.0-accent)*u_accent*clamp(intensity*2.0,0.0,1.0);float shade=abs(mod((aspect+azimuth)/PI+0.5,2.0)-1.0);vec4 shade_color=mix(u_shadow,u_highlight,shade)*sin(scaledSlope)*clamp(intensity*2.0,0.0,1.0);glFragColor=accent_color*(1.0-shade_color.a)+shade_color;
#ifdef LIGHTING_3D_MODE
glFragColor=apply_lighting_with_emission_ground(glFragColor,u_emissive_strength);
#endif
#ifdef FOG
glFragColor=fog_dither(fog_apply_premultiplied(glFragColor,v_fog_pos));
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos;void main() {gl_Position=u_matrix*vec4(a_pos,0,1);v_pos=a_texture_pos/8192.0;
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
}`),line:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform lowp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_floor_width_scale;uniform float u_alpha_discard_threshold;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;in vec2 v_width2;in vec2 v_normal;in float v_gamma_scale;in highp vec3 v_uv;
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform sampler2D u_dash_image;in vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform sampler2D u_gradient_image;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
float luminance(vec3 c) {return (c.r+c.r+c.b+c.g+c.g+c.g)*0.1667;}uniform float u_emissive_strength;
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
float linearstep(float edge0,float edge1,float x) {return  clamp((x-edge0)/(edge1-edge0),0.0,1.0);}void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);
#ifdef RENDER_LINE_DASH
float sdfdist=texture(u_dash_image,v_tex).r;float sdfgamma=1.0/(2.0*u_device_pixel_ratio)/dash.z;float scaled_floorwidth=(floorwidth*u_floor_width_scale);alpha*=linearstep(0.5-sdfgamma/scaled_floorwidth,0.5+sdfgamma/scaled_floorwidth,sdfdist);
#endif
highp vec4 out_color;
#ifdef RENDER_LINE_GRADIENT
out_color=texture(u_gradient_image,v_uv.xy);
#else
out_color=color;
#endif
float trim_alpha=1.0;
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);out_color=mix(out_color,u_trim_color,transition_factor);trim_alpha=1.0-transition_factor;}
#endif
if (u_alpha_discard_threshold !=0.0) {if (alpha < u_alpha_discard_threshold) {discard;}}
#ifdef RENDER_LINE_BORDER
float edgeBlur=((border_width*u_width_scale)+1.0/u_device_pixel_ratio);float alpha2=clamp(min(dist-(v_width2.t-edgeBlur),v_width2.s-dist)/edgeBlur,0.0,1.0);if (alpha2 < 1.) {float smoothAlpha=smoothstep(0.6,1.0,alpha2);if (border_color.a==0.0) {float Y=(out_color.a > 0.01) ? luminance(out_color.rgb/out_color.a) : 1.;float adjustment=(Y > 0.) ? 0.5/Y : 0.45;if (out_color.a > 0.25 && Y < 0.25) {vec3 borderColor=(Y > 0.) ? out_color.rgb : vec3(1,1,1)*out_color.a;out_color.rgb=out_color.rgb+borderColor*(adjustment*(1.0-smoothAlpha));} else {out_color.rgb*=(0.6 +0.4*smoothAlpha);}} else {out_color=mix(border_color*trim_alpha,out_color,smoothAlpha);}}
#endif
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
out_color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
out_color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
out_color=fog_dither(fog_apply_premultiplied(out_color,v_fog_pos));
#endif
out_color*=(alpha*opacity);
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define EXTRUDE_SCALE 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS) || defined(VARIABLE_LINE_WIDTH)
in vec3 a_z_offset_width;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
in highp vec3 a_packed;
#endif
#ifdef RENDER_LINE_DASH
in float a_linesofar;
#endif
uniform mat4 u_matrix;uniform mat2 u_pixels_to_tile_units;uniform vec2 u_units_to_pixels;uniform lowp float u_device_pixel_ratio;uniform float u_width_scale;uniform highp float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out float v_gamma_scale;out highp vec3 v_uv;
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_LINE_DASH
uniform vec2 u_texsize;uniform float u_tile_units_to_pixels;out vec2 v_tex;
#endif
#ifdef RENDER_LINE_GRADIENT
uniform float u_image_height;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define highp vec4 color
#pragma mapbox: define lowp float floorwidth
#pragma mapbox: define lowp vec4 dash
#pragma mapbox: define lowp float blur
#pragma mapbox: define lowp float opacity
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define lowp float offset
#pragma mapbox: define mediump float width
#pragma mapbox: define lowp float border_width
#pragma mapbox: define lowp vec4 border_color
void main() {
#pragma mapbox: initialize highp vec4 color
#pragma mapbox: initialize lowp float floorwidth
#pragma mapbox: initialize lowp vec4 dash
#pragma mapbox: initialize lowp float blur
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize lowp float offset
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize lowp float border_width
#pragma mapbox: initialize lowp vec4 border_color
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);mediump vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth;
#ifdef VARIABLE_LINE_WIDTH
float left=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);halfwidth=(u_width_scale*(left==1.0 ? a_z_offset_width.y : a_z_offset_width.z))/2.0;
#else
halfwidth=(u_width_scale*width)/2.0;
#endif
offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);mediump vec2 dist=outset*a_extrude*EXTRUDE_SCALE;mediump float u=0.5*a_direction;mediump float t=1.0-abs(u);mediump vec2 offset2=offset*a_extrude*EXTRUDE_SCALE*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float epsilon=0.0001;float extrude_length_without_perspective=max(length(dist),epsilon);float extrude_length_with_perspective=max(length(projected_extrude_xy/gl_Position.w*u_units_to_pixels),epsilon);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#if defined(RENDER_LINE_GRADIENT) || defined(RENDER_LINE_TRIM_OFFSET)
highp float a_uv_x=a_packed[0];float a_split_index=a_packed[1];highp float line_progress=a_packed[2];
#ifdef RENDER_LINE_GRADIENT
highp float texel_height=1.0/u_image_height;highp float half_texel_height=0.5*texel_height;v_uv=vec3(a_uv_x,a_split_index*texel_height-half_texel_height,line_progress);
#else
v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
#endif
#ifdef RENDER_LINE_DASH
float scale=dash.z==0.0 ? 0.0 : u_tile_units_to_pixels/dash.z;float height=dash.y;v_tex=vec2(a_linesofar*scale/(floorwidth*u_floor_width_scale),(-normal.y*height+dash.x+0.5)/u_texsize.y);
#endif
v_width2=vec2(outset,inset);
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),linePattern:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
uniform highp float u_device_pixel_ratio;uniform highp float u_width_scale;uniform highp float u_alpha_discard_threshold;uniform highp vec2 u_texsize;uniform highp float u_tile_units_to_pixels;uniform highp vec2 u_trim_offset;uniform highp vec2 u_trim_fade_range;uniform lowp vec4 u_trim_color;uniform sampler2D u_image;
#ifdef LINE_PATTERN_TRANSITION
uniform float u_pattern_transition;
#endif
in vec2 v_normal;in vec2 v_width2;in highp float v_linesofar;in float v_gamma_scale;in float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
in highp float v_road_z_offset;
#endif
#ifdef LINE_JOIN_NONE
in vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
uniform float u_emissive_strength;
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
void main() {
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
vec2 pattern_tl=pattern.xy;vec2 pattern_br=pattern.zw;vec2 display_size=(pattern_br-pattern_tl)/pixel_ratio;highp float pattern_size=display_size.x/u_tile_units_to_pixels;float aspect=display_size.y/v_width;float dist=length(v_normal)*v_width2.s;float blur2=(u_width_scale*blur+1.0/u_device_pixel_ratio)*v_gamma_scale;float alpha=clamp(min(dist-(v_width2.t-blur2),v_width2.s-dist)/blur2,0.0,1.0);highp float pattern_x=v_linesofar/pattern_size*aspect;highp float x=mod(pattern_x,1.0);highp float y=0.5*v_normal.y+0.5;vec2 texel_size=1.0/u_texsize;highp vec2 pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(x,y));highp vec2 lod_pos=mix(pattern_tl*texel_size-texel_size,pattern_br*texel_size+texel_size,vec2(pattern_x,y));vec4 color=textureLodCustom(u_image,pos,lod_pos);
#ifdef LINE_PATTERN_TRANSITION
vec2 pattern_b_tl=pattern_b.xy;vec2 pattern_b_br=pattern_b.zw;highp vec2 pos_b=mix(pattern_b_tl*texel_size-texel_size,pattern_b_br*texel_size+texel_size,vec2(x,y));vec4 color_b=textureLodCustom(u_image,pos_b,lod_pos);color=color*(1.0-u_pattern_transition)+color_b*u_pattern_transition;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float trim_start=u_trim_offset[0];highp float trim_end=u_trim_offset[1];highp float line_progress=v_uv[2];if (trim_end > trim_start) {highp float start_transition=max(0.0,min(1.0,(line_progress-trim_start)/max(u_trim_fade_range[0],1.0e-9)));highp float end_transition=max(0.0,min(1.0,(trim_end-line_progress)/max(u_trim_fade_range[1],1.0e-9)));highp float transition_factor=min(start_transition,end_transition);color=mix(color,color.a*u_trim_color,transition_factor);}
#endif
#ifdef LINE_JOIN_NONE
highp float pattern_len=pattern_size/aspect;highp float segment_phase=pattern_len-mod(v_linesofar-v_pattern_data.x+pattern_len,pattern_len);highp float visible_start=segment_phase-step(pattern_len*0.5,segment_phase)*pattern_len;highp float visible_end=floor((v_pattern_data.y-segment_phase)/pattern_len)*pattern_len+segment_phase;visible_end+=step(pattern_len*0.5,v_pattern_data.y-visible_end)*pattern_len;if (v_pattern_data.x < visible_start || v_pattern_data.x >=visible_end) {color=vec4(0.0);}
#endif
#ifdef LIGHTING_3D_MODE
color=apply_lighting_with_emission_ground(color,u_emissive_strength);
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);
#ifdef ELEVATED_ROADS
color.rgb*=mix(v_road_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#else
color.rgb*=mix(u_ground_shadow_factor,vec3(1.0),light);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=(alpha*opacity);if (u_alpha_discard_threshold !=0.0) {if (color.a < u_alpha_discard_threshold) {discard;}}
#ifdef INDICATOR_CUTOUT
color=applyCutout(color,v_z_offset);
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
#define scale 0.015873016
in vec2 a_pos_normal;in vec4 a_data;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
in vec3 a_z_offset_width;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
in highp vec3 a_packed;
#endif
in highp float a_linesofar;
#ifdef LINE_JOIN_NONE
in highp vec3 a_pattern_data;out vec2 v_pattern_data;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#endif
uniform mat4 u_matrix;uniform float u_tile_units_to_pixels;uniform vec2 u_units_to_pixels;uniform mat2 u_pixels_to_tile_units;uniform float u_device_pixel_ratio;uniform float u_width_scale;uniform float u_floor_width_scale;
#ifdef ELEVATED
uniform lowp float u_zbias_factor;uniform lowp float u_tile_to_meter;float sample_elevation(vec2 apos) {
#ifdef ELEVATION_REFERENCE_SEA
return 0.0;
#else
return elevation(apos);
#endif
}
#endif
out vec2 v_normal;out vec2 v_width2;out highp float v_linesofar;out float v_gamma_scale;out float v_width;
#ifdef RENDER_LINE_TRIM_OFFSET
out highp vec3 v_uv;
#endif
#ifdef ELEVATED_ROADS
out highp float v_road_z_offset;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#pragma mapbox: define mediump float blur
#pragma mapbox: define mediump float opacity
#pragma mapbox: define mediump float offset
#pragma mapbox: define mediump float gapwidth
#pragma mapbox: define mediump float width
#pragma mapbox: define mediump float floorwidth
#pragma mapbox: define mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: define mediump vec4 pattern_b
#endif
#pragma mapbox: define mediump float pixel_ratio
void main() {
#pragma mapbox: initialize mediump float blur
#pragma mapbox: initialize mediump float opacity
#pragma mapbox: initialize mediump float offset
#pragma mapbox: initialize mediump float gapwidth
#pragma mapbox: initialize mediump float width
#pragma mapbox: initialize mediump float floorwidth
#pragma mapbox: initialize mediump vec4 pattern
#ifdef LINE_PATTERN_TRANSITION
#pragma mapbox: initialize mediump vec4 pattern_b
#endif
#pragma mapbox: initialize mediump float pixel_ratio
float a_z_offset;
#if defined(ELEVATED) || defined(ELEVATED_ROADS)
a_z_offset=a_z_offset_width.x;
#endif
float ANTIALIASING=1.0/u_device_pixel_ratio/2.0;vec2 a_extrude=a_data.xy-128.0;float a_direction=mod(a_data.z,4.0)-1.0;vec2 pos=floor(a_pos_normal*0.5);vec2 normal=a_pos_normal-2.0*pos;normal.y=normal.y*2.0-1.0;v_normal=normal;gapwidth=gapwidth/2.0;float halfwidth=(u_width_scale*width)/2.0;offset=-1.0*offset*u_width_scale;float inset=gapwidth+(gapwidth > 0.0 ? ANTIALIASING : 0.0);float outset=gapwidth+halfwidth*(gapwidth > 0.0 ? 2.0 : 1.0)+(halfwidth==0.0 ? 0.0 : ANTIALIASING);vec2 dist=outset*a_extrude*scale;float u=0.5*a_direction;float t=1.0-abs(u);vec2 offset2=offset*a_extrude*scale*normal.y*mat2(t,-u,u,t);float hidden=float(opacity==0.0);vec2 extrude=dist*u_pixels_to_tile_units;vec4 projected_extrude=u_matrix*vec4(extrude,0.0,0.0);vec2 projected_extrude_xy=projected_extrude.xy;
#ifdef ELEVATED_ROADS
v_road_z_offset=a_z_offset;gl_Position=u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,a_z_offset,1.0)+projected_extrude;
#else
#ifdef ELEVATED
vec2 offsetTile=offset2*u_pixels_to_tile_units;vec2 offset_pos=pos+offsetTile;float ele=0.0;
#ifdef CROSS_SLOPE_VERTICAL
float top=a_pos_normal.y-2.0*floor(a_pos_normal.y*0.5);float line_height=2.0*u_tile_to_meter*outset*top*u_pixels_to_tile_units[1][1]+a_z_offset;ele=sample_elevation(offset_pos)+line_height;projected_extrude=vec4(0);
#else
#ifdef CROSS_SLOPE_HORIZONTAL
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,max(ele1,ele2));ele=ele_max+a_z_offset;
#else
float ele0=sample_elevation(offset_pos);float ele1=max(sample_elevation(offset_pos+extrude),sample_elevation(offset_pos+extrude/2.0));float ele2=max(sample_elevation(offset_pos-extrude),sample_elevation(offset_pos-extrude/2.0));float ele_max=max(ele0,0.5*(ele1+ele2));ele=ele_max-ele0+ele1+a_z_offset;
#endif
#endif
gl_Position=u_matrix*vec4(offset_pos,ele,1.0)+projected_extrude;float z=clamp(gl_Position.z/gl_Position.w,0.5,1.0);float zbias=max(0.00005,(pow(z,0.8)-z)*u_zbias_factor*u_exaggeration);gl_Position.z-=(gl_Position.w*zbias);gl_Position=mix(gl_Position,AWAY,hidden);
#else
gl_Position=mix(u_matrix*vec4(pos+offset2*u_pixels_to_tile_units,0.0,1.0)+projected_extrude,AWAY,hidden);
#endif
#endif
#ifdef ELEVATED_ROADS
#ifdef RENDER_SHADOWS
vec3 shd_pos=vec3(pos+(offset2+dist)*u_pixels_to_tile_units,a_z_offset);vec3 shd_pos0=shd_pos;vec3 shd_pos1=shd_pos;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifndef RENDER_TO_TEXTURE
float extrude_length_without_perspective=length(dist);float extrude_length_with_perspective=length(projected_extrude_xy/gl_Position.w*u_units_to_pixels);v_gamma_scale=mix(extrude_length_without_perspective/extrude_length_with_perspective,1.0,step(0.01,blur));
#else
v_gamma_scale=1.0;
#endif
#ifdef RENDER_LINE_TRIM_OFFSET
highp float a_uv_x=a_packed[0];highp float line_progress=a_packed[2];v_uv=vec3(a_uv_x,0.0,line_progress);
#endif
v_linesofar=a_linesofar;v_width2=vec2(outset,inset);v_width=(floorwidth*u_floor_width_scale);
#ifdef LINE_JOIN_NONE
v_width=(floorwidth*u_floor_width_scale)+ANTIALIASING;mediump float pixels_to_tile_units=1.0/u_tile_units_to_pixels;mediump float pixel_ratio_inverse=1.0/pixel_ratio;mediump float aspect=v_width/((pattern.w-pattern.y)*pixel_ratio_inverse);highp float subt_multiple=(pattern.z-pattern.x)*pixel_ratio_inverse*pixels_to_tile_units*aspect*32.0;highp float subt=floor(a_pattern_data.z/subt_multiple)*subt_multiple;float offset_sign=(fract(a_pattern_data.x)-0.5)*4.0;float line_progress_offset=offset_sign*v_width*0.5*pixels_to_tile_units;v_linesofar=(a_pattern_data.z-subt)+a_linesofar+line_progress_offset;v_pattern_data=vec2(a_pattern_data.x+line_progress_offset,a_pattern_data.y);
#endif
#ifdef FOG
v_fog_pos=fog_position(pos);
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=a_z_offset;
#endif
}`),raster:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
#include "_prelude_raster_array.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;uniform highp float u_zoom_transition;in vec2 v_pos0;in vec2 v_pos1;in float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
in float v_split_fade;
#endif
uniform float u_brightness_low;uniform float u_brightness_high;uniform float u_saturation_factor;uniform float u_contrast_factor;uniform vec3 u_spin_weights;uniform float u_emissive_strength;
#ifndef RASTER_ARRAY
uniform highp sampler2D u_image0;uniform sampler2D u_image1;
#endif
#ifdef RASTER_COLOR
uniform sampler2D u_color_ramp;uniform highp vec4 u_colorization_mix;uniform highp float u_colorization_offset;uniform vec2 u_texture_res;
#endif
void main() {vec4 color0,color1,color;vec2 value;
#ifdef RASTER_COLOR
#ifdef RASTER_ARRAY
#ifdef RASTER_ARRAY_LINEAR
value=mix(
raTexture2D_image0_linear(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_linear(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#else
value=mix(
raTexture2D_image0_nearest(v_pos0,u_texture_res,u_colorization_mix,u_colorization_offset),raTexture2D_image1_nearest(v_pos1,u_texture_res,u_colorization_mix,u_colorization_offset),u_fade_t
);
#endif
if (value.y > 0.0) value.x/=value.y;
#else
color=mix(texture(u_image0,v_pos0),texture(u_image1,v_pos1),u_fade_t);value=vec2(u_colorization_offset+dot(color.rgb,u_colorization_mix.rgb),color.a);
#endif
color=texture(u_color_ramp,vec2(value.x,0.5));if (color.a > 0.0) color.rgb/=color.a;color.a*=value.y;
#else
color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);
#endif
color.a*=u_opacity;
#ifdef GLOBE_POLES
color.a*=1.0-smoothstep(0.0,0.05,u_zoom_transition);
#endif
vec3 rgb=color.rgb;rgb=vec3(
dot(rgb,u_spin_weights.xyz),dot(rgb,u_spin_weights.zxy),dot(rgb,u_spin_weights.yzx));float average=(color.r+color.g+color.b)/3.0;rgb+=(average-rgb)*u_saturation_factor;rgb=(rgb-0.5)*u_contrast_factor+0.5;vec3 u_high_vec=vec3(u_brightness_low,u_brightness_low,u_brightness_low);vec3 u_low_vec=vec3(u_brightness_high,u_brightness_high,u_brightness_high);vec3 out_color=mix(u_high_vec,u_low_vec,rgb);
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),u_emissive_strength).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef PROJECTION_GLOBE_VIEW
glFragColor*=mix(1.0,1.0-smoothstep(0.0,0.05,u_zoom_transition),smoothstep(0.8,0.9,v_split_fade));
#endif
#ifdef RENDER_CUTOFF
glFragColor=glFragColor*cutoff_opacity(u_cutoff_params,v_depth);
#endif
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform vec2 u_perspective_transform;uniform vec2 u_texture_offset;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;in vec2 a_texture_pos;
#endif
out vec2 v_pos0;out vec2 v_pos1;out float v_depth;
#ifdef PROJECTION_GLOBE_VIEW
out float v_split_fade;
#endif
void main() {vec2 uv;
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;gl_Position=u_matrix*u_globe_matrix*vec4(globe_pos   ,1.0);uv=a_uv;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(a_globe_pos,1.0)).xyz);
#endif
#else
float w=1.0+dot(a_texture_pos,u_perspective_transform);uv=a_texture_pos/8192.0;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);    
v_split_fade=0.0;if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;float opposite_merc_center=mod(u_merc_center.x+0.5,1.0);float dist_from_poles=(abs(mercatorY-0.5)*2.0);float range=0.1;v_split_fade=abs(opposite_merc_center-mercatorX);v_split_fade=clamp(1.0-v_split_fade,0.0,1.0);v_split_fade=max(smoothstep(1.0-range,1.0,dist_from_poles),max(smoothstep(1.0-range,1.0,v_split_fade),smoothstep(1.0-range,1.0,1.0-v_split_fade)));}float tiles=u_grid_matrix[0][2];if (tiles > 0.0) {float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvY=mercatorY*tiles-idy;float uvX=mercatorX*tiles-idx;uv=vec2(uvX,uvY);}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;v_pos0=u_texture_offset.x+u_texture_offset.y*v_pos0;v_pos1=u_texture_offset.x+u_texture_offset.y*v_pos1;
#ifdef RENDER_CUTOFF
v_depth=gl_Position.z;
#endif
}`),rasterParticle:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_fade_t;uniform float u_opacity;uniform highp float u_raster_elevation;in vec2 v_pos0;in vec2 v_pos1;uniform sampler2D u_image0;uniform sampler2D u_image1;void main() {vec4 color0,color1,color;color0=texture(u_image0,v_pos0);color1=texture(u_image1,v_pos1);if (color0.a > 0.0) color0.rgb/=color0.a;if (color1.a > 0.0) color1.rgb/=color1.a;color=mix(color0,color1,u_fade_t);color.a*=u_opacity;vec3 out_color=color.rgb;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(vec4(out_color,1.0),0.0).rgb;
#endif
#ifdef FOG
highp float fog_limit_high_meters=1000000.0;highp float fog_limit_low_meters=600000.0;float fog_limit=1.0-smoothstep(fog_limit_low_meters,fog_limit_high_meters,u_raster_elevation);out_color=fog_dither(fog_apply(out_color,v_fog_pos,fog_limit));
#endif
glFragColor=vec4(out_color*color.a,color.a);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
uniform mat4 u_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform mat3 u_grid_matrix;uniform vec2 u_tl_parent;uniform float u_scale_parent;uniform float u_raster_elevation;uniform float u_zoom_transition;uniform vec2 u_merc_center;
#define GLOBE_UPSCALE GLOBE_RADIUS/6371008.8
in vec2 a_pos;in vec2 a_texture_pos;out vec2 v_pos0;out vec2 v_pos1;void main() {float w=1.0;vec2 uv;
#ifdef PROJECTION_GLOBE_VIEW
vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float mercatorX=mercatorXfromLng(latLng[1]);float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];float uvX=mercatorX*tiles-idx;float uvY=mercatorY*tiles-idy;uv=vec2(uvX,uvY);vec3 globe_pos=latLngToECEF(latLng.xy);globe_pos+=normalize(globe_pos)*u_raster_elevation*GLOBE_UPSCALE;vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {vec2 merc_pos=vec2(mercatorX,mercatorY);merc_world_pos=vec4(merc_pos,u_raster_elevation,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition)*w,w);gl_Position=u_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
#else
uv=a_texture_pos/8192.0;gl_Position=u_matrix*vec4(a_pos*w,u_raster_elevation*w,w);
#ifdef FOG
v_fog_pos=fog_position(a_pos);
#endif
#endif
v_pos0=uv;v_pos1=(v_pos0*u_scale_parent)+u_tl_parent;}`),rasterParticleDraw:yi("uniform sampler2D u_color_ramp;in float v_particle_speed;void main() {glFragColor=texture(u_color_ramp,vec2(v_particle_speed,0.5));}",`#include "_prelude_raster_particle.glsl"
in float a_index;uniform sampler2D u_particle_texture;uniform float u_particle_texture_side_len;uniform vec2 u_tile_offset;out float v_particle_speed;void main() {ivec2 pixel_coord=ivec2(
mod(a_index,u_particle_texture_side_len),a_index/u_particle_texture_side_len);vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);vec2 pos=unpack_pos_from_rgba(pixel)+u_tile_offset;vec2 tex_coord=fract(pos);vec2 velocity=lookup_velocity(tex_coord);if (velocity==INVALID_VELOCITY) {gl_Position=AWAY;v_particle_speed=0.0;} else {gl_Position=vec4(2.0*pos-1.0,0,1);v_particle_speed=length(velocity);}gl_PointSize=1.0;}`),rasterParticleTexture:yi("uniform sampler2D u_texture;uniform float u_opacity;in vec2 v_tex_pos;void main() {vec4 color=texture(u_texture,v_tex_pos);glFragColor=vec4(floor(255.0*color*u_opacity)/255.0);}","in vec2 a_pos;out vec2 v_tex_pos;void main() {vec2 uv=0.5*a_pos+vec2(0.5);v_tex_pos=uv;gl_Position=vec4(a_pos,0.0,1.0);}"),rasterParticleUpdate:yi(`#include "_prelude_raster_particle.glsl"
uniform sampler2D u_particle_texture;uniform mediump float u_particle_texture_side_len;uniform mediump float u_speed_factor;uniform highp float u_reset_rate;uniform highp float u_rand_seed;in highp vec2 v_tex_coord;vec2 linearstep(vec2 edge0,vec2 edge1,vec2 x) {return  clamp((x-edge0)/(edge1-edge0),vec2(0),vec2(1));}const highp vec3 rand_constants=vec3(12.9898,78.233,4375.85453);highp float rand(const highp vec2 co) {highp float t=dot(rand_constants.xy,co);return fract(sin(t)*(rand_constants.z+t));}void main() {ivec2 pixel_coord=ivec2(v_tex_coord*u_particle_texture_side_len);highp vec4 pixel=texelFetch(u_particle_texture,pixel_coord,0);highp vec2 pos=unpack_pos_from_rgba(pixel);highp vec2 velocity=lookup_velocity(clamp(pos,0.0,1.0));highp vec2 dp=velocity==INVALID_VELOCITY ? vec2(0) : velocity*u_speed_factor;pos=pos+dp;highp vec2 seed=(pos+v_tex_coord)*u_rand_seed;highp vec2 random_pos=vec2(rand(seed+1.3),rand(seed+2.1));highp vec2 persist_rate=pow(
linearstep(vec2(-u_particle_pos_offset),vec2(0),pos)*linearstep(vec2(1.0+u_particle_pos_offset),vec2(1),pos),vec2(4)
);highp vec2 per_frame_persist=pow(persist_rate,abs(dp)/u_particle_pos_offset);highp float drop_rate=1.0-per_frame_persist.x*per_frame_persist.y;drop_rate=any(greaterThanEqual(abs(pos-0.5),vec2(0.5+u_particle_pos_offset))) ? 1.0 : drop_rate;highp float drop=step(1.0-drop_rate-u_reset_rate,rand(seed));highp vec2 next_pos=mix(pos,random_pos,drop);glFragColor=pack_pos_to_rgba(next_pos);}`,"in vec2 a_pos;out vec2 v_tex_coord;void main() {v_tex_coord=0.5*(a_pos+vec2(1.0));gl_Position=vec4(a_pos,0.0,1.0);}"),symbol:yi(`#include "_prelude_lighting.glsl"
#include "_prelude_shadow.fragment.glsl"
#define SDF_PX 8.0
#define SDF 1.0
#define ICON 0.0
uniform sampler2D u_texture;uniform sampler2D u_texture_icon;uniform highp float u_gamma_scale;uniform lowp float u_device_pixel_ratio;uniform bool u_is_text;uniform bool u_is_halo;uniform lowp float u_scale_factor;
#ifdef ICON_TRANSITION
uniform float u_icon_transition;
#endif
#ifdef COLOR_ADJUSTMENT
uniform mat4 u_color_adj_mat;
#endif
#ifdef INDICATOR_CUTOUT
in highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
in highp float v_z_offset;
#endif
#endif
#endif
in vec2 v_tex_a;
#ifdef ICON_TRANSITION
in vec2 v_tex_b;
#endif
in float v_draw_halo;in vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
in float is_sdf;in vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform vec3 u_ground_shadow_factor;in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
vec4 out_color;float fade_opacity=v_gamma_scale_size_fade_opacity[2];
#ifdef RENDER_TEXT_AND_SYMBOL
if (is_sdf==ICON) {vec2 tex_icon=v_tex_a_icon;lowp float alpha=opacity*fade_opacity;glFragColor=texture(u_texture_icon,tex_icon)*alpha;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
return;}
#endif
#ifdef RENDER_SDF
float EDGE_GAMMA=0.105/u_device_pixel_ratio;float gamma_scale=v_gamma_scale_size_fade_opacity.x;float size=v_gamma_scale_size_fade_opacity.y;float fontScale=u_is_text ? size/24.0 : size;out_color=fill_color;highp float gamma=EDGE_GAMMA/(fontScale*u_gamma_scale);lowp float buff=(256.0-64.0)/256.0;bool draw_halo=v_draw_halo > 0.0;if (draw_halo) {out_color=halo_color;gamma=(halo_blur*u_scale_factor*1.19/SDF_PX+EDGE_GAMMA)/(fontScale*u_gamma_scale);buff=(6.0-halo_width*u_scale_factor/fontScale)/SDF_PX;}lowp float dist=texture(u_texture,v_tex_a).r;highp float gamma_scaled=gamma*gamma_scale;highp float alpha=smoothstep(buff-gamma_scaled,buff+gamma_scaled,dist);out_color*=alpha;
#else
#ifdef ICON_TRANSITION
vec4 a=texture(u_texture,v_tex_a)*(1.0-u_icon_transition);vec4 b=texture(u_texture,v_tex_b)*u_icon_transition;out_color=(a+b);
#else
out_color=texture(u_texture,v_tex_a);
#endif
#ifdef COLOR_ADJUSTMENT
out_color=u_color_adj_mat*out_color;
#endif
#endif
out_color*=opacity*fade_opacity;
#ifdef LIGHTING_3D_MODE
out_color=apply_lighting_with_emission_ground(out_color,emissive_strength);
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
float light=shadowed_light_factor(v_pos_light_view_0,v_pos_light_view_1,v_depth);out_color.rgb*=mix(v_z_offset !=0.0 ? u_ground_shadow_factor : vec3(1.0),vec3(1.0),light);
#endif
#endif
#endif
#ifdef INDICATOR_CUTOUT
out_color=applyCutout(out_color,v_z_offset);
#endif
glFragColor=out_color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_terrain.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec4 a_pos_offset;in vec4 a_tex_size;in vec4 a_pixeloffset;in vec4 a_projected_pos;in float a_fade_opacity;
#ifdef Z_OFFSET
in float a_auto_z_offset;
#endif
#ifdef PROJECTION_GLOBE_VIEW
in vec3 a_globe_anchor;in vec3 a_globe_normal;
#endif
#ifdef ICON_TRANSITION
in vec2 a_texb;
#endif
#ifdef OCCLUSION_QUERIES
in float a_occlusion_query_opacity;
#endif
#ifdef ELEVATED_ROADS
in vec3 a_x_axis;in vec3 a_y_axis;uniform float u_normal_scale;
#endif
#ifdef INDICATOR_CUTOUT
out highp float v_z_offset;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
out highp float v_z_offset;
#endif
#endif
#endif
uniform bool u_is_size_zoom_constant;uniform bool u_is_size_feature_constant;uniform highp float u_size_t;uniform highp float u_size;uniform mat4 u_matrix;uniform mat4 u_inv_matrix;uniform mat4 u_label_plane_matrix;uniform mat4 u_coord_matrix;uniform bool u_is_text;uniform bool u_elevation_from_sea;uniform bool u_pitch_with_map;uniform bool u_rotate_symbol;uniform highp float u_aspect_ratio;uniform highp float u_camera_to_center_distance;uniform float u_fade_change;uniform vec2 u_texsize;uniform vec3 u_up_vector;uniform vec2 u_texsize_icon;uniform bool u_is_halo;
#ifdef PROJECTION_GLOBE_VIEW
uniform vec3 u_tile_id;uniform mat4 u_inv_rot_matrix;uniform vec2 u_merc_center;uniform vec3 u_camera_forward;uniform float u_zoom_transition;uniform vec3 u_ecef_origin;uniform mat4 u_tile_matrix;
#endif
out vec2 v_tex_a;
#ifdef ICON_TRANSITION
out vec2 v_tex_b;
#endif
out float v_draw_halo;out vec3 v_gamma_scale_size_fade_opacity;
#ifdef RENDER_TEXT_AND_SYMBOL
out float is_sdf;out vec2 v_tex_a_icon;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out highp float v_depth;
#endif
#endif
#pragma mapbox: define highp vec4 fill_color
#pragma mapbox: define highp vec4 halo_color
#pragma mapbox: define lowp float opacity
#pragma mapbox: define lowp float halo_width
#pragma mapbox: define lowp float halo_blur
#pragma mapbox: define lowp float emissive_strength
#pragma mapbox: define lowp float occlusion_opacity
#pragma mapbox: define lowp float z_offset
void main() {
#pragma mapbox: initialize highp vec4 fill_color
#pragma mapbox: initialize highp vec4 halo_color
#pragma mapbox: initialize lowp float opacity
#pragma mapbox: initialize lowp float halo_width
#pragma mapbox: initialize lowp float halo_blur
#pragma mapbox: initialize lowp float emissive_strength
#pragma mapbox: initialize lowp float occlusion_opacity
#pragma mapbox: initialize lowp float z_offset
vec2 a_pos=a_pos_offset.xy;vec2 a_offset=a_pos_offset.zw;vec2 a_tex=a_tex_size.xy;vec2 a_size=a_tex_size.zw;float a_size_min=floor(a_size[0]*0.5);vec2 a_pxoffset=a_pixeloffset.xy;vec2 a_min_font_scale=a_pixeloffset.zw/256.0;highp float segment_angle=-a_projected_pos[3];float size;if (!u_is_size_zoom_constant && !u_is_size_feature_constant) {size=mix(a_size_min,a_size[1],u_size_t)/128.0;} else if (u_is_size_zoom_constant && !u_is_size_feature_constant) {size=a_size_min/128.0;} else {size=u_size;}vec2 tile_anchor=a_pos;float e=u_elevation_from_sea ? z_offset : z_offset+elevation(tile_anchor);
#ifdef Z_OFFSET
e+=a_auto_z_offset;
#endif
vec3 h=elevationVector(tile_anchor)*e;float globe_occlusion_fade;vec3 world_pos;vec3 mercator_pos;vec3 world_pos_globe;
#ifdef PROJECTION_GLOBE_VIEW
mercator_pos=mercator_tile_position(u_inv_rot_matrix,tile_anchor,u_tile_id,u_merc_center);world_pos_globe=a_globe_anchor+h;world_pos=mix_globe_mercator(world_pos_globe,mercator_pos,u_zoom_transition);vec4 ecef_point=u_tile_matrix*vec4(world_pos,1.0);vec3 origin_to_point=ecef_point.xyz-u_ecef_origin;globe_occlusion_fade=dot(origin_to_point,u_camera_forward) >=0.0 ? 0.0 : 1.0;
#else
world_pos=vec3(tile_anchor,0)+h;globe_occlusion_fade=1.0;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1);highp float camera_to_anchor_distance=projected_point.w;highp float distance_ratio=u_pitch_with_map ?
camera_to_anchor_distance/u_camera_to_center_distance :
u_camera_to_center_distance/camera_to_anchor_distance;highp float perspective_ratio=clamp(
0.5+0.5*distance_ratio,0.0,1.5);size*=perspective_ratio;float font_scale=u_is_text ? size/24.0 : size;highp float symbol_rotation=0.0;if (u_rotate_symbol) {vec4 offsetprojected_point;vec2 a;
#ifdef PROJECTION_GLOBE_VIEW
vec3 displacement=vec3(a_globe_normal.z,0,-a_globe_normal.x);offsetprojected_point=u_matrix*vec4(a_globe_anchor+displacement,1);vec4 projected_point_globe=u_matrix*vec4(world_pos_globe,1);a=projected_point_globe.xy/projected_point_globe.w;
#else
offsetprojected_point=u_matrix*vec4(tile_anchor+vec2(1,0),0,1);a=projected_point.xy/projected_point.w;
#endif
vec2 b=offsetprojected_point.xy/offsetprojected_point.w;symbol_rotation=atan((b.y-a.y)/u_aspect_ratio,b.x-a.x);}vec4 projected_pos;
#ifdef PROJECTION_GLOBE_VIEW
#ifdef PROJECTED_POS_ON_VIEWPORT
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xyz+h,1.0);
#else
vec3 proj_pos=mix_globe_mercator(a_projected_pos.xyz,mercator_pos,u_zoom_transition)+h;projected_pos=u_label_plane_matrix*vec4(proj_pos,1.0);    
#endif
#else
projected_pos=u_label_plane_matrix*vec4(a_projected_pos.xy,h.z,1.0);
#endif
highp float angle_sin=sin(segment_angle+symbol_rotation);highp float angle_cos=cos(segment_angle+symbol_rotation);mat2 rotation_matrix=mat2(angle_cos,-1.0*angle_sin,angle_sin,angle_cos);float z=0.0;vec2 offset=rotation_matrix*(a_offset/32.0*max(a_min_font_scale,font_scale)+a_pxoffset/16.0);
#ifdef TERRAIN
#ifdef PITCH_WITH_MAP_TERRAIN
vec4 tile_pos=u_label_plane_matrix_inv*vec4(a_projected_pos.xy+offset,0.0,1.0);z=elevation(tile_pos.xy);
#endif
#endif
#ifdef Z_OFFSET
z+=u_pitch_with_map ? a_auto_z_offset+z_offset : 0.0;
#else
z+=u_pitch_with_map ? z_offset : 0.0;
#endif
float occlusion_fade=globe_occlusion_fade;vec2 fade_opacity=unpack_opacity(a_fade_opacity);float fade_change=fade_opacity[1] > 0.5 ? u_fade_change :-u_fade_change;float out_fade_opacity=max(0.0,min(occlusion_fade,fade_opacity[0]+fade_change));
#ifdef DEPTH_OCCLUSION
float depth_occlusion=occlusionFadeMultiSample(projected_point);float depth_occlusion_multplier=mix(occlusion_opacity,1.0,depth_occlusion);out_fade_opacity*=depth_occlusion_multplier;
#endif
#ifdef OCCLUSION_QUERIES
float occludedFadeMultiplier=mix(occlusion_opacity,1.0,a_occlusion_query_opacity);out_fade_opacity*=occludedFadeMultiplier;
#endif
float alpha=opacity*out_fade_opacity;float hidden=float(alpha==0.0 || projected_point.w <=0.0 || occlusion_fade==0.0);vec3 pos;
#ifdef PROJECTION_GLOBE_VIEW
vec3 xAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,u_up_vector)) : vec3(1,0,0);vec3 yAxis=u_pitch_with_map ? normalize(cross(a_globe_normal,xAxis)) : vec3(0,1,0);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
#ifdef ELEVATED_ROADS
vec3 xAxis=vec3(a_x_axis.xy,a_x_axis.z*u_normal_scale);vec3 yAxis=vec3(a_y_axis.xy,a_y_axis.z*u_normal_scale);pos=projected_pos.xyz/projected_pos.w+xAxis*offset.x+yAxis*offset.y;
#else
pos=vec3(projected_pos.xy/projected_pos.w+offset,z);
#endif
#endif
gl_Position=mix(u_coord_matrix*vec4(pos,1.0),AWAY,hidden);float gamma_scale=gl_Position.w;v_draw_halo=(u_is_halo && float(gl_InstanceID)==0.0) ? 1.0 : 0.0;v_gamma_scale_size_fade_opacity=vec3(gamma_scale,size,out_fade_opacity);v_tex_a=a_tex/u_texsize;
#ifdef RENDER_TEXT_AND_SYMBOL
is_sdf=a_size[0]-2.0*a_size_min;v_tex_a_icon=a_tex/u_texsize_icon;
#endif
#ifdef ICON_TRANSITION
v_tex_b=a_texb/u_texsize;
#endif
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
vec4 shd_pos=u_inv_matrix*vec4(pos,1.0);vec3 shd_pos0=shd_pos.xyz;vec3 shd_pos1=shd_pos.xyz;
#ifdef NORMAL_OFFSET
vec3 shd_pos_offset=shadow_normal_offset(vec3(0.0,0.0,1.0));shd_pos0+=shd_pos_offset*shadow_normal_offset_multiplier0();shd_pos1+=shd_pos_offset*shadow_normal_offset_multiplier1();
#endif
v_pos_light_view_0=u_light_matrix_0*vec4(shd_pos0,1);v_pos_light_view_1=u_light_matrix_1*vec4(shd_pos1,1);v_depth=gl_Position.w;
#endif
#endif
#ifdef INDICATOR_CUTOUT
v_z_offset=e;
#else
#ifdef Z_OFFSET
#ifdef RENDER_SHADOWS
v_z_offset=e;
#endif
#endif
#endif
}`),terrainRaster:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;in vec2 v_pos0;
#ifdef FOG
in float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
in vec4 v_pos_light_view_0;in vec4 v_pos_light_view_1;
#endif
uniform vec3 u_ground_shadow_factor;void main() {vec4 image_color=texture(u_image0,v_pos0);vec4 color;
#ifdef LIGHTING_3D_MODE
const vec3 normal=vec3(0.0,0.0,1.0);
#ifdef RENDER_SHADOWS
float cutoffOpacity=1.0;
#ifdef RENDER_CUTOFF
cutoffOpacity=cutoff_opacity(u_cutoff_params,1.0/gl_FragCoord.w);
#endif
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
vec3 unlit_base=image_color.rgb*(1.0-image_color.a);vec3 emissive_base=image_color.rgb*image_color.a;float ndotl=u_shadow_direction.z;float occlusion=ndotl < 0.0 ? 1.0 : shadow_occlusion(v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w,0.0);ndotl=max(0.0,ndotl);vec3 lit=apply_lighting(unlit_base,normal,mix(1.0,(1.0-(u_shadow_intensity*occlusion))*ndotl,cutoffOpacity));vec3 emissive=compute_emissive_draped(emissive_base,1.0-u_shadow_intensity,occlusion,u_ground_shadow_factor);color.rgb=lit+emissive;color.a=1.0;
#else
float lighting_factor=shadowed_light_factor_normal_unbiased(normal,v_pos_light_view_0,v_pos_light_view_1,1.0/gl_FragCoord.w);color=apply_lighting(image_color,normal,mix(1.0,lighting_factor,cutoffOpacity));
#endif
#else
float lighting_factor=u_lighting_directional_dir.z;color=apply_lighting(image_color,normal,lighting_factor);
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color.rgb=mix(color.rgb,image_color.rgb,image_color.a);color.a=1.0;
#endif
#endif
#else
color=image_color;
#endif
#ifdef FOG
#ifdef ZERO_EXAGGERATION
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#else
color=fog_dither(fog_apply_from_vert(color,v_fog_opacity));
#endif
#endif
glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;uniform float u_skirt_height;in vec2 a_pos;out vec2 v_pos0;
#ifdef FOG
out float v_fog_opacity;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out vec4 v_pos_light_view_0;out vec4 v_pos_light_view_1;out float v_depth;
#endif
void main() {vec3 decomposedPosAndSkirt=decomposeToPosAndSkirt(a_pos);float skirt=decomposedPosAndSkirt.z;vec2 decodedPos=decomposedPosAndSkirt.xy;float elevation=elevation(decodedPos)-skirt*u_skirt_height;v_pos0=decodedPos/8192.0;gl_Position=u_matrix*vec4(decodedPos,elevation,1.0);
#ifdef FOG
#ifdef ZERO_EXAGGERATION
v_fog_pos=fog_position(decodedPos);
#else
v_fog_opacity=fog(fog_position(vec3(decodedPos,elevation)));
#endif
#endif
#ifdef RENDER_SHADOWS
vec3 pos=vec3(decodedPos,elevation);v_pos_light_view_0=u_light_matrix_0*vec4(pos,1.);v_pos_light_view_1=u_light_matrix_1*vec4(pos,1.);
#endif
}`),terrainDepth:yi("precision highp float;in float v_depth;void main() {glFragColor=pack_depth(v_depth);}",`#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_matrix;in vec2 a_pos;out float v_depth;void main() {float elevation=elevation(a_pos);gl_Position=u_matrix*vec4(a_pos,elevation,1.0);v_depth=gl_Position.z/gl_Position.w;}`),skybox:yi(`#include "_prelude_fog.fragment.glsl"
in lowp vec3 v_uv;uniform lowp samplerCube u_cubemap;uniform lowp float u_opacity;uniform highp float u_temporal_offset;uniform highp vec3 u_sun_direction;float sun_disk(highp vec3 ray_direction,highp vec3 sun_direction) {highp float cos_angle=dot(normalize(ray_direction),sun_direction);const highp float cos_sun_angular_diameter=0.99996192306;const highp float smoothstep_delta=1e-5;return smoothstep(
cos_sun_angular_diameter-smoothstep_delta,cos_sun_angular_diameter+smoothstep_delta,cos_angle);}float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec3 uv=v_uv;const float y_bias=0.015;uv.y+=y_bias;uv.y=pow(abs(uv.y),1.0/5.0);uv.y=map(uv.y,0.0,1.0,-1.0,1.0);vec3 sky_color=texture(u_cubemap,uv).rgb;
#ifdef FOG
sky_color=fog_apply_sky_gradient(v_uv.xzy,sky_color);
#endif
sky_color+=0.1*sun_disk(v_uv,u_sun_direction);glFragColor=vec4(sky_color*u_opacity,u_opacity);
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,pf),skyboxGradient:yi(`#include "_prelude_fog.fragment.glsl"
in highp vec3 v_uv;uniform lowp sampler2D u_color_ramp;uniform highp vec3 u_center_direction;uniform lowp float u_radius;uniform lowp float u_opacity;uniform highp float u_temporal_offset;void main() {float progress=acos(dot(normalize(v_uv),u_center_direction))/u_radius;vec4 color=texture(u_color_ramp,vec2(progress,0.5));
#ifdef FOG
color.rgb=fog_apply_sky_gradient(v_uv.xzy,color.rgb/color.a)*color.a;
#endif
color*=u_opacity;glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
}`,pf),skyboxCapture:yi(`
in highp vec3 v_position;uniform highp float u_sun_intensity;uniform highp float u_luminance;uniform lowp vec3 u_sun_direction;uniform highp vec4 u_color_tint_r;uniform highp vec4 u_color_tint_m;precision highp float;
#define BETA_R                  vec3(5.5e-6,13.0e-6,22.4e-6)
#define BETA_M                  vec3(21e-6,21e-6,21e-6)
#define MIE_G                   0.76
#define DENSITY_HEIGHT_SCALE_R  8000.0
#define DENSITY_HEIGHT_SCALE_M  1200.0
#define PLANET_RADIUS           6360e3
#define ATMOSPHERE_RADIUS       6420e3
#define SAMPLE_STEPS            10
#define DENSITY_STEPS           4
float ray_sphere_exit(vec3 orig,vec3 dir,float radius) {float a=dot(dir,dir);float b=2.0*dot(dir,orig);float c=dot(orig,orig)-radius*radius;float d=sqrt(b*b-4.0*a*c);return (-b+d)/(2.0*a);}vec3 extinction(vec2 density) {return exp(-vec3(BETA_R*u_color_tint_r.a*density.x+BETA_M*u_color_tint_m.a*density.y));}vec2 local_density(vec3 point) {float height=max(length(point)-PLANET_RADIUS,0.0);float exp_r=exp(-height/DENSITY_HEIGHT_SCALE_R);float exp_m=exp(-height/DENSITY_HEIGHT_SCALE_M);return vec2(exp_r,exp_m);}float phase_ray(float cos_angle) {return (3.0/(16.0*PI))*(1.0+cos_angle*cos_angle);}float phase_mie(float cos_angle) {return (3.0/(8.0*PI))*((1.0-MIE_G*MIE_G)*(1.0+cos_angle*cos_angle))/((2.0+MIE_G*MIE_G)*pow(1.0+MIE_G*MIE_G-2.0*MIE_G*cos_angle,1.5));}vec2 density_to_atmosphere(vec3 point,vec3 light_dir) {float ray_len=ray_sphere_exit(point,light_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(DENSITY_STEPS);vec2 density_point_to_atmosphere=vec2(0.0);for (int i=0; i < DENSITY_STEPS;++i) {vec3 point_on_ray=point+light_dir*((float(i)+0.5)*step_len);density_point_to_atmosphere+=local_density(point_on_ray)*step_len;;}return density_point_to_atmosphere;}vec3 atmosphere(vec3 ray_dir,vec3 sun_direction,float sun_intensity) {vec2 density_orig_to_point=vec2(0.0);vec3 scatter_r=vec3(0.0);vec3 scatter_m=vec3(0.0);vec3 origin=vec3(0.0,PLANET_RADIUS,0.0);float ray_len=ray_sphere_exit(origin,ray_dir,ATMOSPHERE_RADIUS);float step_len=ray_len/float(SAMPLE_STEPS);for (int i=0; i < SAMPLE_STEPS;++i) {vec3 point_on_ray=origin+ray_dir*((float(i)+0.5)*step_len);vec2 density=local_density(point_on_ray)*step_len;density_orig_to_point+=density;vec2 density_point_to_atmosphere=density_to_atmosphere(point_on_ray,sun_direction);vec2 density_orig_to_atmosphere=density_orig_to_point+density_point_to_atmosphere;vec3 extinction=extinction(density_orig_to_atmosphere);scatter_r+=density.x*extinction;scatter_m+=density.y*extinction;}float cos_angle=dot(ray_dir,sun_direction);float phase_r=phase_ray(cos_angle);float phase_m=phase_mie(cos_angle);vec3 beta_r=BETA_R*u_color_tint_r.rgb*u_color_tint_r.a;vec3 beta_m=BETA_M*u_color_tint_m.rgb*u_color_tint_m.a;return (scatter_r*phase_r*beta_r+scatter_m*phase_m*beta_m)*sun_intensity;}const float A=0.15;const float B=0.50;const float C=0.10;const float D=0.20;const float E=0.02;const float F=0.30;vec3 uncharted2_tonemap(vec3 x) {return ((x*(A*x+C*B)+D*E)/(x*(A*x+B)+D*F))-E/F;}void main() {vec3 ray_direction=v_position;ray_direction.y=pow(ray_direction.y,5.0);const float y_bias=0.015;ray_direction.y+=y_bias;vec3 color=atmosphere(normalize(ray_direction),u_sun_direction,u_sun_intensity);float white_scale=1.0748724675633854;color=uncharted2_tonemap((log2(2.0/pow(u_luminance,4.0)))*color)*white_scale;glFragColor=vec4(color,1.0);}`,"in highp vec3 a_pos_3f;uniform mat3 u_matrix_3f;out highp vec3 v_position;float map(float value,float start,float end,float new_start,float new_end) {return ((value-start)*(new_end-new_start))/(end-start)+new_start;}void main() {vec4 pos=vec4(u_matrix_3f*a_pos_3f,1.0);v_position=pos.xyz;v_position.y*=-1.0;v_position.y=map(v_position.y,-1.0,1.0,0.0,1.0);gl_Position=vec4(a_pos_3f.xy,0.0,1.0);}"),globeRaster:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform sampler2D u_image0;uniform float u_far_z_cutoff;in vec2 v_pos0;
#ifndef FOG
uniform highp vec3 u_frustum_tl;uniform highp vec3 u_frustum_tr;uniform highp vec3 u_frustum_br;uniform highp vec3 u_frustum_bl;uniform highp vec3 u_globe_pos;uniform highp float u_globe_radius;uniform vec2 u_viewport;
#endif
void main() {vec4 color;
#ifdef CUSTOM_ANTIALIASING
highp vec2 uv=gl_FragCoord.xy/u_viewport;highp vec3 ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,uv.x),mix(u_frustum_bl,u_frustum_br,uv.x),1.0-uv.y);highp vec3 dir=normalize(ray_dir);highp vec3 closest_point=dot(u_globe_pos,dir)*dir;highp float norm_dist_from_center=1.0-length(closest_point-u_globe_pos)/u_globe_radius;const float antialias_pixel=2.0;highp float antialias_factor=antialias_pixel*fwidth(norm_dist_from_center);highp float antialias=smoothstep(0.0,antialias_factor,norm_dist_from_center);vec4 raster=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
raster=apply_lighting_with_emission_ground(raster,raster.a);color=vec4(clamp(raster.rgb,vec3(0),vec3(1))*antialias,antialias);
#else
raster=apply_lighting_ground(raster);color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=vec4(raster.rgb*antialias,raster.a*antialias);
#endif
#else
color=texture(u_image0,v_pos0);
#ifdef LIGHTING_3D_MODE
#ifdef LIGHTING_3D_ALPHA_EMISSIVENESS
color=apply_lighting_with_emission_ground(color,color.a);color.a=1.0;
#else
color=apply_lighting_ground(color);
#endif
#endif
#endif
#ifdef FOG
color=fog_dither(fog_apply_premultiplied(color,v_fog_pos));
#endif
color*=1.0-step(u_far_z_cutoff,1.0/gl_FragCoord.w);glFragColor=color;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_terrain.vertex.glsl"
uniform mat4 u_proj_matrix;uniform mat4 u_normalize_matrix;uniform mat4 u_globe_matrix;uniform mat4 u_merc_matrix;uniform float u_zoom_transition;uniform vec2 u_merc_center;uniform mat3 u_grid_matrix;uniform float u_skirt_height;
#ifdef GLOBE_POLES
in vec3 a_globe_pos;in vec2 a_uv;
#else
in vec2 a_pos;
#endif
out vec2 v_pos0;void main() {
#ifdef GLOBE_POLES
vec3 globe_pos=a_globe_pos;vec2 uv=a_uv;
#else
float tiles=u_grid_matrix[0][2];float idx=u_grid_matrix[1][2];float idy=u_grid_matrix[2][2];vec3 decomposed_pos_and_skirt=decomposeToPosAndSkirt(a_pos);vec3 latLng=u_grid_matrix*vec3(decomposed_pos_and_skirt.xy,1.0);float mercatorY=mercatorYfromLat(latLng[0]);float uvY=mercatorY*tiles-idy;float mercatorX=mercatorXfromLng(latLng[1]);float uvX=mercatorX*tiles-idx;vec3 globe_pos=latLngToECEF(latLng.xy);vec2 merc_pos=vec2(mercatorX,mercatorY);vec2 uv=vec2(uvX,uvY);
#endif
v_pos0=uv;vec2 tile_pos=uv*EXTENT;vec3 globe_derived_up_vector=normalize(globe_pos)*u_tile_up_scale;
#ifdef GLOBE_POLES
vec3 up_vector=globe_derived_up_vector;
#else
vec3 up_vector=elevationVector(tile_pos);
#endif
float height=elevation(tile_pos);globe_pos+=up_vector*height;
#ifndef GLOBE_POLES
globe_pos-=globe_derived_up_vector*u_skirt_height*decomposed_pos_and_skirt.z;
#endif
#ifdef GLOBE_POLES
vec4 interpolated_pos=u_globe_matrix*vec4(globe_pos,1.0);
#else
vec4 globe_world_pos=u_globe_matrix*vec4(globe_pos,1.0);vec4 merc_world_pos=vec4(0.0);if (u_zoom_transition > 0.0) {merc_world_pos=vec4(merc_pos,height-u_skirt_height*decomposed_pos_and_skirt.z,1.0);merc_world_pos.xy-=u_merc_center;merc_world_pos.x=wrap(merc_world_pos.x,-0.5,0.5);merc_world_pos=u_merc_matrix*merc_world_pos;}vec4 interpolated_pos=vec4(mix(globe_world_pos.xyz,merc_world_pos.xyz,u_zoom_transition),1.0);
#endif
gl_Position=u_proj_matrix*interpolated_pos;
#ifdef FOG
v_fog_pos=fog_position((u_normalize_matrix*vec4(globe_pos,1.0)).xyz);
#endif
}`),globeAtmosphere:yi(`#include "_prelude_fog.fragment.glsl"
uniform float u_transition;uniform highp float u_fadeout_range;uniform highp float u_temporal_offset;uniform vec4 u_color;uniform vec4 u_high_color;uniform vec4 u_space_color;uniform float u_horizon_angle;in highp vec3 v_ray_dir;in highp vec3 v_horizon_dir;void main() {highp vec3 dir=normalize(v_ray_dir);float globe_pos_dot_dir;
#ifdef PROJECTION_GLOBE_VIEW
globe_pos_dot_dir=dot(u_globe_pos,dir);highp vec3 closest_point_forward=abs(globe_pos_dot_dir)*dir;float norm_dist_from_center=length(closest_point_forward-u_globe_pos)/u_globe_radius;if (norm_dist_from_center < 0.98) {
#ifdef ALPHA_PASS
glFragColor=vec4(0,0,0,0);return;
#else
#ifdef NATIVE
glFragColor=vec4(1,1,1,1);
#else
glFragColor=vec4(0,0,0,1);
#endif
return;
#endif
}
#endif
highp vec3 horizon_dir=normalize(v_horizon_dir);float horizon_angle_mercator=dir.y < horizon_dir.y ?
0.0 : max(acos(clamp(dot(dir,horizon_dir),-1.0,1.0)),0.0);float horizon_angle;
#ifdef PROJECTION_GLOBE_VIEW
highp vec3 closest_point=globe_pos_dot_dir*dir;highp float closest_point_to_center=length(closest_point-u_globe_pos);highp float theta=asin(clamp(closest_point_to_center/length(u_globe_pos),-1.0,1.0));horizon_angle=globe_pos_dot_dir < 0.0 ?
PI-theta-u_horizon_angle : theta-u_horizon_angle;float angle_t=pow(u_transition,10.0);horizon_angle=mix(horizon_angle,horizon_angle_mercator,angle_t);
#else
horizon_angle=horizon_angle_mercator;
#endif
horizon_angle/=PI;float t=exp(-horizon_angle/u_fadeout_range);float alpha_0=u_color.a;float alpha_1=u_high_color.a;float alpha_2=u_space_color.a;vec3 color_stop_0=u_color.rgb;vec3 color_stop_1=u_high_color.rgb;vec3 color_stop_2=u_space_color.rgb;
#ifdef ALPHA_PASS
float a0=mix(alpha_2,1.0,alpha_1);float a1=mix(a0,1.0,alpha_0);float a2=mix(a0,a1,t);float a =mix(alpha_2,a2,t);glFragColor=vec4(1.0,1.0,1.0,a);
#else
vec3 c0=mix(color_stop_2,color_stop_1,alpha_1);vec3 c1=mix(c0,color_stop_0,alpha_0);vec3 c2=mix(c0,c1,t);vec3 c=c2;glFragColor=vec4(c*t,t);
#endif
}`,`in vec3 a_pos;in vec2 a_uv;uniform vec3 u_frustum_tl;uniform vec3 u_frustum_tr;uniform vec3 u_frustum_br;uniform vec3 u_frustum_bl;uniform float u_horizon;out highp vec3 v_ray_dir;out highp vec3 v_horizon_dir;void main() {v_ray_dir=mix(
mix(u_frustum_tl,u_frustum_tr,a_uv.x),mix(u_frustum_bl,u_frustum_br,a_uv.x),a_uv.y);v_horizon_dir=mix(
mix(u_frustum_tl,u_frustum_bl,u_horizon),mix(u_frustum_tr,u_frustum_br,u_horizon),a_uv.x);gl_Position=vec4(a_pos,1.0);}`),model:yi(`#include "_prelude_fog.fragment.glsl"
#include "_prelude_shadow.fragment.glsl"
#include "_prelude_lighting.glsl"
uniform float u_opacity;uniform vec3 u_lightcolor;uniform vec3 u_lightpos;uniform float u_lightintensity;uniform vec4 u_baseColorFactor;uniform vec4 u_emissiveFactor;uniform float u_metallicFactor;uniform float u_roughnessFactor;uniform float u_emissive_strength;in highp vec4 v_position_height;in lowp vec4 v_color_mix;
#ifdef RENDER_SHADOWS
in highp vec4 v_pos_light_view_0;in highp vec4 v_pos_light_view_1;in float v_depth_shadows;
#endif
#ifdef OCCLUSION_TEXTURE_TRANSFORM
uniform vec4 u_occlusionTextureTransform;
#endif
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#ifdef HAS_ATTRIBUTE_a_pbr
in lowp vec4 v_roughness_metallic_emissive_alpha;in mediump vec4 v_height_based_emission_params;
#endif
#ifdef HAS_TEXTURE_u_baseColorTexture
uniform sampler2D u_baseColorTexture;uniform bool u_baseTextureIsAlpha;uniform bool u_alphaMask;uniform float u_alphaCutoff;
#endif
#ifdef HAS_TEXTURE_u_metallicRoughnessTexture
uniform sampler2D u_metallicRoughnessTexture;
#endif
#ifdef HAS_TEXTURE_u_occlusionTexture
uniform sampler2D u_occlusionTexture;uniform float u_aoIntensity;
#endif
#ifdef HAS_TEXTURE_u_normalTexture
uniform sampler2D u_normalTexture;
#endif
#ifdef HAS_TEXTURE_u_emissionTexture
uniform sampler2D u_emissionTexture;
#endif
#ifdef APPLY_LUT_ON_GPU
uniform highp sampler3D u_lutTexture;
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
in highp float v_depth;uniform highp sampler2D u_depthTexture;uniform highp vec2 u_inv_depth_size;uniform highp vec2 u_depth_range_unpack;
#ifdef DEPTH_D24
highp float unpack_depth(highp float depth) {return  depth*u_depth_range_unpack.x+u_depth_range_unpack.y;}
#else
highp float unpack_depth_rgba(highp vec4 rgba_depth)
{const highp vec4 bit_shift=vec4(1.0/(255.0*255.0*255.0),1.0/(255.0*255.0),1.0/255.0,1.0);return dot(rgba_depth,bit_shift)*2.0-1.0;}
#endif
bool isOccluded() {highp vec2 coord=gl_FragCoord.xy*u_inv_depth_size;
#ifdef DEPTH_D24
highp float depth=unpack_depth(texture(u_depthTexture,coord).r);
#else
highp float depth=unpack_depth_rgba(texture(u_depthTexture,coord));
#endif
return v_depth > depth+0.0005;}
#endif
#define saturate(_x) clamp(_x,0.,1.)
vec3 linearTosRGB(vec3 color) {return pow(color,vec3(1./2.2));}vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}float calculate_NdotL(vec3 normal,vec3 lightDir) {const float ext=0.70710678118;return (clamp(dot(normal,lightDir),-ext,1.0)+ext)/(1.0+ext);}vec3 getDiffuseShadedColor(vec3 albedo,vec3 normal,vec3 lightDir,vec3 lightColor)
{
#ifdef LIGHTING_3D_MODE
vec3 transformed_normal=vec3(-normal.xy,normal.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=saturate(dot(transformed_normal,u_lighting_directional_dir));
#endif
return apply_lighting(albedo,transformed_normal,lighting_factor);
#else
vec3 n=normal;float colorvalue=((albedo.x*0.2126)+(albedo.y*0.7152))+(albedo.z*0.0722);vec3 c=vec3(0.03,0.03,0.03);float directional=clamp(dot(n,vec3(lightDir)),0.0,1.0);directional=mix(1.0-u_lightintensity,max((1.0-colorvalue)+u_lightintensity,1.0),directional);vec3 c3=c+clamp((albedo*directional)*lightColor,mix(vec3(0.0),vec3(0.3),vec3(1.0)-lightColor),vec3(1.0));return c3;
#endif
}vec4 getBaseColor() {vec4 albedo=u_baseColorFactor;
#ifdef HAS_ATTRIBUTE_a_color_3f
albedo*=vec4(color_3f,1.0);
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#else
#ifdef HAS_ATTRIBUTE_a_color_4f
albedo*=color_4f;
#endif
#endif
#if defined (HAS_TEXTURE_u_baseColorTexture) && defined (HAS_ATTRIBUTE_a_uv_2f)
vec4 texColor=texture(u_baseColorTexture,uv_2f);if(u_alphaMask) {if (texColor.w < u_alphaCutoff) {discard;}}
#ifdef UNPREMULT_TEXTURE_IN_SHADER
if(texColor.w > 0.0) {texColor.rgb/=texColor.w;}texColor.w=1.0;
#endif
if(u_baseTextureIsAlpha) {if (texColor.r < 0.5) {discard;}} else {texColor.rgb=sRGBToLinear(texColor.rgb);albedo*=texColor;}
#endif
vec4 color=vec4(mix(albedo.rgb,v_color_mix.rgb,v_color_mix.a),albedo.a);
#ifdef APPLY_LUT_ON_GPU
color=applyLUT(u_lutTexture,color);
#endif
return color;}highp mat3 cotangentFrame(highp vec3 N,highp vec3 p,highp vec2 uv ) {
#ifdef HAS_TEXTURE_u_normalTexture
highp vec3 dp1=vec3(dFdx(p.x),dFdx(p.y),dFdx(p.z));highp vec3 dp2=vec3(dFdy(p.x),dFdy(p.y),dFdy(p.z));highp vec2 duv1=vec2(dFdx(uv.x),dFdx(uv.y));highp vec2 duv2=vec2(dFdy(uv.x),dFdy(uv.y));highp vec3 dp2perp=cross( dp2,N );highp vec3 dp1perp=cross( N,dp1 );highp vec3 T=dp2perp*duv1.x+dp1perp*duv2.x;highp vec3 B=dp2perp*duv1.y+dp1perp*duv2.y;highp float lengthT=dot(T,T);highp float lengthB=dot(B,B);highp float maxLength=max(lengthT,lengthB);highp float invmax=inversesqrt( maxLength );highp mat3 res=mat3( T*invmax,B*invmax,N );return res;
#else
return mat3(1.0);
#endif
}highp vec3 getNormal(){highp vec3 n;
#ifdef HAS_ATTRIBUTE_a_normal_3f
n=normalize(normal_3f);
#else
highp vec3 fdx=vec3(dFdx(v_position_height.x),dFdx(v_position_height.y),dFdx(v_position_height.z));highp vec3 fdy=vec3(dFdy(v_position_height.x),dFdy(v_position_height.y),dFdy(v_position_height.z));n=normalize(cross(fdx,fdy))*-1.0;
#endif
#if defined(HAS_TEXTURE_u_normalTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
vec3 nMap=texture( u_normalTexture,uv_2f).xyz;nMap=normalize(2.0*nMap-vec3(1.0));highp vec3 v=normalize(-v_position_height.xyz);highp mat3 TBN=cotangentFrame(n,v,uv_2f);n=normalize(TBN*nMap);
#endif
return n;}struct Material {float perceptualRoughness;float alphaRoughness;float metallic;vec3 f90;vec4 baseColor;vec3 diffuseColor;vec3 specularColor;highp vec3 normal;};Material getPBRMaterial() {Material mat;mat.baseColor=getBaseColor();mat.perceptualRoughness=u_roughnessFactor;mat.metallic=u_metallicFactor;
#ifdef HAS_ATTRIBUTE_a_pbr
mat.perceptualRoughness=v_roughness_metallic_emissive_alpha.x;mat.metallic=v_roughness_metallic_emissive_alpha.y;mat.baseColor.w*=v_roughness_metallic_emissive_alpha.w;
#endif
#if defined(HAS_TEXTURE_u_metallicRoughnessTexture) && defined(HAS_ATTRIBUTE_a_uv_2f) 
vec4 mrSample=texture(u_metallicRoughnessTexture,uv_2f);mat.perceptualRoughness*=mrSample.g;mat.metallic*=mrSample.b;
#endif
const float c_minRoughness=0.04;mat.perceptualRoughness=clamp(mat.perceptualRoughness,c_minRoughness,1.0);mat.metallic=saturate(mat.metallic);mat.alphaRoughness=mat.perceptualRoughness*mat.perceptualRoughness;const vec3 f0=vec3(0.04);mat.diffuseColor=mat.baseColor.rgb*(vec3(1.0)-f0);mat.diffuseColor*=1.0-mat.metallic;mat.specularColor=mix(f0,mat.baseColor.rgb,mat.metallic);highp float reflectance=max(max(mat.specularColor.r,mat.specularColor.g),mat.specularColor.b);highp float reflectance90=saturate(reflectance*25.0);mat.f90=vec3(reflectance90);mat.normal=getNormal();return mat;}float V_GGX(float NdotL,float NdotV,float roughness)
{float a2=roughness*roughness;float GGXV=NdotL*sqrt(NdotV*NdotV*(1.0-a2)+a2);float GGXL=NdotV*sqrt(NdotL*NdotL*(1.0-a2)+a2);return 0.5/(GGXV+GGXL);}float V_GGXFast(float NdotL,float NdotV,float roughness) {float a=roughness;float GGXV=NdotL*(NdotV*(1.0-a)+a);float GGXL=NdotV*(NdotL*(1.0-a)+a);return 0.5/(GGXV+GGXL);}vec3 F_Schlick(vec3 specularColor,vec3 f90,float VdotH)
{return specularColor+(f90-specularColor)*pow(clamp(1.0-VdotH,0.0,1.0),5.0);}vec3 F_SchlickFast(vec3 specularColor,float VdotH)
{float x=1.0-VdotH;float x4=x*x*x*x;return specularColor+(1.0-specularColor)*x4*x;}float D_GGX(highp float NdotH,float alphaRoughness)
{highp float a4=alphaRoughness*alphaRoughness;highp float f=(NdotH*a4-NdotH)*NdotH+1.0;return a4/(PI*f*f);}vec3 diffuseBurley(Material mat,float LdotH,float NdotL,float NdotV)
{float f90=2.0*LdotH*LdotH*mat.alphaRoughness-0.5;return (mat.diffuseColor/PI)*(1.0+f90*pow((1.0-NdotL),5.0))*(1.0+f90*pow((1.0-NdotV),5.0));}vec3 diffuseLambertian(Material mat)
{
#ifdef LIGHTING_3D_MODE
return mat.diffuseColor;
#else
return mat.diffuseColor/PI;
#endif
}vec3 EnvBRDFApprox(vec3 specularColor,float roughness,highp float NdotV)
{vec4 c0=vec4(-1,-0.0275,-0.572,0.022);vec4 c1=vec4(1,0.0425,1.04,-0.04);highp vec4 r=roughness*c0+c1;highp float a004=min(r.x*r.x,exp2(-9.28*NdotV))*r.x+r.y;vec2 AB=vec2(-1.04,1.04)*a004+r.zw;return specularColor*AB.x+AB.y;}vec3 computeIndirectLightContribution(Material mat,float NdotV,vec3 normal)
{vec3 env_light=vec3(0.65,0.65,0.65);
#ifdef LIGHTING_3D_MODE
float ambient_factor=calculate_ambient_directional_factor(normal);env_light=u_lighting_ambient_color*ambient_factor;
#endif
vec3 envBRDF=EnvBRDFApprox(mat.specularColor,mat.perceptualRoughness,NdotV);vec3 indirectSpecular= envBRDF*env_light;vec3 indirectDiffuse=mat.diffuseColor*env_light;return indirectSpecular+indirectDiffuse;}vec3 computeLightContribution(Material mat,vec3 lightPosition,vec3 lightColor)
{highp vec3 n=mat.normal;highp vec3 v=normalize(-v_position_height.xyz);highp vec3 l=normalize(lightPosition);highp vec3 h=normalize(v+l);float NdotV=clamp(abs(dot(n,v)),0.001,1.0);float NdotL=saturate(dot(n,l));highp float NdotH=saturate(dot(n,h));float VdotH=saturate(dot(v,h));vec3 f=F_SchlickFast(mat.specularColor,VdotH);float g=V_GGXFast(NdotL,NdotV,mat.alphaRoughness);float d=D_GGX(NdotH,mat.alphaRoughness);vec3 diffuseTerm=(1.0-f)*diffuseLambertian(mat);vec3 specularTerm=f*g*d;vec3 transformed_normal=vec3(-n.xy,n.z);float lighting_factor;
#ifdef RENDER_SHADOWS
lighting_factor=shadowed_light_factor_normal(transformed_normal,v_pos_light_view_0,v_pos_light_view_1,v_depth_shadows);
#else
lighting_factor=NdotL;
#endif
vec3 directLightColor=(specularTerm+diffuseTerm)*lighting_factor*lightColor;vec3 indirectLightColor=computeIndirectLightContribution(mat,NdotV,transformed_normal);vec3 color=(saturate(directLightColor)+indirectLightColor);float intensityFactor=1.0;
#if !defined(LIGHTING_3D_MODE)
const vec3 luminosityFactor=vec3(0.2126,0.7152,0.0722);float luminance=dot(diffuseTerm,luminosityFactor);intensityFactor=mix((1.0-u_lightintensity),max((1.0-luminance+u_lightintensity),1.0),NdotL);
#endif
color*=intensityFactor;return color;}void main() {
#ifdef TERRAIN_FRAGMENT_OCCLUSION
if (isOccluded()) {discard;}
#endif
vec3 lightDir=u_lightpos;vec3 lightColor=u_lightcolor;
#ifdef LIGHTING_3D_MODE
lightDir=u_lighting_directional_dir;lightDir.xy=-lightDir.xy;lightColor=u_lighting_directional_color;
#endif
vec4 finalColor;
#ifdef DIFFUSE_SHADED
vec3 N=getNormal();vec3 baseColor=getBaseColor().rgb;vec3 diffuse=getDiffuseShadedColor(baseColor,N,lightDir,lightColor);
#ifdef HAS_TEXTURE_u_occlusionTexture
float ao=(texture(u_occlusionTexture,uv_2f).r-1.0)*u_aoIntensity+1.0;diffuse*=ao;
#endif
finalColor=vec4(mix(diffuse,baseColor,u_emissive_strength),1.0)*u_opacity;
#else
Material mat=getPBRMaterial();vec3 color=computeLightContribution(mat,lightDir,lightColor);float ao=1.0;
#if defined (HAS_TEXTURE_u_occlusionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
#ifdef OCCLUSION_TEXTURE_TRANSFORM
vec2 uv=uv_2f.xy*u_occlusionTextureTransform.zw+u_occlusionTextureTransform.xy;
#else
vec2 uv=uv_2f;
#endif
ao=(texture(u_occlusionTexture,uv).x-1.0)*u_aoIntensity+1.0;color*=ao;
#endif
vec4 emissive=u_emissiveFactor;
#if defined(HAS_TEXTURE_u_emissionTexture) && defined(HAS_ATTRIBUTE_a_uv_2f)
emissive.rgb*=sRGBToLinear(texture(u_emissionTexture,uv_2f).rgb);
#endif
#ifdef APPLY_LUT_ON_GPU
float emissiveFactorLength=max(length(u_emissiveFactor.rgb),0.001);emissive.rgb=sRGBToLinear(applyLUT(u_lutTexture,linearTosRGB(emissive.rgb/emissiveFactorLength).rbg))*emissiveFactorLength;
#endif
color+=emissive.rgb;float opacity=mat.baseColor.w*u_opacity;
#ifdef HAS_ATTRIBUTE_a_pbr
float resEmission=v_roughness_metallic_emissive_alpha.z;resEmission*=v_height_based_emission_params.z+v_height_based_emission_params.w*pow(clamp(v_height_based_emission_params.x,0.0,1.0),v_height_based_emission_params.y);vec3 color_mix=v_color_mix.rgb;
#ifdef APPLY_LUT_ON_GPU
color_mix=applyLUT(u_lutTexture,color_mix);
#endif
color=mix(color,color_mix,min(1.0,resEmission));
#ifdef HAS_ATTRIBUTE_a_color_4f
float distance=length(vec2(1.3*max(0.0,abs(color_4f.x)-color_4f.z),color_4f.y));distance+= mix(0.5,0.0,clamp(resEmission-1.0,0.0,1.0));opacity*=v_roughness_metallic_emissive_alpha.w*saturate(1.0-distance*distance);
#endif
#endif
vec3 unlitColor=mat.baseColor.rgb*ao+emissive.rgb;color=mix(color,unlitColor,u_emissive_strength);color=linearTosRGB(color);color*=opacity;finalColor=vec4(color,opacity);
#endif
#ifdef FOG
finalColor=fog_dither(fog_apply_premultiplied(finalColor,v_fog_pos,v_position_height.w));
#endif
#ifdef RENDER_CUTOFF
finalColor*=v_cutoff_opacity;
#endif
#ifdef INDICATOR_CUTOUT
finalColor=applyCutout(finalColor,v_position_height.w);
#endif
glFragColor=finalColor;
#ifdef OVERDRAW_INSPECTOR
glFragColor=vec4(1.0);
#endif
HANDLE_WIREFRAME_DEBUG;}`,`#include "_prelude_fog.vertex.glsl"
#include "_prelude_shadow.vertex.glsl"
in vec3 a_pos_3f;
#pragma mapbox: define-attribute highp vec3 normal_3f
#pragma mapbox: define-attribute highp vec2 uv_2f
#pragma mapbox: define-attribute highp vec3 color_3f
#pragma mapbox: define-attribute highp vec4 color_4f
#pragma mapbox: define-attribute-vertex-shader-only highp vec4 pbr
#pragma mapbox: define-attribute-vertex-shader-only highp vec3 heightBasedEmissiveStrength
uniform mat4 u_matrix;uniform mat4 u_node_matrix;uniform mat4 u_lighting_matrix;uniform vec3 u_camera_pos;uniform vec4 u_color_mix;
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_normal_matrix;
#endif
#ifdef RENDER_SHADOWS
uniform mat4 u_light_matrix_0;uniform mat4 u_light_matrix_1;out highp vec4 v_pos_light_view_0;out highp vec4 v_pos_light_view_1;out float v_depth_shadows;
#endif
out vec4 v_position_height;out lowp vec4 v_color_mix;
#ifdef TERRAIN_FRAGMENT_OCCLUSION
out highp float v_depth;
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
out lowp vec4 v_roughness_metallic_emissive_alpha;out mediump vec4 v_height_based_emission_params;
#endif
vec3 sRGBToLinear(vec3 srgbIn) {return pow(srgbIn,vec3(2.2));}void main() {
#pragma mapbox: initialize-attribute highp vec3 normal_3f
#pragma mapbox: initialize-attribute highp vec2 uv_2f
#pragma mapbox: initialize-attribute highp vec3 color_3f
#pragma mapbox: initialize-attribute highp vec4 color_4f
#pragma mapbox: initialize-attribute-custom highp vec4 pbr
#pragma mapbox: initialize-attribute-custom highp vec3 heightBasedEmissiveStrength
highp mat4 normal_matrix;
#ifdef INSTANCED_ARRAYS
normal_matrix=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
normal_matrix=u_normal_matrix;
#endif
vec3 local_pos;mat3 rs;
#ifdef MODEL_POSITION_ON_GPU
vec3 pos_color=normal_matrix[0].xyz;vec4 translate=normal_matrix[1];vec3 pos_a=floor(pos_color);vec3 rgb=1.05*(pos_color-pos_a);float hidden=float(pos_a.x > EXTENT);float color_mix=pos_a.z/100.0;v_color_mix=vec4(sRGBToLinear(rgb),color_mix);float meter_to_tile=normal_matrix[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);rs[0].x=normal_matrix[1].w;rs[0].yz=normal_matrix[2].xy;rs[1].xy=normal_matrix[2].zw;rs[1].z=normal_matrix[3].x;rs[2].xyz=normal_matrix[3].yzw;vec4 pos_node=u_lighting_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;local_pos=pos.xyz;gl_Position=mix(u_matrix*pos,AWAY,hidden);pos.z*=meter_to_tile;v_position_height.xyz=pos.xyz-u_camera_pos;
#else
local_pos=a_pos_3f;gl_Position=u_matrix*vec4(a_pos_3f,1);v_position_height.xyz=vec3(u_lighting_matrix*vec4(a_pos_3f,1));v_color_mix=vec4(sRGBToLinear(u_color_mix.rgb),u_color_mix.a);
#endif
v_position_height.w=a_pos_3f.z;
#ifdef HAS_ATTRIBUTE_a_pbr
vec4 albedo_c=decode_color(pbr.xy);vec2 e_r_m=unpack_float(pbr.z);vec2 r_m= unpack_float(e_r_m.y*16.0);r_m.r=r_m.r*16.0;v_color_mix=vec4(albedo_c.rgb,1.0);v_roughness_metallic_emissive_alpha=vec4(vec3(r_m,e_r_m.x)/255.0,albedo_c.a);v_roughness_metallic_emissive_alpha.z*=2.0;float heightBasedRelativeIntepolation=a_pos_3f.z*heightBasedEmissiveStrength.x+heightBasedEmissiveStrength.y;v_height_based_emission_params.x=heightBasedRelativeIntepolation;v_height_based_emission_params.y=heightBasedEmissiveStrength.z;vec2 emissionMultiplierValues=unpack_float(pbr.w)/256.0;v_height_based_emission_params.z=emissionMultiplierValues.x;v_height_based_emission_params.w=emissionMultiplierValues.y-emissionMultiplierValues.x;
#endif
#ifdef FOG
v_fog_pos=fog_position(local_pos);
#endif
#ifdef RENDER_CUTOFF
v_cutoff_opacity=cutoff_opacity(u_cutoff_params,gl_Position.z);
#endif
#ifdef TERRAIN_FRAGMENT_OCCLUSION
v_depth=gl_Position.z/gl_Position.w;
#endif
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
float x_squared_scale=dot(rs[0],rs[0]);float y_squared_scale=dot(rs[1],rs[1]);float z_squared_scale=dot(rs[2],rs[2]);vec3 squared_scale=vec3(x_squared_scale,y_squared_scale,z_squared_scale);normal_3f=rs*((u_lighting_matrix*vec4(normal_3f,0.0)).xyz/squared_scale);normal_3f=normalize(normal_3f);
#else
normal_3f=vec3(normal_matrix*vec4(normal_3f,0));
#endif
#endif
#ifdef HAS_ATTRIBUTE_a_pbr
#ifdef HAS_ATTRIBUTE_a_color_4f
v_roughness_metallic_emissive_alpha.w=clamp(color_4f.a*v_roughness_metallic_emissive_alpha.w*(v_roughness_metallic_emissive_alpha.z-1.0),0.0,1.0);
#endif
#endif
#ifdef RENDER_SHADOWS
vec4 shadow_pos=u_node_matrix*vec4(local_pos,1.0);
#ifdef NORMAL_OFFSET
#ifdef HAS_ATTRIBUTE_a_normal_3f
#ifdef MODEL_POSITION_ON_GPU
vec3 offset=shadow_normal_offset(vec3(-normal_3f.xy,normal_3f.z));shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#else
vec3 offset=shadow_normal_offset_model(normal_3f);shadow_pos.xyz+=offset*shadow_normal_offset_multiplier0();
#endif
#endif
#endif
v_pos_light_view_0=u_light_matrix_0*shadow_pos;v_pos_light_view_1=u_light_matrix_1*shadow_pos;v_depth_shadows=gl_Position.w;
#endif
}`),modelDepth:yi(`in highp float v_depth;void main() {
#ifndef DEPTH_TEXTURE
glFragColor=pack_depth(v_depth);
#endif
}`,`in vec3 a_pos_3f;uniform mat4 u_matrix;out highp float v_depth;
#ifdef MODEL_POSITION_ON_GPU
#ifdef INSTANCED_ARRAYS
in vec4 a_normal_matrix0;in vec4 a_normal_matrix1;in vec4 a_normal_matrix2;in vec4 a_normal_matrix3;
#else
uniform highp mat4 u_instance;
#endif
uniform highp mat4 u_node_matrix;
#endif
void main() {
#ifdef MODEL_POSITION_ON_GPU
highp mat4 instance;
#ifdef INSTANCED_ARRAYS
instance=mat4(a_normal_matrix0,a_normal_matrix1,a_normal_matrix2,a_normal_matrix3);
#else
instance=u_instance;
#endif
vec3 pos_color=instance[0].xyz;vec4 translate=instance[1];vec3 pos_a=floor(pos_color);float hidden=float(pos_a.x > EXTENT);float meter_to_tile=instance[0].w;vec4 pos=vec4(pos_a.xy,translate.z,1.0);mat3 rs;rs[0].x=instance[1].w;rs[0].yz=instance[2].xy;rs[1].xy=instance[2].zw;rs[1].z=instance[3].x;rs[2].xyz=instance[3].yzw;vec4 pos_node=u_node_matrix*vec4(a_pos_3f,1.0);vec3 rotated_pos_node=rs*pos_node.xyz;vec3 pos_model_tile=(rotated_pos_node+vec3(translate.xy,0.0))*vec3(meter_to_tile,meter_to_tile,1.0);pos.xyz+=pos_model_tile;gl_Position=mix(u_matrix*pos,AWAY,hidden);
#else
gl_Position=u_matrix*vec4(a_pos_3f,1);
#endif
v_depth=gl_Position.z/gl_Position.w;}`),stars:yi(`in highp vec2 v_uv;in mediump float v_intensity;float shapeCircle(in vec2 uv)
{float beginFade=0.6;float lengthFromCenter=length(v_uv);return 1.0-clamp((lengthFromCenter-beginFade)/(1.0-beginFade),0.0,1.0);}void main() {float alpha=shapeCircle(v_uv);vec3 color=vec3(1.0,1.0,1.0);alpha*=v_intensity;glFragColor=vec4(color*alpha,alpha);HANDLE_WIREFRAME_DEBUG;}`,`
in vec3 a_pos_3f;in vec2 a_uv;in float a_size_scale;in float a_fade_opacity;uniform mat4 u_matrix;uniform vec3 u_up;uniform vec3 u_right;uniform float u_intensity_multiplier;out highp vec2 v_uv;out mediump float v_intensity;void main() {v_uv=a_uv;v_intensity=a_fade_opacity*u_intensity_multiplier;vec3 pos=a_pos_3f;pos+=a_uv.x*u_right*a_size_scale;pos+=a_uv.y*u_up*a_size_scale;gl_Position=u_matrix*vec4(pos,1.0);}`),snowParticle:yi("in highp vec2 uv;in highp float alphaMultiplier;uniform vec4 u_particleColor;uniform vec2 u_simpleShapeParameters;void main() {float t=clamp((length(uv)-u_simpleShapeParameters.x)/(1.0-u_simpleShapeParameters.x),0.0,1.0);float alpha=1.0-pow(t,pow(10.0,u_simpleShapeParameters.y));alpha*=alphaMultiplier;alpha*=u_particleColor.a;vec3 color=u_particleColor.rgb*alpha;glFragColor=vec4(color,alpha) ;HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_snowParticleData;in highp vec4 a_snowParticleDataHorizontalOscillation;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform vec2 u_screenSize;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity;uniform vec3 u_direction;uniform float u_horizontalOscillationRadius; 
uniform float u_horizontalOscillationRate; 
uniform float u_billboardSize;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;out highp vec2 uv;out highp float alphaMultiplier;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos.xyz*=halfBoxSize;pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_snowParticleData.z;float coneAngleHeadingRad=a_snowParticleData.w*radians(360.0);vec3 localZ=normalize(u_direction);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 direction;direction.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);direction.z=cos(coneAnglePichRad);direction=normalize(direction);vec3 simPosLocal=vec3(0,0,0);float velocityScale=(1.0+3.0*a_snowParticleData.y)*u_velocity;simPosLocal+=direction*velocityScale*u_time;float horizontalOscillationRadius=u_horizontalOscillationRadius*a_snowParticleDataHorizontalOscillation.x;float horizontalOscillationAngle=u_horizontalOscillationRate*u_time*(-1.0+2.0*a_snowParticleDataHorizontalOscillation.y);simPosLocal.xy+=horizontalOscillationRadius*vec2(cos(horizontalOscillationAngle),sin(horizontalOscillationAngle));vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);float clipZ=-u_cam_pos.z+pos.z;vec4 posView=u_modelview*vec4(pos,1.0);float size=u_billboardSize;alphaMultiplier=1.0;vec4 posScreen=u_projection*posView;posScreen/=posScreen.w;posScreen.xy=vec2(0.5)+posScreen.xy*0.5;posScreen.xy*=u_screenSize;vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=u_screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-posScreen.xy)/(0.5*u_screenSize));screenDist+=a_snowParticleData.x*u_thinningParticleOffset;float scaleFactorMode=0.0;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);if (a_snowParticleData.x < u_thinningAffectedRatio) {scaleFactorMode=1.0-thinningFadeRatio;alphaMultiplier=thinningFadeRatio;}}vec4 posScreen1=u_projection*vec4(posView.x-size,posView.yzw);posScreen1/=posScreen1.w;vec4 posScreen2=u_projection*vec4(posView.x+size,posView.yzw);posScreen2/=posScreen2.w;posScreen1.xy=vec2(0.5)+posScreen1.xy*0.5;posScreen1.xy*=u_screenSize;posScreen2.xy=vec2(0.5)+posScreen2.xy*0.5;posScreen2.xy*=u_screenSize;float screenLength=length(posScreen1.xy-posScreen2.xy);float screenEpsilon=3.0;float scaleFactor=1.0;if (screenLength < screenEpsilon) {scaleFactor=screenEpsilon/max(screenLength,0.01);scaleFactor=mix(scaleFactor,1.0,scaleFactorMode);}float screenEpsilon2=15.0;if (screenLength > screenEpsilon2) {scaleFactor=screenEpsilon2/max(screenLength,0.01);}size*=scaleFactor;vec2 right=size*vec2(1,0);vec2 up=size*vec2(0,1);posView.xy+=right*a_uv.x;posView.xy+=up*a_uv.y;uv=a_uv;gl_Position=u_projection*posView;}`),rainParticle:yi("in highp vec2 uv;in highp float particleRandomValue;uniform sampler2D u_texScreen;uniform float u_distortionStrength;uniform vec4 u_color;uniform vec2 u_thinningCenterPos;uniform vec3 u_thinningShape;uniform float u_thinningAffectedRatio;uniform float u_thinningParticleOffset;uniform float u_shapeDirectionalPower;uniform float u_mode;void main() {vec2 st=uv*0.5+vec2(0.5);vec2 uvm=uv;uvm.y=-1.0+2.0*pow(st.y,u_shapeDirectionalPower);float shape=clamp(1.0-length(uvm),0.0,1.0);float alpha=abs(shape)*u_color.a;vec2 screenSize=vec2(textureSize(u_texScreen,0));vec2 thinningCenterPos=u_thinningCenterPos.xy;thinningCenterPos.y=screenSize.y-thinningCenterPos.y;float screenDist=length((thinningCenterPos-gl_FragCoord.xy)/(0.5*screenSize));screenDist+=(0.5+0.5*particleRandomValue)*u_thinningParticleOffset;float thinningShapeDist=u_thinningShape.x+u_thinningShape.y;float thinningAlpha=1.0;if (screenDist < thinningShapeDist) {float thinningFadeRatio=clamp((screenDist-u_thinningShape.x)/u_thinningShape.y,0.0,1.0);thinningFadeRatio=pow(thinningFadeRatio,u_thinningShape.z);thinningAlpha*=thinningFadeRatio;}vec2 offsetXY=normalize(uvm)*abs(shape);vec2 stScreen=(gl_FragCoord.xy+offsetXY*u_distortionStrength*thinningAlpha)/screenSize;vec3 colorScreen=texture(u_texScreen,stScreen).rgb;alpha*=thinningAlpha;glFragColor=mix(vec4(colorScreen,1.0),vec4(u_color.rgb*alpha,alpha),u_mode);HANDLE_WIREFRAME_DEBUG;}",`
in highp vec3 a_pos_3f;in highp vec2 a_uv;in highp vec4 a_rainParticleData;uniform mat4 u_modelview;uniform mat4 u_projection;uniform vec3 u_cam_pos;uniform float u_time;uniform float u_boxSize;uniform float u_velocityConeAperture; 
uniform float u_velocity; 
uniform vec2 u_rainDropletSize;uniform vec3 u_rainDirection;out highp vec2 uv;out highp float particleRandomValue;void main() {vec3 pos=a_pos_3f;float halfBoxSize=0.5*u_boxSize;pos*=halfBoxSize; 
pos+=u_cam_pos;float velocityConeApertureRad=radians(u_velocityConeAperture*0.5);float coneAnglePichRad=velocityConeApertureRad*a_rainParticleData.z;float coneAngleHeadingRad=a_rainParticleData.w*radians(360.0);vec3 localZ=normalize(u_rainDirection);vec3 localX=normalize(cross(localZ,vec3(1,0,0)));vec3 localY=normalize(cross(localZ,localX));vec3 directionLocal;directionLocal.x=cos(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.y=sin(coneAngleHeadingRad)*sin(coneAnglePichRad);directionLocal.z=cos(coneAnglePichRad);directionLocal=normalize(directionLocal);vec3 directionWorld=localX*directionLocal.x+localY*directionLocal.y+localZ*directionLocal.z;float velocityScale=(1.0+3.0*a_rainParticleData.y)*u_velocity;vec3 simPosLocal=vec3(0,0,0);simPosLocal+=directionLocal*velocityScale*u_time;vec3 simPos=localX*simPosLocal.x+
localY*simPosLocal.y+localZ*simPosLocal.z;pos+=simPos;pos=fract((pos+vec3(halfBoxSize))/vec3(u_boxSize))*u_boxSize-vec3(halfBoxSize);vec4 posView=u_modelview*vec4(pos,1.0);vec3 directionView=normalize((u_modelview*vec4(directionWorld,0.0)).xyz);vec3 side=cross(directionView,normalize(posView.xyz));posView.xyz+=side*a_uv.x*u_rainDropletSize.x;posView.xyz+=directionView*a_uv.y*u_rainDropletSize.y;uv=a_uv;particleRandomValue=a_rainParticleData.x;gl_Position=u_projection*posView;}`),vignette:yi("uniform vec3 u_vignetteShape;uniform vec4 u_vignetteColor;in vec2 st;void main() {float screenDist=length(st);float alpha=clamp((screenDist-u_vignetteShape.x)/u_vignetteShape.y,0.0,1.0);alpha=pow(alpha,u_vignetteShape.z)*u_vignetteColor.a;vec3 color=u_vignetteColor.rgb;glFragColor=vec4(color*alpha,alpha) ;}","in vec2 a_pos_2f;out vec2 st;void main() {st=a_pos_2f;gl_Position=vec4(a_pos_2f,0,1);}"),occlusion:yi("uniform vec4 u_color;void main() {glFragColor=u_color;}",`#include "_prelude_terrain.vertex.glsl"
in highp vec2 a_offset_xy;uniform highp vec3 u_anchorPos;uniform mat4 u_matrix;uniform vec2 u_screenSizePx;uniform vec2 u_occluderSizePx;void main() {vec3 world_pos=u_anchorPos;
#ifdef TERRAIN
float e=elevation(world_pos.xy);world_pos.z+=e;
#endif
vec4 projected_point=u_matrix*vec4(world_pos,1.0);projected_point.xy+=projected_point.w*a_offset_xy*0.5*u_occluderSizePx/u_screenSizePx;gl_Position=projected_point;}`)};function Ta(_,o){const f=_.replace(/\s*\/\/[^\n]*\n/g,`
`).split(`
`);for(let y of f)if(y=y.trim(),y[0]==="#"&&y.includes("if")&&!y.includes("endif")){y=y.replace("#","").replace(/ifdef|ifndef|elif|if/g,"").replace(/!|defined|\(|\)|\|\||&&/g,"").replace(/\s+/g," ").trim();const w=y.split(" ");for(const E of w)o.includes(E)||o.push(E)}}function yi(_,o){const f=/#include\s+"([^"]+)"/g,y=/#pragma mapbox: ([\w\-]+) ([\w]+) ([\w]+) ([\w]+)/g;let w=o.match(/(attribute(\S*)|(^\s*|;)in) (highp |mediump |lowp )?([\w]+) ([\w]+)/gm);w&&(w=w.map(j=>{const H=j.split(" ");return H[H.length-1]}),w=[...new Set(w)]);const E={},C=[],M=[];if(_=_.replace(f,(j,H)=>(M.push(H),"")),(o=o.replace(f,(j,H)=>(C.push(H),""))).includes("flat out"))return void console.error('The usage of "flat" qualifier is disallowed, see: https://bugs.webkit.org/show_bug.cgi?id=268071');let N=[...ed];Ta(_,N),Ta(o,N);for(const j of[...C,...M])kl[j]||console.error(`Undefined include: ${j}`),oc[j]||(oc[j]=[],Ta(kl[j],oc[j])),N=[...N,...oc[j]];return{fragmentSource:_=_.replace(y,(j,H,Z,W,Q)=>(E[Q]=!0,H==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
in ${Z} ${W} ${Q};
#else
uniform ${Z} ${W} u_${Q};
#endif
`:H==="initialize"?`
#ifdef HAS_UNIFORM_u_${Q}
    ${Z} ${W} ${Q} = u_${Q};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${Z} ${W} ${Q};
#endif
`:H==="initialize-attribute"?"":void 0)),vertexSource:o=o.replace(y,(j,H,Z,W,Q)=>{const ce=W==="float"?"vec2":W,se=Q.match(/color/)?"color":ce;return H==="define-attribute-vertex-shader-only"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
in ${Z} ${W} a_${Q};
#endif
`:E[Q]?H==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${Z} ${ce} a_${Q};
out ${Z} ${W} ${Q};
#else
uniform ${Z} ${W} u_${Q};
#endif
`:H==="initialize"?se==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = a_${Q};
#else
    ${Z} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Q} = unpack_mix_${se}(a_${Q}, u_${Q}_t);
#else
    ${Z} ${W} ${Q} = u_${Q};
#endif
`:H==="define-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    in ${Z} ${W} a_${Q};
    out ${Z} ${W} ${Q};
#endif
`:H==="initialize-attribute"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Q} = a_${Q};
#endif
`:void 0:H==="define"?`
#ifndef HAS_UNIFORM_u_${Q}
uniform lowp float u_${Q}_t;
in ${Z} ${ce} a_${Q};
#else
uniform ${Z} ${W} u_${Q};
#endif
`:H==="define-instanced"?se==="mat4"?`
#ifdef INSTANCED_ARRAYS
in vec4 a_${Q}0;
in vec4 a_${Q}1;
in vec4 a_${Q}2;
in vec4 a_${Q}3;
#else
uniform ${Z} ${W} u_${Q};
#endif
`:`
#ifdef INSTANCED_ARRAYS
in ${Z} ${ce} a_${Q};
#else
uniform ${Z} ${W} u_${Q};
#endif
`:H==="initialize-attribute-custom"?`
#ifdef HAS_ATTRIBUTE_a_${Q}
    ${Z} ${W} ${Q} = a_${Q};
#endif
`:se==="vec4"?`
#ifndef HAS_UNIFORM_u_${Q}
    ${Z} ${W} ${Q} = a_${Q};
#else
    ${Z} ${W} ${Q} = u_${Q};
#endif
`:`
#ifndef HAS_UNIFORM_u_${Q}
    ${Z} ${W} ${Q} = unpack_mix_${se}(a_${Q}, u_${Q}_t);
#else
    ${Z} ${W} ${Q} = u_${Q};
#endif
`}),staticAttributes:w,usedDefines:N,vertexIncludes:C,fragmentIncludes:M}}class Ip{constructor(){this.boundProgram=null,this.boundLayoutVertexBuffer=null,this.boundPaintVertexBuffers=[],this.boundIndexBuffer=null,this.boundVertexOffset=null,this.boundDynamicVertexBuffers=[],this.vao=null}bind(o,f,y,w,E,C,M,N){this.context=o;let j=this.boundPaintVertexBuffers.length!==w.length;for(let Z=0;!j&&Z<w.length;Z++)this.boundPaintVertexBuffers[Z]!==w[Z]&&(j=!0);let H=this.boundDynamicVertexBuffers.length!==M.length;for(let Z=0;!H&&Z<M.length;Z++)this.boundDynamicVertexBuffers[Z]!==M[Z]&&(H=!0);if(!this.vao||this.boundProgram!==f||this.boundLayoutVertexBuffer!==y||j||H||this.boundIndexBuffer!==E||this.boundVertexOffset!==C)this.freshBind(f,y,w,E,C,M,N);else{o.bindVertexArrayOES.set(this.vao);for(const Z of M)Z&&(Z.bind(),N&&Z.instanceCount&&Z.setVertexAttribDivisor(o.gl,f,N));E&&E.dynamicDraw&&E.bind()}}freshBind(o,f,y,w,E,C,M){const N=o.numAttributes,j=this.context,H=j.gl;this.vao&&this.destroy(),this.vao=j.gl.createVertexArray(),j.bindVertexArrayOES.set(this.vao),this.boundProgram=o,this.boundLayoutVertexBuffer=f,this.boundPaintVertexBuffers=y,this.boundIndexBuffer=w,this.boundVertexOffset=E,this.boundDynamicVertexBuffers=C,f.enableAttributes(H,o),f.bind(),f.setVertexAttribPointers(H,o,E);for(const Z of y)Z.enableAttributes(H,o),Z.bind(),Z.setVertexAttribPointers(H,o,E);for(const Z of C)Z&&(Z.enableAttributes(H,o),Z.bind(),Z.setVertexAttribPointers(H,o,E),M&&Z.instanceCount&&Z.setVertexAttribDivisor(H,o,M));w&&w.bind(),j.currentNumAttributes=N}destroy(){this.vao&&(this.context.gl.deleteVertexArray(this.vao),this.vao=null)}}function Bx(_,o){const f=Math.pow(2,o.canonical.z),y=o.canonical.y;return[new s.ac(0,y/f).toLngLat().lat,new s.ac(0,(y+1)/f).toLngLat().lat]}function Fx(_,o,f,y,w,E,C){const M=_.context,N=M.gl,j=f.hillshadeFBO;if(!j)return;_.prepareDrawTile();const H=_.isTileAffectedByFog(o),Z=_.getOrCreateProgram("hillshade",{overrideFog:H});M.activeTexture.set(N.TEXTURE0),N.bindTexture(N.TEXTURE_2D,j.colorAttachment.get());const W=((ue,pe,ge,Pe)=>{const Ve=ge.paint.get("hillshade-shadow-color"),Ye=ge.paint.get("hillshade-shadow-color-use-theme").constantOr("default")==="none",qe=ge.paint.get("hillshade-highlight-color"),je=ge.paint.get("hillshade-highlight-color-use-theme").constantOr("default")==="none",Ue=ge.paint.get("hillshade-accent-color"),We=ge.paint.get("hillshade-accent-color-use-theme").constantOr("default")==="none",et=ge.paint.get("hillshade-emissive-strength");let _t=s.al(ge.paint.get("hillshade-illumination-direction"));if(ge.paint.get("hillshade-illumination-anchor")==="viewport")_t-=ue.transform.angle;else if(ue.style&&ue.style.enable3dLights()&&ue.style.directionalLight){const Mt=ue.style.directionalLight.properties.get("direction"),Rt=s.cR(Mt.x,Mt.y,Mt.z);_t=s.al(Rt[1])}const ft=!ue.options.moving;return{u_matrix:Pe||ue.transform.calculateProjMatrix(pe.tileID.toUnwrapped(),ft),u_image:0,u_latrange:Bx(0,pe.tileID),u_light:[ge.paint.get("hillshade-exaggeration"),_t],u_shadow:Ve.toPremultipliedRenderColor(Ye?null:ge.lut),u_highlight:qe.toPremultipliedRenderColor(je?null:ge.lut),u_emissive_strength:et,u_accent:Ue.toPremultipliedRenderColor(We?null:ge.lut)}})(_,f,y,_.terrain?o.projMatrix:null);_.uploadCommonUniforms(M,Z,o.toUnwrapped());const{tileBoundsBuffer:Q,tileBoundsIndexBuffer:ce,tileBoundsSegments:se}=_.getTileBoundsBuffers(f);Z.draw(_,N.TRIANGLES,w,E,C,Un.disabled,W,y.id,Q,ce,se)}function Mp(_,o,f){if(!o.needsDEMTextureUpload)return;const y=_.context,w=y.gl;y.pixelStoreUnpackPremultiplyAlpha.set(!1),o.demTexture=o.demTexture||_.getTileTexture(f.stride);const E=f.getPixels();o.demTexture?o.demTexture.update(E,{premultiply:!1}):o.demTexture=new s.T(y,E,w.R32F,{premultiply:!1}),o.needsDEMTextureUpload=!1}function g0(_,o,f){const y=_.context,w=y.gl;if(!o.dem)return;const E=o.dem;if(y.activeTexture.set(w.TEXTURE1),Mp(_,o,E),!o.demTexture)return;o.demTexture.bind(w.NEAREST,w.CLAMP_TO_EDGE);const C=E.dim;y.activeTexture.set(w.TEXTURE0);let M=o.hillshadeFBO;if(!M){const W=new s.T(y,{width:C,height:C,data:null},w.RGBA8);W.bind(w.LINEAR,w.CLAMP_TO_EDGE),M=o.hillshadeFBO=y.createFramebuffer(C,C,!0,"renderbuffer"),M.colorAttachment.set(W.texture)}y.bindFramebuffer.set(M.framebuffer),y.viewport.set([0,0,C,C]);const{tileBoundsBuffer:N,tileBoundsIndexBuffer:j,tileBoundsSegments:H}=_.getMercatorTileBoundsBuffers(),Z=[];_.linearFloatFilteringSupported()&&Z.push("TERRAIN_DEM_FLOAT_FORMAT"),_.getOrCreateProgram("hillshadePrepare",{defines:Z}).draw(_,w.TRIANGLES,an.disabled,Hn.disabled,kn.unblended,Un.disabled,((W,Q)=>{const ce=Q.stride,se=s.bz();return s.c5(se,0,s.aj,-8192,0,0,1),s.bo(se,se,[0,-8192,0]),{u_matrix:se,u_image:1,u_dimension:[ce,ce],u_zoom:W.overscaledZ}})(o.tileID,E),f.id,N,j,H),o.needsHillshadePrepare=!1}class ri{constructor(o){this.gl=o.gl,this.default=this.getDefault(),this.current=this.default,this.dirty=!1}get(){return this.current}set(o){}getDefault(){return this.default}setDefault(){this.set(this.default)}}class zn extends ri{getDefault(){return s.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.clearColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class nd extends ri{getDefault(){return 1}set(o){(o!==this.current||this.dirty)&&(this.gl.clearDepth(o),this.current=o,this.dirty=!1)}}class H_ extends ri{getDefault(){return 0}set(o){(o!==this.current||this.dirty)&&(this.gl.clearStencil(o),this.current=o,this.dirty=!1)}}class po extends ri{getDefault(){return[!0,!0,!0,!0]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.colorMask(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class _0 extends ri{getDefault(){return!0}set(o){(o!==this.current||this.dirty)&&(this.gl.depthMask(o),this.current=o,this.dirty=!1)}}class y0 extends ri{getDefault(){return 255}set(o){(o!==this.current||this.dirty)&&(this.gl.stencilMask(o),this.current=o,this.dirty=!1)}}class v0 extends ri{getDefault(){return{func:this.gl.ALWAYS,ref:0,mask:255}}set(o){const f=this.current;(o.func!==f.func||o.ref!==f.ref||o.mask!==f.mask||this.dirty)&&(this.gl.stencilFunc(o.func,o.ref,o.mask),this.current=o,this.dirty=!1)}}class b0 extends ri{getDefault(){const o=this.gl;return[o.KEEP,o.KEEP,o.KEEP]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||this.dirty)&&(this.gl.stencilOp(o[0],o[1],o[2]),this.current=o,this.dirty=!1)}}class $_ extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.STENCIL_TEST):f.disable(f.STENCIL_TEST),this.current=o,this.dirty=!1}}class x0 extends ri{getDefault(){return[0,1]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||this.dirty)&&(this.gl.depthRange(o[0],o[1]),this.current=o,this.dirty=!1)}}class G_ extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.DEPTH_TEST):f.disable(f.DEPTH_TEST),this.current=o,this.dirty=!1}}class rg extends ri{getDefault(){return this.gl.LESS}set(o){(o!==this.current||this.dirty)&&(this.gl.depthFunc(o),this.current=o,this.dirty=!1)}}class aa extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.BLEND):f.disable(f.BLEND),this.current=o,this.dirty=!1}}class es extends ri{getDefault(){const o=this.gl;return[o.ONE,o.ZERO,o.ONE,o.ZERO]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.blendFuncSeparate(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class fh extends ri{getDefault(){return s.am.transparent.toNonPremultipliedRenderColor(null)}set(o){const f=this.current;(o.r!==f.r||o.g!==f.g||o.b!==f.b||o.a!==f.a||this.dirty)&&(this.gl.blendColor(o.r,o.g,o.b,o.a),this.current=o,this.dirty=!1)}}class Eu extends ri{getDefault(){return this.gl.FUNC_ADD}set(o){(o!==this.current||this.dirty)&&(this.gl.blendEquationSeparate(o,o),this.current=o,this.dirty=!1)}}class eu extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;o?f.enable(f.CULL_FACE):f.disable(f.CULL_FACE),this.current=o,this.dirty=!1}}class Su extends ri{getDefault(){return this.gl.BACK}set(o){(o!==this.current||this.dirty)&&(this.gl.cullFace(o),this.current=o,this.dirty=!1)}}class Ea extends ri{getDefault(){return this.gl.CCW}set(o){(o!==this.current||this.dirty)&&(this.gl.frontFace(o),this.current=o,this.dirty=!1)}}let q_=class extends ri{getDefault(){return null}set(_){(_!==this.current||this.dirty)&&(this.gl.useProgram(_),this.current=_,this.dirty=!1)}};class id extends ri{getDefault(){return this.gl.TEXTURE0}set(o){(o!==this.current||this.dirty)&&(this.gl.activeTexture(o),this.current=o,this.dirty=!1)}}class W_ extends ri{getDefault(){const o=this.gl;return[0,0,o.drawingBufferWidth,o.drawingBufferHeight]}set(o){const f=this.current;(o[0]!==f[0]||o[1]!==f[1]||o[2]!==f[2]||o[3]!==f[3]||this.dirty)&&(this.gl.viewport(o[0],o[1],o[2],o[3]),this.current=o,this.dirty=!1)}}class Au extends ri{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindFramebuffer(f.FRAMEBUFFER,o),this.current=o,this.dirty=!1}}class Pp extends ri{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindRenderbuffer(f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class _f extends ri{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindTexture(f.TEXTURE_2D,o),this.current=o,this.dirty=!1}}class Y_ extends ri{getDefault(){return null}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.bindBuffer(f.ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class sg extends ri{getDefault(){return null}set(o){const f=this.gl;f.bindBuffer(f.ELEMENT_ARRAY_BUFFER,o),this.current=o,this.dirty=!1}}class kp extends ri{getDefault(){return null}set(o){this.gl&&(o!==this.current||this.dirty)&&(this.gl.bindVertexArray(o),this.current=o,this.dirty=!1)}}class w0 extends ri{getDefault(){return 4}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_ALIGNMENT,o),this.current=o,this.dirty=!1}}class T0 extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_PREMULTIPLY_ALPHA_WEBGL,o),this.current=o,this.dirty=!1}}class Z_ extends ri{getDefault(){return!1}set(o){if(o===this.current&&!this.dirty)return;const f=this.gl;f.pixelStorei(f.UNPACK_FLIP_Y_WEBGL,o),this.current=o,this.dirty=!1}}class Cu extends ri{constructor(o,f){super(o),this.context=o,this.parent=f}getDefault(){return null}}class X_ extends Cu{setDirty(){this.dirty=!0}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class E0 extends Cu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferRenderbuffer(f.FRAMEBUFFER,this.attachment(),f.RENDERBUFFER,o),this.current=o,this.dirty=!1}}class Vx extends Cu{attachment(){return this.gl.DEPTH_ATTACHMENT}set(o){if(o===this.current&&!this.dirty)return;this.context.bindFramebuffer.set(this.parent);const f=this.gl;f.framebufferTexture2D(f.FRAMEBUFFER,this.attachment(),f.TEXTURE_2D,o,0),this.current=o,this.dirty=!1}}class Ux extends E0{attachment(){return this.gl.DEPTH_STENCIL_ATTACHMENT}}const S0=(_,o,f)=>({u_matrix:_,u_image0:0,u_skirt_height:o,u_ground_shadow_factor:f}),og=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se)=>({u_proj_matrix:Float32Array.from(_),u_globe_matrix:o,u_normalize_matrix:Float32Array.from(y),u_merc_matrix:f,u_zoom_transition:w,u_merc_center:E,u_image0:0,u_frustum_tl:C,u_frustum_tr:M,u_frustum_br:N,u_frustum_bl:j,u_globe_pos:H,u_globe_radius:Z,u_viewport:W,u_grid_matrix:se?Float32Array.from(se):new Float32Array(9),u_skirt_height:Q,u_far_z_cutoff:ce});function ag(_,o){return _!=null&&o!=null&&!(!_.hasData()||!o.hasData())&&_.demTexture!=null&&o.demTexture!=null&&_.tileID.key!==o.tileID.key}const ph=new class{constructor(){this.operations={}}newMorphing(_,o,f,y,w){if(_ in this.operations){const E=this.operations[_];E.to.tileID.key!==f.tileID.key&&(E.queued=f)}else this.operations[_]={startTime:y,phase:0,duration:w,from:o,to:f,queued:null}}getMorphValuesForProxy(_){if(!(_ in this.operations))return null;const o=this.operations[_];return{from:o.from,to:o.to,phase:o.phase}}update(_){for(const o in this.operations){const f=this.operations[o];for(f.phase=(_-f.startTime)/f.duration;f.phase>=1||!this._validOp(f);)if(!this._nextOp(f,_)){delete this.operations[o];break}}}_nextOp(_,o){return!!_.queued&&(_.from=_.to,_.to=_.queued,_.queued=null,_.phase=0,_.startTime=o,!0)}_validOp(_){return _.from.hasData()&&_.to.hasData()}},lg={0:null,1:"TERRAIN_VERTEX_MORPHING"};function Q_(_,o,f){if(o===0)return 0;const y=o<1&&f===514?.25/o:1;return 6*Math.pow(1.5,22-_)*Math.max(o,1)*y}function jx(_,o){const f=1<<_.z;return!o&&(_.x===0||_.x===f-1)||_.y===0||_.y===f-1}const ac=_=>({u_matrix:_});function Du(_,o,f,y,w){if(w>0){const E=s.q.now(),C=(E-_.timeAdded)/w,M=o?(E-o.timeAdded)/w:-1,N=f.getSource(),j=y.coveringZoomLevel({tileSize:N.tileSize,roundZoom:N.roundZoom}),H=!o||Math.abs(o.tileID.overscaledZ-j)>Math.abs(_.tileID.overscaledZ-j),Z=H&&_.refreshedUponExpiration?1:s.ay(H?C:1-M,0,1);return _.refreshedUponExpiration&&C>=1&&(_.refreshedUponExpiration=!1),o?{opacity:1,mix:1-Z}:{opacity:Z,mix:0}}return{opacity:1,mix:0}}class A0 extends Bs{constructor(o){const f={type:"raster-dem",maxzoom:o.transform.maxZoom},y=new s.D(s.c$(),null),w=Zu("mock-dem",f,y,o.style);super("mock-dem",w,!1),w.setEventedParent(this),this._sourceLoaded=!0}_loadTile(o,f){o.state="loaded",f(null)}}class Ll extends Bs{constructor(o){const f=Zu("proxy",{type:"geojson",maxzoom:o.transform.maxZoom},new s.D(s.c$(),null),o.style);super("proxy",f,!1),f.setEventedParent(this),this.map=this.getSource().map=o,this.used=this._sourceLoaded=!0,this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}update(o,f,y){if(o.freezeTileCoverage)return;this.transform=o;const w=o.coveringTiles({tileSize:this._source.tileSize,minzoom:this._source.minzoom,maxzoom:this._source.maxzoom,roundZoom:this._source.roundZoom,reparseOverscaled:this._source.reparseOverscaled}).reduce((E,C)=>{if(E[C.key]="",!this._tiles[C.key]){const M=new Rl(C,this._source.tileSize*C.overscaleFactor(),o.tileZoom,void 0,void 0,this._source.worldview);M.state="loaded",this._tiles[C.key]=M}return E},{});for(const E in this._tiles)E in w||(this.freeFBO(E),this._tiles[E].unloadVectorData(),delete this._tiles[E])}freeFBO(o){const f=this.proxyCachedFBO[o];if(f!==void 0){const y=Object.values(f);this.renderCachePool.push(...y),delete this.proxyCachedFBO[o]}}deallocRenderCache(){this.renderCache.forEach(o=>o.fb.destroy()),this.renderCache=[],this.renderCachePool=[],this.proxyCachedFBO={}}}class yf extends s.aM{constructor(o,f,y){super(o.overscaledZ,o.wrap,o.canonical.z,o.canonical.x,o.canonical.y),this.proxyTileKey=f,this.projMatrix=y}}class Ru extends s.dt{constructor(o,f){super(),this._debugParams={sortTilesHiZFirst:!0,disableRenderCache:!1},o.tp.registerParameter(this._debugParams,["Terrain"],"sortTilesHiZFirst",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerParameter(this._debugParams,["Terrain"],"disableRenderCache",{},()=>{this._style.map.triggerRepaint()}),o.tp.registerButton(["Terrain"],"Invalidate Render Cache",()=>{this.invalidateRenderCache=!0,this._style.map.triggerRepaint()}),this.painter=o,this.terrainTileForTile={},this.prevTerrainTileForTile={};const[y,w,E]=function(N){const j=new s.ba,H=new s.a_,Z=131;j.reserve(17161),H.reserve(33800);const W=s.aj/128,Q=s.aj+W/2,ce=Q+W;for(let ue=-64;ue<ce;ue+=W)for(let pe=-64;pe<ce;pe+=W){const ge=pe<0||pe>Q||ue<0||ue>Q?24575:0,Pe=s.ay(Math.round(pe),0,s.aj),Ve=s.ay(Math.round(ue),0,s.aj);j.emplaceBack(Pe+ge,Ve)}const se=(ue,pe)=>{const ge=pe*Z+ue;H.emplaceBack(ge+1,ge,ge+Z),H.emplaceBack(ge+Z,ge+Z+1,ge+1)};for(let ue=1;ue<129;ue++)for(let pe=1;pe<129;pe++)se(pe,ue);return[0,129].forEach(ue=>{for(let pe=0;pe<130;pe++)se(pe,ue),se(ue,pe)}),[j,H,32768]}(),C=o.context;this.gridBuffer=C.createVertexBuffer(y,s.bc.members),this.gridIndexBuffer=C.createIndexBuffer(w),this.gridSegments=s.bd.simpleSegment(0,0,y.length,w.length),this.gridNoSkirtSegments=s.bd.simpleSegment(0,0,y.length,E),this.proxyCoords=[],this.proxiedCoords={},this._visibleDemTiles=[],this._drapedRenderBatches=[],this._sourceTilesOverlap={},this.proxySourceCache=new Ll(f.map),this.orthoMatrix=s.bz(),s.c5(this.orthoMatrix,this.painter.transform.projection.name==="globe"?.015:0,s.aj,0,s.aj,0,1);const M=C.gl;this._overlapStencilMode=new Hn({func:M.GEQUAL,mask:255},0,255,M.KEEP,M.KEEP,M.REPLACE),this._previousZoom=o.transform.zoom,this.pool=[],this._findCoveringTileCache={},this._tilesDirty={},this.style=f,this._useVertexMorphing=!0,this._exaggeration=1,this._mockSourceCache=new A0(f.map),this._pendingGroundEffectLayers=[]}set style(o){o.on("data",this._onStyleDataEvent.bind(this)),this._style=o,this._style.map.on("moveend",()=>{this._clearLineLayersFromRenderCache()})}update(o,f,y){if(o&&o.terrain){this._style!==o&&(this.style=o,this._evaluationZoom=void 0);const w=o.terrain.properties,E=o.terrain.drapeRenderMode===0,C=o.terrain.isZoomDependent();this._previousUpdateTimestamp=this.enabled?this._updateTimestamp:void 0,this._updateTimestamp=s.q.now();const M=o.terrain&&o.terrain.scope,N=w.get("source"),j=E?this._mockSourceCache:o.getSourceCache(N,M);if(!j)return void s.w(`Couldn't find terrain source "${N}".`);if(this.sourceCache=j,this._attenuationRange=o.terrain.getAttenuationRange(),this._exaggeration=C?this.calculateExaggeration(f):w.get("exaggeration"),!f.projection.requiresDraping&&C&&this._exaggeration===0)return void this._disable();this.enabled=!0;const H=()=>{this.sourceCache.used&&s.w(`Raster DEM source '${this.sourceCache.id}' is used both for terrain and as layer source.
This leads to lower resolution of hillshade. For full hillshade resolution but higher memory consumption, define another raster DEM source.`);const Z=this.getScaledDemTileSize();this.sourceCache.update(f,Z,!0),this.resetTileLookupCache(this.sourceCache.id)};this.sourceCache.usedForTerrain||(this.resetTileLookupCache(this.sourceCache.id),this.sourceCache.usedForTerrain=!0,H(),this._initializing=!0),H(),f.updateElevation(!0,y),this.resetTileLookupCache(this.proxySourceCache.id),this.proxySourceCache.update(f),this._emptyDEMTextureDirty=!0,this._previousZoom=f.zoom}else this._disable()}calculateExaggeration(o){if(this._attenuationRange&&o.zoom>=Math.ceil(this._attenuationRange[1]))return this._style.terrain.getExaggeration(o.zoom);const f=this._previousCameraAltitude,y=o.getFreeCameraOptions().position.z/o.pixelsPerMeter*o.worldSize;this._previousCameraAltitude=y;const w=f!=null?y-f:Number.MAX_VALUE;if(Math.abs(w)<2)return this._exaggeration;const E=o.zoom,C=this._style.terrain;if(!this._previousUpdateTimestamp)return C.getExaggeration(E);let M=E-this._previousZoom;const N=this._previousUpdateTimestamp;let j=E;this._evaluationZoom!=null&&(j=this._evaluationZoom,Math.abs(E-j)>.5&&(M=.5*(E-j+M)),M*w<0&&(j+=M)),this._evaluationZoom=j;const H=C.getExaggeration(j),Z=H===C.getExaggeration(Math.max(0,j-.1));if(Z&&Math.abs(H-this._exaggeration)<.01)return H;let W=Math.min(.1,.00375*(this._updateTimestamp-N));return(Z||H<.1||Math.abs(M)<1e-4)&&(W=Math.min(.2,4*W)),s.ai(this._exaggeration,H,W)}resetTileLookupCache(o){this._findCoveringTileCache[o]={}}attenuationRange(){return this._attenuationRange}getDemUpscale(){return this.proxySourceCache.getSource().tileSize/128}getScaledDemTileSize(){return this.sourceCache.getSource().tileSize/128*this.proxySourceCache.getSource().tileSize}_onStyleDataEvent(o){o.coord&&o.dataType==="source"?this._clearRenderCacheForTile(o.sourceCacheId,o.coord):o.dataType==="style"&&(this.invalidateRenderCache=!0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this._previousCameraAltitude=void 0)}_disable(){if(this.enabled&&(this.enabled=!1,this._emptyDEMTextureDirty=!0,this._sharedDepthStencil=void 0,this._evaluationZoom=void 0,this._previousUpdateTimestamp=void 0,this.proxySourceCache.deallocRenderCache(),this._style))for(const o in this._style._mergedSourceCaches)this._style._mergedSourceCaches[o].usedForTerrain=!1}destroy(){this._disable(),this._emptyDEMTexture&&this._emptyDEMTexture.destroy(),this.pool.forEach(o=>o.fb.destroy()),this.pool=[],this.framebufferCopyTexture&&this.framebufferCopyTexture.destroy()}_source(){return this.enabled?this.sourceCache:null}isUsingMockSource(){return this.sourceCache===this._mockSourceCache}exaggeration(){return this.enabled?this._exaggeration:0}get visibleDemTiles(){return this._visibleDemTiles}get drapeBufferSize(){const o=2*this.proxySourceCache.getSource().tileSize;return[o,o]}set useVertexMorphing(o){this._useVertexMorphing=o}updateTileBinding(o){if(!this.enabled)return;this.prevTerrainTileForTile=this.terrainTileForTile;const f=this.proxySourceCache,y=this.painter.transform;this._initializing&&(this._initializing=y._centerAltitude===0&&this.getAtPointOrZero(s.ac.fromLngLat(y.center),-1)===-1,this._emptyDEMTextureDirty=!this._initializing);const w=this.proxyCoords=f.getIds().map(N=>{const j=f.getTileByID(N).tileID;return j.projMatrix=y.calculateProjMatrix(j.toUnwrapped()),j});(function(N,j){const H=j.transform.pointCoordinate(j.transform.getCameraPoint()),Z=new s.P(H.x,H.y);N.sort((W,Q)=>{if(Q.overscaledZ-W.overscaledZ)return Q.overscaledZ-W.overscaledZ;const ce=new s.P(W.canonical.x+(1<<W.canonical.z)*W.wrap,W.canonical.y),se=new s.P(Q.canonical.x+(1<<Q.canonical.z)*Q.wrap,Q.canonical.y),ue=Z.mult(1<<W.canonical.z);return ue.x-=.5,ue.y-=.5,ue.distSqr(ce)-ue.distSqr(se)})})(w,this.painter);const E=this.proxyToSource||{};this.proxyToSource={},w.forEach(N=>{this.proxyToSource[N.key]={}}),this.terrainTileForTile={};const C=this._style._mergedSourceCaches;for(const N in C){const j=C[N];if(!j.used||(j!==this.sourceCache&&this.resetTileLookupCache(j.id),this._setupProxiedCoordsForOrtho(j,o[N],E),j.usedForTerrain))continue;const H=o[N];j.getSource().reparseOverscaled&&this._assignTerrainTiles(H)}this.proxiedCoords[f.id]=w.map(N=>new yf(N,N.key,this.orthoMatrix)),this._assignTerrainTiles(w),this._prepareDEMTextures(),this._setupDrapedRenderBatches(),this._initFBOPool(),this._setupRenderCache(E),this.renderingToTexture=!1;const M={};this._visibleDemTiles=[];for(const N of this.proxyCoords){const j=this.terrainTileForTile[N.key];if(!j)continue;const H=j.tileID.key;H in M||(this._visibleDemTiles.push(j),M[H]=H)}}_assignTerrainTiles(o){this._initializing||o.forEach(f=>{if(this.terrainTileForTile[f.key])return;const y=this._findTileCoveringTileID(f,this.sourceCache);y&&(this.terrainTileForTile[f.key]=y)})}_prepareDEMTextures(){const o=this.painter.context,f=o.gl;for(const y in this.terrainTileForTile){const w=this.terrainTileForTile[y],E=w.dem;!E||w.demTexture&&!w.needsDEMTextureUpload||(o.activeTexture.set(f.TEXTURE1),Mp(this.painter,w,E))}}_prepareDemTileUniforms(o,f,y,w){if(!f||f.demTexture==null)return!1;const E=o.tileID.canonical,C=Math.pow(2,f.tileID.canonical.z-E.z),M=w||"";return y[`u_dem_tl${M}`]=[E.x*C%1,E.y*C%1],y[`u_dem_scale${M}`]=C,!0}get emptyDEMTexture(){return!this._emptyDEMTextureDirty&&this._emptyDEMTexture?this._emptyDEMTexture:this._updateEmptyDEMTexture()}_getLoadedAreaMinimum(){if(!this.enabled)return 0;let o=0;const f=this._visibleDemTiles.reduce((y,w)=>{if(!w.dem)return y;const E=w.dem.tree.minimums[0];return E>0&&o++,y+E},0);return o?f/o:0}_updateEmptyDEMTexture(){const o=this.painter.context,f=o.gl;o.activeTexture.set(f.TEXTURE2);const y=this._getLoadedAreaMinimum(),w=new s.du({width:1,height:1},new Float32Array([y]));this._emptyDEMTextureDirty=!1;let E=this._emptyDEMTexture;return E?E.update(w,{premultiply:!1}):E=this._emptyDEMTexture=new s.T(o,w,f.R32F,{premultiply:!1}),E}setupElevationDraw(o,f,y){const w=this.painter.context,E=w.gl,C={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0};C.u_exaggeration=this.exaggeration();let M=null,N=null,j=1;if(y&&y.morphing&&this._useVertexMorphing){const Q=y.morphing.srcDemTile,ce=y.morphing.dstDemTile;j=y.morphing.phase,Q&&ce&&(this._prepareDemTileUniforms(o,Q,C,"_prev")&&(N=Q),this._prepareDemTileUniforms(o,ce,C)&&(M=ce))}const H=Q=>Q&&Q.demTexture&&this.painter.linearFloatFilteringSupported()?E.LINEAR:E.NEAREST;let Z=null;var W;if(this.enabled?N&&M?(Z=M.demTexture,w.activeTexture.set(E.TEXTURE4),N.demTexture.bind(H(N),E.CLAMP_TO_EDGE),C.u_dem_lerp=j):(M=this.terrainTileForTile[o.tileID.key],Z=this._prepareDemTileUniforms(o,M,C)?M.demTexture:this.emptyDEMTexture):Z=this.emptyDEMTexture,w.activeTexture.set(E.TEXTURE2),Z&&(C.u_dem_size=(W=Z).size[0]===1?1:W.size[0]-2,Z.bind(H(M),E.CLAMP_TO_EDGE)),this.painter.setupDepthForOcclusion(y&&y.useDepthForOcclusion,f,C),y&&y.useMeterToDem&&M){const Q=(1<<M.tileID.canonical.z)*s.c6(1,this.painter.transform.center.lat)*this.sourceCache.getSource().tileSize;C.u_meter_to_dem=Q}if(y&&y.labelPlaneMatrixInv&&(C.u_label_plane_matrix_inv=y.labelPlaneMatrixInv),f.setTerrainUniformValues(w,C),this.painter.transform.projection.name==="globe"){const Q=this.globeUniformValues(this.painter.transform,o.tileID.canonical,y&&y.useDenormalizedUpVectorScale);f.setGlobeUniformValues(w,Q)}}globeUniformValues(o,f,y){const w=o.projection;return{u_tile_tl_up:w.upVector(f,0,0),u_tile_tr_up:w.upVector(f,s.aj,0),u_tile_br_up:w.upVector(f,s.aj,s.aj),u_tile_bl_up:w.upVector(f,0,s.aj),u_tile_up_scale:y?s.dv(1):w.upVectorScale(f,o.center.lat,o.worldSize).metersToTile}}renderToBackBuffer(o){const f=this.painter,y=this.painter.context;o.length!==0&&(y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),f.gpuTimingDeferredRenderStart(),this.renderingToTexture=!1,function(w,E,C,M,N){if(w.transform.projection.name==="globe")(function(j,H,Z,W,Q){const ce=j.context,se=ce.gl;let ue,pe;const ge=j.transform,Pe=s.dl(j,ce,ge),Ve=(Mt,Rt)=>{if(pe===Rt)return;const jt=[lg[Rt],"PROJECTION_GLOBE_VIEW"];Pe&&jt.push("CUSTOM_ANTIALIASING");const ht=j.isTileAffectedByFog(Mt);ue=j.getOrCreateProgram("globeRaster",{defines:jt,overrideFog:ht}),pe=Rt},Ye=j.colorModeForRenderPass(),qe=new an(se.LEQUAL,an.ReadWrite,j.depthRangeFor3D);ph.update(Q);const je=s.dm(ge),Ue=[s.aD(ge.center.lng),s.aH(ge.center.lat)],We=j.globeSharedBuffers,et=[ge.width*s.q.devicePixelRatio,ge.height*s.q.devicePixelRatio],_t=Float32Array.from(ge.globeMatrix),ft={useDenormalizedUpVectorScale:!0};{const Mt=j.transform,Rt=Q_(Mt.zoom,H.exaggeration(),H.sourceCache._source.tileSize);pe=-1;const jt=se.TRIANGLES;for(const ht of W){const Dt=Z.getTile(ht),ot=Hn.disabled,At=H.prevTerrainTileForTile[ht.key],Tt=H.terrainTileForTile[ht.key];ag(At,Tt)&&ph.newMorphing(ht.key,At,Tt,Q,250),ce.activeTexture.set(se.TEXTURE0),Dt.texture&&Dt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Nt=ph.getMorphValuesForProxy(ht.key),Yt=Nt?1:0;Nt&&s.L(ft,{morphing:{srcDemTile:Nt.from,dstDemTile:Nt.to,phase:s.dk(Nt.phase)}});const Pt=s.dn(ht.canonical),qt=s.dp(Pt.getCenter().lat),bn=s.dq(ht.canonical,Pt,qt,Mt.worldSize/Mt._pixelsPerMercatorPixel),fn=s.bh(s.dr(ht.canonical)),pn=og(Mt.expandedFarZProjMatrix,_t,je,fn,s.ah(Mt.zoom),Ue,Mt.frustumCorners.TL,Mt.frustumCorners.TR,Mt.frustumCorners.BR,Mt.frustumCorners.BL,Mt.globeCenterInViewSpace,Mt.globeRadius,et,Rt,Mt._farZ,bn);if(Ve(ht,Yt),ue&&(H.setupElevationDraw(Dt,ue,ft),j.uploadCommonUniforms(ce,ue,ht.toUnwrapped()),We)){const[Rn,Nn,Bn]=We.getGridBuffers(qt,Rt!==0);ue.draw(j,jt,qe,ot,Ye,Un.backCCW,pn,"globe_raster",Rn,Nn,Bn)}}}if(We&&(j.renderDefaultNorthPole||j.renderDefaultSouthPole)){const Mt=["GLOBE_POLES","PROJECTION_GLOBE_VIEW"];Pe&&Mt.push("CUSTOM_ANTIALIASING"),ue=j.getOrCreateProgram("globeRaster",{defines:Mt});for(const Rt of W){const{x:jt,y:ht,z:Dt}=Rt.canonical,ot=ht===0,At=ht===(1<<Dt)-1,[Tt,Nt,Yt,Pt]=We.getPoleBuffers(Dt,!1);if(Pt&&(ot||At)){const qt=Z.getTile(Rt);ce.activeTexture.set(se.TEXTURE0),qt.texture&&qt.texture.bind(se.LINEAR,se.CLAMP_TO_EDGE);let bn=s.ds(Dt,jt,ge);const fn=s.bh(s.dr(Rt.canonical)),pn=(Rn,Nn)=>Rn.draw(j,se.TRIANGLES,qe,Hn.disabled,Ye,Un.disabled,og(ge.expandedFarZProjMatrix,bn,bn,fn,0,Ue,ge.frustumCorners.TL,ge.frustumCorners.TR,ge.frustumCorners.BR,ge.frustumCorners.BL,ge.globeCenterInViewSpace,ge.globeRadius,et,0,ge._farZ),"globe_pole_raster",Nn,Yt,Pt);H.setupElevationDraw(qt,ue,ft),j.uploadCommonUniforms(ce,ue,Rt.toUnwrapped()),ot&&j.renderDefaultNorthPole&&pn(ue,Tt),At&&j.renderDefaultSouthPole&&(bn=s.cE(s.bz(),bn,[1,-1,1]),pn(ue,Nt))}}}})(w,E,C,M,N);else{const j=w.context,H=j.gl;let Z,W;const Q=w.shadowRenderer,ce=oa(w,w.longestCutoffRange),se=Ye=>{if(W===Ye)return;const qe=[];qe.push(lg[Ye]),ce.shouldRenderCutoff&&qe.push("RENDER_CUTOFF"),Q&&(qe.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&qe.push("NORMAL_OFFSET")),Z=w.getOrCreateProgram("terrainRaster",{defines:qe}),W=Ye},ue=w.colorModeForRenderPass(),pe=new an(H.LEQUAL,an.ReadWrite,w.depthRangeFor3D);ph.update(N);const ge=w.transform,Pe=Q_(ge.zoom,E.exaggeration(),E.sourceCache._source.tileSize);let Ve=[0,0,0];if(Q){const Ye=w.style.directionalLight,qe=w.style.ambientLight;Ye&&qe&&(Ve=as(w.style,Ye,qe))}{W=-1;const Ye=H.TRIANGLES,[qe,je]=[E.gridIndexBuffer,E.gridSegments];for(const Ue of M){const We=C.getTile(Ue),et=Hn.disabled,_t=E.prevTerrainTileForTile[Ue.key],ft=E.terrainTileForTile[Ue.key];ag(_t,ft)&&ph.newMorphing(Ue.key,_t,ft,N,250),j.activeTexture.set(H.TEXTURE0),We.texture&&We.texture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const Mt=ph.getMorphValuesForProxy(Ue.key),Rt=Mt?1:0;let jt;Mt&&(jt={morphing:{srcDemTile:Mt.from,dstDemTile:Mt.to,phase:s.dk(Mt.phase)}});const ht=S0(Ue.projMatrix,jx(Ue.canonical,ge.renderWorldCopies)?Pe/10:Pe,Ve);if(se(Rt),!Z)continue;E.setupElevationDraw(We,Z,jt);const Dt=Ue.toUnwrapped();Q&&Q.setupShadows(Dt,Z),w.uploadCommonUniforms(j,Z,Dt,null,ce),Z.draw(w,Ye,pe,et,ue,Un.backCCW,ht,"terrain_raster",E.gridBuffer,qe,je)}}}}(f,this,this.proxySourceCache,o,this._updateTimestamp),this.renderingToTexture=!0,f.gpuTimingDeferredRenderEnd(),o.splice(0,o.length))}renderBatch(o){if(this._drapedRenderBatches.length===0)return o+1;this.renderingToTexture=!0;const f=this.painter,y=this.painter.context,w=this.proxySourceCache,E=this.proxiedCoords[w.id],C=this._drapedRenderBatches.shift(),M=f.style.order,N=[];let j=0;for(const H of E){const Z=w.getTileByID(H.proxyTileKey),W=w.proxyCachedFBO[H.key]?w.proxyCachedFBO[H.key][o]:void 0,Q=W!==void 0?w.renderCache[W]:this.pool[j++],ce=W!==void 0;if(Z.texture=Q.tex,ce&&!Q.dirty){N.push(Z.tileID);continue}let se;y.bindFramebuffer.set(Q.fb.framebuffer),this.renderedToTile=!1,Q.dirty&&(y.clear({color:s.am.transparent,stencil:0}),Q.dirty=!1);for(let ue=C.start;ue<=C.end;++ue){const pe=f.style._mergedLayers[M[ue]];if(pe.isHidden(f.transform.zoom))continue;const ge=f.style.getLayerSourceCache(pe),Pe=ge?this.proxyToSource[H.key][ge.id]:[H];if(!Pe)continue;const Ve=Pe;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),se!==(ge?ge.id:null)&&(this._setupStencil(Q,Pe,pe,ge),se=ge?ge.id:null),f.renderLayer(f,ge,pe,Ve)}if(this._drapedRenderBatches.length===0)for(const ue of this._pendingGroundEffectLayers){const pe=f.style._mergedLayers[M[ue]];if(pe.isHidden(f.transform.zoom))continue;const ge=f.style.getLayerSourceCache(pe),Pe=ge?this.proxyToSource[H.key][ge.id]:[H];if(!Pe)continue;const Ve=Pe;y.viewport.set([0,0,Q.fb.width,Q.fb.height]),se!==(ge?ge.id:null)&&(this._setupStencil(Q,Pe,pe,ge),se=ge?ge.id:null),f.renderLayer(f,ge,pe,Ve)}this.renderedToTile?(Q.dirty=!0,N.push(Z.tileID)):ce||--j,j===5&&(j=0,this.renderToBackBuffer(N))}return this.renderToBackBuffer(N),this.renderingToTexture=!1,y.bindFramebuffer.set(null),y.viewport.set([0,0,f.width,f.height]),C.end+1}postRender(){}isLayerOrderingCorrect(o){const f=o.order.length;let y=-1,w=f;for(let E=0;E<f;++E)this._style.isLayerDraped(o._mergedLayers[o.order[E]])?y=Math.max(y,E):w=Math.min(w,E);return w>y}getMinElevationBelowMSL(){let o=0;return this._visibleDemTiles.filter(f=>f.dem).forEach(f=>{o=Math.min(o,f.dem.tree.minimums[0])}),o===0?o:(o-30)*this._exaggeration}raycast(o,f,y){if(!this._visibleDemTiles)return null;const w=this._visibleDemTiles.filter(E=>E.dem).map(E=>{const C=E.tileID,M=1<<C.overscaledZ,{x:N,y:j}=C.canonical,H=N/M,Z=(N+1)/M,W=j/M,Q=(j+1)/M;return{minx:H,miny:W,maxx:Z,maxy:Q,t:E.dem.tree.raycastRoot(H,W,Z,Q,o,f,y),tile:E}});w.sort((E,C)=>(E.t!==null?E.t:Number.MAX_VALUE)-(C.t!==null?C.t:Number.MAX_VALUE));for(const E of w){if(E.t==null)return null;const C=E.tile.dem.tree.raycast(E.minx,E.miny,E.maxx,E.maxy,o,f,y);if(C!=null)return C}return null}_createFBO(){const o=this.painter.context,f=o.gl,y=this.drapeBufferSize;o.activeTexture.set(f.TEXTURE0);const w=new s.T(o,{width:y[0],height:y[1],data:null},f.RGBA8);w.bind(f.LINEAR,f.CLAMP_TO_EDGE);const E=o.createFramebuffer(y[0],y[1],!0,null);return E.colorAttachment.set(w.texture),E.depthAttachment=new Ux(o,E.framebuffer),this._sharedDepthStencil===void 0?(this._sharedDepthStencil=o.createRenderbuffer(o.gl.DEPTH_STENCIL,y[0],y[1]),this._stencilRef=0,E.depthAttachment.set(this._sharedDepthStencil),o.clear({stencil:0})):E.depthAttachment.set(this._sharedDepthStencil),o.extTextureFilterAnisotropic&&f.texParameterf(f.TEXTURE_2D,o.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,o.extTextureFilterAnisotropicMax),{fb:E,tex:w,dirty:!1}}_initFBOPool(){for(;this.pool.length<Math.min(5,this.proxyCoords.length);)this.pool.push(this._createFBO())}_shouldDisableRenderCache(){if(this._debugParams.disableRenderCache||this._style.hasLightTransitions())return!0;for(const o in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[o].hasTransition())return!0;return this._style.order.some(o=>{const f=this._style._mergedLayers[o],y=f.isHidden(this.painter.transform.zoom);return f.type==="hillshade"||f.type==="custom"?!y&&f.shouldRedrape():!y&&f.hasTransition()})}_clearLineLayersFromRenderCache(){let o=!1;for(const y of this._style.getSources())if(y instanceof Ua){o=!0;break}if(!o)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],E=this._style.getLayerSourceCache(w);if(E&&!f[E.id]&&!w.isHidden(this.painter.transform.zoom)&&w.type==="line"&&w.widthExpression()instanceof s.ab){f[E.id]=!0;for(const C of this.proxyCoords){const M=this.proxyToSource[C.key][E.id];if(M)for(const N of M)this._clearRenderCacheForTile(E.id,N)}}}}_clearRasterLayersFromRenderCache(){let o=!1;for(const y in this._style._mergedSourceCaches)if(this._style._mergedSourceCaches[y]._source instanceof Ws){o=!0;break}if(!o)return;const f={};for(let y=0;y<this._style.order.length;++y){const w=this._style._mergedLayers[this._style.order[y]],E=this._style.getLayerSourceCache(w);if(!E||f[E.id]||w.isHidden(this.painter.transform.zoom)||w.type!=="raster")continue;const C=w.paint.get("raster-fade-duration");for(const M of this.proxyCoords){const N=this.proxyToSource[M.key][E.id];if(N)for(const j of N){const H=Du(E.getTile(j),E.findLoadedParent(j,0),E,this.painter.transform,C);(H.opacity!==1||H.mix!==0)&&this._clearRenderCacheForTile(E.id,j)}}}}_setupDrapedRenderBatches(){this._style.updateDrapeFirstLayers();const o=this._style.order,f=o.length;if(f===0)return;const y=[];this._pendingGroundEffectLayers=[];let w,E=0,C=this._style._mergedLayers[o[E]];for(;!this._style.isLayerDraped(C)&&C.isHidden(this.painter.transform.zoom)&&++E<f;)C=this._style._mergedLayers[o[E]];for(;E<f;++E){const M=this._style._mergedLayers[o[E]];M.isHidden(this.painter.transform.zoom)||(this._style.isLayerDraped(M)?w===void 0&&(w=E):(M.type==="fill-extrusion"&&this._pendingGroundEffectLayers.push(E),w!==void 0&&(y.push({start:w,end:E-1}),w=void 0)))}if(w!==void 0&&y.push({start:w,end:E-1}),y.length!==0){const M=y[y.length-1];this._pendingGroundEffectLayers.every(N=>N>M.end)||s.w("fill-extrusion with flood lighting and/or ground ambient occlusion should be moved to be on top of all draped layers.")}this._drapedRenderBatches=y}_setupRenderCache(o){const f=this.proxySourceCache;if(this._shouldDisableRenderCache()||this.invalidateRenderCache){if(this.invalidateRenderCache=!1,f.renderCache.length>f.renderCachePool.length){const C=Object.values(f.proxyCachedFBO);f.proxyCachedFBO={};for(let M=0;M<C.length;++M){const N=Object.values(C[M]);f.renderCachePool.push(...N)}}return}this._clearRasterLayersFromRenderCache();const y=this.proxyCoords,w=this._tilesDirty;for(let C=y.length-1;C>=0;C--){const M=y[C];if(f.getTileByID(M.key),f.proxyCachedFBO[M.key]!==void 0){const N=o[M.key],j=this.proxyToSource[M.key];let H=0;for(const Z in j){const W=j[Z],Q=N[Z];if(!Q||Q.length!==W.length||W.some((ce,se)=>ce!==Q[se]||w[Z]&&w[Z].hasOwnProperty(ce.key))){H=-1;break}++H}for(const Z in f.proxyCachedFBO[M.key])f.renderCache[f.proxyCachedFBO[M.key][Z]].dirty=H<0||H!==Object.values(N).length}}const E=[...this._drapedRenderBatches];E.sort((C,M)=>M.end-M.start-(C.end-C.start));for(const C of E)for(const M of y){if(f.proxyCachedFBO[M.key])continue;let N=f.renderCachePool.pop();N===void 0&&f.renderCache.length<50&&(N=f.renderCache.length,f.renderCache.push(this._createFBO())),N!==void 0&&(f.proxyCachedFBO[M.key]={},f.proxyCachedFBO[M.key][C.start]=N,f.renderCache[N].dirty=!0)}this._tilesDirty={}}_setupStencil(o,f,y,w){if(!w||!this._sourceTilesOverlap[w.id])return void(this._overlapStencilType&&(this._overlapStencilType=!1));const E=this.painter.context,C=E.gl;if(f.length<=1)return void(this._overlapStencilType=!1);let M;if(y.isTileClipped())M=f.length,this._overlapStencilMode.test={func:C.EQUAL,mask:255},this._overlapStencilType="Clip";else{if(!(f[0].overscaledZ>f[f.length-1].overscaledZ))return void(this._overlapStencilType=!1);M=1,this._overlapStencilMode.test={func:C.GREATER,mask:255},this._overlapStencilType="Mask"}this._stencilRef+M>255&&(E.clear({stencil:0}),this._stencilRef=0),this._stencilRef+=M,this._overlapStencilMode.ref=this._stencilRef,y.isTileClipped()&&this._renderTileClippingMasks(f,this._overlapStencilMode.ref)}clipOrMaskOverlapStencilType(){return this._overlapStencilType==="Clip"||this._overlapStencilType==="Mask"}stencilModeForRTTOverlap(o){return this.renderingToTexture&&this._overlapStencilType?(this._overlapStencilType==="Clip"&&(this._overlapStencilMode.ref=this.painter._tileClippingMaskIDs[o.key]),this._overlapStencilMode):Hn.disabled}_renderTileClippingMasks(o,f){const y=this.painter,w=this.painter.context,E=w.gl;y._tileClippingMaskIDs={},w.setColorMode(kn.disabled),w.setDepthMode(an.disabled);const C=y.getOrCreateProgram("clippingMask");for(const M of o){const N=y._tileClippingMaskIDs[M.key]=--f;C.draw(y,E.TRIANGLES,an.disabled,new Hn({func:E.ALWAYS,mask:0},N,255,E.KEEP,E.KEEP,E.REPLACE),kn.disabled,Un.disabled,ac(M.projMatrix),"$clipping",y.tileExtentBuffer,y.quadTriangleIndexBuffer,y.tileExtentSegments)}}pointCoordinate(o){const f=this.painter.transform;if(o.x<0||o.x>f.width||o.y<0||o.y>f.height)return null;const y=[o.x,o.y,1,1];s.aA(y,y,f.pixelMatrixInverse),s.cw(y,y,1/y[3]),y[0]/=f.worldSize,y[1]/=f.worldSize;const w=f._camera.position,E=s.c6(1,f.center.lat),C=[w[0],w[1],w[2]/E,0],M=s.cX([],y.slice(0,3),C);s.au(M,M);const N=this.raycast(C,M,this._exaggeration);return N!==null&&N?(s.bE(C,C,M,N),C[3]=C[2],C[2]*=E,C):null}_setupProxiedCoordsForOrtho(o,f,y){if(o.getSource()instanceof s.aP)return this._setupProxiedCoordsForImageSource(o,f,y);this._findCoveringTileCache[o.id]=this._findCoveringTileCache[o.id]||{};const w=this.proxiedCoords[o.id]=[],E=this.proxyCoords;for(let N=0;N<E.length;N++){const j=E[N],H=this._findTileCoveringTileID(j,o);if(H){const Z=this._createProxiedId(j,H,y[j.key]&&y[j.key][o.id]);w.push(Z),this.proxyToSource[j.key][o.id]=[Z]}}let C=!1;const M=new Set;for(let N=0;N<f.length;N++){const j=o.getTile(f[N]);if(!j||!j.hasData())continue;const H=this._findTileCoveringTileID(j.tileID,this.proxySourceCache);if(H&&H.tileID.canonical.z!==j.tileID.canonical.z){const Z=this.proxyToSource[H.tileID.key][o.id],W=this._createProxiedId(H.tileID,j,y[H.tileID.key]&&y[H.tileID.key][o.id]);Z?Z.splice(Z.length-1,0,W):this.proxyToSource[H.tileID.key][o.id]=[W];const Q=this.proxyToSource[H.tileID.key][o.id];M.has(Q)||M.add(Q),w.push(W),C=!0}}if(this._sourceTilesOverlap[o.id]=C,C&&this._debugParams.sortTilesHiZFirst)for(const N of M)N.sort((j,H)=>H.overscaledZ-j.overscaledZ)}_setupProxiedCoordsForImageSource(o,f,y){if(!o.getSource().loaded())return;const w=this.proxiedCoords[o.id]=[],E=this.proxyCoords,C=o.getSource(),M=C.tileID;if(!M)return;const N=new s.P(M.x,M.y)._div(1<<M.z),j=C.coordinates.map(s.ac.fromLngLat).reduce((Z,W)=>(Z.min.x=Math.min(Z.min.x,W.x-N.x),Z.min.y=Math.min(Z.min.y,W.y-N.y),Z.max.x=Math.max(Z.max.x,W.x-N.x),Z.max.y=Math.max(Z.max.y,W.y-N.y),Z),{min:new s.P(Number.MAX_VALUE,Number.MAX_VALUE),max:new s.P(-Number.MAX_VALUE,-Number.MAX_VALUE)}),H=(Z,W)=>{const Q=Z.wrap+Z.canonical.x/(1<<Z.canonical.z),ce=Z.canonical.y/(1<<Z.canonical.z),se=s.aj/(1<<Z.canonical.z),ue=W.wrap+W.canonical.x/(1<<W.canonical.z),pe=W.canonical.y/(1<<W.canonical.z);return Q+se<ue+j.min.x||Q>ue+j.max.x||ce+se<pe+j.min.y||ce>pe+j.max.y};for(let Z=0;Z<E.length;Z++){const W=E[Z];for(let Q=0;Q<f.length;Q++){const ce=o.getTile(f[Q]);if(!ce||!ce.hasData()||H(W,ce.tileID))continue;const se=this._createProxiedId(W,ce,y[W.key]&&y[W.key][o.id]),ue=this.proxyToSource[W.key][o.id];ue?ue.push(se):this.proxyToSource[W.key][o.id]=[se],w.push(se)}}}_createProxiedId(o,f,y){let w=this.orthoMatrix;if(y){const E=y.find(C=>C.key===f.tileID.key);if(E)return E}if(f.tileID.key!==o.key){const E=o.canonical.z-f.tileID.canonical.z;let C,M,N;w=s.bz();const j=f.tileID.wrap-o.wrap<<o.overscaledZ;E>0?(C=s.aj>>E,M=C*((f.tileID.canonical.x<<E)-o.canonical.x+j),N=C*((f.tileID.canonical.y<<E)-o.canonical.y)):(C=s.aj<<-E,M=s.aj*(f.tileID.canonical.x-(o.canonical.x+j<<-E)),N=s.aj*(f.tileID.canonical.y-(o.canonical.y<<-E))),s.c5(w,0,C,0,C,0,1),s.bo(w,w,[M,N,0])}return new yf(f.tileID,o.key,w)}_findTileCoveringTileID(o,f){let y=f.getTile(o);if(y&&y.hasData())return y;const w=this._findCoveringTileCache[f.id],E=w[o.key];if(y=E?f.getTileByID(E):null,y&&y.hasData()||E===null)return y;let C=y?y.tileID:o,M=C.overscaledZ;const N=f.getSource().minzoom,j=[];if(!E){const Z=f.getSource().maxzoom;if(o.canonical.z>=Z){const W=o.canonical.z-Z;f.getSource().reparseOverscaled?(M=Math.max(o.canonical.z+2,f.transform.tileZoom),C=new s.aM(M,o.wrap,Z,o.canonical.x>>W,o.canonical.y>>W)):W!==0&&(M=Z,C=new s.aM(M,o.wrap,Z,o.canonical.x>>W,o.canonical.y>>W))}C.key!==o.key&&(j.push(C.key),y=f.getTile(C))}const H=Z=>{j.forEach(W=>{w[W]=Z}),j.length=0};for(M-=1;M>=N&&(!y||!y.hasData());M--){y&&H(y.tileID.key);const Z=C.calculateScaledKey(M);if(y=f.getTileByID(Z),y&&y.hasData())break;const W=w[Z];if(W===null)break;W===void 0?j.push(Z):y=f.getTileByID(W)}return H(y?y.tileID.key:null),y&&y.hasData()?y:null}findDEMTileFor(o){return this.enabled?this._findTileCoveringTileID(o,this.sourceCache):null}prepareDrawTile(){this.renderedToTile=!0}_clearRenderCacheForTile(o,f){let y=this._tilesDirty[o];y||(y=this._tilesDirty[o]={}),y[f.key]=!0}}function vf(_,o,f){const y=function(M,N,j){const H=s.bG(N,M),Z=s.bG(j,[.2126,.7152,.0722]),W=(ce,se,ue)=>(1-ue)*ce+ue*se,Q=W(1-.3*Math.min(Z,1),1,Math.min(H+1,1));return W(.92,1,Math.asin(s.ay(N[2],-1,1))/Math.PI+.5)*Q}(_,[0,0,1],o),w=[0,0,0];s.bY(w,f.slice(0,3),y);const E=[0,0,0];s.bY(E,o.slice(0,3),_[2]);const C=[0,0,0];return s.cV(C,w,E),s.cY(C)}const cg=["fill","fillOutline","fillPattern","line","linePattern","background","backgroundPattern","hillshade","raster"],mh=["stars","rainParticle","snowParticle","fillExtrusion","fillExtrusionGroundEffect","elevatedStructures","model","symbol"];class la{static cacheKey(o,f,y,w){let E=`${f}${w?w.cacheKey:""}`;for(const C of y)o.usedDefines.includes(C)&&(E+=`/${C}`);return E}constructor(o,f,y,w,E,C){const M=o.gl;this.program=M.createProgram(),this.configuration=w,this.name=f,this.fixedDefines=[...C];const N=w?w.getBinderAttributes():[],j=(y.staticAttributes||[]).concat(N);let H=w?w.defines():[];H=H.concat(C.map(ue=>`#define ${ue}`));const Z=`#version 300 es
`;let W=Z+H.concat("precision mediump float;",Nl,dh.fragmentSource).join(`
`);for(const ue of y.fragmentIncludes)W+=`
${kl[ue]}`;W+=`
${y.fragmentSource}`;let Q=Z+H.concat("precision highp float;",Nl,dh.vertexSource).join(`
`);for(const ue of y.vertexIncludes)Q+=`
${kl[ue]}`;this.forceManualRenderingForInstanceIDShaders=o.forceManualRenderingForInstanceIDShaders&&y.vertexSource.indexOf("gl_InstanceID")!==-1,this.forceManualRenderingForInstanceIDShaders&&(Q+=`
uniform int u_instanceID;
`),Q+=`
${y.vertexSource}`,this.forceManualRenderingForInstanceIDShaders&&(Q=Q.replaceAll("gl_InstanceID","u_instanceID"));const ce=M.createShader(M.FRAGMENT_SHADER);if(M.isContextLost())return void(this.failedToCreate=!0);M.shaderSource(ce,W),M.compileShader(ce),M.attachShader(this.program,ce);const se=M.createShader(M.VERTEX_SHADER);if(M.isContextLost())this.failedToCreate=!0;else{M.shaderSource(se,Q),M.compileShader(se),M.attachShader(this.program,se),this.attributes={},this.numAttributes=j.length;for(let ue=0;ue<this.numAttributes;ue++)if(j[ue]){const pe=j[ue].startsWith("a_")?j[ue]:`a_${j[ue]}`;M.bindAttribLocation(this.program,ue,pe),this.attributes[pe]=ue}M.linkProgram(this.program),M.deleteShader(se),M.deleteShader(ce),this.fixedUniforms=E(o),this.binderUniforms=w?w.getUniforms(o):[],this.forceManualRenderingForInstanceIDShaders&&(this.instancingUniforms=(ue=>({u_instanceID:new s.c8(ue)}))(o)),(C.includes("TERRAIN")||f.indexOf("symbol")!==-1||f.indexOf("circle")!==-1)&&(this.terrainUniforms=(ue=>({u_dem:new s.c8(ue),u_dem_prev:new s.c8(ue),u_dem_tl:new s.cb(ue),u_dem_scale:new s.ca(ue),u_dem_tl_prev:new s.cb(ue),u_dem_scale_prev:new s.ca(ue),u_dem_size:new s.ca(ue),u_dem_lerp:new s.ca(ue),u_exaggeration:new s.ca(ue),u_depth:new s.c8(ue),u_depth_size_inv:new s.cb(ue),u_depth_range_unpack:new s.cb(ue),u_occluder_half_size:new s.ca(ue),u_occlusion_depth_offset:new s.ca(ue),u_meter_to_dem:new s.ca(ue),u_label_plane_matrix_inv:new s.cc(ue)}))(o)),C.includes("GLOBE")&&(this.globeUniforms=(ue=>({u_tile_tl_up:new s.c9(ue),u_tile_tr_up:new s.c9(ue),u_tile_br_up:new s.c9(ue),u_tile_bl_up:new s.c9(ue),u_tile_up_scale:new s.ca(ue)}))(o)),C.includes("FOG")&&(this.fogUniforms=(ue=>({u_fog_matrix:new s.cc(ue),u_fog_range:new s.cb(ue),u_fog_color:new s.cQ(ue),u_fog_horizon_blend:new s.ca(ue),u_fog_vertical_limit:new s.cb(ue),u_fog_temporal_offset:new s.ca(ue),u_frustum_tl:new s.c9(ue),u_frustum_tr:new s.c9(ue),u_frustum_br:new s.c9(ue),u_frustum_bl:new s.c9(ue),u_globe_pos:new s.c9(ue),u_globe_radius:new s.ca(ue),u_globe_transition:new s.ca(ue),u_is_globe:new s.c8(ue),u_viewport:new s.cb(ue)}))(o)),C.includes("RENDER_CUTOFF")&&(this.cutoffUniforms=(ue=>({u_cutoff_params:new s.cQ(ue)}))(o)),C.includes("LIGHTING_3D_MODE")&&(this.lightsUniforms=(ue=>({u_lighting_ambient_color:new s.c9(ue),u_lighting_directional_dir:new s.c9(ue),u_lighting_directional_color:new s.c9(ue),u_ground_radiance:new s.c9(ue)}))(o)),C.includes("RENDER_SHADOWS")&&(this.shadowUniforms=(ue=>({u_light_matrix_0:new s.cc(ue),u_light_matrix_1:new s.cc(ue),u_fade_range:new s.cb(ue),u_shadow_normal_offset:new s.c9(ue),u_shadow_intensity:new s.ca(ue),u_shadow_texel_size:new s.ca(ue),u_shadow_map_resolution:new s.ca(ue),u_shadow_direction:new s.c9(ue),u_shadow_bias:new s.c9(ue),u_shadowmap_0:new s.c8(ue),u_shadowmap_1:new s.c8(ue)}))(o))}}setTerrainUniformValues(o,f){if(!this.terrainUniforms)return;const y=this.terrainUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setGlobeUniformValues(o,f){if(!this.globeUniforms)return;const y=this.globeUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)y[w]&&y[w].set(this.program,w,f[w])}}setFogUniformValues(o,f){if(!this.fogUniforms)return;const y=this.fogUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setCutoffUniformValues(o,f){if(!this.cutoffUniforms)return;const y=this.cutoffUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setLightsUniformValues(o,f){if(!this.lightsUniforms)return;const y=this.lightsUniforms;if(!this.failedToCreate){o.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}}setShadowUniformValues(o,f){if(this.failedToCreate||!this.shadowUniforms)return;const y=this.shadowUniforms;o.program.set(this.program);for(const w in f)y[w].set(this.program,w,f[w])}_drawDebugWireframe(o,f,y,w,E,C,M,N,j,H){const Z=o.options.wireframe;if(Z.terrain===!1&&Z.layers2D===!1&&Z.layers3D===!1)return;const W=o.context;if(!(!(!Z.terrain||this.name!=="terrainRaster"&&this.name!=="globeRaster")||!(!Z.layers2D||o._terrain&&o._terrain.renderingToTexture||!cg.includes(this.name))||!(!Z.layers3D||!mh.includes(this.name))))return;const Q=W.gl,ce=o.wireframeDebugCache.getLinesFromTrianglesBuffer(o.frameCounter,E,W);if(!ce)return;const se=[...this.fixedDefines];se.push("DEBUG_WIREFRAME");const ue=o.getOrCreateProgram(this.name,{config:this.configuration,defines:se});W.program.set(ue.program);const pe=(Ve,Ye,qe)=>{if(Ye[Ve]&&qe[Ve])for(const je in Ye[Ve])qe[Ve][je]&&qe[Ve][je].set(qe.program,je,Ye[Ve][je].current)};j&&j.setUniforms(ue.program,W,ue.binderUniforms,M,{zoom:N}),pe("fixedUniforms",this,ue),pe("terrainUniforms",this,ue),pe("globeUniforms",this,ue),pe("fogUniforms",this,ue),pe("lightsUniforms",this,ue),pe("shadowUniforms",this,ue),ce.bind(),W.setColorMode(new kn([Q.ONE,Q.ONE_MINUS_SRC_ALPHA,Q.ZERO,Q.ONE],s.am.transparent,[!0,!0,!0,!1])),W.setDepthMode(new an(f.func===Q.LESS?Q.LEQUAL:f.func,an.ReadOnly,f.range)),W.setStencilMode(Hn.disabled);const ge=3*C.primitiveLength*2,Pe=3*C.primitiveOffset*2*2;if(this.forceManualRenderingForInstanceIDShaders){const Ve=H||1;for(let Ye=0;Ye<Ve;++Ye)ue.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ye),Q.drawElements(Q.LINES,ge,Q.UNSIGNED_SHORT,Pe)}else H&&H>1?Q.drawElementsInstanced(Q.LINES,ge,Q.UNSIGNED_SHORT,Pe,H):Q.drawElements(Q.LINES,ge,Q.UNSIGNED_SHORT,Pe);E.bind(),W.program.set(this.program),W.setDepthMode(f),W.setStencilMode(y),W.setColorMode(w)}checkUniforms(o,f,y){if(this.fixedDefines.includes(f)){for(const w of Object.keys(y))if(!y[w].initialized)throw new Error(`Program '${this.name}', from draw '${o}': uniform ${w} not set but required by ${f} being defined`)}}draw(o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue){const pe=o.context,ge=pe.gl;if(this.failedToCreate)return;pe.program.set(this.program),pe.setDepthMode(y),pe.setStencilMode(w),pe.setColorMode(E),pe.setCullFace(C);for(const Ye of Object.keys(this.fixedUniforms))this.fixedUniforms[Ye].set(this.program,Ye,M[Ye]);ce&&ce.setUniforms(this.program,pe,this.binderUniforms,W,{zoom:Q});const Pe={[ge.POINTS]:1,[ge.LINES]:2,[ge.TRIANGLES]:3,[ge.LINE_STRIP]:1}[f];this.checkUniforms(N,"RENDER_SHADOWS",this.shadowUniforms);const Ve=ue&&ue>0?1:void 0;for(const Ye of Z.get()){const qe=Ye.vaos||(Ye.vaos={});if((qe[N]||(qe[N]=new Ip)).bind(pe,this,j,ce?ce.getPaintVertexBuffers():[],H,Ye.vertexOffset,se||[],Ve),this.forceManualRenderingForInstanceIDShaders){const je=ue||1;for(let Ue=0;Ue<je;++Ue)this.instancingUniforms.u_instanceID.set(this.program,"u_instanceID",Ue),H?ge.drawElements(f,Ye.primitiveLength*Pe,ge.UNSIGNED_SHORT,Ye.primitiveOffset*Pe*2):ge.drawArrays(f,Ye.vertexOffset,Ye.vertexLength)}else ue&&ue>1?ge.drawElementsInstanced(f,Ye.primitiveLength*Pe,ge.UNSIGNED_SHORT,Ye.primitiveOffset*Pe*2,ue):H?ge.drawElements(f,Ye.primitiveLength*Pe,ge.UNSIGNED_SHORT,Ye.primitiveOffset*Pe*2):ge.drawArrays(f,Ye.vertexOffset,Ye.vertexLength);f===ge.TRIANGLES&&H&&this._drawDebugWireframe(o,y,w,E,H,Ye,W,Q,ce,ue)}}}function rd(_,o,f=0){const y=Math.pow(2,o.tileID.overscaledZ),w=o.tileSize*Math.pow(2,_.transform.tileZoom)/y,E=w*(o.tileID.canonical.x+o.tileID.wrap*y),C=w*o.tileID.canonical.y;return{u_image:0,u_texsize:o.imageAtlasTexture?o.imageAtlasTexture.size:[0,0],u_tile_units_to_pixels:1/s.aw(o,1,_.transform.tileZoom),u_pixel_coord_upper:[E>>16,C>>16],u_pixel_coord_lower:[65535&E,65535&C],u_pattern_transition:f}}const sd={terrain:0,flat:1},K_=s.bz(),bf=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe)=>{const ge=o.style.light,Pe=ge.properties.get("position"),Ve=[Pe.x,Pe.y,Pe.z],Ye=s.dx();ge.properties.get("anchor")==="viewport"&&(s.dy(Ye,-o.transform.angle),s.dz(Ve,Ve,Ye));const qe=ge.properties.get("color").toPremultipliedRenderColor(null),je=o.transform,Ue={u_matrix:_,u_lightpos:Ve,u_lightintensity:ge.properties.get("intensity"),u_lightcolor:[qe.r,qe.g,qe.b],u_vertical_gradient:+f,u_opacity:y,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:K_,u_merc_center:[0,0],u_up_dir:[0,0,0],u_height_lift:0,u_height_type:sd[j],u_base_type:sd[H],u_ao:w,u_edge_radius:E,u_width_scale:C,u_flood_light_color:ce,u_vertical_scale:se,u_flood_light_intensity:ue,u_ground_shadow_factor:pe};return je.projection.name==="globe"&&(Ue.u_tile_id=[M.canonical.x,M.canonical.y,1<<M.canonical.z],Ue.u_zoom_transition=Z,Ue.u_inv_rot_matrix=Q,Ue.u_merc_center=W,Ue.u_up_dir=je.projection.upVector(new s.cp(0,0,0),W[0]*s.aj,W[1]*s.aj),Ue.u_height_lift=N),Ue},ug=(_,o,f,y,w,E)=>({u_matrix:_,u_edge_radius:o,u_width_scale:f,u_vertical_scale:y,u_height_type:sd[w],u_base_type:sd[E]}),J_=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe)=>{const ge=bf(_,o,f,y,w,E,C,M,j,H,Z,W,Q,ce,se,ue,1,[0,0,0]),Pe={u_height_factor:-Math.pow(2,M.overscaledZ)/N.tileSize/8};return s.h(ge,rd(o,N,pe),Pe)},Ou=(_,o,f)=>({u_matrix:_,u_emissive_strength:o,u_ground_shadow_factor:f}),ey=(_,o,f,y,w,E=0)=>s.h(Ou(_,o,w),rd(f,y,E)),ty=(_,o,f,y)=>({u_matrix:_,u_world:f,u_emissive_strength:o,u_ground_shadow_factor:y}),C0=(_,o,f,y,w,E,C=0)=>s.h(ey(_,o,f,y,E,C),{u_world:w}),Hx=(_,o)=>({u_matrix:_,u_ground_shadow_factor:o}),hg=(_,o,f,y,w)=>({u_matrix:_,u_camera_pos:[o[0],o[1],o[2]],u_depth_bias:f,u_height_scale:y,u_reset_depth:w}),D0=(_,o,f,y)=>{const w=s.aj/f.tileSize;return{u_matrix:_,u_camera_to_center_distance:o.getCameraToCenterDistance(y),u_extrude_scale:[o.pixelsToGLUnits[0]/w,o.pixelsToGLUnits[1]/w]}},dg=(_,o,f=1)=>({u_matrix:_,u_color:o,u_overlay:0,u_overlay_scale:f}),ny=s.bz(),iy=(_,o,f,y,w,E,C)=>{const M=_.transform,N=M.projection.name==="globe",j=N?s.dA(M.zoom,o.canonical)*M._pixelsPerMercatorPixel:s.aw(f,1,E),H={u_matrix:o.projMatrix,u_extrude_scale:j,u_intensity:C,u_inv_rot_matrix:ny,u_merc_center:[0,0],u_tile_id:[0,0,0],u_zoom_transition:0,u_up_dir:[0,0,0]};if(N){H.u_inv_rot_matrix=y,H.u_merc_center=w,H.u_tile_id=[o.canonical.x,o.canonical.y,1<<o.canonical.z],H.u_zoom_transition=s.ah(M.zoom);const Z=w[0]*s.aj,W=w[1]*s.aj;H.u_up_dir=M.projection.upVector(new s.cp(0,0,0),Z,W)}return H};function od(_,[o,f,y,w],[E,C]){if(E===C)return[0,0,0,0];const M=255*(_-1)/(_*(C-E));return[o*M,f*M,y*M,w*M]}function ry(_,o,[f,y]){return f===y?0:.5/_+(o-f)*(_-1)/(_*(y-f))}const fg=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge,Pe,Ve)=>({u_matrix:_,u_normalize_matrix:o,u_globe_matrix:f,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:j,u_fade_t:H.mix,u_opacity:H.opacity*Z.paint.get("raster-opacity"),u_image0:0,u_image1:1,u_brightness_low:Z.paint.get("raster-brightness-min"),u_brightness_high:Z.paint.get("raster-brightness-max"),u_saturation_factor:s.dC(Z.paint.get("raster-saturation")),u_contrast_factor:s.dB(Z.paint.get("raster-contrast")),u_spin_weights:R0(Z.paint.get("raster-hue-rotate")),u_perspective_transform:W,u_raster_elevation:Q,u_zoom_transition:C,u_merc_center:M,u_cutoff_params:N,u_colorization_mix:od(s.dD,se,pe),u_colorization_offset:ry(s.dD,ue,pe),u_color_ramp:ce,u_texture_offset:[Pe/(ge+2*Pe),ge/(ge+2*Pe)],u_texture_res:[ge+2*Pe,ge+2*Pe],u_emissive_strength:Ve});function R0(_){_*=Math.PI/180;const o=Math.sin(_),f=Math.cos(_);return[(2*f+1)/3,(-Math.sqrt(3)*o-f+1)/3,(Math.sqrt(3)*o-f+1)/3]}const gh=.05,zl=(_,o,f,y,w,E,C,M,N,j,H,Z)=>({u_matrix:_,u_normalize_matrix:o,u_globe_matrix:f,u_merc_matrix:y,u_grid_matrix:w,u_tl_parent:E,u_scale_parent:j,u_fade_t:H.mix,u_opacity:H.opacity,u_image0:0,u_image1:1,u_raster_elevation:Z,u_zoom_transition:C,u_merc_center:M,u_cutoff_params:N}),sy=(_,o,f,y,w,E,C,M,N,j)=>({u_particle_texture:_,u_particle_texture_side_len:o,u_tile_offset:f,u_velocity:y,u_color_ramp:E,u_velocity_res:w,u_max_speed:C,u_uv_offset:M,u_data_scale:[255*N[0],255*N[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[gh,gh]}),Iu=(_,o,f,y,w,E,C,M,N,j)=>({u_particle_texture:_,u_particle_texture_side_len:o,u_velocity:f,u_velocity_res:y,u_max_speed:w,u_speed_factor:E,u_reset_rate:C,u_rand_seed:Math.random(),u_uv_offset:M,u_data_scale:[255*N[0],255*N[1]],u_data_offset:j,u_particle_pos_scale:1.1,u_particle_pos_offset:[gh,gh]}),oy=s.bz(),pg=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge,Pe,Ve,Ye,qe,je)=>{const Ue=w.transform,We={u_is_size_zoom_constant:+(_==="constant"||_==="source"),u_is_size_feature_constant:+(_==="constant"||_==="camera"),u_size_t:o?o.uSizeT:0,u_size:o?o.uSize:0,u_camera_to_center_distance:Ue.getCameraToCenterDistance(ge),u_rotate_symbol:+f,u_aspect_ratio:Ue.width/Ue.height,u_fade_change:w.options.fadeDuration?w.symbolFadeChange:1,u_matrix:E,u_label_plane_matrix:C,u_coord_matrix:M,u_is_text:+j,u_elevation_from_sea:N?1:0,u_pitch_with_map:+y,u_texsize:H,u_texsize_icon:Z,u_texture:0,u_texture_icon:1,u_tile_id:[0,0,0],u_zoom_transition:0,u_inv_rot_matrix:oy,u_merc_center:[0,0],u_camera_forward:[0,0,0],u_ecef_origin:[0,0,0],u_tile_matrix:oy,u_up_vector:[0,-1,0],u_color_adj_mat:Ye,u_icon_transition:qe||0,u_gamma_scale:y?w.transform.getCameraToCenterDistance(ge)*Math.cos(w.terrain?0:w.transform._pitch):1,u_device_pixel_ratio:s.q.devicePixelRatio,u_is_halo:1,u_scale_factor:je||1,u_ground_shadow_factor:Pe,u_inv_matrix:s.bi(s.bz(),C),u_normal_scale:Ve};return ge.name==="globe"&&(We.u_tile_id=[Q.canonical.x,Q.canonical.y,1<<Q.canonical.z],We.u_zoom_transition=ce,We.u_inv_rot_matrix=ue,We.u_merc_center=se,We.u_camera_forward=Ue._camera.forward(),We.u_ecef_origin=s.dE(Ue.globeMatrix,Q.toUnwrapped()),We.u_tile_matrix=Float32Array.from(Ue.globeMatrix),We.u_up_vector=pe),We},ay=(_,o,f,y)=>({u_matrix:_,u_emissive_strength:o,u_opacity:f,u_color:y}),xf=(_,o,f,y,w,E,C,M,N)=>s.h(function(j,H,Z,W,Q,ce){const{width:se,height:ue}=W.imageManager.getPixelSize(H),pe=Math.pow(2,ce.tileID.overscaledZ),ge=ce.tileSize*Math.pow(2,W.transform.tileZoom)/pe,Pe=ge*(ce.tileID.canonical.x+ce.tileID.wrap*pe),Ve=ge*ce.tileID.canonical.y;return{u_image:0,u_pattern_tl:Z.tl,u_pattern_br:Z.br,u_texsize:[se,ue],u_pattern_size:Z.displaySize,u_pattern_units_to_pixels:Q?[W.transform.width,-1*W.transform.height]:[1/s.aw(ce,1,W.transform.tileZoom),1/s.aw(ce,1,W.transform.tileZoom)],u_pixel_coord_upper:[Pe>>16,Ve>>16],u_pixel_coord_lower:[65535&Pe,65535&Ve]}}(0,E,C,y,M,N),{u_matrix:_,u_emissive_strength:o,u_opacity:f}),wf=new Float32Array(s.bx([])),ad=(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q=[0,0,0],ce)=>{const se=w.style.light,ue=se.properties.get("position"),pe=[-ue.x,-ue.y,ue.z],ge=s.dx();se.properties.get("anchor")==="viewport"&&(s.dy(ge,-w.transform.angle),s.dz(pe,pe,ge));const Pe=H.alphaMode==="MASK",Ve=se.properties.get("color").toNonPremultipliedRenderColor(null),Ye=W.paint.get("model-ambient-occlusion-intensity"),qe=W.paint.get("model-color").constantOr(s.am.white).toNonPremultipliedRenderColor(null);return qe.a=W.paint.get("model-color-mix-intensity").constantOr(0),{u_matrix:_,u_lighting_matrix:o,u_normal_matrix:f,u_node_matrix:y||wf,u_lightpos:pe,u_lightintensity:se.properties.get("intensity"),u_lightcolor:[Ve.r,Ve.g,Ve.b],u_camera_pos:Q,u_opacity:E,u_baseTextureIsAlpha:0,u_alphaMask:+Pe,u_alphaCutoff:H.alphaCutoff,u_baseColorFactor:C.toNonPremultipliedRenderColor(null).toArray01(),u_emissiveFactor:M.toNonPremultipliedRenderColor(null).toArray01(),u_metallicFactor:N,u_roughnessFactor:j,u_baseColorTexture:sa.BaseColor,u_metallicRoughnessTexture:sa.MetallicRoughness,u_normalTexture:sa.Normal,u_occlusionTexture:sa.Occlusion,u_emissionTexture:sa.Emission,u_lutTexture:sa.LUT,u_color_mix:qe.toArray01(),u_aoIntensity:Ye,u_emissive_strength:Z,u_occlusionTextureTransform:ce||[0,0,0,0]}},O0=(_,o=wf,f=wf)=>({u_matrix:_,u_instance:o,u_node_matrix:f}),I0={fillExtrusion:_=>({u_matrix:new s.cc(_),u_lightpos:new s.c9(_),u_lightintensity:new s.ca(_),u_lightcolor:new s.c9(_),u_vertical_gradient:new s.ca(_),u_opacity:new s.ca(_),u_edge_radius:new s.ca(_),u_width_scale:new s.ca(_),u_ao:new s.cb(_),u_height_type:new s.c8(_),u_base_type:new s.c8(_),u_tile_id:new s.c9(_),u_zoom_transition:new s.ca(_),u_inv_rot_matrix:new s.cc(_),u_merc_center:new s.cb(_),u_up_dir:new s.c9(_),u_height_lift:new s.ca(_),u_flood_light_color:new s.c9(_),u_vertical_scale:new s.ca(_),u_flood_light_intensity:new s.ca(_),u_ground_shadow_factor:new s.c9(_)}),fillExtrusionDepth:_=>({u_matrix:new s.cc(_),u_edge_radius:new s.ca(_),u_width_scale:new s.ca(_),u_vertical_scale:new s.ca(_),u_height_type:new s.c8(_),u_base_type:new s.c8(_)}),fillExtrusionPattern:_=>({u_matrix:new s.cc(_),u_lightpos:new s.c9(_),u_lightintensity:new s.ca(_),u_lightcolor:new s.c9(_),u_vertical_gradient:new s.ca(_),u_height_factor:new s.ca(_),u_edge_radius:new s.ca(_),u_width_scale:new s.ca(_),u_ao:new s.cb(_),u_height_type:new s.c8(_),u_base_type:new s.c8(_),u_tile_id:new s.c9(_),u_zoom_transition:new s.ca(_),u_inv_rot_matrix:new s.cc(_),u_merc_center:new s.cb(_),u_up_dir:new s.c9(_),u_height_lift:new s.ca(_),u_image:new s.c8(_),u_texsize:new s.cb(_),u_pixel_coord_upper:new s.cb(_),u_pixel_coord_lower:new s.cb(_),u_tile_units_to_pixels:new s.ca(_),u_opacity:new s.ca(_),u_pattern_transition:new s.ca(_)}),fillExtrusionGroundEffect:_=>({u_matrix:new s.cc(_),u_opacity:new s.ca(_),u_ao_pass:new s.ca(_),u_meter_to_tile:new s.ca(_),u_ao:new s.cb(_),u_flood_light_intensity:new s.ca(_),u_flood_light_color:new s.c9(_),u_attenuation:new s.ca(_),u_edge_radius:new s.ca(_),u_fb:new s.c8(_),u_fb_size:new s.ca(_),u_dynamic_offset:new s.ca(_)}),fill:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_ground_shadow_factor:new s.c9(_)}),fillPattern:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_image:new s.c8(_),u_texsize:new s.cb(_),u_pixel_coord_upper:new s.cb(_),u_pixel_coord_lower:new s.cb(_),u_tile_units_to_pixels:new s.ca(_),u_ground_shadow_factor:new s.c9(_),u_pattern_transition:new s.ca(_)}),fillOutline:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_world:new s.cb(_),u_ground_shadow_factor:new s.c9(_)}),fillOutlinePattern:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_world:new s.cb(_),u_image:new s.c8(_),u_texsize:new s.cb(_),u_pixel_coord_upper:new s.cb(_),u_pixel_coord_lower:new s.cb(_),u_tile_units_to_pixels:new s.ca(_),u_ground_shadow_factor:new s.c9(_),u_pattern_transition:new s.ca(_)}),building:_=>({u_matrix:new s.cc(_),u_normal_matrix:new s.cc(_),u_opacity:new s.ca(_)}),buildingDepth:_=>({u_matrix:new s.cc(_)}),elevatedStructuresDepth:_=>({u_matrix:new s.cc(_),u_depth_bias:new s.ca(_)}),elevatedStructures:_=>({u_matrix:new s.cc(_),u_ground_shadow_factor:new s.c9(_)}),elevatedStructuresDepthReconstruct:_=>({u_matrix:new s.cc(_),u_camera_pos:new s.c9(_),u_depth_bias:new s.ca(_),u_height_scale:new s.ca(_),u_reset_depth:new s.ca(_)}),circle:s.dH,collisionBox:_=>({u_matrix:new s.cc(_),u_camera_to_center_distance:new s.ca(_),u_extrude_scale:new s.cb(_)}),collisionCircle:_=>({u_matrix:new s.cc(_),u_inv_matrix:new s.cc(_),u_camera_to_center_distance:new s.ca(_),u_viewport_size:new s.cb(_)}),debug:_=>({u_color:new s.di(_),u_matrix:new s.cc(_),u_overlay:new s.c8(_),u_overlay_scale:new s.ca(_)}),clippingMask:_=>({u_matrix:new s.cc(_)}),heatmap:_=>({u_extrude_scale:new s.ca(_),u_intensity:new s.ca(_),u_matrix:new s.cc(_),u_inv_rot_matrix:new s.cc(_),u_merc_center:new s.cb(_),u_tile_id:new s.c9(_),u_zoom_transition:new s.ca(_),u_up_dir:new s.c9(_)}),heatmapTexture:_=>({u_image:new s.c8(_),u_color_ramp:new s.c8(_),u_opacity:new s.ca(_)}),hillshade:_=>({u_matrix:new s.cc(_),u_image:new s.c8(_),u_latrange:new s.cb(_),u_light:new s.cb(_),u_shadow:new s.di(_),u_highlight:new s.di(_),u_emissive_strength:new s.ca(_),u_accent:new s.di(_)}),hillshadePrepare:_=>({u_matrix:new s.cc(_),u_image:new s.c8(_),u_dimension:new s.cb(_),u_zoom:new s.ca(_)}),line:s.dG,linePattern:s.dF,raster:_=>({u_matrix:new s.cc(_),u_normalize_matrix:new s.cc(_),u_globe_matrix:new s.cc(_),u_merc_matrix:new s.cc(_),u_grid_matrix:new s.dj(_),u_tl_parent:new s.cb(_),u_scale_parent:new s.ca(_),u_fade_t:new s.ca(_),u_opacity:new s.ca(_),u_image0:new s.c8(_),u_image1:new s.c8(_),u_brightness_low:new s.ca(_),u_brightness_high:new s.ca(_),u_saturation_factor:new s.ca(_),u_contrast_factor:new s.ca(_),u_spin_weights:new s.c9(_),u_perspective_transform:new s.cb(_),u_raster_elevation:new s.ca(_),u_zoom_transition:new s.ca(_),u_merc_center:new s.cb(_),u_cutoff_params:new s.cQ(_),u_colorization_mix:new s.cQ(_),u_colorization_offset:new s.ca(_),u_color_ramp:new s.c8(_),u_texture_offset:new s.cb(_),u_texture_res:new s.cb(_),u_emissive_strength:new s.ca(_)}),rasterParticle:_=>({u_matrix:new s.cc(_),u_normalize_matrix:new s.cc(_),u_globe_matrix:new s.cc(_),u_merc_matrix:new s.cc(_),u_grid_matrix:new s.dj(_),u_tl_parent:new s.cb(_),u_scale_parent:new s.ca(_),u_fade_t:new s.ca(_),u_opacity:new s.ca(_),u_image0:new s.c8(_),u_image1:new s.c8(_),u_raster_elevation:new s.ca(_),u_zoom_transition:new s.ca(_),u_merc_center:new s.cb(_),u_cutoff_params:new s.cQ(_)}),rasterParticleTexture:_=>({u_texture:new s.c8(_),u_opacity:new s.ca(_)}),rasterParticleDraw:_=>({u_particle_texture:new s.c8(_),u_particle_texture_side_len:new s.ca(_),u_tile_offset:new s.cb(_),u_velocity:new s.c8(_),u_color_ramp:new s.c8(_),u_velocity_res:new s.cb(_),u_max_speed:new s.ca(_),u_uv_offset:new s.cb(_),u_data_scale:new s.cb(_),u_data_offset:new s.ca(_),u_particle_pos_scale:new s.ca(_),u_particle_pos_offset:new s.cb(_)}),rasterParticleUpdate:_=>({u_particle_texture:new s.c8(_),u_particle_texture_side_len:new s.ca(_),u_velocity:new s.c8(_),u_velocity_res:new s.cb(_),u_max_speed:new s.ca(_),u_speed_factor:new s.ca(_),u_reset_rate:new s.ca(_),u_rand_seed:new s.ca(_),u_uv_offset:new s.cb(_),u_data_scale:new s.cb(_),u_data_offset:new s.ca(_),u_particle_pos_scale:new s.ca(_),u_particle_pos_offset:new s.cb(_)}),symbol:_=>({u_is_size_zoom_constant:new s.c8(_),u_is_size_feature_constant:new s.c8(_),u_size_t:new s.ca(_),u_size:new s.ca(_),u_camera_to_center_distance:new s.ca(_),u_rotate_symbol:new s.c8(_),u_aspect_ratio:new s.ca(_),u_fade_change:new s.ca(_),u_matrix:new s.cc(_),u_label_plane_matrix:new s.cc(_),u_coord_matrix:new s.cc(_),u_is_text:new s.c8(_),u_elevation_from_sea:new s.c8(_),u_pitch_with_map:new s.c8(_),u_texsize:new s.cb(_),u_texsize_icon:new s.cb(_),u_texture:new s.c8(_),u_texture_icon:new s.c8(_),u_gamma_scale:new s.ca(_),u_device_pixel_ratio:new s.ca(_),u_tile_id:new s.c9(_),u_zoom_transition:new s.ca(_),u_inv_rot_matrix:new s.cc(_),u_merc_center:new s.cb(_),u_camera_forward:new s.c9(_),u_tile_matrix:new s.cc(_),u_up_vector:new s.c9(_),u_ecef_origin:new s.c9(_),u_is_halo:new s.c8(_),u_icon_transition:new s.ca(_),u_color_adj_mat:new s.cc(_),u_scale_factor:new s.ca(_),u_ground_shadow_factor:new s.c9(_),u_inv_matrix:new s.cc(_),u_normal_scale:new s.ca(_)}),background:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_opacity:new s.ca(_),u_color:new s.di(_)}),backgroundPattern:_=>({u_matrix:new s.cc(_),u_emissive_strength:new s.ca(_),u_opacity:new s.ca(_),u_image:new s.c8(_),u_pattern_tl:new s.cb(_),u_pattern_br:new s.cb(_),u_texsize:new s.cb(_),u_pattern_size:new s.cb(_),u_pixel_coord_upper:new s.cb(_),u_pixel_coord_lower:new s.cb(_),u_pattern_units_to_pixels:new s.cb(_)}),terrainRaster:_=>({u_matrix:new s.cc(_),u_image0:new s.c8(_),u_skirt_height:new s.ca(_),u_ground_shadow_factor:new s.c9(_)}),skybox:_=>({u_matrix:new s.cc(_),u_sun_direction:new s.c9(_),u_cubemap:new s.c8(_),u_opacity:new s.ca(_),u_temporal_offset:new s.ca(_)}),skyboxGradient:_=>({u_matrix:new s.cc(_),u_color_ramp:new s.c8(_),u_center_direction:new s.c9(_),u_radius:new s.ca(_),u_opacity:new s.ca(_),u_temporal_offset:new s.ca(_)}),skyboxCapture:_=>({u_matrix_3f:new s.dj(_),u_sun_direction:new s.c9(_),u_sun_intensity:new s.ca(_),u_color_tint_r:new s.cQ(_),u_color_tint_m:new s.cQ(_),u_luminance:new s.ca(_)}),globeRaster:_=>({u_proj_matrix:new s.cc(_),u_globe_matrix:new s.cc(_),u_normalize_matrix:new s.cc(_),u_merc_matrix:new s.cc(_),u_zoom_transition:new s.ca(_),u_merc_center:new s.cb(_),u_image0:new s.c8(_),u_grid_matrix:new s.dj(_),u_skirt_height:new s.ca(_),u_far_z_cutoff:new s.ca(_),u_frustum_tl:new s.c9(_),u_frustum_tr:new s.c9(_),u_frustum_br:new s.c9(_),u_frustum_bl:new s.c9(_),u_globe_pos:new s.c9(_),u_globe_radius:new s.ca(_),u_viewport:new s.cb(_)}),globeAtmosphere:_=>({u_frustum_tl:new s.c9(_),u_frustum_tr:new s.c9(_),u_frustum_br:new s.c9(_),u_frustum_bl:new s.c9(_),u_horizon:new s.ca(_),u_transition:new s.ca(_),u_fadeout_range:new s.ca(_),u_color:new s.cQ(_),u_high_color:new s.cQ(_),u_space_color:new s.cQ(_),u_temporal_offset:new s.ca(_),u_horizon_angle:new s.ca(_)}),model:_=>({u_matrix:new s.cc(_),u_lighting_matrix:new s.cc(_),u_normal_matrix:new s.cc(_),u_node_matrix:new s.cc(_),u_lightpos:new s.c9(_),u_lightintensity:new s.ca(_),u_lightcolor:new s.c9(_),u_camera_pos:new s.c9(_),u_opacity:new s.ca(_),u_baseColorFactor:new s.cQ(_),u_emissiveFactor:new s.cQ(_),u_metallicFactor:new s.ca(_),u_roughnessFactor:new s.ca(_),u_baseTextureIsAlpha:new s.c8(_),u_alphaMask:new s.c8(_),u_alphaCutoff:new s.ca(_),u_baseColorTexture:new s.c8(_),u_metallicRoughnessTexture:new s.c8(_),u_normalTexture:new s.c8(_),u_occlusionTexture:new s.c8(_),u_emissionTexture:new s.c8(_),u_lutTexture:new s.c8(_),u_color_mix:new s.cQ(_),u_aoIntensity:new s.ca(_),u_emissive_strength:new s.ca(_),u_occlusionTextureTransform:new s.cQ(_)}),modelDepth:_=>({u_matrix:new s.cc(_),u_instance:new s.cc(_),u_node_matrix:new s.cc(_)}),groundShadow:_=>({u_matrix:new s.cc(_),u_ground_shadow_factor:new s.c9(_)}),stars:_=>({u_matrix:new s.cc(_),u_up:new s.c9(_),u_right:new s.c9(_),u_intensity_multiplier:new s.ca(_)}),snowParticle:_=>({u_modelview:new s.cc(_),u_projection:new s.cc(_),u_time:new s.ca(_),u_cam_pos:new s.c9(_),u_velocityConeAperture:new s.ca(_),u_velocity:new s.ca(_),u_horizontalOscillationRadius:new s.ca(_),u_horizontalOscillationRate:new s.ca(_),u_boxSize:new s.ca(_),u_billboardSize:new s.ca(_),u_simpleShapeParameters:new s.cb(_),u_screenSize:new s.cb(_),u_thinningCenterPos:new s.cb(_),u_thinningShape:new s.c9(_),u_thinningAffectedRatio:new s.ca(_),u_thinningParticleOffset:new s.ca(_),u_particleColor:new s.cQ(_),u_direction:new s.c9(_)}),rainParticle:_=>({u_modelview:new s.cc(_),u_projection:new s.cc(_),u_time:new s.ca(_),u_cam_pos:new s.c9(_),u_texScreen:new s.c8(_),u_velocityConeAperture:new s.ca(_),u_velocity:new s.ca(_),u_boxSize:new s.ca(_),u_rainDropletSize:new s.cb(_),u_distortionStrength:new s.ca(_),u_rainDirection:new s.c9(_),u_color:new s.cQ(_),u_screenSize:new s.cb(_),u_thinningCenterPos:new s.cb(_),u_thinningShape:new s.c9(_),u_thinningAffectedRatio:new s.ca(_),u_thinningParticleOffset:new s.ca(_),u_shapeDirectionalPower:new s.ca(_),u_shapeNormalPower:new s.ca(_),u_mode:new s.ca(_)}),vignette:_=>({u_vignetteShape:new s.c9(_),u_vignetteColor:new s.cQ(_)}),occlusion:_=>({u_matrix:new s.cc(_),u_anchorPos:new s.c9(_),u_screenSizePx:new s.cb(_),u_occluderSizePx:new s.cb(_),u_color:new s.cQ(_)})};class vs{constructor(o,f,y,w){this.id=vs.uniqueIdxCounter,vs.uniqueIdxCounter++,this.context=o;const E=o.gl;this.buffer=E.createBuffer(),this.dynamicDraw=!!y,this.context.unbindVAO(),o.bindElementBuffer.set(this.buffer),E.bufferData(E.ELEMENT_ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?E.DYNAMIC_DRAW:E.STATIC_DRAW),this.dynamicDraw||w||f.destroy()}bind(){this.context.bindElementBuffer.set(this.buffer)}updateData(o){this.id=vs.uniqueIdxCounter,vs.uniqueIdxCounter++;const f=this.context.gl;this.context.unbindVAO(),this.bind(),f.bufferSubData(f.ELEMENT_ARRAY_BUFFER,0,o.arrayBuffer)}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}vs.uniqueIdxCounter=0;const ly={Int8:"BYTE",Uint8:"UNSIGNED_BYTE",Int16:"SHORT",Uint16:"UNSIGNED_SHORT",Int32:"INT",Uint32:"UNSIGNED_INT",Float32:"FLOAT"};class cy{constructor(o,f,y,w,E,C){this.length=f.length,this.attributes=y,this.itemSize=f.bytesPerElement,this.dynamicDraw=w,this.instanceCount=C,this.context=o;const M=o.gl;this.buffer=M.createBuffer(),o.bindVertexBuffer.set(this.buffer),M.bufferData(M.ARRAY_BUFFER,f.arrayBuffer,this.dynamicDraw?M.DYNAMIC_DRAW:M.STATIC_DRAW),this.dynamicDraw||E||f.destroy()}bind(){this.context.bindVertexBuffer.set(this.buffer)}updateData(o){const f=this.context.gl;this.bind(),f.bufferSubData(f.ARRAY_BUFFER,0,o.arrayBuffer)}enableAttributes(o,f){for(let y=0;y<this.attributes.length;y++){const w=f.attributes[this.attributes[y].name];w!==void 0&&o.enableVertexAttribArray(w)}}setVertexAttribPointers(o,f,y){for(let w=0;w<this.attributes.length;w++){const E=this.attributes[w],C=f.attributes[E.name];C!==void 0&&o.vertexAttribPointer(C,E.components,o[ly[E.type]],!1,this.itemSize,E.offset+this.itemSize*(y||0))}}setVertexAttribDivisor(o,f,y){for(let w=0;w<this.attributes.length;w++){const E=f.attributes[this.attributes[w].name];E!==void 0&&this.instanceCount&&this.instanceCount>0&&o.vertexAttribDivisor(E,y)}}destroy(){this.buffer&&(this.context.gl.deleteBuffer(this.buffer),delete this.buffer)}}class Tf{constructor(o,f,y,w,E){this.context=o,this.width=f,this.height=y;const C=this.framebuffer=o.gl.createFramebuffer();w&&(this.colorAttachment=new X_(o,C)),E&&(this.depthAttachmentType=E,this.depthAttachment=E==="renderbuffer"?new E0(o,C):new Vx(o,C))}destroy(){const o=this.context.gl;if(this.colorAttachment){const f=this.colorAttachment.get();f&&o.deleteTexture(f)}if(this.depthAttachment&&this.depthAttachmentType)if(this.depthAttachmentType==="renderbuffer"){const f=this.depthAttachment.get();f&&o.deleteRenderbuffer(f)}else{const f=this.depthAttachment.get();f&&o.deleteTexture(f)}o.deleteFramebuffer(this.framebuffer)}}class uy{constructor(o,f){this.gl=o,this.clearColor=new zn(this),this.clearDepth=new nd(this),this.clearStencil=new H_(this),this.colorMask=new po(this),this.depthMask=new _0(this),this.stencilMask=new y0(this),this.stencilFunc=new v0(this),this.stencilOp=new b0(this),this.stencilTest=new $_(this),this.depthRange=new x0(this),this.depthTest=new G_(this),this.depthFunc=new rg(this),this.blend=new aa(this),this.blendFunc=new es(this),this.blendColor=new fh(this),this.blendEquation=new Eu(this),this.cullFace=new eu(this),this.cullFaceSide=new Su(this),this.frontFace=new Ea(this),this.program=new q_(this),this.activeTexture=new id(this),this.viewport=new W_(this),this.bindFramebuffer=new Au(this),this.bindRenderbuffer=new Pp(this),this.bindTexture=new _f(this),this.bindVertexBuffer=new Y_(this),this.bindElementBuffer=new sg(this),this.bindVertexArrayOES=new kp(this),this.pixelStoreUnpack=new w0(this),this.pixelStoreUnpackPremultiplyAlpha=new T0(this),this.pixelStoreUnpackFlipY=new Z_(this),this.options=f?Object.assign({},f):{},this.options.extTextureFilterAnisotropicForceOff||(this.extTextureFilterAnisotropic=o.getExtension("EXT_texture_filter_anisotropic")||o.getExtension("MOZ_EXT_texture_filter_anisotropic")||o.getExtension("WEBKIT_EXT_texture_filter_anisotropic"),this.extTextureFilterAnisotropic&&(this.extTextureFilterAnisotropicMax=o.getParameter(this.extTextureFilterAnisotropic.MAX_TEXTURE_MAX_ANISOTROPY_EXT))),this.extDebugRendererInfo=o.getExtension("WEBGL_debug_renderer_info"),this.extDebugRendererInfo&&(this.renderer=o.getParameter(this.extDebugRendererInfo.UNMASKED_RENDERER_WEBGL),this.vendor=o.getParameter(this.extDebugRendererInfo.UNMASKED_VENDOR_WEBGL)),this.forceManualRenderingForInstanceIDShaders=f&&!!f.forceManualRenderingForInstanceIDShaders||this.renderer&&this.renderer.indexOf("PowerVR")!==-1,this.options.extTextureFloatLinearForceOff||(this.extTextureFloatLinear=o.getExtension("OES_texture_float_linear")),this.extRenderToTextureHalfFloat=o.getExtension("EXT_color_buffer_half_float"),this.extTimerQuery=o.getExtension("EXT_disjoint_timer_query_webgl2"),this.maxTextureSize=o.getParameter(o.MAX_TEXTURE_SIZE),this.maxPointSize=o.getParameter(o.ALIASED_POINT_SIZE_RANGE)[1]}setDefault(){this.unbindVAO(),this.clearColor.setDefault(),this.clearDepth.setDefault(),this.clearStencil.setDefault(),this.colorMask.setDefault(),this.depthMask.setDefault(),this.stencilMask.setDefault(),this.stencilFunc.setDefault(),this.stencilOp.setDefault(),this.stencilTest.setDefault(),this.depthRange.setDefault(),this.depthTest.setDefault(),this.depthFunc.setDefault(),this.blend.setDefault(),this.blendFunc.setDefault(),this.blendColor.setDefault(),this.blendEquation.setDefault(),this.cullFace.setDefault(),this.cullFaceSide.setDefault(),this.frontFace.setDefault(),this.program.setDefault(),this.activeTexture.setDefault(),this.bindFramebuffer.setDefault(),this.pixelStoreUnpack.setDefault(),this.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.pixelStoreUnpackFlipY.setDefault()}setDirty(){this.clearColor.dirty=!0,this.clearDepth.dirty=!0,this.clearStencil.dirty=!0,this.colorMask.dirty=!0,this.depthMask.dirty=!0,this.stencilMask.dirty=!0,this.stencilFunc.dirty=!0,this.stencilOp.dirty=!0,this.stencilTest.dirty=!0,this.depthRange.dirty=!0,this.depthTest.dirty=!0,this.depthFunc.dirty=!0,this.blend.dirty=!0,this.blendFunc.dirty=!0,this.blendColor.dirty=!0,this.blendEquation.dirty=!0,this.cullFace.dirty=!0,this.cullFaceSide.dirty=!0,this.frontFace.dirty=!0,this.program.dirty=!0,this.activeTexture.dirty=!0,this.viewport.dirty=!0,this.bindFramebuffer.dirty=!0,this.bindRenderbuffer.dirty=!0,this.bindTexture.dirty=!0,this.bindVertexBuffer.dirty=!0,this.bindElementBuffer.dirty=!0,this.bindVertexArrayOES.dirty=!0,this.pixelStoreUnpack.dirty=!0,this.pixelStoreUnpackPremultiplyAlpha.dirty=!0,this.pixelStoreUnpackFlipY.dirty=!0}createIndexBuffer(o,f,y){return new vs(this,o,f,y)}createVertexBuffer(o,f,y,w,E){return new cy(this,o,f,y,w,E)}createRenderbuffer(o,f,y){const w=this.gl,E=w.createRenderbuffer();return this.bindRenderbuffer.set(E),w.renderbufferStorage(w.RENDERBUFFER,o,f,y),this.bindRenderbuffer.set(null),E}createFramebuffer(o,f,y,w){return new Tf(this,o,f,y,w)}clear({color:o,depth:f,stencil:y,colorMask:w}){const E=this.gl;let C=0;o&&(C|=E.COLOR_BUFFER_BIT,this.clearColor.set(o.toNonPremultipliedRenderColor(null)),this.colorMask.set(w||[!0,!0,!0,!0])),f!==void 0&&(C|=E.DEPTH_BUFFER_BIT,this.depthRange.set([0,1]),this.clearDepth.set(f),this.depthMask.set(!0)),y!==void 0&&(C|=E.STENCIL_BUFFER_BIT,this.clearStencil.set(y),this.stencilMask.set(255)),E.clear(C)}setCullFace(o){o.enable===!1?this.cullFace.set(!1):(this.cullFace.set(!0),this.cullFaceSide.set(o.mode),this.frontFace.set(o.frontFace))}setDepthMode(o){o.func!==this.gl.ALWAYS||o.mask?(this.depthTest.set(!0),this.depthFunc.set(o.func),this.depthMask.set(o.mask),this.depthRange.set(o.range)):this.depthTest.set(!1)}setStencilMode(o){o.test.func!==this.gl.ALWAYS||o.mask?(this.stencilTest.set(!0),this.stencilMask.set(o.mask),this.stencilOp.set([o.fail,o.depthFail,o.pass]),this.stencilFunc.set({func:o.test.func,ref:o.ref,mask:o.test.mask})):this.stencilTest.set(!1)}setColorMode(o){s.bv(o.blendFunction,kn.Replace)?this.blend.set(!1):(this.blend.set(!0),this.blendFunc.set(o.blendFunction),this.blendColor.set(o.blendColor),o.blendEquation?this.blendEquation.set(o.blendEquation):this.blendEquation.setDefault()),this.colorMask.set(o.mask)}unbindVAO(){this.bindVertexArrayOES.set(null)}}let _h;function Ef(_,o,f,y,w,E,C){const M=_.context,N=M.gl,j=_.transform,H=_.getOrCreateProgram("collisionBox"),Z=[];let W=0,Q=0;for(let Ve=0;Ve<y.length;Ve++){const Ye=y[Ve],qe=o.getTile(Ye),je=qe.getBucket(f);if(!je)continue;const Ue=$n(Ye,je,j);let We=Ue;w[0]===0&&w[1]===0||(We=_.translatePosMatrix(Ue,qe,w,E));const et=C?je.textCollisionBox:je.iconCollisionBox,_t=je.collisionCircleArray;if(_t.length>0){const ft=s.bz(),Mt=We;s.cB(ft,je.placementInvProjMatrix,j.glCoordMatrix),s.cB(ft,ft,je.placementViewportMatrix),Z.push({circleArray:_t,circleOffset:Q,transform:Mt,invTransform:ft,projection:je.getProjection()}),W+=_t.length/4,Q=W}et&&(_.terrain&&_.terrain.setupElevationDraw(qe,H),H.draw(_,N.LINES,an.disabled,Hn.disabled,_.colorModeForRenderPass(),Un.disabled,D0(We,j,qe,je.getProjection()),f.id,et.layoutVertexBuffer,et.indexBuffer,et.segments,null,j.zoom,null,[et.collisionVertexBuffer,et.collisionVertexBufferExt]))}if(!C||!Z.length)return;const ce=_.getOrCreateProgram("collisionCircle"),se=new s.dI;se.resize(4*W),se._trim();let ue=0;for(const Ve of Z)for(let Ye=0;Ye<Ve.circleArray.length/4;Ye++){const qe=4*Ye,je=Ve.circleArray[qe+0],Ue=Ve.circleArray[qe+1],We=Ve.circleArray[qe+2],et=Ve.circleArray[qe+3];se.emplace(ue++,je,Ue,We,et,0),se.emplace(ue++,je,Ue,We,et,1),se.emplace(ue++,je,Ue,We,et,2),se.emplace(ue++,je,Ue,We,et,3)}(!_h||_h.length<2*W)&&(_h=function(Ve){const Ye=2*Ve,qe=new s.a_;qe.resize(Ye),qe._trim();for(let je=0;je<Ye;je++){const Ue=6*je;qe.uint16[Ue+0]=4*je+0,qe.uint16[Ue+1]=4*je+1,qe.uint16[Ue+2]=4*je+2,qe.uint16[Ue+3]=4*je+2,qe.uint16[Ue+4]=4*je+3,qe.uint16[Ue+5]=4*je+0}return qe}(W));const pe=M.createIndexBuffer(_h,!0),ge=M.createVertexBuffer(se,s.dJ.members,!0);for(const Ve of Z){const Ye={u_matrix:Ve.transform,u_inv_matrix:Ve.invTransform,u_camera_to_center_distance:(Pe=j).getCameraToCenterDistance(Ve.projection),u_viewport_size:[Pe.width,Pe.height]};ce.draw(_,N.TRIANGLES,an.disabled,Hn.disabled,_.colorModeForRenderPass(),Un.disabled,Ye,f.id,ge,pe,s.bd.simpleSegment(0,2*Ve.circleOffset,Ve.circleArray.length,Ve.circleArray.length/2),null,j.zoom)}var Pe;ge.destroy(),pe.destroy()}const Mu=s.bz();function lc(_){const o=_._camera.getWorldToCamera(_.worldSize,1),f=s.az([],o,_.globeMatrix);s.bi(f,f);const y=[0,0,0],w=[0,1,0,0];return s.aA(w,w,f),y[0]=w[0],y[1]=w[1],y[2]=w[2],s.au(y,y),y}function Np({width:_,height:o,anchor:f,textOffset:y,textScale:w},E){const{horizontalAlign:C,verticalAlign:M}=s.bT(f),N=-(C-.5)*_,j=-(M-.5)*o,H=s.bU(f,y);return new s.P((N/w+H[0])*E,(j/w+H[1])*E)}function yh(_,o,f,y,w,E,C,M,N,j){const H=_.text.placedSymbolArray,Z=_.text.dynamicLayoutVertexArray,W=_.icon.dynamicLayoutVertexArray,Q={},ce=_.getProjection(),se=Xc(C,ce,w),ue=w.elevation,pe=ce.upVectorScale(C.canonical,w.center.lat,w.worldSize).metersToTile;Z.clear();for(let ge=0;ge<H.length;ge++){const Pe=H.get(ge),{tileAnchorX:Ve,tileAnchorY:Ye,numGlyphs:qe}=Pe,je=Pe.hidden||!Pe.crossTileID||_.allowVerticalPlacement&&!Pe.placedOrientation?null:y[Pe.crossTileID];if(je){let Ue=0,We=0,et=0;if(ue){const At=ue?ue.getAtTileOffset(C,Ve,Ye):0,[Tt,Nt,Yt]=ce.upVector(C.canonical,Ve,Ye);Ue=At*Tt*pe,We=At*Nt*pe,et=At*Yt*pe}let[_t,ft,Mt,Rt]=qa(Pe.projectedAnchorX+Ue,Pe.projectedAnchorY+We,Pe.projectedAnchorZ+et,f?se:E);const jt=Kh(w.getCameraToCenterDistance(ce),Rt);let ht=s.bJ(_.textSizeData,N,Pe)*jt/s.bO;f&&(ht*=_.tilePixelRatio/M);const Dt=Np(je,ht);f?({x:_t,y:ft,z:Mt}=ce.projectTilePoint(Ve+Dt.x,Ye+Dt.y,C.canonical),[_t,ft,Mt]=qa(_t+Ue,ft+We,Mt+et,E)):(o&&Dt._rotate(-w.angle),_t+=Dt.x,ft+=Dt.y,Mt=0);const ot=_.allowVerticalPlacement&&Pe.placedOrientation===s.bI.vertical?Math.PI/2:0;for(let At=0;At<qe;At++)s.bL(Z,_t,ft,Mt,ot);j&&Pe.associatedIconIndex>=0&&(Q[Pe.associatedIconIndex]={x:_t,y:ft,z:Mt,angle:ot})}else Zc(qe,Z)}if(j){W.clear();const ge=_.icon.placedSymbolArray;for(let Pe=0;Pe<ge.length;Pe++){const Ve=ge.get(Pe),{numGlyphs:Ye}=Ve,qe=Q[Pe];if(Ve.hidden||!qe)Zc(Ye,W);else{const{x:je,y:Ue,z:We,angle:et}=qe;for(let _t=0;_t<Ye;_t++)s.bL(W,je,Ue,We,et)}}_.icon.dynamicLayoutVertexBuffer.updateData(W)}_.text.dynamicLayoutVertexBuffer.updateData(Z)}function dl(_,o,f,y,w,E,C={}){const M=f.paint.get("icon-translate"),N=f.paint.get("text-translate"),j=f.paint.get("icon-translate-anchor"),H=f.paint.get("text-translate-anchor"),Z=f.layout.get("icon-rotation-alignment"),W=f.layout.get("text-rotation-alignment"),Q=f.layout.get("icon-pitch-alignment"),ce=f.layout.get("text-pitch-alignment"),se=f.layout.get("icon-keep-upright"),ue=f.layout.get("text-keep-upright"),pe=f.paint.get("icon-color-saturation"),ge=f.paint.get("icon-color-contrast"),Pe=f.paint.get("icon-color-brightness-min"),Ve=f.paint.get("icon-color-brightness-max"),Ye=f.layout.get("symbol-elevation-reference")==="sea",qe=_.context,je=qe.gl,Ue=_.transform,We=Z==="map",et=W==="map",_t=Q==="map",ft=ce==="map",Mt=f.layout.get("symbol-sort-key").constantOr(1)!==void 0;let Rt=!1;const jt=_.depthModeForSublayer(0,an.ReadOnly),ht=new an(_.context.gl.LEQUAL,an.ReadOnly,_.depthRangeFor3D),Dt=[s.aD(Ue.center.lng),s.aH(Ue.center.lat)],ot=f.layout.get("text-variable-anchor"),At=Ue.projection.name==="globe",Tt=[],Nt=[0,-1,0];for(const Yt of y){const Pt=o.getTile(Yt),qt=Pt.getBucket(f);if(!qt||qt.projection.name==="mercator"&&At||qt.fullyClipped)continue;const bn=qt.projection.name==="globe",fn=bn?s.ah(Ue.zoom):0,pn=Xc(Yt,qt.getProjection(),Ue),Rn=Ue.calculatePixelsToTileUnitsMatrix(Pt),Nn=ot&&qt.hasTextData(),Bn=qt.hasIconTextFit()&&Nn&&qt.hasIconData(),Xn=qt.getProjection().createInversionMatrix(Ue,Yt.canonical),ai=(1<<Pt.tileID.canonical.z)*s.aj/_.transform.worldSize,Bi=Wi=>{let ji=[0,0,0];if(Wi){const Zr=_.style.directionalLight,Ci=_.style.ambientLight;Zr&&Ci&&(ji=as(_.style,Zr,Ci))}return ji},pr=Wi=>{Ue.depthOcclusionForSymbolsAndCircles&&(f.hasInitialOcclusionOpacityProperties||_.terrain)&&(Wi.push("DEPTH_D24"),Wi.push("DEPTH_OCCLUSION"))},Gi=()=>{const Wi=We&&f.layout.get("symbol-placement")!=="point",ji=[];pr(ji);const Zr=Wi||Bn,Ci=qt.elevationType==="road"&&_t,As=_.shadowRenderer,Tr=Ci&&!!As&&As.enabled,mr=Bi(Tr),Er=Ci?ht:jt,Fi=f.paint.get("icon-image-cross-fade");_.terrainRenderModeElevated()&&_t&&ji.push("PITCH_WITH_MAP_TERRAIN"),bn&&(ji.push("PROJECTION_GLOBE_VIEW"),Zr&&ji.push("PROJECTED_POS_ON_VIEWPORT")),Fi>0&&ji.push("ICON_TRANSITION"),qt.icon.zOffsetVertexBuffer&&ji.push("Z_OFFSET"),pe===0&&ge===0&&Pe===0&&Ve===1||ji.push("COLOR_ADJUSTMENT"),qt.sdfIcons&&ji.push("RENDER_SDF"),Tr&&ji.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ci&&qt.icon.orientationVertexBuffer&&ji.push("ELEVATED_ROADS");const ts=qt.icon.programConfigurations.get(f.id),No=_.getOrCreateProgram("symbol",{config:ts,defines:ji}),vr=Pt.imageAtlasTexture?Pt.imageAtlasTexture.size:[0,0],Vi=qt.iconSizeData,js=s.bH(Vi,Ue.zoom),Ca=_t||!Ue.isOrthographic,gl=Gr(pn,Pt.tileID.canonical,_t,We,Ue,qt.getProjection(),Rn),fc=Tp(pn,Pt.tileID.canonical,_t,We,Ue,qt.getProjection(),Rn),Fl=_.translatePosMatrix(fc,Pt,M,j,!0),Qa=_.translatePosMatrix(pn,Pt,M,j),vd=Zr?Mu:gl,pc=We&&!_t&&!Wi;let bd=Nt;!At&&!Ue.mercatorFromTransition||We||(bd=lc(Ue));const Oh=bn?bd:Nt,Wp=f.getColorAdjustmentMatrix(pe,ge,Pe,Ve),Ff=pg(Vi.kind,js,pc,_t,_,Qa,vd,Fl,Ye,!1,vr,[0,0],0,Yt,fn,Dt,Xn,Oh,qt.getProjection(),mr,ai,Wp,Fi,null),Ay=Pt.imageAtlasTexture?Pt.imageAtlasTexture:null,xd=f.layout.get("icon-size").constantOr(0)!==1||qt.iconsNeedLinear,Ih=qt.sdfIcons||_.options.rotating||_.options.zooming||xd||Ca?je.LINEAR:je.NEAREST,wd=qt.sdfIcons&&f.paint.get("icon-halo-width").constantOr(1)!==0,uu=_.terrain&&_t&&Wi?s.bi(s.bz(),gl):Mu;if(Wi&&qt.icon){const Yp=Ue.elevation,mc=Yp?Yp.getAtTileOffsetFunc(Yt,Ue.center.lat,Ue.worldSize,qt.getProjection()):null,gc=wp(pn,Pt.tileID.canonical,_t,We,Ue,qt.getProjection(),Rn);th(qt,pn,_,!1,gc,fc,_t,se,mc,Yt)}return{program:No,buffers:qt.icon,uniformValues:Ff,atlasTexture:Ay,atlasTextureIcon:null,atlasInterpolation:Ih,atlasInterpolationIcon:null,isSDF:qt.sdfIcons,hasHalo:wd,depthMode:Er,tile:Pt,renderWithShadows:Tr,labelPlaneMatrixInv:uu}},qi=()=>{const Wi=et&&f.layout.get("symbol-placement")!=="point",ji=[],Zr=Wi||ot||Bn,Ci=qt.elevationType==="road"&&ft,As=_.shadowRenderer,Tr=Ci&&!!As&&As.enabled,mr=Bi(Tr),Er=Ci?ht:jt;_.terrainRenderModeElevated()&&ft&&ji.push("PITCH_WITH_MAP_TERRAIN"),bn&&(ji.push("PROJECTION_GLOBE_VIEW"),Zr&&ji.push("PROJECTED_POS_ON_VIEWPORT")),qt.text.zOffsetVertexBuffer&&ji.push("Z_OFFSET"),qt.iconsInText&&ji.push("RENDER_TEXT_AND_SYMBOL"),ji.push("RENDER_SDF"),Tr&&ji.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ci&&qt.text.orientationVertexBuffer&&ji.push("ELEVATED_ROADS"),pr(ji);const Fi=qt.text.programConfigurations.get(f.id),ts=_.getOrCreateProgram("symbol",{config:Fi,defines:ji});let No,vr=[0,0],Vi=null;const js=qt.textSizeData;qt.iconsInText&&(vr=Pt.imageAtlasTexture?Pt.imageAtlasTexture.size:[0,0],Vi=Pt.imageAtlasTexture?Pt.imageAtlasTexture:null,No=ft||!Ue.isOrthographic||_.options.rotating||_.options.zooming||js.kind==="composite"||js.kind==="camera"?je.LINEAR:je.NEAREST);const Ca=Pt.glyphAtlasTexture?Pt.glyphAtlasTexture.size:[0,0],gl=f.layout.get("text-size-scale-range"),fc=s.ay(_.scaleFactor,gl[0],gl[1]),Fl=s.bH(js,Ue.zoom,fc),Qa=Gr(pn,Pt.tileID.canonical,ft,et,Ue,qt.getProjection(),Rn),vd=Tp(pn,Pt.tileID.canonical,ft,et,Ue,qt.getProjection(),Rn),pc=_.translatePosMatrix(vd,Pt,N,H,!0),bd=_.translatePosMatrix(pn,Pt,N,H),Oh=Zr?Mu:Qa,Wp=et&&!ft&&!Wi;let Ff=Nt;!At&&!Ue.mercatorFromTransition||et||(Ff=lc(Ue));const Ay=pg(js.kind,Fl,Wp,ft,_,bd,Oh,pc,Ye,!0,Ca,vr,0,Yt,fn,Dt,Xn,bn?Ff:Nt,qt.getProjection(),mr,ai,null,null,fc),xd=Pt.glyphAtlasTexture?Pt.glyphAtlasTexture:null,Ih=je.LINEAR,wd=f.paint.get("text-halo-width").constantOr(1)!==0,uu=_.terrain&&ft&&Wi?s.bi(s.bz(),Qa):Mu;if(Wi&&qt.text){const Yp=Ue.elevation,mc=Yp?Yp.getAtTileOffsetFunc(Yt,Ue.center.lat,Ue.worldSize,qt.getProjection()):null,gc=wp(pn,Pt.tileID.canonical,ft,et,Ue,qt.getProjection(),Rn);th(qt,pn,_,!0,gc,vd,ft,ue,mc,Yt)}return{program:ts,buffers:qt.text,uniformValues:Ay,atlasTexture:xd,atlasTextureIcon:Vi,atlasInterpolation:Ih,atlasInterpolationIcon:No,isSDF:!0,hasHalo:wd,depthMode:Er,tile:Pt,renderWithShadows:Tr,labelPlaneMatrixInv:uu}},cs=qt.icon.segments.get().length,si=qt.text.segments.get().length,li=cs&&!C.onlyText?Gi():null,mi=si&&!C.onlyIcons?qi():null,yr=f.paint.get("icon-opacity").constantOr(1),Us=f.paint.get("text-opacity").constantOr(1);if(Mt&&qt.canOverlap){Rt=!0;const Wi=yr&&!C.onlyText?qt.icon.segments.get():[],ji=Us&&!C.onlyIcons?qt.text.segments.get():[];for(const Zr of Wi)Tt.push({segments:new s.bd([Zr]),sortKey:Zr.sortKey,state:li});for(const Zr of ji)Tt.push({segments:new s.bd([Zr]),sortKey:Zr.sortKey,state:mi})}else C.onlyText||Tt.push({segments:yr?qt.icon.segments:new s.bd([]),sortKey:0,state:li}),C.onlyIcons||Tt.push({segments:Us?qt.text.segments:new s.bd([]),sortKey:0,state:mi})}Rt&&Tt.sort((Yt,Pt)=>Yt.sortKey-Pt.sortKey);for(const Yt of Tt){const Pt=Yt.state;if(Pt)if(_.terrain?_.terrain.setupElevationDraw(Pt.tile,Pt.program,{useDepthForOcclusion:Ue.depthOcclusionForSymbolsAndCircles,labelPlaneMatrixInv:Pt.labelPlaneMatrixInv}):_.setupDepthForOcclusion(Ue.depthOcclusionForSymbolsAndCircles,Pt.program),qe.activeTexture.set(je.TEXTURE0),Pt.atlasTexture&&Pt.atlasTexture.bind(Pt.atlasInterpolation,je.CLAMP_TO_EDGE,!0),Pt.atlasTextureIcon&&(qe.activeTexture.set(je.TEXTURE1),Pt.atlasTextureIcon&&Pt.atlasTextureIcon.bind(Pt.atlasInterpolationIcon,je.CLAMP_TO_EDGE,!0)),Pt.renderWithShadows&&_.shadowRenderer.setupShadows(Pt.tile.tileID.toUnwrapped(),Pt.program,"vector-tile",Pt.tile.tileID.overscaledZ),_.uploadCommonLightUniforms(_.context,Pt.program),Pt.hasHalo){const qt=Pt.uniformValues;qt.u_is_halo=1,vh(Pt.buffers,Yt.segments,f,_,Pt.program,Pt.depthMode,w,E,qt,2),qt.u_is_halo=0}else{if(Pt.isSDF){const qt=Pt.uniformValues;Pt.hasHalo&&(qt.u_is_halo=1,vh(Pt.buffers,Yt.segments,f,_,Pt.program,Pt.depthMode,w,E,qt,1)),qt.u_is_halo=0}vh(Pt.buffers,Yt.segments,f,_,Pt.program,Pt.depthMode,w,E,Pt.uniformValues,1)}}}function vh(_,o,f,y,w,E,C,M,N,j){const H=[_.dynamicLayoutVertexBuffer,_.opacityVertexBuffer,_.iconTransitioningVertexBuffer,_.globeExtVertexBuffer,_.zOffsetVertexBuffer,_.orientationVertexBuffer];w.draw(y,y.context.gl.TRIANGLES,E,C,M,Un.disabled,N,f.id,_.layoutVertexBuffer,_.indexBuffer,o,f.paint,y.transform.zoom,_.programConfigurations.get(f.id),H,j)}function Lp(_,o){const f=1<<_.canonical.z,y=(o.x*f-_.canonical.x-_.wrap*f)*s.aj,w=(o.y*f-_.canonical.y)*s.aj,E=s.dS(o.z,o.y);return s.cS(y,w,E)}function mg(_,o,f,y,w){if(!f.layout||f.layout.get("fill-elevation-reference")==="none")return;const E=_.context.gl,C=new an(_.context.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D),M=new an(_.context.gl.GREATER,an.ReadWrite,_.depthRangeFor3D),N=function(Q){const ce=s.cJ(Q.pitch);let se=.01;return Q.isOrthographic&&(se=s.ai(1e-4,se,s.cN(ce>=fo?1:ce/fo))),2*se}(_.transform),j=_.transform.getFreeCameraOptions().position,H="elevatedStructuresDepthReconstruct",Z=_.getOrCreateProgram(H,{defines:["DEPTH_RECONSTRUCTION"]}),W=_.getOrCreateProgram(H);for(const Q of y){const ce=o.getTile(Q),se=ce.getBucket(f);if(!se)continue;const ue=se.elevatedStructures;if(!ue)continue;const pe=se.elevationBufferData.heightRange,ge=Lp(Q.toUnwrapped(),j),Pe=_.translatePosMatrix(Q.projMatrix,ce,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor"));let Ve,Ye,qe,je;if(w==="initialize"){if(!pe||pe.min>=1||ue.depthSegments.segments[0].primitiveLength===0)continue;Ve=hg(Pe,ge,N,1,0),Ye=C,qe=ue.depthSegments,je=Z}else if(w==="reset"){if(!pe||pe.min>=0||ue.maskSegments.segments[0].primitiveLength===0)continue;Ve=hg(Pe,ge,0,0,1),Ye=M,qe=ue.maskSegments,je=Z}else if(w==="geometry"){if(ue.depthSegments.segments[0].primitiveLength===0)continue;Ve=hg(Pe,ge,N,1,0),Ye=C,qe=ue.depthSegments,je=W}je.draw(_,E.TRIANGLES,Ye,Hn.disabled,kn.disabled,Un.disabled,Ve,f.id,ue.vertexBuffer,ue.indexBuffer,qe,f.paint,_.transform.zoom)}}function hy(_,o,f){const{painter:y,sourceCache:w,layer:E,coords:C,colorMode:M,elevationType:N,terrainEnabled:j,pass:H}=_,Z=y.context.gl,W=E.paint.get("fill-pattern"),Q=E.paint.get("fill-pattern-cross-fade"),ce=W.constantOr(null);let se=N;N!=="road"||o&&!j||(se="none");const ue=se==="road",pe=_.painter.shadowRenderer,ge=ue&&!!pe&&pe.enabled,Pe=new an(y.context.gl.LEQUAL,an.ReadOnly,y.depthRangeFor3D);let Ve=[0,0,0];if(ge){const je=y.style.directionalLight,Ue=y.style.ambientLight;je&&Ue&&(Ve=as(y.style,je,Ue))}const Ye=W&&W.constantOr(1),qe=(je,Ue)=>{let We,et,_t,ft,Mt;Ue?(We=Ye&&!E.getPaintProperty("fill-outline-color")?"fillOutlinePattern":"fillOutline",_t=Z.LINES):(We=Ye?"fillPattern":"fill",_t=Z.TRIANGLES);for(const Rt of C){const jt=w.getTile(Rt);if(Ye&&!jt.patternsLoaded())continue;const ht=jt.getBucket(E);if(!ht)continue;const Dt=o?ht.elevationBufferData:ht.bufferData;if(Dt.isEmpty())continue;y.prepareDrawTile();const ot=Dt.programConfigurations.get(E.id),At=y.isTileAffectedByFog(Rt),Tt=[],Nt=[];ue&&(Tt.push("ELEVATED_ROADS"),Nt.push(Dt.elevatedLayoutVertexBuffer)),ge&&Tt.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET"),Ye&&(y.context.activeTexture.set(Z.TEXTURE0),jt.imageAtlasTexture&&jt.imageAtlasTexture.bind(Z.LINEAR,Z.CLAMP_TO_EDGE),ot.updatePaintBuffers());let Yt=!1;if(ce&&jt.imageAtlas){const pn=jt.imageAtlas,Rn=s.dN.from(ce),Nn=Rn.getPrimary().scaleSelf(s.q.devicePixelRatio).toString(),Bn=Rn.getSecondary(),Xn=pn.patternPositions.get(Nn),ai=Bn?pn.patternPositions.get(Bn.scaleSelf(s.q.devicePixelRatio).toString()):null;Yt=!!Xn&&!!ai,Xn&&ot.setConstantPatternPositions(Xn,ai)}Q>0&&(Yt||ot.getPatternTransitionVertexBuffer("fill-pattern"))&&Tt.push("FILL_PATTERN_TRANSITION");const Pt=y.getOrCreateProgram(We,{config:ot,overrideFog:At,defines:Tt}),qt=y.translatePosMatrix(Rt.projMatrix,jt,E.paint.get("fill-translate"),E.paint.get("fill-translate-anchor"));ge&&pe.setupShadows(jt.tileID.toUnwrapped(),Pt,"vector-tile",jt.tileID.overscaledZ);const bn=E.paint.get("fill-emissive-strength");if(Ue){ft=Dt.lineIndexBuffer,Mt=Dt.lineSegments;const pn=y.terrain&&y.terrain.renderingToTexture?y.terrain.drapeBufferSize:[Z.drawingBufferWidth,Z.drawingBufferHeight];et=We==="fillOutlinePattern"&&Ye?C0(qt,bn,y,jt,pn,Ve,Q):ty(qt,bn,pn,Ve)}else ft=Dt.indexBuffer,Mt=Dt.triangleSegments,et=Ye?ey(qt,bn,y,jt,Ve,Q):Ou(qt,bn,Ve);y.uploadCommonUniforms(y.context,Pt,Rt.toUnwrapped());let fn=je;(N==="road"&&!j||N==="offset")&&(fn=Pe),Pt.draw(y,_t,fn,f||y.stencilModeForClipping(Rt),M,Un.disabled,et,E.id,Dt.layoutVertexBuffer,ft,Mt,E.paint,y.transform.zoom,ot,Nt)}};y.renderPass===H&&qe(y.depthModeForSublayer(1,y.renderPass==="opaque"?an.ReadWrite:an.ReadOnly),!1),se==="none"&&y.renderPass==="translucent"&&E.paint.get("fill-antialias")&&qe(y.depthModeForSublayer(E.getPaintProperty("fill-outline-color")?2:0,an.ReadOnly),!0)}function Pu(_,o,f,y,w,E,C,M){f.resetLayerRenderingStats(_);const N=_.context,j=N.gl,H=_.transform,Z=f.paint.get("fill-extrusion-pattern"),W=f.paint.get("fill-extrusion-pattern-cross-fade"),Q=Z.constantOr(null),ce=Z.constantOr(1),se=f.paint.get("fill-extrusion-opacity"),ue=_.style.enable3dLights(),pe=f.paint.get(ue&&!ce?"fill-extrusion-ambient-occlusion-wall-radius":"fill-extrusion-ambient-occlusion-radius"),ge=[f.paint.get("fill-extrusion-ambient-occlusion-intensity"),pe],Pe=f.layout.get("fill-extrusion-edge-radius"),Ve=Pe>0&&!f.paint.get("fill-extrusion-rounded-roof"),Ye=Ve?0:Pe,qe=H.projection.name==="globe"?s.dV():0,je=H.projection.name==="globe",Ue=je?s.ah(H.zoom):0,We=[s.aD(H.center.lng),s.aH(H.center.lat)],et=f.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",_t=f.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(et?null:f.lut).toArray01().slice(0,3),ft=f.paint.get("fill-extrusion-flood-light-intensity"),Mt=f.paint.get("fill-extrusion-vertical-scale"),Rt=f.paint.get("fill-extrusion-line-width").constantOr(1)!==0,jt=f.paint.get("fill-extrusion-height-alignment"),ht=f.paint.get("fill-extrusion-base-alignment"),Dt=oa(_,f.paint.get("fill-extrusion-cutoff-fade-range")),ot=[];let At;je&&ot.push("PROJECTION_GLOBE_VIEW"),ge[0]>0&&ot.push("FAUX_AO"),Ve&&ot.push("ZERO_ROOF_RADIUS"),M&&ot.push("HAS_CENTROID"),ft>0&&ot.push("FLOOD_LIGHT"),Dt.shouldRenderCutoff&&ot.push("RENDER_CUTOFF"),Rt&&ot.push("RENDER_WALL_MODE");const Tt=_.renderPass==="shadow",Nt=_.shadowRenderer,Yt=Tt&&!!Nt,Pt=Tt?Un.disabled:Un.backCCW;_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!0);let qt=[0,0,0];if(Nt){const pn=_.style.directionalLight,Rn=_.style.ambientLight;pn&&Rn&&(qt=as(_.style,pn,Rn)),Tt||(ot.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Nt.useNormalOffset&&ot.push("NORMAL_OFFSET")),At=ot.concat(["SHADOWS_SINGLE_CASCADE"])}const bn=Yt?"fillExtrusionDepth":ce?"fillExtrusionPattern":"fillExtrusion",fn=f.getLayerRenderingStats();for(const pn of y){const Rn=o.getTile(pn),Nn=Rn.getBucket(f);if(!Nn||Nn.projection.name!==H.projection.name)continue;let Bn=!1;Nt&&(Bn=Nt.getMaxCascadeForTile(pn.toUnwrapped())===0);const Xn=_.isTileAffectedByFog(pn),ai=Nn.programConfigurations.get(f.id);let Bi=!1;if(Q&&Rn.imageAtlas){const mi=Rn.imageAtlas,yr=s.dN.from(Q),Us=yr.getPrimary().scaleSelf(s.q.devicePixelRatio).toString(),Wi=yr.getSecondary(),ji=mi.patternPositions.get(Us),Zr=Wi?mi.patternPositions.get(Wi.scaleSelf(s.q.devicePixelRatio).toString()):null;Bi=!!ji&&!!Zr,ji&&ai.setConstantPatternPositions(ji,Zr)}W>0&&(Bi||ai.getPatternTransitionVertexBuffer("fill-extrusion-pattern"))&&ot.push("FILL_EXTRUSION_PATTERN_TRANSITION");const pr=_.getOrCreateProgram(bn,{config:ai,defines:Bn?At:ot,overrideFog:Xn});if(_.terrain&&_.terrain.setupElevationDraw(Rn,pr,{useMeterToDem:!0}),!Nn.centroidVertexBuffer){const mi=pr.attributes.a_centroid_pos;mi!==void 0&&j.vertexAttrib2f(mi,0,0)}!Tt&&Nt&&Nt.setupShadows(Rn.tileID.toUnwrapped(),pr,"vector-tile",Rn.tileID.overscaledZ),ce&&(_.context.activeTexture.set(j.TEXTURE0),Rn.imageAtlasTexture&&Rn.imageAtlasTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),ai.updatePaintBuffers());const Gi=f.paint.get("fill-extrusion-vertical-gradient"),qi=1/Nn.tileToMeter;let cs;if(Tt&&Nt){if(bh(Rn.tileID,Nn,_))continue;const mi=Nt.calculateShadowPassMatrixFromTile(Rn.tileID.toUnwrapped());cs=ug(mi,Ye,qi,Mt,jt,ht)}else{const mi=_.translatePosMatrix(pn.expandedProjMatrix,Rn,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),yr=H.projection.createInversionMatrix(H,pn.canonical);cs=ce?J_(mi,_,Gi,se,ge,Ye,qi,pn,Rn,qe,jt,ht,Ue,We,yr,_t,Mt,W):bf(mi,_,Gi,se,ge,Ye,qi,pn,qe,jt,ht,Ue,We,yr,_t,Mt,ft,qt)}_.uploadCommonUniforms(N,pr,pn.toUnwrapped(),null,Dt);let si=Nn.segments;if(H.projection.name==="mercator"&&!Tt&&(si=Nn.getVisibleSegments(Rn.tileID,_.terrain,_.transform.getFrustum(0)),!si.get().length))continue;if(fn)if(Tt)for(const mi of si.get())fn.numRenderedVerticesInShadowPass+=mi.primitiveLength;else for(const mi of si.get())fn.numRenderedVerticesInTransparentPass+=mi.primitiveLength;const li=[];(_.terrain||M)&&li.push(Nn.centroidVertexBuffer),je&&li.push(Nn.layoutVertexExtBuffer),Rt&&li.push(Nn.wallVertexBuffer),pr.draw(_,N.gl.TRIANGLES,w,E,C,Pt,cs,f.id,Nn.layoutVertexBuffer,Nn.indexBuffer,si,f.paint,_.transform.zoom,ai,li)}_.shadowRenderer&&(_.shadowRenderer.useNormalOffset=!1)}function Xa(_,o,f,y,w,E,C,M,N,j,H,Z,W,Q,ce,se,ue,pe,ge){const Pe=_.context,Ve=Pe.gl,Ye=_.transform,qe=_.transform.zoom,je=[],Ue=oa(_,f.paint.get("fill-extrusion-cutoff-fade-range"));j==="clear"?(je.push("CLEAR_SUBPASS"),ge&&(je.push("CLEAR_FROM_TEXTURE"),Pe.activeTexture.set(Ve.TEXTURE0),ge.bind(Ve.LINEAR,Ve.CLAMP_TO_EDGE))):j==="sdf"&&je.push("SDF_SUBPASS"),ue&&je.push("HAS_CENTROID"),Ue.shouldRenderCutoff&&je.push("RENDER_CUTOFF");const We=f.layout.get("fill-extrusion-edge-radius"),et=(_t,ft,Mt,Rt,jt)=>{const ht=ft.programConfigurations.get(f.id),Dt=_.isTileAffectedByFog(_t),ot=_.getOrCreateProgram("fillExtrusionGroundEffect",{config:ht,defines:je,overrideFog:Dt}),At=((Nt,Yt,Pt,qt,bn,fn,pn,Rn,Nn,Bn,Xn)=>({u_matrix:Yt,u_opacity:Pt,u_ao_pass:qt?1:0,u_meter_to_tile:bn,u_ao:fn,u_flood_light_intensity:pn,u_flood_light_color:Rn,u_attenuation:Nn,u_edge_radius:Bn,u_fb:0,u_fb_size:Xn,u_dynamic_offset:1}))(0,Rt,H,N,jt,[Z,W*jt],Q,ce,se,qe>=17?0:We*jt,ge?ge.size[0]:0),Tt=[];ue&&Tt.push(ft.hiddenByLandmarkVertexBuffer),_.uploadCommonUniforms(Pe,ot,_t.toUnwrapped(),null,Ue),ot.draw(_,Pe.gl.TRIANGLES,w,E,C,M,At,f.id,ft.vertexBuffer,ft.indexBuffer,Mt,f.paint,qe,ht,Tt)};for(const _t of y){const ft=o.getTile(_t),Mt=ft.getBucket(f);if(!Mt||Mt.projection.name!==Ye.projection.name||!Mt.groundEffect||Mt.groundEffect&&!Mt.groundEffect.hasData())continue;const Rt=Mt.groundEffect,jt=1/Mt.tileToMeter;{const ht=_.translatePosMatrix(_t.projMatrix,ft,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),Dt=Rt.getDefaultSegment();et(_t,Rt,Dt,ht,jt)}if(pe)for(let ht=0;ht<4;ht++){const Dt=s.dT[ht](_t),ot=o.getTile(Dt);if(!ot)continue;const At=ot.getBucket(f);if(!At||At.projection.name!==Ye.projection.name||!At.groundEffect||At.groundEffect&&!At.groundEffect.hasData())continue;const Tt=At.groundEffect;let Nt,Yt;ht===0?(Nt=[-8192,0,0],Yt=1):ht===1?(Nt=[s.aj,0,0],Yt=0):ht===2?(Nt=[0,-8192,0],Yt=3):(Nt=[0,s.aj,0],Yt=2);const Pt=Tt.regionSegments[Yt];if(!Pt)continue;const qt=new Float32Array(16);s.bo(qt,_t.projMatrix,Nt),et(_t,Tt,Pt,_.translatePosMatrix(qt,ft,f.paint.get("fill-extrusion-translate"),f.paint.get("fill-extrusion-translate-anchor")),jt)}}}function vn(_,o,f,y,w,E,C){y.centroidVertexArray.length===0&&y.createCentroidsBuffer();const M=E?E.findDEMTileFor(f):null;if(!(M&&M.dem||C))return;E&&M&&M.dem&&y.selfDEMTileTimestamp!==M.dem._timestamp&&(y.borderDoneWithNeighborZ=[-1,-1,-1,-1],y.selfDEMTileTimestamp=M.dem._timestamp);const N=pe=>new s.P(Math.ceil((pe+s.dX)*s.dY),0),j=pe=>{const ge=o.getSource().minzoom,Pe=Ye=>{const qe=o.getTileByID(Ye);if(qe&&qe.hasData())return qe.getBucket(w)},Ve=[0,-1,1];for(const Ye of Ve){if(pe.overscaledZ+Ye<ge)continue;const qe=Pe(pe.calculateScaledKey(pe.overscaledZ+Ye));if(qe)return qe}},H=[0,0,0],Z=(pe,ge)=>(H[0]=Math.min(pe.min.y,ge.min.y),H[1]=Math.max(pe.max.y,ge.max.y),H[2]=s.aj-ge.min.x>pe.max.x?ge.min.x-s.aj:pe.max.x,H),W=(pe,ge)=>(H[0]=Math.min(pe.min.x,ge.min.x),H[1]=Math.max(pe.max.x,ge.max.x),H[2]=s.aj-ge.min.y>pe.max.y?ge.min.y-s.aj:pe.max.y,H),Q=[(pe,ge)=>Z(pe,ge),(pe,ge)=>Z(ge,pe),(pe,ge)=>W(pe,ge),(pe,ge)=>W(ge,pe)],ce=(pe,ge,Pe,Ve,Ye,qe,je)=>{if(!E)return 0;const Ue=[[qe?Pe:pe,qe?pe:Pe,0],[qe?Pe:ge,qe?ge:Pe,0]],We=je<0?s.aj+je:je,et=[qe?We:(pe+ge)/2,qe?(pe+ge)/2:We,0];return Pe===0&&je<0||Pe!==0&&je>0?E.getForTilePoints(Ye,[et],!0,Ve):Ue.push(et),E.getForTilePoints(f,Ue,!0,M),Math.max(Ue[0][2],Ue[1][2],et[2])/E.exaggeration()};for(let pe=0;pe<4;pe++){const ge=y.borderFeatureIndices[pe];if(ge.length===0)continue;const Pe=s.dT[pe](f),Ve=j(Pe);if(!(Ve&&Ve instanceof s.dU))continue;const Ye=E?E.findDEMTileFor(Pe):null;if(!(Ye&&Ye.dem||C)||(E&&Ye&&Ye.dem&&y.borderDEMTileTimestamp[pe]!==Ye.dem._timestamp&&(y.borderDoneWithNeighborZ[pe]=-1,y.borderDEMTileTimestamp[pe]=Ye.dem._timestamp),y.borderDoneWithNeighborZ[pe]===Ve.canonical.z))continue;Ve.centroidVertexArray.length===0&&Ve.createCentroidsBuffer();const qe=(pe<2?1:5)-pe,je=Ve.borderDoneWithNeighborZ[qe]!==y.canonical.z,Ue=Ve.borderFeatureIndices[qe];let We=0;if(y.canonical.z!==Ve.canonical.z){for(const et of ge)y.showCentroid(y.featuresOnBorder[et]);if(je)for(const et of Ue)Ve.showCentroid(Ve.featuresOnBorder[et]);y.borderDoneWithNeighborZ[pe]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[qe]=y.canonical.z}for(const et of ge){const _t=y.featuresOnBorder[et],ft=y.centroidData[_t.centroidDataIndex],Mt=_t.borders[pe];let Rt;for(;We<Ue.length;){Rt=Ve.featuresOnBorder[Ue[We]];const jt=Rt.borders[qe];if(jt[1]>Mt[0]+3||jt[0]>Mt[0]-3)break;Ve.showCentroid(Rt),We++}if(Rt&&We<Ue.length){const jt=We;let ht=0;for(;!(Rt.borders[qe][0]>Mt[1]-3)&&(ht++,++We!==Ue.length);)Rt=Ve.featuresOnBorder[Ue[We]];Rt=Ve.featuresOnBorder[Ue[jt]];let Dt=!1;if(ht>=1){const Tt=Rt.borders[qe];Math.abs(Mt[0]-Tt[0])<3&&Math.abs(Mt[1]-Tt[1])<3&&(ht=1,Dt=!0,We=jt+1)}else if(ht===0){y.showCentroid(_t);continue}const ot=Ve.centroidData[Rt.centroidDataIndex];C&&Dt&&(((se=ft).flags|(ue=ot).flags)&s.dW?(se.flags|=s.dW,ue.flags|=s.dW):(se.flags&=2147483647,ue.flags&=2147483647));const At=_t.intersectsCount()>1||Rt.intersectsCount()>1;if(ht>1)We=jt,ft.centroidXY=ot.centroidXY=new s.P(0,0);else if(Ye&&Ye.dem&&!At){const Tt=Q[pe](ft,ot),Nt=pe%2?s.aj-1:0,Yt=ce(Tt[0],Math.min(s.aj-1,Tt[1]),Nt,Ye,Pe,pe<2,Tt[2]);ft.centroidXY=ot.centroidXY=N(Yt)}else At?ft.centroidXY=ot.centroidXY=new s.P(0,0):(ft.centroidXY=y.encodeBorderCentroid(_t),ot.centroidXY=Ve.encodeBorderCentroid(Rt));y.writeCentroidToBuffer(ft),Ve.writeCentroidToBuffer(ot)}else y.showCentroid(_t)}y.borderDoneWithNeighborZ[pe]=Ve.canonical.z,Ve.borderDoneWithNeighborZ[qe]=y.canonical.z}var se,ue;(y.needsCentroidUpdate||!y.centroidVertexBuffer&&y.centroidVertexArray.length!==0)&&y.uploadCentroid(_)}const M0=[1,0,0],P0=[0,1,0],tu=[0,0,1];function bh(_,o,f){const y=f.transform,w=f.shadowRenderer;if(!w)return!0;const E=_.toUnwrapped(),C=y.tileSize*w._cascades[f.currentShadowCascade].scale;let M=o.maxHeight;if(y.elevation){const se=y.elevation.getMinMaxForTile(_);se&&(M+=se.max)}const N=[...w.shadowDirection];N[2]=-N[2];const j=w.computeSimplifiedTileShadowVolume(E,M,C,N);if(!j)return!1;const H=[M0,P0,tu,N,[N[0],0,N[2]],[0,N[1],N[2]]],Z=y.projection.name==="globe",W=y.scaleZoom(C),Q=s.cn.fromInvProjectionMatrix(y.invProjMatrix,y.worldSize,W,!Z),ce=w.getCurrentCascadeFrustum();return Q.intersectsPrecise(j.vertices,j.planes,H)===0||ce.intersectsPrecise(j.vertices,j.planes,H)===0}function Fn(_){return[_[0]*s.dZ,_[1]*s.dZ,_[2]*s.dZ,0]}function Sf(_,o,f,y,w,E,C,M,N){const j=y.getSource(),H=f.globeSharedBuffers;if(!H)return;let Z,W,Q;if(o&&(Z=y.getTile(o)),j instanceof s.aP?(W=j.texture,Q=s.ds(0,0,f.transform)):Z&&o&&(W=Z.texture,Q=s.ds(o.canonical.z,o.canonical.x,f.transform)),!W||!Q)return;_||(Q=s.cE(s.bz(),Q,[1,-1,1]));const ce=f.context,se=ce.gl,ue=w.paint.get("raster-resampling")==="nearest"?se.NEAREST:se.LINEAR,pe=f.colorModeForDrapableLayerRenderPass(E),ge=C.defines;ge.push("GLOBE_POLES");const Pe=new an(se.LEQUAL,an.ReadWrite,f.depthRangeFor3D),Ve=Float32Array.from(f.transform.expandedFarZProjMatrix),Ye=Float32Array.from(s.bh(s.dr(new s.cp(0,0,0))));f.terrain&&f.terrain.prepareDrawTile(),ce.activeTexture.set(se.TEXTURE0),W.bind(ue,se.CLAMP_TO_EDGE),ce.activeTexture.set(se.TEXTURE1),W.bind(ue,se.CLAMP_TO_EDGE),"useMipmap"in W&&ce.extTextureFilterAnisotropic&&f.transform.pitch>20&&se.texParameterf(se.TEXTURE_2D,ce.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,ce.extTextureFilterAnisotropicMax);const[qe,je,Ue,We]=o?H.getPoleBuffers(o.canonical.z,!1):H.getPoleBuffers(0,!0),et=w.paint.get("raster-elevation");let _t;_?(_t=qe,f.renderDefaultNorthPole=et!==0):(_t=je,f.renderDefaultSouthPole=et!==0);const ft=Fn(C.mix),Mt=((jt,ht,Dt,ot,At,Tt,Nt,Yt,Pt,qt,bn,fn,pn)=>fg(jt,ht,Dt,new Float32Array(16),new Float32Array(9),[0,0],ot,[0,0],[0,0,0,0],1,{opacity:1,mix:0},Tt,[0,0],Yt,2,qt,bn,fn,1,0,pn))(Ve,Ye,Q,s.ah(f.transform.zoom),0,w,0,et,0,ft,C.offset,C.range,E),Rt=f.getOrCreateProgram("raster",{defines:ge});f.uploadCommonUniforms(ce,Rt,null),Rt.draw(f,se.TRIANGLES,Pe,N,pe,M,Mt,w.id,_t,Ue,We)}function k0(_){const o=_._nearZ,f=_.projection.farthestPixelDistance(_),y=f-o,w=.2*_.height,E=o+w;return[o,f,(E-w-o)/y,(E-o)/y]}function DT(_,o,f,y){if(_)return o instanceof ja&&_ instanceof Xh?o.getTextureDescriptor(_,f,!0):{texture:_.texture,mix:Fn(y.mix),offset:y.offset,buffer:0,tileSize:1}}var ko=s.d_([{name:"a_index",type:"Int16",components:1}]);class N0{constructor(o,f,y,w){const E={width:y[0],height:y[1],data:null},C=o.gl;this.targetColorTexture=new s.T(o,E,C.RGBA8,{useMipmap:!1}),this.backgroundColorTexture=new s.T(o,E,C.RGBA8,{useMipmap:!1}),this.context=o,this.updateParticleTexture(f,w),this.lastInvalidatedAt=0}updateParticleTexture(o,f){if(this.particleTextureDimension===f.width)return;(this.particleTexture0||this.particleTexture1||this.particleIndexBuffer||this.particleSegment)&&(this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleIndexBuffer.destroy(),this.particleSegment.destroy());const y=this.context.gl,w=f.width*f.height;this.particleTexture0=new s.T(this.context,f,y.RGBA8,{premultiply:!1,useMipmap:!1}),this.particleTexture1=new s.T(this.context,f,y.RGBA8,{premultiply:!1,useMipmap:!1});const E=new s.d$;E.reserve(w);for(let C=0;C<w;C++)E.emplaceBack(C);this.particleIndexBuffer=this.context.createVertexBuffer(E,ko.members,!0),this.particleSegment=s.bd.simpleSegment(0,0,this.particleIndexBuffer.length,0),this.particleTextureDimension=f.width}update(o){return!(this.lastInvalidatedAt<o&&(this.lastInvalidatedAt=s.q.now(),1))}destroy(){this.targetColorTexture.destroy(),this.backgroundColorTexture.destroy(),this.particleIndexBuffer.destroy(),this.particleTexture0.destroy(),this.particleTexture1.destroy(),this.particleSegment.destroy()}}function $x(_,o,f){if(!_)return null;const y=o.getTextureDescriptor(_,f,!0);if(!y)return null;let{texture:w,mix:E,offset:C,tileSize:M,buffer:N,format:j}=y;if(!w||!j)return null;let H=!1;return j==="uint32"&&(H=!0,E[3]=0,E=od(s.e0,E,[0,f.paint.get("raster-particle-max-speed")]),C=ry(s.e0,C,[0,f.paint.get("raster-particle-max-speed")])),{texture:w,textureOffset:[N/(M+2*N),M/(M+2*N)],tileSize:M,scalarData:H,scale:E,offset:C,defines:["RASTER_ARRAY",{uint8:"DATA_FORMAT_UINT8",uint16:"DATA_FORMAT_UINT16",uint32:"DATA_FORMAT_UINT32"}[j]]}}function L0(_){const o=_._nearZ,f=_.projection.farthestPixelDistance(_),y=f-o,w=.2*_.height,E=o+w;return[o,f,(E-w-o)/y,(E-o)/y]}const Gx=new s.am(1,0,0,1),qx=new s.am(0,1,0,1),ca=new s.am(0,0,1,1),gg=new s.am(1,0,1,1),ua=new s.am(0,1,1,1);function ku(_,o,f,y,w,E){for(let C=0;C<f.length;C++)if(w){const j=new s.am(y.r*.8,y.g*.8,y.b*.8,1);ld(_,o,f[C],y,-1,-1,E),ld(_,o,f[C],y,-1,1,E),ld(_,o,f[C],y,1,1,E),ld(_,o,f[C],y,1,-1,E),ld(_,o,f[C],j,0,0,E)}else ld(_,o,f[C],y,0,0,E)}function ld(_,o,f,y,w,E,C){const M=_.context,N=_.transform,j=M.gl,H=N.projection.name==="globe",Z=H?["PROJECTION_GLOBE_VIEW"]:[];let W=s.bw(f.projMatrix);if(H&&s.ah(N.zoom)>0){const ft=s.bg(f.canonical,N),Mt=s.e1(ft);W=s.az(new Float32Array(16),N.globeMatrix,Mt),s.az(W,N.projMatrix,W)}const Q=s.bz();Q[12]+=2*w/(s.q.devicePixelRatio*N.width),Q[13]+=2*E/(s.q.devicePixelRatio*N.height),s.az(W,Q,W);const ce=_.getOrCreateProgram("debug",{defines:Z}),se=o.getTileByID(f.key);_.terrain&&_.terrain.setupElevationDraw(se,ce);const ue=an.disabled,pe=Hn.disabled,ge=_.colorModeForRenderPass(),Pe="$debug";M.activeTexture.set(j.TEXTURE0),_.emptyTexture.bind(j.LINEAR,j.CLAMP_TO_EDGE),H?se._makeGlobeTileDebugBuffers(_.context,N):se._makeDebugTileBoundsBuffers(_.context,N.projection);const Ve=se._tileDebugBuffer||_.debugBuffer,Ye=se._tileDebugIndexBuffer||_.debugIndexBuffer,qe=se._tileDebugSegments||_.debugSegments;if(ce.draw(_,j.LINE_STRIP,ue,pe,ge,Un.disabled,dg(W,y.toPremultipliedRenderColor(null)),Pe,Ve,Ye,qe,null,null,null,[se._globeTileDebugBorderBuffer]),C){const ft=se.latestRawTileData,Mt=Math.floor((ft&&ft.byteLength||0)/1024);let Rt=f.canonical.toString();f.overscaledZ!==f.canonical.z&&(Rt+=` => ${f.overscaledZ}`),Rt+=` ${se.state}`,Rt+=` ${Mt}kb`,function(jt,ht){jt.initDebugOverlayCanvas();const Dt=jt.debugOverlayCanvas,ot=jt.context.gl,At=jt.debugOverlayCanvas.getContext("2d");At.clearRect(0,0,Dt.width,Dt.height),At.shadowColor="white",At.shadowBlur=2,At.lineWidth=1.5,At.strokeStyle="white",At.textBaseline="top",At.font="bold 36px Open Sans, sans-serif",At.fillText(ht,5,5),At.strokeText(ht,5,5),jt.debugOverlayTexture.update(Dt),jt.debugOverlayTexture.bind(ot.LINEAR,ot.CLAMP_TO_EDGE)}(_,Rt)}const je=o.getTile(f).tileSize,Ue=512/Math.min(je,512)*(f.overscaledZ/N.zoom)*.5,We=se._tileDebugTextBuffer||_.debugBuffer,et=se._tileDebugTextIndexBuffer||_.quadTriangleIndexBuffer,_t=se._tileDebugTextSegments||_.debugSegments;ce.draw(_,j.TRIANGLES,ue,pe,kn.alphaBlended,Un.disabled,dg(W,s.am.transparent.toPremultipliedRenderColor(null),Ue),Pe,We,et,_t,null,null,null,[se._globeTileDebugTextBuffer])}function zp(_,o,f,y){cd(_,0,o+f/2,_.transform.width,f,y)}function Bp(_,o,f,y){cd(_,o-f/2,0,f,_.transform.height,y)}function cd(_,o,f,y,w,E){const C=_.context,M=C.gl;M.enable(M.SCISSOR_TEST),M.scissor(o*s.q.devicePixelRatio,f*s.q.devicePixelRatio,y*s.q.devicePixelRatio,w*s.q.devicePixelRatio),C.clear({color:E}),M.disable(M.SCISSOR_TEST)}const z0=s.d_([{name:"a_pos_3f",components:3,type:"Float32"}]),{members:nu}=z0;function $i(_,o,f,y){_.emplaceBack(o,f,y)}class Af{constructor(o){this.vertexArray=new s.e2,this.indices=new s.a_,$i(this.vertexArray,-1,-1,1),$i(this.vertexArray,1,-1,1),$i(this.vertexArray,-1,1,1),$i(this.vertexArray,1,1,1),$i(this.vertexArray,-1,-1,-1),$i(this.vertexArray,1,-1,-1),$i(this.vertexArray,-1,1,-1),$i(this.vertexArray,1,1,-1),this.indices.emplaceBack(5,1,3),this.indices.emplaceBack(3,7,5),this.indices.emplaceBack(6,2,0),this.indices.emplaceBack(0,4,6),this.indices.emplaceBack(2,6,7),this.indices.emplaceBack(7,3,2),this.indices.emplaceBack(5,4,0),this.indices.emplaceBack(0,1,5),this.indices.emplaceBack(0,2,3),this.indices.emplaceBack(3,1,0),this.indices.emplaceBack(7,6,4),this.indices.emplaceBack(4,5,7),this.vertexBuffer=o.createVertexBuffer(this.vertexArray,nu),this.indexBuffer=o.createIndexBuffer(this.indices),this.segment=s.bd.simpleSegment(0,0,36,12)}}function xh(_,o,f,y,w,E){const C=_.context.gl,M=o.paint.get("sky-atmosphere-color"),N=o.paint.get("sky-atmosphere-halo-color"),j=o.paint.get("sky-atmosphere-sun-intensity"),H=((Z,W,Q,ce,se)=>({u_matrix_3f:Z,u_sun_direction:W,u_sun_intensity:Q,u_color_tint_r:[ce.r,ce.g,ce.b,ce.a],u_color_tint_m:[se.r,se.g,se.b,se.a],u_luminance:5e-5}))(s.e4(s.dx(),y),w,j,M.toPremultipliedRenderColor(null),N.toPremultipliedRenderColor(null));C.framebufferTexture2D(C.FRAMEBUFFER,C.COLOR_ATTACHMENT0,C.TEXTURE_CUBE_MAP_POSITIVE_X+E,o.skyboxTexture,0),f.draw(_,C.TRIANGLES,an.disabled,Hn.disabled,kn.unblended,Un.frontCW,H,"skyboxCapture",o.skyboxGeometry.vertexBuffer,o.skyboxGeometry.indexBuffer,o.skyboxGeometry.segment)}const B0=s.d_([{type:"Float32",name:"a_pos",components:3},{type:"Float32",name:"a_uv",components:2}]);class dy{constructor(o){const f=new s.e5;f.emplaceBack(-1,1,1,0,0),f.emplaceBack(1,1,1,1,0),f.emplaceBack(1,-1,1,1,1),f.emplaceBack(-1,-1,1,0,1);const y=new s.a_;y.emplaceBack(0,1,2),y.emplaceBack(2,3,0),this.vertexBuffer=o.createVertexBuffer(f,B0.members),this.indexBuffer=o.createIndexBuffer(y),this.segments=s.bd.simpleSegment(0,0,4,2)}destroy(){this.vertexBuffer.destroy(),this.indexBuffer.destroy(),this.segments.destroy()}}const F0=s.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_size_scale",components:1},{type:"Float32",name:"a_fade_opacity",components:1}]);class wh{constructor(){this.starsCount=16e3,this.sizeMultiplier=.15,this.sizeRange=100,this.intensityRange=200}}class ud{constructor(o){this.colorModeAlphaBlendedWriteRGB=new kn([1,Ss,1,Ss],s.am.transparent,[!0,!0,!0,!1]),this.colorModeWriteAlpha=new kn([1,0,1,0],s.am.transparent,[!1,!1,!1,!0]),this.params=new wh,this.updateNeeded=!0,o.tp.registerParameter(this.params,["Stars"],"starsCount",{min:100,max:16e3,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"sizeMultiplier",{min:.01,max:2,step:.01}),o.tp.registerParameter(this.params,["Stars"],"sizeRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0}),o.tp.registerParameter(this.params,["Stars"],"intensityRange",{min:0,max:200,step:1},()=>{this.updateNeeded=!0})}update(o){const f=o.context;if(!this.atmosphereBuffer||this.updateNeeded){this.updateNeeded=!1,this.atmosphereBuffer=new dy(f);const y=this.params.sizeRange,w=this.params.intensityRange,E=function(H){const Z=s.e7(30),W=[];for(let Q=0;Q<H;++Q){const ce=2*Math.PI*Z(),se=Math.acos(1-2*Z())-.5*Math.PI;W.push(s.cS(Math.cos(se)*Math.cos(ce),Math.cos(se)*Math.sin(ce),Math.sin(se)))}return W}(this.params.starsCount),C=s.e7(300),M=new s.e6,N=new s.a_;let j=0;for(let H=0;H<E.length;++H){const Z=s.bY([],E[H],200),W=Math.max(0,1+.01*y*(1*C()-.5)),Q=Math.max(0,1+.01*w*(1*C()-.5));M.emplaceBack(Z[0],Z[1],Z[2],-1,-1,W,Q),M.emplaceBack(Z[0],Z[1],Z[2],1,-1,W,Q),M.emplaceBack(Z[0],Z[1],Z[2],1,1,W,Q),M.emplaceBack(Z[0],Z[1],Z[2],-1,1,W,Q),N.emplaceBack(j+0,j+1,j+2),N.emplaceBack(j+0,j+2,j+3),j+=4}this.starsVx=f.createVertexBuffer(M,F0.members),this.starsIdx=f.createIndexBuffer(N),this.starsSegments=s.bd.simpleSegment(0,0,M.length,N.length)}}destroy(){this.atmosphereBuffer&&this.atmosphereBuffer.destroy(),this.starsVx&&this.starsVx.destroy(),this.starsIdx&&this.starsIdx.destroy()}drawAtmosphereGlow(o,f){const y=o.context,w=y.gl,E=o.transform,C=new an(w.LEQUAL,an.ReadOnly,[0,1]),M=s.ah(E.zoom),N=o.style.getLut(f.scope),j=f.properties.get("color-use-theme")==="none",H=f.properties.get("color").toNonPremultipliedRenderColor(j?null:N).toArray01(),Z=f.properties.get("high-color-use-theme")==="none",W=f.properties.get("high-color").toNonPremultipliedRenderColor(Z?null:N).toArray01(),Q=f.properties.get("space-color-use-theme")==="none",ce=f.properties.get("space-color").toNonPremultipliedRenderColor(Q?null:N).toArray01(),se=5e-4,ue=s.e8(f.properties.get("horizon-blend"),0,1,se,.25),pe=s.dl(o,y,E)&&ue===se?E.worldSize/(2*Math.PI*1.025)-1:E.globeRadius,ge=o.frameCounter/1e3%1,Pe=s.ae(E.globeCenterInViewSpace),Ve=Math.sqrt(Math.pow(Pe,2)-Math.pow(pe,2)),Ye=Math.acos(Ve/Pe),qe=je=>{const Ue=E.projection.name==="globe"?["PROJECTION_GLOBE_VIEW","FOG"]:["FOG"];je&&Ue.push("ALPHA_PASS");const We=o.getOrCreateProgram("globeAtmosphere",{defines:Ue}),et=((ft,Mt,Rt,jt,ht,Dt,ot,At,Tt,Nt,Yt,Pt)=>({u_frustum_tl:ft,u_frustum_tr:Mt,u_frustum_br:Rt,u_frustum_bl:jt,u_horizon:ht,u_transition:Dt,u_fadeout_range:ot,u_color:At,u_high_color:Tt,u_space_color:Nt,u_temporal_offset:Yt,u_horizon_angle:Pt}))(E.frustumCorners.TL,E.frustumCorners.TR,E.frustumCorners.BR,E.frustumCorners.BL,E.frustumCorners.horizon,M,ue,H,W,ce,ge,Ye);o.uploadCommonUniforms(y,We);const _t=this.atmosphereBuffer;_t&&We.draw(o,w.TRIANGLES,C,Hn.disabled,je?this.colorModeWriteAlpha:this.colorModeAlphaBlendedWriteRGB,Un.backCW,et,je?"atmosphere_glow_alpha":"atmosphere_glow",_t.vertexBuffer,_t.indexBuffer,_t.segments)};qe(!1),qe(!0)}drawStars(o,f){const y=s.ay(f.properties.get("star-intensity"),0,1);if(y===0)return;const w=o.context,E=w.gl,C=o.transform,M=o.getOrCreateProgram("stars"),N=s.b_([]);s.c0(N,N,-C._pitch),s.b$(N,N,-C.angle),s.c0(N,N,s.al(C._center.lat)),s.e9(N,N,-s.al(C._center.lng));const j=s.c3(new Float32Array(16),N),H=s.az([],C.starsProjMatrix,j),Z=s.e4([],j),W=s.ea([],Z),Q=[0,1,0];s.dz(Q,Q,W),s.bY(Q,Q,this.params.sizeMultiplier);const ce=[1,0,0];s.dz(ce,ce,W),s.bY(ce,ce,this.params.sizeMultiplier);const se=(ue=Q,pe=ce,ge=y,{u_matrix:Float32Array.from(H),u_up:ue,u_right:pe,u_intensity_multiplier:ge});var ue,pe,ge;o.uploadCommonUniforms(w,M),this.starsVx&&this.starsIdx&&M.draw(o,E.TRIANGLES,an.disabled,Hn.disabled,this.colorModeAlphaBlendedWriteRGB,Un.disabled,se,"atmosphere_stars",this.starsVx,this.starsIdx,this.starsSegments)}}function Cf(_,o){const f=[..._],y=o.cameraWorldSizeForFog/o.worldSize,w=s.bx([]);return s.cE(w,w,[y,y,1]),s.az(f,w,f),s.az(f,o.worldToFogMatrix,f),f}function Gt(_,o,f,y,w){const E=f.material,C=y.context,{baseColorTexture:M,metallicRoughnessTexture:N}=E.pbrMetallicRoughness,{normalTexture:j,occlusionTexture:H,emissionTexture:Z}=E;function W(ce,se,ue){if(ce&&(_.push(se),C.activeTexture.set(C.gl.TEXTURE0+ue),ce.gfxTexture)){const{minFilter:pe,magFilter:ge,wrapS:Pe,wrapT:Ve}=ce.sampler;ce.gfxTexture.bindExtraParam(pe,ge,Pe,Ve)}}W(M,"HAS_TEXTURE_u_baseColorTexture",sa.BaseColor),W(N,"HAS_TEXTURE_u_metallicRoughnessTexture",sa.MetallicRoughness),W(j,"HAS_TEXTURE_u_normalTexture",sa.Normal),W(H,"HAS_TEXTURE_u_occlusionTexture",sa.Occlusion),W(Z,"HAS_TEXTURE_u_emissionTexture",sa.Emission),w&&(w.texture||(w.texture=new s.eh(y.context,w.image,[w.image.height,w.image.height,w.image.height],C.gl.RGBA8)),C.activeTexture.set(C.gl.TEXTURE0+sa.LUT),w.texture&&w.texture.bind(C.gl.LINEAR,C.gl.CLAMP_TO_EDGE),_.push("APPLY_LUT_ON_GPU")),f.texcoordBuffer&&(_.push("HAS_ATTRIBUTE_a_uv_2f"),o.push(f.texcoordBuffer)),f.colorBuffer&&(_.push(f.colorBuffer.itemSize===12?"HAS_ATTRIBUTE_a_color_3f":"HAS_ATTRIBUTE_a_color_4f"),o.push(f.colorBuffer)),f.normalBuffer&&(_.push("HAS_ATTRIBUTE_a_normal_3f"),o.push(f.normalBuffer)),f.pbrBuffer&&(_.push("HAS_ATTRIBUTE_a_pbr"),_.push("HAS_ATTRIBUTE_a_heightBasedEmissiveStrength"),o.push(f.pbrBuffer)),E.alphaMode!=="OPAQUE"&&E.alphaMode!=="MASK"||_.push("UNPREMULT_TEXTURE_IN_SHADER"),E.defined||_.push("DIFFUSE_SHADED");const Q=y.shadowRenderer;Q&&(_.push("RENDER_SHADOWS","DEPTH_TEXTURE"),Q.useNormalOffset&&_.push("NORMAL_OFFSET"))}function cn(_,o,f,y,w,E){const C=f.paint.get("model-opacity").constantOr(1),M=o.context,N=new an(o.context.gl.LEQUAL,an.ReadWrite,o.depthRangeFor3D),j=o.transform,H=_.mesh,Z=H.material,W=Z.pbrMetallicRoughness,Q=o.style.fog;let ce;ce=o.transform.projection.zAxisUnit==="pixels"?[..._.nodeModelMatrix]:s.az([],y.zScaleMatrix,_.nodeModelMatrix),s.az(ce,y.negCameraPosMatrix,ce);const se=s.bi([],ce);s.ee(se,se);const ue=f.paint.get("model-color-use-theme").constantOr("default")==="none",pe=f.paint.get("model-emissive-strength").constantOr(0),ge=ad(new Float32Array(_.worldViewProjection),new Float32Array(ce),new Float32Array(se),null,o,C,W.baseColorFactor,Z.emissiveFactor,W.metallicFactor,W.roughnessFactor,Z,pe,f),Pe={defines:[]},Ve=[],Ye=o.shadowRenderer;Ye&&(Ye.useNormalOffset=!1),Gt(Pe.defines,Ve,H,o,ue?null:f.lut);let qe=null;if(Q){const We=Cf(_.nodeModelMatrix,o.transform);if(qe=new Float32Array(We),j.projection.name!=="globe"){const et=H.aabb.min,_t=H.aabb.max,[ft,Mt]=Q.getOpacityForBounds(We,et[0],et[1],_t[0],_t[1]);Pe.overrideFog=ft>=Et||Mt>=Et}}const je=oa(o,f.paint.get("model-cutoff-fade-range"));je.shouldRenderCutoff&&Pe.defines.push("RENDER_CUTOFF");const Ue=o.getOrCreateProgram("model",Pe);o.uploadCommonUniforms(M,Ue,null,qe,je),o.renderPass!=="shadow"&&Ye&&Ye.setupShadowsFromMatrix(_.nodeModelMatrix,Ue),Ue.draw(o,M.gl.TRIANGLES,N,w,E,H.material.doubleSided?Un.disabled:Un.backCCW,ge,f.id,H.vertexBuffer,H.indexBuffer,H.segments,f.paint,o.transform.zoom,void 0,Ve)}function hd(_,o,f,y,w,E,C){let M;M=_.projection.name==="globe"?s.ed(f,_):[...f],s.az(M,M,o.matrix);const N=s.az([],y,M);if(o.meshes)for(const j of o.meshes){if(j.material.alphaMode!=="BLEND"){C.push({mesh:j,depth:0,modelIndex:w,worldViewProjection:N,nodeModelMatrix:M});continue}const H=s.ad([],j.centroid,N);!_.isOrthographic&&H[2]<=0||E.push({mesh:j,depth:H[2],modelIndex:w,worldViewProjection:N,nodeModelMatrix:M})}if(o.children)for(const j of o.children)hd(_,j,f,y,w,E,C)}function Lr(_,o,f,y){const w=f.shadowRenderer;if(!w)return;const E=w.getShadowPassDepthMode(),C=w.getShadowPassColorMode(),M=w.calculateShadowPassMatrixFromMatrix(o),N=O0(M);f.getOrCreateProgram("modelDepth",{defines:f._shadowMapDebug?[]:["DEPTH_TEXTURE"]}).draw(f,f.context.gl.TRIANGLES,E,Hn.disabled,C,Un.backCCW,N,y.id,_.vertexBuffer,_.indexBuffer,_.segments,y.paint,f.transform.zoom,void 0,void 0)}function pt(_,o,f){const y=o.updateZoomBasedPaintProperties(),w=function(E,C,M){let N,j,H,Z=E.terrain?E.terrain.exaggeration():0;if(E.terrain&&Z>0){const W=E.terrain,Q=W.findDEMTileFor(M);Q&&Q.dem?N=s.ei.create(W,M,Q):Z=0}if(Z===0&&(C.terrainElevationMin=0,C.terrainElevationMax=0),Z===C.validForExaggeration&&(Z===0||N&&N._demTile&&N._demTile.tileID===C.validForDEMTile.id&&N._dem._timestamp===C.validForDEMTile.timestamp))return!1;for(const W in C.instancesPerModel){const Q=C.instancesPerModel[W];for(let ce=0;ce<Q.instancedDataArray.length;++ce){const se=(N?Z*N.getElevationAt(0|Q.instancedDataArray.float32[16*ce],0|Q.instancedDataArray.float32[16*ce+1],!0,!0):0)+Q.instancesEvaluatedElevation[ce];Q.instancedDataArray.float32[16*ce+6]=se,j=j?Math.min(C.terrainElevationMin,se):se,H=H?Math.max(C.terrainElevationMax,se):se}}return C.terrainElevationMin=j||0,C.terrainElevationMax=H||0,C.validForExaggeration=Z,C.validForDEMTile=N&&N._demTile?{id:N._demTile.tileID,timestamp:N._dem._timestamp}:{id:void 0,timestamp:0},!0}(_,o,f);(y||w)&&(o.uploaded=!1,o.upload(_.context))}const Vr={shadowUniformsInitialized:!1,useSingleShadowCascade:!1,tileMatrix:new Float64Array(16),shadowTileMatrix:new Float32Array(16),aabb:new s.cW([0,0,0],[s.aj,s.aj,0])};function fy(_,o){const f=1<<_.canonical.z,y=o.getFreeCameraOptions().position,w=o.elevation,E=_.canonical.x/f,C=(_.canonical.x+1)/f,M=_.canonical.y/f,N=(_.canonical.y+1)/f;let j=o._centerAltitude;if(w){const Q=w.getMinMaxForTile(_);Q&&Q.max>j&&(j=Q.max)}const H=s.ay(y.x,E,C)-y.x,Z=s.ay(y.y,M,N)-y.y,W=s.c6(j,o.center.lat)-y.z;return o._zoomFromMercatorZ(Math.sqrt(H*H+Z*Z+W*W))}function py(_,o,f,y,w,E,C){const M=_.context,N=_.renderPass==="shadow",j=_.shadowRenderer,H=N&&j?j.getShadowPassDepthMode():new an(M.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D),Z=_.isTileAffectedByFog(E);if(f.meshes)for(const W of f.meshes){const Q=["MODEL_POSITION_ON_GPU"],ce=[];let se,ue,pe;y.instancedDataArray.length>20&&Q.push("INSTANCED_ARRAYS");const ge=oa(_,o.paint.get("model-cutoff-fade-range"));if(ge.shouldRenderCutoff&&Q.push("RENDER_CUTOFF"),N&&j)se=_.getOrCreateProgram("modelDepth",{defines:Q}),ue=O0(C.shadowTileMatrix,C.shadowTileMatrix,Float32Array.from(f.matrix)),pe=j.getShadowPassColorMode();else{Gt(Q,ce,W,_,o.paint.get("model-color-use-theme").constantOr("default")==="none"?null:o.lut),se=_.getOrCreateProgram("model",{defines:Q,overrideFog:Z});const Ve=W.material,Ye=Ve.pbrMetallicRoughness,qe=o.paint.get("model-opacity").constantOr(1),je=o.paint.get("model-emissive-strength").constantOr(0);ue=ad(E.expandedProjMatrix,Float32Array.from(f.matrix),new Float32Array(16),null,_,qe,Ye.baseColorFactor,Ve.emissiveFactor,Ye.metallicFactor,Ye.roughnessFactor,Ve,je,o,w),j&&(C.shadowUniformsInitialized?se.setShadowUniformValues(M,j.getShadowUniformValues()):(j.setupShadows(E.toUnwrapped(),se,"model-tile",E.overscaledZ),C.shadowUniformsInitialized=!0)),pe=ge.shouldRenderCutoff||qe<1||Ve.alphaMode!=="OPAQUE"?kn.alphaBlended:kn.unblended}_.uploadCommonUniforms(M,se,E.toUnwrapped(),null,ge);const Pe=W.material.doubleSided?Un.disabled:Un.backCCW;if(y.instancedDataArray.length>20)ce.push(y.instancedDataBuffer),se.draw(_,M.gl.TRIANGLES,H,Hn.disabled,pe,Pe,ue,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,_.transform.zoom,void 0,ce,y.instancedDataArray.length);else{const Ve=N?"u_instance":"u_normal_matrix";for(let Ye=0;Ye<y.instancedDataArray.length;++Ye)ue[Ve]=new Float32Array(y.instancedDataArray.arrayBuffer,64*Ye,16),se.draw(_,M.gl.TRIANGLES,H,Hn.disabled,pe,Pe,ue,o.id,W.vertexBuffer,W.indexBuffer,W.segments,o.paint,_.transform.zoom,void 0,ce)}}if(f.children)for(const W of f.children)py(_,o,W,y,w,E,C)}const my=[1,-1,1];function iu(_,o,f,y){if(!f.modelManager)return!0;const w=f.modelManager;if(!f.shadowRenderer)return!0;const E=f.shadowRenderer,C=o.aabb;let M=!0,N=_.maxHeight;if(N===0){let H=0;for(const Z in _.instancesPerModel){const W=w.getModel(Z,y);W?H=Math.max(H,Math.max(Math.max(W.aabb.max[0],W.aabb.max[1]),W.aabb.max[2])):M=!1}N=_.maxScale*H*1.41+_.maxVerticalOffset,M&&(_.maxHeight=N)}C.max[2]=N,C.min[2]+=_.terrainElevationMin,C.max[2]+=_.terrainElevationMax,s.ad(C.min,C.min,o.tileMatrix),s.ad(C.max,C.max,o.tileMatrix);const j=C.intersects(E.getCurrentCascadeFrustum());return f.currentShadowCascade===0&&(_.isInsideFirstShadowMapFrustum=j===2),j===0}function V0(_,o){const f=_.uniformValues.u_cutoff_params[0],y=_.uniformValues.u_cutoff_params[1],w=_.uniformValues.u_cutoff_params[2],E=_.uniformValues.u_cutoff_params[3];return y===f||E===w?1:s.ay(((o-f)/(y-f)-w)/(E-w),0,1)}function dd(_,o,f,y){if(o.pitch<20)return 1;const w=o.getWorldToCameraMatrix();s.az(w,w,_);const E=s.ej(f.min[0],f.min[1],f.min[2],1);let C=s.aA(s.ek(),E,w),M=C,N=C;E[1]=f.max[1],C=s.aA(s.ek(),E,w),M=C[1]<M[1]?C:M,N=C[1]>N[1]?C:N,E[0]=f.max[0],C=s.aA(s.ek(),E,w),M=C[1]<M[1]?C:M,N=C[1]>N[1]?C:N,E[1]=f.min[1],C=s.aA(s.ek(),E,w),M=C[1]<M[1]?C:M,N=C[1]>N[1]?C:N;const j=s.ay(y[0],0,1),H=100*o.pixelsPerMeter*s.ay(y[1],0,1),Z=s.ay(y[2],0,1),W=s.el(s.ek(),M,N,j),Q=Math.tan(.5*o.fovX),ce=-W[2]*Q;if(H===0)return W[1]<-Math.abs(ce)?Z:1;const se=(-Math.abs(ce)-W[1])/H,ue=(ge,Pe,Ve)=>(1-Ve)*ge+Ve*Pe,pe=s.ay(ue(1,Z,se),Z,1);return ue(1,pe,s.ay((o.pitch-20)/20,0,1))}class _g{}class Fp{constructor(){this._storage=new Map}getLinesFromTrianglesBuffer(o,f,y){{const Z=this._storage.get(f.id);if(Z)return Z.lastUsedFrameIdx=o,Z.buf}const w=y.gl,E=w.getBufferParameter(w.ELEMENT_ARRAY_BUFFER,w.BUFFER_SIZE),C=new ArrayBuffer(E),M=new Int16Array(C);w.getBufferSubData(w.ELEMENT_ARRAY_BUFFER,0,new Int16Array(C));const N=new s.en;for(let Z=0;Z<E/2;Z+=3){const W=M[Z],Q=M[Z+1],ce=M[Z+2];N.emplaceBack(W,Q),N.emplaceBack(Q,ce),N.emplaceBack(ce,W)}const j=y.bindVertexArrayOES.current,H=new _g;return H.buf=new vs(y,N),H.lastUsedFrameIdx=o,this._storage.set(f.id,H),y.bindVertexArrayOES.set(j),H.buf}update(o){for(const[f,y]of this._storage)o-y.lastUsedFrameIdx>30&&(y.buf.destroy(),this._storage.delete(f))}destroy(){for(const[o,f]of this._storage)f.buf.destroy(),this._storage.delete(o)}}class U0{constructor(o){this.occluderSize=30,this.depthOffset=-1e-4,o.registerParameter(this,["Occlusion"],"occluderSize",{min:1,max:100,step:1}),o.registerParameter(this,["Occlusion"],"depthOffset",{min:-.05,max:0,step:1e-5})}}const Vp=s.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_rainParticleData",components:4}]);class gy{registerParameter(){}registerButton(){}registerBinding(){}refreshUI(){}}class j0{constructor(o,f){this.revealStart=11,this.revealRange=2,o.registerParameter(this,[...f,"Reveal"],"revealStart",{min:0,max:17,step:.05}),o.registerParameter(this,[...f,"Reveal"],"revealRange",{min:.1,max:5.1,step:.05})}}const Wx=s.d_([{type:"Float32",name:"a_pos_2f",components:2}]);class yg{destroy(){this.vignetteVx&&this.vignetteVx.destroy(),this.vignetteIdx&&this.vignetteIdx.destroy()}draw(o,f){const y=o.getOrCreateProgram("vignette");if(!this.vignetteVx||!this.vignetteIdx){const C=new s.eo,M=new s.a_;C.emplaceBack(-1,-1),C.emplaceBack(1,-1),C.emplaceBack(1,1),C.emplaceBack(-1,1),M.emplaceBack(0,1,2),M.emplaceBack(0,2,3),this.vignetteVx=o.context.createVertexBuffer(C,Wx.members),this.vignetteIdx=o.context.createIndexBuffer(M)}const w=s.bd.simpleSegment(0,0,4,6);if(this.vignetteVx&&this.vignetteIdx){o.uploadCommonUniforms(o.context,y);const C={u_vignetteShape:(E={vignetteShape:[f.start,f.range,Math.pow(10,f.fadePower)],vignetteColor:[f.color.r,f.color.g,f.color.b,f.color.a*f.strength]}).vignetteShape,u_vignetteColor:E.vignetteColor};y.draw(o,o.context.gl.TRIANGLES,an.disabled,Hn.disabled,kn.alphaBlended,Un.disabled,C,"vignette",this.vignetteVx,this.vignetteIdx,w)}var E}}class vg{constructor(){this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0}update(o,f){const y=o.getFreeCameraOptions().position,w=y.toAltitude(),E=y.toLngLat(),C=s.al(E.lng),M=s.al(E.lat),N=o.pixelsPerMeter/f,j=C*s.eq,H=s.eq*Math.log(Math.tan(Math.PI/4+M/2));if(this._offsetXPrev===void 0)this._offsetXPrev=0,this._offsetYPrev=0,this._elevationPrev=0,this._accumulatedOffsetX=0,this._accumulatedOffsetY=0,this._accumulatedElevation=0;else{const Z=-this._offsetYPrev+H,W=-this._elevationPrev+w;this._accumulatedOffsetX+=(-this._offsetXPrev+j)*N,this._accumulatedOffsetY+=Z*N,this._accumulatedElevation+=W*N,this._offsetXPrev=j,this._offsetYPrev=H,this._elevationPrev=w}}getPosition(){return[this._accumulatedOffsetX,this._accumulatedOffsetY,this._accumulatedElevation]}}function ru(_,o){return[-(_[0]-Math.floor(_[0]/o)*o),-(_[1]-Math.floor(_[1]/o)*o),-(_[2]-Math.floor(_[2]/o)*o)]}function cc(_){const o=s.e7(1323123451230),f=[];for(let y=0;y<_;++y){const w=2*o()-1,E=2*o()-1,C=2*o()-1;f.push(s.cS(w,E,C))}return f}function Th(_,o,f,y,w){const E=s.ay((w-f)/(y-f),0,1);return(1-E)*_+E*o}class ha{constructor(o){this._movement=new vg,this._accumulatedTimeFromStart=0,this._prevTime=Date.now()/1e3,this._vignette=new yg,this._ppmScaleFactor=o}destroy(){this.particlesVx&&this.particlesVx.destroy(),this.particlesIdx&&this.particlesIdx.destroy(),this._vignette&&this._vignette.destroy()}updateOnRender(o,f){const y=o.transform;this._movement.update(y,this._ppmScaleFactor);const w=y.starsProjMatrix,E=s.b_([]);s.c0(E,E,s.al(90)-y._pitch),s.b$(E,E,-y.angle);const C=s.c3(new Float32Array(16),E),M=s.ep(1,0,0,0,0,0,1,0,0,-1,0,0,0,0,0,1),N=s.ee([],M),j=s.az([],N,C),H=Date.now()/1e3;return this._accumulatedTimeFromStart+=(H-this._prevTime)*f,this._prevTime=H,{projectionMatrix:w,modelviewMatrix:j}}}class Yx extends ha{constructor(o){super(4.25),this._params={overrideStyleParameters:!1,intensity:.5,timeFactor:1,velocityConeAperture:0,velocity:300,boxSize:2500,dropletSizeX:1,dropletSizeYScale:10,distortionStrength:70,screenThinning:{intensity:.57,start:.46,range:1.17,fadePower:.17,affectedRatio:1,particleOffset:-.2},color:{r:.66,g:.68,b:.74,a:.7},direction:{x:-50,y:-35},shapeDirPower:2,shapeNormalPower:1},this._revealParams=new j0(o.tp,["Precipitation","Rain"]),this._vignetteParams={strength:1,start:.7,range:1,fadePower:.4,color:{r:.27,g:.27,b:.27,a:1}},this.particlesCount=16e3}update(o){const f=o.context;if(!this.particlesVx){const y=cc(this.particlesCount),w=new s.er,E=new s.a_;let C=0;const M=s.e7(1323123451230);for(let N=0;N<y.length;++N){const j=y[N],H=[2*M()-1,M(),M(),M()];w.emplaceBack(j[0],j[1],j[2],-1,-1,...H),w.emplaceBack(j[0],j[1],j[2],1,-1,...H),w.emplaceBack(j[0],j[1],j[2],1,1,...H),w.emplaceBack(j[0],j[1],j[2],-1,1,...H),E.emplaceBack(C+0,C+1,C+2),E.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=f.createVertexBuffer(w,Vp.members),this.particlesIdx=f.createIndexBuffer(E)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.rain)return;const f=this._params.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},y=o.transform.zoom;if(f.revealStart>y)return;const w=Th(0,1,f.revealStart,f.revealStart+f.revealRange,y);if(!this.particlesVx||!this.particlesIdx)return;const E=structuredClone(this._params);let C=[-E.direction.x,E.direction.y,-100];s.au(C,C);const M=structuredClone(this._vignetteParams);M.strength*=w,E.overrideStyleParameters||(E.intensity=o.style.rain.state.density,E.timeFactor=o.style.rain.state.intensity,E.color=structuredClone(o.style.rain.state.color),C=structuredClone(o.style.rain.state.direction),E.screenThinning.intensity=o.style.rain.state.centerThinning,E.dropletSizeX=o.style.rain.state.dropletSize[0],E.dropletSizeYScale=o.style.rain.state.dropletSize[1]/o.style.rain.state.dropletSize[0],E.distortionStrength=100*o.style.rain.state.distortionStrength,M.strength=1,M.color=structuredClone(o.style.rain.state.vignetteColor));const N=this.updateOnRender(o,E.timeFactor),j=o.context,H=j.gl,Z=o.transform;this.screenTexture&&this.screenTexture.size[0]===o.width&&this.screenTexture.size[1]===o.height||(this.screenTexture=new s.T(j,{width:o.width,height:o.height,data:null},H.RGBA8)),E.distortionStrength>0&&(j.activeTexture.set(H.TEXTURE0),this.screenTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE),H.copyTexSubImage2D(H.TEXTURE_2D,0,0,0,0,0,o.width,o.height));const W=o.getOrCreateProgram("rainParticle");o.uploadCommonUniforms(j,W),j.activeTexture.set(H.TEXTURE0),this.screenTexture.bind(H.LINEAR,H.CLAMP_TO_EDGE);const Q=[E.color.r,E.color.g,E.color.b,E.color.a],ce=(se,ue)=>{const pe=ru(this._movement.getPosition(),se),ge=E.dropletSizeX,Pe=E.dropletSizeX*E.dropletSizeYScale,Ve=o.width/2,Ye=o.height/2,qe=Th(0,E.screenThinning.start,0,1,E.screenThinning.intensity),je=Th(.001,E.screenThinning.range,0,1,E.screenThinning.intensity),Ue=Th(0,E.screenThinning.particleOffset,0,1,E.screenThinning.intensity),We=(et={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:pe,velocityConeAperture:E.velocityConeAperture,velocity:E.velocity,boxSize:se,rainDropletSize:[ge,Pe],distortionStrength:E.distortionStrength,rainDirection:C,color:Q,screenSize:[Z.width,Z.height],thinningCenterPos:[Ve,Ye],thinningShape:[qe,je,Math.pow(10,E.screenThinning.fadePower)],thinningAffectedRatio:E.screenThinning.affectedRatio,thinningParticleOffset:Ue,shapeDirectionalPower:E.shapeDirPower,shapeNormalPower:E.shapeNormalPower,mode:ue?0:1},{u_modelview:Float32Array.from(et.modelview),u_projection:Float32Array.from(et.projection),u_time:et.time,u_cam_pos:et.camPos,u_texScreen:0,u_velocityConeAperture:et.velocityConeAperture,u_velocity:et.velocity,u_boxSize:et.boxSize,u_rainDropletSize:et.rainDropletSize,u_distortionStrength:et.distortionStrength,u_rainDirection:et.rainDirection,u_color:et.color,u_screenSize:et.screenSize,u_thinningCenterPos:et.thinningCenterPos,u_thinningShape:et.thinningShape,u_thinningAffectedRatio:et.thinningAffectedRatio,u_thinningParticleOffset:et.thinningParticleOffset,u_shapeDirectionalPower:et.shapeDirectionalPower,u_shapeNormalPower:et.shapeNormalPower,u_mode:et.mode});var et;const _t=Math.round(E.intensity*this.particlesCount),ft=s.bd.simpleSegment(0,0,4*_t,2*_t);W.draw(o,H.TRIANGLES,an.disabled,Hn.disabled,kn.alphaBlended,Un.disabled,We,"rain_particles",this.particlesVx,this.particlesIdx,ft)};E.distortionStrength>0&&ce(E.boxSize,!0),ce(E.boxSize,!1),this._vignette.draw(o,M)}}const Df=s.d_([{type:"Float32",name:"a_pos_3f",components:3},{type:"Float32",name:"a_uv",components:2},{type:"Float32",name:"a_snowParticleData",components:4},{type:"Float32",name:"a_snowParticleDataHorizontalOscillation",components:2}]);class wr extends ha{constructor(o){super(2.25),this._params={overrideStyleParameters:!1,intensity:.85,timeFactor:.75,velocityConeAperture:70,velocity:40,horizontalOscillationRadius:4,horizontalOscillationRate:1.5,boxSize:2e3,billboardSize:2,shapeFadeStart:.27,shapeFadePower:.21,screenThinning:{intensity:.4,start:.15,range:1.4,fadePower:.24,affectedRatio:1,particleOffset:-.2},color:{r:1,g:1,b:1,a:1},direction:{x:-50,y:-35}},this._revealParams=new j0(o.tp,["Precipitation","Snow"]),this._vignetteParams={strength:.3,start:.78,range:.46,fadePower:.2,color:{r:1,g:1,b:1,a:1}},this.particlesCount=16e3}update(o){const f=o.context;if(!this.particlesVx){const y=cc(this.particlesCount),w=new s.es,E=new s.a_;let C=0;const M=s.e7(1323123451230);for(let N=0;N<y.length;++N){const j=y[N],H=M(),Z=M(),W=M(),Q=[N/y.length,H,Z,W],ce=[M(),M()];w.emplaceBack(j[0],j[1],j[2],-1,-1,...Q,...ce),w.emplaceBack(j[0],j[1],j[2],1,-1,...Q,...ce),w.emplaceBack(j[0],j[1],j[2],1,1,...Q,...ce),w.emplaceBack(j[0],j[1],j[2],-1,1,...Q,...ce),E.emplaceBack(C+0,C+1,C+2),E.emplaceBack(C+0,C+2,C+3),C+=4}this.particlesVx=f.createVertexBuffer(w,Df.members),this.particlesIdx=f.createIndexBuffer(E)}}draw(o){if(!this._params.overrideStyleParameters&&!o.style.snow)return;const f=structuredClone(this._params);let y=[-f.direction.x,f.direction.y,-100];s.au(y,y);const w=structuredClone(this._vignetteParams),E=f.overrideStyleParameters?this._revealParams:{revealStart:0,revealRange:.01},C=o.transform.zoom;if(E.revealStart>C)return;const M=Th(0,1,E.revealStart,E.revealStart+E.revealRange,C);w.strength*=M,f.overrideStyleParameters||(f.intensity=o.style.snow.state.density,f.timeFactor=o.style.snow.state.intensity,f.color=structuredClone(o.style.snow.state.color),y=structuredClone(o.style.snow.state.direction),f.screenThinning.intensity=o.style.snow.state.centerThinning,f.billboardSize=2.79*o.style.snow.state.flakeSize,w.strength=1,w.color=structuredClone(o.style.snow.state.vignetteColor));const N=this.updateOnRender(o,f.timeFactor);if(!this.particlesVx||!this.particlesIdx)return;const j=o.context,H=j.gl,Z=o.transform,W=o.getOrCreateProgram("snowParticle");o.uploadCommonUniforms(j,W),((Q,ce,se)=>{const ue=ru(this._movement.getPosition(),Q),pe=Z.width/2,ge=Z.height/2,Pe=Th(0,se.screenThinning.start,0,1,se.screenThinning.intensity),Ve=Th(.001,se.screenThinning.range,0,1,se.screenThinning.intensity),Ye=Th(0,se.screenThinning.particleOffset,0,1,se.screenThinning.intensity),qe=(je={modelview:N.modelviewMatrix,projection:N.projectionMatrix,time:this._accumulatedTimeFromStart,camPos:ue,velocityConeAperture:se.velocityConeAperture,velocity:se.velocity,horizontalOscillationRadius:se.horizontalOscillationRadius,horizontalOscillationRate:se.horizontalOscillationRate,boxSize:Q,billboardSize:1*se.billboardSize,simpleShapeParameters:[se.shapeFadeStart,se.shapeFadePower],screenSize:[Z.width,Z.height],thinningCenterPos:[pe,ge],thinningShape:[Pe,Ve,Math.pow(10,se.screenThinning.fadePower)],thinningAffectedRatio:se.screenThinning.affectedRatio,thinningParticleOffset:Ye,color:[se.color.r,se.color.g,se.color.b,se.color.a],direction:y},{u_modelview:Float32Array.from(je.modelview),u_projection:Float32Array.from(je.projection),u_time:je.time,u_cam_pos:je.camPos,u_velocityConeAperture:je.velocityConeAperture,u_velocity:je.velocity,u_horizontalOscillationRadius:je.horizontalOscillationRadius,u_horizontalOscillationRate:je.horizontalOscillationRate,u_boxSize:je.boxSize,u_billboardSize:je.billboardSize,u_simpleShapeParameters:je.simpleShapeParameters,u_screenSize:je.screenSize,u_thinningCenterPos:je.thinningCenterPos,u_thinningShape:je.thinningShape,u_thinningAffectedRatio:je.thinningAffectedRatio,u_thinningParticleOffset:je.thinningParticleOffset,u_particleColor:je.color,u_direction:je.direction});var je;const Ue=Math.round(se.intensity*this.particlesCount),We=s.bd.simpleSegment(0,0,4*Ue,2*Ue);this.particlesVx&&this.particlesIdx&&W.draw(o,H.TRIANGLES,an.disabled,Hn.disabled,kn.alphaBlended,Un.disabled,qe,"snow_particles",this.particlesVx,this.particlesIdx,We)})(f.boxSize,0,f),this._vignette.draw(o,w)}}const Oi={symbol:function(_,o,f,y,w){if(_.renderPass!=="translucent")return;const E=Hn.disabled,C=_.colorModeForRenderPass(),M=f.layout.get("text-variable-anchor"),N=f.layout.get("text-size-scale-range"),j=s.ay(_.scaleFactor,N[0],N[1]);M&&function(W,Q,ce,se,ue,pe,ge,Pe){const Ve=Q.transform,Ye=ue==="map",qe=pe==="map";for(const je of W){const Ue=se.getTile(je),We=Ue.getBucket(ce);if(!We||!We.text||!We.text.segments.get().length)continue;const et=s.bH(We.textSizeData,Ve.zoom,Pe),_t=Xc(je,We.getProjection(),Ve),ft=Ve.calculatePixelsToTileUnitsMatrix(Ue),Mt=Gr(_t,Ue.tileID.canonical,qe,Ye,Ve,We.getProjection(),ft),Rt=We.hasIconTextFit()&&We.hasIconData();et&&yh(We,Ye,qe,ge,Ve,Mt,je,Math.pow(2,Ve.zoom-Ue.tileID.overscaledZ),et,Rt)}}(y,_,f,o,f.layout.get("text-rotation-alignment"),f.layout.get("text-pitch-alignment"),w,j);const H=f.paint.get("icon-opacity").constantOr(1)!==0,Z=f.paint.get("text-opacity").constantOr(1)!==0;f.layout.get("symbol-sort-key").constantOr(1)!==void 0&&(H||Z)?dl(_,o,f,y,E,C):(H&&dl(_,o,f,y,E,C,{onlyIcons:!0}),Z&&dl(_,o,f,y,E,C,{onlyText:!0})),o.map.showCollisionBoxes&&(Ef(_,o,f,y,f.paint.get("text-translate"),f.paint.get("text-translate-anchor"),!0),Ef(_,o,f,y,f.paint.get("icon-translate"),f.paint.get("icon-translate-anchor"),!1))},circle:function(_,o,f,y){if(_.renderPass!=="translucent")return;const w=f.paint.get("circle-opacity"),E=f.paint.get("circle-stroke-width"),C=f.paint.get("circle-stroke-opacity"),M=f.layout.get("circle-sort-key").constantOr(1)!==void 0,N=f.paint.get("circle-emissive-strength");if(w.constantOr(1)===0&&(E.constantOr(1)===0||C.constantOr(1)===0))return;const j=_.context,H=j.gl,Z=_.transform,W=!(!_.terrain||!_.terrain.enabled),Q=f.layout.get("circle-elevation-reference"),ce=_.depthModeForSublayer(0,an.ReadOnly),se=new an(_.context.gl.LEQUAL,an.ReadOnly,_.depthRangeFor3D),ue=Q==="none"||W?ce:se,pe=Hn.disabled,ge=_.colorModeForDrapableLayerRenderPass(N),Pe=Z.projection.name==="globe",Ve=[s.aD(Z.center.lng),s.aH(Z.center.lat)],Ye=[];for(let je=0;je<y.length;je++){const Ue=y[je],We=o.getTile(Ue),et=We.getBucket(f);if(!et||et.projection.name!==Z.projection.name)continue;const _t=et.programConfigurations.get(f.id),ft=et.layoutVertexBuffer,Mt=et.globeExtVertexBuffer,Rt=et.indexBuffer,jt=s.dK(f),ht=[Mt],Dt=_.isTileAffectedByFog(Ue);Pe&&jt.push("PROJECTION_GLOBE_VIEW"),jt.push("DEPTH_D24"),_.terrain&&Z.depthOcclusionForSymbolsAndCircles&&jt.push("DEPTH_OCCLUSION"),et.hasElevation&&(jt.push("ELEVATED_ROADS"),ht.push(et.elevatedLayoutVertexBuffer));const ot=_.getOrCreateProgram("circle",{config:_t,defines:jt,overrideFog:Dt}),At=Z.projection.createInversionMatrix(Z,Ue.canonical),Tt={programConfiguration:_t,program:ot,layoutVertexBuffer:ft,dynamicBuffers:ht,indexBuffer:Rt,uniformValues:s.dL(_,Ue,We,At,Ve,f),tile:We};if(M){const Nt=et.segments.get();for(const Yt of Nt)Ye.push({segments:new s.bd([Yt]),sortKey:Yt.sortKey,state:Tt})}else Ye.push({segments:et.segments,sortKey:0,state:Tt})}M&&Ye.sort((je,Ue)=>je.sortKey-Ue.sortKey);const qe={useDepthForOcclusion:Z.depthOcclusionForSymbolsAndCircles};for(const je of Ye){const{programConfiguration:Ue,program:We,layoutVertexBuffer:et,dynamicBuffers:_t,indexBuffer:ft,uniformValues:Mt,tile:Rt}=je.state,jt=je.segments;_.terrain&&_.terrain.setupElevationDraw(Rt,We,qe),_.uploadCommonUniforms(j,We,Rt.tileID.toUnwrapped()),We.draw(_,H.TRIANGLES,ue,pe,ge,Un.disabled,Mt,f.id,et,ft,jt,f.paint,Z.zoom,Ue,_t)}},heatmap:function(_,o,f,y){if(f.paint.get("heatmap-opacity")!==0)if(_.renderPass==="offscreen"){const w=_.context,E=w.gl,C=Hn.disabled,M=new kn([E.ONE,E.ONE,E.ONE,E.ONE],s.am.transparent,[!0,!0,!0,!0]);(function(Q,ce,se,ue){const pe=Q.gl,ge=ce.width*ue,Pe=ce.height*ue;Q.activeTexture.set(pe.TEXTURE1),Q.viewport.set([0,0,ge,Pe]);let Ve=se.heatmapFbo;if(!Ve||Ve&&(Ve.width!==ge||Ve.height!==Pe)){Ve&&Ve.destroy();const Ye=pe.createTexture();pe.bindTexture(pe.TEXTURE_2D,Ye),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_S,pe.CLAMP_TO_EDGE),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_WRAP_T,pe.CLAMP_TO_EDGE),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MIN_FILTER,pe.LINEAR),pe.texParameteri(pe.TEXTURE_2D,pe.TEXTURE_MAG_FILTER,pe.LINEAR),Ve=se.heatmapFbo=Q.createFramebuffer(ge,Pe,!0,null),function(qe,je,Ue,We,et,_t){const ft=qe.gl;ft.texImage2D(ft.TEXTURE_2D,0,qe.extRenderToTextureHalfFloat?ft.RGBA16F:ft.RGBA,et,_t,0,ft.RGBA,qe.extRenderToTextureHalfFloat?ft.HALF_FLOAT:ft.UNSIGNED_BYTE,null),We.colorAttachment.set(Ue)}(Q,0,Ye,Ve,ge,Pe)}else pe.bindTexture(pe.TEXTURE_2D,Ve.colorAttachment.get()),Q.bindFramebuffer.set(Ve.framebuffer)})(w,_,f,_.transform.projection.name==="globe"?.5:.25),w.clear({color:s.am.transparent});const N=_.transform,j=N.projection.name==="globe",H=j?["PROJECTION_GLOBE_VIEW"]:[],Z=j?Un.frontCCW:Un.disabled,W=[s.aD(N.center.lng),s.aH(N.center.lat)];for(let Q=0;Q<y.length;Q++){const ce=y[Q];if(o.hasRenderableParent(ce))continue;const se=o.getTile(ce),ue=se.getBucket(f);if(!ue||ue.projection.name!==N.projection.name)continue;const pe=_.isTileAffectedByFog(ce),ge=ue.programConfigurations.get(f.id),Pe=_.getOrCreateProgram("heatmap",{config:ge,defines:H,overrideFog:pe}),{zoom:Ve}=_.transform;_.terrain&&_.terrain.setupElevationDraw(se,Pe),_.uploadCommonUniforms(w,Pe,ce.toUnwrapped());const Ye=N.projection.createInversionMatrix(N,ce.canonical);Pe.draw(_,E.TRIANGLES,an.disabled,C,M,Z,iy(_,ce,se,Ye,W,Ve,f.paint.get("heatmap-intensity")),f.id,ue.layoutVertexBuffer,ue.indexBuffer,ue.segments,f.paint,_.transform.zoom,ge,j?[ue.globeExtVertexBuffer]:null)}w.viewport.set([0,0,_.width,_.height])}else _.renderPass==="translucent"&&(_.context.setColorMode(_.colorModeForRenderPass()),function(w,E){const C=w.context,M=C.gl,N=E.heatmapFbo;if(!N)return;C.activeTexture.set(M.TEXTURE0),M.bindTexture(M.TEXTURE_2D,N.colorAttachment.get()),C.activeTexture.set(M.TEXTURE1);let j=E.colorRampTexture;j||(j=E.colorRampTexture=new s.T(C,E.colorRamp,M.RGBA8)),j.bind(M.LINEAR,M.CLAMP_TO_EDGE),w.getOrCreateProgram("heatmapTexture").draw(w,M.TRIANGLES,an.disabled,Hn.disabled,w.colorModeForRenderPass(),Un.disabled,((H,Z,W,Q)=>({u_image:0,u_color_ramp:1,u_opacity:Z.paint.get("heatmap-opacity")}))(0,E),E.id,w.viewportBuffer,w.quadTriangleIndexBuffer,w.viewportSegments,E.paint,w.transform.zoom)}(_,f))},line:function(_,o,f,y){if(_.renderPass!=="translucent")return;const w=f.paint.get("line-opacity"),E=f.paint.get("line-width");if(w.constantOr(1)===0||E.constantOr(1)===0)return;const C=f.paint.get("line-emissive-strength"),M=f.paint.get("line-occlusion-opacity"),N=f.layout.get("line-elevation-reference"),j=f.layout.get("line-width-unit")==="meters",H=N==="sea",Z=!(!_.terrain||!_.terrain.enabled),W=_.context,Q=W.gl;if(f.hasElevatedBuckets&&_.transform.projection.name==="globe")return;const ce=f.layout.get("line-cross-slope"),se=ce!==void 0,ue=ce<1,pe=_.colorModeForDrapableLayerRenderPass(C),ge=_.terrain&&_.terrain.renderingToTexture,Pe=ge?1:s.q.devicePixelRatio,Ve=f.paint.get("line-dasharray"),Ye=Ve.constantOr(1),qe=f.layout.get("line-cap"),je=Ve.constantOr(null),Ue=qe.constantOr(null),We=f.paint.get("line-pattern"),et=We.constantOr(1),_t=f.paint.get("line-pattern-cross-fade"),ft=We.constantOr(null),Mt=f.paint.get("line-opacity").constantOr(1);let Rt=!et&&Mt!==1||_.depthOcclusion&&M>0&&M<1;const jt=f.paint.get("line-gradient"),ht=et?"linePattern":"line",Dt=s.dM(f);let ot;if(ge&&_.terrain&&_.terrain.clipOrMaskOverlapStencilType()&&(Rt=!1),M!==0&&_.depthOcclusion){const Yt=f.paint._values["line-opacity"];Yt&&Yt.value&&Yt.value.kind==="constant"?ot=Yt.value:s.w(`Occlusion opacity for layer ${f.id} is supported only when line-opacity isn't data-driven.`)}E.value.kind!=="constant"&&E.value.isLineProgressConstant===!1&&Dt.push("VARIABLE_LINE_WIDTH");const At=(Yt,Pt,qt,bn,fn,pn)=>{for(const Rn of Yt){const Nn=o.getTile(Rn);if(et&&!Nn.patternsLoaded())continue;const Bn=Nn.getBucket(f);if(!Bn||Bn.elevationType!=="none"&&!fn||Bn.elevationType==="none"&&fn)continue;_.prepareDrawTile();const Xn=[...Pt],ai=_.shadowRenderer,Bi=Bn.elevationType==="road"&&!!ai&&ai.enabled;let pr=[0,0,0];if(Bi){const Ci=_.style.directionalLight,As=_.style.ambientLight;Ci&&As&&(pr=as(_.style,Ci,As)),Xn.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET")}const Gi=Bn.programConfigurations.get(f.id);let qi=!1;if(ft&&Nn.imageAtlas){const Ci=s.dN.from(ft),As=Ci.getPrimary().scaleSelf(Pe).toString(),Tr=Nn.imageAtlas.patternPositions.get(As),mr=Ci.getSecondary(),Er=mr?Nn.imageAtlas.patternPositions.get(mr.scaleSelf(Pe).toString()):null;qi=!!Tr&&!!Er,Tr&&Gi.setConstantPatternPositions(Tr,Er)}_t>0&&(qi||Gi.getPatternTransitionVertexBuffer("line-pattern"))&&Xn.push("LINE_PATTERN_TRANSITION");const cs=_.isTileAffectedByFog(Rn),si=_.getOrCreateProgram(ht,{config:Gi,defines:Xn,overrideFog:cs,overrideRtt:!fn&&void 0});if(!et&&je&&Ue&&Nn.lineAtlas){const Ci=Nn.lineAtlas.getDash(je,Ue);Ci&&Gi.setConstantPatternPositions(Ci)}Bi&&ai.setupShadows(Nn.tileID.toUnwrapped(),si,"vector-tile",Nn.tileID.overscaledZ);let[li,mi]=f.paint.get("line-trim-offset");(Ue==="round"||Ue==="square")&&li!==mi&&(li===0&&(li-=1),mi===1&&(mi+=1));const yr=ge?Rn.projMatrix:null,Us=j?1/Bn.tileToMeter/s.aw(Nn,1,_.transform.zoom):1,Wi=j?1/Bn.tileToMeter/s.aw(Nn,1,Math.floor(_.transform.zoom)):1,ji=et?s.dO(_,Nn,f,yr,Pe,Us,Wi,[li,mi],pr,_t):s.dP(_,Nn,f,yr,Bn.lineClipsArray.length,Pe,Us,Wi,[li,mi],pr);if(jt){const Ci=Bn.gradients[f.id];let As=Ci.texture;if(f.gradientVersion!==Ci.version){let Tr=256;if(f.stepInterpolant){const mr=o.getSource().maxzoom,Er=Rn.canonical.z===mr?Math.ceil(1<<_.transform.maxZoom-Rn.canonical.z):1;Tr=s.ay(s.dQ(Bn.maxLineLength/s.aj*1024*Er),256,W.maxTextureSize)}Ci.gradient=s.dR({expression:f.gradientExpression(),evaluationKey:"lineProgress",resolution:Tr,image:Ci.gradient||void 0,clips:Bn.lineClipsArray}),Ci.texture?Ci.texture.update(Ci.gradient):Ci.texture=new s.T(W,Ci.gradient,Q.RGBA8),Ci.version=f.gradientVersion,As=Ci.texture}W.activeTexture.set(Q.TEXTURE1),As.bind(f.stepInterpolant?Q.NEAREST:Q.LINEAR,Q.CLAMP_TO_EDGE)}Ye&&(W.activeTexture.set(Q.TEXTURE0),Nn.lineAtlasTexture&&Nn.lineAtlasTexture.bind(Q.LINEAR,Q.REPEAT),Gi.updatePaintBuffers()),et&&(W.activeTexture.set(Q.TEXTURE0),Nn.imageAtlasTexture&&Nn.imageAtlasTexture.bind(Q.LINEAR,Q.CLAMP_TO_EDGE),Gi.updatePaintBuffers()),fn&&!H&&_.terrain.setupElevationDraw(Nn,si),_.uploadCommonUniforms(W,si,Rn.toUnwrapped());const Zr=Ci=>{ot!=null&&(ot.value=Mt*M),si.draw(_,Q.TRIANGLES,qt,Ci,pe,Un.disabled,ji,f.id,Bn.layoutVertexBuffer,Bn.indexBuffer,Bn.segments,f.paint,_.transform.zoom,Gi,[Bn.layoutVertexBuffer2,Bn.patternVertexBuffer,Bn.zOffsetVertexBuffer]),ot!=null&&(ot.value=Mt)};if(Rt&&!fn){const Ci=_.stencilModeForClipping(Rn).ref;Ci===0&&ge&&W.clear({stencil:0});const As={func:Q.EQUAL,mask:255};ji.u_alpha_discard_threshold=.8,Zr(new Hn(As,Ci,255,Q.KEEP,Q.KEEP,Q.INVERT)),ji.u_alpha_discard_threshold=0,Zr(new Hn(As,Ci,255,Q.KEEP,Q.KEEP,Q.KEEP))}else ji.u_alpha_discard_threshold=Rt&&fn&&pn?.8:0,Zr(fn?bn:_.stencilModeForClipping(Rn))}};let Tt=_.depthModeForSublayer(0,an.ReadOnly);const Nt=new an(_.depthOcclusion?Q.GREATER:Q.LEQUAL,an.ReadOnly,_.depthRangeFor3D);if(f.hasNonElevatedBuckets){const Yt=!ge&&_.terrain;M!==0&&Yt?s.w(`Occlusion opacity for layer ${f.id} is supported on terrain only if the layer has line-z-offset enabled.`):Yt?s.w(`Cannot render non-elevated lines in immediate mode when terrain is enabled. Layer: ${f.id}.`):At(y,Dt,Tt,Hn.disabled,!1,!0)}if(f.hasElevatedBuckets){N==="hd-road-markup"?Z||(Tt=Nt,Dt.push("ELEVATED_ROADS")):(Dt.push("ELEVATED"),Tt=Nt,se&&Dt.push(ue?"CROSS_SLOPE_HORIZONTAL":"CROSS_SLOPE_VERTICAL"),H&&Dt.push("ELEVATION_REFERENCE_SEA"));const Yt=Rt?_.stencilModeFor3D():Hn.disabled;_.forceTerrainMode=!0,At(y,Dt,Tt,Yt,!0,!0),Rt&&At(y,Dt,Tt,Yt,!0,!1),_.forceTerrainMode=!1}Rt&&(_.resetStencilClippingMasks(),ge&&W.clear({stencil:0})),M===0||_.depthOcclusion||ge||_.layersWithOcclusionOpacity.push(_.currentLayer)},fill:function(_,o,f,y){const w=f.paint.get("fill-color"),E=f.paint.get("fill-opacity");if(E.constantOr(1)===0)return;const C=f.paint.get("fill-emissive-strength"),M=_.colorModeForDrapableLayerRenderPass(C),N=f.paint.get("fill-pattern"),j=_.opaquePassEnabledForLayer()&&!N.constantOr(1)&&w.constantOr(s.am.transparent).a===1&&E.constantOr(0)===1?"opaque":"translucent";let H="none";f.layout.get("fill-elevation-reference")!=="none"?H="road":f.paint.get("fill-z-offset").constantOr(1)!==0&&(H="offset");const Z=!(!_.terrain||!_.terrain.enabled),W={painter:_,sourceCache:o,layer:f,coords:y,colorMode:M,elevationType:H,terrainEnabled:Z,pass:j};if(_.renderPass!=="shadow")if(H!=="offset"){if(hy(W,!1),H==="road"){const Q=!Z&&_.renderPass==="translucent";Q&&mg(_,o,f,y,"geometry"),hy(W,!0,Hn.disabled),Q&&function(ce){const{painter:se,sourceCache:ue,layer:pe,coords:ge,colorMode:Pe}=ce,Ve=se.context.gl,Ye=ce.painter.shadowRenderer,qe=!!Ye&&Ye.enabled,je=new an(se.context.gl.LEQUAL,an.ReadOnly,se.depthRangeFor3D);let Ue=[0,0,0];if(qe){const et=se.style.directionalLight,_t=se.style.ambientLight;et&&_t&&(Ue=as(se.style,et,_t))}const We=et=>{for(const _t of ge){const ft=ue.getTile(_t),Mt=ft.getBucket(pe);if(!Mt)continue;const Rt=Mt.elevatedStructures;if(!Rt)continue;let jt,ht;if(et?(jt=Rt.renderableBridgeSegments,ht=Rt.bridgeProgramConfigurations.get(pe.id)):(jt=Rt.renderableTunnelSegments,ht=Rt.tunnelProgramConfigurations.get(pe.id)),!jt||jt.segments[0].primitiveLength===0)continue;ht.updatePaintBuffers(),se.prepareDrawTile();const Dt=se.isTileAffectedByFog(_t),ot=[];qe&&ot.push("RENDER_SHADOWS","DEPTH_TEXTURE","NORMAL_OFFSET");const At=se.getOrCreateProgram("elevatedStructures",{config:ht,overrideFog:Dt,defines:ot}),Tt=se.translatePosMatrix(_t.projMatrix,ft,pe.paint.get("fill-translate"),pe.paint.get("fill-translate-anchor"));qe&&Ye.setupShadows(ft.tileID.toUnwrapped(),At,"vector-tile",ft.tileID.overscaledZ);const Nt=Hx(Tt,Ue);se.uploadCommonUniforms(se.context,At,_t.toUnwrapped()),At.draw(se,Ve.TRIANGLES,je,Hn.disabled,Pe,Un.backCCW,Nt,pe.id,Rt.vertexBuffer,Rt.indexBuffer,jt,pe.paint,se.transform.zoom,ht,[Rt.vertexBufferNormal])}};We(!0),We(!1)}(W)}}else hy(W,!1,_.stencilModeFor3D());else _.shadowRenderer&&H==="road"&&!Z&&function(Q){const{painter:ce,sourceCache:se,layer:ue,coords:pe}=Q,ge=ce.context.gl,Pe=Q.painter.shadowRenderer;for(const Ve of pe){const Ye=se.getTile(Ve),qe=Ye.getBucket(ue);if(!qe)continue;const je=qe.elevatedStructures;if(!je||!je.shadowCasterSegments||je.shadowCasterSegments.segments[0].primitiveLength===0)continue;ce.prepareDrawTile();const Ue=qe.bufferData.programConfigurations.get(ue.id),We=ce.isTileAffectedByFog(Ve),et=ce.getOrCreateProgram("elevatedStructuresDepth",{config:Ue,overrideFog:We}),_t=Pe.calculateShadowPassMatrixFromTile(Ye.tileID.toUnwrapped());ce.uploadCommonUniforms(ce.context,et,Ve.toUnwrapped());const ft={u_matrix:_t,u_depth_bias:.001};et.draw(ce,ge.TRIANGLES,Pe.getShadowPassDepthMode(),Hn.disabled,Pe.getShadowPassColorMode(),Un.disabled,ft,ue.id,je.vertexBuffer,je.indexBuffer,je.shadowCasterSegments,ue.paint,ce.transform.zoom,Ue)}}(W)},"fill-extrusion":function(_,o,f,y){const w=f.paint.get("fill-extrusion-opacity"),E=_.context,C=E.gl,M=_.terrain,N=M&&M.renderingToTexture;if(w===0)return;const j=_.conflationActive&&_.style.isLayerClipped(f,o.getSource()),H=_.style.order.indexOf(f.fqid);if(j&&function(Z,W,Q,ce,se){for(const ue of ce){const pe=W.getTile(ue).getBucket(Q);pe&&(pe.updateReplacement(ue,Z.replacementSource,se),pe.uploadCentroid(Z.context))}}(_,o,f,y,H),M||j)for(const Z of y){const W=o.getTile(Z).getBucket(f);W&&vn(_.context,o,Z,W,f,M,j)}if(_.renderPass==="shadow"&&_.shadowRenderer){const Z=_.shadowRenderer;if(M&&w<.65&&f._transitionablePaint._values["fill-extrusion-opacity"].value.expression instanceof s.ab)return;const W=Z.getShadowPassDepthMode(),Q=Z.getShadowPassColorMode();Pu(_,o,f,y,W,Hn.disabled,Q,j)}else if(_.renderPass==="translucent"){const Z=!f.paint.get("fill-extrusion-pattern").constantOr(1),W=f.paint.get("fill-extrusion-color").constantOr(s.am.white);if(!N&&W.a!==0){const Q=new an(_.context.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D);w===1&&Z?Pu(_,o,f,y,Q,Hn.disabled,kn.unblended,j):(Pu(_,o,f,y,Q,Hn.disabled,kn.disabled,j),Pu(_,o,f,y,Q,_.stencilModeFor3D(),_.colorModeForRenderPass(),j),_.resetStencilClippingMasks())}if(_.style.enable3dLights()&&Z&&(!M&&_.transform.projection.name!=="globe"||N)){const Q=f.paint.get("fill-extrusion-opacity"),ce=f.paint.get("fill-extrusion-ambient-occlusion-intensity"),se=f.paint.get("fill-extrusion-ambient-occlusion-ground-radius"),ue=f.paint.get("fill-extrusion-flood-light-intensity"),pe=f.paint.get("fill-extrusion-flood-light-color-use-theme").constantOr("default")==="none",ge=f.paint.get("fill-extrusion-flood-light-color").toNonPremultipliedRenderColor(pe?null:f.lut).toArray01().slice(0,3),Pe=ce>0&&se>0,Ve=ue>0,Ye=(je,Ue,We)=>(1-We)*je+We*Ue,qe=je=>{const Ue=_.depthModeForSublayer(1,an.ReadOnly,C.LEQUAL,!0),We=f.paint.get(je?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),et=Ye(.1,3,We),_t=_._showOverdrawInspector;if(!_t){const ft=new Hn({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),Mt=new kn([C.ONE,C.ONE,C.ONE,C.ONE],s.am.transparent,[!1,!1,!1,!0],C.MIN);Xa(_,o,f,y,Ue,ft,Mt,Un.disabled,je,"sdf",Q,ce,se,ue,ge,et,j,!1)}{const ft=_t?Hn.disabled:new Hn({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),Mt=_t?_.colorModeForRenderPass():new kn([C.ONE_MINUS_DST_ALPHA,C.DST_ALPHA,C.ONE,C.ONE],s.am.transparent,[!0,!0,!0,!0]);Xa(_,o,f,y,Ue,ft,Mt,Un.disabled,je,"color",Q,ce,se,ue,ge,et,j,!1)}};if(N){const je=(Ue,We,et)=>{const _t=_.depthModeForSublayer(1,an.ReadOnly,C.LEQUAL,!1),ft=f.paint.get(Ue?"fill-extrusion-ambient-occlusion-ground-attenuation":"fill-extrusion-flood-light-ground-attenuation"),Mt=Ye(.1,3,ft);{const Rt=new kn([C.ONE,C.ONE,C.ONE,C.ONE],s.am.transparent,[!1,!1,!1,!0]);Xa(_,o,f,y,_t,Hn.disabled,Rt,Un.disabled,Ue,"clear",Q,ce,se,ue,ge,Mt,j,We)}{const Rt=new Hn({func:C.ALWAYS,mask:255},255,255,C.KEEP,C.KEEP,C.REPLACE),jt=new kn([C.ONE,C.ONE,C.ONE,C.ONE],s.am.transparent,[!1,!1,!1,!0],C.MIN);Xa(_,o,f,y,_t,Rt,jt,Un.disabled,Ue,"sdf",Q,ce,se,ue,ge,Mt,j,We)}{const Rt=Ue?C.ZERO:C.ONE_MINUS_DST_ALPHA,jt=new Hn({func:C.EQUAL,mask:255},255,255,C.KEEP,C.DECR,C.DECR),ht=new kn([Rt,C.DST_ALPHA,C.ONE_MINUS_DST_ALPHA,C.ZERO],s.am.transparent,[!0,!0,!0,!0]);Xa(_,o,f,y,_t,jt,ht,Un.disabled,Ue,"color",Q,ce,se,ue,ge,Mt,j,We)}{const Rt=new kn([C.ONE,C.ONE,C.ONE,Ue?C.ZERO:C.ONE],s.am.transparent,[!1,!1,!1,!0],Ue?C.FUNC_ADD:C.MAX);Xa(_,o,f,y,_t,Hn.disabled,Rt,Un.disabled,Ue,"clear",Q,ce,se,ue,ge,Mt,j,We,et)}};if(Pe||Ve){let Ue;if(_.prepareDrawTile(),M){const We=M.drapeBufferSize[0],et=M.drapeBufferSize[1];Ue=M.framebufferCopyTexture,Ue&&(!Ue||Ue.size[0]===We&&Ue.size[1]===et)||(Ue&&Ue.destroy(),Ue=M.framebufferCopyTexture=new s.T(E,new s.r({width:We,height:et}),C.RGBA8)),Ue.bind(C.LINEAR,C.CLAMP_TO_EDGE),C.copyTexSubImage2D(C.TEXTURE_2D,0,0,0,0,0,We,et)}Pe&&je(!0,!1,Ue),Ve&&je(!1,!0,Ue)}}else Pe&&qe(!0),Ve&&qe(!1),(Pe||Ve)&&_.resetStencilClippingMasks()}}},building:function(_,o,f,y){},hillshade:function(_,o,f,y){if(_.renderPass!=="offscreen"&&_.renderPass!=="translucent"||_.style.disableElevatedTerrain)return;const w=_.context,E=_.terrain&&_.terrain.renderingToTexture,[C,M]=_.renderPass!=="translucent"||E?[{},y]:_.stencilConfigForOverlap(y);for(const N of M){const j=o.getTile(N);if(j.needsHillshadePrepare&&_.renderPass==="offscreen")g0(_,j,f);else if(_.renderPass==="translucent"){const H=_.depthModeForSublayer(0,an.ReadOnly),Z=f.paint.get("hillshade-emissive-strength"),W=_.colorModeForDrapableLayerRenderPass(Z),Q=E&&_.terrain?_.terrain.stencilModeForRTTOverlap(N):C[N.overscaledZ];Fx(_,N,j,f,H,Q,W)}}w.viewport.set([0,0,_.width,_.height]),_.resetStencilClippingMasks()},raster:function(_,o,f,y,w,E){if(_.renderPass!=="translucent"||f.paint.get("raster-opacity")===0)return;const C=_.transform.projection.name==="globe",M=f.paint.get("raster-elevation")!==0,N=M&&C;if(_.renderElevatedRasterBackface&&!N)return;const j=_.context,H=j.gl,Z=o.getSource(),W=function(qe,je,Ue,We){const et=je.paint.get("raster-color"),_t=qe.type==="raster-array",ft=[],Mt=je.paint.get("raster-resampling"),Rt=je.paint.get("raster-color-mix");let jt=je.paint.get("raster-color-range");const ht=[Rt[0],Rt[1],Rt[2],0],Dt=Rt[3];let ot=Mt==="nearest"?We.NEAREST:We.LINEAR;if(_t&&(ft.push("RASTER_ARRAY"),et||ft.push("RASTER_COLOR"),Mt==="linear"&&ft.push("RASTER_ARRAY_LINEAR"),ot=We.NEAREST,!jt&&qe.rasterLayers)){const At=qe.rasterLayers.find(({id:Tt})=>Tt===je.sourceLayer);At&&At.fields&&At.fields.range&&(jt=At.fields.range)}if(jt=jt||[0,1],et){ft.push("RASTER_COLOR"),Ue.activeTexture.set(We.TEXTURE2),je.updateColorRamp(jt);let At=je.colorRampTexture;At||(At=je.colorRampTexture=new s.T(Ue,je.colorRamp,We.RGBA8)),At.bind(We.LINEAR,We.CLAMP_TO_EDGE)}return{mix:ht,range:jt,offset:Dt,defines:ft,resampling:ot}}(Z,f,j,H);if(Z instanceof s.aP&&!y.length&&!C)return;const Q=f.paint.get("raster-emissive-strength"),ce=_.colorModeForDrapableLayerRenderPass(Q),se=_.terrain&&_.terrain.renderingToTexture,ue=!_.options.moving,pe=f.paint.get("raster-resampling")==="nearest"?H.NEAREST:H.LINEAR;if(Z instanceof s.aP&&!y.length&&(Z.onNorthPole||Z.onSouthPole)){const qe=M?_.stencilModeFor3D():Hn.disabled;return void Sf(!!Z.onNorthPole,null,_,o,f,Q,W,Un.disabled,qe)}if(!y.length)return;const[ge,Pe]=Z instanceof s.aP||se?[{},y]:_.stencilConfigForOverlap(y),Ve=Pe[Pe.length-1].overscaledZ;N&&W.defines.push("PROJECTION_GLOBE_VIEW"),M&&W.defines.push("RENDER_CUTOFF");const Ye=(qe,je,Ue)=>{for(const We of qe){const et=We.toUnwrapped(),_t=o.getTile(We);if(se&&(!_t||!_t.hasData()))continue;j.activeTexture.set(H.TEXTURE0);const ft=DT(_t,Z,f,W);if(!ft||!ft.texture)continue;const{texture:Mt,mix:Rt,offset:jt,tileSize:ht,buffer:Dt}=ft;let ot,At;se?(ot=an.disabled,At=We.projMatrix):M?(ot=new an(H.LEQUAL,an.ReadWrite,_.depthRangeFor3D),At=C?Float32Array.from(_.transform.expandedFarZProjMatrix):_.transform.calculateProjMatrix(et,ue)):(ot=_.depthModeForSublayer(We.overscaledZ-Ve,f.paint.get("raster-opacity")===1?an.ReadWrite:an.ReadOnly,H.LESS),At=_.transform.calculateProjMatrix(et,ue));const Tt=_.terrain&&se?_.terrain.stencilModeForRTTOverlap(We):ge[We.overscaledZ],Nt=E?0:f.paint.get("raster-fade-duration");_t.registerFadeDuration(Nt);const Yt=o.findLoadedParent(We,0),Pt=Du(_t,Yt,o,_.transform,Nt);let qt,bn;_.terrain&&_.terrain.prepareDrawTile(),j.activeTexture.set(H.TEXTURE0),Mt.bind(pe,H.CLAMP_TO_EDGE),j.activeTexture.set(H.TEXTURE1),Yt?(Yt.texture&&Yt.texture.bind(pe,H.CLAMP_TO_EDGE),qt=Math.pow(2,Yt.tileID.overscaledZ-_t.tileID.overscaledZ),bn=[_t.tileID.canonical.x*qt%1,_t.tileID.canonical.y*qt%1]):Mt.bind(pe,H.CLAMP_TO_EDGE),"useMipmap"in Mt&&j.extTextureFilterAnisotropic&&_.transform.pitch>20&&H.texParameterf(H.TEXTURE_2D,j.extTextureFilterAnisotropic.TEXTURE_MAX_ANISOTROPY_EXT,j.extTextureFilterAnisotropicMax);const fn=_.transform;let pn;const Rn=M?k0(fn):[0,0,0,0];let Nn,Bn,Xn,ai,Bi,pr=0;if(N&&Z instanceof s.aP&&Z.coordinates.length>3)Nn=Float32Array.from(s.bh(s.dr(new s.cp(0,0,0)))),Bn=Float32Array.from(fn.globeMatrix),Xn=Float32Array.from(s.dm(fn)),ai=[s.aD(fn.center.lng),s.aH(fn.center.lat)],pn=Z.elevatedGlobePerspectiveTransform,Bi=Z.elevatedGlobeGridMatrix||new Float32Array(9);else if(N){const si=s.dn(We.canonical);pr=s.dp(si.getCenter().lat),Nn=Float32Array.from(s.bh(s.dr(We.canonical))),Bn=Float32Array.from(fn.globeMatrix),Xn=Float32Array.from(s.dm(fn)),ai=[s.aD(fn.center.lng),s.aH(fn.center.lat)],pn=[0,0],Bi=Float32Array.from(s.dq(We.canonical,si,pr,fn.worldSize/fn._pixelsPerMercatorPixel))}else pn=Z instanceof s.aP?Z.perspectiveTransform:[0,0],Nn=new Float32Array(16),Bn=new Float32Array(9),Xn=new Float32Array(16),ai=[0,0],Bi=new Float32Array(9);const Gi=fg(At,Nn,Bn,Xn,Bi,bn||[0,0],s.ah(_.transform.zoom),ai,Rn,qt||1,Pt,f,pn,M?f.paint.get("raster-elevation"):0,2,Rt,jt,W.range,ht,Dt,Q),qi=_.isTileAffectedByFog(We),cs=_.getOrCreateProgram("raster",{defines:W.defines,overrideFog:qi});if(_.uploadCommonUniforms(j,cs,et),Z instanceof s.aP){const si=Z.elevatedGlobeVertexBuffer,li=Z.elevatedGlobeIndexBuffer;if(se||!C)Z.boundsBuffer&&Z.boundsSegments&&cs.draw(_,H.TRIANGLES,ot,Hn.disabled,ce,Un.disabled,Gi,f.id,Z.boundsBuffer,_.quadTriangleIndexBuffer,Z.boundsSegments);else if(si&&li){const mi=fn.zoom<=s.cL?Z.elevatedGlobeSegments:Z.getSegmentsForLongitude(fn.center.lng);mi&&cs.draw(_,H.TRIANGLES,ot,Hn.disabled,ce,je,Gi,f.id,si,li,mi)}}else if(N){ot=new an(H.LEQUAL,an.ReadOnly,_.depthRangeFor3D);const si=_.globeSharedBuffers;if(si){const[li,mi,yr]=si.getGridBuffers(pr,!1);cs.draw(_,H.TRIANGLES,ot,Ue||Tt,_.colorModeForRenderPass(),je,Gi,f.id,li,mi,yr)}}else{const{tileBoundsBuffer:si,tileBoundsIndexBuffer:li,tileBoundsSegments:mi}=_.getTileBoundsBuffers(_t);cs.draw(_,H.TRIANGLES,ot,Tt,ce,Un.disabled,Gi,f.id,si,li,mi)}}if(!(Z instanceof s.aP)&&N)for(const We of qe){const et=We.canonical.y===(1<<We.canonical.z)-1;We.canonical.y===0&&Sf(!0,We,_,o,f,Q,W,je,Ue||Hn.disabled),et&&Sf(!1,We,_,o,f,Q,W,je===Un.frontCW?Un.backCW:Un.frontCW,Ue||Hn.disabled)}};N?Ye(Pe,_.renderElevatedRasterBackface?Un.backCW:Un.frontCW,_.stencilModeFor3D()):Ye(Pe,Un.disabled,void 0),_.resetStencilClippingMasks()},"raster-particle":function(_,o,f,y,w,E){_.renderPass==="offscreen"&&function(C,M,N,j){if(!j.length)return;const H=C.context,Z=H.gl,W=M.getSource();if(!(W instanceof ja))return;const Q=Math.ceil(Math.sqrt(N.paint.get("raster-particle-count")));let ce=N.particlePositionRGBAImage;if(!ce||ce.width!==Q){const Pe=function(Ve){const Ye=Ve*Ve,qe=new Uint8Array(4*Ye),je=function(We){return We|=0,We=Math.imul(2747636419^We,2654435769),We=Math.imul(We^We>>>16,2654435769),((We=Math.imul(We^We>>>16,2654435769))>>>0)/4294967296},Ue=1/1.1;for(let We=0;We<Ye;We++){const et=Ue*(je(2*We+0)+gh),_t=Ue*(je(2*We+1)+gh),ft=255*et%1,Mt=255*_t%1,Rt=ft,jt=_t-Mt/255,ht=Mt;qe[4*We+0]=255*(et-ft/255),qe[4*We+1]=255*Rt,qe[4*We+2]=255*jt,qe[4*We+3]=255*ht}return qe}(Q);ce=N.particlePositionRGBAImage=new s.r({width:Q,height:Q},Pe)}let se=N.particleFramebuffer;se?se.width!==Q&&(se.destroy(),se=N.particleFramebuffer=H.createFramebuffer(Q,Q,!0,null)):se=N.particleFramebuffer=H.createFramebuffer(Q,Q,!0,null);const ue=[];for(const Pe of j){const Ve=M.getTile(Pe);if(!(Ve instanceof Xh))continue;const Ye=$x(Ve,W,N);if(!Ye)continue;const qe=[Ve.tileSize,Ve.tileSize];let je=N.tileFramebuffer;je||(je=N.tileFramebuffer=H.createFramebuffer(qe[0],qe[1],!0,null));let Ue=Ve.rasterParticleState;Ue||(Ue=Ve.rasterParticleState=new N0(H,Pe,qe,ce));const We=Ue.update(N.lastInvalidatedAt);Ue.particleTextureDimension!==Q&&Ue.updateParticleTexture(Pe,ce);const et=Ue.targetColorTexture;Ue.targetColorTexture=Ue.backgroundColorTexture,Ue.backgroundColorTexture=et;const _t=Ue.particleTexture0;Ue.particleTexture0=Ue.particleTexture1,Ue.particleTexture1=_t,ue.push([Pe,Ye,Ue,We])}if(ue.length===0)return;const pe=s.q.now(),ge=N.previousDrawTimestamp?.001*(pe-N.previousDrawTimestamp):.0167;if(N.previousDrawTimestamp=pe,N.hasColorMap()){H.activeTexture.set(Z.TEXTURE0+2);let Pe=N.colorRampTexture;Pe||(Pe=N.colorRampTexture=new s.T(H,N.colorRamp,Z.RGBA8)),Pe.bind(Z.LINEAR,Z.CLAMP_TO_EDGE)}H.bindFramebuffer.set(N.tileFramebuffer.framebuffer),function(Pe,Ve,Ye){const qe=Pe.context,je=qe.gl,Ue=Ve.tileFramebuffer;qe.activeTexture.set(je.TEXTURE0);const We={u_texture:0,u_opacity:1.05*(_t=Ve.paint.get("raster-particle-fade-opacity-factor"))/(_t+.05)},et=Pe.getOrCreateProgram("rasterParticleTexture",{defines:[],overrideFog:!1});var _t;for(const ft of Ye){const[,,Mt,Rt]=ft;Ue.colorAttachment.set(Mt.targetColorTexture.texture),qe.viewport.set([0,0,Ue.width,Ue.height]),qe.clear({color:s.am.transparent}),Rt&&(Mt.backgroundColorTexture.bind(je.NEAREST,je.CLAMP_TO_EDGE),et.draw(Pe,je.TRIANGLES,an.disabled,Hn.disabled,kn.alphaBlended,Un.disabled,We,Ve.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments))}}(C,N,ue),function(Pe,Ve,Ye,qe){const je=Pe.context,Ue=je.gl,We=Ye.tileFramebuffer,et=Pe.transform.projection.name==="globe",_t=Ye.paint.get("raster-particle-max-speed");for(const ft of qe){const[Mt,Rt,jt]=ft;je.activeTexture.set(Ue.TEXTURE0+0),Rt.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),We.colorAttachment.set(jt.targetColorTexture.texture);const ht=Pe.getOrCreateProgram("rasterParticleDraw",{defines:Rt.defines,overrideFog:!1});je.activeTexture.set(Ue.TEXTURE0+1);const Dt=Rt.scalarData?[]:[0,1,2,3].map(Tt=>s.dT[Tt](Mt));Dt.push(Mt);const ot=Mt.canonical.x,At=Mt.canonical.y;for(const Tt of Dt){const Nt=Ve.getTile(et?Tt.wrapped():Tt);if(!Nt)continue;const Yt=Nt.rasterParticleState;if(!Yt)continue;const Pt=Tt.canonical.x+(1<<Tt.canonical.z)*(Tt.wrap-Mt.wrap),qt=Tt.canonical.y;Yt.particleTexture0.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const bn=sy(1,Yt.particleTexture0.size[0],[Pt-ot,qt-At],0,Rt.texture.size,2,_t,Rt.textureOffset,Rt.scale,Rt.offset);ht.draw(Pe,Ue.POINTS,an.disabled,Hn.disabled,kn.alphaBlended,Un.disabled,bn,Ye.id,Yt.particleIndexBuffer,void 0,Yt.particleSegment)}}}(C,M,N,ue),H.bindFramebuffer.set(N.particleFramebuffer.framebuffer),function(Pe,Ve,Ye,qe){const je=Pe.context,Ue=je.gl,We=Ve.paint.get("raster-particle-max-speed"),et=qe*Ve.paint.get("raster-particle-speed-factor")*.15,_t=function(Mt){return Math.pow(Mt,6)}(.01+1*Ve.paint.get("raster-particle-reset-rate-factor")),ft=Ve.particleFramebuffer;je.viewport.set([0,0,ft.width,ft.height]);for(const Mt of Ye){const[,Rt,jt]=Mt;je.activeTexture.set(Ue.TEXTURE0+0),Rt.texture.bind(Ue.LINEAR,Ue.CLAMP_TO_EDGE),je.activeTexture.set(Ue.TEXTURE0+1);const ht=jt.particleTexture0;ht.bind(Ue.NEAREST,Ue.CLAMP_TO_EDGE);const Dt=Iu(1,ht.size[0],0,Rt.texture.size,We,et,_t,Rt.textureOffset,Rt.scale,Rt.offset);ft.colorAttachment.set(jt.particleTexture1.texture),je.clear({color:s.am.transparent}),Pe.getOrCreateProgram("rasterParticleUpdate",{defines:Rt.defines}).draw(Pe,Ue.TRIANGLES,an.disabled,Hn.disabled,kn.unblended,Un.disabled,Dt,Ve.id,Pe.viewportBuffer,Pe.quadTriangleIndexBuffer,Pe.viewportSegments)}}(C,N,ue,ge)}(_,o,f,y),_.renderPass==="translucent"&&(function(C,M,N,j,H){const Z=C.context,W=Z.gl,Q=M.getSource().tileSize,ce=5*(1-s.af(s.cx,s.cx+1,C.transform.zoom))*Q+N.paint.get("raster-particle-elevation"),se=!C.options.moving,ue=C.transform.projection.name==="globe";if(!j.length)return;const[pe,ge]=C.stencilConfigForOverlap(j),Pe=[];ue&&Pe.push("PROJECTION_GLOBE_VIEW");const Ve=C.stencilModeFor3D();for(const Ye of ge){const qe=Ye.toUnwrapped(),je=M.getTile(Ye);if(!je.rasterParticleState)continue;const Ue=je.rasterParticleState,We=100;je.registerFadeDuration(We);const et=M.findLoadedParent(Ye,0),_t=Du(je,et,M,C.transform,We);let ft,Mt;C.terrain&&C.terrain.prepareDrawTile(),Z.activeTexture.set(W.TEXTURE0),Ue.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),Z.activeTexture.set(W.TEXTURE1),et&&et.rasterParticleState?(et.rasterParticleState.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE),ft=Math.pow(2,et.tileID.overscaledZ-je.tileID.overscaledZ),Mt=[je.tileID.canonical.x*ft%1,je.tileID.canonical.y*ft%1]):Ue.targetColorTexture.bind(W.LINEAR,W.CLAMP_TO_EDGE);const Rt=ue?Float32Array.from(C.transform.expandedFarZProjMatrix):C.transform.calculateProjMatrix(qe,se),jt=C.transform,ht=L0(jt),Dt=s.dn(Ye.canonical),ot=s.dp(Dt.getCenter().lat);let At,Tt,Nt,Yt,Pt;ue?(At=Float32Array.from(s.bh(s.dr(Ye.canonical))),Tt=Float32Array.from(jt.globeMatrix),Nt=Float32Array.from(s.dm(jt)),Yt=[s.aD(jt.center.lng),s.aH(jt.center.lat)],Pt=Float32Array.from(s.dq(Ye.canonical,Dt,ot,jt.worldSize/jt._pixelsPerMercatorPixel))):(At=new Float32Array(16),Tt=new Float32Array(9),Nt=new Float32Array(16),Yt=[0,0],Pt=new Float32Array(9));const qt=zl(Rt,At,Tt,Nt,Pt,Mt||[0,0],s.ah(C.transform.zoom),Yt,ht,ft||1,_t,ce),bn=C.isTileAffectedByFog(Ye),fn=C.getOrCreateProgram("rasterParticle",{defines:Pe,overrideFog:bn});if(C.uploadCommonUniforms(Z,fn,qe),ue){const pn=new an(W.LEQUAL,an.ReadOnly,C.depthRangeFor3D),Rn=0,Nn=C.globeSharedBuffers;if(Nn){const[Bn,Xn,ai]=Nn.getGridBuffers(ot,Rn!==0);fn.draw(C,W.TRIANGLES,pn,Ve,kn.alphaBlended,C.renderElevatedRasterBackface?Un.frontCCW:Un.backCCW,qt,N.id,Bn,Xn,ai)}}else{const pn=C.depthModeForSublayer(0,an.ReadOnly),Rn=pe[Ye.overscaledZ],{tileBoundsBuffer:Nn,tileBoundsIndexBuffer:Bn,tileBoundsSegments:Xn}=C.getTileBoundsBuffers(je);fn.draw(C,W.TRIANGLES,pn,Rn,kn.alphaBlended,Un.disabled,qt,N.id,Nn,Bn,Xn)}}C.resetStencilClippingMasks()}(_,o,f,y),_.style.map.triggerRepaint())},background:function(_,o,f,y){const w=f.paint.get("background-color"),E=f.paint.get("background-color-use-theme").constantOr("default")==="none",C=f.paint.get("background-opacity"),M=f.paint.get("background-emissive-strength"),N=f.paint.get("background-pitch-alignment")==="viewport";if(C===0)return;const j=_.context,H=j.gl,Z=_.transform,W=Z.tileSize,Q=f.paint.get("background-pattern");let ce;if(Q!==void 0&&(Q===null||(ce=_.imageManager.getPattern(s.I.from(Q.toString()),f.scope,_.style.getLut(f.scope)),!ce)))return;const se=!Q&&w.a===1&&C===1&&_.opaquePassEnabledForLayer()?"opaque":"translucent";if(_.renderPass!==se)return;const ue=Hn.disabled,pe=_.depthModeForSublayer(0,se==="opaque"?an.ReadWrite:an.ReadOnly),ge=_.colorModeForDrapableLayerRenderPass(M),Pe=Q?"backgroundPattern":"background";let Ve,Ye=y;if(Ye||(Ve=_.getBackgroundTiles(),Ye=Object.values(Ve).map(qe=>qe.tileID)),Q&&(j.activeTexture.set(H.TEXTURE0),_.imageManager.bind(_.context,f.scope)),N){const qe=_.getOrCreateProgram(Pe,{overrideFog:!1,overrideRtt:!0}),je=new Float32Array(s.bx([])),Ue=new s.aM(0,0,0,0,0),We=Q?xf(je,M,C,_,0,f.scope,ce,N,{tileID:Ue,tileSize:W}):ay(je,M,C,w.toPremultipliedRenderColor(E?null:f.lut));qe.draw(_,H.TRIANGLES,pe,ue,ge,Un.disabled,We,f.id,_.viewportBuffer,_.quadTriangleIndexBuffer,_.viewportSegments)}else for(const qe of Ye){const je=_.isTileAffectedByFog(qe),Ue=_.getOrCreateProgram(Pe,{overrideFog:je}),We=qe.toUnwrapped(),et=y?qe.projMatrix:_.transform.calculateProjMatrix(We);_.prepareDrawTile();const _t=o?o.getTile(qe):Ve?Ve[qe.key]:new Rl(qe,W,Z.zoom,_),ft=Q?xf(et,M,C,_,0,f.scope,ce,N,{tileID:qe,tileSize:W}):ay(et,M,C,w.toPremultipliedRenderColor(E?null:f.lut));_.uploadCommonUniforms(j,Ue,We);const{tileBoundsBuffer:Mt,tileBoundsIndexBuffer:Rt,tileBoundsSegments:jt}=_.getTileBoundsBuffers(_t);Ue.draw(_,H.TRIANGLES,pe,ue,ge,Un.disabled,ft,f.id,Mt,Rt,jt)}},sky:function(_,o,f){const y=_._atmosphere?s.ah(_.transform.zoom):1,w=f.paint.get("sky-opacity")*y;if(w===0)return;const E=_.context,C=f.paint.get("sky-type"),M=new an(E.gl.LEQUAL,an.ReadOnly,[0,1]),N=_.frameCounter/1e3%1;C==="atmosphere"?_.renderPass==="offscreen"?f.needsSkyboxCapture(_)&&(function(j,H,Z,W){const Q=j.context,ce=Q.gl;let se=H.skyboxFbo;if(!se){se=H.skyboxFbo=Q.createFramebuffer(32,32,!0,null),H.skyboxGeometry=new Af(Q),H.skyboxTexture=Q.gl.createTexture(),ce.bindTexture(ce.TEXTURE_CUBE_MAP,H.skyboxTexture),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_S,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_WRAP_T,ce.CLAMP_TO_EDGE),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MIN_FILTER,ce.LINEAR),ce.texParameteri(ce.TEXTURE_CUBE_MAP,ce.TEXTURE_MAG_FILTER,ce.LINEAR);for(let Pe=0;Pe<6;++Pe)ce.texImage2D(ce.TEXTURE_CUBE_MAP_POSITIVE_X+Pe,0,ce.RGBA,32,32,0,ce.RGBA,ce.UNSIGNED_BYTE,null)}Q.bindFramebuffer.set(se.framebuffer),Q.viewport.set([0,0,32,32]);const ue=H.getCenter(j,!0),pe=j.getOrCreateProgram("skyboxCapture"),ge=new Float64Array(16);s.bx(ge),s.e3(ge,ge,.5*-Math.PI),xh(j,H,pe,ge,ue,0),s.bx(ge),s.e3(ge,ge,.5*Math.PI),xh(j,H,pe,ge,ue,1),s.bx(ge),s.cG(ge,ge,.5*-Math.PI),xh(j,H,pe,ge,ue,2),s.bx(ge),s.cG(ge,ge,.5*Math.PI),xh(j,H,pe,ge,ue,3),s.bx(ge),xh(j,H,pe,ge,ue,4),s.bx(ge),s.e3(ge,ge,Math.PI),xh(j,H,pe,ge,ue,5),Q.viewport.set([0,0,j.width,j.height])}(_,f),f.markSkyboxValid(_)):_.renderPass==="sky"&&function(j,H,Z,W,Q){const ce=j.context,se=ce.gl,ue=j.transform,pe=j.getOrCreateProgram("skybox");ce.activeTexture.set(se.TEXTURE0),se.bindTexture(se.TEXTURE_CUBE_MAP,H.skyboxTexture);const ge=((Pe,Ve,Ye,qe,je)=>({u_matrix:Pe,u_sun_direction:Ve,u_cubemap:0,u_opacity:qe,u_temporal_offset:je}))(ue.skyboxMatrix,H.getCenter(j,!1),0,W,Q);j.uploadCommonUniforms(ce,pe),pe.draw(j,se.TRIANGLES,Z,Hn.disabled,j.colorModeForRenderPass(),Un.backCW,ge,"skybox",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(_,f,M,w,N):C==="gradient"&&_.renderPass==="sky"&&function(j,H,Z,W,Q){const ce=j.context,se=ce.gl,ue=j.transform,pe=j.getOrCreateProgram("skyboxGradient");H.skyboxGeometry||(H.skyboxGeometry=new Af(ce)),ce.activeTexture.set(se.TEXTURE0);let ge=H.colorRampTexture;ge||(ge=H.colorRampTexture=new s.T(ce,H.colorRamp,se.RGBA8)),ge.bind(se.LINEAR,se.CLAMP_TO_EDGE);const Pe=((Ve,Ye,qe,je,Ue)=>({u_matrix:Ve,u_color_ramp:0,u_center_direction:Ye,u_radius:s.al(qe),u_opacity:je,u_temporal_offset:Ue}))(ue.skyboxMatrix,H.getCenter(j,!1),H.paint.get("sky-gradient-radius"),W,Q);j.uploadCommonUniforms(ce,pe),pe.draw(j,se.TRIANGLES,Z,Hn.disabled,j.colorModeForRenderPass(),Un.backCW,Pe,"skyboxGradient",H.skyboxGeometry.vertexBuffer,H.skyboxGeometry.indexBuffer,H.skyboxGeometry.segment)}(_,f,M,w,N)},custom:function(_,o,f,y){const w=_.context,E=f.implementation;if(!_.transform.projection.unsupportedLayers||!_.transform.projection.unsupportedLayers.includes("custom")||_.terrain&&(_.terrain.renderingToTexture||_.renderPass==="offscreen")&&f.isDraped(o)){if(_.renderPass==="offscreen"){const C=E.prerender;if(C){if(_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),_.transform.projection.name==="globe"){const M=_.transform.pointMerc;C.call(E,w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.ah(_.transform.zoom),[M.x,M.y],_.transform.pixelsPerMeterRatio)}else C.call(E,w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState()}}else if(_.renderPass==="translucent"){if(_.terrain&&_.terrain.renderingToTexture){const M=E.renderToTile;if(M){const N=y[0].canonical,j={x:N.x+y[0].wrap*(E.wrapTileId?0:1<<N.z),y:N.y,z:N.z};w.setDepthMode(an.disabled),w.setStencilMode(Hn.disabled),w.setColorMode(_.colorModeForRenderPass()),_.setCustomLayerDefaults(),M.call(E,w.gl,j),w.setDirty(),_.setBaseState()}return}_.setCustomLayerDefaults(),w.setColorMode(_.colorModeForRenderPass()),w.setStencilMode(Hn.disabled);const C=E.renderingMode==="3d"?new an(_.context.gl.LEQUAL,an.ReadWrite,_.depthRangeFor3D):_.depthModeForSublayer(0,an.ReadOnly);if(w.setDepthMode(C),_.transform.projection.name==="globe"){const M=_.transform.pointMerc;E.render(w.gl,_.transform.customLayerMatrix(),_.transform.getProjection(),_.transform.globeToMercatorMatrix(),s.ah(_.transform.zoom),[M.x,M.y],_.transform.pixelsPerMeterRatio)}else E.render(w.gl,_.transform.customLayerMatrix());w.setDirty(),_.setBaseState(),w.bindFramebuffer.set(null)}}else s.w("Custom layers are not yet supported with this projection. Use mercator or globe to enable usage of custom layers.")},model:function(_,o,f,y){if(_.renderPass==="opaque")return;const w=f.paint.get("model-opacity").constantOr(1);if(w===0)return;const E=f.paint.get("model-cast-shadows");if(_.renderPass==="shadow"&&(!E||_.terrain&&w<.65&&f._transitionablePaint._values["model-opacity"].value.expression instanceof s.ab))return;const C=_.shadowRenderer,M=f.paint.get("model-receive-shadows");C&&(C.useNormalOffset=!0,M||(C.enabled=!1));const N=()=>{C&&(C.useNormalOffset=!0,M||(C.enabled=!0))},j=o.getSource();if(_.renderPass==="light-beam"&&j.type!=="batched-model")return;if(j.type==="vector"||j.type==="geojson")return function(pe,ge,Pe,Ve,Ye){const qe=pe.transform;if(qe.projection.name!=="mercator")return void s.w(`Drawing 3D models for ${qe.projection.name} projection is not yet implemented`);const je=qe.getFreeCameraOptions().position;if(!pe.modelManager)return;const Ue=pe.modelManager;Pe.modelManager=Ue;const We=pe.shadowRenderer;if(!Pe._unevaluatedLayout._values.hasOwnProperty("model-id"))return;const et=Pe._unevaluatedLayout._values["model-id"],_t=Object.assign({},Pe.layout.get("model-id").parameters),ft=pe.style.order.indexOf(Pe.fqid);for(const Mt of Ve){const Rt=ge.getTile(Mt).getBucket(Pe);if(!Rt||Rt.projection.name!==qe.projection.name)continue;const jt=Rt.getModelUris();jt&&!Rt.modelsRequested&&(Ue.addModelsFromBucket(jt,Ye),Rt.modelsRequested=!0);const ht=fy(Mt,qe);_t.zoom=ht;const Dt=et.possiblyEvaluate(_t);if(pt(pe,Rt,Mt),Vr.shadowUniformsInitialized=!1,Vr.useSingleShadowCascade=!!We&&We.getMaxCascadeForTile(Mt.toUnwrapped())===0,pe.renderPass==="shadow"&&We){if(pe.currentShadowCascade===1&&Rt.isInsideFirstShadowMapFrustum)continue;const Tt=qe.calculatePosMatrix(Mt.toUnwrapped(),qe.worldSize);if(Vr.tileMatrix.set(Tt),Vr.shadowTileMatrix=Float32Array.from(We.calculateShadowPassMatrixFromMatrix(Tt)),Vr.aabb.min.fill(0),Vr.aabb.max[0]=Vr.aabb.max[1]=s.aj,Vr.aabb.max[2]=0,iu(Rt,Vr,pe,Pe.scope))continue}const ot=1<<Mt.canonical.z,At=[((je.x-Mt.wrap)*ot-Mt.canonical.x)*s.aj,(je.y*ot-Mt.canonical.y)*s.aj,je.z*ot*s.aj];pe.conflationActive&&Object.keys(Rt.instancesPerModel).length>0&&pe.style.isLayerClipped(Pe,ge.getSource())&&Rt.updateReplacement(Mt,pe.replacementSource,ft,Ye)&&(Rt.uploaded=!1,Rt.upload(pe.context));for(let Tt in Rt.instancesPerModel){const Nt=Rt.instancesPerModel[Tt];Nt.features.length>0&&(Tt=Dt.evaluate(Nt.features[0].feature,{}));const Yt=Ue.getModel(Tt,Ye);if(Yt||Ue.hasURLBeenRequested(Tt)||Rt.modelUris.includes(Tt)||(Rt.modelUris.push(Tt),Rt.modelsRequested=!1),Yt&&Yt.uploaded)for(const Pt of Yt.nodes)py(pe,Pe,Pt,Nt,At,Mt,Vr)}}}(_,o,f,y,j.type==="vector"?f.scope:""),void N();if(!j.loaded())return;if(j.type==="batched-model")return function(pe,ge,Pe,Ve){Pe.resetLayerRenderingStats(pe);const Ye=pe.context,qe=pe.transform,je=pe.style.fog,Ue=pe.shadowRenderer;if(qe.projection.name!=="mercator")return void s.w(`Drawing 3D landmark models for ${qe.projection.name} projection is not yet implemented`);const We=pe.transform.getFreeCameraOptions().position,et=s.bY([],[We.x,We.y,We.z],pe.transform.worldSize),_t=s.eb([],et),ft=s.bx([]),Mt=s.ec(qe.center.lat,qe.zoom),Rt=s.bn([],[1,1,1/Mt]);s.bo(ft,ft,_t);const jt=Pe.paint.get("model-opacity").constantOr(1),ht=new an(Ye.gl.LEQUAL,an.ReadWrite,pe.depthRangeFor3D),Dt=new an(Ye.gl.LEQUAL,an.ReadOnly,pe.depthRangeFor3D),ot=new s.cW([1/0,1/0,1/0],[-1/0,-1/0,-1/0]),At=pe.renderPass==="shadow",Tt=At&&Ue?Ue.getCurrentCascadeFrustum():qe.getFrustum(qe.scaleZoom(qe.worldSize)),Nt=Pe.paint.get("model-front-cutoff"),Yt=Nt[2]<1,Pt=oa(pe,Pe.paint.get("model-cutoff-fade-range")),qt=Pe.getLayerRenderingStats();(function(bn,fn,pn,Rn){const Nn=bn.terrain?bn.terrain.exaggeration():0,Bn=bn.transform.zoom;for(const Xn of Rn){const ai=fn.getTile(Xn).getBucket(pn);ai&&(ai.setFilter(pn.filter),bn.conflationActive&&ai.updateReplacement(Xn,bn.replacementSource),ai.evaluateTransform(bn,pn),bn.terrain&&Nn>0&&ai.elevationUpdate(bn.terrain,Nn,Xn,pn.source),ai.needsReEvaluation(bn,Bn,pn)&&ai.evaluate(pn))}})(pe,ge,Pe,Ve),function(){let bn,fn,pn;Yt?(bn=Ve.length-1,fn=-1,pn=-1):(bn=0,fn=Ve.length,pn=1);const Rn=new Float64Array(16),Nn=s.ef(),Bn=new s.P(0,0);for(let Xn=bn;Xn!==fn;Xn+=pn){const ai=Ve[Xn],Bi=ge.getTile(ai).getBucket(Pe);if(!Bi||!Bi.uploaded)continue;let pr=!1;Ue&&(pr=Ue.getMaxCascadeForTile(ai.toUnwrapped())===0);const Gi=qe.calculatePosMatrix(ai.toUnwrapped(),qe.worldSize),qi=Bi.modelTraits;!At&&Yt&&(s.bi(Rn,Gi),s.ad(Nn,et,Rn),Bn.x=Nn[0],Bn.y=Nn[1]);const cs=[];Bi.setFilter(Pe.filter);for(const si of Bi.getNodesInfo()){if(si.hiddenByReplacement||!si.node.meshes)continue;const li=si.node;let mi=0;pe.terrain&&li.elevation&&(mi=li.elevation*pe.terrain.exaggeration());const yr=(()=>{const ts=si.aabb;return ot.min=[...ts.min],ot.max=[...ts.max],ot.min[2]+=mi,ot.max[2]+=mi,s.ad(ot.min,ot.min,Gi),s.ad(ot.max,ot.max,Gi),ot})(),Us=si.evaluatedScale;if(Us[0]<=1&&Us[1]<=1&&Us[2]<=1&&yr.intersects(Tt)===0)continue;if(!At&&Yt){const ts=.16666666666666666;si.cameraCollisionOpacity=et[0]>yr.min[0]&&et[0]<yr.max[0]&&et[1]>yr.min[1]&&et[1]<yr.max[1]&&et[2]*Mt<yr.max[2]&&li.footprint&&s.bS(Bn,li.footprint)?Math.max(si.cameraCollisionOpacity-ts,0):Math.min(1,si.cameraCollisionOpacity+ts)}const Wi=[...Gi],ji=1/s.cU(ai.canonical),Zr=li.anchor?li.anchor[0]:0,Ci=li.anchor?li.anchor[1]:0;s.bo(Wi,Wi,[Zr*(Us[0]-1)+si.evaluatedTranslation[0]*ji,Ci*(Us[1]-1)+si.evaluatedTranslation[1]*ji,mi+si.evaluatedTranslation[2]]),s.ci(Us,s.eg)||s.cE(Wi,Wi,Us);const As=s.az([],Wi,li.matrix),Tr=s.az([],qe.expandedFarZProjMatrix,As),mr=s.az([],qe.expandedFarZProjMatrix,Wi),Er=s.aA([],[Zr,Ci,mi,1],Tr)[2];li.hidden=!1;let Fi=jt;At||(Yt&&(Fi*=si.cameraCollisionOpacity,Fi*=dd(Wi,qe,si.aabb,Nt)),Fi*=V0(Pt,Er)),Fi!==0?cs.push({nodeInfo:si,depth:Er,opacity:Fi,wvpForNode:Tr,wvpForTile:mr,nodeModelMatrix:As,tileModelMatrix:Wi}):li.hidden=!0}At||cs.sort((si,li)=>!Yt||si.opacity===1&&li.opacity===1?si.depth<li.depth?-1:1:si.opacity===1?-1:li.opacity===1?1:si.depth>li.depth?-1:1);for(const si of cs){const li=si.nodeInfo,mi=li.node;let yr=s.az([],Rt,si.tileModelMatrix);s.az(yr,ft,yr);const Us=s.bi([],yr);s.ee(Us,Us),s.cE(Us,Us,my),yr=s.az(yr,yr,mi.matrix);const Wi=pe.renderPass==="light-beam",ji=Pe.paint.get("model-color-use-theme").constantOr("default")==="none",Zr=qi&s.em.HasMapboxMeshFeatures,Ci=Zr?0:li.evaluatedRMEA[0][2];for(let As=0;As<mi.meshes.length;++As){const Tr=mi.meshes[As],mr=As===mi.lightMeshIndex;let Er=si.wvpForNode;if(mr){if(!Wi&&!pe.terrain&&pe.shadowRenderer){pe.currentLayer<pe.firstLightBeamLayer&&(pe.firstLightBeamLayer=pe.currentLayer);continue}Er=si.wvpForTile}else if(Wi)continue;const Fi={defines:[]},ts=[];if(!At&&Ue&&(Ue.useNormalOffset=!!Tr.normalBuffer),Gt(Fi.defines,ts,Tr,pe,ji?null:Pe.lut),Zr||Fi.defines.push("DIFFUSE_SHADED"),pr&&Fi.defines.push("SHADOWS_SINGLE_CASCADE"),qt&&(At?qt.numRenderedVerticesInShadowPass+=Tr.vertexArray.length:qt.numRenderedVerticesInTransparentPass+=Tr.vertexArray.length),At){Lr(Tr,si.nodeModelMatrix,pe,Pe);continue}let No=null;if(je){const fc=Cf(si.nodeModelMatrix,pe.transform);if(No=new Float32Array(fc),qe.projection.name!=="globe"){const Fl=Tr.aabb.min,Qa=Tr.aabb.max,[vd,pc]=je.getOpacityForBounds(fc,Fl[0],Fl[1],Qa[0],Qa[1]);Fi.overrideFog=vd>=Et||pc>=Et}}const vr=Tr.material;let Vi;vr.occlusionTexture&&vr.occlusionTexture.offsetScale&&(Vi=vr.occlusionTexture.offsetScale,Fi.defines.push("OCCLUSION_TEXTURE_TRANSFORM"));const js=pe.getOrCreateProgram("model",Fi);!At&&Ue&&Ue.setupShadowsFromMatrix(si.tileModelMatrix,js,Ue.useNormalOffset),pe.uploadCommonUniforms(Ye,js,null,No);const Ca=vr.pbrMetallicRoughness;Ca.metallicFactor=.9,Ca.roughnessFactor=.5;const gl=ad(new Float32Array(Er),new Float32Array(yr),new Float32Array(Us),new Float32Array(mi.matrix),pe,si.opacity,Ca.baseColorFactor,vr.emissiveFactor,Ca.metallicFactor,Ca.roughnessFactor,vr,Ci,Pe,[0,0,0],Vi);!mr&&(li.hasTranslucentParts||si.opacity<1)&&js.draw(pe,Ye.gl.TRIANGLES,ht,Hn.disabled,kn.disabled,Un.backCCW,gl,Pe.id,Tr.vertexBuffer,Tr.indexBuffer,Tr.segments,Pe.paint,pe.transform.zoom,void 0,ts),js.draw(pe,Ye.gl.TRIANGLES,mr?Dt:ht,Hn.disabled,mr||si.opacity<1||li.hasTranslucentParts?kn.alphaBlended:kn.unblended,Un.backCCW,gl,Pe.id,Tr.vertexBuffer,Tr.indexBuffer,Tr.segments,Pe.paint,pe.transform.zoom,void 0,ts)}}}}()}(_,o,f,y),void N();if(j.type!=="model")return;const H=j.getModels(),Z=[],W=_.transform.getFreeCameraOptions().position,Q=s.bY([],[W.x,W.y,W.z],_.transform.worldSize);s.eb(Q,Q);const ce=[],se=[];let ue=0;for(const pe of H){const ge=f.paint.get("model-rotation").constantOr(null),Pe=f.paint.get("model-scale").constantOr(null),Ve=f.paint.get("model-translation").constantOr(null);pe.computeModelMatrix(_,ge,Pe,Ve,!0,!0,!1);const Ye=s.bx([]),qe=s.ec(pe.position.lat,_.transform.zoom),je=s.bn([],[1,1,1/qe]);s.bo(Ye,Ye,Q),Z.push({zScaleMatrix:je,negCameraPosMatrix:Ye});for(const Ue of pe.nodes)hd(_.transform,Ue,pe.matrix,_.transform.expandedFarZProjMatrix,ue,ce,se);ue++}if(ce.sort((pe,ge)=>ge.depth-pe.depth),_.renderPass!=="shadow"){if(w===1)for(const pe of se)cn(pe,_,f,Z[pe.modelIndex],Hn.disabled,_.colorModeForRenderPass());else{for(const pe of se)cn(pe,_,f,Z[pe.modelIndex],Hn.disabled,kn.disabled);for(const pe of se)cn(pe,_,f,Z[pe.modelIndex],_.stencilModeFor3D(),_.colorModeForRenderPass());_.resetStencilClippingMasks()}for(const pe of ce)cn(pe,_,f,Z[pe.modelIndex],Hn.disabled,_.colorModeForRenderPass());N()}else{for(const pe of se)Lr(pe.mesh,pe.nodeModelMatrix,_,f);for(const pe of ce)Lr(pe.mesh,pe.nodeModelMatrix,_,f);N()}}},bg={line:function(_,o,f){if(_.hasElevatedBuckets=!1,_.hasNonElevatedBuckets=!1,_._unevaluatedLayout.getValue("line-elevation-reference")!==void 0||_._unevaluatedLayout.getValue("line-z-offset")!==void 0){if(o){const y=o.getVisibleCoordinates();for(const w of y){const E=o.getTile(w).getBucket(_);if(E&&(E.elevationType!=="none"?_.hasElevatedBuckets=!0:_.hasNonElevatedBuckets=!0,_.hasElevatedBuckets&&_.hasNonElevatedBuckets))break}}}else _.hasNonElevatedBuckets=!0},model:function(_,o,f){const y=o.getSource();if(!y.loaded())return;if(y.type==="vector"||y.type==="geojson")return void(f.modelManager&&f.modelManager.upload(f,y.type==="vector"?_.scope:""));if(y.type==="batched-model"||y.type!=="model")return;const w=y.getModels();for(const E of w)E.upload(f.context)},raster:function(_,o,f){const y=o.getSource();if(!(y instanceof ja&&y.loaded()))return;const w=_.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const E=_.paint.get("raster-array-band")||y.getInitialBand(w);if(E==null)return;const C=o.getIds().map(M=>o.getTileByID(M));for(const M of C)M.updateNeeded(w,E)&&y.prepareTile(M,w,E)},"raster-particle":function(_,o,f){const y=o.getSource();if(!(y instanceof ja&&y.loaded()))return;const w=_.sourceLayer||y.rasterLayerIds&&y.rasterLayerIds[0];if(!w)return;const E=_.paint.get("raster-particle-array-band")||y.getInitialBand(w);if(E==null)return;const C=o.getIds().map(M=>o.getTileByID(M));for(const M of C)M.updateNeeded(w,E)&&y.prepareTile(M,w,E)}},uc={fill:mg},xg={fill:function(_,o,f,y){if(!f.layout||f.layout.get("fill-elevation-reference")==="none")return;const w=_.context.gl,E=new an(w.LEQUAL,an.ReadOnly,_.depthRangeFor3D),C=new Hn({func:w.ALWAYS,mask:255},255,255,w.KEEP,w.KEEP,w.REPLACE),M=_.transform.getFreeCameraOptions().position,N=_.getOrCreateProgram("elevatedStructuresDepthReconstruct",{defines:["DEPTH_RECONSTRUCTION"]});for(const j of y){const H=o.getTile(j),Z=H.getBucket(f);if(!Z)continue;const W=Z.elevatedStructures;if(!W||W.maskSegments.segments[0].primitiveLength===0)continue;const Q=Lp(j.toUnwrapped(),M),ce=_.translatePosMatrix(j.projMatrix,H,f.paint.get("fill-translate"),f.paint.get("fill-translate-anchor")),se=hg(ce,Q,0,0,0);N.draw(_,w.TRIANGLES,E,C,kn.disabled,Un.disabled,se,f.id,W.vertexBuffer,W.indexBuffer,W.maskSegments,f.paint,_.transform.zoom)}}};class Rf{constructor(o,f,y,w,E,C){this.context=new uy(o,f),this.transform=y,this._tileTextures={},this.frameCopies=[],this.loadTimeStamps=[],this.tp=E,this._timeStamp=s.q.now(),this._averageFPS=0,this._fpsHistory=[],this._dt=0,this._debugParams={forceEnablePrecipitation:!1,showTerrainProxyTiles:!1,fpsWindow:30,continousRedraw:!1,enabledLayers:{}};const M=["fill","line","symbol","circle","heatmap","fill-extrusion","building","raster","raster-particle","hillshade","model","background","sky"];for(const j of M)this._debugParams.enabledLayers[j]=!0;E.registerParameter(this._debugParams,["Terrain"],"showTerrainProxyTiles",{},()=>{this.style.map.triggerRepaint()}),E.registerParameter(this._debugParams,["Precipitation"],"forceEnablePrecipitation"),E.registerParameter(this._debugParams,["FPS"],"fpsWindow",{min:1,max:100,step:1}),E.registerBinding(this._debugParams,["FPS"],"continousRedraw",{readonly:!0,label:"continuous redraw"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"value"}),E.registerBinding(this,["FPS"],"_averageFPS",{readonly:!0,label:"graph",view:"graph",min:0,max:200});for(const j of M)E.registerParameter(this._debugParams.enabledLayers,["Debug","Layers"],j);this.occlusionParams=new U0(E),this.setup(),this.numSublayers=Bs.maxUnderzooming+Bs.maxOverzooming+1,this.depthEpsilon=1/Math.pow(2,16),this.deferredRenderGpuTimeQueries=[],this.gpuTimers={},this.frameCounter=0,this._backgroundTiles={},this.conflationActive=!1,this.replacementSource=new s.et,this.longestCutoffRange=0,this.minCutoffZoom=0,this._fogVisible=!1,this._cachedTileFogOpacities={},this._shadowRenderer=new Jm(this),this._wireframeDebugCache=new Fp,this.renderDefaultNorthPole=!0,this.renderDefaultSouthPole=!0,this.layersWithOcclusionOpacity=[];const N=new s.r({width:1,height:1},Uint8Array.of(0,0,0,0));this.emptyDepthTexture=new s.T(this.context,N,o.RGBA8),this._clippingActiveLastFrame=!1,this.scaleFactor=w,this.worldview=C}updateTerrain(o,f){const y=!!o&&!!o.terrain&&this.transform.projection.supportsTerrain;if(!(y||this._terrain&&this._terrain.enabled))return;this._terrain||(this._terrain=new Ru(this,o));const w=this._terrain;this.transform.elevation=y?w:null,w.update(o,this.transform,f),this.transform.elevation&&!w.enabled&&(this.transform.elevation=null)}_updateFog(o){const f=o.fog;if(!f||this.transform.projection.name==="globe"||f.getOpacity(this.transform.pitch)<1||f.properties.get("horizon-blend")<.03)return void(this.transform.fogCullDistSq=null);const[y,w]=f.getFovAdjustedRange(this.transform._fov);if(y>w)return void(this.transform.fogCullDistSq=null);const E=y+.78*(w-y);this.transform.fogCullDistSq=E*E}get terrain(){return this.transform._terrainEnabled()&&this._terrain&&this._terrain.enabled||this._forceTerrainMode?this._terrain:null}get forceTerrainMode(){return this._forceTerrainMode}set forceTerrainMode(o){o&&!this._terrain&&(this._terrain=new Ru(this,this.style)),this._forceTerrainMode=o}get shadowRenderer(){return this._shadowRenderer&&this._shadowRenderer.enabled?this._shadowRenderer:null}get wireframeDebugCache(){return this._wireframeDebugCache}resize(o,f){if(this.width=o*s.q.devicePixelRatio,this.height=f*s.q.devicePixelRatio,this.context.viewport.set([0,0,this.width,this.height]),this.style)for(const y of this.style.order)this.style._mergedLayers[y].resize()}setup(){const o=this.context,f=new s.ba;f.emplaceBack(0,0),f.emplaceBack(s.aj,0),f.emplaceBack(0,s.aj),f.emplaceBack(s.aj,s.aj),this.tileExtentBuffer=o.createVertexBuffer(f,s.bc.members),this.tileExtentSegments=s.bd.simpleSegment(0,0,4,2);const y=new s.ba;y.emplaceBack(0,0),y.emplaceBack(s.aj,0),y.emplaceBack(0,s.aj),y.emplaceBack(s.aj,s.aj),this.debugBuffer=o.createVertexBuffer(y,s.bc.members),this.debugSegments=s.bd.simpleSegment(0,0,4,5);const w=new s.ba;w.emplaceBack(-1,-1),w.emplaceBack(1,-1),w.emplaceBack(-1,1),w.emplaceBack(1,1),this.viewportBuffer=o.createVertexBuffer(w,s.bc.members),this.viewportSegments=s.bd.simpleSegment(0,0,4,2);const E=new s.aZ;E.emplaceBack(0,0,0,0),E.emplaceBack(s.aj,0,s.aj,0),E.emplaceBack(0,s.aj,0,s.aj),E.emplaceBack(s.aj,s.aj,s.aj,s.aj),this.mercatorBoundsBuffer=o.createVertexBuffer(E,s.bf.members),this.mercatorBoundsSegments=s.bd.simpleSegment(0,0,4,2);const C=new s.a_;C.emplaceBack(0,1,2),C.emplaceBack(2,1,3),this.quadTriangleIndexBuffer=o.createIndexBuffer(C);const M=new s.bb;for(const j of[0,1,3,2,0])M.emplaceBack(j);this.debugIndexBuffer=o.createIndexBuffer(M),this.emptyTexture=new s.T(o,new s.r({width:1,height:1},Uint8Array.of(0,0,0,0)),o.gl.RGBA8),this.identityMat=s.bz();const N=this.context.gl;this.stencilClearMode=new Hn({func:N.ALWAYS,mask:0},0,255,N.ZERO,N.ZERO,N.ZERO),this.loadTimeStamps.push(performance.now())}getMercatorTileBoundsBuffers(){return{tileBoundsBuffer:this.mercatorBoundsBuffer,tileBoundsIndexBuffer:this.quadTriangleIndexBuffer,tileBoundsSegments:this.mercatorBoundsSegments}}getTileBoundsBuffers(o){return o._makeTileBoundsBuffers(this.context,this.transform.projection),o._tileBoundsBuffer?{tileBoundsBuffer:o._tileBoundsBuffer,tileBoundsIndexBuffer:o._tileBoundsIndexBuffer,tileBoundsSegments:o._tileBoundsSegments}:this.getMercatorTileBoundsBuffers()}clearStencil(){const o=this.context.gl;this.nextStencilID=1,this.currentStencilSource=void 0,this._tileClippingMaskIDs={},this.getOrCreateProgram("clippingMask").draw(this,o.TRIANGLES,an.disabled,this.stencilClearMode,kn.disabled,Un.disabled,ac(this.identityMat),"$clipping",this.viewportBuffer,this.quadTriangleIndexBuffer,this.viewportSegments)}resetStencilClippingMasks(){this.terrain||(this.currentStencilSource=void 0,this._tileClippingMaskIDs={})}_renderTileClippingMasks(o,f,y){if(!f||this.currentStencilSource===f.id||!o.isTileClipped()||!y||y.length===0)return;if(this._tileClippingMaskIDs&&!this.terrain){let M=!1;for(const N of y)if(this._tileClippingMaskIDs[N.key]===void 0){M=!0;break}if(!M)return}this.currentStencilSource=f.id;const w=this.context,E=w.gl;this.nextStencilID+y.length>256&&this.clearStencil(),w.setColorMode(kn.disabled),w.setDepthMode(an.disabled);const C=this.getOrCreateProgram("clippingMask");this._tileClippingMaskIDs={};for(const M of y){const N=f.getTile(M),j=this._tileClippingMaskIDs[M.key]=this.nextStencilID++,{tileBoundsBuffer:H,tileBoundsIndexBuffer:Z,tileBoundsSegments:W}=this.getTileBoundsBuffers(N);C.draw(this,E.TRIANGLES,an.disabled,new Hn({func:E.ALWAYS,mask:0},j,255,E.KEEP,E.KEEP,E.REPLACE),kn.disabled,Un.disabled,ac(M.projMatrix),"$clipping",H,Z,W)}}stencilModeFor3D(){this.currentStencilSource=void 0,this.nextStencilID+1>256&&this.clearStencil();const o=this.nextStencilID++,f=this.context.gl;return new Hn({func:f.NOTEQUAL,mask:255},o,255,f.KEEP,f.KEEP,f.REPLACE)}stencilModeForClipping(o){if(this.terrain)return this.terrain.stencilModeForRTTOverlap(o);const f=this.context.gl;return new Hn({func:f.EQUAL,mask:255},this._tileClippingMaskIDs[o.key],0,f.KEEP,f.KEEP,f.REPLACE)}stencilConfigForOverlap(o){const f=this.context.gl,y=o.sort((C,M)=>M.overscaledZ-C.overscaledZ),w=y[y.length-1].overscaledZ,E=y[0].overscaledZ-w+1;if(E>1){this.currentStencilSource=void 0,this.nextStencilID+E>256&&this.clearStencil();const C={};for(let M=0;M<E;M++)C[M+w]=new Hn({func:f.GEQUAL,mask:255},M+this.nextStencilID,255,f.KEEP,f.KEEP,f.REPLACE);return this.nextStencilID+=E,[C,y]}return[{[w]:Hn.disabled},y]}colorModeForRenderPass(){const o=this.context.gl;return this._showOverdrawInspector?new kn([o.CONSTANT_COLOR,o.ONE,o.CONSTANT_COLOR,o.ONE],new s.am(.125,.125,.125,0),[!0,!0,!0,!0]):this.renderPass==="opaque"?kn.unblended:kn.alphaBlended}colorModeForDrapableLayerRenderPass(o){const f=this.context.gl;return this.style&&this.style.enable3dLights()&&this.terrain&&this.terrain.renderingToTexture&&this.renderPass==="translucent"?new kn([f.ONE,f.ONE_MINUS_SRC_ALPHA,f.CONSTANT_ALPHA,f.ONE_MINUS_SRC_ALPHA],new s.am(0,0,0,o===void 0?0:o),[!0,!0,!0,!0]):this.colorModeForRenderPass()}depthModeForSublayer(o,f,y,w=!1){if(this.depthOcclusion)return new an(this.context.gl.GREATER,an.ReadOnly,this.depthRangeFor3D);if(!this.opaquePassEnabledForLayer()&&!w)return an.disabled;const E=1-((1+this.currentLayer)*this.numSublayers+o)*this.depthEpsilon;return new an(y||this.context.gl.LEQUAL,f,[E,E])}opaquePassEnabledForLayer(){return this.currentLayer<this.opaquePassCutoff}blitDepth(){const o=this.context.gl,f=Math.ceil(this.width),y=Math.ceil(this.height),w=this.context.bindFramebuffer.get(),E=o.getParameter(o.TEXTURE_BINDING_2D);this.depthFBO&&this.depthFBO.width===f&&this.depthFBO.height===y||(this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),f!==0&&y!==0&&(this.depthFBO=new Tf(this.context,f,y,!1,"texture"),this.depthTexture=new s.T(this.context,{width:f,height:y,data:null},o.DEPTH24_STENCIL8),this.depthFBO.depthAttachment.set(this.depthTexture.texture))),this.context.bindFramebuffer.set(w),o.bindTexture(o.TEXTURE_2D,E),this.depthFBO&&(o.bindFramebuffer(o.READ_FRAMEBUFFER,null),o.bindFramebuffer(o.DRAW_FRAMEBUFFER,this.depthFBO.framebuffer),o.blitFramebuffer(0,0,f,y,0,0,f,y,o.DEPTH_BUFFER_BIT,o.NEAREST),o.bindFramebuffer(o.FRAMEBUFFER,this.context.bindFramebuffer.current))}updateAverageFPS(){this._fpsHistory.push(this._dt===0?0:1e3/this._dt),this._fpsHistory.length>this._debugParams.fpsWindow&&this._fpsHistory.splice(0,this._fpsHistory.length-this._debugParams.fpsWindow),this._averageFPS=Math.round(this._fpsHistory.reduce((o,f)=>o+f/this._fpsHistory.length,0))}render(o,f){const y=s.q.now();this._dt=y-this._timeStamp,this._timeStamp=y,this._wireframeDebugCache.update(this.frameCounter),this._debugParams.continousRedraw=o.map.repaint,this.style=o,this.options=f;const w=this.style._mergedLayers,E=!(!this.terrain||!this.terrain.enabled),C=()=>this.style._getOrder(E).filter(ht=>{const Dt=w[ht];return!(Dt.type in this._debugParams.enabledLayers)||this._debugParams.enabledLayers[Dt.type]});let M=C(),N=!1,j=!1;for(const ht of M){const Dt=w[ht];Dt.type==="circle"&&(N=!0),Dt.type==="symbol"&&(Dt.hasInitialOcclusionOpacityProperties?j=!0:N=!0)}let H=M.map(ht=>w[ht]);const Z=this.style._mergedSourceCaches;this.imageManager=o.imageManager,this.modelManager=o.modelManager,this.symbolFadeChange=o.placement.symbolFadeChange(s.q.now()),this.imageManager.beginFrame();let W=0,Q=!1;for(const ht in Z){const Dt=Z[ht];Dt.used&&(Dt.prepare(this.context),Dt.getSource().usedInConflation&&++W)}let ce=!1;for(const ht of H)ht.isHidden(this.transform.zoom)||(ht.type==="clip"&&(ce=!0),this.prepareLayer(ht));const se={},ue={},pe={},ge={},Pe={};for(const ht in Z){const Dt=Z[ht];se[ht]=Dt.getVisibleCoordinates(),ue[ht]=se[ht].slice().reverse(),pe[ht]=Dt.getVisibleCoordinates(!0).reverse(),ge[ht]=Dt.getShadowCasterCoordinates(),Pe[ht]=Dt.sortCoordinatesByDistance(se[ht])}const Ve=ht=>{const Dt=this.style.getLayerSourceCache(ht);return Dt&&Dt.used?Dt.getSource():null};if(W||ce||this._clippingActiveLastFrame){const ht=[],Dt=[];let ot=0;for(const At of H)this.isSourceForClippingOrConflation(At,Ve(At))&&(ht.push(At),Dt.push(ot)),ot++;if(ht&&(ce||ht.length>1)||this._clippingActiveLastFrame){ce=!1;const At=[];for(let Tt=0;Tt<ht.length;Tt++){const Nt=ht[Tt],Yt=Dt[Tt],Pt=this.style.getLayerSourceCache(Nt);if(!Pt||!Pt.used||!Pt.getSource().usedInConflation&&Nt.type!=="clip")continue;let qt=s.eu,bn=s.bQ.None;const fn=[];let pn=!0;if(Nt.type==="clip"){qt=Yt;for(const Rn of Nt.layout.get("clip-layer-types"))bn|=Rn==="model"?s.bQ.Model:Rn==="symbol"?s.bQ.Symbol:s.bQ.FillExtrusion;for(const Rn of Nt.layout.get("clip-layer-scope"))fn.push(Rn);Nt.isHidden(this.transform.zoom)?pn=!1:ce=!0}pn&&At.push({layer:Nt.fqid,cache:Pt,order:qt,clipMask:bn,clipScope:fn})}this.replacementSource.setSources(At),Q=!0}}this._clippingActiveLastFrame=ce,Q||this.replacementSource.clear(),this.conflationActive=Q,this.minCutoffZoom=0,this.longestCutoffRange=0,this.opaquePassCutoff=1/0,this._lastOcclusionLayer=-1,this.layersWithOcclusionOpacity=[];for(let ht=0;ht<H.length;ht++){const Dt=H[ht],ot=Dt.cutoffRange();if(this.longestCutoffRange=Math.max(ot,this.longestCutoffRange),ot>0){const At=Ve(Dt);At&&(this.minCutoffZoom=Math.max(At.minzoom,this.minCutoffZoom)),Dt.minzoom&&(this.minCutoffZoom=Math.max(Dt.minzoom,this.minCutoffZoom))}Dt.is3D(E)&&(this.opaquePassCutoff===1/0&&(this.opaquePassCutoff=ht),this._lastOcclusionLayer=ht)}const Ye=this.style&&this.style.fog;Ye?(this._fogVisible=Ye.getOpacity(this.transform.pitch)!==0,this._fogVisible&&this.transform.projection.name!=="globe"&&(this._fogVisible=Ye.isVisibleOnFrustum(this.transform.cameraFrustum))):this._fogVisible=!1,this._cachedTileFogOpacities={},this.terrain&&(this.terrain.updateTileBinding(pe),this.opaquePassCutoff=0,M=C(),H=M.map(ht=>w[ht]));const qe=this._shadowRenderer;if(qe){qe.updateShadowParameters(this.transform,this.style.directionalLight);for(const ht in Z)for(const Dt of se[ht]){let ot={min:0,max:0};this.terrain&&(ot=this.terrain.getMinMaxForTile(Dt)||ot),qe.addShadowReceiver(Dt.toUnwrapped(),ot.min,ot.max)}}this.transform.projection.name!=="globe"||this.globeSharedBuffers||(this.globeSharedBuffers=new s.ev(this.context)),this.style.fog&&this.transform.projection.supportsFog?(this._atmosphere||(this._atmosphere=new ud(this)),this._atmosphere.update(this)):this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0);const je=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.snow),Ue=this._debugParams.forceEnablePrecipitation||!(!this.style||!this.style.rain);if(je&&!this._snow&&(this._snow=new wr(this)),!je&&this._snow&&(this._snow.destroy(),delete this._snow),Ue&&!this._rain&&(this._rain=new Yx(this)),!Ue&&this._rain&&(this._rain.destroy(),delete this._rain),this._snow&&this._snow.update(this),this._rain&&this._rain.update(this),!Kn.has(this.context.gl))return;this.renderPass="offscreen";for(const ht of H){const Dt=o.getLayerSourceCache(ht);if(!ht.hasOffscreenPass()||ht.isHidden(this.transform.zoom))continue;const ot=Dt?ue[Dt.id]:void 0;(ht.type==="custom"||ht.type==="raster"||ht.type==="raster-particle"||ht.isSky()||ot&&ot.length)&&this.renderLayer(this,Dt,ht,ot)}this.depthRangeFor3D=[0,1-(H.length+2)*this.numSublayers*this.depthEpsilon],this._shadowRenderer&&(this.renderPass="shadow",this._shadowRenderer.drawShadowPass(this.style,ge)),this.context.bindFramebuffer.set(null),this.context.viewport.set([0,0,this.width,this.height]);const We=this.transform.projection.name==="globe"||this.transform.isHorizonVisible(),et=(()=>{if(f.showOverdrawInspector)return s.am.black;const ht=this.style.fog;if(ht&&this.transform.projection.supportsFog){const Dt=this.style.getLut(ht.scope);if(!We){const ot=ht.properties.get("color-use-theme")==="none",At=ht.properties.get("color").toNonPremultipliedRenderColor(ot?null:Dt).toArray01();return new s.am(...At)}if(We){const ot=ht.properties.get("space-color-use-theme")==="none",At=ht.properties.get("space-color").toNonPremultipliedRenderColor(ot?null:Dt).toArray01();return new s.am(...At)}}return s.am.transparent})();if(this.context.clear({color:et,depth:1}),this.clearStencil(),this._showOverdrawInspector=f.showOverdrawInspector,this.renderPass="opaque",this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawStars(this,this.style.fog),!this.terrain)for(this.currentLayer=M.length-1;this.currentLayer>=0;this.currentLayer--){const ht=H[this.currentLayer],Dt=o.getLayerSourceCache(ht);if(ht.isSky())continue;const ot=Dt?(ht.is3D(E)?Pe:ue)[Dt.id]:void 0;this._renderTileClippingMasks(ht,Dt,ot),this.renderLayer(this,Dt,ht,ot)}if(this.style.fog&&this.transform.projection.supportsFog&&this._atmosphere&&!this._showOverdrawInspector&&We&&this._atmosphere.drawAtmosphereGlow(this,this.style.fog),this.renderPass="sky",(!this._atmosphere||s.ah(this.transform.zoom)>0)&&(this.transform.projection.name==="globe"||this.transform.isHorizonVisible()))for(this.currentLayer=0;this.currentLayer<M.length;this.currentLayer++){const ht=H[this.currentLayer],Dt=o.getLayerSourceCache(ht);ht.isSky()&&this.renderLayer(this,Dt,ht,Dt?ue[Dt.id]:void 0)}function _t(ht,Dt){let ot;return Dt&&(ot=(ht.type==="symbol"?pe:ht.is3D(E)?Pe:ue)[Dt.id]),ot}if(this.renderPass="translucent",this.transform.projection.name==="globe"){for(this.renderElevatedRasterBackface=!0,this.currentLayer=0;this.currentLayer<M.length;){const ht=H[this.currentLayer];if(ht.type==="raster"||ht.type==="raster-particle"){const Dt=o.getLayerSourceCache(ht);this.renderLayer(this,Dt,ht,_t(ht,Dt))}++this.currentLayer}this.renderElevatedRasterBackface=!1}this.currentLayer=0,this.firstLightBeamLayer=Number.MAX_SAFE_INTEGER;let ft=0;qe&&(ft=qe.getShadowCastingLayerCount());let Mt=!1,Rt=-1;for(let ht=0;ht<M.length;++ht){const Dt=H[ht];Dt.isHidden(this.transform.zoom)||Dt.is3D(E)&&(Rt=ht)}j&&Rt===-1&&(N=!0);let jt=!1;for(;this.currentLayer<M.length;){const ht=H[this.currentLayer],Dt=o.getLayerSourceCache(ht);if(ht.isSky())++this.currentLayer;else if(this.terrain&&this.style.isLayerDraped(ht)){if(ht.isHidden(this.transform.zoom)){++this.currentLayer;continue}this.currentLayer=this.terrain.renderBatch(this.currentLayer),this._lastOcclusionLayer=Math.max(this.currentLayer,this._lastOcclusionLayer)}else{if(!jt&&ht.is3D(E)&&!E){const ot=this.currentLayer,At=Tt=>{for(this.currentLayer=0;this.currentLayer<H.length;this.currentLayer++){const Nt=H[this.currentLayer];if(uc[Nt.type]){const Yt=this.style.getLayerSourceCache(Nt);uc[Nt.type](this,Yt,Nt,_t(Nt,Yt),Tt)}}};At("initialize"),At("reset"),this.currentLayer=ot,jt=!0}if(N&&!Mt&&this.terrain&&!this.transform.isOrthographic&&(Mt=!0,this.blitDepth()),j&&Rt!==-1&&this.currentLayer===Rt+1&&!this.transform.isOrthographic&&this.blitDepth(),this.terrain||this._renderTileClippingMasks(ht,Dt,Dt?se[Dt.id]:void 0),this.renderLayer(this,Dt,ht,_t(ht,Dt)),!this.terrain&&qe&&ft>0&&ht.hasShadowPass()&&--ft==0){{this.clearStencil();const ot=this.currentLayer;for(this.currentLayer=0;this.currentLayer<H.length;this.currentLayer++){const At=H[this.currentLayer];if(xg[At.type]){const Tt=this.style.getLayerSourceCache(At);xg[At.type](this,Tt,At,_t(At,Tt))}}this.currentLayer=ot}if(qe.drawGroundShadows(),this.firstLightBeamLayer<=this.currentLayer){const ot=this.currentLayer;for(this.renderPass="light-beam",this.currentLayer=this.firstLightBeamLayer;this.currentLayer<=ot;this.currentLayer++){const At=H[this.currentLayer];if(!At.hasLightBeamPass())continue;const Tt=o.getLayerSourceCache(At);this.renderLayer(this,Tt,At,Tt?ue[Tt.id]:void 0)}this.currentLayer=ot,this.renderPass="translucent"}}if(this.currentLayer>=this._lastOcclusionLayer&&this.layersWithOcclusionOpacity.length>0){const ot=this.currentLayer;this.depthOcclusion=!0;for(const At of this.layersWithOcclusionOpacity){this.currentLayer=At;const Tt=H[this.currentLayer],Nt=o.getLayerSourceCache(Tt),Yt=Nt?ue[Nt.id]:void 0;this.terrain||this._renderTileClippingMasks(Tt,Nt,Nt?se[Nt.id]:void 0),this.renderLayer(this,Nt,Tt,Yt)}this.depthOcclusion=!1,this.currentLayer=ot,this.renderPass="translucent",this.layersWithOcclusionOpacity=[]}++this.currentLayer}}if(this.terrain&&this.terrain.postRender(),this._snow&&this._snow.draw(this),this._rain&&this._rain.draw(this),this.options.showTileBoundaries||this.options.showQueryGeometry||this.options.showTileAABBs){let ht=null;H.forEach(Dt=>{const ot=o.getLayerSourceCache(Dt);ot&&!Dt.isHidden(this.transform.zoom)&&ot.getVisibleCoordinates().length&&(!ht||ht.getSource().maxzoom<ot.getSource().maxzoom)&&(ht=ot)}),ht&&this.options.showTileBoundaries&&ku(this,ht,ht.getVisibleCoordinates(),s.am.red,!1,this.options.showParseStatus)}this.terrain&&this._debugParams.showTerrainProxyTiles&&ku(this,this.terrain.proxySourceCache,this.terrain.proxyCoords,new s.am(1,.8,.1,1),!0,this.options.showParseStatus),this.options.showPadding&&function(ht){const Dt=ht.transform.padding;zp(ht,ht.transform.height-(Dt.top||0),3,Gx),zp(ht,Dt.bottom||0,3,qx),Bp(ht,Dt.left||0,3,ca),Bp(ht,ht.transform.width-(Dt.right||0),3,gg);const ot=ht.transform.centerPoint;(function(At,Tt,Nt,Yt){cd(At,Tt-1,Nt-10,2,20,Yt),cd(At,Tt-10,Nt-1,20,2,Yt)})(ht,ot.x,ht.transform.height-ot.y,ua)}(this),this.context.setDefault(),this.frameCounter=(this.frameCounter+1)%Number.MAX_SAFE_INTEGER,this.tileLoaded&&this.options.speedIndexTiming&&(this.loadTimeStamps.push(performance.now()),this.saveCanvasCopy()),Q||(this.conflationActive=!1)}prepareLayer(o){this.gpuTimingStart(o);const{unsupportedLayers:f}=this.transform.projection,y=!f||!f.includes(o.type);if(bg[o.type]&&(y||this.terrain&&o.type==="custom")){const w=this.style.getLayerSourceCache(o);bg[o.type](o,w,this)}this.gpuTimingEnd()}renderLayer(o,f,y,w){y.isHidden(this.transform.zoom)||(y.type==="background"||y.type==="sky"||y.type==="custom"||y.type==="model"||y.type==="raster"||y.type==="raster-particle"||w&&w.length)&&(this.id=y.id,this.gpuTimingStart(y),o.transform.projection.unsupportedLayers&&o.transform.projection.unsupportedLayers.includes(y.type)&&(!o.terrain||y.type!=="custom")||y.type==="clip"||Oi[y.type](o,f,y,w,this.style.placement.variableOffsets,this.options.isInitialLoad),this.gpuTimingEnd())}gpuTimingStart(o){if(!this.options.gpuTiming)return;const f=this.context.extTimerQuery,y=this.context.gl;let w=this.gpuTimers[o.id];w||(w=this.gpuTimers[o.id]={calls:0,cpuTime:0,query:y.createQuery()}),w.calls++,y.beginQuery(f.TIME_ELAPSED_EXT,w.query)}gpuTimingDeferredRenderStart(){if(this.options.gpuTimingDeferredRender){const o=this.context.extTimerQuery,f=this.context.gl,y=f.createQuery();this.deferredRenderGpuTimeQueries.push(y),f.beginQuery(o.TIME_ELAPSED_EXT,y)}}gpuTimingDeferredRenderEnd(){this.options.gpuTimingDeferredRender&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}gpuTimingEnd(){this.options.gpuTiming&&this.context.gl.endQuery(this.context.extTimerQuery.TIME_ELAPSED_EXT)}collectGpuTimers(){const o=this.gpuTimers;return this.gpuTimers={},o}collectDeferredRenderGpuQueries(){const o=this.deferredRenderGpuTimeQueries;return this.deferredRenderGpuTimeQueries=[],o}queryGpuTimers(o){const f={};for(const y in o){const w=o[y],E=this.context.extTimerQuery,C=E.getQueryParameter(w.query,this.context.gl.QUERY_RESULT)/1e6;E.deleteQueryEXT(w.query),f[y]=C}return f}queryGpuTimeDeferredRender(o){if(!this.options.gpuTimingDeferredRender)return 0;const f=this.context.gl;let y=0;for(const w of o)y+=f.getQueryParameter(w,f.QUERY_RESULT)/1e6,f.deleteQuery(w);return y}translatePosMatrix(o,f,y,w,E){if(!y[0]&&!y[1])return o;const C=E?w==="map"?this.transform.angle:0:w==="viewport"?-this.transform.angle:0;if(C){const j=Math.sin(C),H=Math.cos(C);y=[y[0]*H-y[1]*j,y[0]*j+y[1]*H]}const M=[E?y[0]:s.aw(f,y[0],this.transform.zoom),E?y[1]:s.aw(f,y[1],this.transform.zoom),0],N=new Float32Array(16);return s.bo(N,o,M),N}saveTileTexture(o){const f=o.size[0],y=this._tileTextures[f];y?y.push(o):this._tileTextures[f]=[o]}getTileTexture(o){const f=this._tileTextures[o];return f&&f.length>0?f.pop():null}terrainRenderModeElevated(){return this.style&&!!this.style.getTerrain()&&!!this.terrain&&!this.terrain.renderingToTexture||this.forceTerrainMode}linearFloatFilteringSupported(){return this.context.extTextureFloatLinear!=null}currentGlobalDefines(o,f,y){const w=y===void 0?this.terrain&&this.terrain.renderingToTexture:y,E=[];return this.style&&this.style.enable3dLights()&&(o==="globeRaster"||o==="terrainRaster"?(E.push("LIGHTING_3D_MODE"),E.push("LIGHTING_3D_ALPHA_EMISSIVENESS")):w||E.push("LIGHTING_3D_MODE")),this.renderPass==="shadow"&&(this._shadowMapDebug||E.push("DEPTH_TEXTURE")),this.terrainRenderModeElevated()&&(E.push("TERRAIN"),this.linearFloatFilteringSupported()&&E.push("TERRAIN_DEM_FLOAT_FORMAT")),this.transform.projection.name==="globe"&&E.push("GLOBE"),!this._fogVisible||w||f!==void 0&&!f||E.push("FOG","FOG_DITHERING"),w&&E.push("RENDER_TO_TEXTURE"),this._showOverdrawInspector&&E.push("OVERDRAW_INSPECTOR"),E}getOrCreateProgram(o,f){this.cache=this.cache||{};const y=f&&f.defines||[],w=f&&f.config,E=this.currentGlobalDefines(o,f&&f.overrideFog,f&&f.overrideRtt).concat(y),C=la.cacheKey(td[o],o,E,w);return this.cache[C]||(this.cache[C]=new la(this.context,o,td[o],w,I0[o],E)),this.cache[C]}setCustomLayerDefaults(){this.context.unbindVAO(),this.context.cullFace.setDefault(),this.context.frontFace.setDefault(),this.context.cullFaceSide.setDefault(),this.context.activeTexture.setDefault(),this.context.pixelStoreUnpack.setDefault(),this.context.pixelStoreUnpackPremultiplyAlpha.setDefault(),this.context.pixelStoreUnpackFlipY.setDefault()}setBaseState(){const o=this.context.gl;this.context.cullFace.set(!1),this.context.viewport.set([0,0,this.width,this.height]),this.context.blendEquation.set(o.FUNC_ADD)}initDebugOverlayCanvas(){this.debugOverlayCanvas==null&&(this.debugOverlayCanvas=document.createElement("canvas"),this.debugOverlayCanvas.width=512,this.debugOverlayCanvas.height=512,this.debugOverlayTexture=new s.T(this.context,this.debugOverlayCanvas,this.context.gl.RGBA8))}destroy(){this._terrain&&this._terrain.destroy(),this._atmosphere&&(this._atmosphere.destroy(),this._atmosphere=void 0),this.globeSharedBuffers&&this.globeSharedBuffers.destroy(),this.emptyTexture.destroy(),this.debugOverlayTexture&&this.debugOverlayTexture.destroy(),this._wireframeDebugCache.destroy(),this.depthFBO&&(this.depthFBO.destroy(),this.depthFBO=void 0,this.depthTexture=void 0),this.emptyDepthTexture&&this.emptyDepthTexture.destroy()}prepareDrawTile(){this.terrain&&this.terrain.prepareDrawTile()}uploadCommonLightUniforms(o,f){if(this.style.enable3dLights()){const y=this.style.directionalLight,w=this.style.ambientLight;if(y&&w){const E=((C,M,N)=>{const j=C.properties.get("direction"),H=C.properties.get("color-use-theme")==="none",Z=C.properties.get("color").toNonPremultipliedRenderColor(H?null:N.getLut(C.scope)).toArray01(),W=C.properties.get("intensity"),Q=M.properties.get("color-use-theme")==="none",ce=M.properties.get("color").toNonPremultipliedRenderColor(Q?null:N.getLut(M.scope)).toArray01(),se=M.properties.get("intensity"),ue=[j.x,j.y,j.z],pe=s.dw(ce,se),ge=s.dw(Z,W);return{u_lighting_ambient_color:pe,u_lighting_directional_dir:ue,u_lighting_directional_color:ge,u_ground_radiance:vf(ue,ge,pe)}})(y,w,this.style);f.setLightsUniformValues(o,E)}}}uploadCommonUniforms(o,f,y,w,E){if(this.uploadCommonLightUniforms(o,f),this.terrain&&this.terrain.renderingToTexture)return;const C=this.style.fog;if(C){const M=C.getOpacity(this.transform.pitch),N=((j,H,Z,W,Q,ce,se,ue,pe,ge,Pe,Ve)=>{const Ye=j.transform,qe=H.properties.get("color-use-theme")==="none",je=H.properties.get("color").toNonPremultipliedRenderColor(qe?null:j.style.getLut(H.scope)).toArray01();je[3]=W;const Ue=j.frameCounter/1e3%1,[We,et]=H.properties.get("vertical-range");return{u_fog_matrix:Z?Ye.calculateFogTileMatrix(Z):Ve||j.identityMat,u_fog_range:H.getFovAdjustedRange(Ye._fov),u_fog_color:je,u_fog_horizon_blend:H.properties.get("horizon-blend"),u_fog_vertical_limit:[Math.min(We,et),et],u_fog_temporal_offset:Ue,u_frustum_tl:Q,u_frustum_tr:ce,u_frustum_br:se,u_frustum_bl:ue,u_globe_pos:pe,u_globe_radius:ge,u_viewport:Pe,u_globe_transition:s.ah(Ye.zoom),u_is_globe:+(Ye.projection.name==="globe")}})(this,C,y,M,this.transform.frustumCorners.TL,this.transform.frustumCorners.TR,this.transform.frustumCorners.BR,this.transform.frustumCorners.BL,this.transform.globeCenterInViewSpace,this.transform.globeRadius,[this.transform.width*s.q.devicePixelRatio,this.transform.height*s.q.devicePixelRatio],w);f.setFogUniformValues(o,N)}E&&f.setCutoffUniformValues(o,E.uniformValues)}setTileLoadedFlag(o){this.tileLoaded=o}saveCanvasCopy(){const o=this.canvasCopy();o&&(this.frameCopies.push(o),this.tileLoaded=!1)}canvasCopy(){const o=this.context.gl,f=o.createTexture();return o.bindTexture(o.TEXTURE_2D,f),o.copyTexImage2D(o.TEXTURE_2D,0,o.RGBA,0,0,o.drawingBufferWidth,o.drawingBufferHeight,0),f}getCanvasCopiesAndTimestamps(){return{canvasCopies:this.frameCopies,timeStamps:this.loadTimeStamps}}averageElevationNeedsEasing(){if(!this.transform._elevation)return!1;const o=this.style&&this.style.fog;return!!o&&o.getOpacity(this.transform.pitch)!==0}getBackgroundTiles(){const o=this._backgroundTiles,f=this._backgroundTiles={},y=this.transform.coveringTiles({tileSize:512});for(const w of y)f[w.key]=o[w.key]||new Rl(w,512,this.transform.tileZoom,this,void 0,this.worldview);return f}clearBackgroundTiles(){this._backgroundTiles={}}isSourceForClippingOrConflation(o,f){return!(!o.is3D(!(!this.terrain||!this.terrain.enabled))||o.type!=="clip"&&(o.minzoom&&o.minzoom>this.transform.zoom||(this.style._clipLayerPresent||o.sourceLayer!=="building")&&(!f||f.type!=="batched-model")))}isTileAffectedByFog(o){if(!this.style||!this.style.fog)return!1;if(this.transform.projection.name==="globe")return!0;let f=this._cachedTileFogOpacities[o.key];return f||(this._cachedTileFogOpacities[o.key]=f=this.style.fog.getOpacityForTile(o)),f[0]>=Et||f[1]>=Et}setupDepthForOcclusion(o,f,y){const w=this.context,E=w.gl,C=!!y;var M;y||(y={u_dem:2,u_dem_prev:4,u_dem_tl:[0,0],u_dem_tl_prev:[0,0],u_dem_scale:0,u_dem_scale_prev:0,u_dem_size:0,u_dem_lerp:1,u_depth:3,u_depth_size_inv:[0,0],u_depth_range_unpack:[0,1],u_occluder_half_size:16,u_occlusion_depth_offset:-1e-4,u_exaggeration:0}),w.activeTexture.set(E.TEXTURE3),o&&this.depthFBO&&this.depthTexture?(this.depthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),y.u_depth_size_inv=[1/this.depthFBO.width,1/this.depthFBO.height],y.u_depth_range_unpack=[2/((M=this.depthRangeFor3D)[1]-M[0]),-1-2*M[0]/(M[1]-M[0])],y.u_occluder_half_size=.5*this.occlusionParams.occluderSize,y.u_occlusion_depth_offset=this.occlusionParams.depthOffset):this.emptyDepthTexture.bind(E.NEAREST,E.CLAMP_TO_EDGE),w.activeTexture.set(E.TEXTURE0),C||f.setTerrainUniformValues(w,y)}}function fd(_,o){let f=!1,y=null;const w=()=>{y=null,f&&(_(),y=setTimeout(w,o),f=!1)};return()=>(f=!0,y||w(),y)}class _y{constructor(o){this._hashName=o&&encodeURIComponent(o),s.aV(["_getCurrentHash","_onHashChange","_updateHash"],this),this._updateHash=fd(this._updateHashUnthrottled.bind(this),300)}addTo(o){return this._map=o,window.addEventListener("hashchange",this._onHashChange,!1),o.on("moveend",this._updateHash),this}remove(){return this._map?(this._map.off("moveend",this._updateHash),window.removeEventListener("hashchange",this._onHashChange,!1),clearTimeout(this._updateHash()),this._map=void 0,this):this}getHashString(){const o=this._map;if(!o)return"";const f=wg(o);if(this._hashName){const y=this._hashName;let w=!1;const E=location.hash.slice(1).split("&").map(C=>{const M=C.split("=")[0];return M===y?(w=!0,`${M}=${f}`):C}).filter(C=>C);return w||E.push(`${y}=${f}`),`#${E.join("&")}`}return`#${f}`}_getCurrentHash(){const o=location.hash.replace("#","");if(this._hashName){let f;return o.split("&").map(y=>y.split("=")).forEach(y=>{y[0]===this._hashName&&(f=y)}),(f&&f[1]||"").split("/")}return o.split("/")}_onHashChange(){const o=this._map;if(!o)return!1;const f=this._getCurrentHash();if(f.length>=3&&!f.some(y=>isNaN(Number(y)))){const y=o.dragRotate.isEnabled()&&o.touchZoomRotate.isEnabled()?+(f[3]||0):o.getBearing();return o.jumpTo({center:[+f[2],+f[1]],zoom:+f[0],bearing:y,pitch:+(f[4]||0)}),!0}return!1}_updateHashUnthrottled(){history.replaceState(history.state,"",location.href.replace(/(#.+)?$/,this.getHashString()))}}function wg(_,o){const f=_.getCenter(),y=Math.round(100*_.getZoom())/100,w=Math.ceil((y*Math.LN2+Math.log(512/360/.5))/Math.LN10),E=Math.pow(10,w),C=Math.round(f.lng*E)/E,M=Math.round(f.lat*E)/E,N=_.getBearing(),j=_.getPitch();let H=o?`/${C}/${M}/${y}`:`${y}/${M}/${C}`;return(N||j)&&(H+="/"+Math.round(10*N)/10),j&&(H+=`/${Math.round(j)}`),H}const fl={linearity:.3,easing:s.ew(0,0,.3,1)},yy=s.h({deceleration:2500,maxSpeed:1400},fl),su=s.h({deceleration:20,maxSpeed:1400},fl),pd=s.h({deceleration:1e3,maxSpeed:360},fl),Of=s.h({deceleration:1e3,maxSpeed:90},fl);class Sa{constructor(o){this._map=o,this.clear()}clear(){this._inertiaBuffer=[]}record(o){this._drainInertiaBuffer(),this._inertiaBuffer.push({time:s.q.now(),settings:o})}_drainInertiaBuffer(){const o=this._inertiaBuffer,f=s.q.now();for(;o.length>0&&f-o[0].time>160;)o.shift()}_onMoveEnd(o){if(this._map._prefersReducedMotion()||(this._drainInertiaBuffer(),this._inertiaBuffer.length<2))return;const f={zoom:0,bearing:0,pitch:0,pan:new s.P(0,0),pinchAround:void 0,around:void 0};for(const{settings:E}of this._inertiaBuffer)f.zoom+=E.zoomDelta||0,f.bearing+=E.bearingDelta||0,f.pitch+=E.pitchDelta||0,E.panDelta&&f.pan._add(E.panDelta),E.around&&(f.around=E.around),E.pinchAround&&(f.pinchAround=E.pinchAround);const y=this._inertiaBuffer[this._inertiaBuffer.length-1].time-this._inertiaBuffer[0].time,w={};if(f.pan.mag()){const E=qo(f.pan.mag(),y,s.h({},yy,o||{}));w.offset=f.pan.mult(E.amount/f.pan.mag()),w.center=this._map.transform.center,If(w,E)}if(f.zoom){const E=qo(f.zoom,y,su);w.zoom=this._map.transform.zoom+E.amount,If(w,E)}if(f.bearing){const E=qo(f.bearing,y,pd);w.bearing=this._map.transform.bearing+s.ay(E.amount,-179,179),If(w,E)}if(f.pitch){const E=qo(f.pitch,y,Of);w.pitch=this._map.transform.pitch+E.amount,If(w,E)}if(w.zoom||w.bearing){const E=f.pinchAround===void 0?f.around:f.pinchAround;w.around=E?this._map.unproject(E):this._map.getCenter()}return this.clear(),w.noMoveStart=!0,w}}function If(_,o){(!_.duration||_.duration<o.duration)&&(_.duration=o.duration,_.easing=o.easing)}function qo(_,o,f){const{maxSpeed:y,linearity:w,deceleration:E}=f,C=s.ay(_*w/(o/1e3),-y,y),M=Math.abs(C)/(E*w);return{easing:f.easing,duration:1e3*M,amount:C*(M/2)}}class Eo extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,y,w={}){const E=_e(f.getCanvasContainer(),y),C=f.unproject(E);super(o,s.h({point:E,lngLat:C,originalEvent:y},w)),this._defaultPrevented=!1,this.target=f}}class pl extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f,y){const w=o==="touchend"?y.changedTouches:y.touches,E=Te(f.getCanvasContainer(),w),C=E.map(N=>f.unproject(N)),M=E.reduce((N,j,H,Z)=>N.add(j.div(Z.length)),new s.P(0,0));super(o,{points:E,point:M,lngLats:C,lngLat:f.unproject(M),originalEvent:y}),this._defaultPrevented=!1}}class Eh extends s.A{preventDefault(){this._defaultPrevented=!0}get defaultPrevented(){return this._defaultPrevented}constructor(o,f){super("wheel",{originalEvent:f}),this._defaultPrevented=!1}}class Sh{constructor(o,f){this._map=o,this._clickTolerance=f.clickTolerance}reset(){this._mousedownPos=void 0}wheel(o){return this._firePreventable(new Eh(this._map,o))}mousedown(o,f){return this._mousedownPos=f,this._firePreventable(new Eo(o.type,this._map,o))}mouseup(o){this._map.fire(new Eo(o.type,this._map,o))}preclick(o){const f=s.h({},o);f.type="preclick",this._map.fire(new Eo(f.type,this._map,f))}click(o,f){this._mousedownPos&&this._mousedownPos.dist(f)>=this._clickTolerance||(this.preclick(o),this._map.fire(new Eo(o.type,this._map,o)))}dblclick(o){return this._firePreventable(new Eo(o.type,this._map,o))}mouseover(o){this._map.fire(new Eo(o.type,this._map,o))}mouseout(o){this._map.fire(new Eo(o.type,this._map,o))}touchstart(o){return this._firePreventable(new pl(o.type,this._map,o))}touchmove(o){this._map.fire(new pl(o.type,this._map,o))}touchend(o){this._map.fire(new pl(o.type,this._map,o))}touchcancel(o){this._map.fire(new pl(o.type,this._map,o))}_firePreventable(o){if(this._map.fire(o),o.defaultPrevented)return{}}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class Tg{constructor(o){this._map=o}reset(){this._delayContextMenu=!1,this._contextMenuEvent=void 0}mousemove(o){this._map.fire(new Eo(o.type,this._map,o))}mousedown(){this._delayContextMenu=!0}mouseup(){this._delayContextMenu=!1,this._contextMenuEvent&&(this._map.fire(new Eo("contextmenu",this._map,this._contextMenuEvent)),delete this._contextMenuEvent)}contextmenu(o){this._delayContextMenu?this._contextMenuEvent=o:this._map.fire(new Eo(o.type,this._map,o)),this._map.listens("contextmenu")&&o.preventDefault()}isEnabled(){return!0}isActive(){return!1}enable(){}disable(){}}class ou{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._container=o.getContainer(),this._clickTolerance=f.clickTolerance||1}isEnabled(){return!!this._enabled}isActive(){return!!this._active}enable(){this.isEnabled()||(this._enabled=!0)}disable(){this.isEnabled()&&(this._enabled=!1)}mousedown(o,f){this.isEnabled()&&o.shiftKey&&o.button===0&&(Re(),this._startPos=this._lastPos=f,this._active=!0)}mousemoveWindow(o,f){if(!this._active)return;const y=f,w=this._startPos,E=this._lastPos;if(!w||!E||E.equals(y)||!this._box&&y.dist(w)<this._clickTolerance)return;this._lastPos=y,this._box||(this._box=X("div","mapboxgl-boxzoom",this._container),this._container.classList.add("mapboxgl-crosshair"),this._fireEvent("boxzoomstart",o));const C=Math.min(w.x,y.x),M=Math.max(w.x,y.x),N=Math.min(w.y,y.y),j=Math.max(w.y,y.y);this._map._requestDomTask(()=>{this._box&&(this._box.style.transform=`translate(${C}px,${N}px)`,this._box.style.width=M-C+"px",this._box.style.height=j-N+"px")})}mouseupWindow(o,f){if(!this._active)return;const y=this._startPos,w=f;if(y&&o.button===0){if(this.reset(),be(),y.x!==w.x||y.y!==w.y)return this._map.fire(new s.A("boxzoomend",{originalEvent:o})),{cameraAnimation:E=>E.fitScreenCoordinates(y,w,this._map.getBearing(),{linear:!1})};this._fireEvent("boxzoomcancel",o)}}keydown(o){this._active&&o.keyCode===27&&(this.reset(),this._fireEvent("boxzoomcancel",o))}blur(){this.reset()}reset(){this._active=!1,this._container.classList.remove("mapboxgl-crosshair"),this._box&&(this._box.remove(),this._box=null),Ne(),delete this._startPos,delete this._lastPos}_fireEvent(o,f){return this._map.fire(new s.A(o,{originalEvent:f}))}}function Mf(_,o){const f={};for(let y=0;y<_.length;y++)f[_[y].identifier]=o[y];return f}class mo{constructor(o){this.reset(),this.numTouches=o.numTouches}reset(){this.centroid=void 0,this.startTime=0,this.touches={},this.aborted=!1}touchstart(o,f,y){(this.centroid||y.length>this.numTouches)&&(this.aborted=!0),this.aborted||(this.startTime===0&&(this.startTime=o.timeStamp),y.length===this.numTouches&&(this.centroid=function(w){const E=new s.P(0,0);for(const C of w)E._add(C);return E.div(w.length)}(f),this.touches=Mf(y,f)))}touchmove(o,f,y){if(this.aborted||!this.centroid)return;const w=Mf(y,f);for(const E in this.touches){const C=w[E];(!C||C.dist(this.touches[E])>30)&&(this.aborted=!0)}}touchend(o,f,y){if((!this.centroid||o.timeStamp-this.startTime>500)&&(this.aborted=!0),y.length===0){const w=!this.aborted&&this.centroid;if(this.reset(),w)return w}}}class ml{constructor(o){this.singleTap=new mo(o),this.numTaps=o.numTaps,this.reset()}reset(){this.lastTime=1/0,this.lastTap=void 0,this.count=0,this.singleTap.reset()}touchstart(o,f,y){this.singleTap.touchstart(o,f,y)}touchmove(o,f,y){this.singleTap.touchmove(o,f,y)}touchend(o,f,y){const w=this.singleTap.touchend(o,f,y);if(w){const E=o.timeStamp-this.lastTime<500,C=!this.lastTap||this.lastTap.dist(w)<30;if(E&&C||this.reset(),this.count++,this.lastTime=o.timeStamp,this.lastTap=w,this.count===this.numTaps)return this.reset(),w}}}class vy{constructor(){this._zoomIn=new ml({numTouches:1,numTaps:2}),this._zoomOut=new ml({numTouches:2,numTaps:1}),this.reset()}reset(){this._active=!1,this._zoomIn.reset(),this._zoomOut.reset()}touchstart(o,f,y){this._zoomIn.touchstart(o,f,y),this._zoomOut.touchstart(o,f,y)}touchmove(o,f,y){this._zoomIn.touchmove(o,f,y),this._zoomOut.touchmove(o,f,y)}touchend(o,f,y){const w=this._zoomIn.touchend(o,f,y),E=this._zoomOut.touchend(o,f,y);return w?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()+1,around:C.unproject(w)},{originalEvent:o})}):E?(this._active=!0,o.preventDefault(),setTimeout(()=>this.reset(),0),{cameraAnimation:C=>C.easeTo({duration:300,zoom:C.getZoom()-1,around:C.unproject(E)},{originalEvent:o})}):void 0}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}const md={0:1,2:2},Ah={Control:"ctrlKey",Alt:"altKey",Shift:"shiftKey",Meta:"metaKey"};class Ch{constructor(o){this.reset(),this._clickTolerance=o.clickTolerance||1}blur(){this.reset()}reset(){this._active=!1,this._moved=!1,this._lastPoint=void 0,this._eventButton=void 0}_correctButton(o,f){return!1}_move(o,f){return{}}mousedown(o,f){if(this._lastPoint)return;const y=oe(o);this._correctButton(o,y)&&(this._lastPoint=f,this._eventButton=y)}mousemoveWindow(o,f){const y=this._lastPoint;if(y){if(o.preventDefault(),this._eventButton!=null&&function(w,E){const C=md[E];return w.buttons===void 0||(w.buttons&C)!==C}(o,this._eventButton))this.reset();else if(this._moved||!(f.dist(y)<this._clickTolerance))return this._moved=!0,this._lastPoint=f,this._move(y,f)}}mouseupWindow(o){this._lastPoint&&oe(o)===this._eventButton&&(this._moved&&be(),this.reset())}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class gd extends Ch{mousedown(o,f){super.mousedown(o,f),this._lastPoint&&(this._active=!0)}_correctButton(o,f){return f===0&&!o.ctrlKey}_move(o,f){return{around:f,panDelta:f.sub(o)}}}class Eg extends Ch{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Ah[o.pitchRotateKey]:void 0}_correctButton(o,f){return this._pitchRotateKey?f===0&&o[this._pitchRotateKey]:f===0&&o.ctrlKey||f===2}_move(o,f){const y=.8*(f.x-o.x);if(y)return this._active=!0,{bearingDelta:y}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class _d extends Ch{constructor(o){super(o),this._pitchRotateKey=o.pitchRotateKey?Ah[o.pitchRotateKey]:void 0}_correctButton(o,f){return this._pitchRotateKey?f===0&&o[this._pitchRotateKey]:f===0&&o.ctrlKey||f===2}_move(o,f){const y=-.5*(f.y-o.y);if(y)return this._active=!0,{pitchDelta:y}}contextmenu(o){this._pitchRotateKey||o.preventDefault()}}class Pf{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._minTouches=1,this._clickTolerance=f.clickTolerance||1,this.reset(),s.aV(["_addTouchPanBlocker","_showTouchPanBlockerAlert"],this)}reset(){this._active=!1,this._touches={},this._sum=new s.P(0,0)}touchstart(o,f,y){return this._calculateTransform(o,f,y)}touchmove(o,f,y){if(this._active&&!(y.length<this._minTouches)){if(this._map._cooperativeGestures&&!this._map.isMoving()){if(y.length===1&&!s.ex())return void this._showTouchPanBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}return o.cancelable&&o.preventDefault(),this._calculateTransform(o,f,y)}}touchend(o,f,y){this._calculateTransform(o,f,y),this._active&&y.length<this._minTouches&&this.reset()}touchcancel(){this.reset()}_calculateTransform(o,f,y){y.length>0&&(this._active=!0);const w=Mf(y,f),E=new s.P(0,0),C=new s.P(0,0);let M=0;for(const j in w){const H=w[j],Z=this._touches[j];Z&&(E._add(H),C._add(H.sub(Z)),M++,w[j]=H)}if(this._touches=w,M<this._minTouches||!C.mag())return;const N=C.div(M);return this._sum._add(N),this._sum.mag()<this._clickTolerance?void 0:{around:E.div(M),panDelta:N}}enable(){this._enabled=!0,this._map._cooperativeGestures&&(this._addTouchPanBlocker(),this._el.classList.add("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page"))}disable(){this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove(),this._el.classList.remove("mapboxgl-touch-pan-blocker-override","mapboxgl-scrollable-page")),this.reset()}isEnabled(){return!!this._enabled}isActive(){return!!this._active}_addTouchPanBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=X("div","mapboxgl-touch-pan-blocker",this._map._container),this._alertContainer.textContent=this._map._getUIString("TouchPanBlocker.Message"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showTouchPanBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-touch-pan-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-touch-pan-blocker-show"),this._alertContainer.removeAttribute("role")},500)}}class Up{constructor(){this.reset()}reset(){this._active=!1,this._firstTwoTouches=void 0}_start(o){}_move(o,f,y){return{}}touchstart(o,f,y){this._firstTwoTouches||y.length<2||(this._firstTwoTouches=[y[0].identifier,y[1].identifier],this._start([f[0],f[1]]))}touchmove(o,f,y){const w=this._firstTwoTouches;if(!w)return;o.preventDefault();const[E,C]=w,M=Dh(y,f,E),N=Dh(y,f,C);if(!M||!N)return;const j=this._aroundCenter?null:M.add(N).div(2);return this._move([M,N],j,o)}touchend(o,f,y){if(!this._firstTwoTouches)return;const[w,E]=this._firstTwoTouches,C=Dh(y,f,w),M=Dh(y,f,E);C&&M||(this._active&&be(),this.reset())}touchcancel(){this.reset()}enable(o){this._enabled=!0,this._aroundCenter=!!o&&o.around==="center"}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}function Dh(_,o,f){for(let y=0;y<_.length;y++)if(_[y].identifier===f)return o[y]}function jp(_,o){return Math.log(_/o)/Math.LN2}class by extends Up{reset(){super.reset(),this._distance=0,this._startDistance=0}_start(o){this._startDistance=this._distance=o[0].dist(o[1])}_move(o,f){const y=this._distance;if(this._distance=o[0].dist(o[1]),this._active||!(Math.abs(jp(this._distance,this._startDistance))<.1))return this._active=!0,{zoomDelta:jp(this._distance,y),pinchAround:f}}}function xy(_,o){return 180*_.angleWith(o)/Math.PI}class H0 extends Up{reset(){super.reset(),this._minDiameter=0,this._startVector=void 0,this._vector=void 0}_start(o){this._startVector=this._vector=o[0].sub(o[1]),this._minDiameter=o[0].dist(o[1])}_move(o,f){const y=this._vector;if(this._vector=o[0].sub(o[1]),y&&(this._active||!this._isBelowThreshold(this._vector)))return this._active=!0,{bearingDelta:xy(this._vector,y),pinchAround:f}}_isBelowThreshold(o){this._minDiameter=Math.min(this._minDiameter,o.mag());const f=25/(Math.PI*this._minDiameter)*360,y=this._startVector;if(!y)return!1;const w=xy(o,y);return Math.abs(w)<f}}function Aa(_){return Math.abs(_.y)>Math.abs(_.x)}class $0 extends Up{constructor(o){super(),this._map=o}reset(){super.reset(),this._valid=void 0,this._firstMove=void 0,this._lastPoints=void 0}_start(o){this._lastPoints=o,Aa(o[0].sub(o[1]))&&(this._valid=!1)}_move(o,f,y){const w=this._lastPoints;if(!w)return;const E=o[0].sub(w[0]),C=o[1].sub(w[1]);return this._map._cooperativeGestures&&!s.ex()&&y.touches.length<3||(this._valid=this.gestureBeginsVertically(E,C,y.timeStamp),!this._valid)?void 0:(this._lastPoints=o,this._active=!0,{pitchDelta:(E.y+C.y)/2*-.5})}gestureBeginsVertically(o,f,y){if(this._valid!==void 0)return this._valid;const w=o.mag()>=2,E=f.mag()>=2;if(!w&&!E)return;if(!w||!E)return this._firstMove==null&&(this._firstMove=y),y-this._firstMove<100&&void 0;const C=o.y>0==f.y>0;return Aa(o)&&Aa(f)&&C}}const oo={panStep:100,bearingStep:15,pitchStep:10};class G0{constructor(){const o=oo;this._panStep=o.panStep,this._bearingStep=o.bearingStep,this._pitchStep=o.pitchStep,this._rotationDisabled=!1}blur(){this.reset()}reset(){this._active=!1}keydown(o){if(o.altKey||o.ctrlKey||o.metaKey)return;let f=0,y=0,w=0,E=0,C=0;switch(o.keyCode){case 61:case 107:case 171:case 187:f=1;break;case 189:case 109:case 173:f=-1;break;case 37:o.shiftKey?y=-1:(o.preventDefault(),E=-1);break;case 39:o.shiftKey?y=1:(o.preventDefault(),E=1);break;case 38:o.shiftKey?w=1:(o.preventDefault(),C=-1);break;case 40:o.shiftKey?w=-1:(o.preventDefault(),C=1);break;default:return}return this._rotationDisabled&&(y=0,w=0),{cameraAnimation:M=>{const N=M.getZoom();M.easeTo({duration:300,easeId:"keyboardHandler",easing:q0,zoom:f?Math.round(N)+f*(o.shiftKey?2:1):N,bearing:M.getBearing()+y*this._bearingStep,pitch:M.getPitch()+w*this._pitchStep,offset:[-E*this._panStep,-C*this._panStep],center:M.getCenter()},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}disableRotation(){this._rotationDisabled=!0}enableRotation(){this._rotationDisabled=!1}}function q0(_){return _*(2-_)}const W0=4.000244140625,Rh=1/450;class kf{constructor(o,f){this._map=o,this._el=o.getCanvasContainer(),this._handler=f,this._delta=0,this._lastDelta=0,this._defaultZoomRate=.01,this._wheelZoomRate=Rh,s.aV(["_onTimeout","_addScrollZoomBlocker","_showBlockerAlert"],this)}setZoomRate(o){this._defaultZoomRate=o}setWheelZoomRate(o){this._wheelZoomRate=o}isEnabled(){return!!this._enabled}isActive(){return this._active||this._finishTimeout!==void 0}isZooming(){return!!this._zooming}enable(o){this.isEnabled()||(this._enabled=!0,this._aroundCenter=!!o&&o.around==="center",this._map._cooperativeGestures&&this._addScrollZoomBlocker())}disable(){this.isEnabled()&&(this._enabled=!1,this._map._cooperativeGestures&&(clearTimeout(this._alertTimer),this._alertContainer.remove()))}wheel(o){if(!this.isEnabled())return;if(this._map._cooperativeGestures){if(!(o.ctrlKey||o.metaKey||this.isZooming()||s.ex()))return void this._showBlockerAlert();this._alertContainer.style.visibility!=="hidden"&&(this._alertContainer.style.visibility="hidden",clearTimeout(this._alertTimer))}let f=o.deltaMode===WheelEvent.DOM_DELTA_LINE?40*o.deltaY:o.deltaY;const y=s.q.now(),w=y-(this._lastWheelEventTime||0);this._lastWheelEventTime=y,f!==0&&f%W0==0?this._type="wheel":f!==0&&Math.abs(f)<4?this._type="trackpad":w>400?(this._type=null,this._lastValue=f,this._timeout=window.setTimeout(this._onTimeout,40,o)):this._type||(this._type=Math.abs(w*f)<200?"trackpad":"wheel",this._timeout&&(clearTimeout(this._timeout),this._timeout=null,f+=this._lastValue)),o.shiftKey&&f&&(f/=4),this._type&&(this._lastWheelEvent=o,this._delta-=f,this._active||this._start(o)),o.preventDefault()}_onTimeout(o){this._type="wheel",this._delta-=this._lastValue,this._active||this._start(o)}_start(o){if(!this._delta)return;this._frameId&&(this._frameId=null),this._active=!0,this.isZooming()||(this._zooming=!0),this._finishTimeout&&(clearTimeout(this._finishTimeout),delete this._finishTimeout);const f=_e(this._el,o);this._aroundPoint=this._aroundCenter?this._map.transform.centerPoint:f,this._aroundCoord=this._map.transform.pointCoordinate3D(this._aroundPoint),this._targetZoom=void 0,this._frameId||(this._frameId=!0,this._handler._triggerRenderFrame())}renderFrame(){if(!this._frameId||(this._frameId=null,!this.isActive()))return;const o=this._map.transform;this._type==="wheel"&&o.projection.wrap&&(o._center.lng>=180||o._center.lng<=-180)&&(this._prevEase=null,this._easing=null,this._lastWheelEvent=null,this._lastWheelEventTime=0);const f=()=>o._terrainEnabled()&&this._aroundCoord?o.computeZoomRelativeTo(this._aroundCoord):o.zoom;if(this._delta!==0){const j=this._type==="wheel"&&Math.abs(this._delta)>W0?this._wheelZoomRate:this._defaultZoomRate;let H=2/(1+Math.exp(-Math.abs(this._delta*j)));this._delta<0&&H!==0&&(H=1/H);const Z=f(),W=Math.pow(2,Z),Q=typeof this._targetZoom=="number"?o.zoomScale(this._targetZoom):W;this._targetZoom=Math.min(o.maxZoom,Math.max(o.minZoom,o.scaleZoom(Q*H))),this._type==="wheel"&&(this._startZoom=Z,this._easing=this._smoothOutEasing(200)),this._lastDelta=this._delta,this._delta=0}const y=typeof this._targetZoom=="number"?this._targetZoom:f(),w=this._startZoom,E=this._easing;let C,M=!1;if(this._type==="wheel"&&w&&E){const j=Math.min((s.q.now()-this._lastWheelEventTime)/200,1),H=E(j);C=s.ai(w,y,H),j<1?this._frameId||(this._frameId=!0):M=!0}else C=y,M=!0;this._active=!0,M&&(this._active=!1,this._finishTimeout=window.setTimeout(()=>{this._zooming=!1,this._handler._triggerRenderFrame(),delete this._targetZoom,delete this._finishTimeout},200));let N=C-f();return N*this._lastDelta<0&&(N=0),{noInertia:!0,needsRenderFrame:!M,zoomDelta:N,around:this._aroundPoint,aroundCoord:this._aroundCoord,originalEvent:this._lastWheelEvent}}_smoothOutEasing(o){let f=s.ey;if(this._prevEase){const y=this._prevEase,w=(s.q.now()-y.start)/y.duration,E=y.easing(w+.01)-y.easing(w),C=.27/Math.sqrt(E*E+1e-4)*.01,M=Math.sqrt(.0729-C*C);f=s.ew(C,M,.25,1)}return this._prevEase={start:s.q.now(),duration:o,easing:f},f}blur(){this.reset()}reset(){this._active=!1}_addScrollZoomBlocker(){this._map&&!this._alertContainer&&(this._alertContainer=X("div","mapboxgl-scroll-zoom-blocker",this._map._container),this._alertContainer.textContent=/(Mac|iPad)/i.test(navigator.userAgent)?this._map._getUIString("ScrollZoomBlocker.CmdMessage"):this._map._getUIString("ScrollZoomBlocker.CtrlMessage"),this._alertContainer.style.fontSize=`${Math.max(10,Math.min(24,Math.floor(.05*this._el.clientWidth)))}px`)}_showBlockerAlert(){this._alertContainer.style.visibility="visible",this._alertContainer.classList.add("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.setAttribute("role","alert"),clearTimeout(this._alertTimer),this._alertTimer=window.setTimeout(()=>{this._alertContainer.classList.remove("mapboxgl-scroll-zoom-blocker-show"),this._alertContainer.removeAttribute("role")},200)}}class wy{constructor(o,f){this._clickZoom=o,this._tapZoom=f}enable(){this._clickZoom.enable(),this._tapZoom.enable()}disable(){this._clickZoom.disable(),this._tapZoom.disable()}isEnabled(){return this._clickZoom.isEnabled()&&this._tapZoom.isEnabled()}isActive(){return this._clickZoom.isActive()||this._tapZoom.isActive()}}class Nf{constructor(){this.reset()}reset(){this._active=!1}blur(){this.reset()}dblclick(o,f){return o.preventDefault(),{cameraAnimation:y=>{y.easeTo({duration:300,zoom:y.getZoom()+(o.shiftKey?-1:1),around:y.unproject(f)},{originalEvent:o})}}}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Y0{constructor(){this._tap=new ml({numTouches:1,numTaps:1}),this.reset()}reset(){this._active=!1,this._swipePoint=void 0,this._swipeTouch=0,this._tapTime=0,this._tap.reset()}touchstart(o,f,y){this._swipePoint||(this._tapTime&&o.timeStamp-this._tapTime>500&&this.reset(),this._tapTime?y.length>0&&(this._swipePoint=f[0],this._swipeTouch=y[0].identifier):this._tap.touchstart(o,f,y))}touchmove(o,f,y){if(this._tapTime){if(this._swipePoint){if(y[0].identifier!==this._swipeTouch)return;const w=f[0],E=w.y-this._swipePoint.y;return this._swipePoint=w,o.preventDefault(),this._active=!0,{zoomDelta:E/128}}}else this._tap.touchmove(o,f,y)}touchend(o,f,y){this._tapTime?this._swipePoint&&y.length===0&&this.reset():this._tap.touchend(o,f,y)&&(this._tapTime=o.timeStamp)}touchcancel(){this.reset()}enable(){this._enabled=!0}disable(){this._enabled=!1,this.reset()}isEnabled(){return this._enabled}isActive(){return this._active}}class Z0{constructor(o,f,y){this._el=o,this._mousePan=f,this._touchPan=y}enable(o){this._inertiaOptions=o||{},this._mousePan.enable(),this._touchPan.enable(),this._el.classList.add("mapboxgl-touch-drag-pan")}disable(){this._mousePan.disable(),this._touchPan.disable(),this._el.classList.remove("mapboxgl-touch-drag-pan")}isEnabled(){return this._mousePan.isEnabled()&&this._touchPan.isEnabled()}isActive(){return this._mousePan.isActive()||this._touchPan.isActive()}}class Zx{constructor(o,f,y){this._pitchWithRotate=o.pitchWithRotate,this._mouseRotate=f,this._mousePitch=y}enable(){this._mouseRotate.enable(),this._pitchWithRotate&&this._mousePitch.enable()}disable(){this._mouseRotate.disable(),this._mousePitch.disable()}isEnabled(){return this._mouseRotate.isEnabled()&&(!this._pitchWithRotate||this._mousePitch.isEnabled())}isActive(){return this._mouseRotate.isActive()||this._mousePitch.isActive()}}class X0{constructor(o,f,y,w){this._el=o,this._touchZoom=f,this._touchRotate=y,this._tapDragZoom=w,this._rotationDisabled=!1,this._enabled=!0}enable(o){this._touchZoom.enable(o),this._rotationDisabled||this._touchRotate.enable(o),this._tapDragZoom.enable(),this._el.classList.add("mapboxgl-touch-zoom-rotate")}disable(){this._touchZoom.disable(),this._touchRotate.disable(),this._tapDragZoom.disable(),this._el.classList.remove("mapboxgl-touch-zoom-rotate")}isEnabled(){return this._touchZoom.isEnabled()&&(this._rotationDisabled||this._touchRotate.isEnabled())&&this._tapDragZoom.isEnabled()}isActive(){return this._touchZoom.isActive()||this._touchRotate.isActive()||this._tapDragZoom.isActive()}disableRotation(){this._rotationDisabled=!0,this._touchRotate.disable()}enableRotation(){this._rotationDisabled=!1,this._touchZoom.isEnabled()&&this._touchRotate.enable()}}const Hp=_=>_.zoom||_.drag||_.pitch||_.rotate;class Yr extends s.A{}class Xx{constructor(){this.constants=[1,1,.01],this.radius=0}setup(o,f){const y=s.at([],f,o);this.radius=s.ae(y[2]<0?s.eA([],y,this.constants):[y[0],y[1],0])}projectRay(o){s.eA(o,o,this.constants),s.au(o,o),s.eB(o,o,this.constants);const f=s.bY([],o,this.radius);if(f[2]>0){const y=s.bY([],[0,0,1],s.bG(f,[0,0,1])),w=s.bY([],s.au([],[f[0],f[1],0]),this.radius),E=s.cV([],f,s.bY([],s.at([],s.cV([],w,y),f),2));f[0]=E[0],f[1]=E[1]}return f}}function Ty(_){return _.panDelta&&_.panDelta.mag()||_.zoomDelta||_.bearingDelta||_.pitchDelta}class Ey{constructor(o,f){this._map=o,this._el=this._map.getCanvasContainer(),this._handlers=[],this._handlersById={},this._changes=[],this._inertia=new Sa(o),this._bearingSnap=f.bearingSnap,this._previousActiveHandlers={},this._trackingEllipsoid=new Xx,this._dragOrigin=null,this._eventsInProgress={},this._addDefaultHandlers(f),s.aV(["handleEvent","handleWindowEvent"],this);const y=this._el;this._listeners=[[y,"touchstart",{passive:!0}],[y,"touchmove",{passive:!1}],[y,"touchend",void 0],[y,"touchcancel",void 0],[y,"mousedown",void 0],[y,"mousemove",void 0],[y,"mouseup",void 0],[document,"mousemove",{capture:!0}],[document,"mouseup",void 0],[y,"mouseover",void 0],[y,"mouseout",void 0],[y,"dblclick",void 0],[y,"click",void 0],[y,"keydown",{capture:!1}],[y,"keyup",void 0],[y,"wheel",{passive:!1}],[y,"contextmenu",void 0],[window,"blur",void 0]];for(const[w,E,C]of this._listeners){const M=w===document?this.handleWindowEvent:this.handleEvent;w.addEventListener(E,M,C)}}destroy(){for(const[o,f,y]of this._listeners){const w=o===document?this.handleWindowEvent:this.handleEvent;o.removeEventListener(f,w,y)}}_addDefaultHandlers(o){const f=this._map,y=f.getCanvasContainer();this._add("mapEvent",new Sh(f,o));const w=f.boxZoom=new ou(f,o);this._add("boxZoom",w);const E=new vy,C=new Nf;f.doubleClickZoom=new wy(C,E),this._add("tapZoom",E),this._add("clickZoom",C);const M=new Y0;this._add("tapDragZoom",M);const N=f.touchPitch=new $0(f);this._add("touchPitch",N);const j=new Eg(o),H=new _d(o);f.dragRotate=new Zx(o,j,H),this._add("mouseRotate",j,["mousePitch"]),this._add("mousePitch",H,["mouseRotate"]);const Z=new gd(o),W=new Pf(f,o);f.dragPan=new Z0(y,Z,W),this._add("mousePan",Z),this._add("touchPan",W,["touchZoom","touchRotate"]);const Q=new H0,ce=new by;f.touchZoomRotate=new X0(y,ce,Q,M),this._add("touchRotate",Q,["touchPan","touchZoom"]),this._add("touchZoom",ce,["touchPan","touchRotate"]),this._add("blockableMapEvent",new Tg(f));const se=f.scrollZoom=new kf(f,this);this._add("scrollZoom",se,["mousePan"]);const ue=f.keyboard=new G0;this._add("keyboard",ue);for(const pe of["boxZoom","doubleClickZoom","tapDragZoom","touchPitch","dragRotate","dragPan","touchZoomRotate","scrollZoom","keyboard"])o.interactive&&o[pe]&&f[pe].enable(o[pe])}_add(o,f,y){this._handlers.push({handlerName:o,handler:f,allowed:y}),this._handlersById[o]=f}stop(o){if(!this._updatingCamera){for(const{handler:f}of this._handlers)f.reset();this._inertia.clear(),this._fireEvents({},{},o),this._changes=[],this._originalZoom=void 0}}isActive(){for(const{handler:o}of this._handlers)if(o.isActive())return!0;return!1}isZooming(){return!!this._eventsInProgress.zoom||this._map.scrollZoom.isZooming()}isRotating(){return!!this._eventsInProgress.rotate}isMoving(){return!!Hp(this._eventsInProgress)||this.isZooming()}_isDragging(){return!!this._eventsInProgress.drag}_blockedByActive(o,f,y){for(const w in o)if(w!==y&&(!f||f.indexOf(w)<0))return!0;return!1}handleWindowEvent(o){this.handleEvent(o,`${o.type}Window`)}_getMapTouches(o){const f=[];for(const y of o)this._el.contains(y.target)&&f.push(y);return f}handleEvent(o,f){this._updatingCamera=!0;const y=o.type==="renderFrame",w=y?void 0:o,E={needsRenderFrame:!1},C={},M={},N=o.touches?this._getMapTouches(o.touches):void 0,j=N?Te(this._el,N):y?void 0:_e(this._el,o);for(const{handlerName:W,handler:Q,allowed:ce}of this._handlers){if(!Q.isEnabled())continue;let se;this._blockedByActive(M,ce,W)?Q.reset():Q[f||o.type]&&(se=Q[f||o.type](o,j,N),this.mergeHandlerResult(E,C,se,W,w),se&&se.needsRenderFrame&&this._triggerRenderFrame()),(se||Q.isActive())&&(M[W]=Q)}const H={};for(const W in this._previousActiveHandlers)M[W]||(H[W]=w);this._previousActiveHandlers=M,(Object.keys(H).length||Ty(E))&&(this._changes.push([E,C,H]),this._triggerRenderFrame()),(Object.keys(M).length||Ty(E))&&this._map._stop(!0),this._updatingCamera=!1;const{cameraAnimation:Z}=E;Z&&(this._inertia.clear(),this._fireEvents({},{},!0),this._changes=[],Z(this._map))}mergeHandlerResult(o,f,y,w,E){if(!y)return;s.h(o,y);const C={handlerName:w,originalEvent:y.originalEvent||E};y.zoomDelta!==void 0&&(f.zoom=C),y.panDelta!==void 0&&(f.drag=C),y.pitchDelta!==void 0&&(f.pitch=C),y.bearingDelta!==void 0&&(f.rotate=C)}_applyChanges(){const o={},f={},y={};for(const[w,E,C]of this._changes)w.panDelta&&(o.panDelta=(o.panDelta||new s.P(0,0))._add(w.panDelta)),w.zoomDelta&&(o.zoomDelta=(o.zoomDelta||0)+w.zoomDelta),w.bearingDelta&&(o.bearingDelta=(o.bearingDelta||0)+w.bearingDelta),w.pitchDelta&&(o.pitchDelta=(o.pitchDelta||0)+w.pitchDelta),w.around!==void 0&&(o.around=w.around),w.aroundCoord!==void 0&&(o.aroundCoord=w.aroundCoord),w.pinchAround!==void 0&&(o.pinchAround=w.pinchAround),w.noInertia&&(o.noInertia=w.noInertia),s.h(f,E),s.h(y,C);this._updateMapTransform(o,f,y),this._changes=[]}_updateMapTransform(o,f,y){const w=this._map,E=w.transform,C=ge=>[ge.x,ge.y,ge.z];if((ge=>{const Pe=this._eventsInProgress.drag;return Pe&&!this._handlersById[Pe.handlerName].isActive()})()&&!Ty(o)){const ge=E.zoom;E.cameraElevationReference="sea",this._originalZoom!=null&&E._orthographicProjectionAtLowPitch&&E.projection.name!=="globe"&&E.pitch===0?(E.cameraElevationReference="ground",E.zoom=this._originalZoom):(E.recenterOnTerrain(),E.cameraElevationReference="ground"),ge!==E.zoom&&this._map._update(!0)}if(E._isCameraConstrained&&w._stop(!0),!Ty(o))return void this._fireEvents(f,y,!0);let{panDelta:M,zoomDelta:N,bearingDelta:j,pitchDelta:H,around:Z,aroundCoord:W,pinchAround:Q}=o;E._isCameraConstrained&&(N>0&&(N=0),E._isCameraConstrained=!1),Q!==void 0&&(Z=Q),(N||(ge=>f[ge]&&!this._eventsInProgress[ge])("drag"))&&Z&&(this._dragOrigin=C(E.pointCoordinate3D(Z)),this._originalZoom=E.zoom,this._trackingEllipsoid.setup(E._camera.position,this._dragOrigin)),E.cameraElevationReference="sea",w._stop(!0),Z=Z||w.transform.centerPoint,j&&(E.bearing+=j),H&&(E.pitch+=H),E._updateCameraState();const ce=[0,0,0];if(M)if(E.projection.name==="mercator"){const ge=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Z).dir),Pe=this._trackingEllipsoid.projectRay(E.screenPointToMercatorRay(Z.sub(M)).dir);ce[0]=Pe[0]-ge[0],ce[1]=Pe[1]-ge[1]}else{const ge=E.pointCoordinate(Z);if(E.projection.name==="globe"){M=M.rotate(-E.angle);const Pe=E._pixelsPerMercatorPixel/E.worldSize;ce[0]=-M.x*s.ez(s.aY(ge.y))*Pe,ce[1]=-M.y*s.ez(E.center.lat)*Pe}else{const Pe=E.pointCoordinate(Z.sub(M));ge&&Pe&&(ce[0]=Pe.x-ge.x,ce[1]=Pe.y-ge.y)}}const se=E.zoom,ue=[0,0,0];if(N){const ge=C(W||E.pointCoordinate3D(Z)),Pe={dir:s.au([],s.at([],ge,E._camera.position))};if(Pe.dir[2]<0){const Ve=E.zoomDeltaToMovement(ge,N);s.bY(ue,Pe.dir,Ve)}}const pe=s.cV(ce,ce,ue);E._translateCameraConstrained(pe),N&&Math.abs(E.zoom-se)>1e-4&&E.recenterOnTerrain(),E.cameraElevationReference="ground",this._map._update(),o.noInertia||this._inertia.record(o),this._fireEvents(f,y,!0)}_fireEvents(o,f,y){const w=Hp(this._eventsInProgress),E=Hp(o),C={};for(const H in o){const{originalEvent:Z}=o[H];this._eventsInProgress[H]||(C[`${H}start`]=Z),this._eventsInProgress[H]=o[H]}!w&&E&&this._fireEvent("movestart",E.originalEvent);for(const H in C)this._fireEvent(H,C[H]);E&&this._fireEvent("move",E.originalEvent);for(const H in o){const{originalEvent:Z}=o[H];this._fireEvent(H,Z)}const M={};let N;for(const H in this._eventsInProgress){const{handlerName:Z,originalEvent:W}=this._eventsInProgress[H];this._handlersById[Z].isActive()||(delete this._eventsInProgress[H],N=f[Z]||W,M[`${H}end`]=N)}for(const H in M)this._fireEvent(H,M[H]);const j=Hp(this._eventsInProgress);if(y&&(w||E)&&!j){this._updatingCamera=!0;const H=this._inertia._onMoveEnd(this._map.dragPan._inertiaOptions),Z=W=>W!==0&&-this._bearingSnap<W&&W<this._bearingSnap;H?(Z(H.bearing||this._map.getBearing())&&(H.bearing=0),this._map.easeTo(H,{originalEvent:N})):(this._map.fire(new s.A("moveend",{originalEvent:N})),Z(this._map.getBearing())&&this._map.resetNorth()),this._updatingCamera=!1}}_fireEvent(o,f){this._map.fire(new s.A(o,f?{originalEvent:f}:{}))}_requestFrame(){return this._map.triggerRepaint(),this._map._renderTaskQueue.add(o=>{this._frameId=void 0,this.handleEvent(new Yr("renderFrame",{timeStamp:o})),this._applyChanges()})}_triggerRenderFrame(){this._frameId===void 0&&(this._frameId=this._requestFrame())}}const Q0="map.setFreeCameraOptions(...) and map.getFreeCameraOptions() are not yet supported for non-mercator projections.";class Sg extends s.E{constructor(o,f){super(),this._moving=!1,this._zooming=!1,this.transform=o,this._bearingSnap=f.bearingSnap,this._respectPrefersReducedMotion=f.respectPrefersReducedMotion!==!1,s.aV(["_renderFrameCallback"],this)}getCenter(){return new s.cd(this.transform.center.lng,this.transform.center.lat)}setCenter(o,f){return this.jumpTo({center:o},f)}panBy(o,f,y){return o=s.P.convert(o).mult(-1),this.panTo(this.transform.center,s.h({offset:o},f),y)}panTo(o,f,y){return this.easeTo(s.h({center:o},f),y)}getZoom(){return this.transform.zoom}setZoom(o,f){return this.jumpTo({zoom:o},f),this}zoomTo(o,f,y){return this.easeTo(s.h({zoom:o},f),y)}zoomIn(o,f){return this.zoomTo(this.getZoom()+1,o,f),this}zoomOut(o,f){return this.zoomTo(this.getZoom()-1,o,f),this}getBearing(){return this.transform.bearing}setBearing(o,f){return this.jumpTo({bearing:o},f),this}getPadding(){return this.transform.padding}setPadding(o,f){return this.jumpTo({padding:o},f),this}rotateTo(o,f,y){return this.easeTo(s.h({bearing:o},f),y)}resetNorth(o,f){return this.rotateTo(0,s.h({duration:1e3},o),f),this}resetNorthPitch(o,f){return this.easeTo(s.h({bearing:0,pitch:0,duration:1e3},o),f),this}snapToNorth(o,f){return Math.abs(this.getBearing())<this._bearingSnap?this.resetNorth(o,f):this}getPitch(){return this.transform.pitch}setPitch(o,f){return this.jumpTo({pitch:o},f),this}cameraForBounds(o,f){o=s.aG.convert(o);const y=f&&f.bearing||0,w=f&&f.pitch||0,E=o.getNorthWest(),C=o.getSouthEast();return this._cameraForBounds(this.transform,E,C,y,w,f)}_extendPadding(o){const f={top:0,right:0,bottom:0,left:0};return o==null?s.h({},f,this.transform.padding):typeof o=="number"?{top:o,bottom:o,right:o,left:o}:s.h({},f,o)}_extendCameraOptions(o){return(o=s.h({offset:[0,0],maxZoom:this.transform.maxZoom},o)).padding=this._extendPadding(o.padding),o}_minimumAABBFrustumDistance(o,f){const y=f.max[0]-f.min[0],w=f.max[1]-f.min[1];return y/w>o.aspect?y/(2*Math.tan(.5*o.fovX)*o.aspect):w/(2*Math.tan(.5*o.fovY)*o.aspect)}_cameraForBoundsOnGlobe(o,f,y,w,E,C){const M=o.clone(),N=this._extendCameraOptions(C);M.bearing=w,M.pitch=E;const j=s.cd.convert(f),H=s.cd.convert(y),Z=.5*(j.lat+H.lat),W=.5*(j.lng+H.lng),Q=s.eC(Z,W),ce=s.au([],Q),se=s.au([],s.bF([],ce,[0,1,0])),ue=s.bF([],se,ce),pe=[se[0],se[1],se[2],0,ue[0],ue[1],ue[2],0,ce[0],ce[1],ce[2],0,0,0,0,1],ge=[Q,s.eC(j.lat,j.lng),s.eC(H.lat,j.lng),s.eC(H.lat,H.lng),s.eC(j.lat,H.lng),s.eC(Z,j.lng),s.eC(Z,H.lng),s.eC(j.lat,W),s.eC(H.lat,W)];let Pe=s.cW.fromPoints(ge.map(Tt=>[s.bG(se,Tt),s.bG(ue,Tt),s.bG(ce,Tt)]));const Ve=s.ad([],Pe.center,pe);s.eD(Ve)===0&&s.eE(Ve,0,0,1),s.au(Ve,Ve),s.bY(Ve,Ve,s.aB),M.center=s.eF(Ve);const Ye=M.getWorldToCameraMatrix(),qe=s.bi(new Float64Array(16),Ye);Pe=s.cW.applyTransform(Pe,s.az([],Ye,pe));const je=this._extendAABB(Pe,M,N,w);if(!je)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Pe=je,s.ad(Ve,Ve,Ye);const Ue=.5*(Pe.max[2]-Pe.min[2]),We=this._minimumAABBFrustumDistance(M,Pe),et=s.bY([],[0,0,1],Ue),_t=s.cV(et,Ve,et),ft=We+(M.pitch===0?0:s.bD(Ve,_t)),Mt=M.globeCenterInViewSpace,Rt=s.at([],Ve,[Mt[0],Mt[1],Mt[2]]);s.au(Rt,Rt),s.bY(Rt,Rt,ft);const jt=s.cV([],Ve,Rt);s.ad(jt,jt,qe);const ht=s.eq/s.aB,Dt=s.ae(jt),ot=s.c6(Math.max(Dt*ht-s.eq,Number.EPSILON),0),At=Math.min(M.zoomFromMercatorZAdjusted(ot),N.maxZoom);return At>.5*(s.cL+s.cx)?(M.setProjection({name:"mercator"}),M.zoom=At,this._cameraForBounds(M,f,y,w,E,C)):{center:M.center,zoom:At,bearing:w,pitch:E}}_extendAABB(o,f,y,w){const E=.5*((y.padding.left||0)+(y.padding.right||0)),C=.5*((y.padding.top||0)+(y.padding.bottom||0)),M=C,N=E,j=E,H=C,Z=f.width-(N+j),W=f.height-(M+H),Q=s.at([],o.max,o.min),ce=Math.min(Z/Q[0],W/Q[1]),se=Math.min(f.scaleZoom(f.scale*ce),y.maxZoom);if(isNaN(se))return null;const ue=f.scale/f.zoomScale(se),pe=new s.cW([o.min[0]-N*ue,o.min[1]-H*ue,o.min[2]],[o.max[0]+j*ue,o.max[1]+M*ue,o.max[2]]),ge=(typeof y.offset.x=="number"&&typeof y.offset.y=="number"?new s.P(y.offset.x,y.offset.y):s.P.convert(y.offset)).rotate(-s.al(w));return pe.center[0]-=ge.x*ue,pe.center[1]+=ge.y*ue,pe}queryTerrainElevation(o,f){const y=this.transform.elevation;return y?(f=s.h({},{exaggerated:!0},f),y.getAtPoint(s.ac.fromLngLat(o),null,f.exaggerated)):null}_cameraForBounds(o,f,y,w,E,C){if(o.projection.name==="globe")return this._cameraForBoundsOnGlobe(o,f,y,w,E,C);const M=o.clone(),N=this._extendCameraOptions(C);M.bearing=w,M.pitch=E;const j=s.cd.convert(f),H=s.cd.convert(y),Z=new s.cd(j.lng,H.lat),W=new s.cd(H.lng,j.lat),Q=M.project(j),ce=M.project(H),se=this.queryTerrainElevation(j),ue=this.queryTerrainElevation(H),pe=this.queryTerrainElevation(Z),ge=this.queryTerrainElevation(W),Pe=[[Q.x,Q.y,Math.min(se||0,ue||0,pe||0,ge||0)],[ce.x,ce.y,Math.max(se||0,ue||0,pe||0,ge||0)]];let Ve=s.cW.fromPoints(Pe);const Ye=M.getWorldToCameraMatrix(),qe=s.bi(new Float64Array(16),Ye);Ve=s.cW.applyTransform(Ve,Ye);const je=this._extendAABB(Ve,M,N,w);if(!je)return void s.w("Map cannot fit within canvas with the given bounds, padding, and/or offset.");Ve=je;const Ue=.5*s.at([],Ve.max,Ve.min)[2],We=this._minimumAABBFrustumDistance(M,Ve),et=[0,0,1,0];s.aA(et,et,Ye),s.eG(et,et);const _t=s.bY([],et,We+Ue),ft=s.cV([],Ve.center,_t);s.ad(Ve.center,Ve.center,qe),s.ad(ft,ft,qe);const Mt=M.unproject(new s.P(Ve.center[0],Ve.center[1])),Rt=s.eH(M.projection,Mt),jt=Math.pow(2,Rt),ht=Math.min(M._zoomFromMercatorZ(ft[2]*M.pixelsPerMeter*jt/M.worldSize),N.maxZoom);return M.mercatorFromTransition&&ht<.5*(s.cL+s.cx)?(M.setProjection({name:"globe"}),M.zoom=ht,this._cameraForBounds(M,f,y,w,E,C)):{center:Mt,zoom:ht,bearing:w,pitch:E}}fitBounds(o,f,y){const w=this.cameraForBounds(o,f);return this._fitInternal(w,f,y)}fitScreenCoordinates(o,f,y,w,E){const C=s.P.convert(o),M=s.P.convert(f),N=new s.P(Math.min(C.x,M.x),Math.min(C.y,M.y)),j=new s.P(Math.max(C.x,M.x),Math.max(C.y,M.y));if(this.transform.projection.name==="mercator"&&this.transform.anyCornerOffEdge(C,M))return this;const H=this.transform.pointLocation3D(N),Z=this.transform.pointLocation3D(j),W=this.transform.pointLocation3D(new s.P(N.x,j.y)),Q=this.transform.pointLocation3D(new s.P(j.x,N.y)),ce=[Math.min(H.lng,Z.lng,W.lng,Q.lng),Math.min(H.lat,Z.lat,W.lat,Q.lat)],se=[Math.max(H.lng,Z.lng,W.lng,Q.lng),Math.max(H.lat,Z.lat,W.lat,Q.lat)],ue=w&&w.pitch?w.pitch:this.getPitch(),pe=this._cameraForBounds(this.transform,ce,se,y,ue,w);return this._fitInternal(pe,w,E)}_fitInternal(o,f,y){return o?(f=s.h(o,f)).linear?this.easeTo(f,y):this.flyTo(f,y):this}jumpTo(o,f){this.stop();const y=o.preloadOnly?this.transform.clone():this.transform;let w=!1,E=!1,C=!1;"zoom"in o&&y.zoom!==+o.zoom&&(w=!0,y.zoom=+o.zoom),o.center!==void 0&&(y.center=s.cd.convert(o.center)),"bearing"in o&&y.bearing!==+o.bearing&&(E=!0,y.bearing=+o.bearing),"pitch"in o&&y.pitch!==+o.pitch&&(C=!0,y.pitch=+o.pitch);const M=typeof o.padding=="number"?this._extendPadding(o.padding):o.padding;if(o.padding!=null&&!y.isPaddingEqual(M))if(o.retainPadding===!1){const N=y.clone();N.padding=M,y.setLocationAtPoint(y.center,N.centerPoint)}else y.padding=M;return o.preloadOnly?(this._preloadTiles(y),this):(this.fire(new s.A("movestart",f)).fire(new s.A("move",f)),w&&this.fire(new s.A("zoomstart",f)).fire(new s.A("zoom",f)).fire(new s.A("zoomend",f)),E&&this.fire(new s.A("rotatestart",f)).fire(new s.A("rotate",f)).fire(new s.A("rotateend",f)),C&&this.fire(new s.A("pitchstart",f)).fire(new s.A("pitch",f)).fire(new s.A("pitchend",f)),this.fire(new s.A("moveend",f)))}getFreeCameraOptions(){return this.transform.projection.supportsFreeCamera||s.w(Q0),this.transform.getFreeCameraOptions()}setFreeCameraOptions(o,f){const y=this.transform;if(!y.projection.supportsFreeCamera)return s.w(Q0),this;this.stop();const w=y.zoom,E=y.pitch,C=y.bearing;y.setFreeCameraOptions(o);const M=w!==y.zoom,N=E!==y.pitch,j=C!==y.bearing;return this.fire(new s.A("movestart",f)).fire(new s.A("move",f)),M&&this.fire(new s.A("zoomstart",f)).fire(new s.A("zoom",f)).fire(new s.A("zoomend",f)),j&&this.fire(new s.A("rotatestart",f)).fire(new s.A("rotate",f)).fire(new s.A("rotateend",f)),N&&this.fire(new s.A("pitchstart",f)).fire(new s.A("pitch",f)).fire(new s.A("pitchend",f)),this.fire(new s.A("moveend",f)),this}easeTo(o,f){this._stop(!1,o.easeId),((o=s.h({offset:[0,0],duration:500,easing:s.ey},o)).animate===!1||this._prefersReducedMotion(o))&&(o.duration=0);const y=this.transform,w=this.getZoom(),E=this.getBearing(),C=this.getPitch(),M=this.getPadding(),N="zoom"in o?+o.zoom:w,j="bearing"in o?this._normalizeBearing(o.bearing,E):E,H="pitch"in o?+o.pitch:C,Z=this._extendPadding(o.padding),W=s.P.convert(o.offset);let Q,ce,se;if(y.projection.name==="globe"){const et=s.ac.fromLngLat(y.center),_t=W.rotate(-y.angle);et.x+=_t.x/y.worldSize,et.y+=_t.y/y.worldSize;const ft=et.toLngLat(),Mt=s.cd.convert(o.center||ft);this._normalizeCenter(Mt),Q=y.centerPoint.add(_t),ce=new s.P(et.x,et.y).mult(y.worldSize),se=new s.P(s.aD(Mt.lng),s.aH(Mt.lat)).mult(y.worldSize).sub(ce)}else{Q=y.centerPoint.add(W);const et=y.pointLocation(Q),_t=s.cd.convert(o.center||et);this._normalizeCenter(_t),ce=y.project(et),se=y.project(_t).sub(ce)}const ue=y.zoomScale(N-w);let pe,ge;o.around&&(pe=s.cd.convert(o.around),ge=y.locationPoint(pe));const Pe=this._zooming||N!==w,Ve=this._rotating||E!==j,Ye=this._pitching||H!==C,qe=!y.isPaddingEqual(Z),je=o.retainPadding===!1?y.clone():y,Ue=et=>_t=>{if(Pe&&(et.zoom=s.ai(w,N,_t)),Ve&&(et.bearing=s.ai(E,j,_t)),Ye&&(et.pitch=s.ai(C,H,_t)),qe&&(je.interpolatePadding(M,Z,_t),Q=je.centerPoint.add(W)),pe)et.setLocationAtPoint(pe,ge);else{const ft=et.zoomScale(et.zoom-w),Mt=N>w?Math.min(2,ue):Math.max(.5,ue),Rt=Math.pow(Mt,1-_t),jt=et.unproject(ce.add(se.mult(_t*Rt)).mult(ft));et.setLocationAtPoint(et.renderWorldCopies?jt.wrap():jt,Q)}return o.preloadOnly||this._fireMoveEvents(f),et};if(o.preloadOnly){const et=this._emulate(Ue,o.duration,y);return this._preloadTiles(et),this}const We={moving:this._moving,zooming:this._zooming,rotating:this._rotating,pitching:this._pitching};return this._zooming=Pe,this._rotating=Ve,this._pitching=Ye,this._padding=qe,this._easeId=o.easeId,this._prepareEase(f,o.noMoveStart,We),this._ease(Ue(y),et=>{y.cameraElevationReference==="sea"&&y.recenterOnTerrain(),this._afterEase(f,et)},o),this}_prepareEase(o,f,y={}){this._moving=!0,this.transform.cameraElevationReference="sea",this.transform._orthographicProjectionAtLowPitch&&this.transform.pitch===0&&this.transform.projection.name!=="globe"&&(this.transform.cameraElevationReference="ground"),f||y.moving||this.fire(new s.A("movestart",o)),this._zooming&&!y.zooming&&this.fire(new s.A("zoomstart",o)),this._rotating&&!y.rotating&&this.fire(new s.A("rotatestart",o)),this._pitching&&!y.pitching&&this.fire(new s.A("pitchstart",o))}_fireMoveEvents(o){this.fire(new s.A("move",o)),this._zooming&&this.fire(new s.A("zoom",o)),this._rotating&&this.fire(new s.A("rotate",o)),this._pitching&&this.fire(new s.A("pitch",o))}_afterEase(o,f){if(this._easeId&&f&&this._easeId===f)return;this._easeId=void 0,this.transform.cameraElevationReference="ground";const y=this._zooming,w=this._rotating,E=this._pitching;this._moving=!1,this._zooming=!1,this._rotating=!1,this._pitching=!1,this._padding=!1,y&&this.fire(new s.A("zoomend",o)),w&&this.fire(new s.A("rotateend",o)),E&&this.fire(new s.A("pitchend",o)),this.fire(new s.A("moveend",o))}flyTo(o,f){if(this._prefersReducedMotion(o)){const Tt=s.aF(o,["center","zoom","bearing","pitch","around","padding","retainPadding"]);return this.jumpTo(Tt,f)}this.stop(),o=s.h({offset:[0,0],speed:1.2,curve:1.42,easing:s.ey},o);const y=this.transform,w=this.getZoom(),E=this.getBearing(),C=this.getPitch(),M=this.getPadding(),N="zoom"in o?s.ay(+o.zoom,y.minZoom,y.maxZoom):w,j="bearing"in o?this._normalizeBearing(o.bearing,E):E,H="pitch"in o?+o.pitch:C,Z=this._extendPadding(o.padding),W=y.zoomScale(N-w),Q=s.P.convert(o.offset);let ce=y.centerPoint.add(Q);const se=y.pointLocation(ce),ue=s.cd.convert(o.center||se);this._normalizeCenter(ue);const pe=y.project(se),ge=y.project(ue).sub(pe);let Pe=o.curve;const Ve=Math.max(y.width,y.height),Ye=Ve/W,qe=ge.mag();if("minZoom"in o){const Tt=s.ay(Math.min(o.minZoom,w,N),y.minZoom,y.maxZoom),Nt=Ve/y.zoomScale(Tt-w);Pe=Math.sqrt(Nt/qe*2)}const je=Pe*Pe;function Ue(Tt){const Nt=(Ye*Ye-Ve*Ve+(Tt?-1:1)*je*je*qe*qe)/(2*(Tt?Ye:Ve)*je*qe);return Math.log(Math.sqrt(Nt*Nt+1)-Nt)}function We(Tt){return(Math.exp(Tt)-Math.exp(-Tt))/2}function et(Tt){return(Math.exp(Tt)+Math.exp(-Tt))/2}const _t=Ue(0);let ft=function(Tt){return et(_t)/et(_t+Pe*Tt)},Mt=function(Tt){return Ve*((et(_t)*(We(Nt=_t+Pe*Tt)/et(Nt))-We(_t))/je)/qe;var Nt},Rt=(Ue(1)-_t)/Pe;if(Math.abs(qe)<1e-6||!isFinite(Rt)){if(Math.abs(Ve-Ye)<1e-6)return this.easeTo(o,f);const Tt=Ye<Ve?-1:1;Rt=Math.abs(Math.log(Ye/Ve))/Pe,Mt=function(){return 0},ft=function(Nt){return Math.exp(Tt*Pe*Nt)}}o.duration="duration"in o?+o.duration:1e3*Rt/("screenSpeed"in o?+o.screenSpeed/Pe:+o.speed),o.maxDuration&&o.duration>o.maxDuration&&(o.duration=0);const jt=E!==j,ht=H!==C,Dt=!y.isPaddingEqual(Z),ot=o.retainPadding===!1?y.clone():y,At=Tt=>Nt=>{const Yt=Nt*Rt,Pt=1/ft(Yt);Tt.zoom=Nt===1?N:w+Tt.scaleZoom(Pt),jt&&(Tt.bearing=s.ai(E,j,Nt)),ht&&(Tt.pitch=s.ai(C,H,Nt)),Dt&&(ot.interpolatePadding(M,Z,Nt),ce=ot.centerPoint.add(Q));const qt=Nt===1?ue:Tt.unproject(pe.add(ge.mult(Mt(Yt))).mult(Pt));return Tt.setLocationAtPoint(Tt.renderWorldCopies?qt.wrap():qt,ce),Tt._updateCameraOnTerrain(),o.preloadOnly||this._fireMoveEvents(f),Tt};if(o.preloadOnly){const Tt=this._emulate(At,o.duration,y);return this._preloadTiles(Tt),this}return this._zooming=!0,this._rotating=jt,this._pitching=ht,this._padding=Dt,this._prepareEase(f,!1),this._ease(At(y),()=>this._afterEase(f),o),this}isEasing(){return!!this._easeFrameId}stop(){return this._stop()}_requestRenderFrame(o){}_cancelRenderFrame(o){}_stop(o,f){if(this._easeFrameId&&(this._cancelRenderFrame(this._easeFrameId),this._easeFrameId=void 0,this._onEaseFrame=void 0),this._onEaseEnd){const y=this._onEaseEnd;this._onEaseEnd=void 0,y.call(this,f)}if(!o){const y=this.handlers;y&&y.stop(!1)}return this}_ease(o,f,y){y.animate===!1||y.duration===0?(o(1),f()):(this._easeStart=s.q.now(),this._easeOptions=y,this._onEaseFrame=o,this._onEaseEnd=f,this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback))}_renderFrameCallback(){const o=Math.min((s.q.now()-this._easeStart)/this._easeOptions.duration,1),f=this._onEaseFrame;f&&f(this._easeOptions.easing(o)),o<1?this._easeFrameId=this._requestRenderFrame(this._renderFrameCallback):this.stop()}_normalizeBearing(o,f){o=s.bX(o,-180,180);const y=Math.abs(o-f);return Math.abs(o-360-f)<y&&(o-=360),Math.abs(o+360-f)<y&&(o+=360),o}_normalizeCenter(o){const f=this.transform;if(f.maxBounds||f.projection.name!=="globe"&&!f.renderWorldCopies)return;const y=o.lng-f.center.lng;o.lng+=y>180?-360:y<-180?360:0}_prefersReducedMotion(o){return this._respectPrefersReducedMotion&&s.q.prefersReducedMotion&&!(o&&o.essential)}_emulate(o,f,y){const w=Math.ceil(15*f/1e3),E=[],C=o(y.clone());for(let M=0;M<=w;M++){const N=C(M/w);E.push(N.clone())}return E}_preloadTiles(o,f){}}class yd{constructor(o={}){this.options=o,s.aV(["_toggleAttribution","_updateEditLink","_updateData","_updateCompact"],this)}getDefaultPosition(){return"bottom-right"}onAdd(o){const f=this.options&&this.options.compact,y=o._getUIString("AttributionControl.ToggleAttribution");this._map=o,this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-attrib"),this._compactButton=X("button","mapboxgl-ctrl-attrib-button",this._container),this._compactButton.type="button",this._compactButton.addEventListener("click",this._toggleAttribution),this._compactButton.setAttribute("aria-label",y);const w=X("span","mapboxgl-ctrl-icon",this._compactButton);return w.setAttribute("aria-hidden","true"),w.setAttribute("title",y),this._innerContainer=X("div","mapboxgl-ctrl-attrib-inner",this._container),f&&this._container.classList.add("mapboxgl-compact"),this._updateAttributions(),this._updateEditLink(),this._map.on("styledata",this._updateData),this._map.on("sourcedata",this._updateData),this._map.on("moveend",this._updateEditLink),f===void 0&&(this._map.on("resize",this._updateCompact),this._updateCompact()),this._container}onRemove(){this._container.remove(),this._map.off("styledata",this._updateData),this._map.off("sourcedata",this._updateData),this._map.off("moveend",this._updateEditLink),this._map.off("resize",this._updateCompact),this._map=void 0,this._attribHTML=void 0}_toggleAttribution(){this._container.classList.contains("mapboxgl-compact-show")?(this._container.classList.remove("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","false")):(this._container.classList.add("mapboxgl-compact-show"),this._compactButton.setAttribute("aria-expanded","true"))}_updateEditLink(){let o=this._editLink;o||(o=this._editLink=this._container.querySelector(".mapbox-improve-map"));const f=[{key:"owner",value:this.styleOwner},{key:"id",value:this.styleId},{key:"access_token",value:this._map._requestManager._customAccessToken||s.e.ACCESS_TOKEN}];if(o){const y=f.reduce((w,E,C)=>(E.value&&(w+=`${E.key}=${E.value}${C<f.length-1?"&":""}`),w),"?");o.href=`${s.e.FEEDBACK_URL}/${y}#${wg(this._map,!0)}`,o.rel="noopener nofollow"}}_updateData(o){!o||o.sourceDataType!=="metadata"&&o.sourceDataType!=="visibility"&&o.dataType!=="style"||(this._updateAttributions(),this._updateEditLink())}_updateAttributions(){if(!this._map.style)return;let o=[];if(this._map.style.stylesheet){const w=this._map.style.stylesheet;this.styleOwner=w.owner,this.styleId=w.id}const f=this._map.style._mergedSourceCaches;for(const w in f){const E=f[w];if(E.used){const C=E.getSource();C.attribution&&o.indexOf(C.attribution)<0&&o.push(C.attribution)}}o.sort((w,E)=>w.length-E.length),o=o.filter((w,E)=>{for(let C=E+1;C<o.length;C++)if(o[C].indexOf(w)>=0)return!1;return!0}),this.options.customAttribution&&(Array.isArray(this.options.customAttribution)?o=[...this.options.customAttribution,...o]:o.unshift(this.options.customAttribution));const y=o.join(" | ");y!==this._attribHTML&&(this._attribHTML=y,o.length?(this._innerContainer.innerHTML=y,this._container.classList.remove("mapboxgl-attrib-empty")):this._container.classList.add("mapboxgl-attrib-empty"),this._editLink=null)}_updateCompact(){this._map.getCanvasContainer().offsetWidth<=640?this._container.classList.add("mapboxgl-compact"):this._container.classList.remove("mapboxgl-compact","mapboxgl-compact-show")}}class Lf{constructor(){s.aV(["_updateLogo","_updateCompact"],this)}onAdd(o){this._map=o,this._container=X("div","mapboxgl-ctrl");const f=X("a","mapboxgl-ctrl-logo");return f.target="_blank",f.rel="noopener nofollow",f.href="https://www.mapbox.com/",f.setAttribute("aria-label",this._map._getUIString("LogoControl.Title")),f.setAttribute("rel","noopener nofollow"),this._container.appendChild(f),this._container.style.display="none",this._map.on("sourcedata",this._updateLogo),this._updateLogo(),this._map.on("resize",this._updateCompact),this._updateCompact(),this._container}onRemove(){this._container.remove(),this._map.off("sourcedata",this._updateLogo),this._map.off("resize",this._updateCompact)}getDefaultPosition(){return"bottom-left"}_updateLogo(o){o&&o.sourceDataType!=="metadata"||(this._container.style.display=this._logoRequired()?"block":"none")}_logoRequired(){if(!this._map.style)return!0;const o=this._map.style._sourceCaches;if(Object.entries(o).length===0)return!0;for(const f in o){const y=o[f].getSource();if(y.hasOwnProperty("mapbox_logo")&&!y.mapbox_logo)return!1}return!0}_updateCompact(){const o=this._container.children;if(o.length){const f=o[0];this._map.getCanvasContainer().offsetWidth<250?f.classList.add("mapboxgl-compact"):f.classList.remove("mapboxgl-compact")}}}class $p{constructor(){this._queue=[],this._id=0,this._cleared=!1,this._currentlyRunning=!1}add(o){const f=++this._id;return this._queue.push({callback:o,id:f,cancelled:!1}),f}remove(o){const f=this._currentlyRunning,y=f?this._queue.concat(f):this._queue;for(const w of y)if(w.id===o)return void(w.cancelled=!0)}run(o=0){const f=this._currentlyRunning=this._queue;this._queue=[];for(const y of f)if(!y.cancelled&&(y.callback(o),this._cleared))break;this._cleared=!1,this._currentlyRunning=!1}clear(){this._currentlyRunning&&(this._cleared=!0),this._queue=[]}}class au{constructor(o){this.jumpTo(o)}getValue(o){if(o<=this._startTime)return this._start;if(o>=this._endTime)return this._end;const f=s.dk((o-this._startTime)/(this._endTime-this._startTime));return this._start*(1-f)+this._end*f}isEasing(o){return o>=this._startTime&&o<=this._endTime}jumpTo(o){this._startTime=-1/0,this._endTime=-1/0,this._start=o,this._end=o}easeTo(o,f,y){this._start=this.getValue(f),this._end=o,this._startTime=f,this._endTime=f+y}}const Ag={"AttributionControl.ToggleAttribution":"Toggle attribution","FullscreenControl.Enter":"Enter fullscreen","FullscreenControl.Exit":"Exit fullscreen","GeolocateControl.FindMyLocation":"Find my location","GeolocateControl.LocationNotAvailable":"Location not available","LogoControl.Title":"Mapbox homepage","Map.Title":"Map","NavigationControl.ResetBearing":"Reset bearing to north","NavigationControl.ZoomIn":"Zoom in","NavigationControl.ZoomOut":"Zoom out","ScrollZoomBlocker.CtrlMessage":"Use ctrl + scroll to zoom the map","ScrollZoomBlocker.CmdMessage":"Use ⌘ + scroll to zoom the map","TouchPanBlocker.Message":"Use two fingers to move the map"};class bs extends s.A{constructor(o,f,y,w){const{point:E,lngLat:C,originalEvent:M,target:N}=o;super(o.type,{point:E,lngLat:C,originalEvent:M,target:N}),this.preventDefault=()=>{o.preventDefault()},this.id=f,this.interaction=y,this.feature=w}}class lu{constructor(o){this.map=o,this.interactionsByType=new Map,this.delegatedInteractions=new Map,this.typeById=new Map,this.filters=new Map,this.handleType=this.handleType.bind(this),this.handleMove=this.handleMove.bind(this),this.handleOut=this.handleOut.bind(this),this.hoveredFeatures=new Map,this.prevHoveredFeatures=new Map}add(o,f){if(this.typeById.has(o))throw new Error(`Interaction id "${o}" already exists.`);const y=f.filter;let w=f.type;y&&this.filters.set(o,s.b3(y)),w==="mouseover"&&(w="mouseenter"),w==="mouseout"&&(w="mouseleave");const E=this.interactionsByType.get(w)||new Map;w==="mouseenter"||w==="mouseleave"?(this.delegatedInteractions.size===0&&(this.map.on("mousemove",this.handleMove),this.map.on("mouseout",this.handleOut)),this.delegatedInteractions.set(o,f)):E.size===0&&this.map.on(w,this.handleType),E.size===0&&this.interactionsByType.set(w,E),E.set(o,f),this.typeById.set(o,w)}get(o){const f=this.typeById.get(o);if(!f)return;const y=this.interactionsByType.get(f);return y?y.get(o):void 0}remove(o){const f=this.typeById.get(o);if(!f)return;this.typeById.delete(o),this.filters.delete(o);const y=this.interactionsByType.get(f);y&&(y.delete(o),f==="mouseenter"||f==="mouseleave"?(this.delegatedInteractions.delete(o),this.delegatedInteractions.size===0&&(this.map.off("mousemove",this.handleMove),this.map.off("mouseout",this.handleOut))):y.size===0&&this.map.off(f,this.handleType))}queryTargets(o,f){const y=[];for(const[w,E]of f)E.target&&y.push({targetId:w,target:E.target,filter:this.filters.get(w)});return this.map.style.queryRenderedTargets(o,y,this.map.transform)}handleMove(o){this.prevHoveredFeatures=this.hoveredFeatures,this.hoveredFeatures=new Map;const f=this.queryTargets(o.point,Array.from(this.delegatedInteractions).reverse());f.length&&(o.type="mouseenter",this.handleType(o,f));const y=new Map;for(const[w,{feature:E}]of this.prevHoveredFeatures)this.hoveredFeatures.has(w)||y.set(E.id,E);y.size&&(o.type="mouseleave",this.handleType(o,Array.from(y.values())))}handleOut(o){const f=Array.from(this.hoveredFeatures.values()).map(({feature:y})=>y);f.length&&(o.type="mouseleave",this.handleType(o,f)),this.hoveredFeatures.clear()}handleType(o,f){const y=o.type==="mouseenter";if(y&&!this.interactionsByType.has(o.type))return void s.w("mouseenter interaction required for mouseleave to work.");const w=Array.from(this.interactionsByType.get(o.type)).reverse(),E=!!f;f=f||this.queryTargets(o.point,w);let C=!1;const M=new Set;for(const N of f){for(const[j,H]of w){if(!H.target)continue;const Z=N.variants?N.variants[j]:null;if(Z){for(const W of Z){if(Jl(W,N,M,j))continue;const Q=new s.de(N,W),ce=Hc(W,N,j);E&&(Q.state=this.map.getFeatureState(Q));const se=y?this.prevHoveredFeatures.get(ce):null,ue=new bs(o,j,H,Q),pe=se?se.stop:H.handler(ue);if(y&&this.hoveredFeatures.set(ce,{feature:N,stop:pe}),pe!==!1){C=!0;break}}if(C)break}}if(C)break}if(!C)for(const[N,j]of w){const{handler:H,target:Z}=j;if(!Z&&H(new bs(o,N,j,null))!==!1)break}}}function Cg(_,o){if(Array.isArray(_)&&Array.isArray(o)){const f=new Set(_),y=new Set(o);return f.size===y.size&&_.every(w=>y.has(w))}return s.bv(_,o)}const Dg={center:[0,0],zoom:0,bearing:0,pitch:0,minZoom:-2,maxZoom:22,minPitch:0,maxPitch:85,interactive:!0,scrollZoom:!0,boxZoom:!0,dragRotate:!0,dragPan:!0,keyboard:!0,doubleClickZoom:!0,touchZoomRotate:!0,touchPitch:!0,cooperativeGestures:!1,performanceMetricsCollection:!0,bearingSnap:7,clickTolerance:3,pitchWithRotate:!0,hash:!1,attributionControl:!0,antialias:!1,failIfMajorPerformanceCaveat:!1,preserveDrawingBuffer:!1,trackResize:!0,renderWorldCopies:!0,refreshExpiredTiles:!0,minTileCacheSize:null,maxTileCacheSize:null,localIdeographFontFamily:"sans-serif",localFontFamily:null,transformRequest:null,accessToken:null,fadeDuration:300,respectPrefersReducedMotion:!0,crossSourceCollisions:!0,collectResourceTiming:!1,testMode:!1,precompilePrograms:!0,scaleFactor:1,spriteFormat:"auto"},Gp={showCompass:!0,showZoom:!0,visualizePitch:!1};class Qx{constructor(o,f,y=!1){this._clickTolerance=10,this.element=f,this.mouseRotate=new Eg({clickTolerance:o.dragRotate._mouseRotate._clickTolerance}),this.map=o,y&&(this.mousePitch=new _d({clickTolerance:o.dragRotate._mousePitch._clickTolerance})),s.aV(["mousedown","mousemove","mouseup","touchstart","touchmove","touchend","reset"],this),f.addEventListener("mousedown",this.mousedown),f.addEventListener("touchstart",this.touchstart,{passive:!1}),f.addEventListener("touchmove",this.touchmove),f.addEventListener("touchend",this.touchend),f.addEventListener("touchcancel",this.reset)}down(o,f){this.mouseRotate.mousedown(o,f),this.mousePitch&&this.mousePitch.mousedown(o,f),Re()}move(o,f){const y=this.map,w=this.mouseRotate.mousemoveWindow(o,f),E=w&&w.bearingDelta;if(E&&y.setBearing(y.getBearing()+E),this.mousePitch){const C=this.mousePitch.mousemoveWindow(o,f),M=C&&C.pitchDelta;M&&y.setPitch(y.getPitch()+M)}}off(){const o=this.element;o.removeEventListener("mousedown",this.mousedown),o.removeEventListener("touchstart",this.touchstart),o.removeEventListener("touchmove",this.touchmove),o.removeEventListener("touchend",this.touchend),o.removeEventListener("touchcancel",this.reset),this.offTemp()}offTemp(){Ne(),window.removeEventListener("mousemove",this.mousemove),window.removeEventListener("mouseup",this.mouseup)}mousedown(o){this.down(s.h({},o,{ctrlKey:!0,preventDefault:()=>o.preventDefault()}),_e(this.element,o)),window.addEventListener("mousemove",this.mousemove),window.addEventListener("mouseup",this.mouseup)}mousemove(o){this.move(o,_e(this.element,o))}mouseup(o){this.mouseRotate.mouseupWindow(o),this.mousePitch&&this.mousePitch.mouseupWindow(o),this.offTemp()}touchstart(o){o.targetTouches.length!==1?this.reset():(this._startPos=this._lastPos=Te(this.element,o.targetTouches)[0],this.down({type:"mousedown",button:0,ctrlKey:!0,preventDefault:()=>o.preventDefault()},this._startPos))}touchmove(o){o.targetTouches.length!==1?this.reset():(this._lastPos=Te(this.element,o.targetTouches)[0],this.move({preventDefault:()=>o.preventDefault()},this._lastPos))}touchend(o){o.targetTouches.length===0&&this._startPos&&this._lastPos&&this._startPos.dist(this._lastPos)<this._clickTolerance&&this.element.click(),this.reset()}reset(){this.mouseRotate.reset(),this.mousePitch&&this.mousePitch.reset(),delete this._startPos,delete this._lastPos,this.offTemp()}}function zf(_,o,f){if(_=new s.cd(_.lng,_.lat),o){const y=new s.cd(_.lng-360,_.lat),w=new s.cd(_.lng+360,_.lat),E=360*Math.ceil(Math.abs(_.lng-f.center.lng)/360),C=f.locationPoint3D(_).distSqr(o),M=o.x<0||o.y<0||o.x>f.width||o.y>f.height;f.locationPoint3D(y).distSqr(o)<C&&(M||Math.abs(y.lng-f.center.lng)<E)?_=y:f.locationPoint3D(w).distSqr(o)<C&&(M||Math.abs(w.lng-f.center.lng)<E)&&(_=w)}for(;Math.abs(_.lng-f.center.lng)>180;){const y=f.locationPoint3D(_);if(y.x>=0&&y.y>=0&&y.x<=f.width&&y.y<=f.height)break;_.lng>f.center.lng?_.lng-=360:_.lng+=360}return _}const ls={center:"translate(-50%,-50%)",top:"translate(-50%,0)","top-left":"translate(0,0)","top-right":"translate(-100%,0)",bottom:"translate(-50%,-100%)","bottom-left":"translate(0,-100%)","bottom-right":"translate(-100%,-100%)",left:"translate(0,-50%)",right:"translate(-100%,-50%)"},hc={rotation:0,rotationAlignment:"auto",pitchAlignment:"auto",occludedOpacity:.2,altitude:0};class Rg extends s.E{constructor(o,f){super(),(o instanceof HTMLElement||f)&&(o=s.h({element:o},f)),s.aV(["_update","_onMove","_onUp","_addDragHandler","_onMapClick","_onKeyPress","_clearFadeTimer"],this);const{anchor:y="center",color:w="#3FB1CE",scale:E=1,draggable:C=!1,clickTolerance:M=0,rotation:N=hc.rotation,rotationAlignment:j=hc.rotationAlignment,pitchAlignment:H=hc.pitchAlignment,occludedOpacity:Z=hc.occludedOpacity,altitude:W=hc.altitude}=o||{};this._anchor=y,this._color=w,this._scale=E,this._draggable=C,this._clickTolerance=M,this._rotation=N,this._rotationAlignment=j,this._pitchAlignment=H,this._occludedOpacity=Z,this._altitude=W,this._state="inactive",this._isDragging=!1,this._updateMoving=()=>this._update(!0),o&&o.element?(this._element=o.element,this._offset=s.P.convert(o&&o.offset||[0,0])):(this._defaultMarker=!0,this._element=this._createDefaultMarker(),this._offset=s.P.convert(o&&o.offset||[0,-14])),this._element.hasAttribute("aria-label")||this._element.setAttribute("aria-label","Map marker"),this._element.hasAttribute("role")||this._element.setAttribute("role","img"),this._element.classList.add("mapboxgl-marker"),this._element.addEventListener("dragstart",se=>{se.preventDefault()}),this._element.addEventListener("mousedown",se=>{se.preventDefault()});const Q=this._element.classList;for(const se in ls)Q.remove(`mapboxgl-marker-anchor-${se}`);Q.add(`mapboxgl-marker-anchor-${this._anchor}`);const ce=o&&o.className?o.className.trim().split(/\s+/):[];Q.add(...ce),this._popup=null}_createDefaultMarker(){const o=X("div"),f=te("svg",{display:"block",height:41*this._scale+"px",width:27*this._scale+"px",viewBox:"0 0 27 41"},o);if(this._altitude===0){const y=te("radialGradient",{id:"shadowGradient"},te("defs",{},f));te("stop",{offset:"10%","stop-opacity":.4},y),te("stop",{offset:"100%","stop-opacity":.05},y),te("ellipse",{cx:13.5,cy:34.8,rx:10.5,ry:5.25,fill:"url(#shadowGradient)"},f)}return te("path",{fill:this._color,d:"M27,13.5C27,19.07 20.25,27 14.75,34.5C14.02,35.5 12.98,35.5 12.25,34.5C6.75,27 0,19.22 0,13.5C0,6.04 6.04,0 13.5,0C20.96,0 27,6.04 27,13.5Z"},f),te("path",{opacity:.25,d:"M13.5,0C6.04,0 0,6.04 0,13.5C0,19.22 6.75,27 12.25,34.5C13,35.52 14.02,35.5 14.75,34.5C20.25,27 27,19.07 27,13.5C27,6.04 20.96,0 13.5,0ZM13.5,1C20.42,1 26,6.58 26,13.5C26,15.9 24.5,19.18 22.22,22.74C19.95,26.3 16.71,30.14 13.94,33.91C13.74,34.18 13.61,34.32 13.5,34.44C13.39,34.32 13.26,34.18 13.06,33.91C10.28,30.13 7.41,26.31 5.02,22.77C2.62,19.23 1,15.95 1,13.5C1,6.58 6.58,1 13.5,1Z"},f),te("circle",{fill:"white",cx:13.5,cy:13.5,r:5.5},f),o}addTo(o){return o===this._map||(this.remove(),this._map=o,o.getCanvasContainer().appendChild(this._element),o.on("move",this._updateMoving),o.on("moveend",this._update),o.on("remove",this._clearFadeTimer),o._addMarker(this),this.setDraggable(this._draggable),this._update(),o.on("click",this._onMapClick)),this}remove(){const o=this._map;return o&&(o.off("click",this._onMapClick),o.off("move",this._updateMoving),o.off("moveend",this._update),o.off("mousedown",this._addDragHandler),o.off("touchstart",this._addDragHandler),o.off("mouseup",this._onUp),o.off("touchend",this._onUp),o.off("mousemove",this._onMove),o.off("touchmove",this._onMove),o.off("remove",this._clearFadeTimer),o._removeMarker(this),this._map=void 0),this._clearFadeTimer(),this._element.remove(),this._popup&&this._popup.remove(),this}getLngLat(){return this._lngLat}setLngLat(o){return this._lngLat=s.cd.convert(o),this._pos=null,this._popup&&this._popup.setLngLat(this._lngLat),this._update(!0),this}setAltitude(o){return o===this._altitude||(this._defaultMarker&&(this._altitude===0&&o!==0||this._altitude!==0&&o===0)&&(this._element=this._createDefaultMarker()),this._altitude=o||hc.altitude,this._update()),this}getAltitude(){return this._altitude}getElement(){return this._element}setPopup(o){if(this._popup&&(this._popup.remove(),this._popup=null,this._element.removeAttribute("role"),this._element.removeEventListener("keypress",this._onKeyPress),this._originalTabIndex||this._element.removeAttribute("tabindex")),o){if(!("offset"in o.options)){const w=Math.sqrt(Math.pow(13.5,2)/2);o.options.offset=this._defaultMarker?{top:[0,0],"top-left":[0,0],"top-right":[0,0],bottom:[0,-38.1],"bottom-left":[w,-1*(38.1-13.5+w)],"bottom-right":[-w,-1*(38.1-13.5+w)],left:[13.5,-1*(38.1-13.5)],right:[-13.5,-1*(38.1-13.5)]}:this._offset}this._popup=o,o._marker=this,o._altitude=this._altitude,this._lngLat&&this._popup.setLngLat(this._lngLat),this._element.setAttribute("role","button"),this._originalTabIndex=this._element.getAttribute("tabindex"),this._originalTabIndex||this._element.setAttribute("tabindex","0"),this._element.addEventListener("keypress",this._onKeyPress),this._element.setAttribute("aria-expanded","false")}return this}_onKeyPress(o){const f=o.code,y=o.charCode||o.keyCode;f!=="Space"&&f!=="Enter"&&y!==32&&y!==13||this.togglePopup()}_onMapClick(o){const f=o.originalEvent.target,y=this._element;this._popup&&(f===y||y.contains(f))&&this.togglePopup()}getPopup(){return this._popup}togglePopup(){const o=this._popup;return o?(o.isOpen()?(o.remove(),this._element.setAttribute("aria-expanded","false")):this._map&&(o.addTo(this._map),this._element.setAttribute("aria-expanded","true")),this):this}_behindTerrain(){const o=this._map,f=this._pos;if(!o||!f)return!1;const y=o.unproject(f,this._altitude),w=o.getFreeCameraOptions();if(!w.position)return!1;const E=w.position.toLngLat();return E.distanceTo(y)<.9*E.distanceTo(this._lngLat)}_evaluateOpacity(){const o=this._map;if(!o)return;const f=this._pos;if(!f||f.x<0||f.x>o.transform.width||f.y<0||f.y>o.transform.height)return void this._clearFadeTimer();const y=o.unproject(f,this._altitude);let w;o._showingGlobe()&&s.eK(o.transform,this._lngLat)?w=0:(w=1-o._queryFogOpacity(y),o.transform._terrainEnabled()&&o.getTerrain()&&this._behindTerrain()&&(w*=this._occludedOpacity)),this._element.style.opacity=`${w}`,this._element.style.pointerEvents=w>0?"auto":"none",this._popup&&this._popup._setOpacity(w),this._fadeTimer=null}_clearFadeTimer(){this._fadeTimer&&(clearTimeout(this._fadeTimer),this._fadeTimer=null)}_updateDOM(){const o=this._pos;if(!o||!this._map)return;const f=this._offset.mult(this._scale);this._element.style.transform=`
            translate(${o.x}px,${o.y}px)
            ${ls[this._anchor]}
            ${this._calculateXYTransform()} ${this._calculateZTransform()}
            translate(${f.x}px,${f.y}px)
        `}_calculateXYTransform(){const o=this._pos,f=this._map,y=this.getPitchAlignment();if(!f||!o||y!=="map")return"";if(!f._showingGlobe()){const N=f.getPitch();return N?`rotateX(${N}deg)`:""}const w=s.cJ(s.eL(f.transform,this._lngLat)),E=o.sub(s.eM(f.transform)),C=Math.abs(E.x)+Math.abs(E.y);if(C===0)return"";const M=w/C;return`rotateX(${-E.y*M}deg) rotateY(${E.x*M}deg)`}_calculateZTransform(){const o=this._pos,f=this._map;if(!f||!o)return"";let y=0;const w=this.getRotationAlignment();if(w==="map")if(f._showingGlobe()){const E=f.project(new s.cd(this._lngLat.lng,this._lngLat.lat+.001),this._altitude),C=f.project(new s.cd(this._lngLat.lng,this._lngLat.lat-.001),this._altitude).sub(E);y=s.cJ(Math.atan2(C.y,C.x))-90}else y=-f.getBearing();else if(w==="horizon"){const E=s.af(4,6,f.getZoom()),C=s.eM(f.transform);C.y+=E*f.transform.height;const M=o.sub(C),N=s.cJ(Math.atan2(M.y,M.x));y=(N>90?N-270:N+90)*(1-E)}return y+=this._rotation,y?`rotateZ(${y}deg)`:""}_update(o){cancelAnimationFrame(this._updateFrameId);const f=this._map;f&&(f.transform.renderWorldCopies&&(this._lngLat=zf(this._lngLat,this._pos,f.transform)),this._pos=f.project(this._lngLat,this._altitude),o===!0?this._updateFrameId=requestAnimationFrame(()=>{this._element&&this._pos&&this._anchor&&(this._pos=this._pos.round(),this._updateDOM())}):this._pos=this._pos.round(),f._requestDomTask(()=>{this._map&&(this._element&&this._pos&&this._anchor&&this._updateDOM(),(f._showingGlobe()||f.getTerrain()||f.getFog())&&!this._fadeTimer&&(this._fadeTimer=window.setTimeout(this._evaluateOpacity.bind(this),60)))}))}getOffset(){return this._offset}setOffset(o){return this._offset=s.P.convert(o),this._update(),this}addClassName(o){return this._element.classList.add(o),this}removeClassName(o){return this._element.classList.remove(o),this}toggleClassName(o){return this._element.classList.toggle(o)}_onMove(o){const f=this._map;if(!f)return;const y=this._pointerdownPos,w=this._positionDelta;if(y&&w){if(!this._isDragging){const E=this._clickTolerance||f._clickTolerance;if(o.point.dist(y)<E)return;this._isDragging=!0}this._pos=o.point.sub(w),this._lngLat=f.unproject(this._pos,this._altitude),this.setLngLat(this._lngLat),this._element.style.pointerEvents="none",this._state==="pending"&&(this._state="active",this.fire(new s.A("dragstart"))),this.fire(new s.A("drag"))}}_onUp(){this._element.style.pointerEvents="auto",this._positionDelta=null,this._pointerdownPos=null,this._isDragging=!1;const o=this._map;o&&(o.off("mousemove",this._onMove),o.off("touchmove",this._onMove)),this._state==="active"&&this.fire(new s.A("dragend")),this._state="inactive"}_addDragHandler(o){const f=this._map,y=this._pos;f&&y&&this._element.contains(o.originalEvent.target)&&(o.preventDefault(),this._positionDelta=o.point.sub(y),this._pointerdownPos=o.point,this._state="pending",f.on("mousemove",this._onMove),f.on("touchmove",this._onMove),f.once("mouseup",this._onUp),f.once("touchend",this._onUp))}setDraggable(o){this._draggable=!!o;const f=this._map;return f&&(o?(f.on("mousedown",this._addDragHandler),f.on("touchstart",this._addDragHandler)):(f.off("mousedown",this._addDragHandler),f.off("touchstart",this._addDragHandler))),this}isDraggable(){return this._draggable}setRotation(o){return this._rotation=o||hc.rotation,this._update(),this}getRotation(){return this._rotation}setRotationAlignment(o){return this._rotationAlignment=o||hc.rotationAlignment,this._update(),this}getRotationAlignment(){return this._rotationAlignment==="auto"||this._rotationAlignment==="horizon"&&this._map&&!this._map._showingGlobe()?"viewport":this._rotationAlignment}setPitchAlignment(o){return this._pitchAlignment=o||hc.pitchAlignment,this._update(),this}getPitchAlignment(){return this._pitchAlignment==="auto"?this.getRotationAlignment():this._pitchAlignment}setOccludedOpacity(o){return this._occludedOpacity=o||hc.occludedOpacity,this._update(),this}getOccludedOpacity(){return this._occludedOpacity}}const Sy={positionOptions:{enableHighAccuracy:!1,maximumAge:0,timeout:6e3},fitBoundsOptions:{maxZoom:15},trackUserLocation:!1,showAccuracyCircle:!0,showUserLocation:!0,showUserHeading:!1},Og={maxWidth:100,unit:"metric"},qp={kilometer:"km",meter:"m",mile:"mi",foot:"ft","nautical-mile":"nm"},cu={closeButton:!0,closeOnClick:!0,focusAfterOpen:!0,className:"",maxWidth:"240px",altitude:0},dc=["a[href]","[tabindex]:not([tabindex='-1'])","[contenteditable]:not([contenteditable='false'])","button:not([disabled])","input:not([disabled])","select:not([disabled])","textarea:not([disabled])"].join(", ");function Bl(_=new s.P(0,0),o="bottom"){if(typeof _=="number"){const f=Math.round(Math.sqrt(.5*Math.pow(_,2)));switch(o){case"top":return new s.P(0,_);case"top-left":return new s.P(f,f);case"top-right":return new s.P(-f,f);case"bottom":return new s.P(0,-_);case"bottom-left":return new s.P(f,-f);case"bottom-right":return new s.P(-f,-f);case"left":return new s.P(_,0);case"right":return new s.P(-_,0)}return new s.P(0,0)}return _ instanceof s.P||Array.isArray(_)?s.P.convert(_):s.P.convert(_[o]||[0,0])}return{version:T,supported:J.supported,setRTLTextPlugin:s.eQ,getRTLTextPluginStatus:s.eP,Map:class extends Sg{constructor(_){P.mark(D.create);const o=_;if((_=s.h({},Dg,_)).minZoom!=null&&_.maxZoom!=null&&_.minZoom>_.maxZoom)throw new Error("maxZoom must be greater than or equal to minZoom");if(_.minPitch!=null&&_.maxPitch!=null&&_.minPitch>_.maxPitch)throw new Error("maxPitch must be greater than or equal to minPitch");if(_.minPitch!=null&&_.minPitch<0)throw new Error("minPitch must be greater than or equal to 0");if(_.maxPitch!=null&&_.maxPitch>85)throw new Error("maxPitch must be less than or equal to 85");if(_.antialias&&s.eI(window)&&(_.antialias=!1,s.w("Antialiasing is disabled for this WebGL context to avoid browser bug: https://github.com/mapbox/mapbox-gl-js/issues/11609")),super(new Ap(_.minZoom,_.maxZoom,_.minPitch,_.maxPitch,_.renderWorldCopies,null,null),_),this._repaint=!!_.repaint,this._interactive=_.interactive,this._minTileCacheSize=_.minTileCacheSize,this._maxTileCacheSize=_.maxTileCacheSize,this._failIfMajorPerformanceCaveat=_.failIfMajorPerformanceCaveat,this._preserveDrawingBuffer=_.preserveDrawingBuffer,this._antialias=_.antialias,this._trackResize=_.trackResize,this._bearingSnap=_.bearingSnap,this._refreshExpiredTiles=_.refreshExpiredTiles,this._fadeDuration=_.fadeDuration,this._isInitialLoad=!0,this._crossSourceCollisions=_.crossSourceCollisions,this._collectResourceTiming=_.collectResourceTiming,this._language=this._parseLanguage(_.language),this._worldview=_.worldview,this._renderTaskQueue=new $p,this._domRenderTaskQueue=new $p,this._controls=[],this._markers=[],this._popups=[],this._mapId=s.a$(),this._locale=s.h({},Ag,_.locale),this._clickTolerance=_.clickTolerance,this._cooperativeGestures=_.cooperativeGestures,this._performanceMetricsCollection=_.performanceMetricsCollection,this._tessellationStep=_.tessellationStep,this._containerWidth=0,this._containerHeight=0,this._showParseStatus=!0,this._precompilePrograms=_.precompilePrograms,this._scaleFactorChanged=!1,this._averageElevationLastSampledAt=-1/0,this._averageElevationExaggeration=0,this._averageElevation=new au(0),this._interactionRange=[1/0,-1/0],this._visibilityHidden=0,this._useExplicitProjection=!1,this._frameId=0,this._scaleFactor=_.scaleFactor,this._requestManager=new zt(_.transformRequest,_.accessToken,_.testMode),this._silenceAuthErrors=!!_.testMode,this._contextCreateOptions=_.contextCreateOptions?Object.assign({},_.contextCreateOptions):{},typeof _.container=="string"){const f=document.getElementById(_.container);if(!f)throw new Error(`Container '${_.container.toString()}' not found.`);this._container=f}else{if(!(_.container instanceof HTMLElement))throw new Error("Invalid type: 'container' must be a String or HTMLElement.");this._container=_.container}if(this._container.childNodes.length>0&&s.w("The map container element should be empty, otherwise the map's interactivity will be negatively impacted. If you want to display a message when WebGL is not supported, use the Mapbox GL Supported plugin instead."),_.maxBounds&&this.setMaxBounds(_.maxBounds),this._spriteFormat=_.spriteFormat,s.aV(["_onWindowOnline","_onWindowResize","_onVisibilityChange","_onMapScroll","_contextLost","_contextRestored"],this),this._setupContainer(),this._tp||(this._tp=new gy),this._tp.registerParameter(this,["Debug"],"showOverdrawInspector"),this._tp.registerParameter(this,["Debug"],"showTileBoundaries"),this._tp.registerParameter(this,["Debug"],"showParseStatus"),this._tp.registerParameter(this,["Debug"],"repaint"),this._tp.registerParameter(this,["Debug"],"showTileAABBs"),this._tp.registerParameter(this,["Debug"],"showPadding"),this._tp.registerParameter(this,["Debug"],"showCollisionBoxes",{noSave:!0}),this._tp.registerParameter(this.transform,["Debug"],"freezeTileCoverage",{noSave:!0},()=>{this._update()}),this._tp.registerParameter(this,["Debug","Wireframe"],"showTerrainWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers2DWireframe"),this._tp.registerParameter(this,["Debug","Wireframe"],"showLayers3DWireframe"),this._tp.registerParameter(this,["Scaling"],"_scaleFactor",{min:.1,max:10,step:.1},()=>{this.setScaleFactor(this._scaleFactor)}),this._setupPainter(),this.painter===void 0)throw new Error("Failed to initialize WebGL.");if(this.on("move",()=>this._update(!1)),this.on("moveend",()=>this._update(!1)),this.on("zoom",()=>this._update(!0)),this._fullscreenchangeEvent="onfullscreenchange"in document?"fullscreenchange":"webkitfullscreenchange",window.addEventListener("online",this._onWindowOnline,!1),window.addEventListener("resize",this._onWindowResize,!1),window.addEventListener("orientationchange",this._onWindowResize,!1),window.addEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.addEventListener("visibilitychange",this._onVisibilityChange,!1),this.handlers=new Ey(this,_),this._localFontFamily=_.localFontFamily,this._localIdeographFontFamily=_.localIdeographFontFamily,(_.style||!_.testMode)&&this.setStyle(_.style||s.e.DEFAULT_STYLE,{config:_.config,localFontFamily:this._localFontFamily,localIdeographFontFamily:this._localIdeographFontFamily}),_.projection&&this.setProjection(_.projection),this.indoor=new uh(this),_.hash&&(this._hash=new _y(typeof _.hash=="string"&&_.hash||void 0).addTo(this)),!this._hash||!this._hash._onHashChange()){o.center==null&&o.zoom==null||(this.transform._unmodified=!1),this.jumpTo({center:_.center,zoom:_.zoom,bearing:_.bearing,pitch:_.pitch});const f=_.bounds;f&&(this.resize(),this.fitBounds(f,s.h({},_.fitBoundsOptions,{duration:0})))}this.resize(),_.attributionControl&&this.addControl(new yd({customAttribution:_.customAttribution})),this._logoControl=new Lf,this.addControl(this._logoControl,_.logoPosition),this.on("style.load",()=>{this.transform.unmodified&&this.jumpTo(this.style.stylesheet),this._postStyleLoadEvent()}),this.on("data",f=>{this._update(f.dataType==="style"),this.fire(new s.A(`${f.dataType}data`,f))}),this.on("dataloading",f=>{this.fire(new s.A(`${f.dataType}dataloading`,f))}),this._interactions=new lu(this)}_getMapId(){return this._mapId}addControl(_,o){if(o===void 0&&(o=_.getDefaultPosition?_.getDefaultPosition():"top-right"),!_||!_.onAdd)return this.fire(new s.z(new Error("Invalid argument to map.addControl(). Argument must be a control with onAdd and onRemove methods.")));const f=_.onAdd(this);this._controls.push(_);const y=this._controlPositions[o];return o.indexOf("bottom")!==-1?y.insertBefore(f,y.firstChild):y.appendChild(f),this}removeControl(_){if(!_||!_.onRemove)return this.fire(new s.z(new Error("Invalid argument to map.removeControl(). Argument must be a control with onAdd and onRemove methods.")));const o=this._controls.indexOf(_);return o>-1&&this._controls.splice(o,1),_.onRemove(this),this}hasControl(_){return this._controls.indexOf(_)>-1}getContainer(){return this._container}getCanvasContainer(){return this._canvasContainer}getCanvas(){return this._canvas}resize(_){if(this._updateContainerDimensions(),this._containerWidth===this.transform.width&&this._containerHeight===this.transform.height)return this;this._resizeCanvas(this._containerWidth,this._containerHeight),this.transform.resize(this._containerWidth,this._containerHeight),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight));const o=!this._moving;return o&&this.fire(new s.A("movestart",_)).fire(new s.A("move",_)),this.fire(new s.A("resize",_)),o&&this.fire(new s.A("moveend",_)),this}getBounds(){return this.transform.getBounds()}getMaxBounds(){return this.transform.getMaxBounds()||null}setMaxBounds(_){return this.transform.setMaxBounds(s.aG.convert(_)),this._update()}setMinZoom(_){if((_=_??-2)>=-2&&_<=this.transform.maxZoom)return this.transform.minZoom=_,this._update(),this.getZoom()<_?this.setZoom(_):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("minZoom must be between -2 and the current maxZoom, inclusive")}getMinZoom(){return this.transform.minZoom}setMaxZoom(_){if((_=_??22)>=this.transform.minZoom)return this.transform.maxZoom=_,this._update(),this.getZoom()>_?this.setZoom(_):this.fire(new s.A("zoomstart")).fire(new s.A("zoom")).fire(new s.A("zoomend")),this;throw new Error("maxZoom must be greater than the current minZoom")}getMaxZoom(){return this.transform.maxZoom}setMinPitch(_){if((_=_??0)<0)throw new Error("minPitch must be greater than or equal to 0");if(_>=0&&_<=this.transform.maxPitch)return this.transform.minPitch=_,this._update(),this.getPitch()<_?this.setPitch(_):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("minPitch must be between 0 and the current maxPitch, inclusive")}getMinPitch(){return this.transform.minPitch}setMaxPitch(_){if((_=_??85)>85)throw new Error("maxPitch must be less than or equal to 85");if(_>=this.transform.minPitch)return this.transform.maxPitch=_,this._update(),this.getPitch()>_?this.setPitch(_):this.fire(new s.A("pitchstart")).fire(new s.A("pitch")).fire(new s.A("pitchend")),this;throw new Error("maxPitch must be greater than or equal to minPitch")}getMaxPitch(){return this.transform.maxPitch}getScaleFactor(){return this._scaleFactor}setScaleFactor(_){return this._scaleFactor=_,this.painter.scaleFactor=_,this._tp.refreshUI(),this._scaleFactorChanged=!0,this.style._updateFilteredLayers(o=>o.type==="symbol"),this._update(!0),this}getRenderWorldCopies(){return this.transform.renderWorldCopies}setRenderWorldCopies(_){return this.transform.renderWorldCopies=_,this.transform.renderWorldCopies||this._forceMarkerAndPopupUpdate(!0),this._update()}getLanguage(){return this._language}_parseLanguage(_){return _==="auto"?navigator.language:Array.isArray(_)?_.length===0?void 0:_.map(o=>o==="auto"?navigator.language:o):_}setLanguage(_){const o=this._parseLanguage(_);if(!this.style||o===this._language)return this;this._language=o,this.style.reloadSources();for(const f of this._controls)f._setLanguage&&f._setLanguage(this._language);return this}getWorldview(){return this._worldview}setWorldview(_){return this.style&&_!==this._worldview?(this._worldview=_,this._styleDirty=!0,this.style.reloadSources(),this):this}getProjection(){return this.transform.mercatorFromTransition?{name:"globe",center:[0,0]}:this.transform.getProjection()}_showingGlobe(){return this.transform.projection.name==="globe"}setProjection(_){return this._lazyInitEmptyStyle(),_?typeof _=="string"&&(_={name:_}):_=null,this._useExplicitProjection=!!_,this._prioritizeAndUpdateProjection(_,this.style.projection)}_updateProjectionTransition(){if(this.getProjection().name!=="globe")return;const _=this.transform,o=_.projection.name;let f;o==="globe"&&_.zoom>=s.cx?(_.setMercatorFromTransition(),f=!0):o==="mercator"&&_.zoom<s.cx&&(_.setProjection({name:"globe"}),f=!0),f&&(this.style.applyProjectionUpdate(),this.style._forceSymbolLayerUpdate(),this._update(!0))}_prioritizeAndUpdateProjection(_,o){return this._updateProjection(_||o||{name:"mercator"})}_updateProjection(_){let o;return o=_.name==="globe"&&this.transform.zoom>=s.cx?this.transform.setMercatorFromTransition():this.transform.setProjection(_),this.style.applyProjectionUpdate(),o&&(this.painter.clearBackgroundTiles(),this.style.clearSources(),this._update(!0),this._forceMarkerAndPopupUpdate(!0)),this}project(_,o){return this.transform.locationPoint3D(s.cd.convert(_),o)}unproject(_,o){return this.transform.pointLocation3D(s.P.convert(_),o)}isMoving(){return this._moving||this.handlers&&this.handlers.isMoving()||!1}isZooming(){return this._zooming||this.handlers&&this.handlers.isZooming()||!1}isRotating(){return this._rotating||this.handlers&&this.handlers.isRotating()||!1}_isDragging(){return this.handlers&&this.handlers._isDragging()||!1}_createDelegatedListener(_,o,f){const y=w=>{let E=[];if(Array.isArray(o)){const C=o.filter(M=>this.getLayer(M));E=C.length?this.queryRenderedFeatures(w,{layers:C}):[]}else E=this.queryRenderedFeatures(w,{target:o});return E};if(_==="mouseenter"||_==="mouseover"){let w=!1;return{listener:f,targets:o,delegates:{mousemove:C=>{const M=y(C.point);M.length?w||(w=!0,f.call(this,new Eo(_,this,C.originalEvent,{features:M}))):w=!1},mouseout:()=>{w=!1}}}}if(_==="mouseleave"||_==="mouseout"){let w=!1;return{listener:f,targets:o,delegates:{mousemove:M=>{y(M.point).length?w=!0:w&&(w=!1,f.call(this,new Eo(_,this,M.originalEvent)))},mouseout:M=>{w&&(w=!1,f.call(this,new Eo(_,this,M.originalEvent)))}}}}{const w=E=>{const C=y(E.point);C.length&&(E.features=C,f.call(this,E),delete E.features)};return{listener:f,targets:o,delegates:{[_]:w}}}}on(_,o,f){if(typeof o=="function"||f===void 0)return super.on(_,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(_,o,f);this._delegatedListeners=this._delegatedListeners||{},this._delegatedListeners[_]=this._delegatedListeners[_]||[],this._delegatedListeners[_].push(y);for(const w in y.delegates)this.on(w,y.delegates[w]);return this}once(_,o,f){if(typeof o=="function"||f===void 0)return super.once(_,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._createDelegatedListener(_,o,f);for(const w in y.delegates)this.once(w,y.delegates[w]);return this}off(_,o,f){if(typeof o=="function"||f===void 0)return super.off(_,o);if(typeof o=="string"&&(o=[o]),!this._areTargetsValid(o))return this;const y=this._delegatedListeners?this._delegatedListeners[_]:void 0;return y&&(w=>{for(let E=0;E<w.length;E++){const C=w[E];if(C.listener===f&&Cg(C.targets,o)){for(const M in C.delegates)this.off(M,C.delegates[M]);return w.splice(E,1),this}}})(y),this}queryRenderedFeatures(_,o){if(!this.style)return[];if(_===void 0||_ instanceof s.P||Array.isArray(_)||o!==void 0||(o=_,_=void 0),_=_||[[0,0],[this.transform.width,this.transform.height]],!o){const E=this.style.queryRenderedFeatures(_,void 0,this.transform),C=this.style.queryRenderedFeatureset(_,void 0,this.transform);return E.concat(C)}let f=!0;if(o.target&&(f=this._isTargetValid(o.target),f&&!o.layers))return this.style.queryRenderedFeatureset(_,o,this.transform);let y=!0;if(o.layers&&Array.isArray(o.layers)){for(const E of o.layers)if(!this._isValidId(E)){y=!1;break}if(y&&!o.target)return this.style.queryRenderedFeatures(_,o,this.transform)}let w=[];return y&&(w=w.concat(this.style.queryRenderedFeatures(_,o,this.transform))),f&&(w=w.concat(this.style.queryRenderedFeatureset(_,o,this.transform))),w}querySourceFeatures(_,o){return!_||typeof _=="string"&&!this._isValidId(_)?[]:this.style.querySourceFeatures(_,o)}isPointOnSurface(_){const{name:o}=this.transform.projection;return o!=="globe"&&o!=="mercator"&&s.w(`${o} projection does not support isPointOnSurface, this API may behave unexpectedly.`),this.transform.isPointOnSurface(s.P.convert(_))}addInteraction(_,o){return this._interactions.add(_,o),this}removeInteraction(_){return this._interactions.remove(_),this}getCooperativeGestures(){return this._cooperativeGestures}setCooperativeGestures(_){return this._cooperativeGestures=_,this}setStyle(_,o){return o=s.h({},{localIdeographFontFamily:this._localIdeographFontFamily,localFontFamily:this._localFontFamily},o),this.style&&_&&o.diff!==!1&&o.localFontFamily===this._localFontFamily&&o.localIdeographFontFamily===this._localIdeographFontFamily&&!o.config?(this.style._diffStyle(_,(f,y)=>{if(f){const w=typeof f=="string"?f:f instanceof Error?f.message:f.error;s.w(`Unable to perform style diff: ${w}. Rebuilding the style from scratch.`),this._updateStyle(_,o)}else y&&this._update(!0)},()=>this._postStyleLoadEvent()),this):(this._localIdeographFontFamily=o.localIdeographFontFamily,this._localFontFamily=o.localFontFamily,this._updateStyle(_,o))}_getUIString(_){const o=this._locale[_];if(o==null)throw new Error(`Missing UI string '${_}'`);return o}_updateStyle(_,o){if(this.style&&(this.style.setEventedParent(null),this.style._remove(),this.style=void 0),_){const f=s.h({},o);o&&o.config&&(f.initialConfig=o.config,delete f.config),this.style=new Go(this,f).load(_),this.style.setEventedParent(this,{style:this.style})}return this._updateTerrain(),this}_lazyInitEmptyStyle(){this.style||(this.style=new Go(this,{}),this.style.setEventedParent(this,{style:this.style}),this.style.loadEmpty())}getStyle(){if(this.style)return this.style.serialize()}isStyleLoaded(){return this.style?this.style.loaded():(s.w("There is no style added to the map."),!1)}_isValidId(_){return _==null?(this.fire(new s.z(new Error("IDs can't be empty."))),!1):!s.d8(_)||(this.fire(new s.z(new Error(`IDs can't contain special symbols: "${_}".`))),!1)}_isTargetValid(_){return"featuresetId"in _?this._isValidId("importId"in _?_.importId:_.featuresetId):"layerId"in _&&this._isValidId(_.layerId)}_areTargetsValid(_){if(Array.isArray(_)){for(const o of _)if(!this._isValidId(o))return!1;return!0}return this._isTargetValid(_)}addSource(_,o){return this._isValidId(_)?(this._lazyInitEmptyStyle(),this.style.addSource(_,o),this._update(!0)):this}isSourceLoaded(_){return!!this._isValidId(_)&&!!this.style&&this.style._isSourceCacheLoaded(_)}areTilesLoaded(){return this.style.areTilesLoaded()}addSourceType(_,o,f){this._lazyInitEmptyStyle(),this.style.addSourceType(_,o,f)}removeSource(_){return this._isValidId(_)?(this.style.removeSource(_),this._updateTerrain(),this._update(!0)):this}getSource(_){return this._isValidId(_)?this.style.getOwnSource(_):null}addImage(_,o,{pixelRatio:f=1,sdf:y=!1,stretchX:w,stretchY:E,content:C}={}){this._lazyInitEmptyStyle();const M=s.I.from(_);if(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap){const{width:N,height:j,data:H}=s.q.getImageData(o);this.style.addImage(M,{data:new s.r({width:N,height:j},H),pixelRatio:f,stretchX:w,stretchY:E,content:C,sdf:y,version:0,usvg:!1})}else if(o.width===void 0||o.height===void 0)this.fire(new s.z(new Error("Invalid arguments to map.addImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));else{const{width:N,height:j}=o,H=o;this.style.addImage(M,{data:new s.r({width:N,height:j},new Uint8Array(H.data)),pixelRatio:f,stretchX:w,stretchY:E,content:C,sdf:y,usvg:!1,version:0,userImage:H}),H.onAdd&&H.onAdd(this,_)}}updateImage(_,o){this._lazyInitEmptyStyle();const f=s.I.from(_),y=this.style.getImage(f);if(!y)return void this.fire(new s.z(new Error("The map has no image with that id. If you are adding a new image use `map.addImage(...)` instead.")));const w=o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap?s.q.getImageData(o):o,{width:E,height:C,data:M}=w;if(E===void 0||C===void 0)return void this.fire(new s.z(new Error("Invalid arguments to map.updateImage(). The second argument must be an `HTMLImageElement`, `ImageData`, `ImageBitmap`, or object with `width`, `height`, and `data` properties with the same format as `ImageData`")));if(E!==(y.usvg?y.icon.usvg_tree.width:y.data.width)||C!==(y.usvg?y.icon.usvg_tree.height:y.data.height))return void this.fire(new s.z(new Error(`The width and height of the updated image (${E}, ${C})
                must be that same as the previous version of the image
                (${y.data.width}, ${y.data.height})`)));const N=!(o instanceof HTMLImageElement||ImageBitmap&&o instanceof ImageBitmap);let j=!1;y.usvg?(y.data=new s.r({width:E,height:C},new Uint8Array(M)),y.usvg=!1,y.icon=void 0,j=!0):y.data.replace(M,N),this.style.updateImage(f,y,j)}hasImage(_){return _?!!this.style&&!!this.style.getImage(s.I.from(_)):(this.fire(new s.z(new Error("Missing required image id"))),!1)}removeImage(_){this.style.removeImage(s.I.from(_))}loadImage(_,o){s.o(this._requestManager.transformRequest(_,s.R.Image),(f,y)=>{o(f,y instanceof HTMLImageElement?s.q.getImageData(y):y)})}listImages(){return this.style.listImages().map(_=>_.name)}addModel(_,o){this._lazyInitEmptyStyle(),this.style.addModel(_,o)}hasModel(_){return _?this.style.hasModel(_):(this.fire(new s.z(new Error("Missing required model id"))),!1)}removeModel(_){this.style.removeModel(_)}listModels(){return this.style.listModels()}addLayer(_,o){return this._isValidId(_.id)?(this._lazyInitEmptyStyle(),this.style.addLayer(_,o),this._update(!0)):this}getSlot(_){const o=this.getLayer(_);return o&&o.slot||null}setSlot(_,o){return this.style.setSlot(_,o),this.style.mergeLayers(),this._update(!0)}addImport(_,o){return this.style.addImport(_,o).catch(f=>this.fire(new s.z(new Error("Failed to add import",f)))),this}updateImport(_,o){return typeof o!="string"&&o.id!==_?(this.removeImport(_),this.addImport(o)):(this.style.updateImport(_,o),this._update(!0))}removeImport(_){return this.style.removeImport(_),this}moveImport(_,o){return this.style.moveImport(_,o),this._update(!0)}moveLayer(_,o){return this._isValidId(_)?(this.style.moveLayer(_,o),this._update(!0)):this}removeLayer(_){return this._isValidId(_)?(this.style.removeLayer(_),this._update(!0)):this}getLayer(_){if(!this._isValidId(_))return null;const o=this.style.getOwnLayer(_);return o?o.type==="custom"?o.implementation:o.serialize():void 0}getSlots(){return this.style.getSlots()}setLayerZoomRange(_,o,f){return this._isValidId(_)?(this.style.setLayerZoomRange(_,o,f),this._update(!0)):this}setFilter(_,o,f={}){return this._isValidId(_)?(this.style.setFilter(_,o,f),this._update(!0)):this}getFilter(_){return this._isValidId(_)?this.style.getFilter(_):null}setPaintProperty(_,o,f,y={}){return this._isValidId(_)?(this.style.setPaintProperty(_,o,f,y),this._update(!0)):this}getPaintProperty(_,o){return this._isValidId(_)?this.style.getPaintProperty(_,o):null}setLayoutProperty(_,o,f,y={}){return this._isValidId(_)?(this.style.setLayoutProperty(_,o,f,y),this._update(!0)):this}getLayoutProperty(_,o){return this._isValidId(_)?this.style.getLayoutProperty(_,o):null}getGlyphsUrl(){return this.style.getGlyphsUrl()}setGlyphsUrl(_){return this.style.setGlyphsUrl(_),this._update(!0)}getSchema(_){return this.style.getSchema(_)}setSchema(_,o){return this.style.setSchema(_,o),this._update(!0)}getConfig(_){return this.style.getConfig(_)}setConfig(_,o){return this.style.setConfig(_,o),this._update(!0)}getConfigProperty(_,o){return this.style.getConfigProperty(_,o)}setConfigProperty(_,o,f){return this.style.setConfigProperty(_,o,f),this._update(!0)}getFeaturesetDescriptors(_){return this.style.getFeaturesetDescriptors(_)}setLights(_){if(this._lazyInitEmptyStyle(),_&&_.length===1&&_[0].type==="flat"){const o=_[0];o.properties?this.style.setFlatLight(o.properties,o.id,{}):this.style.setFlatLight({},"flat")}else this.style.setLights(_),this.painter.terrain&&(this.painter.terrain.invalidateRenderCache=!0);return this._update(!0)}getLights(){const _=this.style.getLights()||[];return _.length===0&&_.push({id:this.style.light.id,type:"flat",properties:this.style.getFlatLight()}),_}setLight(_,o={}){return console.log("The `map.setLight` function is deprecated, prefer using `map.setLights` with `flat` light type instead."),this.setLights([{id:"flat",type:"flat",properties:_}])}getLight(){return console.log("The `map.getLight` function is deprecated, prefer using `map.getLights` instead."),this.style.getFlatLight()}setTerrain(_){return this._lazyInitEmptyStyle(),!_&&this.transform.projection.requiresDraping?this.style.setTerrainForDraping():this.style.setTerrain(_),this._averageElevationLastSampledAt=-1/0,this._update(!0)}getTerrain(){return this.style?this.style.getTerrain():null}setFog(_){return this._lazyInitEmptyStyle(),this.style.setFog(_),this._update(!0)}getFog(){return this.style?this.style.getFog():null}setSnow(_){return this._lazyInitEmptyStyle(),this.style.setSnow(_),this._update(!0)}getSnow(){return this.style?this.style.getSnow():null}setRain(_){return this._lazyInitEmptyStyle(),this.style.setRain(_),this._update(!0)}getRain(){return this.style?this.style.getRain():null}setColorTheme(_){return this._lazyInitEmptyStyle(),this.style.setColorTheme(_),this._update(!0)}setImportColorTheme(_,o){return this._lazyInitEmptyStyle(),this.style.setImportColorTheme(_,o),this._update(!0)}setCamera(_){return this.style.setCamera(_),this._triggerCameraUpdate(_)}_triggerCameraUpdate(_){return this._update(this.transform.setOrthographicProjectionAtLowPitch(_["camera-projection"]==="orthographic"))}getCamera(){return this.style.camera}_queryFogOpacity(_){return this.style&&this.style.fog?this.style.fog.getOpacityAtLatLng(s.cd.convert(_),this.transform):0}setFeatureState(_,o){return _.source&&!this._isValidId(_.source)?this:(this.style.setFeatureState(_,o),this._update())}removeFeatureState(_,o){return _.source&&!this._isValidId(_.source)?this:(this.style.removeFeatureState(_,o),this._update())}getFeatureState(_){return _.source&&!this._isValidId(_.source)?null:this.style.getFeatureState(_)}_updateContainerDimensions(){if(!this._container)return;const _=this._container.getBoundingClientRect().width||400,o=this._container.getBoundingClientRect().height||300;let f,y,w,E=this._container;for(;E&&(!y||!w);){const C=window.getComputedStyle(E).transform;C&&C!=="none"&&(f=C.match(/matrix.*\((.+)\)/)[1].split(", "),f[0]&&f[0]!=="0"&&f[0]!=="1"&&(y=f[0]),f[3]&&f[3]!=="0"&&f[3]!=="1"&&(w=f[3])),E=E.parentElement}this._containerWidth=y?Math.abs(_/y):_,this._containerHeight=w?Math.abs(o/w):o}_detectMissingCSS(){window.getComputedStyle(this._missingCSSCanary).getPropertyValue("background-color")!=="rgb(250, 128, 114)"&&s.w("This page appears to be missing CSS declarations for Mapbox GL JS, which may cause the map to display incorrectly. Please ensure your page includes mapbox-gl.css, as described in https://www.mapbox.com/mapbox-gl-js/api/.")}_setupContainer(){const _=this._container;_.classList.add("mapboxgl-map"),(this._missingCSSCanary=X("div","mapboxgl-canary",_)).style.visibility="hidden",this._detectMissingCSS();const o=this._canvasContainer=X("div","mapboxgl-canvas-container",_);this._canvas=X("canvas","mapboxgl-canvas",o),this._interactive&&(o.classList.add("mapboxgl-interactive"),this._canvas.setAttribute("tabindex","0")),this._canvas.addEventListener("webglcontextlost",this._contextLost,!1),this._canvas.addEventListener("webglcontextrestored",this._contextRestored,!1),this._canvas.setAttribute("aria-label",this._getUIString("Map.Title")),this._canvas.setAttribute("role","region"),this._updateContainerDimensions(),this._resizeCanvas(this._containerWidth,this._containerHeight);const f=this._controlContainer=X("div","mapboxgl-control-container",_),y=this._controlPositions={};["top-left","top","top-right","right","bottom-right","bottom","bottom-left","left"].forEach(w=>{y[w]=X("div",`mapboxgl-ctrl-${w}`,f)}),this._container.addEventListener("scroll",this._onMapScroll,!1)}_resizeCanvas(_,o){const f=s.q.devicePixelRatio||1;this._canvas.width=f*Math.ceil(_),this._canvas.height=f*Math.ceil(o),this._canvas.style.width=`${_}px`,this._canvas.style.height=`${o}px`}_addMarker(_){this._markers.push(_)}_removeMarker(_){const o=this._markers.indexOf(_);o!==-1&&this._markers.splice(o,1)}_addPopup(_){this._popups.push(_)}_removePopup(_){const o=this._popups.indexOf(_);o!==-1&&this._popups.splice(o,1)}_setupPainter(){const _=s.h({},J.supported.webGLContextAttributes,{failIfMajorPerformanceCaveat:this._failIfMajorPerformanceCaveat,preserveDrawingBuffer:this._preserveDrawingBuffer,antialias:this._antialias||!1}),o=this._canvas.getContext("webgl2",_);o?(Bt(o,!0),this.painter=new Rf(o,this._contextCreateOptions,this.transform,this._scaleFactor,this._tp,this._worldview),this.on("data",f=>{f.dataType==="source"&&this.painter.setTileLoadedFlag(!0)}),s.l.testSupport(o)):this.fire(new s.z(new Error("Failed to initialize WebGL")))}_contextLost(_){_.preventDefault(),this._frame&&(this._frame.cancel(),this._frame=null),this.fire(new s.A("webglcontextlost",{originalEvent:_}))}_contextRestored(_){this._setupPainter(),this.painter.resize(Math.ceil(this._containerWidth),Math.ceil(this._containerHeight)),this._updateTerrain(),this.style&&(this.style.reloadModels(),this.style.clearSources()),this._update(),this.fire(new s.A("webglcontextrestored",{originalEvent:_}))}_onMapScroll(_){if(_.target===this._container)return this._container.scrollTop=0,this._container.scrollLeft=0,!1}idle(){return!this.isMoving()&&this.loaded()}loaded(){return!this._styleDirty&&!this._sourcesDirty&&!!this.style&&this.style.loaded()}frameReady(){return this.loaded()&&!this._placementDirty}_update(_){return this.style?(this._styleDirty=this._styleDirty||_,this._sourcesDirty=!0,this.triggerRepaint(),this):this}_requestRenderFrame(_){return this._update(),this._renderTaskQueue.add(_)}_cancelRenderFrame(_){this._renderTaskQueue.remove(_)}_requestDomTask(_){!this.loaded()||this.loaded()&&!this.isMoving()?_():this._domRenderTaskQueue.add(_)}_render(_){let o;this.fire(new s.A("renderstart")),++this._frameId;const f=this.painter.context.extTimerQuery,y=s.q.now(),w=this.painter.context.gl;if(this.listens("gpu-timing-frame")&&(o=w.createQuery(),w.beginQuery(f.TIME_ELAPSED_EXT,o)),this.painter.context.setDirty(),this.painter.setBaseState(),(this.isMoving()||this.isRotating()||this.isZooming())&&(this._interactionRange[0]=Math.min(this._interactionRange[0],performance.now()),this._interactionRange[1]=Math.max(this._interactionRange[1],performance.now())),this._renderTaskQueue.run(_),this._domRenderTaskQueue.run(_),this._removed)return;this._updateProjectionTransition();const E=this._isInitialLoad?0:this._fadeDuration;if(this.style&&this._styleDirty){this._styleDirty=!1;const j=this.transform.zoom,H=this.transform.pitch,Z=s.q.now(),W=new s.aa(j,{now:Z,fadeDuration:E,pitch:H,transition:this.style.transition,worldview:this._worldview});this.style.update(W)}this.style&&this.style.hasFogTransition()&&(this.style._markersNeedUpdate=!0,this._sourcesDirty=!0);let C=!1;this.style&&this._sourcesDirty?(this._sourcesDirty=!1,this.painter._updateFog(this.style),this._updateTerrain(),C=this._updateAverageElevation(y),this.style.updateSources(this.transform),this.style.updateImageProviders(),this.isMoving()||this._forceMarkerAndPopupUpdate()):C=this._updateAverageElevation(y);const M=this.style&&this.style._updatePlacement(this.painter,this.painter.transform,this.showCollisionBoxes,E,this._crossSourceCollisions,this.painter.replacementSource,this._scaleFactorChanged);if(this._scaleFactorChanged&&(this._scaleFactorChanged=!1),M&&(this._placementDirty=M.needsRerender),this.style&&this.painter.render(this.style,{showTileBoundaries:this.showTileBoundaries,showParseStatus:this.showParseStatus,wireframe:{terrain:this.showTerrainWireframe,layers2D:this.showLayers2DWireframe,layers3D:this.showLayers3DWireframe},showOverdrawInspector:this._showOverdrawInspector,showQueryGeometry:!!this._showQueryGeometry,showTileAABBs:this.showTileAABBs,rotating:this.isRotating(),zooming:this.isZooming(),moving:this.isMoving(),fadeDuration:E,isInitialLoad:this._isInitialLoad,showPadding:this.showPadding,gpuTiming:!!this.listens("gpu-timing-layer"),gpuTimingDeferredRender:!!this.listens("gpu-timing-deferred-render"),speedIndexTiming:this.speedIndexTiming}),this.fire(new s.A("render")),this.loaded()&&!this._loaded&&(this._loaded=!0,P.mark(D.load),this.fire(new s.A("load"))),this.style&&this.style.hasTransitions()&&(this._styleDirty=!0),this.style&&(this.style.snow||this.style.rain)&&(this._styleDirty=!0),this.style&&this.style.imageManager.hasPatternsInFlight()&&(this._styleDirty=!0),this.style&&!this.style.modelManager.isLoaded()&&(this._styleDirty=!0),this.style&&!this._placementDirty&&this.style._releaseSymbolFadeTiles(),o){const j=s.q.now()-y;w.endQuery(f.TIME_ELAPSED_EXT),setTimeout(()=>{const H=w.getQueryParameter(o,w.QUERY_RESULT)/1e6;w.deleteQuery(o),this.fire(new s.A("gpu-timing-frame",{cpuTime:j,gpuTime:H}))},50)}if(this.listens("gpu-timing-layer")){const j=this.painter.collectGpuTimers();setTimeout(()=>{const H=this.painter.queryGpuTimers(j);this.fire(new s.A("gpu-timing-layer",{layerTimes:H}))},50)}if(this.listens("gpu-timing-deferred-render")){const j=this.painter.collectDeferredRenderGpuQueries();setTimeout(()=>{const H=this.painter.queryGpuTimeDeferredRender(j);this.fire(new s.A("gpu-timing-deferred-render",{gpuTime:H}))},50)}const N=this._sourcesDirty||this._styleDirty||this._placementDirty||C;if(N||this._repaint)this.triggerRepaint();else{const j=this.idle();if(j&&(C=this._updateAverageElevation(y,!0)),C)this.triggerRepaint();else if(this._triggerFrame(!1),j&&(this.fire(new s.A("idle")),this._isInitialLoad=!1,this.speedIndexTiming)){const H=this._calculateSpeedIndex();this.fire(new s.A("speedindexcompleted",{speedIndex:H})),this.speedIndexTiming=!1}}!this._loaded||this._fullyLoaded||N||(this._fullyLoaded=!0,P.mark(D.fullLoad),this._performanceMetricsCollection&&yn(this._requestManager._customAccessToken,{width:this.painter.width,height:this.painter.height,interactionRange:this._interactionRange,visibilityHidden:this._visibilityHidden,terrainEnabled:!!this.painter.style.getTerrain(),fogEnabled:!!this.painter.style.getFog(),projection:this.getProjection().name,zoom:this.transform.zoom,renderer:this.painter.context.renderer,vendor:this.painter.context.vendor}),this._authenticate())}_forceMarkerAndPopupUpdate(_){for(const o of this._markers)_&&!this.getRenderWorldCopies()&&(o._lngLat=o._lngLat.wrap()),o._update();for(const o of this._popups)!_||this.getRenderWorldCopies()||o._trackPointer||(o._lngLat=o._lngLat.wrap()),o._update()}_updateAverageElevation(_,o=!1){const f=w=>(this.transform.averageElevation=w,this._update(!1),!0);if(!this.painter.averageElevationNeedsEasing())return this.transform.averageElevation!==0&&f(0);const y=this.transform.elevation&&this.transform.elevation.exaggeration()!==this._averageElevationExaggeration;if(y||(o||_-this._averageElevationLastSampledAt>500)&&!this._averageElevation.isEasing(_)){const w=this.transform.averageElevation;let E=this.transform.sampleAverageElevation();this.transform.elevation!=null&&(this._averageElevationExaggeration=this.transform.elevation.exaggeration()),isNaN(E)?E=0:this._averageElevationLastSampledAt=_;const C=Math.abs(w-E);if(C>1){if(this._isInitialLoad||y)return this._averageElevation.jumpTo(E),f(E);this._averageElevation.easeTo(E,_,300)}else if(C>1e-4)return this._averageElevation.jumpTo(E),f(E)}return!!this._averageElevation.isEasing(_)&&f(this._averageElevation.getValue(_))}_authenticate(){Cn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,_=>{if(_&&(_.message===ze||_.status===401)){const o=this.painter.context.gl;Bt(o,!1),this._logoControl instanceof Lf&&this._logoControl._updateLogo(),o&&o.clear(o.DEPTH_BUFFER_BIT|o.COLOR_BUFFER_BIT|o.STENCIL_BUFFER_BIT),this._silenceAuthErrors||this.fire(new s.z(new Error("A valid Mapbox access token is required to use Mapbox GL JS. To create an account or a new access token, visit https://account.mapbox.com/")))}}),wn(this._getMapId(),this._requestManager._skuToken,this._requestManager._customAccessToken,()=>{})}_postStyleLoadEvent(){this.style.globalId&&Ht(this._requestManager._customAccessToken,{map:this,style:this.style.globalId,importedStyles:this.style.getImportGlobalIds()})}_updateTerrain(){const _=this._isDragging();this.painter.updateTerrain(this.style,_)}_calculateSpeedIndex(){const _=this.painter.canvasCopy(),o=this.painter.getCanvasCopiesAndTimestamps();o.timeStamps.push(performance.now());const f=this.painter.context.gl,y=f.createFramebuffer();function w(E){f.framebufferTexture2D(f.FRAMEBUFFER,f.COLOR_ATTACHMENT0,f.TEXTURE_2D,E,0);const C=new Uint8Array(f.drawingBufferWidth*f.drawingBufferHeight*4);return f.readPixels(0,0,f.drawingBufferWidth,f.drawingBufferHeight,f.RGBA,f.UNSIGNED_BYTE,C),C}return f.bindFramebuffer(f.FRAMEBUFFER,y),this._canvasPixelComparison(w(_),o.canvasCopies.map(w),o.timeStamps)}_canvasPixelComparison(_,o,f){let y=f[1]-f[0];const w=_.length/4;for(let E=0;E<o.length;E++){const C=o[E];let M=0;for(let N=0;N<C.length;N+=4)C[N]===_[N]&&C[N+1]===_[N+1]&&C[N+2]===_[N+2]&&C[N+3]===_[N+3]&&(M+=1);y+=(f[E+2]-f[E+1])*(1-M/w)}return y}remove(){this._hash&&this._hash.remove();for(const o of this._controls)o.onRemove(this);this._controls=[],this._frame&&(this._frame.cancel(),this._frame=null),this._renderTaskQueue.clear(),this._domRenderTaskQueue.clear(),this.style&&this.style.destroy(),this.indoor.destroy(),this.painter.destroy(),this.handlers&&this.handlers.destroy(),this.handlers=void 0,this.setStyle(null),window.removeEventListener("resize",this._onWindowResize,!1),window.removeEventListener("orientationchange",this._onWindowResize,!1),window.removeEventListener(this._fullscreenchangeEvent,this._onWindowResize,!1),window.removeEventListener("online",this._onWindowOnline,!1),window.removeEventListener("visibilitychange",this._onVisibilityChange,!1);const _=this.painter.context.gl.getExtension("WEBGL_lose_context");_&&_.loseContext(),this._canvas.removeEventListener("webglcontextlost",this._contextLost,!1),this._canvas.removeEventListener("webglcontextrestored",this._contextRestored,!1),this._canvasContainer.remove(),this._controlContainer.remove(),this._missingCSSCanary.remove(),this._canvas=void 0,this._canvasContainer=void 0,this._controlContainer=void 0,this._missingCSSCanary=void 0,this._container.classList.remove("mapboxgl-map"),this._container.removeEventListener("scroll",this._onMapScroll,!1),Kn.delete(this.painter.context.gl),Tn.remove(),ln.remove(),this._removed=!0,this.fire(new s.A("remove"))}triggerRepaint(){this._triggerFrame(!0)}_triggerFrame(_){this._renderNextFrame=this._renderNextFrame||_,this.style&&!this._frame&&(this._frame=s.q.frame(o=>{const f=!!this._renderNextFrame;this._frame=null,this._renderNextFrame=null,f&&this._render(o)}))}_preloadTiles(_){const o=this.style?this.style.getSourceCaches():[];return s.bt(o,(f,y)=>f._preloadTiles(_,y),()=>{this.triggerRepaint()}),this}_onWindowOnline(){this._update()}_onWindowResize(_){this._trackResize&&this.resize({originalEvent:_})._update()}_onVisibilityChange(){document.visibilityState==="hidden"&&this._visibilityHidden++}get showTileBoundaries(){return!!this._showTileBoundaries}set showTileBoundaries(_){this._showTileBoundaries!==_&&(this._showTileBoundaries=_,this._tp.refreshUI(),this._update())}get showParseStatus(){return!!this._showParseStatus}set showParseStatus(_){this._showParseStatus!==_&&(this._showParseStatus=_,this._tp.refreshUI(),this._update())}get showTerrainWireframe(){return!!this._showTerrainWireframe}set showTerrainWireframe(_){this._showTerrainWireframe!==_&&(this._showTerrainWireframe=_,this._tp.refreshUI(),this._update())}get showLayers2DWireframe(){return!!this._showLayers2DWireframe}set showLayers2DWireframe(_){this._showLayers2DWireframe!==_&&(this._showLayers2DWireframe=_,this._tp.refreshUI(),this._update())}get showLayers3DWireframe(){return!!this._showLayers3DWireframe}set showLayers3DWireframe(_){this._showLayers3DWireframe!==_&&(this._showLayers3DWireframe=_,this._tp.refreshUI(),this._update())}get speedIndexTiming(){return!!this._speedIndexTiming}set speedIndexTiming(_){this._speedIndexTiming!==_&&(this._speedIndexTiming=_,this._update())}get showPadding(){return!!this._showPadding}set showPadding(_){this._showPadding!==_&&(this._showPadding=_,this._tp.refreshUI(),this._update())}get showCollisionBoxes(){return!!this._showCollisionBoxes}set showCollisionBoxes(_){this._showCollisionBoxes!==_&&(this._showCollisionBoxes=_,this._tp.refreshUI(),_?this.style._generateCollisionBoxes():this._update())}get showOverdrawInspector(){return!!this._showOverdrawInspector}set showOverdrawInspector(_){this._showOverdrawInspector!==_&&(this._showOverdrawInspector=_,this._tp.refreshUI(),this._update())}get repaint(){return!!this._repaint}set repaint(_){this._repaint!==_&&(this._repaint=_,this._tp.refreshUI(),this.triggerRepaint())}get vertices(){return!!this._vertices}set vertices(_){this._vertices=_,this._update()}get showTileAABBs(){return!!this._showTileAABBs}set showTileAABBs(_){this._showTileAABBs!==_&&(this._showTileAABBs=_,this._tp.refreshUI(),_&&this._update())}_setCacheLimits(_,o){s.eJ(_,o)}get version(){return T}},NavigationControl:class{constructor(_={}){this.options=s.h({},Gp,_),this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._container.addEventListener("contextmenu",o=>o.preventDefault()),this.options.showZoom&&(s.aV(["_setButtonTitle","_updateZoomButtons"],this),this._zoomInButton=this._createButton("mapboxgl-ctrl-zoom-in",o=>{this._map&&this._map.zoomIn({},{originalEvent:o})}),X("span","mapboxgl-ctrl-icon",this._zoomInButton).setAttribute("aria-hidden","true"),this._zoomOutButton=this._createButton("mapboxgl-ctrl-zoom-out",o=>{this._map&&this._map.zoomOut({},{originalEvent:o})}),X("span","mapboxgl-ctrl-icon",this._zoomOutButton).setAttribute("aria-hidden","true")),this.options.showCompass&&(s.aV(["_rotateCompassArrow"],this),this._compass=this._createButton("mapboxgl-ctrl-compass",o=>{const f=this._map;f&&(this.options.visualizePitch?f.resetNorthPitch({},{originalEvent:o}):f.resetNorth({},{originalEvent:o}))}),this._compassIcon=X("span","mapboxgl-ctrl-icon",this._compass),this._compassIcon.setAttribute("aria-hidden","true"))}_updateZoomButtons(){const _=this._map;if(!_)return;const o=_.getZoom(),f=o===_.getMaxZoom(),y=o===_.getMinZoom();this._zoomInButton.disabled=f,this._zoomOutButton.disabled=y,this._zoomInButton.setAttribute("aria-disabled",f.toString()),this._zoomOutButton.setAttribute("aria-disabled",y.toString())}_rotateCompassArrow(){const _=this._map;if(!_)return;const o=this.options.visualizePitch?`scale(${1/Math.pow(Math.cos(_.transform.pitch*(Math.PI/180)),.5)}) rotateX(${_.transform.pitch}deg) rotateZ(${_.transform.angle*(180/Math.PI)}deg)`:`rotate(${_.transform.angle*(180/Math.PI)}deg)`;_._requestDomTask(()=>{this._compassIcon&&(this._compassIcon.style.transform=o)})}onAdd(_){return this._map=_,this.options.showZoom&&(this._setButtonTitle(this._zoomInButton,"ZoomIn"),this._setButtonTitle(this._zoomOutButton,"ZoomOut"),_.on("zoom",this._updateZoomButtons),this._updateZoomButtons()),this.options.showCompass&&(this._setButtonTitle(this._compass,"ResetBearing"),this.options.visualizePitch&&_.on("pitch",this._rotateCompassArrow),_.on("rotate",this._rotateCompassArrow),this._rotateCompassArrow(),this._handler=new Qx(_,this._compass,this.options.visualizePitch)),this._container}onRemove(){const _=this._map;_&&(this._container.remove(),this.options.showZoom&&_.off("zoom",this._updateZoomButtons),this.options.showCompass&&(this.options.visualizePitch&&_.off("pitch",this._rotateCompassArrow),_.off("rotate",this._rotateCompassArrow),this._handler&&this._handler.off(),this._handler=void 0),this._map=void 0)}_createButton(_,o){const f=X("button",_,this._container);return f.type="button",f.addEventListener("click",o),f}_setButtonTitle(_,o){if(!this._map)return;const f=this._map._getUIString(`NavigationControl.${o}`);_.setAttribute("aria-label",f),_.firstElementChild&&_.firstElementChild.setAttribute("title",f)}},GeolocateControl:class extends s.E{constructor(_={}){super();const o=navigator.geolocation;this.options=s.h({geolocation:o},Sy,_),s.aV(["_onSuccess","_onError","_onZoom","_finish","_setupUI","_updateCamera","_updateMarker","_updateMarkerRotation","_onDeviceOrientation"],this),this._updateMarkerRotationThrottled=fd(this._updateMarkerRotation,20),this._numberOfWatches=0}onAdd(_){return this._map=_,this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkGeolocationSupport(this._setupUI),this._container}onRemove(){this._geolocationWatchID!==void 0&&(this.options.geolocation.clearWatch(this._geolocationWatchID),this._geolocationWatchID=void 0),this.options.showUserLocation&&this._userLocationDotMarker&&this._userLocationDotMarker.remove(),this.options.showAccuracyCircle&&this._accuracyCircleMarker&&this._accuracyCircleMarker.remove(),this._container.remove(),this._map.off("zoom",this._onZoom),this._map=void 0,this._numberOfWatches=0,this._noTimeout=!1}_checkGeolocationSupport(_){const o=(f=!!this.options.geolocation)=>{this._supportsGeolocation=f,_(f)};this._supportsGeolocation!==void 0?_(this._supportsGeolocation):navigator.permissions!==void 0?navigator.permissions.query({name:"geolocation"}).then(f=>o(f.state!=="denied")).catch(()=>o()):o()}_isOutOfMapMaxBounds(_){const o=this._map.getMaxBounds(),f=_.coords;return!!o&&(f.longitude<o.getWest()||f.longitude>o.getEast()||f.latitude<o.getSouth()||f.latitude>o.getNorth())}_setErrorState(){switch(this._watchState){case"WAITING_ACTIVE":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"ACTIVE_LOCK":this._watchState="ACTIVE_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting");break;case"BACKGROUND":this._watchState="BACKGROUND_ERROR",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting")}}_onSuccess(_){if(this._map){if(this._isOutOfMapMaxBounds(_))return this._setErrorState(),this.fire(new s.A("outofmaxbounds",_)),this._updateMarker(),void this._finish();if(this.options.trackUserLocation)switch(this._lastKnownPosition=_,this._watchState){case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"BACKGROUND":case"BACKGROUND_ERROR":this._watchState="BACKGROUND",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background")}this.options.showUserLocation&&this._watchState!=="OFF"&&this._updateMarker(_),this.options.trackUserLocation&&this._watchState!=="ACTIVE_LOCK"||this._updateCamera(_),this.options.showUserLocation&&this._userLocationDotMarker.removeClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("geolocate",_)),this._finish()}}_updateCamera(_){const o=new s.cd(_.coords.longitude,_.coords.latitude),f=_.coords.accuracy,y=this._map.getBearing(),w=s.h({bearing:y},this.options.fitBoundsOptions);this._map.fitBounds(o.toBounds(f),w,{geolocateSource:!0})}_updateMarker(_){if(_){const o=new s.cd(_.coords.longitude,_.coords.latitude);this._accuracyCircleMarker.setLngLat(o).addTo(this._map),this._userLocationDotMarker.setLngLat(o).addTo(this._map),this._accuracy=_.coords.accuracy,this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}else this._userLocationDotMarker.remove(),this._accuracyCircleMarker.remove()}_updateCircleRadius(){const _=this._map.transform,o=s.c6(1,_._center.lat)*_.worldSize,f=Math.ceil(2*this._accuracy*o);this._circleElement.style.width=`${f}px`,this._circleElement.style.height=`${f}px`}_onZoom(){this.options.showUserLocation&&this.options.showAccuracyCircle&&this._updateCircleRadius()}_updateMarkerRotation(){this._userLocationDotMarker&&typeof this._heading=="number"?(this._userLocationDotMarker.setRotation(this._heading),this._userLocationDotMarker.addClassName("mapboxgl-user-location-show-heading")):(this._userLocationDotMarker.removeClassName("mapboxgl-user-location-show-heading"),this._userLocationDotMarker.setRotation(0))}_onError(_){if(this._map){if(this.options.trackUserLocation)if(_.code===1){this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this._geolocateButton.disabled=!0;const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o),this._geolocationWatchID!==void 0&&this._clearWatch()}else{if(_.code===3&&this._noTimeout)return;this._setErrorState()}this._watchState!=="OFF"&&this.options.showUserLocation&&this._userLocationDotMarker.addClassName("mapboxgl-user-location-dot-stale"),this.fire(new s.A("error",_)),this._finish()}}_finish(){this._timeoutId&&clearTimeout(this._timeoutId),this._timeoutId=void 0}_setupUI(_){if(this._map!==void 0){if(this._container.addEventListener("contextmenu",o=>o.preventDefault()),this._geolocateButton=X("button","mapboxgl-ctrl-geolocate",this._container),X("span","mapboxgl-ctrl-icon",this._geolocateButton).setAttribute("aria-hidden","true"),this._geolocateButton.type="button",_===!1){s.w("Geolocation support is not available so the GeolocateControl will be disabled.");const o=this._map._getUIString("GeolocateControl.LocationNotAvailable");this._geolocateButton.disabled=!0,this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}else{const o=this._map._getUIString("GeolocateControl.FindMyLocation");this._geolocateButton.setAttribute("aria-label",o),this._geolocateButton.firstElementChild&&this._geolocateButton.firstElementChild.setAttribute("title",o)}this.options.trackUserLocation&&(this._geolocateButton.setAttribute("aria-pressed","false"),this._watchState="OFF"),this.options.showUserLocation&&(this._dotElement=X("div","mapboxgl-user-location"),this._dotElement.appendChild(X("div","mapboxgl-user-location-dot")),this._dotElement.appendChild(X("div","mapboxgl-user-location-heading")),this._userLocationDotMarker=new Rg({element:this._dotElement,rotationAlignment:"map",pitchAlignment:"map"}),this._circleElement=X("div","mapboxgl-user-location-accuracy-circle"),this._accuracyCircleMarker=new Rg({element:this._circleElement,pitchAlignment:"map"}),this.options.trackUserLocation&&(this._watchState="OFF"),this._map.on("zoom",this._onZoom)),this._geolocateButton.addEventListener("click",this.trigger.bind(this)),this._setup=!0,this.options.trackUserLocation&&this._map.on("movestart",o=>{o.geolocateSource||this._watchState!=="ACTIVE_LOCK"||o.originalEvent&&o.originalEvent.type==="resize"||(this._watchState="BACKGROUND",this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this.fire(new s.A("trackuserlocationend")))})}}_onDeviceOrientation(_){this._userLocationDotMarker&&(_.webkitCompassHeading?this._heading=_.webkitCompassHeading:_.absolute===!0&&(this._heading=-1*_.alpha),this._updateMarkerRotationThrottled())}trigger(){if(!this._setup)return s.w("Geolocate control triggered before added to a map"),!1;if(this.options.trackUserLocation){switch(this._watchState){case"OFF":this._watchState="WAITING_ACTIVE",this.fire(new s.A("trackuserlocationstart"));break;case"WAITING_ACTIVE":case"ACTIVE_LOCK":case"ACTIVE_ERROR":case"BACKGROUND_ERROR":this._numberOfWatches--,this._noTimeout=!1,this._watchState="OFF",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-active-error"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background-error"),this.fire(new s.A("trackuserlocationend"));break;case"BACKGROUND":this._watchState="ACTIVE_LOCK",this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-background"),this._lastKnownPosition&&this._updateCamera(this._lastKnownPosition),this.fire(new s.A("trackuserlocationstart"))}switch(this._watchState){case"WAITING_ACTIVE":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_LOCK":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active");break;case"ACTIVE_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-active-error");break;case"BACKGROUND":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background");break;case"BACKGROUND_ERROR":this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-background-error")}if(this._watchState==="OFF"&&this._geolocationWatchID!==void 0)this._clearWatch();else if(this._geolocationWatchID===void 0){let _;this._geolocateButton.classList.add("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","true"),this._numberOfWatches++,this._numberOfWatches>1?(_={maximumAge:6e5,timeout:0},this._noTimeout=!0):(_=this.options.positionOptions,this._noTimeout=!1),this._geolocationWatchID=this.options.geolocation.watchPosition(this._onSuccess,this._onError,_),this.options.showUserHeading&&this._addDeviceOrientationListener()}}else this.options.geolocation.getCurrentPosition(this._onSuccess,this._onError,this.options.positionOptions),this._timeoutId=window.setTimeout(this._finish,1e4);return!0}_addDeviceOrientationListener(){const _=()=>{"ondeviceorientationabsolute"in window?window.addEventListener("deviceorientationabsolute",this._onDeviceOrientation):window.addEventListener("deviceorientation",this._onDeviceOrientation)};typeof DeviceMotionEvent<"u"&&typeof DeviceMotionEvent.requestPermission=="function"?DeviceOrientationEvent.requestPermission().then(o=>{o==="granted"&&_()}).catch(console.error):_()}_clearWatch(){this.options.geolocation.clearWatch(this._geolocationWatchID),window.removeEventListener("deviceorientation",this._onDeviceOrientation),window.removeEventListener("deviceorientationabsolute",this._onDeviceOrientation),this._geolocationWatchID=void 0,this._geolocateButton.classList.remove("mapboxgl-ctrl-geolocate-waiting"),this._geolocateButton.setAttribute("aria-pressed","false"),this.options.showUserLocation&&this._updateMarker(null)}},AttributionControl:yd,ScaleControl:class{constructor(_={}){this.options=s.h({},Og,_),this._isNumberFormatSupported=function(){try{return new Intl.NumberFormat("en",{style:"unit",unitDisplay:"short",unit:"meter"}),!0}catch{return!1}}(),s.aV(["_update","_setScale","setUnit"],this)}getDefaultPosition(){return"bottom-left"}_update(){const _=this.options.maxWidth||100,o=this._map,f=o._containerHeight/2,y=o._containerWidth/2-_/2,w=o.unproject([y,f]),E=o.unproject([y+_,f]),C=w.distanceTo(E);if(this.options.unit==="imperial"){const M=3.2808*C;M>5280?this._setScale(_,M/5280,"mile"):this._setScale(_,M,"foot")}else this.options.unit==="nautical"?this._setScale(_,C/1852,"nautical-mile"):C>=1e3?this._setScale(_,C/1e3,"kilometer"):this._setScale(_,C,"meter")}_setScale(_,o,f){this._map._requestDomTask(()=>{const y=function(E){const C=Math.pow(10,`${Math.floor(E)}`.length-1);let M=E/C;return M=M>=10?10:M>=5?5:M>=3?3:M>=2?2:M>=1?1:function(N){const j=Math.pow(10,Math.ceil(-Math.log(N)/Math.LN10));return Math.round(N*j)/j}(M),C*M}(o),w=y/o;this._container.innerHTML=this._isNumberFormatSupported&&f!=="nautical-mile"?new Intl.NumberFormat(this._language,{style:"unit",unitDisplay:"short",unit:f}).format(y):`${y}&nbsp;${qp[f]}`,this._container.style.width=_*w+"px"})}onAdd(_){return this._map=_,this._language=_.getLanguage(),this._container=X("div","mapboxgl-ctrl mapboxgl-ctrl-scale",_.getContainer()),this._container.dir="auto",this._map.on("move",this._update),this._update(),this._container}onRemove(){this._container.remove(),this._map.off("move",this._update),this._map=void 0}_setLanguage(_){this._language=_,this._update()}setUnit(_){this.options.unit=_,this._update()}},FullscreenControl:class{constructor(_={}){this._fullscreen=!1,_&&_.container&&(_.container instanceof HTMLElement?this._container=_.container:s.w("Full screen control 'container' must be a DOM element.")),s.aV(["_onClickFullscreen","_changeIcon"],this),"onfullscreenchange"in document?this._fullscreenchange="fullscreenchange":"onwebkitfullscreenchange"in document&&(this._fullscreenchange="webkitfullscreenchange")}onAdd(_){return this._map=_,this._container||(this._container=this._map.getContainer()),this._controlContainer=X("div","mapboxgl-ctrl mapboxgl-ctrl-group"),this._checkFullscreenSupport()?this._setupUI():(this._controlContainer.style.display="none",s.w("This device does not support fullscreen mode.")),this._controlContainer}onRemove(){this._controlContainer.remove(),this._map=null,document.removeEventListener(this._fullscreenchange,this._changeIcon)}_checkFullscreenSupport(){return!(!document.fullscreenEnabled&&!document.webkitFullscreenEnabled)}_setupUI(){const _=this._fullscreenButton=X("button","mapboxgl-ctrl-fullscreen",this._controlContainer);X("span","mapboxgl-ctrl-icon",_).setAttribute("aria-hidden","true"),_.type="button",this._updateTitle(),this._fullscreenButton.addEventListener("click",this._onClickFullscreen),document.addEventListener(this._fullscreenchange,this._changeIcon)}_updateTitle(){const _=this._getTitle();this._fullscreenButton.setAttribute("aria-label",_),this._fullscreenButton.firstElementChild&&this._fullscreenButton.firstElementChild.setAttribute("title",_)}_getTitle(){return this._map._getUIString(this._isFullscreen()?"FullscreenControl.Exit":"FullscreenControl.Enter")}_isFullscreen(){return this._fullscreen}_changeIcon(){(document.fullscreenElement||document.webkitFullscreenElement)===this._container!==this._fullscreen&&(this._fullscreen=!this._fullscreen,this._fullscreenButton.classList.toggle("mapboxgl-ctrl-shrink"),this._fullscreenButton.classList.toggle("mapboxgl-ctrl-fullscreen"),this._updateTitle())}_onClickFullscreen(){this._isFullscreen()?document.exitFullscreen?document.exitFullscreen():document.webkitCancelFullScreen&&document.webkitCancelFullScreen():this._container.requestFullscreen?this._container.requestFullscreen():this._container.webkitRequestFullscreen&&this._container.webkitRequestFullscreen()}},Popup:class extends s.E{constructor(_){super(),this.options=s.h(Object.create(cu),_),this._altitude=this.options.altitude,s.aV(["_update","_onClose","remove","_onMouseEvent"],this),this._classList=new Set(_&&_.className?_.className.trim().split(/\s+/):[])}addTo(_){return this._map&&this.remove(),this._map=_,this.options.closeOnClick&&_.on("preclick",this._onClose),this.options.closeOnMove&&_.on("move",this._onClose),_.on("remove",this.remove),this._update(),_._addPopup(this),this._focusFirstElement(),this._trackPointer?(_.on("mousemove",this._onMouseEvent),_.on("mouseup",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")):_.on("move",this._update),this.fire(new s.A("open")),this}isOpen(){return!!this._map}remove(){this._content&&this._content.remove(),this._container&&(this._container.remove(),this._container=void 0);const _=this._map;return _&&(_.off("move",this._update),_.off("move",this._onClose),_.off("preclick",this._onClose),_.off("click",this._onClose),_.off("remove",this.remove),_.off("mousemove",this._onMouseEvent),_.off("mouseup",this._onMouseEvent),_.off("drag",this._onMouseEvent),_._canvasContainer&&_._canvasContainer.classList.remove("mapboxgl-track-pointer"),_._removePopup(this),this._map=void 0),this.fire(new s.A("close")),this}getLngLat(){return this._lngLat}setLngLat(_){this._lngLat=s.cd.convert(_),this._pos=null,this._trackPointer=!1,this._update();const o=this._map;return o&&(o.on("move",this._update),o.off("mousemove",this._onMouseEvent),o._canvasContainer.classList.remove("mapboxgl-track-pointer")),this}getAltitude(){return this._altitude}setAltitude(_){return this._altitude=_,this._update(),this}trackPointer(){this._trackPointer=!0,this._pos=null,this._update();const _=this._map;return _&&(_.off("move",this._update),_.on("mousemove",this._onMouseEvent),_.on("drag",this._onMouseEvent),_._canvasContainer.classList.add("mapboxgl-track-pointer")),this}getElement(){return this._container}setText(_){return this.setDOMContent(document.createTextNode(_))}setHTML(_){const o=document.createDocumentFragment(),f=document.createElement("body");let y;for(f.innerHTML=_;y=f.firstChild,y;)o.appendChild(y);return this.setDOMContent(o)}getMaxWidth(){return this._container&&this._container.style.maxWidth}setMaxWidth(_){return this.options.maxWidth=_,this._update(),this}setDOMContent(_){let o=this._content;if(o)for(;o.hasChildNodes();)o.firstChild&&o.removeChild(o.firstChild);else o=this._content=X("div","mapboxgl-popup-content",this._container||void 0);if(o.appendChild(_),this.options.closeButton){const f=this._closeButton=X("button","mapboxgl-popup-close-button",o);f.type="button",f.setAttribute("aria-label","Close popup"),f.innerHTML='<span aria-hidden="true">&#215;</span>',f.addEventListener("click",this._onClose)}return this._update(),this._focusFirstElement(),this}addClassName(_){return this._classList.add(_),this._updateClassList(),this}removeClassName(_){return this._classList.delete(_),this._updateClassList(),this}setOffset(_){return this.options.offset=_,this._update(),this}toggleClassName(_){let o;return this._classList.delete(_)?o=!1:(this._classList.add(_),o=!0),this._updateClassList(),o}_onMouseEvent(_){this._update(_.point)}_getAnchor(_){if(this.options.anchor)return this.options.anchor;const o=this._map,f=this._container,y=this._pos;if(!o||!f||!y)return"bottom";const w=f.offsetWidth,E=f.offsetHeight,C=y.x<w/2,M=y.x>o.transform.width-w/2;if(y.y+_<E)return C?"top-left":M?"top-right":"top";if(y.y>o.transform.height-E){if(C)return"bottom-left";if(M)return"bottom-right"}return C?"left":M?"right":"bottom"}_updateClassList(){const _=this._container;if(!_)return;const o=[...this._classList];o.push("mapboxgl-popup"),this._anchor&&o.push(`mapboxgl-popup-anchor-${this._anchor}`),this._trackPointer&&o.push("mapboxgl-popup-track-pointer"),_.className=o.join(" ")}_update(_){const o=this._map,f=this._content;if(!o||!this._lngLat&&!this._trackPointer||!f)return;let y=this._container;if(y||(y=this._container=X("div","mapboxgl-popup",o.getContainer()),this._tip=X("div","mapboxgl-popup-tip",y),y.appendChild(f)),this.options.maxWidth&&y.style.maxWidth!==this.options.maxWidth&&(y.style.maxWidth=this.options.maxWidth),o.transform.renderWorldCopies&&!this._trackPointer&&(this._lngLat=zf(this._lngLat,this._pos,o.transform)),!this._trackPointer||_){const w=this._pos=this._trackPointer&&_ instanceof s.P?_:o.project(this._lngLat,this._altitude),E=Bl(this.options.offset),C=this._anchor=this._getAnchor(E.y),M=Bl(this.options.offset,C),N=w.add(M).round();o._requestDomTask(()=>{this._container&&C&&(this._container.style.transform=`${ls[C]} translate(${N.x}px,${N.y}px)`)})}if(!this._marker&&o._showingGlobe()){const w=s.eK(o.transform,this._lngLat)?0:1;this._setOpacity(w)}this._updateClassList()}_focusFirstElement(){if(!this.options.focusAfterOpen||!this._container)return;const _=this._container.querySelector(dc);_&&_.focus()}_onClose(){this.remove()}_setOpacity(_){this._container&&(this._container.style.opacity=`${_}`),this._content&&(this._content.style.pointerEvents=_?"auto":"none")}},Marker:Rg,Style:Go,LngLat:s.cd,LngLatBounds:s.aG,Point:s.P,MercatorCoordinate:s.ac,FreeCameraOptions:Sp,Evented:s.E,config:s.e,prewarm:s.eO,clearPrewarmedResources:s.eN,get accessToken(){return s.e.ACCESS_TOKEN},set accessToken(_){s.e.ACCESS_TOKEN=_},get baseApiUrl(){return s.e.API_URL},set baseApiUrl(_){s.e.API_URL=_},get workerCount(){return s.eX.workerCount},set workerCount(_){s.eX.workerCount=_},get maxParallelImageRequests(){return s.e.MAX_PARALLEL_IMAGE_REQUESTS},set maxParallelImageRequests(_){s.e.MAX_PARALLEL_IMAGE_REQUESTS=_},clearStorage(_){s.eW(_)},get workerUrl(){return s.eV.workerUrl},set workerUrl(_){s.eV.workerUrl=_},get workerClass(){return s.eV.workerClass},set workerClass(_){s.eV.workerClass=_},get workerParams(){return s.eV.workerParams},set workerParams(_){s.eV.workerParams=_},get dracoUrl(){return s.eU()},set dracoUrl(_){s.eT(_)},get meshoptUrl(){return s.eS()},set meshoptUrl(_){s.eR(_)},setNow:s.q.setNow,restoreNow:s.q.restoreNow}});var m=c;return m})}(KR)),KR.exports}var Fse=Bse();const MP=AA(Fse),Vse=()=>{const t=ke.useRef(null),e=ke.useRef(null),{userProfile:n}=lf(),{currentList:r,addItemToCurrentList:c}=cf(),[d,m]=ke.useState([]),[s,T]=ke.useState(null),[D,P]=ke.useState(!0),[z,F]=ke.useState(null),[$,J]=ke.useState("");ke.useEffect(()=>{if(!t.current||e.current)return;const te="pk.eyJ1IjoicGF1bGFyZTE3IiwiYSI6ImNtYzRrb2V6bjA3aXIyanNkcmt6ZTdlaWwifQ.RjVXYpHpPS6QktfxILyf6Q";try{if(MP.accessToken=te,!(r!=null&&r.postalCode)){F("Selecciona una llista amb codi postal per veure el mapa"),P(!1);return}e.current=new MP.Map({container:t.current,style:"mapbox://styles/mapbox/streets-v12",center:[0,0],zoom:13});const ie=setTimeout(()=>{F("Timeout carregant el mapa"),P(!1)},15e3);return e.current.on("load",()=>{clearTimeout(ie),P(!1),F(null)}),e.current.on("error",()=>{clearTimeout(ie),F("Error carregant el mapa"),P(!1)}),()=>{clearTimeout(ie),e.current&&(e.current.remove(),e.current=null)}}catch(ie){F(`Error: ${ie}`),P(!1)}},[r]),ke.useEffect(()=>{if(!e.current||D||!(r!=null&&r.postalCode))return;let te=!1;return(async()=>{try{const we=await l8.getAllNearbySupermarkets(r.postalCode);if(te)return;if(we.length===0){F(`No s'han trobat supermercats a la zona ${r.postalCode}`);return}if(m(we),document.querySelectorAll(".mapbox-marker").forEach(Ie=>Ie.remove()),we.length>0&&e.current){const Ie=we.reduce((Ne,Xe)=>Ne+Xe.coordinates.lat,0)/we.length,Re=we.reduce((Ne,Xe)=>Ne+Xe.coordinates.lng,0)/we.length;e.current.flyTo({center:[Re,Ie],zoom:13})}we.forEach(Ie=>{const Re=r.items.some(Xe=>{var be;return((be=Xe.supermarket)==null?void 0:be.id)===Ie.id}),Ne=document.createElement("div");Ne.className="mapbox-marker",Re?(Ne.innerHTML="🛒",Ne.style.fontSize="28px",Ne.classList.add("marker-with-products")):(Ne.innerHTML="🏪",Ne.style.fontSize="24px",Ne.classList.add("marker-without-products")),Ne.style.cursor="pointer",Ne.title=Re?`${Ie.name} - Té productes assignats`:`${Ie.name}`,Ne.onclick=()=>{T(Ie),e.current&&e.current.flyTo({center:[Ie.coordinates.lng,Ie.coordinates.lat],zoom:15})},new MP.Marker(Ne).setLngLat([Ie.coordinates.lng,Ie.coordinates.lat]).addTo(e.current)})}catch(we){te||F(`Error carregant supermercats: ${we}`)}})(),()=>{te=!0}},[D,r]);const X=te=>{if(te.preventDefault(),!$.trim()||!s||!r)return;const ie={done:!1,task:$.trim(),supermarket:{id:s.id,name:s.name,chain:s.chain}};c(ie),J("")};return n?r?z?de.jsxDEV("div",{className:"map-page",children:de.jsxDEV("div",{className:"map-header",children:[de.jsxDEV("h2",{children:"🗺️ Mapa de Supermercats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:236,columnNumber:11},void 0),de.jsxDEV("p",{children:["❌ Error: ",z]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:237,columnNumber:11},void 0),de.jsxDEV("button",{onClick:()=>window.location.reload(),children:"🔄 Recarregar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:238,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:235,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:234,columnNumber:7},void 0):de.jsxDEV("div",{className:"map-page",children:[de.jsxDEV("div",{className:"map-header",children:[de.jsxDEV("h2",{children:"🗺️ Mapa de Supermercats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:247,columnNumber:9},void 0),de.jsxDEV("p",{children:["📍 Zona: ",r.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:248,columnNumber:9},void 0),de.jsxDEV("p",{children:["📋 Llista: ",r.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:249,columnNumber:9},void 0),D&&de.jsxDEV("p",{children:"⏳ Carregant mapa..."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:250,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:246,columnNumber:7},void 0),de.jsxDEV("div",{className:"map-legend",children:[de.jsxDEV("div",{className:"legend-item",children:[de.jsxDEV("span",{className:"legend-icon",children:"🏪"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:256,columnNumber:11},void 0),de.jsxDEV("span",{children:"Supermercats disponibles"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:257,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:255,columnNumber:9},void 0),de.jsxDEV("div",{className:"legend-item",children:[de.jsxDEV("span",{className:"legend-icon legend-icon-large",children:"🛒"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:260,columnNumber:11},void 0),de.jsxDEV("span",{children:"Amb productes assignats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:261,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:259,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:254,columnNumber:7},void 0),de.jsxDEV("div",{className:"map-container-wrapper",style:{position:"relative",width:"100%",height:"500px"},children:[D&&de.jsxDEV("div",{className:"map-loading",style:{position:"absolute",top:"50%",left:"50%",transform:"translate(-50%, -50%)",zIndex:1e3,background:"white",padding:"20px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.1)"},children:"Carregant mapa..."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:267,columnNumber:11},void 0),de.jsxDEV("div",{ref:t,className:"map-container",style:{width:"100%",height:"100%"}},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:281,columnNumber:9},void 0),s&&de.jsxDEV("div",{className:"supermarket-popup",style:{position:"absolute",top:"20px",right:"20px",background:"white",padding:"15px",borderRadius:"8px",boxShadow:"0 2px 8px rgba(0,0,0,0.2)",zIndex:1e3,minWidth:"280px",maxWidth:"350px"},children:[de.jsxDEV("div",{className:"popup-header",style:{display:"flex",justifyContent:"space-between",alignItems:"center",marginBottom:"10px"},children:[de.jsxDEV("h3",{style:{margin:0},children:[r.items.some(te=>{var ie;return((ie=te.supermarket)==null?void 0:ie.id)===s.id})?"🛒":"🏪",s.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:301,columnNumber:15},void 0),de.jsxDEV("button",{onClick:()=>T(null),style:{background:"none",border:"none",fontSize:"18px",cursor:"pointer"},children:"✕"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:305,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:300,columnNumber:13},void 0),de.jsxDEV("div",{className:"popup-content",children:[de.jsxDEV("p",{style:{margin:"5px 0"},children:["📍 ",s.address]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:308,columnNumber:15},void 0),de.jsxDEV("div",{style:{marginTop:"12px",marginBottom:"12px",padding:"10px",background:"#f0f8ff",borderRadius:"6px",border:"1px solid #e3f2fd"},children:[de.jsxDEV("h5",{style:{margin:"0 0 8px 0",fontSize:"13px",color:"#1976d2",fontWeight:"600"},children:"➕ Afegir producte aquí"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:312,columnNumber:17},void 0),de.jsxDEV("form",{onSubmit:X,style:{display:"flex",gap:"6px",alignItems:"center"},children:[de.jsxDEV("input",{type:"text",value:$,onChange:te=>J(te.target.value),placeholder:"Nom del producte...",style:{flex:1,padding:"6px 8px",border:"1px solid #ddd",borderRadius:"4px",fontSize:"13px",outline:"none"},onFocus:te=>te.target.style.borderColor="#1976d2",onBlur:te=>te.target.style.borderColor="#ddd"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:316,columnNumber:19},void 0),de.jsxDEV("button",{type:"submit",disabled:!$.trim(),style:{background:$.trim()?"#1976d2":"#ccc",color:"white",border:"none",borderRadius:"4px",padding:"6px 10px",cursor:$.trim()?"pointer":"not-allowed",fontSize:"14px",fontWeight:"600",transition:"background-color 0.2s ease"},children:"➕"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:332,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:315,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:311,columnNumber:15},void 0),(()=>{const te=r.items.filter(ie=>{var we;return((we=ie.supermarket)==null?void 0:we.id)===s.id});return te.length>0?de.jsxDEV("div",{style:{marginTop:"10px",padding:"10px",background:"#f8f9fa",borderRadius:"4px"},children:[de.jsxDEV("h4",{style:{margin:"0 0 8px 0",fontSize:"14px",color:"#28a745"},children:["✅ Productes assignats (",te.length,"):"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:361,columnNumber:23},void 0),de.jsxDEV("ul",{style:{margin:0,paddingLeft:"16px",fontSize:"13px"},children:[te.slice(0,3).map(ie=>de.jsxDEV("li",{style:{textDecoration:ie.done?"line-through":"none",color:ie.done?"#6c757d":"inherit"},children:[ie.task," ",ie.done?"✓":""]},ie.id,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:366,columnNumber:27},void 0)),te.length>3&&de.jsxDEV("li",{style:{fontStyle:"italic",color:"#6c757d"},children:["... i ",te.length-3," més"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:374,columnNumber:27},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:364,columnNumber:23},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:360,columnNumber:21},void 0):null})(),de.jsxDEV("button",{onClick:()=>window.location.href="/pendents",style:{background:"#007bff",color:"white",border:"none",padding:"8px 16px",borderRadius:"4px",cursor:"pointer",marginTop:"10px",width:"100%"},children:"📋 Gestionar llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:385,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:307,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:288,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:265,columnNumber:7},void 0),de.jsxDEV("div",{className:"map-info",children:[de.jsxDEV("span",{children:["🏪 ",d.length," supermercats"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:406,columnNumber:9},void 0),de.jsxDEV("span",{children:["🛒 ",d.filter(te=>r.items.some(ie=>{var we;return((we=ie.supermarket)==null?void 0:we.id)===te.id})).length," amb productes"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:407,columnNumber:9},void 0),de.jsxDEV("span",{children:["📝 ",r.items.filter(te=>!te.done).length," pendents"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:408,columnNumber:9},void 0),de.jsxDEV("span",{children:["✅ ",r.items.filter(te=>te.done).length," comprats"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:409,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:405,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:245,columnNumber:5},void 0):de.jsxDEV(wx,{pageTitle:"Mapa de Supermercats",pageIcon:"🗺️",description:"Selecciona una llista amb codi postal per veure el mapa dels supermercats de la zona i poder afegir productes directament des del mapa."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:224,columnNumber:7},void 0):de.jsxDEV(wx,{pageTitle:"Mapa de Supermercats",pageIcon:"🗺️",description:"Inicia sessió per veure el mapa dels supermercats de la teva zona.",showCreateJoinButtons:!1},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/MapPage.tsx",lineNumber:213,columnNumber:7},void 0)};/*!
 * @kurkle/color v0.3.4
 * https://github.com/kurkle/color#readme
 * (c) 2024 Jukka Kurkela
 * Released under the MIT License
 */function tC(t){return t+.5|0}const kv=(t,e,n)=>Math.max(Math.min(t,n),e);function IS(t){return kv(tC(t*2.55),0,255)}function qv(t){return kv(tC(t*255),0,255)}function g_(t){return kv(tC(t/2.55)/100,0,1)}function SF(t){return kv(tC(t*100),0,100)}const Yd={0:0,1:1,2:2,3:3,4:4,5:5,6:6,7:7,8:8,9:9,A:10,B:11,C:12,D:13,E:14,F:15,a:10,b:11,c:12,d:13,e:14,f:15},cN=[..."0123456789ABCDEF"],Use=t=>cN[t&15],jse=t=>cN[(t&240)>>4]+cN[t&15],hR=t=>(t&240)>>4===(t&15),Hse=t=>hR(t.r)&&hR(t.g)&&hR(t.b)&&hR(t.a);function $se(t){var e=t.length,n;return t[0]==="#"&&(e===4||e===5?n={r:255&Yd[t[1]]*17,g:255&Yd[t[2]]*17,b:255&Yd[t[3]]*17,a:e===5?Yd[t[4]]*17:255}:(e===7||e===9)&&(n={r:Yd[t[1]]<<4|Yd[t[2]],g:Yd[t[3]]<<4|Yd[t[4]],b:Yd[t[5]]<<4|Yd[t[6]],a:e===9?Yd[t[7]]<<4|Yd[t[8]]:255})),n}const Gse=(t,e)=>t<255?e(t):"";function qse(t){var e=Hse(t)?Use:jse;return t?"#"+e(t.r)+e(t.g)+e(t.b)+Gse(t.a,e):void 0}const Wse=/^(hsla?|hwb|hsv)\(\s*([-+.e\d]+)(?:deg)?[\s,]+([-+.e\d]+)%[\s,]+([-+.e\d]+)%(?:[\s,]+([-+.e\d]+)(%)?)?\s*\)$/;function p8(t,e,n){const r=e*Math.min(n,1-n),c=(d,m=(d+t/30)%12)=>n-r*Math.max(Math.min(m-3,9-m,1),-1);return[c(0),c(8),c(4)]}function Yse(t,e,n){const r=(c,d=(c+t/60)%6)=>n-n*e*Math.max(Math.min(d,4-d,1),0);return[r(5),r(3),r(1)]}function Zse(t,e,n){const r=p8(t,1,.5);let c;for(e+n>1&&(c=1/(e+n),e*=c,n*=c),c=0;c<3;c++)r[c]*=1-e-n,r[c]+=e;return r}function Xse(t,e,n,r,c){return t===c?(e-n)/r+(e<n?6:0):e===c?(n-t)/r+2:(t-e)/r+4}function cL(t){const n=t.r/255,r=t.g/255,c=t.b/255,d=Math.max(n,r,c),m=Math.min(n,r,c),s=(d+m)/2;let T,D,P;return d!==m&&(P=d-m,D=s>.5?P/(2-d-m):P/(d+m),T=Xse(n,r,c,P,d),T=T*60+.5),[T|0,D||0,s]}function uL(t,e,n,r){return(Array.isArray(e)?t(e[0],e[1],e[2]):t(e,n,r)).map(qv)}function hL(t,e,n){return uL(p8,t,e,n)}function Qse(t,e,n){return uL(Zse,t,e,n)}function Kse(t,e,n){return uL(Yse,t,e,n)}function m8(t){return(t%360+360)%360}function Jse(t){const e=Wse.exec(t);let n=255,r;if(!e)return;e[5]!==r&&(n=e[6]?IS(+e[5]):qv(+e[5]));const c=m8(+e[2]),d=+e[3]/100,m=+e[4]/100;return e[1]==="hwb"?r=Qse(c,d,m):e[1]==="hsv"?r=Kse(c,d,m):r=hL(c,d,m),{r:r[0],g:r[1],b:r[2],a:n}}function eoe(t,e){var n=cL(t);n[0]=m8(n[0]+e),n=hL(n),t.r=n[0],t.g=n[1],t.b=n[2]}function toe(t){if(!t)return;const e=cL(t),n=e[0],r=SF(e[1]),c=SF(e[2]);return t.a<255?`hsla(${n}, ${r}%, ${c}%, ${g_(t.a)})`:`hsl(${n}, ${r}%, ${c}%)`}const AF={x:"dark",Z:"light",Y:"re",X:"blu",W:"gr",V:"medium",U:"slate",A:"ee",T:"ol",S:"or",B:"ra",C:"lateg",D:"ights",R:"in",Q:"turquois",E:"hi",P:"ro",O:"al",N:"le",M:"de",L:"yello",F:"en",K:"ch",G:"arks",H:"ea",I:"ightg",J:"wh"},CF={OiceXe:"f0f8ff",antiquewEte:"faebd7",aqua:"ffff",aquamarRe:"7fffd4",azuY:"f0ffff",beige:"f5f5dc",bisque:"ffe4c4",black:"0",blanKedOmond:"ffebcd",Xe:"ff",XeviTet:"8a2be2",bPwn:"a52a2a",burlywood:"deb887",caMtXe:"5f9ea0",KartYuse:"7fff00",KocTate:"d2691e",cSO:"ff7f50",cSnflowerXe:"6495ed",cSnsilk:"fff8dc",crimson:"dc143c",cyan:"ffff",xXe:"8b",xcyan:"8b8b",xgTMnPd:"b8860b",xWay:"a9a9a9",xgYF:"6400",xgYy:"a9a9a9",xkhaki:"bdb76b",xmagFta:"8b008b",xTivegYF:"556b2f",xSange:"ff8c00",xScEd:"9932cc",xYd:"8b0000",xsOmon:"e9967a",xsHgYF:"8fbc8f",xUXe:"483d8b",xUWay:"2f4f4f",xUgYy:"2f4f4f",xQe:"ced1",xviTet:"9400d3",dAppRk:"ff1493",dApskyXe:"bfff",dimWay:"696969",dimgYy:"696969",dodgerXe:"1e90ff",fiYbrick:"b22222",flSOwEte:"fffaf0",foYstWAn:"228b22",fuKsia:"ff00ff",gaRsbSo:"dcdcdc",ghostwEte:"f8f8ff",gTd:"ffd700",gTMnPd:"daa520",Way:"808080",gYF:"8000",gYFLw:"adff2f",gYy:"808080",honeyMw:"f0fff0",hotpRk:"ff69b4",RdianYd:"cd5c5c",Rdigo:"4b0082",ivSy:"fffff0",khaki:"f0e68c",lavFMr:"e6e6fa",lavFMrXsh:"fff0f5",lawngYF:"7cfc00",NmoncEffon:"fffacd",ZXe:"add8e6",ZcSO:"f08080",Zcyan:"e0ffff",ZgTMnPdLw:"fafad2",ZWay:"d3d3d3",ZgYF:"90ee90",ZgYy:"d3d3d3",ZpRk:"ffb6c1",ZsOmon:"ffa07a",ZsHgYF:"20b2aa",ZskyXe:"87cefa",ZUWay:"778899",ZUgYy:"778899",ZstAlXe:"b0c4de",ZLw:"ffffe0",lime:"ff00",limegYF:"32cd32",lRF:"faf0e6",magFta:"ff00ff",maPon:"800000",VaquamarRe:"66cdaa",VXe:"cd",VScEd:"ba55d3",VpurpN:"9370db",VsHgYF:"3cb371",VUXe:"7b68ee",VsprRggYF:"fa9a",VQe:"48d1cc",VviTetYd:"c71585",midnightXe:"191970",mRtcYam:"f5fffa",mistyPse:"ffe4e1",moccasR:"ffe4b5",navajowEte:"ffdead",navy:"80",Tdlace:"fdf5e6",Tive:"808000",TivedBb:"6b8e23",Sange:"ffa500",SangeYd:"ff4500",ScEd:"da70d6",pOegTMnPd:"eee8aa",pOegYF:"98fb98",pOeQe:"afeeee",pOeviTetYd:"db7093",papayawEp:"ffefd5",pHKpuff:"ffdab9",peru:"cd853f",pRk:"ffc0cb",plum:"dda0dd",powMrXe:"b0e0e6",purpN:"800080",YbeccapurpN:"663399",Yd:"ff0000",Psybrown:"bc8f8f",PyOXe:"4169e1",saddNbPwn:"8b4513",sOmon:"fa8072",sandybPwn:"f4a460",sHgYF:"2e8b57",sHshell:"fff5ee",siFna:"a0522d",silver:"c0c0c0",skyXe:"87ceeb",UXe:"6a5acd",UWay:"708090",UgYy:"708090",snow:"fffafa",sprRggYF:"ff7f",stAlXe:"4682b4",tan:"d2b48c",teO:"8080",tEstN:"d8bfd8",tomato:"ff6347",Qe:"40e0d0",viTet:"ee82ee",JHt:"f5deb3",wEte:"ffffff",wEtesmoke:"f5f5f5",Lw:"ffff00",LwgYF:"9acd32"};function noe(){const t={},e=Object.keys(CF),n=Object.keys(AF);let r,c,d,m,s;for(r=0;r<e.length;r++){for(m=s=e[r],c=0;c<n.length;c++)d=n[c],s=s.replace(d,AF[d]);d=parseInt(CF[m],16),t[s]=[d>>16&255,d>>8&255,d&255]}return t}let dR;function ioe(t){dR||(dR=noe(),dR.transparent=[0,0,0,0]);const e=dR[t.toLowerCase()];return e&&{r:e[0],g:e[1],b:e[2],a:e.length===4?e[3]:255}}const roe=/^rgba?\(\s*([-+.\d]+)(%)?[\s,]+([-+.e\d]+)(%)?[\s,]+([-+.e\d]+)(%)?(?:[\s,/]+([-+.e\d]+)(%)?)?\s*\)$/;function soe(t){const e=roe.exec(t);let n=255,r,c,d;if(e){if(e[7]!==r){const m=+e[7];n=e[8]?IS(m):kv(m*255,0,255)}return r=+e[1],c=+e[3],d=+e[5],r=255&(e[2]?IS(r):kv(r,0,255)),c=255&(e[4]?IS(c):kv(c,0,255)),d=255&(e[6]?IS(d):kv(d,0,255)),{r,g:c,b:d,a:n}}}function ooe(t){return t&&(t.a<255?`rgba(${t.r}, ${t.g}, ${t.b}, ${g_(t.a)})`:`rgb(${t.r}, ${t.g}, ${t.b})`)}const PP=t=>t<=.0031308?t*12.92:Math.pow(t,1/2.4)*1.055-.055,vw=t=>t<=.04045?t/12.92:Math.pow((t+.055)/1.055,2.4);function aoe(t,e,n){const r=vw(g_(t.r)),c=vw(g_(t.g)),d=vw(g_(t.b));return{r:qv(PP(r+n*(vw(g_(e.r))-r))),g:qv(PP(c+n*(vw(g_(e.g))-c))),b:qv(PP(d+n*(vw(g_(e.b))-d))),a:t.a+n*(e.a-t.a)}}function fR(t,e,n){if(t){let r=cL(t);r[e]=Math.max(0,Math.min(r[e]+r[e]*n,e===0?360:1)),r=hL(r),t.r=r[0],t.g=r[1],t.b=r[2]}}function g8(t,e){return t&&Object.assign(e||{},t)}function DF(t){var e={r:0,g:0,b:0,a:255};return Array.isArray(t)?t.length>=3&&(e={r:t[0],g:t[1],b:t[2],a:255},t.length>3&&(e.a=qv(t[3]))):(e=g8(t,{r:0,g:0,b:0,a:1}),e.a=qv(e.a)),e}function loe(t){return t.charAt(0)==="r"?soe(t):Jse(t)}class _A{constructor(e){if(e instanceof _A)return e;const n=typeof e;let r;n==="object"?r=DF(e):n==="string"&&(r=$se(e)||ioe(e)||loe(e)),this._rgb=r,this._valid=!!r}get valid(){return this._valid}get rgb(){var e=g8(this._rgb);return e&&(e.a=g_(e.a)),e}set rgb(e){this._rgb=DF(e)}rgbString(){return this._valid?ooe(this._rgb):void 0}hexString(){return this._valid?qse(this._rgb):void 0}hslString(){return this._valid?toe(this._rgb):void 0}mix(e,n){if(e){const r=this.rgb,c=e.rgb;let d;const m=n===d?.5:n,s=2*m-1,T=r.a-c.a,D=((s*T===-1?s:(s+T)/(1+s*T))+1)/2;d=1-D,r.r=255&D*r.r+d*c.r+.5,r.g=255&D*r.g+d*c.g+.5,r.b=255&D*r.b+d*c.b+.5,r.a=m*r.a+(1-m)*c.a,this.rgb=r}return this}interpolate(e,n){return e&&(this._rgb=aoe(this._rgb,e._rgb,n)),this}clone(){return new _A(this.rgb)}alpha(e){return this._rgb.a=qv(e),this}clearer(e){const n=this._rgb;return n.a*=1-e,this}greyscale(){const e=this._rgb,n=tC(e.r*.3+e.g*.59+e.b*.11);return e.r=e.g=e.b=n,this}opaquer(e){const n=this._rgb;return n.a*=1+e,this}negate(){const e=this._rgb;return e.r=255-e.r,e.g=255-e.g,e.b=255-e.b,this}lighten(e){return fR(this._rgb,2,e),this}darken(e){return fR(this._rgb,2,-e),this}saturate(e){return fR(this._rgb,1,e),this}desaturate(e){return fR(this._rgb,1,-e),this}rotate(e){return eoe(this._rgb,e),this}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */function d_(){}const coe=(()=>{let t=0;return()=>t++})();function no(t){return t==null}function sl(t){if(Array.isArray&&Array.isArray(t))return!0;const e=Object.prototype.toString.call(t);return e.slice(0,7)==="[object"&&e.slice(-6)==="Array]"}function _s(t){return t!==null&&Object.prototype.toString.call(t)==="[object Object]"}function sf(t){return(typeof t=="number"||t instanceof Number)&&isFinite(+t)}function Cm(t,e){return sf(t)?t:e}function gs(t,e){return typeof t>"u"?e:t}const uoe=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100:+t/e,_8=(t,e)=>typeof t=="string"&&t.endsWith("%")?parseFloat(t)/100*e:+t;function vo(t,e,n){if(t&&typeof t.call=="function")return t.apply(n,e)}function Gs(t,e,n,r){let c,d,m;if(sl(t))for(d=t.length,c=0;c<d;c++)e.call(n,t[c],c);else if(_s(t))for(m=Object.keys(t),d=m.length,c=0;c<d;c++)e.call(n,t[m[c]],m[c])}function HO(t,e){let n,r,c,d;if(!t||!e||t.length!==e.length)return!1;for(n=0,r=t.length;n<r;++n)if(c=t[n],d=e[n],c.datasetIndex!==d.datasetIndex||c.index!==d.index)return!1;return!0}function $O(t){if(sl(t))return t.map($O);if(_s(t)){const e=Object.create(null),n=Object.keys(t),r=n.length;let c=0;for(;c<r;++c)e[n[c]]=$O(t[n[c]]);return e}return t}function y8(t){return["__proto__","prototype","constructor"].indexOf(t)===-1}function hoe(t,e,n,r){if(!y8(t))return;const c=e[t],d=n[t];_s(c)&&_s(d)?yA(c,d,r):e[t]=$O(d)}function yA(t,e,n){const r=sl(e)?e:[e],c=r.length;if(!_s(t))return t;n=n||{};const d=n.merger||hoe;let m;for(let s=0;s<c;++s){if(m=r[s],!_s(m))continue;const T=Object.keys(m);for(let D=0,P=T.length;D<P;++D)d(T[D],t,m,n)}return t}function qS(t,e){return yA(t,e,{merger:doe})}function doe(t,e,n){if(!y8(t))return;const r=e[t],c=n[t];_s(r)&&_s(c)?qS(r,c):Object.prototype.hasOwnProperty.call(e,t)||(e[t]=$O(c))}const RF={"":t=>t,x:t=>t.x,y:t=>t.y};function foe(t){const e=t.split("."),n=[];let r="";for(const c of e)r+=c,r.endsWith("\\")?r=r.slice(0,-1)+".":(n.push(r),r="");return n}function poe(t){const e=foe(t);return n=>{for(const r of e){if(r==="")break;n=n&&n[r]}return n}}function Tx(t,e){return(RF[e]||(RF[e]=poe(e)))(t)}function dL(t){return t.charAt(0).toUpperCase()+t.slice(1)}const vA=t=>typeof t<"u",i0=t=>typeof t=="function",OF=(t,e)=>{if(t.size!==e.size)return!1;for(const n of t)if(!e.has(n))return!1;return!0};function moe(t){return t.type==="mouseup"||t.type==="click"||t.type==="contextmenu"}const to=Math.PI,Fa=2*to,GO=Number.POSITIVE_INFINITY,goe=to/180,ol=to/2,Wb=to/4,IF=to*2/3,v8=Math.log10,Wv=Math.sign;function JR(t,e,n){return Math.abs(t-e)<n}function MF(t){const e=Math.round(t);t=JR(t,e,t/1e3)?e:t;const n=Math.pow(10,Math.floor(v8(t))),r=t/n;return(r<=1?1:r<=2?2:r<=5?5:10)*n}function _oe(t){const e=[],n=Math.sqrt(t);let r;for(r=1;r<n;r++)t%r===0&&(e.push(r),e.push(t/r));return n===(n|0)&&e.push(n),e.sort((c,d)=>c-d).pop(),e}function yoe(t){return typeof t=="symbol"||typeof t=="object"&&t!==null&&!(Symbol.toPrimitive in t||"toString"in t||"valueOf"in t)}function qO(t){return!yoe(t)&&!isNaN(parseFloat(t))&&isFinite(t)}function voe(t,e){const n=Math.round(t);return n-e<=t&&n+e>=t}function boe(t,e,n){let r,c,d;for(r=0,c=t.length;r<c;r++)d=t[r][n],isNaN(d)||(e.min=Math.min(e.min,d),e.max=Math.max(e.max,d))}function v_(t){return t*(to/180)}function xoe(t){return t*(180/to)}function PF(t){if(!sf(t))return;let e=1,n=0;for(;Math.round(t*e)/e!==t;)e*=10,n++;return n}function b8(t,e){const n=e.x-t.x,r=e.y-t.y,c=Math.sqrt(n*n+r*r);let d=Math.atan2(r,n);return d<-.5*to&&(d+=Fa),{angle:d,distance:c}}function woe(t,e){return Math.sqrt(Math.pow(e.x-t.x,2)+Math.pow(e.y-t.y,2))}function km(t){return(t%Fa+Fa)%Fa}function WO(t,e,n,r){const c=km(t),d=km(e),m=km(n),s=km(d-c),T=km(m-c),D=km(c-d),P=km(c-m);return c===d||c===m||r&&d===m||s>T&&D<P}function $u(t,e,n){return Math.max(e,Math.min(n,t))}function Toe(t){return $u(t,-32768,32767)}function ox(t,e,n,r=1e-6){return t>=Math.min(e,n)-r&&t<=Math.max(e,n)+r}function fL(t,e,n){n=n||(m=>t[m]<e);let r=t.length-1,c=0,d;for(;r-c>1;)d=c+r>>1,n(d)?c=d:r=d;return{lo:c,hi:r}}const uN=(t,e,n,r)=>fL(t,n,r?c=>{const d=t[c][e];return d<n||d===n&&t[c+1][e]===n}:c=>t[c][e]<n),Eoe=(t,e,n)=>fL(t,n,r=>t[r][e]>=n);function Soe(t,e,n){let r=0,c=t.length;for(;r<c&&t[r]<e;)r++;for(;c>r&&t[c-1]>n;)c--;return r>0||c<t.length?t.slice(r,c):t}const x8=["push","pop","shift","splice","unshift"];function Aoe(t,e){if(t._chartjs){t._chartjs.listeners.push(e);return}Object.defineProperty(t,"_chartjs",{configurable:!0,enumerable:!1,value:{listeners:[e]}}),x8.forEach(n=>{const r="_onData"+dL(n),c=t[n];Object.defineProperty(t,n,{configurable:!0,enumerable:!1,value(...d){const m=c.apply(this,d);return t._chartjs.listeners.forEach(s=>{typeof s[r]=="function"&&s[r](...d)}),m}})})}function kF(t,e){const n=t._chartjs;if(!n)return;const r=n.listeners,c=r.indexOf(e);c!==-1&&r.splice(c,1),!(r.length>0)&&(x8.forEach(d=>{delete t[d]}),delete t._chartjs)}function w8(t){const e=new Set(t);return e.size===t.length?t:Array.from(e)}const T8=function(){return typeof window>"u"?function(t){return t()}:window.requestAnimationFrame}();function E8(t,e){let n=[],r=!1;return function(...c){n=c,r||(r=!0,T8.call(window,()=>{r=!1,t.apply(e,n)}))}}function Coe(t,e){let n;return function(...r){return e?(clearTimeout(n),n=setTimeout(t,e,r)):t.apply(this,r),e}}const pL=t=>t==="start"?"left":t==="end"?"right":"center",Pc=(t,e,n)=>t==="start"?e:t==="end"?n:(e+n)/2,Doe=(t,e,n,r)=>t===(r?"left":"right")?n:t==="center"?(e+n)/2:e,pR=t=>t===0||t===1,NF=(t,e,n)=>-(Math.pow(2,10*(t-=1))*Math.sin((t-e)*Fa/n)),LF=(t,e,n)=>Math.pow(2,-10*t)*Math.sin((t-e)*Fa/n)+1,WS={linear:t=>t,easeInQuad:t=>t*t,easeOutQuad:t=>-t*(t-2),easeInOutQuad:t=>(t/=.5)<1?.5*t*t:-.5*(--t*(t-2)-1),easeInCubic:t=>t*t*t,easeOutCubic:t=>(t-=1)*t*t+1,easeInOutCubic:t=>(t/=.5)<1?.5*t*t*t:.5*((t-=2)*t*t+2),easeInQuart:t=>t*t*t*t,easeOutQuart:t=>-((t-=1)*t*t*t-1),easeInOutQuart:t=>(t/=.5)<1?.5*t*t*t*t:-.5*((t-=2)*t*t*t-2),easeInQuint:t=>t*t*t*t*t,easeOutQuint:t=>(t-=1)*t*t*t*t+1,easeInOutQuint:t=>(t/=.5)<1?.5*t*t*t*t*t:.5*((t-=2)*t*t*t*t+2),easeInSine:t=>-Math.cos(t*ol)+1,easeOutSine:t=>Math.sin(t*ol),easeInOutSine:t=>-.5*(Math.cos(to*t)-1),easeInExpo:t=>t===0?0:Math.pow(2,10*(t-1)),easeOutExpo:t=>t===1?1:-Math.pow(2,-10*t)+1,easeInOutExpo:t=>pR(t)?t:t<.5?.5*Math.pow(2,10*(t*2-1)):.5*(-Math.pow(2,-10*(t*2-1))+2),easeInCirc:t=>t>=1?t:-(Math.sqrt(1-t*t)-1),easeOutCirc:t=>Math.sqrt(1-(t-=1)*t),easeInOutCirc:t=>(t/=.5)<1?-.5*(Math.sqrt(1-t*t)-1):.5*(Math.sqrt(1-(t-=2)*t)+1),easeInElastic:t=>pR(t)?t:NF(t,.075,.3),easeOutElastic:t=>pR(t)?t:LF(t,.075,.3),easeInOutElastic(t){return pR(t)?t:t<.5?.5*NF(t*2,.1125,.45):.5+.5*LF(t*2-1,.1125,.45)},easeInBack(t){return t*t*((1.70158+1)*t-1.70158)},easeOutBack(t){return(t-=1)*t*((1.70158+1)*t+1.70158)+1},easeInOutBack(t){let e=1.70158;return(t/=.5)<1?.5*(t*t*(((e*=1.525)+1)*t-e)):.5*((t-=2)*t*(((e*=1.525)+1)*t+e)+2)},easeInBounce:t=>1-WS.easeOutBounce(1-t),easeOutBounce(t){return t<1/2.75?7.5625*t*t:t<2/2.75?7.5625*(t-=1.5/2.75)*t+.75:t<2.5/2.75?7.5625*(t-=2.25/2.75)*t+.9375:7.5625*(t-=2.625/2.75)*t+.984375},easeInOutBounce:t=>t<.5?WS.easeInBounce(t*2)*.5:WS.easeOutBounce(t*2-1)*.5+.5};function S8(t){if(t&&typeof t=="object"){const e=t.toString();return e==="[object CanvasPattern]"||e==="[object CanvasGradient]"}return!1}function zF(t){return S8(t)?t:new _A(t)}function kP(t){return S8(t)?t:new _A(t).saturate(.5).darken(.1).hexString()}const Roe=["x","y","borderWidth","radius","tension"],Ooe=["color","borderColor","backgroundColor"];function Ioe(t){t.set("animation",{delay:void 0,duration:1e3,easing:"easeOutQuart",fn:void 0,from:void 0,loop:void 0,to:void 0,type:void 0}),t.describe("animation",{_fallback:!1,_indexable:!1,_scriptable:e=>e!=="onProgress"&&e!=="onComplete"&&e!=="fn"}),t.set("animations",{colors:{type:"color",properties:Ooe},numbers:{type:"number",properties:Roe}}),t.describe("animations",{_fallback:"animation"}),t.set("transitions",{active:{animation:{duration:400}},resize:{animation:{duration:0}},show:{animations:{colors:{from:"transparent"},visible:{type:"boolean",duration:0}}},hide:{animations:{colors:{to:"transparent"},visible:{type:"boolean",easing:"linear",fn:e=>e|0}}}})}function Moe(t){t.set("layout",{autoPadding:!0,padding:{top:0,right:0,bottom:0,left:0}})}const BF=new Map;function Poe(t,e){e=e||{};const n=t+JSON.stringify(e);let r=BF.get(n);return r||(r=new Intl.NumberFormat(t,e),BF.set(n,r)),r}function mL(t,e,n){return Poe(e,n).format(t)}const koe={values(t){return sl(t)?t:""+t},numeric(t,e,n){if(t===0)return"0";const r=this.chart.options.locale;let c,d=t;if(n.length>1){const D=Math.max(Math.abs(n[0].value),Math.abs(n[n.length-1].value));(D<1e-4||D>1e15)&&(c="scientific"),d=Noe(t,n)}const m=v8(Math.abs(d)),s=isNaN(m)?1:Math.max(Math.min(-1*Math.floor(m),20),0),T={notation:c,minimumFractionDigits:s,maximumFractionDigits:s};return Object.assign(T,this.options.ticks.format),mL(t,r,T)}};function Noe(t,e){let n=e.length>3?e[2].value-e[1].value:e[1].value-e[0].value;return Math.abs(n)>=1&&t!==Math.floor(t)&&(n=t-Math.floor(t)),n}var A8={formatters:koe};function Loe(t){t.set("scale",{display:!0,offset:!1,reverse:!1,beginAtZero:!1,bounds:"ticks",clip:!0,grace:0,grid:{display:!0,lineWidth:1,drawOnChartArea:!0,drawTicks:!0,tickLength:8,tickWidth:(e,n)=>n.lineWidth,tickColor:(e,n)=>n.color,offset:!1},border:{display:!0,dash:[],dashOffset:0,width:1},title:{display:!1,text:"",padding:{top:4,bottom:4}},ticks:{minRotation:0,maxRotation:50,mirror:!1,textStrokeWidth:0,textStrokeColor:"",padding:3,display:!0,autoSkip:!0,autoSkipPadding:3,labelOffset:0,callback:A8.formatters.values,minor:{},major:{},align:"center",crossAlign:"near",showLabelBackdrop:!1,backdropColor:"rgba(255, 255, 255, 0.75)",backdropPadding:2}}),t.route("scale.ticks","color","","color"),t.route("scale.grid","color","","borderColor"),t.route("scale.border","color","","borderColor"),t.route("scale.title","color","","color"),t.describe("scale",{_fallback:!1,_scriptable:e=>!e.startsWith("before")&&!e.startsWith("after")&&e!=="callback"&&e!=="parser",_indexable:e=>e!=="borderDash"&&e!=="tickBorderDash"&&e!=="dash"}),t.describe("scales",{_fallback:"scale"}),t.describe("scale.ticks",{_scriptable:e=>e!=="backdropPadding"&&e!=="callback",_indexable:e=>e!=="backdropPadding"})}const Ex=Object.create(null),hN=Object.create(null);function YS(t,e){if(!e)return t;const n=e.split(".");for(let r=0,c=n.length;r<c;++r){const d=n[r];t=t[d]||(t[d]=Object.create(null))}return t}function NP(t,e,n){return typeof e=="string"?yA(YS(t,e),n):yA(YS(t,""),e)}class zoe{constructor(e,n){this.animation=void 0,this.backgroundColor="rgba(0,0,0,0.1)",this.borderColor="rgba(0,0,0,0.1)",this.color="#666",this.datasets={},this.devicePixelRatio=r=>r.chart.platform.getDevicePixelRatio(),this.elements={},this.events=["mousemove","mouseout","click","touchstart","touchmove"],this.font={family:"'Helvetica Neue', 'Helvetica', 'Arial', sans-serif",size:12,style:"normal",lineHeight:1.2,weight:null},this.hover={},this.hoverBackgroundColor=(r,c)=>kP(c.backgroundColor),this.hoverBorderColor=(r,c)=>kP(c.borderColor),this.hoverColor=(r,c)=>kP(c.color),this.indexAxis="x",this.interaction={mode:"nearest",intersect:!0,includeInvisible:!1},this.maintainAspectRatio=!0,this.onHover=null,this.onClick=null,this.parsing=!0,this.plugins={},this.responsive=!0,this.scale=void 0,this.scales={},this.showLine=!0,this.drawActiveElementsOnTop=!0,this.describe(e),this.apply(n)}set(e,n){return NP(this,e,n)}get(e){return YS(this,e)}describe(e,n){return NP(hN,e,n)}override(e,n){return NP(Ex,e,n)}route(e,n,r,c){const d=YS(this,e),m=YS(this,r),s="_"+n;Object.defineProperties(d,{[s]:{value:d[n],writable:!0},[n]:{enumerable:!0,get(){const T=this[s],D=m[c];return _s(T)?Object.assign({},D,T):gs(T,D)},set(T){this[s]=T}}})}apply(e){e.forEach(n=>n(this))}}var ga=new zoe({_scriptable:t=>!t.startsWith("on"),_indexable:t=>t!=="events",hover:{_fallback:"interaction"},interaction:{_scriptable:!1,_indexable:!1}},[Ioe,Moe,Loe]);function Boe(t){return!t||no(t.size)||no(t.family)?null:(t.style?t.style+" ":"")+(t.weight?t.weight+" ":"")+t.size+"px "+t.family}function FF(t,e,n,r,c){let d=e[c];return d||(d=e[c]=t.measureText(c).width,n.push(c)),d>r&&(r=d),r}function Yb(t,e,n){const r=t.currentDevicePixelRatio,c=n!==0?Math.max(n/2,.5):0;return Math.round((e-c)*r)/r+c}function VF(t,e){!e&&!t||(e=e||t.getContext("2d"),e.save(),e.resetTransform(),e.clearRect(0,0,t.width,t.height),e.restore())}function UF(t,e,n,r){C8(t,e,n,r,null)}function C8(t,e,n,r,c){let d,m,s,T,D,P,z,F;const $=e.pointStyle,J=e.rotation,X=e.radius;let te=(J||0)*goe;if($&&typeof $=="object"&&(d=$.toString(),d==="[object HTMLImageElement]"||d==="[object HTMLCanvasElement]")){t.save(),t.translate(n,r),t.rotate(te),t.drawImage($,-$.width/2,-$.height/2,$.width,$.height),t.restore();return}if(!(isNaN(X)||X<=0)){switch(t.beginPath(),$){default:c?t.ellipse(n,r,c/2,X,0,0,Fa):t.arc(n,r,X,0,Fa),t.closePath();break;case"triangle":P=c?c/2:X,t.moveTo(n+Math.sin(te)*P,r-Math.cos(te)*X),te+=IF,t.lineTo(n+Math.sin(te)*P,r-Math.cos(te)*X),te+=IF,t.lineTo(n+Math.sin(te)*P,r-Math.cos(te)*X),t.closePath();break;case"rectRounded":D=X*.516,T=X-D,m=Math.cos(te+Wb)*T,z=Math.cos(te+Wb)*(c?c/2-D:T),s=Math.sin(te+Wb)*T,F=Math.sin(te+Wb)*(c?c/2-D:T),t.arc(n-z,r-s,D,te-to,te-ol),t.arc(n+F,r-m,D,te-ol,te),t.arc(n+z,r+s,D,te,te+ol),t.arc(n-F,r+m,D,te+ol,te+to),t.closePath();break;case"rect":if(!J){T=Math.SQRT1_2*X,P=c?c/2:T,t.rect(n-P,r-T,2*P,2*T);break}te+=Wb;case"rectRot":z=Math.cos(te)*(c?c/2:X),m=Math.cos(te)*X,s=Math.sin(te)*X,F=Math.sin(te)*(c?c/2:X),t.moveTo(n-z,r-s),t.lineTo(n+F,r-m),t.lineTo(n+z,r+s),t.lineTo(n-F,r+m),t.closePath();break;case"crossRot":te+=Wb;case"cross":z=Math.cos(te)*(c?c/2:X),m=Math.cos(te)*X,s=Math.sin(te)*X,F=Math.sin(te)*(c?c/2:X),t.moveTo(n-z,r-s),t.lineTo(n+z,r+s),t.moveTo(n+F,r-m),t.lineTo(n-F,r+m);break;case"star":z=Math.cos(te)*(c?c/2:X),m=Math.cos(te)*X,s=Math.sin(te)*X,F=Math.sin(te)*(c?c/2:X),t.moveTo(n-z,r-s),t.lineTo(n+z,r+s),t.moveTo(n+F,r-m),t.lineTo(n-F,r+m),te+=Wb,z=Math.cos(te)*(c?c/2:X),m=Math.cos(te)*X,s=Math.sin(te)*X,F=Math.sin(te)*(c?c/2:X),t.moveTo(n-z,r-s),t.lineTo(n+z,r+s),t.moveTo(n+F,r-m),t.lineTo(n-F,r+m);break;case"line":m=c?c/2:Math.cos(te)*X,s=Math.sin(te)*X,t.moveTo(n-m,r-s),t.lineTo(n+m,r+s);break;case"dash":t.moveTo(n,r),t.lineTo(n+Math.cos(te)*(c?c/2:X),r+Math.sin(te)*X);break;case!1:t.closePath();break}t.fill(),e.borderWidth>0&&t.stroke()}}function D8(t,e,n){return n=n||.5,!e||t&&t.x>e.left-n&&t.x<e.right+n&&t.y>e.top-n&&t.y<e.bottom+n}function gL(t,e){t.save(),t.beginPath(),t.rect(e.left,e.top,e.right-e.left,e.bottom-e.top),t.clip()}function _L(t){t.restore()}function Foe(t,e){e.translation&&t.translate(e.translation[0],e.translation[1]),no(e.rotation)||t.rotate(e.rotation),e.color&&(t.fillStyle=e.color),e.textAlign&&(t.textAlign=e.textAlign),e.textBaseline&&(t.textBaseline=e.textBaseline)}function Voe(t,e,n,r,c){if(c.strikethrough||c.underline){const d=t.measureText(r),m=e-d.actualBoundingBoxLeft,s=e+d.actualBoundingBoxRight,T=n-d.actualBoundingBoxAscent,D=n+d.actualBoundingBoxDescent,P=c.strikethrough?(T+D)/2:D;t.strokeStyle=t.fillStyle,t.beginPath(),t.lineWidth=c.decorationWidth||2,t.moveTo(m,P),t.lineTo(s,P),t.stroke()}}function Uoe(t,e){const n=t.fillStyle;t.fillStyle=e.color,t.fillRect(e.left,e.top,e.width,e.height),t.fillStyle=n}function bA(t,e,n,r,c,d={}){const m=sl(e)?e:[e],s=d.strokeWidth>0&&d.strokeColor!=="";let T,D;for(t.save(),t.font=c.string,Foe(t,d),T=0;T<m.length;++T)D=m[T],d.backdrop&&Uoe(t,d.backdrop),s&&(d.strokeColor&&(t.strokeStyle=d.strokeColor),no(d.strokeWidth)||(t.lineWidth=d.strokeWidth),t.strokeText(D,n,r,d.maxWidth)),t.fillText(D,n,r,d.maxWidth),Voe(t,n,r,D,d),r+=Number(c.lineHeight);t.restore()}function YO(t,e){const{x:n,y:r,w:c,h:d,radius:m}=e;t.arc(n+m.topLeft,r+m.topLeft,m.topLeft,1.5*to,to,!0),t.lineTo(n,r+d-m.bottomLeft),t.arc(n+m.bottomLeft,r+d-m.bottomLeft,m.bottomLeft,to,ol,!0),t.lineTo(n+c-m.bottomRight,r+d),t.arc(n+c-m.bottomRight,r+d-m.bottomRight,m.bottomRight,ol,0,!0),t.lineTo(n+c,r+m.topRight),t.arc(n+c-m.topRight,r+m.topRight,m.topRight,0,-ol,!0),t.lineTo(n+m.topLeft,r)}const joe=/^(normal|(\d+(?:\.\d+)?)(px|em|%)?)$/,Hoe=/^(normal|italic|initial|inherit|unset|(oblique( -?[0-9]?[0-9]deg)?))$/;function $oe(t,e){const n=(""+t).match(joe);if(!n||n[1]==="normal")return e*1.2;switch(t=+n[2],n[3]){case"px":return t;case"%":t/=100;break}return e*t}const Goe=t=>+t||0;function yL(t,e){const n={},r=_s(e),c=r?Object.keys(e):e,d=_s(t)?r?m=>gs(t[m],t[e[m]]):m=>t[m]:()=>t;for(const m of c)n[m]=Goe(d(m));return n}function R8(t){return yL(t,{top:"y",right:"x",bottom:"y",left:"x"})}function Bw(t){return yL(t,["topLeft","topRight","bottomLeft","bottomRight"])}function of(t){const e=R8(t);return e.width=e.left+e.right,e.height=e.top+e.bottom,e}function Fc(t,e){t=t||{},e=e||ga.font;let n=gs(t.size,e.size);typeof n=="string"&&(n=parseInt(n,10));let r=gs(t.style,e.style);r&&!(""+r).match(Hoe)&&(console.warn('Invalid font style specified: "'+r+'"'),r=void 0);const c={family:gs(t.family,e.family),lineHeight:$oe(gs(t.lineHeight,e.lineHeight),n),size:n,style:r,weight:gs(t.weight,e.weight),string:""};return c.string=Boe(c),c}function mR(t,e,n,r){let c,d,m;for(c=0,d=t.length;c<d;++c)if(m=t[c],m!==void 0&&m!==void 0)return m}function qoe(t,e,n){const{min:r,max:c}=t,d=_8(e,(c-r)/2),m=(s,T)=>n&&s===0?0:s+T;return{min:m(r,-Math.abs(d)),max:m(c,d)}}function ET(t,e){return Object.assign(Object.create(t),e)}function vL(t,e=[""],n,r,c=()=>t[0]){const d=n||t;typeof r>"u"&&(r=P8("_fallback",t));const m={[Symbol.toStringTag]:"Object",_cacheable:!0,_scopes:t,_rootScopes:d,_fallback:r,_getTarget:c,override:s=>vL([s,...t],e,d,r)};return new Proxy(m,{deleteProperty(s,T){return delete s[T],delete s._keys,delete t[0][T],!0},get(s,T){return I8(s,T,()=>eae(T,e,t,s))},getOwnPropertyDescriptor(s,T){return Reflect.getOwnPropertyDescriptor(s._scopes[0],T)},getPrototypeOf(){return Reflect.getPrototypeOf(t[0])},has(s,T){return HF(s).includes(T)},ownKeys(s){return HF(s)},set(s,T,D){const P=s._storage||(s._storage=c());return s[T]=P[T]=D,delete s._keys,!0}})}function aT(t,e,n,r){const c={_cacheable:!1,_proxy:t,_context:e,_subProxy:n,_stack:new Set,_descriptors:O8(t,r),setContext:d=>aT(t,d,n,r),override:d=>aT(t.override(d),e,n,r)};return new Proxy(c,{deleteProperty(d,m){return delete d[m],delete t[m],!0},get(d,m,s){return I8(d,m,()=>Yoe(d,m,s))},getOwnPropertyDescriptor(d,m){return d._descriptors.allKeys?Reflect.has(t,m)?{enumerable:!0,configurable:!0}:void 0:Reflect.getOwnPropertyDescriptor(t,m)},getPrototypeOf(){return Reflect.getPrototypeOf(t)},has(d,m){return Reflect.has(t,m)},ownKeys(){return Reflect.ownKeys(t)},set(d,m,s){return t[m]=s,delete d[m],!0}})}function O8(t,e={scriptable:!0,indexable:!0}){const{_scriptable:n=e.scriptable,_indexable:r=e.indexable,_allKeys:c=e.allKeys}=t;return{allKeys:c,scriptable:n,indexable:r,isScriptable:i0(n)?n:()=>n,isIndexable:i0(r)?r:()=>r}}const Woe=(t,e)=>t?t+dL(e):e,bL=(t,e)=>_s(e)&&t!=="adapters"&&(Object.getPrototypeOf(e)===null||e.constructor===Object);function I8(t,e,n){if(Object.prototype.hasOwnProperty.call(t,e)||e==="constructor")return t[e];const r=n();return t[e]=r,r}function Yoe(t,e,n){const{_proxy:r,_context:c,_subProxy:d,_descriptors:m}=t;let s=r[e];return i0(s)&&m.isScriptable(e)&&(s=Zoe(e,s,t,n)),sl(s)&&s.length&&(s=Xoe(e,s,t,m.isIndexable)),bL(e,s)&&(s=aT(s,c,d&&d[e],m)),s}function Zoe(t,e,n,r){const{_proxy:c,_context:d,_subProxy:m,_stack:s}=n;if(s.has(t))throw new Error("Recursion detected: "+Array.from(s).join("->")+"->"+t);s.add(t);let T=e(d,m||r);return s.delete(t),bL(t,T)&&(T=xL(c._scopes,c,t,T)),T}function Xoe(t,e,n,r){const{_proxy:c,_context:d,_subProxy:m,_descriptors:s}=n;if(typeof d.index<"u"&&r(t))return e[d.index%e.length];if(_s(e[0])){const T=e,D=c._scopes.filter(P=>P!==T);e=[];for(const P of T){const z=xL(D,c,t,P);e.push(aT(z,d,m&&m[t],s))}}return e}function M8(t,e,n){return i0(t)?t(e,n):t}const Qoe=(t,e)=>t===!0?e:typeof t=="string"?Tx(e,t):void 0;function Koe(t,e,n,r,c){for(const d of e){const m=Qoe(n,d);if(m){t.add(m);const s=M8(m._fallback,n,c);if(typeof s<"u"&&s!==n&&s!==r)return s}else if(m===!1&&typeof r<"u"&&n!==r)return null}return!1}function xL(t,e,n,r){const c=e._rootScopes,d=M8(e._fallback,n,r),m=[...t,...c],s=new Set;s.add(r);let T=jF(s,m,n,d||n,r);return T===null||typeof d<"u"&&d!==n&&(T=jF(s,m,d,T,r),T===null)?!1:vL(Array.from(s),[""],c,d,()=>Joe(e,n,r))}function jF(t,e,n,r,c){for(;n;)n=Koe(t,e,n,r,c);return n}function Joe(t,e,n){const r=t._getTarget();e in r||(r[e]={});const c=r[e];return sl(c)&&_s(n)?n:c||{}}function eae(t,e,n,r){let c;for(const d of e)if(c=P8(Woe(d,t),n),typeof c<"u")return bL(t,c)?xL(n,r,t,c):c}function P8(t,e){for(const n of e){if(!n)continue;const r=n[t];if(typeof r<"u")return r}}function HF(t){let e=t._keys;return e||(e=t._keys=tae(t._scopes)),e}function tae(t){const e=new Set;for(const n of t)for(const r of Object.keys(n).filter(c=>!c.startsWith("_")))e.add(r);return Array.from(e)}function wL(){return typeof window<"u"&&typeof document<"u"}function TL(t){let e=t.parentNode;return e&&e.toString()==="[object ShadowRoot]"&&(e=e.host),e}function ZO(t,e,n){let r;return typeof t=="string"?(r=parseInt(t,10),t.indexOf("%")!==-1&&(r=r/100*e.parentNode[n])):r=t,r}const aM=t=>t.ownerDocument.defaultView.getComputedStyle(t,null);function nae(t,e){return aM(t).getPropertyValue(e)}const iae=["top","right","bottom","left"];function cx(t,e,n){const r={};n=n?"-"+n:"";for(let c=0;c<4;c++){const d=iae[c];r[d]=parseFloat(t[e+"-"+d+n])||0}return r.width=r.left+r.right,r.height=r.top+r.bottom,r}const rae=(t,e,n)=>(t>0||e>0)&&(!n||!n.shadowRoot);function sae(t,e){const n=t.touches,r=n&&n.length?n[0]:t,{offsetX:c,offsetY:d}=r;let m=!1,s,T;if(rae(c,d,t.target))s=c,T=d;else{const D=e.getBoundingClientRect();s=r.clientX-D.left,T=r.clientY-D.top,m=!0}return{x:s,y:T,box:m}}function Jb(t,e){if("native"in t)return t;const{canvas:n,currentDevicePixelRatio:r}=e,c=aM(n),d=c.boxSizing==="border-box",m=cx(c,"padding"),s=cx(c,"border","width"),{x:T,y:D,box:P}=sae(t,n),z=m.left+(P&&s.left),F=m.top+(P&&s.top);let{width:$,height:J}=e;return d&&($-=m.width+s.width,J-=m.height+s.height),{x:Math.round((T-z)/$*n.width/r),y:Math.round((D-F)/J*n.height/r)}}function oae(t,e,n){let r,c;if(e===void 0||n===void 0){const d=t&&TL(t);if(!d)e=t.clientWidth,n=t.clientHeight;else{const m=d.getBoundingClientRect(),s=aM(d),T=cx(s,"border","width"),D=cx(s,"padding");e=m.width-D.width-T.width,n=m.height-D.height-T.height,r=ZO(s.maxWidth,d,"clientWidth"),c=ZO(s.maxHeight,d,"clientHeight")}}return{width:e,height:n,maxWidth:r||GO,maxHeight:c||GO}}const gR=t=>Math.round(t*10)/10;function aae(t,e,n,r){const c=aM(t),d=cx(c,"margin"),m=ZO(c.maxWidth,t,"clientWidth")||GO,s=ZO(c.maxHeight,t,"clientHeight")||GO,T=oae(t,e,n);let{width:D,height:P}=T;if(c.boxSizing==="content-box"){const F=cx(c,"border","width"),$=cx(c,"padding");D-=$.width+F.width,P-=$.height+F.height}return D=Math.max(0,D-d.width),P=Math.max(0,r?D/r:P-d.height),D=gR(Math.min(D,m,T.maxWidth)),P=gR(Math.min(P,s,T.maxHeight)),D&&!P&&(P=gR(D/2)),(e!==void 0||n!==void 0)&&r&&T.height&&P>T.height&&(P=T.height,D=gR(Math.floor(P*r))),{width:D,height:P}}function $F(t,e,n){const r=e||1,c=Math.floor(t.height*r),d=Math.floor(t.width*r);t.height=Math.floor(t.height),t.width=Math.floor(t.width);const m=t.canvas;return m.style&&(n||!m.style.height&&!m.style.width)&&(m.style.height=`${t.height}px`,m.style.width=`${t.width}px`),t.currentDevicePixelRatio!==r||m.height!==c||m.width!==d?(t.currentDevicePixelRatio=r,m.height=c,m.width=d,t.ctx.setTransform(r,0,0,r,0,0),!0):!1}const lae=function(){let t=!1;try{const e={get passive(){return t=!0,!1}};wL()&&(window.addEventListener("test",null,e),window.removeEventListener("test",null,e))}catch{}return t}();function GF(t,e){const n=nae(t,e),r=n&&n.match(/^(\d+)(\.\d+)?px$/);return r?+r[1]:void 0}const cae=function(t,e){return{x(n){return t+t+e-n},setWidth(n){e=n},textAlign(n){return n==="center"?n:n==="right"?"left":"right"},xPlus(n,r){return n-r},leftForLtr(n,r){return n-r}}},uae=function(){return{x(t){return t},setWidth(t){},textAlign(t){return t},xPlus(t,e){return t+e},leftForLtr(t,e){return t}}};function Fw(t,e,n){return t?cae(e,n):uae()}function k8(t,e){let n,r;(e==="ltr"||e==="rtl")&&(n=t.canvas.style,r=[n.getPropertyValue("direction"),n.getPropertyPriority("direction")],n.setProperty("direction",e,"important"),t.prevTextDirection=r)}function N8(t,e){e!==void 0&&(delete t.prevTextDirection,t.canvas.style.setProperty("direction",e[0],e[1]))}function _R(t,e,n){return t.options.clip?t[n]:e[n]}function hae(t,e){const{xScale:n,yScale:r}=t;return n&&r?{left:_R(n,e,"left"),right:_R(n,e,"right"),top:_R(r,e,"top"),bottom:_R(r,e,"bottom")}:e}function dae(t,e){const n=e._clip;if(n.disabled)return!1;const r=hae(e,t.chartArea);return{left:n.left===!1?0:r.left-(n.left===!0?0:n.left),right:n.right===!1?t.width:r.right+(n.right===!0?0:n.right),top:n.top===!1?0:r.top-(n.top===!0?0:n.top),bottom:n.bottom===!1?t.height:r.bottom+(n.bottom===!0?0:n.bottom)}}/*!
 * Chart.js v4.5.0
 * https://www.chartjs.org
 * (c) 2025 Chart.js Contributors
 * Released under the MIT License
 */class fae{constructor(){this._request=null,this._charts=new Map,this._running=!1,this._lastDate=void 0}_notify(e,n,r,c){const d=n.listeners[c],m=n.duration;d.forEach(s=>s({chart:e,initial:n.initial,numSteps:m,currentStep:Math.min(r-n.start,m)}))}_refresh(){this._request||(this._running=!0,this._request=T8.call(window,()=>{this._update(),this._request=null,this._running&&this._refresh()}))}_update(e=Date.now()){let n=0;this._charts.forEach((r,c)=>{if(!r.running||!r.items.length)return;const d=r.items;let m=d.length-1,s=!1,T;for(;m>=0;--m)T=d[m],T._active?(T._total>r.duration&&(r.duration=T._total),T.tick(e),s=!0):(d[m]=d[d.length-1],d.pop());s&&(c.draw(),this._notify(c,r,e,"progress")),d.length||(r.running=!1,this._notify(c,r,e,"complete"),r.initial=!1),n+=d.length}),this._lastDate=e,n===0&&(this._running=!1)}_getAnims(e){const n=this._charts;let r=n.get(e);return r||(r={running:!1,initial:!0,items:[],listeners:{complete:[],progress:[]}},n.set(e,r)),r}listen(e,n,r){this._getAnims(e).listeners[n].push(r)}add(e,n){!n||!n.length||this._getAnims(e).items.push(...n)}has(e){return this._getAnims(e).items.length>0}start(e){const n=this._charts.get(e);n&&(n.running=!0,n.start=Date.now(),n.duration=n.items.reduce((r,c)=>Math.max(r,c._duration),0),this._refresh())}running(e){if(!this._running)return!1;const n=this._charts.get(e);return!(!n||!n.running||!n.items.length)}stop(e){const n=this._charts.get(e);if(!n||!n.items.length)return;const r=n.items;let c=r.length-1;for(;c>=0;--c)r[c].cancel();n.items=[],this._notify(e,n,Date.now(),"complete")}remove(e){return this._charts.delete(e)}}var p_=new fae;const qF="transparent",pae={boolean(t,e,n){return n>.5?e:t},color(t,e,n){const r=zF(t||qF),c=r.valid&&zF(e||qF);return c&&c.valid?c.mix(r,n).hexString():e},number(t,e,n){return t+(e-t)*n}};class mae{constructor(e,n,r,c){const d=n[r];c=mR([e.to,c,d,e.from]);const m=mR([e.from,d,c]);this._active=!0,this._fn=e.fn||pae[e.type||typeof m],this._easing=WS[e.easing]||WS.linear,this._start=Math.floor(Date.now()+(e.delay||0)),this._duration=this._total=Math.floor(e.duration),this._loop=!!e.loop,this._target=n,this._prop=r,this._from=m,this._to=c,this._promises=void 0}active(){return this._active}update(e,n,r){if(this._active){this._notify(!1);const c=this._target[this._prop],d=r-this._start,m=this._duration-d;this._start=r,this._duration=Math.floor(Math.max(m,e.duration)),this._total+=d,this._loop=!!e.loop,this._to=mR([e.to,n,c,e.from]),this._from=mR([e.from,c,n])}}cancel(){this._active&&(this.tick(Date.now()),this._active=!1,this._notify(!1))}tick(e){const n=e-this._start,r=this._duration,c=this._prop,d=this._from,m=this._loop,s=this._to;let T;if(this._active=d!==s&&(m||n<r),!this._active){this._target[c]=s,this._notify(!0);return}if(n<0){this._target[c]=d;return}T=n/r%2,T=m&&T>1?2-T:T,T=this._easing(Math.min(1,Math.max(0,T))),this._target[c]=this._fn(d,s,T)}wait(){const e=this._promises||(this._promises=[]);return new Promise((n,r)=>{e.push({res:n,rej:r})})}_notify(e){const n=e?"res":"rej",r=this._promises||[];for(let c=0;c<r.length;c++)r[c][n]()}}class L8{constructor(e,n){this._chart=e,this._properties=new Map,this.configure(n)}configure(e){if(!_s(e))return;const n=Object.keys(ga.animation),r=this._properties;Object.getOwnPropertyNames(e).forEach(c=>{const d=e[c];if(!_s(d))return;const m={};for(const s of n)m[s]=d[s];(sl(d.properties)&&d.properties||[c]).forEach(s=>{(s===c||!r.has(s))&&r.set(s,m)})})}_animateOptions(e,n){const r=n.options,c=_ae(e,r);if(!c)return[];const d=this._createAnimations(c,r);return r.$shared&&gae(e.options.$animations,r).then(()=>{e.options=r},()=>{}),d}_createAnimations(e,n){const r=this._properties,c=[],d=e.$animations||(e.$animations={}),m=Object.keys(n),s=Date.now();let T;for(T=m.length-1;T>=0;--T){const D=m[T];if(D.charAt(0)==="$")continue;if(D==="options"){c.push(...this._animateOptions(e,n));continue}const P=n[D];let z=d[D];const F=r.get(D);if(z)if(F&&z.active()){z.update(F,P,s);continue}else z.cancel();if(!F||!F.duration){e[D]=P;continue}d[D]=z=new mae(F,e,D,P),c.push(z)}return c}update(e,n){if(this._properties.size===0){Object.assign(e,n);return}const r=this._createAnimations(e,n);if(r.length)return p_.add(this._chart,r),!0}}function gae(t,e){const n=[],r=Object.keys(e);for(let c=0;c<r.length;c++){const d=t[r[c]];d&&d.active()&&n.push(d.wait())}return Promise.all(n)}function _ae(t,e){if(!e)return;let n=t.options;if(!n){t.options=e;return}return n.$shared&&(t.options=n=Object.assign({},n,{$shared:!1,$animations:{}})),n}function WF(t,e){const n=t&&t.options||{},r=n.reverse,c=n.min===void 0?e:0,d=n.max===void 0?e:0;return{start:r?d:c,end:r?c:d}}function yae(t,e,n){if(n===!1)return!1;const r=WF(t,n),c=WF(e,n);return{top:c.end,right:r.end,bottom:c.start,left:r.start}}function vae(t){let e,n,r,c;return _s(t)?(e=t.top,n=t.right,r=t.bottom,c=t.left):e=n=r=c=t,{top:e,right:n,bottom:r,left:c,disabled:t===!1}}function z8(t,e){const n=[],r=t._getSortedDatasetMetas(e);let c,d;for(c=0,d=r.length;c<d;++c)n.push(r[c].index);return n}function YF(t,e,n,r={}){const c=t.keys,d=r.mode==="single";let m,s,T,D;if(e===null)return;let P=!1;for(m=0,s=c.length;m<s;++m){if(T=+c[m],T===n){if(P=!0,r.all)continue;break}D=t.values[T],sf(D)&&(d||e===0||Wv(e)===Wv(D))&&(e+=D)}return!P&&!r.all?0:e}function bae(t,e){const{iScale:n,vScale:r}=e,c=n.axis==="x"?"x":"y",d=r.axis==="x"?"x":"y",m=Object.keys(t),s=new Array(m.length);let T,D,P;for(T=0,D=m.length;T<D;++T)P=m[T],s[T]={[c]:P,[d]:t[P]};return s}function LP(t,e){const n=t&&t.options.stacked;return n||n===void 0&&e.stack!==void 0}function xae(t,e,n){return`${t.id}.${e.id}.${n.stack||n.type}`}function wae(t){const{min:e,max:n,minDefined:r,maxDefined:c}=t.getUserBounds();return{min:r?e:Number.NEGATIVE_INFINITY,max:c?n:Number.POSITIVE_INFINITY}}function Tae(t,e,n){const r=t[e]||(t[e]={});return r[n]||(r[n]={})}function ZF(t,e,n,r){for(const c of e.getMatchingVisibleMetas(r).reverse()){const d=t[c.index];if(n&&d>0||!n&&d<0)return c.index}return null}function XF(t,e){const{chart:n,_cachedMeta:r}=t,c=n._stacks||(n._stacks={}),{iScale:d,vScale:m,index:s}=r,T=d.axis,D=m.axis,P=xae(d,m,r),z=e.length;let F;for(let $=0;$<z;++$){const J=e[$],{[T]:X,[D]:te}=J,ie=J._stacks||(J._stacks={});F=ie[D]=Tae(c,P,X),F[s]=te,F._top=ZF(F,m,!0,r.type),F._bottom=ZF(F,m,!1,r.type);const we=F._visualValues||(F._visualValues={});we[s]=te}}function zP(t,e){const n=t.scales;return Object.keys(n).filter(r=>n[r].axis===e).shift()}function Eae(t,e){return ET(t,{active:!1,dataset:void 0,datasetIndex:e,index:e,mode:"default",type:"dataset"})}function Sae(t,e,n){return ET(t,{active:!1,dataIndex:e,parsed:void 0,raw:void 0,element:n,index:e,mode:"default",type:"data"})}function mS(t,e){const n=t.controller.index,r=t.vScale&&t.vScale.axis;if(r){e=e||t._parsed;for(const c of e){const d=c._stacks;if(!d||d[r]===void 0||d[r][n]===void 0)return;delete d[r][n],d[r]._visualValues!==void 0&&d[r]._visualValues[n]!==void 0&&delete d[r]._visualValues[n]}}}const BP=t=>t==="reset"||t==="none",QF=(t,e)=>e?t:Object.assign({},t),Aae=(t,e,n)=>t&&!e.hidden&&e._stacked&&{keys:z8(n,!0),values:null};class Vw{constructor(e,n){this.chart=e,this._ctx=e.ctx,this.index=n,this._cachedDataOpts={},this._cachedMeta=this.getMeta(),this._type=this._cachedMeta.type,this.options=void 0,this._parsing=!1,this._data=void 0,this._objectData=void 0,this._sharedOptions=void 0,this._drawStart=void 0,this._drawCount=void 0,this.enableOptionSharing=!1,this.supportsDecimation=!1,this.$context=void 0,this._syncList=[],this.datasetElementType=new.target.datasetElementType,this.dataElementType=new.target.dataElementType,this.initialize()}initialize(){const e=this._cachedMeta;this.configure(),this.linkScales(),e._stacked=LP(e.vScale,e),this.addElements(),this.options.fill&&!this.chart.isPluginEnabled("filler")&&console.warn("Tried to use the 'fill' option without the 'Filler' plugin enabled. Please import and register the 'Filler' plugin and make sure it is not disabled in the options")}updateIndex(e){this.index!==e&&mS(this._cachedMeta),this.index=e}linkScales(){const e=this.chart,n=this._cachedMeta,r=this.getDataset(),c=(z,F,$,J)=>z==="x"?F:z==="r"?J:$,d=n.xAxisID=gs(r.xAxisID,zP(e,"x")),m=n.yAxisID=gs(r.yAxisID,zP(e,"y")),s=n.rAxisID=gs(r.rAxisID,zP(e,"r")),T=n.indexAxis,D=n.iAxisID=c(T,d,m,s),P=n.vAxisID=c(T,m,d,s);n.xScale=this.getScaleForId(d),n.yScale=this.getScaleForId(m),n.rScale=this.getScaleForId(s),n.iScale=this.getScaleForId(D),n.vScale=this.getScaleForId(P)}getDataset(){return this.chart.data.datasets[this.index]}getMeta(){return this.chart.getDatasetMeta(this.index)}getScaleForId(e){return this.chart.scales[e]}_getOtherScale(e){const n=this._cachedMeta;return e===n.iScale?n.vScale:n.iScale}reset(){this._update("reset")}_destroy(){const e=this._cachedMeta;this._data&&kF(this._data,this),e._stacked&&mS(e)}_dataCheck(){const e=this.getDataset(),n=e.data||(e.data=[]),r=this._data;if(_s(n)){const c=this._cachedMeta;this._data=bae(n,c)}else if(r!==n){if(r){kF(r,this);const c=this._cachedMeta;mS(c),c._parsed=[]}n&&Object.isExtensible(n)&&Aoe(n,this),this._syncList=[],this._data=n}}addElements(){const e=this._cachedMeta;this._dataCheck(),this.datasetElementType&&(e.dataset=new this.datasetElementType)}buildOrUpdateElements(e){const n=this._cachedMeta,r=this.getDataset();let c=!1;this._dataCheck();const d=n._stacked;n._stacked=LP(n.vScale,n),n.stack!==r.stack&&(c=!0,mS(n),n.stack=r.stack),this._resyncElements(e),(c||d!==n._stacked)&&(XF(this,n._parsed),n._stacked=LP(n.vScale,n))}configure(){const e=this.chart.config,n=e.datasetScopeKeys(this._type),r=e.getOptionScopes(this.getDataset(),n,!0);this.options=e.createResolver(r,this.getContext()),this._parsing=this.options.parsing,this._cachedDataOpts={}}parse(e,n){const{_cachedMeta:r,_data:c}=this,{iScale:d,_stacked:m}=r,s=d.axis;let T=e===0&&n===c.length?!0:r._sorted,D=e>0&&r._parsed[e-1],P,z,F;if(this._parsing===!1)r._parsed=c,r._sorted=!0,F=c;else{sl(c[e])?F=this.parseArrayData(r,c,e,n):_s(c[e])?F=this.parseObjectData(r,c,e,n):F=this.parsePrimitiveData(r,c,e,n);const $=()=>z[s]===null||D&&z[s]<D[s];for(P=0;P<n;++P)r._parsed[P+e]=z=F[P],T&&($()&&(T=!1),D=z);r._sorted=T}m&&XF(this,F)}parsePrimitiveData(e,n,r,c){const{iScale:d,vScale:m}=e,s=d.axis,T=m.axis,D=d.getLabels(),P=d===m,z=new Array(c);let F,$,J;for(F=0,$=c;F<$;++F)J=F+r,z[F]={[s]:P||d.parse(D[J],J),[T]:m.parse(n[J],J)};return z}parseArrayData(e,n,r,c){const{xScale:d,yScale:m}=e,s=new Array(c);let T,D,P,z;for(T=0,D=c;T<D;++T)P=T+r,z=n[P],s[T]={x:d.parse(z[0],P),y:m.parse(z[1],P)};return s}parseObjectData(e,n,r,c){const{xScale:d,yScale:m}=e,{xAxisKey:s="x",yAxisKey:T="y"}=this._parsing,D=new Array(c);let P,z,F,$;for(P=0,z=c;P<z;++P)F=P+r,$=n[F],D[P]={x:d.parse(Tx($,s),F),y:m.parse(Tx($,T),F)};return D}getParsed(e){return this._cachedMeta._parsed[e]}getDataElement(e){return this._cachedMeta.data[e]}applyStack(e,n,r){const c=this.chart,d=this._cachedMeta,m=n[e.axis],s={keys:z8(c,!0),values:n._stacks[e.axis]._visualValues};return YF(s,m,d.index,{mode:r})}updateRangeFromParsed(e,n,r,c){const d=r[n.axis];let m=d===null?NaN:d;const s=c&&r._stacks[n.axis];c&&s&&(c.values=s,m=YF(c,d,this._cachedMeta.index)),e.min=Math.min(e.min,m),e.max=Math.max(e.max,m)}getMinMax(e,n){const r=this._cachedMeta,c=r._parsed,d=r._sorted&&e===r.iScale,m=c.length,s=this._getOtherScale(e),T=Aae(n,r,this.chart),D={min:Number.POSITIVE_INFINITY,max:Number.NEGATIVE_INFINITY},{min:P,max:z}=wae(s);let F,$;function J(){$=c[F];const X=$[s.axis];return!sf($[e.axis])||P>X||z<X}for(F=0;F<m&&!(!J()&&(this.updateRangeFromParsed(D,e,$,T),d));++F);if(d){for(F=m-1;F>=0;--F)if(!J()){this.updateRangeFromParsed(D,e,$,T);break}}return D}getAllParsedValues(e){const n=this._cachedMeta._parsed,r=[];let c,d,m;for(c=0,d=n.length;c<d;++c)m=n[c][e.axis],sf(m)&&r.push(m);return r}getMaxOverflow(){return!1}getLabelAndValue(e){const n=this._cachedMeta,r=n.iScale,c=n.vScale,d=this.getParsed(e);return{label:r?""+r.getLabelForValue(d[r.axis]):"",value:c?""+c.getLabelForValue(d[c.axis]):""}}_update(e){const n=this._cachedMeta;this.update(e||"default"),n._clip=vae(gs(this.options.clip,yae(n.xScale,n.yScale,this.getMaxOverflow())))}update(e){}draw(){const e=this._ctx,n=this.chart,r=this._cachedMeta,c=r.data||[],d=n.chartArea,m=[],s=this._drawStart||0,T=this._drawCount||c.length-s,D=this.options.drawActiveElementsOnTop;let P;for(r.dataset&&r.dataset.draw(e,d,s,T),P=s;P<s+T;++P){const z=c[P];z.hidden||(z.active&&D?m.push(z):z.draw(e,d))}for(P=0;P<m.length;++P)m[P].draw(e,d)}getStyle(e,n){const r=n?"active":"default";return e===void 0&&this._cachedMeta.dataset?this.resolveDatasetElementOptions(r):this.resolveDataElementOptions(e||0,r)}getContext(e,n,r){const c=this.getDataset();let d;if(e>=0&&e<this._cachedMeta.data.length){const m=this._cachedMeta.data[e];d=m.$context||(m.$context=Sae(this.getContext(),e,m)),d.parsed=this.getParsed(e),d.raw=c.data[e],d.index=d.dataIndex=e}else d=this.$context||(this.$context=Eae(this.chart.getContext(),this.index)),d.dataset=c,d.index=d.datasetIndex=this.index;return d.active=!!n,d.mode=r,d}resolveDatasetElementOptions(e){return this._resolveElementOptions(this.datasetElementType.id,e)}resolveDataElementOptions(e,n){return this._resolveElementOptions(this.dataElementType.id,n,e)}_resolveElementOptions(e,n="default",r){const c=n==="active",d=this._cachedDataOpts,m=e+"-"+n,s=d[m],T=this.enableOptionSharing&&vA(r);if(s)return QF(s,T);const D=this.chart.config,P=D.datasetElementScopeKeys(this._type,e),z=c?[`${e}Hover`,"hover",e,""]:[e,""],F=D.getOptionScopes(this.getDataset(),P),$=Object.keys(ga.elements[e]),J=()=>this.getContext(r,c,n),X=D.resolveNamedOptions(F,$,J,z);return X.$shared&&(X.$shared=T,d[m]=Object.freeze(QF(X,T))),X}_resolveAnimations(e,n,r){const c=this.chart,d=this._cachedDataOpts,m=`animation-${n}`,s=d[m];if(s)return s;let T;if(c.options.animation!==!1){const P=this.chart.config,z=P.datasetAnimationScopeKeys(this._type,n),F=P.getOptionScopes(this.getDataset(),z);T=P.createResolver(F,this.getContext(e,r,n))}const D=new L8(c,T&&T.animations);return T&&T._cacheable&&(d[m]=Object.freeze(D)),D}getSharedOptions(e){if(e.$shared)return this._sharedOptions||(this._sharedOptions=Object.assign({},e))}includeOptions(e,n){return!n||BP(e)||this.chart._animationsDisabled}_getSharedOptions(e,n){const r=this.resolveDataElementOptions(e,n),c=this._sharedOptions,d=this.getSharedOptions(r),m=this.includeOptions(n,d)||d!==c;return this.updateSharedOptions(d,n,r),{sharedOptions:d,includeOptions:m}}updateElement(e,n,r,c){BP(c)?Object.assign(e,r):this._resolveAnimations(n,c).update(e,r)}updateSharedOptions(e,n,r){e&&!BP(n)&&this._resolveAnimations(void 0,n).update(e,r)}_setStyle(e,n,r,c){e.active=c;const d=this.getStyle(n,c);this._resolveAnimations(n,r,c).update(e,{options:!c&&this.getSharedOptions(d)||d})}removeHoverStyle(e,n,r){this._setStyle(e,r,"active",!1)}setHoverStyle(e,n,r){this._setStyle(e,r,"active",!0)}_removeDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!1)}_setDatasetHoverStyle(){const e=this._cachedMeta.dataset;e&&this._setStyle(e,void 0,"active",!0)}_resyncElements(e){const n=this._data,r=this._cachedMeta.data;for(const[s,T,D]of this._syncList)this[s](T,D);this._syncList=[];const c=r.length,d=n.length,m=Math.min(d,c);m&&this.parse(0,m),d>c?this._insertElements(c,d-c,e):d<c&&this._removeElements(d,c-d)}_insertElements(e,n,r=!0){const c=this._cachedMeta,d=c.data,m=e+n;let s;const T=D=>{for(D.length+=n,s=D.length-1;s>=m;s--)D[s]=D[s-n]};for(T(d),s=e;s<m;++s)d[s]=new this.dataElementType;this._parsing&&T(c._parsed),this.parse(e,n),r&&this.updateElements(d,e,n,"reset")}updateElements(e,n,r,c){}_removeElements(e,n){const r=this._cachedMeta;if(this._parsing){const c=r._parsed.splice(e,n);r._stacked&&mS(r,c)}r.data.splice(e,n)}_sync(e){if(this._parsing)this._syncList.push(e);else{const[n,r,c]=e;this[n](r,c)}this.chart._dataChanges.push([this.index,...e])}_onDataPush(){const e=arguments.length;this._sync(["_insertElements",this.getDataset().data.length-e,e])}_onDataPop(){this._sync(["_removeElements",this._cachedMeta.data.length-1,1])}_onDataShift(){this._sync(["_removeElements",0,1])}_onDataSplice(e,n){n&&this._sync(["_removeElements",e,n]);const r=arguments.length-2;r&&this._sync(["_insertElements",e,r])}_onDataUnshift(){this._sync(["_insertElements",0,arguments.length])}}ki(Vw,"defaults",{}),ki(Vw,"datasetElementType",null),ki(Vw,"dataElementType",null);function Cae(t,e){if(!t._cache.$bar){const n=t.getMatchingVisibleMetas(e);let r=[];for(let c=0,d=n.length;c<d;c++)r=r.concat(n[c].controller.getAllParsedValues(t));t._cache.$bar=w8(r.sort((c,d)=>c-d))}return t._cache.$bar}function Dae(t){const e=t.iScale,n=Cae(e,t.type);let r=e._length,c,d,m,s;const T=()=>{m===32767||m===-32768||(vA(s)&&(r=Math.min(r,Math.abs(m-s)||r)),s=m)};for(c=0,d=n.length;c<d;++c)m=e.getPixelForValue(n[c]),T();for(s=void 0,c=0,d=e.ticks.length;c<d;++c)m=e.getPixelForTick(c),T();return r}function Rae(t,e,n,r){const c=n.barThickness;let d,m;return no(c)?(d=e.min*n.categoryPercentage,m=n.barPercentage):(d=c*r,m=1),{chunk:d/r,ratio:m,start:e.pixels[t]-d/2}}function Oae(t,e,n,r){const c=e.pixels,d=c[t];let m=t>0?c[t-1]:null,s=t<c.length-1?c[t+1]:null;const T=n.categoryPercentage;m===null&&(m=d-(s===null?e.end-e.start:s-d)),s===null&&(s=d+d-m);const D=d-(d-Math.min(m,s))/2*T;return{chunk:Math.abs(s-m)/2*T/r,ratio:n.barPercentage,start:D}}function Iae(t,e,n,r){const c=n.parse(t[0],r),d=n.parse(t[1],r),m=Math.min(c,d),s=Math.max(c,d);let T=m,D=s;Math.abs(m)>Math.abs(s)&&(T=s,D=m),e[n.axis]=D,e._custom={barStart:T,barEnd:D,start:c,end:d,min:m,max:s}}function B8(t,e,n,r){return sl(t)?Iae(t,e,n,r):e[n.axis]=n.parse(t,r),e}function KF(t,e,n,r){const c=t.iScale,d=t.vScale,m=c.getLabels(),s=c===d,T=[];let D,P,z,F;for(D=n,P=n+r;D<P;++D)F=e[D],z={},z[c.axis]=s||c.parse(m[D],D),T.push(B8(F,z,d,D));return T}function FP(t){return t&&t.barStart!==void 0&&t.barEnd!==void 0}function Mae(t,e,n){return t!==0?Wv(t):(e.isHorizontal()?1:-1)*(e.min>=n?1:-1)}function Pae(t){let e,n,r,c,d;return t.horizontal?(e=t.base>t.x,n="left",r="right"):(e=t.base<t.y,n="bottom",r="top"),e?(c="end",d="start"):(c="start",d="end"),{start:n,end:r,reverse:e,top:c,bottom:d}}function kae(t,e,n,r){let c=e.borderSkipped;const d={};if(!c){t.borderSkipped=d;return}if(c===!0){t.borderSkipped={top:!0,right:!0,bottom:!0,left:!0};return}const{start:m,end:s,reverse:T,top:D,bottom:P}=Pae(t);c==="middle"&&n&&(t.enableBorderRadius=!0,(n._top||0)===r?c=D:(n._bottom||0)===r?c=P:(d[JF(P,m,s,T)]=!0,c=D)),d[JF(c,m,s,T)]=!0,t.borderSkipped=d}function JF(t,e,n,r){return r?(t=Nae(t,e,n),t=eV(t,n,e)):t=eV(t,e,n),t}function Nae(t,e,n){return t===e?n:t===n?e:t}function eV(t,e,n){return t==="start"?e:t==="end"?n:t}function Lae(t,{inflateAmount:e},n){t.inflateAmount=e==="auto"?n===1?.33:0:e}class eO extends Vw{parsePrimitiveData(e,n,r,c){return KF(e,n,r,c)}parseArrayData(e,n,r,c){return KF(e,n,r,c)}parseObjectData(e,n,r,c){const{iScale:d,vScale:m}=e,{xAxisKey:s="x",yAxisKey:T="y"}=this._parsing,D=d.axis==="x"?s:T,P=m.axis==="x"?s:T,z=[];let F,$,J,X;for(F=r,$=r+c;F<$;++F)X=n[F],J={},J[d.axis]=d.parse(Tx(X,D),F),z.push(B8(Tx(X,P),J,m,F));return z}updateRangeFromParsed(e,n,r,c){super.updateRangeFromParsed(e,n,r,c);const d=r._custom;d&&n===this._cachedMeta.vScale&&(e.min=Math.min(e.min,d.min),e.max=Math.max(e.max,d.max))}getMaxOverflow(){return 0}getLabelAndValue(e){const n=this._cachedMeta,{iScale:r,vScale:c}=n,d=this.getParsed(e),m=d._custom,s=FP(m)?"["+m.start+", "+m.end+"]":""+c.getLabelForValue(d[c.axis]);return{label:""+r.getLabelForValue(d[r.axis]),value:s}}initialize(){this.enableOptionSharing=!0,super.initialize();const e=this._cachedMeta;e.stack=this.getDataset().stack}update(e){const n=this._cachedMeta;this.updateElements(n.data,0,n.data.length,e)}updateElements(e,n,r,c){const d=c==="reset",{index:m,_cachedMeta:{vScale:s}}=this,T=s.getBasePixel(),D=s.isHorizontal(),P=this._getRuler(),{sharedOptions:z,includeOptions:F}=this._getSharedOptions(n,c);for(let $=n;$<n+r;$++){const J=this.getParsed($),X=d||no(J[s.axis])?{base:T,head:T}:this._calculateBarValuePixels($),te=this._calculateBarIndexPixels($,P),ie=(J._stacks||{})[s.axis],we={horizontal:D,base:X.base,enableBorderRadius:!ie||FP(J._custom)||m===ie._top||m===ie._bottom,x:D?X.head:te.center,y:D?te.center:X.head,height:D?te.size:Math.abs(X.size),width:D?Math.abs(X.size):te.size};F&&(we.options=z||this.resolveDataElementOptions($,e[$].active?"active":c));const Ie=we.options||e[$].options;kae(we,Ie,ie,m),Lae(we,Ie,P.ratio),this.updateElement(e[$],$,we,c)}}_getStacks(e,n){const{iScale:r}=this._cachedMeta,c=r.getMatchingVisibleMetas(this._type).filter(P=>P.controller.options.grouped),d=r.options.stacked,m=[],s=this._cachedMeta.controller.getParsed(n),T=s&&s[r.axis],D=P=>{const z=P._parsed.find($=>$[r.axis]===T),F=z&&z[P.vScale.axis];if(no(F)||isNaN(F))return!0};for(const P of c)if(!(n!==void 0&&D(P))&&((d===!1||m.indexOf(P.stack)===-1||d===void 0&&P.stack===void 0)&&m.push(P.stack),P.index===e))break;return m.length||m.push(void 0),m}_getStackCount(e){return this._getStacks(void 0,e).length}_getAxisCount(){return this._getAxis().length}getFirstScaleIdForIndexAxis(){const e=this.chart.scales,n=this.chart.options.indexAxis;return Object.keys(e).filter(r=>e[r].axis===n).shift()}_getAxis(){const e={},n=this.getFirstScaleIdForIndexAxis();for(const r of this.chart.data.datasets)e[gs(this.chart.options.indexAxis==="x"?r.xAxisID:r.yAxisID,n)]=!0;return Object.keys(e)}_getStackIndex(e,n,r){const c=this._getStacks(e,r),d=n!==void 0?c.indexOf(n):-1;return d===-1?c.length-1:d}_getRuler(){const e=this.options,n=this._cachedMeta,r=n.iScale,c=[];let d,m;for(d=0,m=n.data.length;d<m;++d)c.push(r.getPixelForValue(this.getParsed(d)[r.axis],d));const s=e.barThickness;return{min:s||Dae(n),pixels:c,start:r._startPixel,end:r._endPixel,stackCount:this._getStackCount(),scale:r,grouped:e.grouped,ratio:s?1:e.categoryPercentage*e.barPercentage}}_calculateBarValuePixels(e){const{_cachedMeta:{vScale:n,_stacked:r,index:c},options:{base:d,minBarLength:m}}=this,s=d||0,T=this.getParsed(e),D=T._custom,P=FP(D);let z=T[n.axis],F=0,$=r?this.applyStack(n,T,r):z,J,X;$!==z&&(F=$-z,$=z),P&&(z=D.barStart,$=D.barEnd-D.barStart,z!==0&&Wv(z)!==Wv(D.barEnd)&&(F=0),F+=z);const te=!no(d)&&!P?d:F;let ie=n.getPixelForValue(te);if(this.chart.getDataVisibility(e)?J=n.getPixelForValue(F+$):J=ie,X=J-ie,Math.abs(X)<m){X=Mae(X,n,s)*m,z===s&&(ie-=X/2);const we=n.getPixelForDecimal(0),Ie=n.getPixelForDecimal(1),Re=Math.min(we,Ie),Ne=Math.max(we,Ie);ie=Math.max(Math.min(ie,Ne),Re),J=ie+X,r&&!P&&(T._stacks[n.axis]._visualValues[c]=n.getValueForPixel(J)-n.getValueForPixel(ie))}if(ie===n.getPixelForValue(s)){const we=Wv(X)*n.getLineWidthForValue(s)/2;ie+=we,X-=we}return{size:X,base:ie,head:J,center:J+X/2}}_calculateBarIndexPixels(e,n){const r=n.scale,c=this.options,d=c.skipNull,m=gs(c.maxBarThickness,1/0);let s,T;const D=this._getAxisCount();if(n.grouped){const P=d?this._getStackCount(e):n.stackCount,z=c.barThickness==="flex"?Oae(e,n,c,P*D):Rae(e,n,c,P*D),F=this.chart.options.indexAxis==="x"?this.getDataset().xAxisID:this.getDataset().yAxisID,$=this._getAxis().indexOf(gs(F,this.getFirstScaleIdForIndexAxis())),J=this._getStackIndex(this.index,this._cachedMeta.stack,d?e:void 0)+$;s=z.start+z.chunk*J+z.chunk/2,T=Math.min(m,z.chunk*z.ratio)}else s=r.getPixelForValue(this.getParsed(e)[r.axis],e),T=Math.min(m,n.min*n.ratio);return{base:s-T/2,head:s+T/2,center:s,size:T}}draw(){const e=this._cachedMeta,n=e.vScale,r=e.data,c=r.length;let d=0;for(;d<c;++d)this.getParsed(d)[n.axis]!==null&&!r[d].hidden&&r[d].draw(this._ctx)}}ki(eO,"id","bar"),ki(eO,"defaults",{datasetElementType:!1,dataElementType:"bar",categoryPercentage:.8,barPercentage:.9,grouped:!0,animations:{numbers:{type:"number",properties:["x","y","base","width","height"]}}}),ki(eO,"overrides",{scales:{_index_:{type:"category",offset:!0,grid:{offset:!0}},_value_:{type:"linear",beginAtZero:!0}}});function zae(t,e,n){let r=1,c=1,d=0,m=0;if(e<Fa){const s=t,T=s+e,D=Math.cos(s),P=Math.sin(s),z=Math.cos(T),F=Math.sin(T),$=(Ie,Re,Ne)=>WO(Ie,s,T,!0)?1:Math.max(Re,Re*n,Ne,Ne*n),J=(Ie,Re,Ne)=>WO(Ie,s,T,!0)?-1:Math.min(Re,Re*n,Ne,Ne*n),X=$(0,D,z),te=$(ol,P,F),ie=J(to,D,z),we=J(to+ol,P,F);r=(X-ie)/2,c=(te-we)/2,d=-(X+ie)/2,m=-(te+we)/2}return{ratioX:r,ratioY:c,offsetX:d,offsetY:m}}class MS extends Vw{constructor(e,n){super(e,n),this.enableOptionSharing=!0,this.innerRadius=void 0,this.outerRadius=void 0,this.offsetX=void 0,this.offsetY=void 0}linkScales(){}parse(e,n){const r=this.getDataset().data,c=this._cachedMeta;if(this._parsing===!1)c._parsed=r;else{let d=T=>+r[T];if(_s(r[e])){const{key:T="value"}=this._parsing;d=D=>+Tx(r[D],T)}let m,s;for(m=e,s=e+n;m<s;++m)c._parsed[m]=d(m)}}_getRotation(){return v_(this.options.rotation-90)}_getCircumference(){return v_(this.options.circumference)}_getRotationExtents(){let e=Fa,n=-Fa;for(let r=0;r<this.chart.data.datasets.length;++r)if(this.chart.isDatasetVisible(r)&&this.chart.getDatasetMeta(r).type===this._type){const c=this.chart.getDatasetMeta(r).controller,d=c._getRotation(),m=c._getCircumference();e=Math.min(e,d),n=Math.max(n,d+m)}return{rotation:e,circumference:n-e}}update(e){const n=this.chart,{chartArea:r}=n,c=this._cachedMeta,d=c.data,m=this.getMaxBorderWidth()+this.getMaxOffset(d)+this.options.spacing,s=Math.max((Math.min(r.width,r.height)-m)/2,0),T=Math.min(uoe(this.options.cutout,s),1),D=this._getRingWeight(this.index),{circumference:P,rotation:z}=this._getRotationExtents(),{ratioX:F,ratioY:$,offsetX:J,offsetY:X}=zae(z,P,T),te=(r.width-m)/F,ie=(r.height-m)/$,we=Math.max(Math.min(te,ie)/2,0),Ie=_8(this.options.radius,we),Re=Math.max(Ie*T,0),Ne=(Ie-Re)/this._getVisibleDatasetWeightTotal();this.offsetX=J*Ie,this.offsetY=X*Ie,c.total=this.calculateTotal(),this.outerRadius=Ie-Ne*this._getRingWeightOffset(this.index),this.innerRadius=Math.max(this.outerRadius-Ne*D,0),this.updateElements(d,0,d.length,e)}_circumference(e,n){const r=this.options,c=this._cachedMeta,d=this._getCircumference();return n&&r.animation.animateRotate||!this.chart.getDataVisibility(e)||c._parsed[e]===null||c.data[e].hidden?0:this.calculateCircumference(c._parsed[e]*d/Fa)}updateElements(e,n,r,c){const d=c==="reset",m=this.chart,s=m.chartArea,D=m.options.animation,P=(s.left+s.right)/2,z=(s.top+s.bottom)/2,F=d&&D.animateScale,$=F?0:this.innerRadius,J=F?0:this.outerRadius,{sharedOptions:X,includeOptions:te}=this._getSharedOptions(n,c);let ie=this._getRotation(),we;for(we=0;we<n;++we)ie+=this._circumference(we,d);for(we=n;we<n+r;++we){const Ie=this._circumference(we,d),Re=e[we],Ne={x:P+this.offsetX,y:z+this.offsetY,startAngle:ie,endAngle:ie+Ie,circumference:Ie,outerRadius:J,innerRadius:$};te&&(Ne.options=X||this.resolveDataElementOptions(we,Re.active?"active":c)),ie+=Ie,this.updateElement(Re,we,Ne,c)}}calculateTotal(){const e=this._cachedMeta,n=e.data;let r=0,c;for(c=0;c<n.length;c++){const d=e._parsed[c];d!==null&&!isNaN(d)&&this.chart.getDataVisibility(c)&&!n[c].hidden&&(r+=Math.abs(d))}return r}calculateCircumference(e){const n=this._cachedMeta.total;return n>0&&!isNaN(e)?Fa*(Math.abs(e)/n):0}getLabelAndValue(e){const n=this._cachedMeta,r=this.chart,c=r.data.labels||[],d=mL(n._parsed[e],r.options.locale);return{label:c[e]||"",value:d}}getMaxBorderWidth(e){let n=0;const r=this.chart;let c,d,m,s,T;if(!e){for(c=0,d=r.data.datasets.length;c<d;++c)if(r.isDatasetVisible(c)){m=r.getDatasetMeta(c),e=m.data,s=m.controller;break}}if(!e)return 0;for(c=0,d=e.length;c<d;++c)T=s.resolveDataElementOptions(c),T.borderAlign!=="inner"&&(n=Math.max(n,T.borderWidth||0,T.hoverBorderWidth||0));return n}getMaxOffset(e){let n=0;for(let r=0,c=e.length;r<c;++r){const d=this.resolveDataElementOptions(r);n=Math.max(n,d.offset||0,d.hoverOffset||0)}return n}_getRingWeightOffset(e){let n=0;for(let r=0;r<e;++r)this.chart.isDatasetVisible(r)&&(n+=this._getRingWeight(r));return n}_getRingWeight(e){return Math.max(gs(this.chart.data.datasets[e].weight,1),0)}_getVisibleDatasetWeightTotal(){return this._getRingWeightOffset(this.chart.data.datasets.length)||1}}ki(MS,"id","doughnut"),ki(MS,"defaults",{datasetElementType:!1,dataElementType:"arc",animation:{animateRotate:!0,animateScale:!1},animations:{numbers:{type:"number",properties:["circumference","endAngle","innerRadius","outerRadius","startAngle","x","y","offset","borderWidth","spacing"]}},cutout:"50%",rotation:0,circumference:360,radius:"100%",spacing:0,indexAxis:"r"}),ki(MS,"descriptors",{_scriptable:e=>e!=="spacing",_indexable:e=>e!=="spacing"&&!e.startsWith("borderDash")&&!e.startsWith("hoverBorderDash")}),ki(MS,"overrides",{aspectRatio:1,plugins:{legend:{labels:{generateLabels(e){const n=e.data;if(n.labels.length&&n.datasets.length){const{labels:{pointStyle:r,color:c}}=e.legend.options;return n.labels.map((d,m)=>{const T=e.getDatasetMeta(0).controller.getStyle(m);return{text:d,fillStyle:T.backgroundColor,strokeStyle:T.borderColor,fontColor:c,lineWidth:T.borderWidth,pointStyle:r,hidden:!e.getDataVisibility(m),index:m}})}return[]}},onClick(e,n,r){r.chart.toggleDataVisibility(n.index),r.chart.update()}}}});function Zb(){throw new Error("This method is not implemented: Check that a complete date adapter is provided.")}class EL{constructor(e){ki(this,"options");this.options=e||{}}static override(e){Object.assign(EL.prototype,e)}init(){}formats(){return Zb()}parse(){return Zb()}format(){return Zb()}add(){return Zb()}diff(){return Zb()}startOf(){return Zb()}endOf(){return Zb()}}var Bae={_date:EL};function Fae(t,e,n,r){const{controller:c,data:d,_sorted:m}=t,s=c._cachedMeta.iScale,T=t.dataset&&t.dataset.options?t.dataset.options.spanGaps:null;if(s&&e===s.axis&&e!=="r"&&m&&d.length){const D=s._reversePixels?Eoe:uN;if(r){if(c._sharedOptions){const P=d[0],z=typeof P.getRange=="function"&&P.getRange(e);if(z){const F=D(d,e,n-z),$=D(d,e,n+z);return{lo:F.lo,hi:$.hi}}}}else{const P=D(d,e,n);if(T){const{vScale:z}=c._cachedMeta,{_parsed:F}=t,$=F.slice(0,P.lo+1).reverse().findIndex(X=>!no(X[z.axis]));P.lo-=Math.max(0,$);const J=F.slice(P.hi).findIndex(X=>!no(X[z.axis]));P.hi+=Math.max(0,J)}return P}}return{lo:0,hi:d.length-1}}function lM(t,e,n,r,c){const d=t.getSortedVisibleDatasetMetas(),m=n[e];for(let s=0,T=d.length;s<T;++s){const{index:D,data:P}=d[s],{lo:z,hi:F}=Fae(d[s],e,m,c);for(let $=z;$<=F;++$){const J=P[$];J.skip||r(J,D,$)}}}function Vae(t){const e=t.indexOf("x")!==-1,n=t.indexOf("y")!==-1;return function(r,c){const d=e?Math.abs(r.x-c.x):0,m=n?Math.abs(r.y-c.y):0;return Math.sqrt(Math.pow(d,2)+Math.pow(m,2))}}function VP(t,e,n,r,c){const d=[];return!c&&!t.isPointInArea(e)||lM(t,n,e,function(s,T,D){!c&&!D8(s,t.chartArea,0)||s.inRange(e.x,e.y,r)&&d.push({element:s,datasetIndex:T,index:D})},!0),d}function Uae(t,e,n,r){let c=[];function d(m,s,T){const{startAngle:D,endAngle:P}=m.getProps(["startAngle","endAngle"],r),{angle:z}=b8(m,{x:e.x,y:e.y});WO(z,D,P)&&c.push({element:m,datasetIndex:s,index:T})}return lM(t,n,e,d),c}function jae(t,e,n,r,c,d){let m=[];const s=Vae(n);let T=Number.POSITIVE_INFINITY;function D(P,z,F){const $=P.inRange(e.x,e.y,c);if(r&&!$)return;const J=P.getCenterPoint(c);if(!(!!d||t.isPointInArea(J))&&!$)return;const te=s(e,J);te<T?(m=[{element:P,datasetIndex:z,index:F}],T=te):te===T&&m.push({element:P,datasetIndex:z,index:F})}return lM(t,n,e,D),m}function UP(t,e,n,r,c,d){return!d&&!t.isPointInArea(e)?[]:n==="r"&&!r?Uae(t,e,n,c):jae(t,e,n,r,c,d)}function tV(t,e,n,r,c){const d=[],m=n==="x"?"inXRange":"inYRange";let s=!1;return lM(t,n,e,(T,D,P)=>{T[m]&&T[m](e[n],c)&&(d.push({element:T,datasetIndex:D,index:P}),s=s||T.inRange(e.x,e.y,c))}),r&&!s?[]:d}var Hae={modes:{index(t,e,n,r){const c=Jb(e,t),d=n.axis||"x",m=n.includeInvisible||!1,s=n.intersect?VP(t,c,d,r,m):UP(t,c,d,!1,r,m),T=[];return s.length?(t.getSortedVisibleDatasetMetas().forEach(D=>{const P=s[0].index,z=D.data[P];z&&!z.skip&&T.push({element:z,datasetIndex:D.index,index:P})}),T):[]},dataset(t,e,n,r){const c=Jb(e,t),d=n.axis||"xy",m=n.includeInvisible||!1;let s=n.intersect?VP(t,c,d,r,m):UP(t,c,d,!1,r,m);if(s.length>0){const T=s[0].datasetIndex,D=t.getDatasetMeta(T).data;s=[];for(let P=0;P<D.length;++P)s.push({element:D[P],datasetIndex:T,index:P})}return s},point(t,e,n,r){const c=Jb(e,t),d=n.axis||"xy",m=n.includeInvisible||!1;return VP(t,c,d,r,m)},nearest(t,e,n,r){const c=Jb(e,t),d=n.axis||"xy",m=n.includeInvisible||!1;return UP(t,c,d,n.intersect,r,m)},x(t,e,n,r){const c=Jb(e,t);return tV(t,c,"x",n.intersect,r)},y(t,e,n,r){const c=Jb(e,t);return tV(t,c,"y",n.intersect,r)}}};const F8=["left","top","right","bottom"];function gS(t,e){return t.filter(n=>n.pos===e)}function nV(t,e){return t.filter(n=>F8.indexOf(n.pos)===-1&&n.box.axis===e)}function _S(t,e){return t.sort((n,r)=>{const c=e?r:n,d=e?n:r;return c.weight===d.weight?c.index-d.index:c.weight-d.weight})}function $ae(t){const e=[];let n,r,c,d,m,s;for(n=0,r=(t||[]).length;n<r;++n)c=t[n],{position:d,options:{stack:m,stackWeight:s=1}}=c,e.push({index:n,box:c,pos:d,horizontal:c.isHorizontal(),weight:c.weight,stack:m&&d+m,stackWeight:s});return e}function Gae(t){const e={};for(const n of t){const{stack:r,pos:c,stackWeight:d}=n;if(!r||!F8.includes(c))continue;const m=e[r]||(e[r]={count:0,placed:0,weight:0,size:0});m.count++,m.weight+=d}return e}function qae(t,e){const n=Gae(t),{vBoxMaxWidth:r,hBoxMaxHeight:c}=e;let d,m,s;for(d=0,m=t.length;d<m;++d){s=t[d];const{fullSize:T}=s.box,D=n[s.stack],P=D&&s.stackWeight/D.weight;s.horizontal?(s.width=P?P*r:T&&e.availableWidth,s.height=c):(s.width=r,s.height=P?P*c:T&&e.availableHeight)}return n}function Wae(t){const e=$ae(t),n=_S(e.filter(D=>D.box.fullSize),!0),r=_S(gS(e,"left"),!0),c=_S(gS(e,"right")),d=_S(gS(e,"top"),!0),m=_S(gS(e,"bottom")),s=nV(e,"x"),T=nV(e,"y");return{fullSize:n,leftAndTop:r.concat(d),rightAndBottom:c.concat(T).concat(m).concat(s),chartArea:gS(e,"chartArea"),vertical:r.concat(c).concat(T),horizontal:d.concat(m).concat(s)}}function iV(t,e,n,r){return Math.max(t[n],e[n])+Math.max(t[r],e[r])}function V8(t,e){t.top=Math.max(t.top,e.top),t.left=Math.max(t.left,e.left),t.bottom=Math.max(t.bottom,e.bottom),t.right=Math.max(t.right,e.right)}function Yae(t,e,n,r){const{pos:c,box:d}=n,m=t.maxPadding;if(!_s(c)){n.size&&(t[c]-=n.size);const z=r[n.stack]||{size:0,count:1};z.size=Math.max(z.size,n.horizontal?d.height:d.width),n.size=z.size/z.count,t[c]+=n.size}d.getPadding&&V8(m,d.getPadding());const s=Math.max(0,e.outerWidth-iV(m,t,"left","right")),T=Math.max(0,e.outerHeight-iV(m,t,"top","bottom")),D=s!==t.w,P=T!==t.h;return t.w=s,t.h=T,n.horizontal?{same:D,other:P}:{same:P,other:D}}function Zae(t){const e=t.maxPadding;function n(r){const c=Math.max(e[r]-t[r],0);return t[r]+=c,c}t.y+=n("top"),t.x+=n("left"),n("right"),n("bottom")}function Xae(t,e){const n=e.maxPadding;function r(c){const d={left:0,top:0,right:0,bottom:0};return c.forEach(m=>{d[m]=Math.max(e[m],n[m])}),d}return r(t?["left","right"]:["top","bottom"])}function PS(t,e,n,r){const c=[];let d,m,s,T,D,P;for(d=0,m=t.length,D=0;d<m;++d){s=t[d],T=s.box,T.update(s.width||e.w,s.height||e.h,Xae(s.horizontal,e));const{same:z,other:F}=Yae(e,n,s,r);D|=z&&c.length,P=P||F,T.fullSize||c.push(s)}return D&&PS(c,e,n,r)||P}function yR(t,e,n,r,c){t.top=n,t.left=e,t.right=e+r,t.bottom=n+c,t.width=r,t.height=c}function rV(t,e,n,r){const c=n.padding;let{x:d,y:m}=e;for(const s of t){const T=s.box,D=r[s.stack]||{placed:0,weight:1},P=s.stackWeight/D.weight||1;if(s.horizontal){const z=e.w*P,F=D.size||T.height;vA(D.start)&&(m=D.start),T.fullSize?yR(T,c.left,m,n.outerWidth-c.right-c.left,F):yR(T,e.left+D.placed,m,z,F),D.start=m,D.placed+=z,m=T.bottom}else{const z=e.h*P,F=D.size||T.width;vA(D.start)&&(d=D.start),T.fullSize?yR(T,d,c.top,F,n.outerHeight-c.bottom-c.top):yR(T,d,e.top+D.placed,F,z),D.start=d,D.placed+=z,d=T.right}}e.x=d,e.y=m}var Kd={addBox(t,e){t.boxes||(t.boxes=[]),e.fullSize=e.fullSize||!1,e.position=e.position||"top",e.weight=e.weight||0,e._layers=e._layers||function(){return[{z:0,draw(n){e.draw(n)}}]},t.boxes.push(e)},removeBox(t,e){const n=t.boxes?t.boxes.indexOf(e):-1;n!==-1&&t.boxes.splice(n,1)},configure(t,e,n){e.fullSize=n.fullSize,e.position=n.position,e.weight=n.weight},update(t,e,n,r){if(!t)return;const c=of(t.options.layout.padding),d=Math.max(e-c.width,0),m=Math.max(n-c.height,0),s=Wae(t.boxes),T=s.vertical,D=s.horizontal;Gs(t.boxes,X=>{typeof X.beforeLayout=="function"&&X.beforeLayout()});const P=T.reduce((X,te)=>te.box.options&&te.box.options.display===!1?X:X+1,0)||1,z=Object.freeze({outerWidth:e,outerHeight:n,padding:c,availableWidth:d,availableHeight:m,vBoxMaxWidth:d/2/P,hBoxMaxHeight:m/2}),F=Object.assign({},c);V8(F,of(r));const $=Object.assign({maxPadding:F,w:d,h:m,x:c.left,y:c.top},c),J=qae(T.concat(D),z);PS(s.fullSize,$,z,J),PS(T,$,z,J),PS(D,$,z,J)&&PS(T,$,z,J),Zae($),rV(s.leftAndTop,$,z,J),$.x+=$.w,$.y+=$.h,rV(s.rightAndBottom,$,z,J),t.chartArea={left:$.left,top:$.top,right:$.left+$.w,bottom:$.top+$.h,height:$.h,width:$.w},Gs(s.chartArea,X=>{const te=X.box;Object.assign(te,t.chartArea),te.update($.w,$.h,{left:0,top:0,right:0,bottom:0})})}};class U8{acquireContext(e,n){}releaseContext(e){return!1}addEventListener(e,n,r){}removeEventListener(e,n,r){}getDevicePixelRatio(){return 1}getMaximumSize(e,n,r,c){return n=Math.max(0,n||e.width),r=r||e.height,{width:n,height:Math.max(0,c?Math.floor(n/c):r)}}isAttached(e){return!0}updateConfig(e){}}class Qae extends U8{acquireContext(e){return e&&e.getContext&&e.getContext("2d")||null}updateConfig(e){e.options.animation=!1}}const tO="$chartjs",Kae={touchstart:"mousedown",touchmove:"mousemove",touchend:"mouseup",pointerenter:"mouseenter",pointerdown:"mousedown",pointermove:"mousemove",pointerup:"mouseup",pointerleave:"mouseout",pointerout:"mouseout"},sV=t=>t===null||t==="";function Jae(t,e){const n=t.style,r=t.getAttribute("height"),c=t.getAttribute("width");if(t[tO]={initial:{height:r,width:c,style:{display:n.display,height:n.height,width:n.width}}},n.display=n.display||"block",n.boxSizing=n.boxSizing||"border-box",sV(c)){const d=GF(t,"width");d!==void 0&&(t.width=d)}if(sV(r))if(t.style.height==="")t.height=t.width/(e||2);else{const d=GF(t,"height");d!==void 0&&(t.height=d)}return t}const j8=lae?{passive:!0}:!1;function ele(t,e,n){t&&t.addEventListener(e,n,j8)}function tle(t,e,n){t&&t.canvas&&t.canvas.removeEventListener(e,n,j8)}function nle(t,e){const n=Kae[t.type]||t.type,{x:r,y:c}=Jb(t,e);return{type:n,chart:e,native:t,x:r!==void 0?r:null,y:c!==void 0?c:null}}function XO(t,e){for(const n of t)if(n===e||n.contains(e))return!0}function ile(t,e,n){const r=t.canvas,c=new MutationObserver(d=>{let m=!1;for(const s of d)m=m||XO(s.addedNodes,r),m=m&&!XO(s.removedNodes,r);m&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}function rle(t,e,n){const r=t.canvas,c=new MutationObserver(d=>{let m=!1;for(const s of d)m=m||XO(s.removedNodes,r),m=m&&!XO(s.addedNodes,r);m&&n()});return c.observe(document,{childList:!0,subtree:!0}),c}const xA=new Map;let oV=0;function H8(){const t=window.devicePixelRatio;t!==oV&&(oV=t,xA.forEach((e,n)=>{n.currentDevicePixelRatio!==t&&e()}))}function sle(t,e){xA.size||window.addEventListener("resize",H8),xA.set(t,e)}function ole(t){xA.delete(t),xA.size||window.removeEventListener("resize",H8)}function ale(t,e,n){const r=t.canvas,c=r&&TL(r);if(!c)return;const d=E8((s,T)=>{const D=c.clientWidth;n(s,T),D<c.clientWidth&&n()},window),m=new ResizeObserver(s=>{const T=s[0],D=T.contentRect.width,P=T.contentRect.height;D===0&&P===0||d(D,P)});return m.observe(c),sle(t,d),m}function jP(t,e,n){n&&n.disconnect(),e==="resize"&&ole(t)}function lle(t,e,n){const r=t.canvas,c=E8(d=>{t.ctx!==null&&n(nle(d,t))},t);return ele(r,e,c),c}class cle extends U8{acquireContext(e,n){const r=e&&e.getContext&&e.getContext("2d");return r&&r.canvas===e?(Jae(e,n),r):null}releaseContext(e){const n=e.canvas;if(!n[tO])return!1;const r=n[tO].initial;["height","width"].forEach(d=>{const m=r[d];no(m)?n.removeAttribute(d):n.setAttribute(d,m)});const c=r.style||{};return Object.keys(c).forEach(d=>{n.style[d]=c[d]}),n.width=n.width,delete n[tO],!0}addEventListener(e,n,r){this.removeEventListener(e,n);const c=e.$proxies||(e.$proxies={}),m={attach:ile,detach:rle,resize:ale}[n]||lle;c[n]=m(e,n,r)}removeEventListener(e,n){const r=e.$proxies||(e.$proxies={}),c=r[n];if(!c)return;({attach:jP,detach:jP,resize:jP}[n]||tle)(e,n,c),r[n]=void 0}getDevicePixelRatio(){return window.devicePixelRatio}getMaximumSize(e,n,r,c){return aae(e,n,r,c)}isAttached(e){const n=e&&TL(e);return!!(n&&n.isConnected)}}function ule(t){return!wL()||typeof OffscreenCanvas<"u"&&t instanceof OffscreenCanvas?Qae:cle}var MR;let Mx=(MR=class{constructor(){ki(this,"x");ki(this,"y");ki(this,"active",!1);ki(this,"options");ki(this,"$animations")}tooltipPosition(e){const{x:n,y:r}=this.getProps(["x","y"],e);return{x:n,y:r}}hasValue(){return qO(this.x)&&qO(this.y)}getProps(e,n){const r=this.$animations;if(!n||!r)return this;const c={};return e.forEach(d=>{c[d]=r[d]&&r[d].active()?r[d]._to:this[d]}),c}},ki(MR,"defaults",{}),ki(MR,"defaultRoutes"),MR);function hle(t,e){const n=t.options.ticks,r=dle(t),c=Math.min(n.maxTicksLimit||r,r),d=n.major.enabled?ple(e):[],m=d.length,s=d[0],T=d[m-1],D=[];if(m>c)return mle(e,D,d,m/c),D;const P=fle(d,e,c);if(m>0){let z,F;const $=m>1?Math.round((T-s)/(m-1)):null;for(vR(e,D,P,no($)?0:s-$,s),z=0,F=m-1;z<F;z++)vR(e,D,P,d[z],d[z+1]);return vR(e,D,P,T,no($)?e.length:T+$),D}return vR(e,D,P),D}function dle(t){const e=t.options.offset,n=t._tickSize(),r=t._length/n+(e?0:1),c=t._maxLength/n;return Math.floor(Math.min(r,c))}function fle(t,e,n){const r=gle(t),c=e.length/n;if(!r)return Math.max(c,1);const d=_oe(r);for(let m=0,s=d.length-1;m<s;m++){const T=d[m];if(T>c)return T}return Math.max(c,1)}function ple(t){const e=[];let n,r;for(n=0,r=t.length;n<r;n++)t[n].major&&e.push(n);return e}function mle(t,e,n,r){let c=0,d=n[0],m;for(r=Math.ceil(r),m=0;m<t.length;m++)m===d&&(e.push(t[m]),c++,d=n[c*r])}function vR(t,e,n,r,c){const d=gs(r,0),m=Math.min(gs(c,t.length),t.length);let s=0,T,D,P;for(n=Math.ceil(n),c&&(T=c-r,n=T/Math.floor(T/n)),P=d;P<0;)s++,P=Math.round(d+s*n);for(D=Math.max(d,0);D<m;D++)D===P&&(e.push(t[D]),s++,P=Math.round(d+s*n))}function gle(t){const e=t.length;let n,r;if(e<2)return!1;for(r=t[0],n=1;n<e;++n)if(t[n]-t[n-1]!==r)return!1;return r}const _le=t=>t==="left"?"right":t==="right"?"left":t,aV=(t,e,n)=>e==="top"||e==="left"?t[e]+n:t[e]-n,lV=(t,e)=>Math.min(e||t,t);function cV(t,e){const n=[],r=t.length/e,c=t.length;let d=0;for(;d<c;d+=r)n.push(t[Math.floor(d)]);return n}function yle(t,e,n){const r=t.ticks.length,c=Math.min(e,r-1),d=t._startPixel,m=t._endPixel,s=1e-6;let T=t.getPixelForTick(c),D;if(!(n&&(r===1?D=Math.max(T-d,m-T):e===0?D=(t.getPixelForTick(1)-T)/2:D=(T-t.getPixelForTick(c-1))/2,T+=c<e?D:-D,T<d-s||T>m+s)))return T}function vle(t,e){Gs(t,n=>{const r=n.gc,c=r.length/2;let d;if(c>e){for(d=0;d<c;++d)delete n.data[r[d]];r.splice(0,c)}})}function yS(t){return t.drawTicks?t.tickLength:0}function uV(t,e){if(!t.display)return 0;const n=Fc(t.font,e),r=of(t.padding);return(sl(t.text)?t.text.length:1)*n.lineHeight+r.height}function ble(t,e){return ET(t,{scale:e,type:"scale"})}function xle(t,e,n){return ET(t,{tick:n,index:e,type:"tick"})}function wle(t,e,n){let r=pL(t);return(n&&e!=="right"||!n&&e==="right")&&(r=_le(r)),r}function Tle(t,e,n,r){const{top:c,left:d,bottom:m,right:s,chart:T}=t,{chartArea:D,scales:P}=T;let z=0,F,$,J;const X=m-c,te=s-d;if(t.isHorizontal()){if($=Pc(r,d,s),_s(n)){const ie=Object.keys(n)[0],we=n[ie];J=P[ie].getPixelForValue(we)+X-e}else n==="center"?J=(D.bottom+D.top)/2+X-e:J=aV(t,n,e);F=s-d}else{if(_s(n)){const ie=Object.keys(n)[0],we=n[ie];$=P[ie].getPixelForValue(we)-te+e}else n==="center"?$=(D.left+D.right)/2-te+e:$=aV(t,n,e);J=Pc(r,m,c),z=n==="left"?-ol:ol}return{titleX:$,titleY:J,maxWidth:F,rotation:z}}class ST extends Mx{constructor(e){super(),this.id=e.id,this.type=e.type,this.options=void 0,this.ctx=e.ctx,this.chart=e.chart,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this._margins={left:0,right:0,top:0,bottom:0},this.maxWidth=void 0,this.maxHeight=void 0,this.paddingTop=void 0,this.paddingBottom=void 0,this.paddingLeft=void 0,this.paddingRight=void 0,this.axis=void 0,this.labelRotation=void 0,this.min=void 0,this.max=void 0,this._range=void 0,this.ticks=[],this._gridLineItems=null,this._labelItems=null,this._labelSizes=null,this._length=0,this._maxLength=0,this._longestTextCache={},this._startPixel=void 0,this._endPixel=void 0,this._reversePixels=!1,this._userMax=void 0,this._userMin=void 0,this._suggestedMax=void 0,this._suggestedMin=void 0,this._ticksLength=0,this._borderValue=0,this._cache={},this._dataLimitsCached=!1,this.$context=void 0}init(e){this.options=e.setContext(this.getContext()),this.axis=e.axis,this._userMin=this.parse(e.min),this._userMax=this.parse(e.max),this._suggestedMin=this.parse(e.suggestedMin),this._suggestedMax=this.parse(e.suggestedMax)}parse(e,n){return e}getUserBounds(){let{_userMin:e,_userMax:n,_suggestedMin:r,_suggestedMax:c}=this;return e=Cm(e,Number.POSITIVE_INFINITY),n=Cm(n,Number.NEGATIVE_INFINITY),r=Cm(r,Number.POSITIVE_INFINITY),c=Cm(c,Number.NEGATIVE_INFINITY),{min:Cm(e,r),max:Cm(n,c),minDefined:sf(e),maxDefined:sf(n)}}getMinMax(e){let{min:n,max:r,minDefined:c,maxDefined:d}=this.getUserBounds(),m;if(c&&d)return{min:n,max:r};const s=this.getMatchingVisibleMetas();for(let T=0,D=s.length;T<D;++T)m=s[T].controller.getMinMax(this,e),c||(n=Math.min(n,m.min)),d||(r=Math.max(r,m.max));return n=d&&n>r?r:n,r=c&&n>r?n:r,{min:Cm(n,Cm(r,n)),max:Cm(r,Cm(n,r))}}getPadding(){return{left:this.paddingLeft||0,top:this.paddingTop||0,right:this.paddingRight||0,bottom:this.paddingBottom||0}}getTicks(){return this.ticks}getLabels(){const e=this.chart.data;return this.options.labels||(this.isHorizontal()?e.xLabels:e.yLabels)||e.labels||[]}getLabelItems(e=this.chart.chartArea){return this._labelItems||(this._labelItems=this._computeLabelItems(e))}beforeLayout(){this._cache={},this._dataLimitsCached=!1}beforeUpdate(){vo(this.options.beforeUpdate,[this])}update(e,n,r){const{beginAtZero:c,grace:d,ticks:m}=this.options,s=m.sampleSize;this.beforeUpdate(),this.maxWidth=e,this.maxHeight=n,this._margins=r=Object.assign({left:0,right:0,top:0,bottom:0},r),this.ticks=null,this._labelSizes=null,this._gridLineItems=null,this._labelItems=null,this.beforeSetDimensions(),this.setDimensions(),this.afterSetDimensions(),this._maxLength=this.isHorizontal()?this.width+r.left+r.right:this.height+r.top+r.bottom,this._dataLimitsCached||(this.beforeDataLimits(),this.determineDataLimits(),this.afterDataLimits(),this._range=qoe(this,d,c),this._dataLimitsCached=!0),this.beforeBuildTicks(),this.ticks=this.buildTicks()||[],this.afterBuildTicks();const T=s<this.ticks.length;this._convertTicksToLabels(T?cV(this.ticks,s):this.ticks),this.configure(),this.beforeCalculateLabelRotation(),this.calculateLabelRotation(),this.afterCalculateLabelRotation(),m.display&&(m.autoSkip||m.source==="auto")&&(this.ticks=hle(this,this.ticks),this._labelSizes=null,this.afterAutoSkip()),T&&this._convertTicksToLabels(this.ticks),this.beforeFit(),this.fit(),this.afterFit(),this.afterUpdate()}configure(){let e=this.options.reverse,n,r;this.isHorizontal()?(n=this.left,r=this.right):(n=this.top,r=this.bottom,e=!e),this._startPixel=n,this._endPixel=r,this._reversePixels=e,this._length=r-n,this._alignToPixels=this.options.alignToPixels}afterUpdate(){vo(this.options.afterUpdate,[this])}beforeSetDimensions(){vo(this.options.beforeSetDimensions,[this])}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=0,this.right=this.width):(this.height=this.maxHeight,this.top=0,this.bottom=this.height),this.paddingLeft=0,this.paddingTop=0,this.paddingRight=0,this.paddingBottom=0}afterSetDimensions(){vo(this.options.afterSetDimensions,[this])}_callHooks(e){this.chart.notifyPlugins(e,this.getContext()),vo(this.options[e],[this])}beforeDataLimits(){this._callHooks("beforeDataLimits")}determineDataLimits(){}afterDataLimits(){this._callHooks("afterDataLimits")}beforeBuildTicks(){this._callHooks("beforeBuildTicks")}buildTicks(){return[]}afterBuildTicks(){this._callHooks("afterBuildTicks")}beforeTickToLabelConversion(){vo(this.options.beforeTickToLabelConversion,[this])}generateTickLabels(e){const n=this.options.ticks;let r,c,d;for(r=0,c=e.length;r<c;r++)d=e[r],d.label=vo(n.callback,[d.value,r,e],this)}afterTickToLabelConversion(){vo(this.options.afterTickToLabelConversion,[this])}beforeCalculateLabelRotation(){vo(this.options.beforeCalculateLabelRotation,[this])}calculateLabelRotation(){const e=this.options,n=e.ticks,r=lV(this.ticks.length,e.ticks.maxTicksLimit),c=n.minRotation||0,d=n.maxRotation;let m=c,s,T,D;if(!this._isVisible()||!n.display||c>=d||r<=1||!this.isHorizontal()){this.labelRotation=c;return}const P=this._getLabelSizes(),z=P.widest.width,F=P.highest.height,$=$u(this.chart.width-z,0,this.maxWidth);s=e.offset?this.maxWidth/r:$/(r-1),z+6>s&&(s=$/(r-(e.offset?.5:1)),T=this.maxHeight-yS(e.grid)-n.padding-uV(e.title,this.chart.options.font),D=Math.sqrt(z*z+F*F),m=xoe(Math.min(Math.asin($u((P.highest.height+6)/s,-1,1)),Math.asin($u(T/D,-1,1))-Math.asin($u(F/D,-1,1)))),m=Math.max(c,Math.min(d,m))),this.labelRotation=m}afterCalculateLabelRotation(){vo(this.options.afterCalculateLabelRotation,[this])}afterAutoSkip(){}beforeFit(){vo(this.options.beforeFit,[this])}fit(){const e={width:0,height:0},{chart:n,options:{ticks:r,title:c,grid:d}}=this,m=this._isVisible(),s=this.isHorizontal();if(m){const T=uV(c,n.options.font);if(s?(e.width=this.maxWidth,e.height=yS(d)+T):(e.height=this.maxHeight,e.width=yS(d)+T),r.display&&this.ticks.length){const{first:D,last:P,widest:z,highest:F}=this._getLabelSizes(),$=r.padding*2,J=v_(this.labelRotation),X=Math.cos(J),te=Math.sin(J);if(s){const ie=r.mirror?0:te*z.width+X*F.height;e.height=Math.min(this.maxHeight,e.height+ie+$)}else{const ie=r.mirror?0:X*z.width+te*F.height;e.width=Math.min(this.maxWidth,e.width+ie+$)}this._calculatePadding(D,P,te,X)}}this._handleMargins(),s?(this.width=this._length=n.width-this._margins.left-this._margins.right,this.height=e.height):(this.width=e.width,this.height=this._length=n.height-this._margins.top-this._margins.bottom)}_calculatePadding(e,n,r,c){const{ticks:{align:d,padding:m},position:s}=this.options,T=this.labelRotation!==0,D=s!=="top"&&this.axis==="x";if(this.isHorizontal()){const P=this.getPixelForTick(0)-this.left,z=this.right-this.getPixelForTick(this.ticks.length-1);let F=0,$=0;T?D?(F=c*e.width,$=r*n.height):(F=r*e.height,$=c*n.width):d==="start"?$=n.width:d==="end"?F=e.width:d!=="inner"&&(F=e.width/2,$=n.width/2),this.paddingLeft=Math.max((F-P+m)*this.width/(this.width-P),0),this.paddingRight=Math.max(($-z+m)*this.width/(this.width-z),0)}else{let P=n.height/2,z=e.height/2;d==="start"?(P=0,z=e.height):d==="end"&&(P=n.height,z=0),this.paddingTop=P+m,this.paddingBottom=z+m}}_handleMargins(){this._margins&&(this._margins.left=Math.max(this.paddingLeft,this._margins.left),this._margins.top=Math.max(this.paddingTop,this._margins.top),this._margins.right=Math.max(this.paddingRight,this._margins.right),this._margins.bottom=Math.max(this.paddingBottom,this._margins.bottom))}afterFit(){vo(this.options.afterFit,[this])}isHorizontal(){const{axis:e,position:n}=this.options;return n==="top"||n==="bottom"||e==="x"}isFullSize(){return this.options.fullSize}_convertTicksToLabels(e){this.beforeTickToLabelConversion(),this.generateTickLabels(e);let n,r;for(n=0,r=e.length;n<r;n++)no(e[n].label)&&(e.splice(n,1),r--,n--);this.afterTickToLabelConversion()}_getLabelSizes(){let e=this._labelSizes;if(!e){const n=this.options.ticks.sampleSize;let r=this.ticks;n<r.length&&(r=cV(r,n)),this._labelSizes=e=this._computeLabelSizes(r,r.length,this.options.ticks.maxTicksLimit)}return e}_computeLabelSizes(e,n,r){const{ctx:c,_longestTextCache:d}=this,m=[],s=[],T=Math.floor(n/lV(n,r));let D=0,P=0,z,F,$,J,X,te,ie,we,Ie,Re,Ne;for(z=0;z<n;z+=T){if(J=e[z].label,X=this._resolveTickFontOptions(z),c.font=te=X.string,ie=d[te]=d[te]||{data:{},gc:[]},we=X.lineHeight,Ie=Re=0,!no(J)&&!sl(J))Ie=FF(c,ie.data,ie.gc,Ie,J),Re=we;else if(sl(J))for(F=0,$=J.length;F<$;++F)Ne=J[F],!no(Ne)&&!sl(Ne)&&(Ie=FF(c,ie.data,ie.gc,Ie,Ne),Re+=we);m.push(Ie),s.push(Re),D=Math.max(Ie,D),P=Math.max(Re,P)}vle(d,n);const Xe=m.indexOf(D),be=s.indexOf(P),_e=Te=>({width:m[Te]||0,height:s[Te]||0});return{first:_e(0),last:_e(n-1),widest:_e(Xe),highest:_e(be),widths:m,heights:s}}getLabelForValue(e){return e}getPixelForValue(e,n){return NaN}getValueForPixel(e){}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getPixelForDecimal(e){this._reversePixels&&(e=1-e);const n=this._startPixel+e*this._length;return Toe(this._alignToPixels?Yb(this.chart,n,0):n)}getDecimalForPixel(e){const n=(e-this._startPixel)/this._length;return this._reversePixels?1-n:n}getBasePixel(){return this.getPixelForValue(this.getBaseValue())}getBaseValue(){const{min:e,max:n}=this;return e<0&&n<0?n:e>0&&n>0?e:0}getContext(e){const n=this.ticks||[];if(e>=0&&e<n.length){const r=n[e];return r.$context||(r.$context=xle(this.getContext(),e,r))}return this.$context||(this.$context=ble(this.chart.getContext(),this))}_tickSize(){const e=this.options.ticks,n=v_(this.labelRotation),r=Math.abs(Math.cos(n)),c=Math.abs(Math.sin(n)),d=this._getLabelSizes(),m=e.autoSkipPadding||0,s=d?d.widest.width+m:0,T=d?d.highest.height+m:0;return this.isHorizontal()?T*r>s*c?s/r:T/c:T*c<s*r?T/r:s/c}_isVisible(){const e=this.options.display;return e!=="auto"?!!e:this.getMatchingVisibleMetas().length>0}_computeGridLineItems(e){const n=this.axis,r=this.chart,c=this.options,{grid:d,position:m,border:s}=c,T=d.offset,D=this.isHorizontal(),z=this.ticks.length+(T?1:0),F=yS(d),$=[],J=s.setContext(this.getContext()),X=J.display?J.width:0,te=X/2,ie=function(mt){return Yb(r,mt,X)};let we,Ie,Re,Ne,Xe,be,_e,Te,oe,Ee,$e,ze;if(m==="top")we=ie(this.bottom),be=this.bottom-F,Te=we-te,Ee=ie(e.top)+te,ze=e.bottom;else if(m==="bottom")we=ie(this.top),Ee=e.top,ze=ie(e.bottom)-te,be=we+te,Te=this.top+F;else if(m==="left")we=ie(this.right),Xe=this.right-F,_e=we-te,oe=ie(e.left)+te,$e=e.right;else if(m==="right")we=ie(this.left),oe=e.left,$e=ie(e.right)-te,Xe=we+te,_e=this.left+F;else if(n==="x"){if(m==="center")we=ie((e.top+e.bottom)/2+.5);else if(_s(m)){const mt=Object.keys(m)[0],Ft=m[mt];we=ie(this.chart.scales[mt].getPixelForValue(Ft))}Ee=e.top,ze=e.bottom,be=we+te,Te=be+F}else if(n==="y"){if(m==="center")we=ie((e.left+e.right)/2);else if(_s(m)){const mt=Object.keys(m)[0],Ft=m[mt];we=ie(this.chart.scales[mt].getPixelForValue(Ft))}Xe=we-te,_e=Xe-F,oe=e.left,$e=e.right}const zt=gs(c.ticks.maxTicksLimit,z),St=Math.max(1,Math.ceil(z/zt));for(Ie=0;Ie<z;Ie+=St){const mt=this.getContext(Ie),Ft=d.setContext(mt),rn=s.setContext(mt),Xt=Ft.lineWidth,Fe=Ft.color,Ot=rn.dash||[],Ut=rn.dashOffset,ln=Ft.tickWidth,wn=Ft.tickColor,dn=Ft.tickBorderDash||[],Ht=Ft.tickBorderDashOffset;Re=yle(this,Ie,T),Re!==void 0&&(Ne=Yb(r,Re,Xt),D?Xe=_e=oe=$e=Ne:be=Te=Ee=ze=Ne,$.push({tx1:Xe,ty1:be,tx2:_e,ty2:Te,x1:oe,y1:Ee,x2:$e,y2:ze,width:Xt,color:Fe,borderDash:Ot,borderDashOffset:Ut,tickWidth:ln,tickColor:wn,tickBorderDash:dn,tickBorderDashOffset:Ht}))}return this._ticksLength=z,this._borderValue=we,$}_computeLabelItems(e){const n=this.axis,r=this.options,{position:c,ticks:d}=r,m=this.isHorizontal(),s=this.ticks,{align:T,crossAlign:D,padding:P,mirror:z}=d,F=yS(r.grid),$=F+P,J=z?-P:$,X=-v_(this.labelRotation),te=[];let ie,we,Ie,Re,Ne,Xe,be,_e,Te,oe,Ee,$e,ze="middle";if(c==="top")Xe=this.bottom-J,be=this._getXAxisLabelAlignment();else if(c==="bottom")Xe=this.top+J,be=this._getXAxisLabelAlignment();else if(c==="left"){const St=this._getYAxisLabelAlignment(F);be=St.textAlign,Ne=St.x}else if(c==="right"){const St=this._getYAxisLabelAlignment(F);be=St.textAlign,Ne=St.x}else if(n==="x"){if(c==="center")Xe=(e.top+e.bottom)/2+$;else if(_s(c)){const St=Object.keys(c)[0],mt=c[St];Xe=this.chart.scales[St].getPixelForValue(mt)+$}be=this._getXAxisLabelAlignment()}else if(n==="y"){if(c==="center")Ne=(e.left+e.right)/2-$;else if(_s(c)){const St=Object.keys(c)[0],mt=c[St];Ne=this.chart.scales[St].getPixelForValue(mt)}be=this._getYAxisLabelAlignment(F).textAlign}n==="y"&&(T==="start"?ze="top":T==="end"&&(ze="bottom"));const zt=this._getLabelSizes();for(ie=0,we=s.length;ie<we;++ie){Ie=s[ie],Re=Ie.label;const St=d.setContext(this.getContext(ie));_e=this.getPixelForTick(ie)+d.labelOffset,Te=this._resolveTickFontOptions(ie),oe=Te.lineHeight,Ee=sl(Re)?Re.length:1;const mt=Ee/2,Ft=St.color,rn=St.textStrokeColor,Xt=St.textStrokeWidth;let Fe=be;m?(Ne=_e,be==="inner"&&(ie===we-1?Fe=this.options.reverse?"left":"right":ie===0?Fe=this.options.reverse?"right":"left":Fe="center"),c==="top"?D==="near"||X!==0?$e=-Ee*oe+oe/2:D==="center"?$e=-zt.highest.height/2-mt*oe+oe:$e=-zt.highest.height+oe/2:D==="near"||X!==0?$e=oe/2:D==="center"?$e=zt.highest.height/2-mt*oe:$e=zt.highest.height-Ee*oe,z&&($e*=-1),X!==0&&!St.showLabelBackdrop&&(Ne+=oe/2*Math.sin(X))):(Xe=_e,$e=(1-Ee)*oe/2);let Ot;if(St.showLabelBackdrop){const Ut=of(St.backdropPadding),ln=zt.heights[ie],wn=zt.widths[ie];let dn=$e-Ut.top,Ht=0-Ut.left;switch(ze){case"middle":dn-=ln/2;break;case"bottom":dn-=ln;break}switch(be){case"center":Ht-=wn/2;break;case"right":Ht-=wn;break;case"inner":ie===we-1?Ht-=wn:ie>0&&(Ht-=wn/2);break}Ot={left:Ht,top:dn,width:wn+Ut.width,height:ln+Ut.height,color:St.backdropColor}}te.push({label:Re,font:Te,textOffset:$e,options:{rotation:X,color:Ft,strokeColor:rn,strokeWidth:Xt,textAlign:Fe,textBaseline:ze,translation:[Ne,Xe],backdrop:Ot}})}return te}_getXAxisLabelAlignment(){const{position:e,ticks:n}=this.options;if(-v_(this.labelRotation))return e==="top"?"left":"right";let c="center";return n.align==="start"?c="left":n.align==="end"?c="right":n.align==="inner"&&(c="inner"),c}_getYAxisLabelAlignment(e){const{position:n,ticks:{crossAlign:r,mirror:c,padding:d}}=this.options,m=this._getLabelSizes(),s=e+d,T=m.widest.width;let D,P;return n==="left"?c?(P=this.right+d,r==="near"?D="left":r==="center"?(D="center",P+=T/2):(D="right",P+=T)):(P=this.right-s,r==="near"?D="right":r==="center"?(D="center",P-=T/2):(D="left",P=this.left)):n==="right"?c?(P=this.left+d,r==="near"?D="right":r==="center"?(D="center",P-=T/2):(D="left",P-=T)):(P=this.left+s,r==="near"?D="left":r==="center"?(D="center",P+=T/2):(D="right",P=this.right)):D="right",{textAlign:D,x:P}}_computeLabelArea(){if(this.options.ticks.mirror)return;const e=this.chart,n=this.options.position;if(n==="left"||n==="right")return{top:0,left:this.left,bottom:e.height,right:this.right};if(n==="top"||n==="bottom")return{top:this.top,left:0,bottom:this.bottom,right:e.width}}drawBackground(){const{ctx:e,options:{backgroundColor:n},left:r,top:c,width:d,height:m}=this;n&&(e.save(),e.fillStyle=n,e.fillRect(r,c,d,m),e.restore())}getLineWidthForValue(e){const n=this.options.grid;if(!this._isVisible()||!n.display)return 0;const c=this.ticks.findIndex(d=>d.value===e);return c>=0?n.setContext(this.getContext(c)).lineWidth:0}drawGrid(e){const n=this.options.grid,r=this.ctx,c=this._gridLineItems||(this._gridLineItems=this._computeGridLineItems(e));let d,m;const s=(T,D,P)=>{!P.width||!P.color||(r.save(),r.lineWidth=P.width,r.strokeStyle=P.color,r.setLineDash(P.borderDash||[]),r.lineDashOffset=P.borderDashOffset,r.beginPath(),r.moveTo(T.x,T.y),r.lineTo(D.x,D.y),r.stroke(),r.restore())};if(n.display)for(d=0,m=c.length;d<m;++d){const T=c[d];n.drawOnChartArea&&s({x:T.x1,y:T.y1},{x:T.x2,y:T.y2},T),n.drawTicks&&s({x:T.tx1,y:T.ty1},{x:T.tx2,y:T.ty2},{color:T.tickColor,width:T.tickWidth,borderDash:T.tickBorderDash,borderDashOffset:T.tickBorderDashOffset})}}drawBorder(){const{chart:e,ctx:n,options:{border:r,grid:c}}=this,d=r.setContext(this.getContext()),m=r.display?d.width:0;if(!m)return;const s=c.setContext(this.getContext(0)).lineWidth,T=this._borderValue;let D,P,z,F;this.isHorizontal()?(D=Yb(e,this.left,m)-m/2,P=Yb(e,this.right,s)+s/2,z=F=T):(z=Yb(e,this.top,m)-m/2,F=Yb(e,this.bottom,s)+s/2,D=P=T),n.save(),n.lineWidth=d.width,n.strokeStyle=d.color,n.beginPath(),n.moveTo(D,z),n.lineTo(P,F),n.stroke(),n.restore()}drawLabels(e){if(!this.options.ticks.display)return;const r=this.ctx,c=this._computeLabelArea();c&&gL(r,c);const d=this.getLabelItems(e);for(const m of d){const s=m.options,T=m.font,D=m.label,P=m.textOffset;bA(r,D,0,P,T,s)}c&&_L(r)}drawTitle(){const{ctx:e,options:{position:n,title:r,reverse:c}}=this;if(!r.display)return;const d=Fc(r.font),m=of(r.padding),s=r.align;let T=d.lineHeight/2;n==="bottom"||n==="center"||_s(n)?(T+=m.bottom,sl(r.text)&&(T+=d.lineHeight*(r.text.length-1))):T+=m.top;const{titleX:D,titleY:P,maxWidth:z,rotation:F}=Tle(this,T,n,s);bA(e,r.text,0,0,d,{color:r.color,maxWidth:z,rotation:F,textAlign:wle(s,n,c),textBaseline:"middle",translation:[D,P]})}draw(e){this._isVisible()&&(this.drawBackground(),this.drawGrid(e),this.drawBorder(),this.drawTitle(),this.drawLabels(e))}_layers(){const e=this.options,n=e.ticks&&e.ticks.z||0,r=gs(e.grid&&e.grid.z,-1),c=gs(e.border&&e.border.z,0);return!this._isVisible()||this.draw!==ST.prototype.draw?[{z:n,draw:d=>{this.draw(d)}}]:[{z:r,draw:d=>{this.drawBackground(),this.drawGrid(d),this.drawTitle()}},{z:c,draw:()=>{this.drawBorder()}},{z:n,draw:d=>{this.drawLabels(d)}}]}getMatchingVisibleMetas(e){const n=this.chart.getSortedVisibleDatasetMetas(),r=this.axis+"AxisID",c=[];let d,m;for(d=0,m=n.length;d<m;++d){const s=n[d];s[r]===this.id&&(!e||s.type===e)&&c.push(s)}return c}_resolveTickFontOptions(e){const n=this.options.ticks.setContext(this.getContext(e));return Fc(n.font)}_maxDigits(){const e=this._resolveTickFontOptions(0).lineHeight;return(this.isHorizontal()?this.width:this.height)/e}}class bR{constructor(e,n,r){this.type=e,this.scope=n,this.override=r,this.items=Object.create(null)}isForType(e){return Object.prototype.isPrototypeOf.call(this.type.prototype,e.prototype)}register(e){const n=Object.getPrototypeOf(e);let r;Ale(n)&&(r=this.register(n));const c=this.items,d=e.id,m=this.scope+"."+d;if(!d)throw new Error("class does not have id: "+e);return d in c||(c[d]=e,Ele(e,m,r),this.override&&ga.override(e.id,e.overrides)),m}get(e){return this.items[e]}unregister(e){const n=this.items,r=e.id,c=this.scope;r in n&&delete n[r],c&&r in ga[c]&&(delete ga[c][r],this.override&&delete Ex[r])}}function Ele(t,e,n){const r=yA(Object.create(null),[n?ga.get(n):{},ga.get(e),t.defaults]);ga.set(e,r),t.defaultRoutes&&Sle(e,t.defaultRoutes),t.descriptors&&ga.describe(e,t.descriptors)}function Sle(t,e){Object.keys(e).forEach(n=>{const r=n.split("."),c=r.pop(),d=[t].concat(r).join("."),m=e[n].split("."),s=m.pop(),T=m.join(".");ga.route(d,c,T,s)})}function Ale(t){return"id"in t&&"defaults"in t}class Cle{constructor(){this.controllers=new bR(Vw,"datasets",!0),this.elements=new bR(Mx,"elements"),this.plugins=new bR(Object,"plugins"),this.scales=new bR(ST,"scales"),this._typedRegistries=[this.controllers,this.scales,this.elements]}add(...e){this._each("register",e)}remove(...e){this._each("unregister",e)}addControllers(...e){this._each("register",e,this.controllers)}addElements(...e){this._each("register",e,this.elements)}addPlugins(...e){this._each("register",e,this.plugins)}addScales(...e){this._each("register",e,this.scales)}getController(e){return this._get(e,this.controllers,"controller")}getElement(e){return this._get(e,this.elements,"element")}getPlugin(e){return this._get(e,this.plugins,"plugin")}getScale(e){return this._get(e,this.scales,"scale")}removeControllers(...e){this._each("unregister",e,this.controllers)}removeElements(...e){this._each("unregister",e,this.elements)}removePlugins(...e){this._each("unregister",e,this.plugins)}removeScales(...e){this._each("unregister",e,this.scales)}_each(e,n,r){[...n].forEach(c=>{const d=r||this._getRegistryForType(c);r||d.isForType(c)||d===this.plugins&&c.id?this._exec(e,d,c):Gs(c,m=>{const s=r||this._getRegistryForType(m);this._exec(e,s,m)})})}_exec(e,n,r){const c=dL(e);vo(r["before"+c],[],r),n[e](r),vo(r["after"+c],[],r)}_getRegistryForType(e){for(let n=0;n<this._typedRegistries.length;n++){const r=this._typedRegistries[n];if(r.isForType(e))return r}return this.plugins}_get(e,n,r){const c=n.get(e);if(c===void 0)throw new Error('"'+e+'" is not a registered '+r+".");return c}}var Mm=new Cle;class Dle{constructor(){this._init=[]}notify(e,n,r,c){n==="beforeInit"&&(this._init=this._createDescriptors(e,!0),this._notify(this._init,e,"install"));const d=c?this._descriptors(e).filter(c):this._descriptors(e),m=this._notify(d,e,n,r);return n==="afterDestroy"&&(this._notify(d,e,"stop"),this._notify(this._init,e,"uninstall")),m}_notify(e,n,r,c){c=c||{};for(const d of e){const m=d.plugin,s=m[r],T=[n,c,d.options];if(vo(s,T,m)===!1&&c.cancelable)return!1}return!0}invalidate(){no(this._cache)||(this._oldCache=this._cache,this._cache=void 0)}_descriptors(e){if(this._cache)return this._cache;const n=this._cache=this._createDescriptors(e);return this._notifyStateChanges(e),n}_createDescriptors(e,n){const r=e&&e.config,c=gs(r.options&&r.options.plugins,{}),d=Rle(r);return c===!1&&!n?[]:Ile(e,d,c,n)}_notifyStateChanges(e){const n=this._oldCache||[],r=this._cache,c=(d,m)=>d.filter(s=>!m.some(T=>s.plugin.id===T.plugin.id));this._notify(c(n,r),e,"stop"),this._notify(c(r,n),e,"start")}}function Rle(t){const e={},n=[],r=Object.keys(Mm.plugins.items);for(let d=0;d<r.length;d++)n.push(Mm.getPlugin(r[d]));const c=t.plugins||[];for(let d=0;d<c.length;d++){const m=c[d];n.indexOf(m)===-1&&(n.push(m),e[m.id]=!0)}return{plugins:n,localIds:e}}function Ole(t,e){return!e&&t===!1?null:t===!0?{}:t}function Ile(t,{plugins:e,localIds:n},r,c){const d=[],m=t.getContext();for(const s of e){const T=s.id,D=Ole(r[T],c);D!==null&&d.push({plugin:s,options:Mle(t.config,{plugin:s,local:n[T]},D,m)})}return d}function Mle(t,{plugin:e,local:n},r,c){const d=t.pluginScopeKeys(e),m=t.getOptionScopes(r,d);return n&&e.defaults&&m.push(e.defaults),t.createResolver(m,c,[""],{scriptable:!1,indexable:!1,allKeys:!0})}function dN(t,e){const n=ga.datasets[t]||{};return((e.datasets||{})[t]||{}).indexAxis||e.indexAxis||n.indexAxis||"x"}function Ple(t,e){let n=t;return t==="_index_"?n=e:t==="_value_"&&(n=e==="x"?"y":"x"),n}function kle(t,e){return t===e?"_index_":"_value_"}function hV(t){if(t==="x"||t==="y"||t==="r")return t}function Nle(t){if(t==="top"||t==="bottom")return"x";if(t==="left"||t==="right")return"y"}function fN(t,...e){if(hV(t))return t;for(const n of e){const r=n.axis||Nle(n.position)||t.length>1&&hV(t[0].toLowerCase());if(r)return r}throw new Error(`Cannot determine type of '${t}' axis. Please provide 'axis' or 'position' option.`)}function dV(t,e,n){if(n[e+"AxisID"]===t)return{axis:e}}function Lle(t,e){if(e.data&&e.data.datasets){const n=e.data.datasets.filter(r=>r.xAxisID===t||r.yAxisID===t);if(n.length)return dV(t,"x",n[0])||dV(t,"y",n[0])}return{}}function zle(t,e){const n=Ex[t.type]||{scales:{}},r=e.scales||{},c=dN(t.type,e),d=Object.create(null);return Object.keys(r).forEach(m=>{const s=r[m];if(!_s(s))return console.error(`Invalid scale configuration for scale: ${m}`);if(s._proxy)return console.warn(`Ignoring resolver passed as options for scale: ${m}`);const T=fN(m,s,Lle(m,t),ga.scales[s.type]),D=kle(T,c),P=n.scales||{};d[m]=qS(Object.create(null),[{axis:T},s,P[T],P[D]])}),t.data.datasets.forEach(m=>{const s=m.type||t.type,T=m.indexAxis||dN(s,e),P=(Ex[s]||{}).scales||{};Object.keys(P).forEach(z=>{const F=Ple(z,T),$=m[F+"AxisID"]||F;d[$]=d[$]||Object.create(null),qS(d[$],[{axis:F},r[$],P[z]])})}),Object.keys(d).forEach(m=>{const s=d[m];qS(s,[ga.scales[s.type],ga.scale])}),d}function $8(t){const e=t.options||(t.options={});e.plugins=gs(e.plugins,{}),e.scales=zle(t,e)}function G8(t){return t=t||{},t.datasets=t.datasets||[],t.labels=t.labels||[],t}function Ble(t){return t=t||{},t.data=G8(t.data),$8(t),t}const fV=new Map,q8=new Set;function xR(t,e){let n=fV.get(t);return n||(n=e(),fV.set(t,n),q8.add(n)),n}const vS=(t,e,n)=>{const r=Tx(e,n);r!==void 0&&t.add(r)};class Fle{constructor(e){this._config=Ble(e),this._scopeCache=new Map,this._resolverCache=new Map}get platform(){return this._config.platform}get type(){return this._config.type}set type(e){this._config.type=e}get data(){return this._config.data}set data(e){this._config.data=G8(e)}get options(){return this._config.options}set options(e){this._config.options=e}get plugins(){return this._config.plugins}update(){const e=this._config;this.clearCache(),$8(e)}clearCache(){this._scopeCache.clear(),this._resolverCache.clear()}datasetScopeKeys(e){return xR(e,()=>[[`datasets.${e}`,""]])}datasetAnimationScopeKeys(e,n){return xR(`${e}.transition.${n}`,()=>[[`datasets.${e}.transitions.${n}`,`transitions.${n}`],[`datasets.${e}`,""]])}datasetElementScopeKeys(e,n){return xR(`${e}-${n}`,()=>[[`datasets.${e}.elements.${n}`,`datasets.${e}`,`elements.${n}`,""]])}pluginScopeKeys(e){const n=e.id,r=this.type;return xR(`${r}-plugin-${n}`,()=>[[`plugins.${n}`,...e.additionalOptionScopes||[]]])}_cachedScopes(e,n){const r=this._scopeCache;let c=r.get(e);return(!c||n)&&(c=new Map,r.set(e,c)),c}getOptionScopes(e,n,r){const{options:c,type:d}=this,m=this._cachedScopes(e,r),s=m.get(n);if(s)return s;const T=new Set;n.forEach(P=>{e&&(T.add(e),P.forEach(z=>vS(T,e,z))),P.forEach(z=>vS(T,c,z)),P.forEach(z=>vS(T,Ex[d]||{},z)),P.forEach(z=>vS(T,ga,z)),P.forEach(z=>vS(T,hN,z))});const D=Array.from(T);return D.length===0&&D.push(Object.create(null)),q8.has(n)&&m.set(n,D),D}chartOptionScopes(){const{options:e,type:n}=this;return[e,Ex[n]||{},ga.datasets[n]||{},{type:n},ga,hN]}resolveNamedOptions(e,n,r,c=[""]){const d={$shared:!0},{resolver:m,subPrefixes:s}=pV(this._resolverCache,e,c);let T=m;if(Ule(m,n)){d.$shared=!1,r=i0(r)?r():r;const D=this.createResolver(e,r,s);T=aT(m,r,D)}for(const D of n)d[D]=T[D];return d}createResolver(e,n,r=[""],c){const{resolver:d}=pV(this._resolverCache,e,r);return _s(n)?aT(d,n,void 0,c):d}}function pV(t,e,n){let r=t.get(e);r||(r=new Map,t.set(e,r));const c=n.join();let d=r.get(c);return d||(d={resolver:vL(e,n),subPrefixes:n.filter(s=>!s.toLowerCase().includes("hover"))},r.set(c,d)),d}const Vle=t=>_s(t)&&Object.getOwnPropertyNames(t).some(e=>i0(t[e]));function Ule(t,e){const{isScriptable:n,isIndexable:r}=O8(t);for(const c of e){const d=n(c),m=r(c),s=(m||d)&&t[c];if(d&&(i0(s)||Vle(s))||m&&sl(s))return!0}return!1}var jle="4.5.0";const Hle=["top","bottom","left","right","chartArea"];function mV(t,e){return t==="top"||t==="bottom"||Hle.indexOf(t)===-1&&e==="x"}function gV(t,e){return function(n,r){return n[t]===r[t]?n[e]-r[e]:n[t]-r[t]}}function _V(t){const e=t.chart,n=e.options.animation;e.notifyPlugins("afterRender"),vo(n&&n.onComplete,[t],e)}function $le(t){const e=t.chart,n=e.options.animation;vo(n&&n.onProgress,[t],e)}function W8(t){return wL()&&typeof t=="string"?t=document.getElementById(t):t&&t.length&&(t=t[0]),t&&t.canvas&&(t=t.canvas),t}const nO={},yV=t=>{const e=W8(t);return Object.values(nO).filter(n=>n.canvas===e).pop()};function Gle(t,e,n){const r=Object.keys(t);for(const c of r){const d=+c;if(d>=e){const m=t[c];delete t[c],(n>0||d>e)&&(t[d+n]=m)}}}function qle(t,e,n,r){return!n||t.type==="mouseout"?null:r?e:t}var Dv;let cM=(Dv=class{static register(...e){Mm.add(...e),vV()}static unregister(...e){Mm.remove(...e),vV()}constructor(e,n){const r=this.config=new Fle(n),c=W8(e),d=yV(c);if(d)throw new Error("Canvas is already in use. Chart with ID '"+d.id+"' must be destroyed before the canvas with ID '"+d.canvas.id+"' can be reused.");const m=r.createResolver(r.chartOptionScopes(),this.getContext());this.platform=new(r.platform||ule(c)),this.platform.updateConfig(r);const s=this.platform.acquireContext(c,m.aspectRatio),T=s&&s.canvas,D=T&&T.height,P=T&&T.width;if(this.id=coe(),this.ctx=s,this.canvas=T,this.width=P,this.height=D,this._options=m,this._aspectRatio=this.aspectRatio,this._layers=[],this._metasets=[],this._stacks=void 0,this.boxes=[],this.currentDevicePixelRatio=void 0,this.chartArea=void 0,this._active=[],this._lastEvent=void 0,this._listeners={},this._responsiveListeners=void 0,this._sortedMetasets=[],this.scales={},this._plugins=new Dle,this.$proxies={},this._hiddenIndices={},this.attached=!1,this._animationsDisabled=void 0,this.$context=void 0,this._doResize=Coe(z=>this.update(z),m.resizeDelay||0),this._dataChanges=[],nO[this.id]=this,!s||!T){console.error("Failed to create chart: can't acquire context from the given item");return}p_.listen(this,"complete",_V),p_.listen(this,"progress",$le),this._initialize(),this.attached&&this.update()}get aspectRatio(){const{options:{aspectRatio:e,maintainAspectRatio:n},width:r,height:c,_aspectRatio:d}=this;return no(e)?n&&d?d:c?r/c:null:e}get data(){return this.config.data}set data(e){this.config.data=e}get options(){return this._options}set options(e){this.config.options=e}get registry(){return Mm}_initialize(){return this.notifyPlugins("beforeInit"),this.options.responsive?this.resize():$F(this,this.options.devicePixelRatio),this.bindEvents(),this.notifyPlugins("afterInit"),this}clear(){return VF(this.canvas,this.ctx),this}stop(){return p_.stop(this),this}resize(e,n){p_.running(this)?this._resizeBeforeDraw={width:e,height:n}:this._resize(e,n)}_resize(e,n){const r=this.options,c=this.canvas,d=r.maintainAspectRatio&&this.aspectRatio,m=this.platform.getMaximumSize(c,e,n,d),s=r.devicePixelRatio||this.platform.getDevicePixelRatio(),T=this.width?"resize":"attach";this.width=m.width,this.height=m.height,this._aspectRatio=this.aspectRatio,$F(this,s,!0)&&(this.notifyPlugins("resize",{size:m}),vo(r.onResize,[this,m],this),this.attached&&this._doResize(T)&&this.render())}ensureScalesHaveIDs(){const n=this.options.scales||{};Gs(n,(r,c)=>{r.id=c})}buildOrUpdateScales(){const e=this.options,n=e.scales,r=this.scales,c=Object.keys(r).reduce((m,s)=>(m[s]=!1,m),{});let d=[];n&&(d=d.concat(Object.keys(n).map(m=>{const s=n[m],T=fN(m,s),D=T==="r",P=T==="x";return{options:s,dposition:D?"chartArea":P?"bottom":"left",dtype:D?"radialLinear":P?"category":"linear"}}))),Gs(d,m=>{const s=m.options,T=s.id,D=fN(T,s),P=gs(s.type,m.dtype);(s.position===void 0||mV(s.position,D)!==mV(m.dposition))&&(s.position=m.dposition),c[T]=!0;let z=null;if(T in r&&r[T].type===P)z=r[T];else{const F=Mm.getScale(P);z=new F({id:T,type:P,ctx:this.ctx,chart:this}),r[z.id]=z}z.init(s,e)}),Gs(c,(m,s)=>{m||delete r[s]}),Gs(r,m=>{Kd.configure(this,m,m.options),Kd.addBox(this,m)})}_updateMetasets(){const e=this._metasets,n=this.data.datasets.length,r=e.length;if(e.sort((c,d)=>c.index-d.index),r>n){for(let c=n;c<r;++c)this._destroyDatasetMeta(c);e.splice(n,r-n)}this._sortedMetasets=e.slice(0).sort(gV("order","index"))}_removeUnreferencedMetasets(){const{_metasets:e,data:{datasets:n}}=this;e.length>n.length&&delete this._stacks,e.forEach((r,c)=>{n.filter(d=>d===r._dataset).length===0&&this._destroyDatasetMeta(c)})}buildOrUpdateControllers(){const e=[],n=this.data.datasets;let r,c;for(this._removeUnreferencedMetasets(),r=0,c=n.length;r<c;r++){const d=n[r];let m=this.getDatasetMeta(r);const s=d.type||this.config.type;if(m.type&&m.type!==s&&(this._destroyDatasetMeta(r),m=this.getDatasetMeta(r)),m.type=s,m.indexAxis=d.indexAxis||dN(s,this.options),m.order=d.order||0,m.index=r,m.label=""+d.label,m.visible=this.isDatasetVisible(r),m.controller)m.controller.updateIndex(r),m.controller.linkScales();else{const T=Mm.getController(s),{datasetElementType:D,dataElementType:P}=ga.datasets[s];Object.assign(T,{dataElementType:Mm.getElement(P),datasetElementType:D&&Mm.getElement(D)}),m.controller=new T(this,r),e.push(m.controller)}}return this._updateMetasets(),e}_resetElements(){Gs(this.data.datasets,(e,n)=>{this.getDatasetMeta(n).controller.reset()},this)}reset(){this._resetElements(),this.notifyPlugins("reset")}update(e){const n=this.config;n.update();const r=this._options=n.createResolver(n.chartOptionScopes(),this.getContext()),c=this._animationsDisabled=!r.animation;if(this._updateScales(),this._checkEventBindings(),this._updateHiddenIndices(),this._plugins.invalidate(),this.notifyPlugins("beforeUpdate",{mode:e,cancelable:!0})===!1)return;const d=this.buildOrUpdateControllers();this.notifyPlugins("beforeElementsUpdate");let m=0;for(let D=0,P=this.data.datasets.length;D<P;D++){const{controller:z}=this.getDatasetMeta(D),F=!c&&d.indexOf(z)===-1;z.buildOrUpdateElements(F),m=Math.max(+z.getMaxOverflow(),m)}m=this._minPadding=r.layout.autoPadding?m:0,this._updateLayout(m),c||Gs(d,D=>{D.reset()}),this._updateDatasets(e),this.notifyPlugins("afterUpdate",{mode:e}),this._layers.sort(gV("z","_idx"));const{_active:s,_lastEvent:T}=this;T?this._eventHandler(T,!0):s.length&&this._updateHoverStyles(s,s,!0),this.render()}_updateScales(){Gs(this.scales,e=>{Kd.removeBox(this,e)}),this.ensureScalesHaveIDs(),this.buildOrUpdateScales()}_checkEventBindings(){const e=this.options,n=new Set(Object.keys(this._listeners)),r=new Set(e.events);(!OF(n,r)||!!this._responsiveListeners!==e.responsive)&&(this.unbindEvents(),this.bindEvents())}_updateHiddenIndices(){const{_hiddenIndices:e}=this,n=this._getUniformDataChanges()||[];for(const{method:r,start:c,count:d}of n){const m=r==="_removeElements"?-d:d;Gle(e,c,m)}}_getUniformDataChanges(){const e=this._dataChanges;if(!e||!e.length)return;this._dataChanges=[];const n=this.data.datasets.length,r=d=>new Set(e.filter(m=>m[0]===d).map((m,s)=>s+","+m.splice(1).join(","))),c=r(0);for(let d=1;d<n;d++)if(!OF(c,r(d)))return;return Array.from(c).map(d=>d.split(",")).map(d=>({method:d[1],start:+d[2],count:+d[3]}))}_updateLayout(e){if(this.notifyPlugins("beforeLayout",{cancelable:!0})===!1)return;Kd.update(this,this.width,this.height,e);const n=this.chartArea,r=n.width<=0||n.height<=0;this._layers=[],Gs(this.boxes,c=>{r&&c.position==="chartArea"||(c.configure&&c.configure(),this._layers.push(...c._layers()))},this),this._layers.forEach((c,d)=>{c._idx=d}),this.notifyPlugins("afterLayout")}_updateDatasets(e){if(this.notifyPlugins("beforeDatasetsUpdate",{mode:e,cancelable:!0})!==!1){for(let n=0,r=this.data.datasets.length;n<r;++n)this.getDatasetMeta(n).controller.configure();for(let n=0,r=this.data.datasets.length;n<r;++n)this._updateDataset(n,i0(e)?e({datasetIndex:n}):e);this.notifyPlugins("afterDatasetsUpdate",{mode:e})}}_updateDataset(e,n){const r=this.getDatasetMeta(e),c={meta:r,index:e,mode:n,cancelable:!0};this.notifyPlugins("beforeDatasetUpdate",c)!==!1&&(r.controller._update(n),c.cancelable=!1,this.notifyPlugins("afterDatasetUpdate",c))}render(){this.notifyPlugins("beforeRender",{cancelable:!0})!==!1&&(p_.has(this)?this.attached&&!p_.running(this)&&p_.start(this):(this.draw(),_V({chart:this})))}draw(){let e;if(this._resizeBeforeDraw){const{width:r,height:c}=this._resizeBeforeDraw;this._resizeBeforeDraw=null,this._resize(r,c)}if(this.clear(),this.width<=0||this.height<=0||this.notifyPlugins("beforeDraw",{cancelable:!0})===!1)return;const n=this._layers;for(e=0;e<n.length&&n[e].z<=0;++e)n[e].draw(this.chartArea);for(this._drawDatasets();e<n.length;++e)n[e].draw(this.chartArea);this.notifyPlugins("afterDraw")}_getSortedDatasetMetas(e){const n=this._sortedMetasets,r=[];let c,d;for(c=0,d=n.length;c<d;++c){const m=n[c];(!e||m.visible)&&r.push(m)}return r}getSortedVisibleDatasetMetas(){return this._getSortedDatasetMetas(!0)}_drawDatasets(){if(this.notifyPlugins("beforeDatasetsDraw",{cancelable:!0})===!1)return;const e=this.getSortedVisibleDatasetMetas();for(let n=e.length-1;n>=0;--n)this._drawDataset(e[n]);this.notifyPlugins("afterDatasetsDraw")}_drawDataset(e){const n=this.ctx,r={meta:e,index:e.index,cancelable:!0},c=dae(this,e);this.notifyPlugins("beforeDatasetDraw",r)!==!1&&(c&&gL(n,c),e.controller.draw(),c&&_L(n),r.cancelable=!1,this.notifyPlugins("afterDatasetDraw",r))}isPointInArea(e){return D8(e,this.chartArea,this._minPadding)}getElementsAtEventForMode(e,n,r,c){const d=Hae.modes[n];return typeof d=="function"?d(this,e,r,c):[]}getDatasetMeta(e){const n=this.data.datasets[e],r=this._metasets;let c=r.filter(d=>d&&d._dataset===n).pop();return c||(c={type:null,data:[],dataset:null,controller:null,hidden:null,xAxisID:null,yAxisID:null,order:n&&n.order||0,index:e,_dataset:n,_parsed:[],_sorted:!1},r.push(c)),c}getContext(){return this.$context||(this.$context=ET(null,{chart:this,type:"chart"}))}getVisibleDatasetCount(){return this.getSortedVisibleDatasetMetas().length}isDatasetVisible(e){const n=this.data.datasets[e];if(!n)return!1;const r=this.getDatasetMeta(e);return typeof r.hidden=="boolean"?!r.hidden:!n.hidden}setDatasetVisibility(e,n){const r=this.getDatasetMeta(e);r.hidden=!n}toggleDataVisibility(e){this._hiddenIndices[e]=!this._hiddenIndices[e]}getDataVisibility(e){return!this._hiddenIndices[e]}_updateVisibility(e,n,r){const c=r?"show":"hide",d=this.getDatasetMeta(e),m=d.controller._resolveAnimations(void 0,c);vA(n)?(d.data[n].hidden=!r,this.update()):(this.setDatasetVisibility(e,r),m.update(d,{visible:r}),this.update(s=>s.datasetIndex===e?c:void 0))}hide(e,n){this._updateVisibility(e,n,!1)}show(e,n){this._updateVisibility(e,n,!0)}_destroyDatasetMeta(e){const n=this._metasets[e];n&&n.controller&&n.controller._destroy(),delete this._metasets[e]}_stop(){let e,n;for(this.stop(),p_.remove(this),e=0,n=this.data.datasets.length;e<n;++e)this._destroyDatasetMeta(e)}destroy(){this.notifyPlugins("beforeDestroy");const{canvas:e,ctx:n}=this;this._stop(),this.config.clearCache(),e&&(this.unbindEvents(),VF(e,n),this.platform.releaseContext(n),this.canvas=null,this.ctx=null),delete nO[this.id],this.notifyPlugins("afterDestroy")}toBase64Image(...e){return this.canvas.toDataURL(...e)}bindEvents(){this.bindUserEvents(),this.options.responsive?this.bindResponsiveEvents():this.attached=!0}bindUserEvents(){const e=this._listeners,n=this.platform,r=(d,m)=>{n.addEventListener(this,d,m),e[d]=m},c=(d,m,s)=>{d.offsetX=m,d.offsetY=s,this._eventHandler(d)};Gs(this.options.events,d=>r(d,c))}bindResponsiveEvents(){this._responsiveListeners||(this._responsiveListeners={});const e=this._responsiveListeners,n=this.platform,r=(T,D)=>{n.addEventListener(this,T,D),e[T]=D},c=(T,D)=>{e[T]&&(n.removeEventListener(this,T,D),delete e[T])},d=(T,D)=>{this.canvas&&this.resize(T,D)};let m;const s=()=>{c("attach",s),this.attached=!0,this.resize(),r("resize",d),r("detach",m)};m=()=>{this.attached=!1,c("resize",d),this._stop(),this._resize(0,0),r("attach",s)},n.isAttached(this.canvas)?s():m()}unbindEvents(){Gs(this._listeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._listeners={},Gs(this._responsiveListeners,(e,n)=>{this.platform.removeEventListener(this,n,e)}),this._responsiveListeners=void 0}updateHoverStyle(e,n,r){const c=r?"set":"remove";let d,m,s,T;for(n==="dataset"&&(d=this.getDatasetMeta(e[0].datasetIndex),d.controller["_"+c+"DatasetHoverStyle"]()),s=0,T=e.length;s<T;++s){m=e[s];const D=m&&this.getDatasetMeta(m.datasetIndex).controller;D&&D[c+"HoverStyle"](m.element,m.datasetIndex,m.index)}}getActiveElements(){return this._active||[]}setActiveElements(e){const n=this._active||[],r=e.map(({datasetIndex:d,index:m})=>{const s=this.getDatasetMeta(d);if(!s)throw new Error("No dataset found at index "+d);return{datasetIndex:d,element:s.data[m],index:m}});!HO(r,n)&&(this._active=r,this._lastEvent=null,this._updateHoverStyles(r,n))}notifyPlugins(e,n,r){return this._plugins.notify(this,e,n,r)}isPluginEnabled(e){return this._plugins._cache.filter(n=>n.plugin.id===e).length===1}_updateHoverStyles(e,n,r){const c=this.options.hover,d=(T,D)=>T.filter(P=>!D.some(z=>P.datasetIndex===z.datasetIndex&&P.index===z.index)),m=d(n,e),s=r?e:d(e,n);m.length&&this.updateHoverStyle(m,c.mode,!1),s.length&&c.mode&&this.updateHoverStyle(s,c.mode,!0)}_eventHandler(e,n){const r={event:e,replay:n,cancelable:!0,inChartArea:this.isPointInArea(e)},c=m=>(m.options.events||this.options.events).includes(e.native.type);if(this.notifyPlugins("beforeEvent",r,c)===!1)return;const d=this._handleEvent(e,n,r.inChartArea);return r.cancelable=!1,this.notifyPlugins("afterEvent",r,c),(d||r.changed)&&this.render(),this}_handleEvent(e,n,r){const{_active:c=[],options:d}=this,m=n,s=this._getActiveElements(e,c,r,m),T=moe(e),D=qle(e,this._lastEvent,r,T);r&&(this._lastEvent=null,vo(d.onHover,[e,s,this],this),T&&vo(d.onClick,[e,s,this],this));const P=!HO(s,c);return(P||n)&&(this._active=s,this._updateHoverStyles(s,c,n)),this._lastEvent=D,P}_getActiveElements(e,n,r,c){if(e.type==="mouseout")return[];if(!r)return n;const d=this.options.hover;return this.getElementsAtEventForMode(e,d.mode,d,c)}},ki(Dv,"defaults",ga),ki(Dv,"instances",nO),ki(Dv,"overrides",Ex),ki(Dv,"registry",Mm),ki(Dv,"version",jle),ki(Dv,"getChart",yV),Dv);function vV(){return Gs(cM.instances,t=>t._plugins.invalidate())}function Wle(t,e,n){const{startAngle:r,x:c,y:d,outerRadius:m,innerRadius:s,options:T}=e,{borderWidth:D,borderJoinStyle:P}=T,z=Math.min(D/m,km(r-n));if(t.beginPath(),t.arc(c,d,m-D/2,r+z/2,n-z/2),s>0){const F=Math.min(D/s,km(r-n));t.arc(c,d,s+D/2,n-F/2,r+F/2,!0)}else{const F=Math.min(D/2,m*km(r-n));if(P==="round")t.arc(c,d,F,n-to/2,r+to/2,!0);else if(P==="bevel"){const $=2*F*F,J=-$*Math.cos(n+to/2)+c,X=-$*Math.sin(n+to/2)+d,te=$*Math.cos(r+to/2)+c,ie=$*Math.sin(r+to/2)+d;t.lineTo(J,X),t.lineTo(te,ie)}}t.closePath(),t.moveTo(0,0),t.rect(0,0,t.canvas.width,t.canvas.height),t.clip("evenodd")}function Yle(t,e,n){const{startAngle:r,pixelMargin:c,x:d,y:m,outerRadius:s,innerRadius:T}=e;let D=c/s;t.beginPath(),t.arc(d,m,s,r-D,n+D),T>c?(D=c/T,t.arc(d,m,T,n+D,r-D,!0)):t.arc(d,m,c,n+ol,r-ol),t.closePath(),t.clip()}function Zle(t){return yL(t,["outerStart","outerEnd","innerStart","innerEnd"])}function Xle(t,e,n,r){const c=Zle(t.options.borderRadius),d=(n-e)/2,m=Math.min(d,r*e/2),s=T=>{const D=(n-Math.min(d,T))*r/2;return $u(T,0,Math.min(d,D))};return{outerStart:s(c.outerStart),outerEnd:s(c.outerEnd),innerStart:$u(c.innerStart,0,m),innerEnd:$u(c.innerEnd,0,m)}}function bw(t,e,n,r){return{x:n+t*Math.cos(e),y:r+t*Math.sin(e)}}function QO(t,e,n,r,c,d){const{x:m,y:s,startAngle:T,pixelMargin:D,innerRadius:P}=e,z=Math.max(e.outerRadius+r+n-D,0),F=P>0?P+r+n+D:0;let $=0;const J=c-T;if(r){const St=P>0?P-r:0,mt=z>0?z-r:0,Ft=(St+mt)/2,rn=Ft!==0?J*Ft/(Ft+r):J;$=(J-rn)/2}const X=Math.max(.001,J*z-n/to)/z,te=(J-X)/2,ie=T+te+$,we=c-te-$,{outerStart:Ie,outerEnd:Re,innerStart:Ne,innerEnd:Xe}=Xle(e,F,z,we-ie),be=z-Ie,_e=z-Re,Te=ie+Ie/be,oe=we-Re/_e,Ee=F+Ne,$e=F+Xe,ze=ie+Ne/Ee,zt=we-Xe/$e;if(t.beginPath(),d){const St=(Te+oe)/2;if(t.arc(m,s,z,Te,St),t.arc(m,s,z,St,oe),Re>0){const Xt=bw(_e,oe,m,s);t.arc(Xt.x,Xt.y,Re,oe,we+ol)}const mt=bw($e,we,m,s);if(t.lineTo(mt.x,mt.y),Xe>0){const Xt=bw($e,zt,m,s);t.arc(Xt.x,Xt.y,Xe,we+ol,zt+Math.PI)}const Ft=(we-Xe/F+(ie+Ne/F))/2;if(t.arc(m,s,F,we-Xe/F,Ft,!0),t.arc(m,s,F,Ft,ie+Ne/F,!0),Ne>0){const Xt=bw(Ee,ze,m,s);t.arc(Xt.x,Xt.y,Ne,ze+Math.PI,ie-ol)}const rn=bw(be,ie,m,s);if(t.lineTo(rn.x,rn.y),Ie>0){const Xt=bw(be,Te,m,s);t.arc(Xt.x,Xt.y,Ie,ie-ol,Te)}}else{t.moveTo(m,s);const St=Math.cos(Te)*z+m,mt=Math.sin(Te)*z+s;t.lineTo(St,mt);const Ft=Math.cos(oe)*z+m,rn=Math.sin(oe)*z+s;t.lineTo(Ft,rn)}t.closePath()}function Qle(t,e,n,r,c){const{fullCircles:d,startAngle:m,circumference:s}=e;let T=e.endAngle;if(d){QO(t,e,n,r,T,c);for(let D=0;D<d;++D)t.fill();isNaN(s)||(T=m+(s%Fa||Fa))}return QO(t,e,n,r,T,c),t.fill(),T}function Kle(t,e,n,r,c){const{fullCircles:d,startAngle:m,circumference:s,options:T}=e,{borderWidth:D,borderJoinStyle:P,borderDash:z,borderDashOffset:F,borderRadius:$}=T,J=T.borderAlign==="inner";if(!D)return;t.setLineDash(z||[]),t.lineDashOffset=F,J?(t.lineWidth=D*2,t.lineJoin=P||"round"):(t.lineWidth=D,t.lineJoin=P||"bevel");let X=e.endAngle;if(d){QO(t,e,n,r,X,c);for(let te=0;te<d;++te)t.stroke();isNaN(s)||(X=m+(s%Fa||Fa))}J&&Yle(t,e,X),T.selfJoin&&X-m>=to&&$===0&&P!=="miter"&&Wle(t,e,X),d||(QO(t,e,n,r,X,c),t.stroke())}class kS extends Mx{constructor(n){super();ki(this,"circumference");ki(this,"endAngle");ki(this,"fullCircles");ki(this,"innerRadius");ki(this,"outerRadius");ki(this,"pixelMargin");ki(this,"startAngle");this.options=void 0,this.circumference=void 0,this.startAngle=void 0,this.endAngle=void 0,this.innerRadius=void 0,this.outerRadius=void 0,this.pixelMargin=0,this.fullCircles=0,n&&Object.assign(this,n)}inRange(n,r,c){const d=this.getProps(["x","y"],c),{angle:m,distance:s}=b8(d,{x:n,y:r}),{startAngle:T,endAngle:D,innerRadius:P,outerRadius:z,circumference:F}=this.getProps(["startAngle","endAngle","innerRadius","outerRadius","circumference"],c),$=(this.options.spacing+this.options.borderWidth)/2,J=gs(F,D-T),X=WO(m,T,D)&&T!==D,te=J>=Fa||X,ie=ox(s,P+$,z+$);return te&&ie}getCenterPoint(n){const{x:r,y:c,startAngle:d,endAngle:m,innerRadius:s,outerRadius:T}=this.getProps(["x","y","startAngle","endAngle","innerRadius","outerRadius"],n),{offset:D,spacing:P}=this.options,z=(d+m)/2,F=(s+T+P+D)/2;return{x:r+Math.cos(z)*F,y:c+Math.sin(z)*F}}tooltipPosition(n){return this.getCenterPoint(n)}draw(n){const{options:r,circumference:c}=this,d=(r.offset||0)/4,m=(r.spacing||0)/2,s=r.circular;if(this.pixelMargin=r.borderAlign==="inner"?.33:0,this.fullCircles=c>Fa?Math.floor(c/Fa):0,c===0||this.innerRadius<0||this.outerRadius<0)return;n.save();const T=(this.startAngle+this.endAngle)/2;n.translate(Math.cos(T)*d,Math.sin(T)*d);const D=1-Math.sin(Math.min(to,c||0)),P=d*D;n.fillStyle=r.backgroundColor,n.strokeStyle=r.borderColor,Qle(n,this,P,m,s),Kle(n,this,P,m,s),n.restore()}}ki(kS,"id","arc"),ki(kS,"defaults",{borderAlign:"center",borderColor:"#fff",borderDash:[],borderDashOffset:0,borderJoinStyle:void 0,borderRadius:0,borderWidth:2,offset:0,spacing:0,angle:void 0,circular:!0,selfJoin:!1}),ki(kS,"defaultRoutes",{backgroundColor:"backgroundColor"}),ki(kS,"descriptors",{_scriptable:!0,_indexable:n=>n!=="borderDash"});function Y8(t,e){const{x:n,y:r,base:c,width:d,height:m}=t.getProps(["x","y","base","width","height"],e);let s,T,D,P,z;return t.horizontal?(z=m/2,s=Math.min(n,c),T=Math.max(n,c),D=r-z,P=r+z):(z=d/2,s=n-z,T=n+z,D=Math.min(r,c),P=Math.max(r,c)),{left:s,top:D,right:T,bottom:P}}function Nv(t,e,n,r){return t?0:$u(e,n,r)}function Jle(t,e,n){const r=t.options.borderWidth,c=t.borderSkipped,d=R8(r);return{t:Nv(c.top,d.top,0,n),r:Nv(c.right,d.right,0,e),b:Nv(c.bottom,d.bottom,0,n),l:Nv(c.left,d.left,0,e)}}function ece(t,e,n){const{enableBorderRadius:r}=t.getProps(["enableBorderRadius"]),c=t.options.borderRadius,d=Bw(c),m=Math.min(e,n),s=t.borderSkipped,T=r||_s(c);return{topLeft:Nv(!T||s.top||s.left,d.topLeft,0,m),topRight:Nv(!T||s.top||s.right,d.topRight,0,m),bottomLeft:Nv(!T||s.bottom||s.left,d.bottomLeft,0,m),bottomRight:Nv(!T||s.bottom||s.right,d.bottomRight,0,m)}}function tce(t){const e=Y8(t),n=e.right-e.left,r=e.bottom-e.top,c=Jle(t,n/2,r/2),d=ece(t,n/2,r/2);return{outer:{x:e.left,y:e.top,w:n,h:r,radius:d},inner:{x:e.left+c.l,y:e.top+c.t,w:n-c.l-c.r,h:r-c.t-c.b,radius:{topLeft:Math.max(0,d.topLeft-Math.max(c.t,c.l)),topRight:Math.max(0,d.topRight-Math.max(c.t,c.r)),bottomLeft:Math.max(0,d.bottomLeft-Math.max(c.b,c.l)),bottomRight:Math.max(0,d.bottomRight-Math.max(c.b,c.r))}}}}function HP(t,e,n,r){const c=e===null,d=n===null,s=t&&!(c&&d)&&Y8(t,r);return s&&(c||ox(e,s.left,s.right))&&(d||ox(n,s.top,s.bottom))}function nce(t){return t.topLeft||t.topRight||t.bottomLeft||t.bottomRight}function ice(t,e){t.rect(e.x,e.y,e.w,e.h)}function $P(t,e,n={}){const r=t.x!==n.x?-e:0,c=t.y!==n.y?-e:0,d=(t.x+t.w!==n.x+n.w?e:0)-r,m=(t.y+t.h!==n.y+n.h?e:0)-c;return{x:t.x+r,y:t.y+c,w:t.w+d,h:t.h+m,radius:t.radius}}class iO extends Mx{constructor(e){super(),this.options=void 0,this.horizontal=void 0,this.base=void 0,this.width=void 0,this.height=void 0,this.inflateAmount=void 0,e&&Object.assign(this,e)}draw(e){const{inflateAmount:n,options:{borderColor:r,backgroundColor:c}}=this,{inner:d,outer:m}=tce(this),s=nce(m.radius)?YO:ice;e.save(),(m.w!==d.w||m.h!==d.h)&&(e.beginPath(),s(e,$P(m,n,d)),e.clip(),s(e,$P(d,-n,m)),e.fillStyle=r,e.fill("evenodd")),e.beginPath(),s(e,$P(d,n)),e.fillStyle=c,e.fill(),e.restore()}inRange(e,n,r){return HP(this,e,n,r)}inXRange(e,n){return HP(this,e,null,n)}inYRange(e,n){return HP(this,null,e,n)}getCenterPoint(e){const{x:n,y:r,base:c,horizontal:d}=this.getProps(["x","y","base","horizontal"],e);return{x:d?(n+c)/2:n,y:d?r:(r+c)/2}}getRange(e){return e==="x"?this.width/2:this.height/2}}ki(iO,"id","bar"),ki(iO,"defaults",{borderSkipped:"start",borderWidth:0,borderRadius:0,inflateAmount:"auto",pointStyle:void 0}),ki(iO,"defaultRoutes",{backgroundColor:"backgroundColor",borderColor:"borderColor"});const bV=(t,e)=>{let{boxHeight:n=e,boxWidth:r=e}=t;return t.usePointStyle&&(n=Math.min(n,e),r=t.pointStyleWidth||Math.min(r,e)),{boxWidth:r,boxHeight:n,itemHeight:Math.max(e,n)}},rce=(t,e)=>t!==null&&e!==null&&t.datasetIndex===e.datasetIndex&&t.index===e.index;class xV extends Mx{constructor(e){super(),this._added=!1,this.legendHitBoxes=[],this._hoveredItem=null,this.doughnutMode=!1,this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this.legendItems=void 0,this.columnSizes=void 0,this.lineWidths=void 0,this.maxHeight=void 0,this.maxWidth=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.height=void 0,this.width=void 0,this._margins=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n,r){this.maxWidth=e,this.maxHeight=n,this._margins=r,this.setDimensions(),this.buildLabels(),this.fit()}setDimensions(){this.isHorizontal()?(this.width=this.maxWidth,this.left=this._margins.left,this.right=this.width):(this.height=this.maxHeight,this.top=this._margins.top,this.bottom=this.height)}buildLabels(){const e=this.options.labels||{};let n=vo(e.generateLabels,[this.chart],this)||[];e.filter&&(n=n.filter(r=>e.filter(r,this.chart.data))),e.sort&&(n=n.sort((r,c)=>e.sort(r,c,this.chart.data))),this.options.reverse&&n.reverse(),this.legendItems=n}fit(){const{options:e,ctx:n}=this;if(!e.display){this.width=this.height=0;return}const r=e.labels,c=Fc(r.font),d=c.size,m=this._computeTitleHeight(),{boxWidth:s,itemHeight:T}=bV(r,d);let D,P;n.font=c.string,this.isHorizontal()?(D=this.maxWidth,P=this._fitRows(m,d,s,T)+10):(P=this.maxHeight,D=this._fitCols(m,c,s,T)+10),this.width=Math.min(D,e.maxWidth||this.maxWidth),this.height=Math.min(P,e.maxHeight||this.maxHeight)}_fitRows(e,n,r,c){const{ctx:d,maxWidth:m,options:{labels:{padding:s}}}=this,T=this.legendHitBoxes=[],D=this.lineWidths=[0],P=c+s;let z=e;d.textAlign="left",d.textBaseline="middle";let F=-1,$=-P;return this.legendItems.forEach((J,X)=>{const te=r+n/2+d.measureText(J.text).width;(X===0||D[D.length-1]+te+2*s>m)&&(z+=P,D[D.length-(X>0?0:1)]=0,$+=P,F++),T[X]={left:0,top:$,row:F,width:te,height:c},D[D.length-1]+=te+s}),z}_fitCols(e,n,r,c){const{ctx:d,maxHeight:m,options:{labels:{padding:s}}}=this,T=this.legendHitBoxes=[],D=this.columnSizes=[],P=m-e;let z=s,F=0,$=0,J=0,X=0;return this.legendItems.forEach((te,ie)=>{const{itemWidth:we,itemHeight:Ie}=sce(r,n,d,te,c);ie>0&&$+Ie+2*s>P&&(z+=F+s,D.push({width:F,height:$}),J+=F+s,X++,F=$=0),T[ie]={left:J,top:$,col:X,width:we,height:Ie},F=Math.max(F,we),$+=Ie+s}),z+=F,D.push({width:F,height:$}),z}adjustHitBoxes(){if(!this.options.display)return;const e=this._computeTitleHeight(),{legendHitBoxes:n,options:{align:r,labels:{padding:c},rtl:d}}=this,m=Fw(d,this.left,this.width);if(this.isHorizontal()){let s=0,T=Pc(r,this.left+c,this.right-this.lineWidths[s]);for(const D of n)s!==D.row&&(s=D.row,T=Pc(r,this.left+c,this.right-this.lineWidths[s])),D.top+=this.top+e+c,D.left=m.leftForLtr(m.x(T),D.width),T+=D.width+c}else{let s=0,T=Pc(r,this.top+e+c,this.bottom-this.columnSizes[s].height);for(const D of n)D.col!==s&&(s=D.col,T=Pc(r,this.top+e+c,this.bottom-this.columnSizes[s].height)),D.top=T,D.left+=this.left+c,D.left=m.leftForLtr(m.x(D.left),D.width),T+=D.height+c}}isHorizontal(){return this.options.position==="top"||this.options.position==="bottom"}draw(){if(this.options.display){const e=this.ctx;gL(e,this),this._draw(),_L(e)}}_draw(){const{options:e,columnSizes:n,lineWidths:r,ctx:c}=this,{align:d,labels:m}=e,s=ga.color,T=Fw(e.rtl,this.left,this.width),D=Fc(m.font),{padding:P}=m,z=D.size,F=z/2;let $;this.drawTitle(),c.textAlign=T.textAlign("left"),c.textBaseline="middle",c.lineWidth=.5,c.font=D.string;const{boxWidth:J,boxHeight:X,itemHeight:te}=bV(m,z),ie=function(Xe,be,_e){if(isNaN(J)||J<=0||isNaN(X)||X<0)return;c.save();const Te=gs(_e.lineWidth,1);if(c.fillStyle=gs(_e.fillStyle,s),c.lineCap=gs(_e.lineCap,"butt"),c.lineDashOffset=gs(_e.lineDashOffset,0),c.lineJoin=gs(_e.lineJoin,"miter"),c.lineWidth=Te,c.strokeStyle=gs(_e.strokeStyle,s),c.setLineDash(gs(_e.lineDash,[])),m.usePointStyle){const oe={radius:X*Math.SQRT2/2,pointStyle:_e.pointStyle,rotation:_e.rotation,borderWidth:Te},Ee=T.xPlus(Xe,J/2),$e=be+F;C8(c,oe,Ee,$e,m.pointStyleWidth&&J)}else{const oe=be+Math.max((z-X)/2,0),Ee=T.leftForLtr(Xe,J),$e=Bw(_e.borderRadius);c.beginPath(),Object.values($e).some(ze=>ze!==0)?YO(c,{x:Ee,y:oe,w:J,h:X,radius:$e}):c.rect(Ee,oe,J,X),c.fill(),Te!==0&&c.stroke()}c.restore()},we=function(Xe,be,_e){bA(c,_e.text,Xe,be+te/2,D,{strikethrough:_e.hidden,textAlign:T.textAlign(_e.textAlign)})},Ie=this.isHorizontal(),Re=this._computeTitleHeight();Ie?$={x:Pc(d,this.left+P,this.right-r[0]),y:this.top+P+Re,line:0}:$={x:this.left+P,y:Pc(d,this.top+Re+P,this.bottom-n[0].height),line:0},k8(this.ctx,e.textDirection);const Ne=te+P;this.legendItems.forEach((Xe,be)=>{c.strokeStyle=Xe.fontColor,c.fillStyle=Xe.fontColor;const _e=c.measureText(Xe.text).width,Te=T.textAlign(Xe.textAlign||(Xe.textAlign=m.textAlign)),oe=J+F+_e;let Ee=$.x,$e=$.y;T.setWidth(this.width),Ie?be>0&&Ee+oe+P>this.right&&($e=$.y+=Ne,$.line++,Ee=$.x=Pc(d,this.left+P,this.right-r[$.line])):be>0&&$e+Ne>this.bottom&&(Ee=$.x=Ee+n[$.line].width+P,$.line++,$e=$.y=Pc(d,this.top+Re+P,this.bottom-n[$.line].height));const ze=T.x(Ee);if(ie(ze,$e,Xe),Ee=Doe(Te,Ee+J+F,Ie?Ee+oe:this.right,e.rtl),we(T.x(Ee),$e,Xe),Ie)$.x+=oe+P;else if(typeof Xe.text!="string"){const zt=D.lineHeight;$.y+=Z8(Xe,zt)+P}else $.y+=Ne}),N8(this.ctx,e.textDirection)}drawTitle(){const e=this.options,n=e.title,r=Fc(n.font),c=of(n.padding);if(!n.display)return;const d=Fw(e.rtl,this.left,this.width),m=this.ctx,s=n.position,T=r.size/2,D=c.top+T;let P,z=this.left,F=this.width;if(this.isHorizontal())F=Math.max(...this.lineWidths),P=this.top+D,z=Pc(e.align,z,this.right-F);else{const J=this.columnSizes.reduce((X,te)=>Math.max(X,te.height),0);P=D+Pc(e.align,this.top,this.bottom-J-e.labels.padding-this._computeTitleHeight())}const $=Pc(s,z,z+F);m.textAlign=d.textAlign(pL(s)),m.textBaseline="middle",m.strokeStyle=n.color,m.fillStyle=n.color,m.font=r.string,bA(m,n.text,$,P,r)}_computeTitleHeight(){const e=this.options.title,n=Fc(e.font),r=of(e.padding);return e.display?n.lineHeight+r.height:0}_getLegendItemAt(e,n){let r,c,d;if(ox(e,this.left,this.right)&&ox(n,this.top,this.bottom)){for(d=this.legendHitBoxes,r=0;r<d.length;++r)if(c=d[r],ox(e,c.left,c.left+c.width)&&ox(n,c.top,c.top+c.height))return this.legendItems[r]}return null}handleEvent(e){const n=this.options;if(!lce(e.type,n))return;const r=this._getLegendItemAt(e.x,e.y);if(e.type==="mousemove"||e.type==="mouseout"){const c=this._hoveredItem,d=rce(c,r);c&&!d&&vo(n.onLeave,[e,c,this],this),this._hoveredItem=r,r&&!d&&vo(n.onHover,[e,r,this],this)}else r&&vo(n.onClick,[e,r,this],this)}}function sce(t,e,n,r,c){const d=oce(r,t,e,n),m=ace(c,r,e.lineHeight);return{itemWidth:d,itemHeight:m}}function oce(t,e,n,r){let c=t.text;return c&&typeof c!="string"&&(c=c.reduce((d,m)=>d.length>m.length?d:m)),e+n.size/2+r.measureText(c).width}function ace(t,e,n){let r=t;return typeof e.text!="string"&&(r=Z8(e,n)),r}function Z8(t,e){const n=t.text?t.text.length:0;return e*n}function lce(t,e){return!!((t==="mousemove"||t==="mouseout")&&(e.onHover||e.onLeave)||e.onClick&&(t==="click"||t==="mouseup"))}var cce={id:"legend",_element:xV,start(t,e,n){const r=t.legend=new xV({ctx:t.ctx,options:n,chart:t});Kd.configure(t,r,n),Kd.addBox(t,r)},stop(t){Kd.removeBox(t,t.legend),delete t.legend},beforeUpdate(t,e,n){const r=t.legend;Kd.configure(t,r,n),r.options=n},afterUpdate(t){const e=t.legend;e.buildLabels(),e.adjustHitBoxes()},afterEvent(t,e){e.replay||t.legend.handleEvent(e.event)},defaults:{display:!0,position:"top",align:"center",fullSize:!0,reverse:!1,weight:1e3,onClick(t,e,n){const r=e.datasetIndex,c=n.chart;c.isDatasetVisible(r)?(c.hide(r),e.hidden=!0):(c.show(r),e.hidden=!1)},onHover:null,onLeave:null,labels:{color:t=>t.chart.options.color,boxWidth:40,padding:10,generateLabels(t){const e=t.data.datasets,{labels:{usePointStyle:n,pointStyle:r,textAlign:c,color:d,useBorderRadius:m,borderRadius:s}}=t.legend.options;return t._getSortedDatasetMetas().map(T=>{const D=T.controller.getStyle(n?0:void 0),P=of(D.borderWidth);return{text:e[T.index].label,fillStyle:D.backgroundColor,fontColor:d,hidden:!T.visible,lineCap:D.borderCapStyle,lineDash:D.borderDash,lineDashOffset:D.borderDashOffset,lineJoin:D.borderJoinStyle,lineWidth:(P.width+P.height)/4,strokeStyle:D.borderColor,pointStyle:r||D.pointStyle,rotation:D.rotation,textAlign:c||D.textAlign,borderRadius:m&&(s||D.borderRadius),datasetIndex:T.index}},this)}},title:{color:t=>t.chart.options.color,display:!1,position:"center",text:""}},descriptors:{_scriptable:t=>!t.startsWith("on"),labels:{_scriptable:t=>!["generateLabels","filter","sort"].includes(t)}}};class X8 extends Mx{constructor(e){super(),this.chart=e.chart,this.options=e.options,this.ctx=e.ctx,this._padding=void 0,this.top=void 0,this.bottom=void 0,this.left=void 0,this.right=void 0,this.width=void 0,this.height=void 0,this.position=void 0,this.weight=void 0,this.fullSize=void 0}update(e,n){const r=this.options;if(this.left=0,this.top=0,!r.display){this.width=this.height=this.right=this.bottom=0;return}this.width=this.right=e,this.height=this.bottom=n;const c=sl(r.text)?r.text.length:1;this._padding=of(r.padding);const d=c*Fc(r.font).lineHeight+this._padding.height;this.isHorizontal()?this.height=d:this.width=d}isHorizontal(){const e=this.options.position;return e==="top"||e==="bottom"}_drawArgs(e){const{top:n,left:r,bottom:c,right:d,options:m}=this,s=m.align;let T=0,D,P,z;return this.isHorizontal()?(P=Pc(s,r,d),z=n+e,D=d-r):(m.position==="left"?(P=r+e,z=Pc(s,c,n),T=to*-.5):(P=d-e,z=Pc(s,n,c),T=to*.5),D=c-n),{titleX:P,titleY:z,maxWidth:D,rotation:T}}draw(){const e=this.ctx,n=this.options;if(!n.display)return;const r=Fc(n.font),d=r.lineHeight/2+this._padding.top,{titleX:m,titleY:s,maxWidth:T,rotation:D}=this._drawArgs(d);bA(e,n.text,0,0,r,{color:n.color,maxWidth:T,rotation:D,textAlign:pL(n.align),textBaseline:"middle",translation:[m,s]})}}function uce(t,e){const n=new X8({ctx:t.ctx,options:e,chart:t});Kd.configure(t,n,e),Kd.addBox(t,n),t.titleBlock=n}var hce={id:"title",_element:X8,start(t,e,n){uce(t,n)},stop(t){const e=t.titleBlock;Kd.removeBox(t,e),delete t.titleBlock},beforeUpdate(t,e,n){const r=t.titleBlock;Kd.configure(t,r,n),r.options=n},defaults:{align:"center",display:!1,font:{weight:"bold"},fullSize:!0,padding:10,position:"top",text:"",weight:2e3},defaultRoutes:{color:"color"},descriptors:{_scriptable:!0,_indexable:!1}};const NS={average(t){if(!t.length)return!1;let e,n,r=new Set,c=0,d=0;for(e=0,n=t.length;e<n;++e){const s=t[e].element;if(s&&s.hasValue()){const T=s.tooltipPosition();r.add(T.x),c+=T.y,++d}}return d===0||r.size===0?!1:{x:[...r].reduce((s,T)=>s+T)/r.size,y:c/d}},nearest(t,e){if(!t.length)return!1;let n=e.x,r=e.y,c=Number.POSITIVE_INFINITY,d,m,s;for(d=0,m=t.length;d<m;++d){const T=t[d].element;if(T&&T.hasValue()){const D=T.getCenterPoint(),P=woe(e,D);P<c&&(c=P,s=T)}}if(s){const T=s.tooltipPosition();n=T.x,r=T.y}return{x:n,y:r}}};function Im(t,e){return e&&(sl(e)?Array.prototype.push.apply(t,e):t.push(e)),t}function m_(t){return(typeof t=="string"||t instanceof String)&&t.indexOf(`
`)>-1?t.split(`
`):t}function dce(t,e){const{element:n,datasetIndex:r,index:c}=e,d=t.getDatasetMeta(r).controller,{label:m,value:s}=d.getLabelAndValue(c);return{chart:t,label:m,parsed:d.getParsed(c),raw:t.data.datasets[r].data[c],formattedValue:s,dataset:d.getDataset(),dataIndex:c,datasetIndex:r,element:n}}function wV(t,e){const n=t.chart.ctx,{body:r,footer:c,title:d}=t,{boxWidth:m,boxHeight:s}=e,T=Fc(e.bodyFont),D=Fc(e.titleFont),P=Fc(e.footerFont),z=d.length,F=c.length,$=r.length,J=of(e.padding);let X=J.height,te=0,ie=r.reduce((Re,Ne)=>Re+Ne.before.length+Ne.lines.length+Ne.after.length,0);if(ie+=t.beforeBody.length+t.afterBody.length,z&&(X+=z*D.lineHeight+(z-1)*e.titleSpacing+e.titleMarginBottom),ie){const Re=e.displayColors?Math.max(s,T.lineHeight):T.lineHeight;X+=$*Re+(ie-$)*T.lineHeight+(ie-1)*e.bodySpacing}F&&(X+=e.footerMarginTop+F*P.lineHeight+(F-1)*e.footerSpacing);let we=0;const Ie=function(Re){te=Math.max(te,n.measureText(Re).width+we)};return n.save(),n.font=D.string,Gs(t.title,Ie),n.font=T.string,Gs(t.beforeBody.concat(t.afterBody),Ie),we=e.displayColors?m+2+e.boxPadding:0,Gs(r,Re=>{Gs(Re.before,Ie),Gs(Re.lines,Ie),Gs(Re.after,Ie)}),we=0,n.font=P.string,Gs(t.footer,Ie),n.restore(),te+=J.width,{width:te,height:X}}function fce(t,e){const{y:n,height:r}=e;return n<r/2?"top":n>t.height-r/2?"bottom":"center"}function pce(t,e,n,r){const{x:c,width:d}=r,m=n.caretSize+n.caretPadding;if(t==="left"&&c+d+m>e.width||t==="right"&&c-d-m<0)return!0}function mce(t,e,n,r){const{x:c,width:d}=n,{width:m,chartArea:{left:s,right:T}}=t;let D="center";return r==="center"?D=c<=(s+T)/2?"left":"right":c<=d/2?D="left":c>=m-d/2&&(D="right"),pce(D,t,e,n)&&(D="center"),D}function TV(t,e,n){const r=n.yAlign||e.yAlign||fce(t,n);return{xAlign:n.xAlign||e.xAlign||mce(t,e,n,r),yAlign:r}}function gce(t,e){let{x:n,width:r}=t;return e==="right"?n-=r:e==="center"&&(n-=r/2),n}function _ce(t,e,n){let{y:r,height:c}=t;return e==="top"?r+=n:e==="bottom"?r-=c+n:r-=c/2,r}function EV(t,e,n,r){const{caretSize:c,caretPadding:d,cornerRadius:m}=t,{xAlign:s,yAlign:T}=n,D=c+d,{topLeft:P,topRight:z,bottomLeft:F,bottomRight:$}=Bw(m);let J=gce(e,s);const X=_ce(e,T,D);return T==="center"?s==="left"?J+=D:s==="right"&&(J-=D):s==="left"?J-=Math.max(P,F)+c:s==="right"&&(J+=Math.max(z,$)+c),{x:$u(J,0,r.width-e.width),y:$u(X,0,r.height-e.height)}}function wR(t,e,n){const r=of(n.padding);return e==="center"?t.x+t.width/2:e==="right"?t.x+t.width-r.right:t.x+r.left}function SV(t){return Im([],m_(t))}function yce(t,e,n){return ET(t,{tooltip:e,tooltipItems:n,type:"tooltip"})}function AV(t,e){const n=e&&e.dataset&&e.dataset.tooltip&&e.dataset.tooltip.callbacks;return n?t.override(n):t}const Q8={beforeTitle:d_,title(t){if(t.length>0){const e=t[0],n=e.chart.data.labels,r=n?n.length:0;if(this&&this.options&&this.options.mode==="dataset")return e.dataset.label||"";if(e.label)return e.label;if(r>0&&e.dataIndex<r)return n[e.dataIndex]}return""},afterTitle:d_,beforeBody:d_,beforeLabel:d_,label(t){if(this&&this.options&&this.options.mode==="dataset")return t.label+": "+t.formattedValue||t.formattedValue;let e=t.dataset.label||"";e&&(e+=": ");const n=t.formattedValue;return no(n)||(e+=n),e},labelColor(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{borderColor:n.borderColor,backgroundColor:n.backgroundColor,borderWidth:n.borderWidth,borderDash:n.borderDash,borderDashOffset:n.borderDashOffset,borderRadius:0}},labelTextColor(){return this.options.bodyColor},labelPointStyle(t){const n=t.chart.getDatasetMeta(t.datasetIndex).controller.getStyle(t.dataIndex);return{pointStyle:n.pointStyle,rotation:n.rotation}},afterLabel:d_,afterBody:d_,beforeFooter:d_,footer:d_,afterFooter:d_};function Vu(t,e,n,r){const c=t[e].call(n,r);return typeof c>"u"?Q8[e].call(n,r):c}class pN extends Mx{constructor(e){super(),this.opacity=0,this._active=[],this._eventPosition=void 0,this._size=void 0,this._cachedAnimations=void 0,this._tooltipItems=[],this.$animations=void 0,this.$context=void 0,this.chart=e.chart,this.options=e.options,this.dataPoints=void 0,this.title=void 0,this.beforeBody=void 0,this.body=void 0,this.afterBody=void 0,this.footer=void 0,this.xAlign=void 0,this.yAlign=void 0,this.x=void 0,this.y=void 0,this.height=void 0,this.width=void 0,this.caretX=void 0,this.caretY=void 0,this.labelColors=void 0,this.labelPointStyles=void 0,this.labelTextColors=void 0}initialize(e){this.options=e,this._cachedAnimations=void 0,this.$context=void 0}_resolveAnimations(){const e=this._cachedAnimations;if(e)return e;const n=this.chart,r=this.options.setContext(this.getContext()),c=r.enabled&&n.options.animation&&r.animations,d=new L8(this.chart,c);return c._cacheable&&(this._cachedAnimations=Object.freeze(d)),d}getContext(){return this.$context||(this.$context=yce(this.chart.getContext(),this,this._tooltipItems))}getTitle(e,n){const{callbacks:r}=n,c=Vu(r,"beforeTitle",this,e),d=Vu(r,"title",this,e),m=Vu(r,"afterTitle",this,e);let s=[];return s=Im(s,m_(c)),s=Im(s,m_(d)),s=Im(s,m_(m)),s}getBeforeBody(e,n){return SV(Vu(n.callbacks,"beforeBody",this,e))}getBody(e,n){const{callbacks:r}=n,c=[];return Gs(e,d=>{const m={before:[],lines:[],after:[]},s=AV(r,d);Im(m.before,m_(Vu(s,"beforeLabel",this,d))),Im(m.lines,Vu(s,"label",this,d)),Im(m.after,m_(Vu(s,"afterLabel",this,d))),c.push(m)}),c}getAfterBody(e,n){return SV(Vu(n.callbacks,"afterBody",this,e))}getFooter(e,n){const{callbacks:r}=n,c=Vu(r,"beforeFooter",this,e),d=Vu(r,"footer",this,e),m=Vu(r,"afterFooter",this,e);let s=[];return s=Im(s,m_(c)),s=Im(s,m_(d)),s=Im(s,m_(m)),s}_createItems(e){const n=this._active,r=this.chart.data,c=[],d=[],m=[];let s=[],T,D;for(T=0,D=n.length;T<D;++T)s.push(dce(this.chart,n[T]));return e.filter&&(s=s.filter((P,z,F)=>e.filter(P,z,F,r))),e.itemSort&&(s=s.sort((P,z)=>e.itemSort(P,z,r))),Gs(s,P=>{const z=AV(e.callbacks,P);c.push(Vu(z,"labelColor",this,P)),d.push(Vu(z,"labelPointStyle",this,P)),m.push(Vu(z,"labelTextColor",this,P))}),this.labelColors=c,this.labelPointStyles=d,this.labelTextColors=m,this.dataPoints=s,s}update(e,n){const r=this.options.setContext(this.getContext()),c=this._active;let d,m=[];if(!c.length)this.opacity!==0&&(d={opacity:0});else{const s=NS[r.position].call(this,c,this._eventPosition);m=this._createItems(r),this.title=this.getTitle(m,r),this.beforeBody=this.getBeforeBody(m,r),this.body=this.getBody(m,r),this.afterBody=this.getAfterBody(m,r),this.footer=this.getFooter(m,r);const T=this._size=wV(this,r),D=Object.assign({},s,T),P=TV(this.chart,r,D),z=EV(r,D,P,this.chart);this.xAlign=P.xAlign,this.yAlign=P.yAlign,d={opacity:1,x:z.x,y:z.y,width:T.width,height:T.height,caretX:s.x,caretY:s.y}}this._tooltipItems=m,this.$context=void 0,d&&this._resolveAnimations().update(this,d),e&&r.external&&r.external.call(this,{chart:this.chart,tooltip:this,replay:n})}drawCaret(e,n,r,c){const d=this.getCaretPosition(e,r,c);n.lineTo(d.x1,d.y1),n.lineTo(d.x2,d.y2),n.lineTo(d.x3,d.y3)}getCaretPosition(e,n,r){const{xAlign:c,yAlign:d}=this,{caretSize:m,cornerRadius:s}=r,{topLeft:T,topRight:D,bottomLeft:P,bottomRight:z}=Bw(s),{x:F,y:$}=e,{width:J,height:X}=n;let te,ie,we,Ie,Re,Ne;return d==="center"?(Re=$+X/2,c==="left"?(te=F,ie=te-m,Ie=Re+m,Ne=Re-m):(te=F+J,ie=te+m,Ie=Re-m,Ne=Re+m),we=te):(c==="left"?ie=F+Math.max(T,P)+m:c==="right"?ie=F+J-Math.max(D,z)-m:ie=this.caretX,d==="top"?(Ie=$,Re=Ie-m,te=ie-m,we=ie+m):(Ie=$+X,Re=Ie+m,te=ie+m,we=ie-m),Ne=Ie),{x1:te,x2:ie,x3:we,y1:Ie,y2:Re,y3:Ne}}drawTitle(e,n,r){const c=this.title,d=c.length;let m,s,T;if(d){const D=Fw(r.rtl,this.x,this.width);for(e.x=wR(this,r.titleAlign,r),n.textAlign=D.textAlign(r.titleAlign),n.textBaseline="middle",m=Fc(r.titleFont),s=r.titleSpacing,n.fillStyle=r.titleColor,n.font=m.string,T=0;T<d;++T)n.fillText(c[T],D.x(e.x),e.y+m.lineHeight/2),e.y+=m.lineHeight+s,T+1===d&&(e.y+=r.titleMarginBottom-s)}}_drawColorBox(e,n,r,c,d){const m=this.labelColors[r],s=this.labelPointStyles[r],{boxHeight:T,boxWidth:D}=d,P=Fc(d.bodyFont),z=wR(this,"left",d),F=c.x(z),$=T<P.lineHeight?(P.lineHeight-T)/2:0,J=n.y+$;if(d.usePointStyle){const X={radius:Math.min(D,T)/2,pointStyle:s.pointStyle,rotation:s.rotation,borderWidth:1},te=c.leftForLtr(F,D)+D/2,ie=J+T/2;e.strokeStyle=d.multiKeyBackground,e.fillStyle=d.multiKeyBackground,UF(e,X,te,ie),e.strokeStyle=m.borderColor,e.fillStyle=m.backgroundColor,UF(e,X,te,ie)}else{e.lineWidth=_s(m.borderWidth)?Math.max(...Object.values(m.borderWidth)):m.borderWidth||1,e.strokeStyle=m.borderColor,e.setLineDash(m.borderDash||[]),e.lineDashOffset=m.borderDashOffset||0;const X=c.leftForLtr(F,D),te=c.leftForLtr(c.xPlus(F,1),D-2),ie=Bw(m.borderRadius);Object.values(ie).some(we=>we!==0)?(e.beginPath(),e.fillStyle=d.multiKeyBackground,YO(e,{x:X,y:J,w:D,h:T,radius:ie}),e.fill(),e.stroke(),e.fillStyle=m.backgroundColor,e.beginPath(),YO(e,{x:te,y:J+1,w:D-2,h:T-2,radius:ie}),e.fill()):(e.fillStyle=d.multiKeyBackground,e.fillRect(X,J,D,T),e.strokeRect(X,J,D,T),e.fillStyle=m.backgroundColor,e.fillRect(te,J+1,D-2,T-2))}e.fillStyle=this.labelTextColors[r]}drawBody(e,n,r){const{body:c}=this,{bodySpacing:d,bodyAlign:m,displayColors:s,boxHeight:T,boxWidth:D,boxPadding:P}=r,z=Fc(r.bodyFont);let F=z.lineHeight,$=0;const J=Fw(r.rtl,this.x,this.width),X=function(_e){n.fillText(_e,J.x(e.x+$),e.y+F/2),e.y+=F+d},te=J.textAlign(m);let ie,we,Ie,Re,Ne,Xe,be;for(n.textAlign=m,n.textBaseline="middle",n.font=z.string,e.x=wR(this,te,r),n.fillStyle=r.bodyColor,Gs(this.beforeBody,X),$=s&&te!=="right"?m==="center"?D/2+P:D+2+P:0,Re=0,Xe=c.length;Re<Xe;++Re){for(ie=c[Re],we=this.labelTextColors[Re],n.fillStyle=we,Gs(ie.before,X),Ie=ie.lines,s&&Ie.length&&(this._drawColorBox(n,e,Re,J,r),F=Math.max(z.lineHeight,T)),Ne=0,be=Ie.length;Ne<be;++Ne)X(Ie[Ne]),F=z.lineHeight;Gs(ie.after,X)}$=0,F=z.lineHeight,Gs(this.afterBody,X),e.y-=d}drawFooter(e,n,r){const c=this.footer,d=c.length;let m,s;if(d){const T=Fw(r.rtl,this.x,this.width);for(e.x=wR(this,r.footerAlign,r),e.y+=r.footerMarginTop,n.textAlign=T.textAlign(r.footerAlign),n.textBaseline="middle",m=Fc(r.footerFont),n.fillStyle=r.footerColor,n.font=m.string,s=0;s<d;++s)n.fillText(c[s],T.x(e.x),e.y+m.lineHeight/2),e.y+=m.lineHeight+r.footerSpacing}}drawBackground(e,n,r,c){const{xAlign:d,yAlign:m}=this,{x:s,y:T}=e,{width:D,height:P}=r,{topLeft:z,topRight:F,bottomLeft:$,bottomRight:J}=Bw(c.cornerRadius);n.fillStyle=c.backgroundColor,n.strokeStyle=c.borderColor,n.lineWidth=c.borderWidth,n.beginPath(),n.moveTo(s+z,T),m==="top"&&this.drawCaret(e,n,r,c),n.lineTo(s+D-F,T),n.quadraticCurveTo(s+D,T,s+D,T+F),m==="center"&&d==="right"&&this.drawCaret(e,n,r,c),n.lineTo(s+D,T+P-J),n.quadraticCurveTo(s+D,T+P,s+D-J,T+P),m==="bottom"&&this.drawCaret(e,n,r,c),n.lineTo(s+$,T+P),n.quadraticCurveTo(s,T+P,s,T+P-$),m==="center"&&d==="left"&&this.drawCaret(e,n,r,c),n.lineTo(s,T+z),n.quadraticCurveTo(s,T,s+z,T),n.closePath(),n.fill(),c.borderWidth>0&&n.stroke()}_updateAnimationTarget(e){const n=this.chart,r=this.$animations,c=r&&r.x,d=r&&r.y;if(c||d){const m=NS[e.position].call(this,this._active,this._eventPosition);if(!m)return;const s=this._size=wV(this,e),T=Object.assign({},m,this._size),D=TV(n,e,T),P=EV(e,T,D,n);(c._to!==P.x||d._to!==P.y)&&(this.xAlign=D.xAlign,this.yAlign=D.yAlign,this.width=s.width,this.height=s.height,this.caretX=m.x,this.caretY=m.y,this._resolveAnimations().update(this,P))}}_willRender(){return!!this.opacity}draw(e){const n=this.options.setContext(this.getContext());let r=this.opacity;if(!r)return;this._updateAnimationTarget(n);const c={width:this.width,height:this.height},d={x:this.x,y:this.y};r=Math.abs(r)<.001?0:r;const m=of(n.padding),s=this.title.length||this.beforeBody.length||this.body.length||this.afterBody.length||this.footer.length;n.enabled&&s&&(e.save(),e.globalAlpha=r,this.drawBackground(d,e,c,n),k8(e,n.textDirection),d.y+=m.top,this.drawTitle(d,e,n),this.drawBody(d,e,n),this.drawFooter(d,e,n),N8(e,n.textDirection),e.restore())}getActiveElements(){return this._active||[]}setActiveElements(e,n){const r=this._active,c=e.map(({datasetIndex:s,index:T})=>{const D=this.chart.getDatasetMeta(s);if(!D)throw new Error("Cannot find a dataset at index "+s);return{datasetIndex:s,element:D.data[T],index:T}}),d=!HO(r,c),m=this._positionChanged(c,n);(d||m)&&(this._active=c,this._eventPosition=n,this._ignoreReplayEvents=!0,this.update(!0))}handleEvent(e,n,r=!0){if(n&&this._ignoreReplayEvents)return!1;this._ignoreReplayEvents=!1;const c=this.options,d=this._active||[],m=this._getActiveElements(e,d,n,r),s=this._positionChanged(m,e),T=n||!HO(m,d)||s;return T&&(this._active=m,(c.enabled||c.external)&&(this._eventPosition={x:e.x,y:e.y},this.update(!0,n))),T}_getActiveElements(e,n,r,c){const d=this.options;if(e.type==="mouseout")return[];if(!c)return n.filter(s=>this.chart.data.datasets[s.datasetIndex]&&this.chart.getDatasetMeta(s.datasetIndex).controller.getParsed(s.index)!==void 0);const m=this.chart.getElementsAtEventForMode(e,d.mode,d,r);return d.reverse&&m.reverse(),m}_positionChanged(e,n){const{caretX:r,caretY:c,options:d}=this,m=NS[d.position].call(this,e,n);return m!==!1&&(r!==m.x||c!==m.y)}}ki(pN,"positioners",NS);var vce={id:"tooltip",_element:pN,positioners:NS,afterInit(t,e,n){n&&(t.tooltip=new pN({chart:t,options:n}))},beforeUpdate(t,e,n){t.tooltip&&t.tooltip.initialize(n)},reset(t,e,n){t.tooltip&&t.tooltip.initialize(n)},afterDraw(t){const e=t.tooltip;if(e&&e._willRender()){const n={tooltip:e};if(t.notifyPlugins("beforeTooltipDraw",{...n,cancelable:!0})===!1)return;e.draw(t.ctx),t.notifyPlugins("afterTooltipDraw",n)}},afterEvent(t,e){if(t.tooltip){const n=e.replay;t.tooltip.handleEvent(e.event,n,e.inChartArea)&&(e.changed=!0)}},defaults:{enabled:!0,external:null,position:"average",backgroundColor:"rgba(0,0,0,0.8)",titleColor:"#fff",titleFont:{weight:"bold"},titleSpacing:2,titleMarginBottom:6,titleAlign:"left",bodyColor:"#fff",bodySpacing:2,bodyFont:{},bodyAlign:"left",footerColor:"#fff",footerSpacing:2,footerMarginTop:6,footerFont:{weight:"bold"},footerAlign:"left",padding:6,caretPadding:2,caretSize:5,cornerRadius:6,boxHeight:(t,e)=>e.bodyFont.size,boxWidth:(t,e)=>e.bodyFont.size,multiKeyBackground:"#fff",displayColors:!0,boxPadding:0,borderColor:"rgba(0,0,0,0)",borderWidth:0,animation:{duration:400,easing:"easeOutQuart"},animations:{numbers:{type:"number",properties:["x","y","width","height","caretX","caretY"]},opacity:{easing:"linear",duration:200}},callbacks:Q8},defaultRoutes:{bodyFont:"font",footerFont:"font",titleFont:"font"},descriptors:{_scriptable:t=>t!=="filter"&&t!=="itemSort"&&t!=="external",_indexable:!1,callbacks:{_scriptable:!1,_indexable:!1},animation:{_fallback:!1},animations:{_fallback:"animation"}},additionalOptionScopes:["interaction"]};const bce=(t,e,n,r)=>(typeof e=="string"?(n=t.push(e)-1,r.unshift({index:n,label:e})):isNaN(e)&&(n=null),n);function xce(t,e,n,r){const c=t.indexOf(e);if(c===-1)return bce(t,e,n,r);const d=t.lastIndexOf(e);return c!==d?n:c}const wce=(t,e)=>t===null?null:$u(Math.round(t),0,e);function CV(t){const e=this.getLabels();return t>=0&&t<e.length?e[t]:t}class mN extends ST{constructor(e){super(e),this._startValue=void 0,this._valueRange=0,this._addedLabels=[]}init(e){const n=this._addedLabels;if(n.length){const r=this.getLabels();for(const{index:c,label:d}of n)r[c]===d&&r.splice(c,1);this._addedLabels=[]}super.init(e)}parse(e,n){if(no(e))return null;const r=this.getLabels();return n=isFinite(n)&&r[n]===e?n:xce(r,e,gs(n,e),this._addedLabels),wce(n,r.length-1)}determineDataLimits(){const{minDefined:e,maxDefined:n}=this.getUserBounds();let{min:r,max:c}=this.getMinMax(!0);this.options.bounds==="ticks"&&(e||(r=0),n||(c=this.getLabels().length-1)),this.min=r,this.max=c}buildTicks(){const e=this.min,n=this.max,r=this.options.offset,c=[];let d=this.getLabels();d=e===0&&n===d.length-1?d:d.slice(e,n+1),this._valueRange=Math.max(d.length-(r?0:1),1),this._startValue=this.min-(r?.5:0);for(let m=e;m<=n;m++)c.push({value:m});return c}getLabelForValue(e){return CV.call(this,e)}configure(){super.configure(),this.isHorizontal()||(this._reversePixels=!this._reversePixels)}getPixelForValue(e){return typeof e!="number"&&(e=this.parse(e)),e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getPixelForTick(e){const n=this.ticks;return e<0||e>n.length-1?null:this.getPixelForValue(n[e].value)}getValueForPixel(e){return Math.round(this._startValue+this.getDecimalForPixel(e)*this._valueRange)}getBasePixel(){return this.bottom}}ki(mN,"id","category"),ki(mN,"defaults",{ticks:{callback:CV}});function Tce(t,e){const n=[],{bounds:c,step:d,min:m,max:s,precision:T,count:D,maxTicks:P,maxDigits:z,includeBounds:F}=t,$=d||1,J=P-1,{min:X,max:te}=e,ie=!no(m),we=!no(s),Ie=!no(D),Re=(te-X)/(z+1);let Ne=MF((te-X)/J/$)*$,Xe,be,_e,Te;if(Ne<1e-14&&!ie&&!we)return[{value:X},{value:te}];Te=Math.ceil(te/Ne)-Math.floor(X/Ne),Te>J&&(Ne=MF(Te*Ne/J/$)*$),no(T)||(Xe=Math.pow(10,T),Ne=Math.ceil(Ne*Xe)/Xe),c==="ticks"?(be=Math.floor(X/Ne)*Ne,_e=Math.ceil(te/Ne)*Ne):(be=X,_e=te),ie&&we&&d&&voe((s-m)/d,Ne/1e3)?(Te=Math.round(Math.min((s-m)/Ne,P)),Ne=(s-m)/Te,be=m,_e=s):Ie?(be=ie?m:be,_e=we?s:_e,Te=D-1,Ne=(_e-be)/Te):(Te=(_e-be)/Ne,JR(Te,Math.round(Te),Ne/1e3)?Te=Math.round(Te):Te=Math.ceil(Te));const oe=Math.max(PF(Ne),PF(be));Xe=Math.pow(10,no(T)?oe:T),be=Math.round(be*Xe)/Xe,_e=Math.round(_e*Xe)/Xe;let Ee=0;for(ie&&(F&&be!==m?(n.push({value:m}),be<m&&Ee++,JR(Math.round((be+Ee*Ne)*Xe)/Xe,m,DV(m,Re,t))&&Ee++):be<m&&Ee++);Ee<Te;++Ee){const $e=Math.round((be+Ee*Ne)*Xe)/Xe;if(we&&$e>s)break;n.push({value:$e})}return we&&F&&_e!==s?n.length&&JR(n[n.length-1].value,s,DV(s,Re,t))?n[n.length-1].value=s:n.push({value:s}):(!we||_e===s)&&n.push({value:_e}),n}function DV(t,e,{horizontal:n,minRotation:r}){const c=v_(r),d=(n?Math.sin(c):Math.cos(c))||.001,m=.75*e*(""+t).length;return Math.min(e/d,m)}class Ece extends ST{constructor(e){super(e),this.start=void 0,this.end=void 0,this._startValue=void 0,this._endValue=void 0,this._valueRange=0}parse(e,n){return no(e)||(typeof e=="number"||e instanceof Number)&&!isFinite(+e)?null:+e}handleTickRangeOptions(){const{beginAtZero:e}=this.options,{minDefined:n,maxDefined:r}=this.getUserBounds();let{min:c,max:d}=this;const m=T=>c=n?c:T,s=T=>d=r?d:T;if(e){const T=Wv(c),D=Wv(d);T<0&&D<0?s(0):T>0&&D>0&&m(0)}if(c===d){let T=d===0?1:Math.abs(d*.05);s(d+T),e||m(c-T)}this.min=c,this.max=d}getTickLimit(){const e=this.options.ticks;let{maxTicksLimit:n,stepSize:r}=e,c;return r?(c=Math.ceil(this.max/r)-Math.floor(this.min/r)+1,c>1e3&&(console.warn(`scales.${this.id}.ticks.stepSize: ${r} would result generating up to ${c} ticks. Limiting to 1000.`),c=1e3)):(c=this.computeTickLimit(),n=n||11),n&&(c=Math.min(n,c)),c}computeTickLimit(){return Number.POSITIVE_INFINITY}buildTicks(){const e=this.options,n=e.ticks;let r=this.getTickLimit();r=Math.max(2,r);const c={maxTicks:r,bounds:e.bounds,min:e.min,max:e.max,precision:n.precision,step:n.stepSize,count:n.count,maxDigits:this._maxDigits(),horizontal:this.isHorizontal(),minRotation:n.minRotation||0,includeBounds:n.includeBounds!==!1},d=this._range||this,m=Tce(c,d);return e.bounds==="ticks"&&boe(m,this,"value"),e.reverse?(m.reverse(),this.start=this.max,this.end=this.min):(this.start=this.min,this.end=this.max),m}configure(){const e=this.ticks;let n=this.min,r=this.max;if(super.configure(),this.options.offset&&e.length){const c=(r-n)/Math.max(e.length-1,1)/2;n-=c,r+=c}this._startValue=n,this._endValue=r,this._valueRange=r-n}getLabelForValue(e){return mL(e,this.chart.options.locale,this.options.ticks.format)}}class gN extends Ece{determineDataLimits(){const{min:e,max:n}=this.getMinMax(!0);this.min=sf(e)?e:0,this.max=sf(n)?n:1,this.handleTickRangeOptions()}computeTickLimit(){const e=this.isHorizontal(),n=e?this.width:this.height,r=v_(this.options.ticks.minRotation),c=(e?Math.sin(r):Math.cos(r))||.001,d=this._resolveTickFontOptions(0);return Math.ceil(n/Math.min(40,d.lineHeight/c))}getPixelForValue(e){return e===null?NaN:this.getPixelForDecimal((e-this._startValue)/this._valueRange)}getValueForPixel(e){return this._startValue+this.getDecimalForPixel(e)*this._valueRange}}ki(gN,"id","linear"),ki(gN,"defaults",{ticks:{callback:A8.formatters.numeric}});const uM={millisecond:{common:!0,size:1,steps:1e3},second:{common:!0,size:1e3,steps:60},minute:{common:!0,size:6e4,steps:60},hour:{common:!0,size:36e5,steps:24},day:{common:!0,size:864e5,steps:30},week:{common:!1,size:6048e5,steps:4},month:{common:!0,size:2628e6,steps:12},quarter:{common:!1,size:7884e6,steps:4},year:{common:!0,size:3154e7}},Hu=Object.keys(uM);function RV(t,e){return t-e}function OV(t,e){if(no(e))return null;const n=t._adapter,{parser:r,round:c,isoWeekday:d}=t._parseOpts;let m=e;return typeof r=="function"&&(m=r(m)),sf(m)||(m=typeof r=="string"?n.parse(m,r):n.parse(m)),m===null?null:(c&&(m=c==="week"&&(qO(d)||d===!0)?n.startOf(m,"isoWeek",d):n.startOf(m,c)),+m)}function IV(t,e,n,r){const c=Hu.length;for(let d=Hu.indexOf(t);d<c-1;++d){const m=uM[Hu[d]],s=m.steps?m.steps:Number.MAX_SAFE_INTEGER;if(m.common&&Math.ceil((n-e)/(s*m.size))<=r)return Hu[d]}return Hu[c-1]}function Sce(t,e,n,r,c){for(let d=Hu.length-1;d>=Hu.indexOf(n);d--){const m=Hu[d];if(uM[m].common&&t._adapter.diff(c,r,m)>=e-1)return m}return Hu[n?Hu.indexOf(n):0]}function Ace(t){for(let e=Hu.indexOf(t)+1,n=Hu.length;e<n;++e)if(uM[Hu[e]].common)return Hu[e]}function MV(t,e,n){if(!n)t[e]=!0;else if(n.length){const{lo:r,hi:c}=fL(n,e),d=n[r]>=e?n[r]:n[c];t[d]=!0}}function Cce(t,e,n,r){const c=t._adapter,d=+c.startOf(e[0].value,r),m=e[e.length-1].value;let s,T;for(s=d;s<=m;s=+c.add(s,1,r))T=n[s],T>=0&&(e[T].major=!0);return e}function PV(t,e,n){const r=[],c={},d=e.length;let m,s;for(m=0;m<d;++m)s=e[m],c[s]=m,r.push({value:s,major:!1});return d===0||!n?r:Cce(t,r,c,n)}class KO extends ST{constructor(e){super(e),this._cache={data:[],labels:[],all:[]},this._unit="day",this._majorUnit=void 0,this._offsets={},this._normalized=!1,this._parseOpts=void 0}init(e,n={}){const r=e.time||(e.time={}),c=this._adapter=new Bae._date(e.adapters.date);c.init(n),qS(r.displayFormats,c.formats()),this._parseOpts={parser:r.parser,round:r.round,isoWeekday:r.isoWeekday},super.init(e),this._normalized=n.normalized}parse(e,n){return e===void 0?null:OV(this,e)}beforeLayout(){super.beforeLayout(),this._cache={data:[],labels:[],all:[]}}determineDataLimits(){const e=this.options,n=this._adapter,r=e.time.unit||"day";let{min:c,max:d,minDefined:m,maxDefined:s}=this.getUserBounds();function T(D){!m&&!isNaN(D.min)&&(c=Math.min(c,D.min)),!s&&!isNaN(D.max)&&(d=Math.max(d,D.max))}(!m||!s)&&(T(this._getLabelBounds()),(e.bounds!=="ticks"||e.ticks.source!=="labels")&&T(this.getMinMax(!1))),c=sf(c)&&!isNaN(c)?c:+n.startOf(Date.now(),r),d=sf(d)&&!isNaN(d)?d:+n.endOf(Date.now(),r)+1,this.min=Math.min(c,d-1),this.max=Math.max(c+1,d)}_getLabelBounds(){const e=this.getLabelTimestamps();let n=Number.POSITIVE_INFINITY,r=Number.NEGATIVE_INFINITY;return e.length&&(n=e[0],r=e[e.length-1]),{min:n,max:r}}buildTicks(){const e=this.options,n=e.time,r=e.ticks,c=r.source==="labels"?this.getLabelTimestamps():this._generate();e.bounds==="ticks"&&c.length&&(this.min=this._userMin||c[0],this.max=this._userMax||c[c.length-1]);const d=this.min,m=this.max,s=Soe(c,d,m);return this._unit=n.unit||(r.autoSkip?IV(n.minUnit,this.min,this.max,this._getLabelCapacity(d)):Sce(this,s.length,n.minUnit,this.min,this.max)),this._majorUnit=!r.major.enabled||this._unit==="year"?void 0:Ace(this._unit),this.initOffsets(c),e.reverse&&s.reverse(),PV(this,s,this._majorUnit)}afterAutoSkip(){this.options.offsetAfterAutoskip&&this.initOffsets(this.ticks.map(e=>+e.value))}initOffsets(e=[]){let n=0,r=0,c,d;this.options.offset&&e.length&&(c=this.getDecimalForValue(e[0]),e.length===1?n=1-c:n=(this.getDecimalForValue(e[1])-c)/2,d=this.getDecimalForValue(e[e.length-1]),e.length===1?r=d:r=(d-this.getDecimalForValue(e[e.length-2]))/2);const m=e.length<3?.5:.25;n=$u(n,0,m),r=$u(r,0,m),this._offsets={start:n,end:r,factor:1/(n+1+r)}}_generate(){const e=this._adapter,n=this.min,r=this.max,c=this.options,d=c.time,m=d.unit||IV(d.minUnit,n,r,this._getLabelCapacity(n)),s=gs(c.ticks.stepSize,1),T=m==="week"?d.isoWeekday:!1,D=qO(T)||T===!0,P={};let z=n,F,$;if(D&&(z=+e.startOf(z,"isoWeek",T)),z=+e.startOf(z,D?"day":m),e.diff(r,n,m)>1e5*s)throw new Error(n+" and "+r+" are too far apart with stepSize of "+s+" "+m);const J=c.ticks.source==="data"&&this.getDataTimestamps();for(F=z,$=0;F<r;F=+e.add(F,s,m),$++)MV(P,F,J);return(F===r||c.bounds==="ticks"||$===1)&&MV(P,F,J),Object.keys(P).sort(RV).map(X=>+X)}getLabelForValue(e){const n=this._adapter,r=this.options.time;return r.tooltipFormat?n.format(e,r.tooltipFormat):n.format(e,r.displayFormats.datetime)}format(e,n){const c=this.options.time.displayFormats,d=this._unit,m=n||c[d];return this._adapter.format(e,m)}_tickFormatFunction(e,n,r,c){const d=this.options,m=d.ticks.callback;if(m)return vo(m,[e,n,r],this);const s=d.time.displayFormats,T=this._unit,D=this._majorUnit,P=T&&s[T],z=D&&s[D],F=r[n],$=D&&z&&F&&F.major;return this._adapter.format(e,c||($?z:P))}generateTickLabels(e){let n,r,c;for(n=0,r=e.length;n<r;++n)c=e[n],c.label=this._tickFormatFunction(c.value,n,e)}getDecimalForValue(e){return e===null?NaN:(e-this.min)/(this.max-this.min)}getPixelForValue(e){const n=this._offsets,r=this.getDecimalForValue(e);return this.getPixelForDecimal((n.start+r)*n.factor)}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return this.min+r*(this.max-this.min)}_getLabelSize(e){const n=this.options.ticks,r=this.ctx.measureText(e).width,c=v_(this.isHorizontal()?n.maxRotation:n.minRotation),d=Math.cos(c),m=Math.sin(c),s=this._resolveTickFontOptions(0).size;return{w:r*d+s*m,h:r*m+s*d}}_getLabelCapacity(e){const n=this.options.time,r=n.displayFormats,c=r[n.unit]||r.millisecond,d=this._tickFormatFunction(e,0,PV(this,[e],this._majorUnit),c),m=this._getLabelSize(d),s=Math.floor(this.isHorizontal()?this.width/m.w:this.height/m.h)-1;return s>0?s:1}getDataTimestamps(){let e=this._cache.data||[],n,r;if(e.length)return e;const c=this.getMatchingVisibleMetas();if(this._normalized&&c.length)return this._cache.data=c[0].controller.getAllParsedValues(this);for(n=0,r=c.length;n<r;++n)e=e.concat(c[n].controller.getAllParsedValues(this));return this._cache.data=this.normalize(e)}getLabelTimestamps(){const e=this._cache.labels||[];let n,r;if(e.length)return e;const c=this.getLabels();for(n=0,r=c.length;n<r;++n)e.push(OV(this,c[n]));return this._cache.labels=this._normalized?e:this.normalize(e)}normalize(e){return w8(e.sort(RV))}}ki(KO,"id","time"),ki(KO,"defaults",{bounds:"data",adapters:{},time:{parser:!1,unit:!1,round:!1,isoWeekday:!1,minUnit:"millisecond",displayFormats:{}},ticks:{source:"auto",callback:!1,major:{enabled:!1}}});function TR(t,e,n){let r=0,c=t.length-1,d,m,s,T;n?(e>=t[r].pos&&e<=t[c].pos&&({lo:r,hi:c}=uN(t,"pos",e)),{pos:d,time:s}=t[r],{pos:m,time:T}=t[c]):(e>=t[r].time&&e<=t[c].time&&({lo:r,hi:c}=uN(t,"time",e)),{time:d,pos:s}=t[r],{time:m,pos:T}=t[c]);const D=m-d;return D?s+(T-s)*(e-d)/D:s}class kV extends KO{constructor(e){super(e),this._table=[],this._minPos=void 0,this._tableRange=void 0}initOffsets(){const e=this._getTimestampsForTable(),n=this._table=this.buildLookupTable(e);this._minPos=TR(n,this.min),this._tableRange=TR(n,this.max)-this._minPos,super.initOffsets(e)}buildLookupTable(e){const{min:n,max:r}=this,c=[],d=[];let m,s,T,D,P;for(m=0,s=e.length;m<s;++m)D=e[m],D>=n&&D<=r&&c.push(D);if(c.length<2)return[{time:n,pos:0},{time:r,pos:1}];for(m=0,s=c.length;m<s;++m)P=c[m+1],T=c[m-1],D=c[m],Math.round((P+T)/2)!==D&&d.push({time:D,pos:m/(s-1)});return d}_generate(){const e=this.min,n=this.max;let r=super.getDataTimestamps();return(!r.includes(e)||!r.length)&&r.splice(0,0,e),(!r.includes(n)||r.length===1)&&r.push(n),r.sort((c,d)=>c-d)}_getTimestampsForTable(){let e=this._cache.all||[];if(e.length)return e;const n=this.getDataTimestamps(),r=this.getLabelTimestamps();return n.length&&r.length?e=this.normalize(n.concat(r)):e=n.length?n:r,e=this._cache.all=e,e}getDecimalForValue(e){return(TR(this._table,e)-this._minPos)/this._tableRange}getValueForPixel(e){const n=this._offsets,r=this.getDecimalForPixel(e)/n.factor-n.end;return TR(this._table,r*this._tableRange+this._minPos,!0)}}ki(kV,"id","timeseries"),ki(kV,"defaults",KO.defaults);const K8="label";function NV(t,e){typeof t=="function"?t(e):t&&(t.current=e)}function Dce(t,e){const n=t.options;n&&e&&Object.assign(n,e)}function J8(t,e){t.labels=e}function eH(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:K8;const r=[];t.datasets=e.map(c=>{const d=t.datasets.find(m=>m[n]===c[n]);return!d||!c.data||r.includes(d)?{...c}:(r.push(d),Object.assign(d,c),d)})}function Rce(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:K8;const n={labels:[],datasets:[]};return J8(n,t.labels),eH(n,t.datasets,e),n}function Oce(t,e){const{height:n=150,width:r=300,redraw:c=!1,datasetIdKey:d,type:m,data:s,options:T,plugins:D=[],fallbackContent:P,updateMode:z,...F}=t,$=ke.useRef(null),J=ke.useRef(null),X=()=>{$.current&&(J.current=new cM($.current,{type:m,data:Rce(s,d),options:T&&{...T},plugins:D}),NV(e,J.current))},te=()=>{NV(e,null),J.current&&(J.current.destroy(),J.current=null)};return ke.useEffect(()=>{!c&&J.current&&T&&Dce(J.current,T)},[c,T]),ke.useEffect(()=>{!c&&J.current&&J8(J.current.config.data,s.labels)},[c,s.labels]),ke.useEffect(()=>{!c&&J.current&&s.datasets&&eH(J.current.config.data,s.datasets,d)},[c,s.datasets]),ke.useEffect(()=>{J.current&&(c?(te(),setTimeout(X)):J.current.update(z))},[c,T,s.labels,s.datasets,z]),ke.useEffect(()=>{J.current&&(te(),setTimeout(X))},[m]),ke.useEffect(()=>(X(),()=>te()),[]),Bc.createElement("canvas",{ref:$,role:"img",height:n,width:r,...F},P)}const Ice=ke.forwardRef(Oce);function tH(t,e){return cM.register(e),ke.forwardRef((n,r)=>Bc.createElement(Ice,{...n,ref:r,type:t}))}const Mce=tH("bar",eO),Pce=tH("doughnut",MS);cM.register(mN,gN,iO,hce,vce,cce,kS);const kce=()=>{const{currentList:t}=cf(),e=ke.useMemo(()=>{if(!t)return{addedItems:{},purchasedItems:{},userNames:{}};const T={addedItems:{},purchasedItems:{},userNames:{}};return t.members.forEach(D=>{T.addedItems[D]=0,T.purchasedItems[D]=0,T.userNames[D]=D.split("@")[0]}),t.items.forEach(D=>{D.addedBy&&D.addedBy in T.addedItems&&(T.addedItems[D.addedBy]++,D.done&&T.purchasedItems[D.addedBy]++)}),T},[t]),n=ke.useMemo(()=>{const T=Object.keys(e.addedItems),D=T.map(z=>e.userNames[z]),P=T.map(z=>e.addedItems[z]);return{labels:D,datasets:[{label:"Productes afegits",data:P,backgroundColor:["rgba(163, 239, 113, 0.8)","rgba(235, 113, 240, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)"],borderColor:["rgba(163, 239, 113, 1)","rgba(235, 113, 240, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)"],borderWidth:2}]}},[e]),r=ke.useMemo(()=>{const T=Object.keys(e.purchasedItems),D=T.map(z=>e.userNames[z]),P=T.map(z=>e.purchasedItems[z]);return{labels:D,datasets:[{label:"Productes comprats",data:P,backgroundColor:["rgba(163, 239, 113, 0.8)","rgba(235, 113, 240, 0.8)","rgba(54, 162, 235, 0.8)","rgba(255, 206, 86, 0.8)","rgba(75, 192, 192, 0.8)","rgba(153, 102, 255, 0.8)"],borderColor:["rgba(163, 239, 113, 1)","rgba(235, 113, 240, 1)","rgba(54, 162, 235, 1)","rgba(255, 206, 86, 1)","rgba(75, 192, 192, 1)","rgba(153, 102, 255, 1)"],borderWidth:2}]}},[e]),c={responsive:!0,plugins:{legend:{position:"top"},title:{display:!0,text:"Activitat dels Usuaris"}},scales:{y:{beginAtZero:!0,ticks:{stepSize:1}}}},d={responsive:!0,plugins:{legend:{position:"bottom"},title:{display:!0,text:"Distribució de Compres"}}};if(!t)return de.jsxDEV("div",{className:"analytics-container",children:[de.jsxDEV("h3",{children:"📊 Analítica d'Usuaris"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:176,columnNumber:9},void 0),de.jsxDEV("p",{children:"Selecciona una llista per veure les estadístiques dels usuaris."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:177,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:175,columnNumber:7},void 0);const m=Object.values(e.addedItems).reduce((T,D)=>T+D,0),s=Object.values(e.purchasedItems).reduce((T,D)=>T+D,0);return de.jsxDEV("div",{className:"analytics-container",children:[de.jsxDEV("h3",{children:["📊 Analítica d'Usuaris - ",t.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:187,columnNumber:7},void 0),de.jsxDEV("div",{className:"analytics-summary",children:[de.jsxDEV("div",{className:"stat-card",children:[de.jsxDEV("h4",{children:"📝 Total Productes Afegits"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:192,columnNumber:11},void 0),de.jsxDEV("span",{className:"stat-number",children:m},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:193,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:191,columnNumber:9},void 0),de.jsxDEV("div",{className:"stat-card",children:[de.jsxDEV("h4",{children:"✅ Total Productes Comprats"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:196,columnNumber:11},void 0),de.jsxDEV("span",{className:"stat-number",children:s},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:197,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:195,columnNumber:9},void 0),de.jsxDEV("div",{className:"stat-card",children:[de.jsxDEV("h4",{children:"👥 Membres Actius"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:200,columnNumber:11},void 0),de.jsxDEV("span",{className:"stat-number",children:t.members.length},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:201,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:199,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:190,columnNumber:7},void 0),de.jsxDEV("div",{className:"charts-container",children:[de.jsxDEV("div",{className:"chart-section",children:[de.jsxDEV("h4",{children:"📈 Productes Afegits per Usuari"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:208,columnNumber:11},void 0),de.jsxDEV("div",{className:"chart-wrapper",children:de.jsxDEV(Mce,{data:n,options:c},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:210,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:209,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:207,columnNumber:9},void 0),de.jsxDEV("div",{className:"chart-section",children:[de.jsxDEV("h4",{children:"🛒 Distribució de Compres"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:215,columnNumber:11},void 0),de.jsxDEV("div",{className:"chart-wrapper",children:de.jsxDEV(Pce,{data:r,options:d},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:217,columnNumber:13},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:216,columnNumber:11},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:214,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:206,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/components/UserAnalytics.tsx",lineNumber:186,columnNumber:5},void 0)},Nce=()=>{const t=Xm(),{currentList:e}=cf(),{currentUser:n}=lf();return n?e?de.jsxDEV("div",{className:"analytics-page",children:[de.jsxDEV("div",{className:"analytics-page-header",children:[de.jsxDEV("h1",{children:"📊 Gràfics d'Analítica"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:36,columnNumber:9},void 0),de.jsxDEV("div",{className:"current-list-info",children:de.jsxDEV("span",{className:"current-list-badge",children:["📋 ",e.name," | 📍 ",e.postalCode]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:38,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:37,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:35,columnNumber:7},void 0),de.jsxDEV(kce,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:44,columnNumber:7},void 0),de.jsxDEV("div",{className:"analytics-page-footer",children:[de.jsxDEV("button",{onClick:()=>t("/pendents"),className:"back-to-list-button",children:"← Tornar a la Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:47,columnNumber:9},void 0),de.jsxDEV("button",{onClick:()=>t("/lists"),className:"change-list-button",children:"📝 Canviar de Llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:50,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:46,columnNumber:7},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:34,columnNumber:5},void 0):de.jsxDEV(wx,{pageTitle:"Gràfics d'Analítica",pageIcon:"📊",description:"Selecciona una llista per veure les estadístiques dels usuaris i analitzar qui afegeix més productes i qui en compra més."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:25,columnNumber:7},void 0):de.jsxDEV(wx,{pageTitle:"Gràfics d'Analítica",pageIcon:"📊",description:"Selecciona una llista per veure les estadístiques dels usuaris i analitzar qui afegeix més productes i qui en compra més."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/AnalyticsPage.tsx",lineNumber:15,columnNumber:7},void 0)};var hM,Ui,nH,iH,lT,nx,LV,rH,sH,JO={},oH=[],Lce=/acit|ex(?:s|g|n|p|$)|rph|grid|ows|mnc|ntw|ine[ch]|zoo|^ord|itera/i;function Lv(t,e){for(var n in e)t[n]=e[n];return t}function aH(t){var e=t.parentNode;e&&e.removeChild(t)}function on(t,e,n){var r,c,d,m={};for(d in e)d=="key"?r=e[d]:d=="ref"?c=e[d]:m[d]=e[d];if(arguments.length>2&&(m.children=arguments.length>3?hM.call(arguments,2):n),typeof t=="function"&&t.defaultProps!=null)for(d in t.defaultProps)m[d]===void 0&&(m[d]=t.defaultProps[d]);return rO(t,m,r,c,null)}function rO(t,e,n,r,c){var d={type:t,props:e,key:n,ref:r,__k:null,__:null,__b:0,__e:null,__d:void 0,__c:null,__h:null,constructor:void 0,__v:c??++nH};return c==null&&Ui.vnode!=null&&Ui.vnode(d),d}function I_(){return{current:null}}function ea(t){return t.children}function zce(t,e,n,r,c){var d;for(d in n)d==="children"||d==="key"||d in e||eI(t,d,null,n[d],r);for(d in e)c&&typeof e[d]!="function"||d==="children"||d==="key"||d==="value"||d==="checked"||n[d]===e[d]||eI(t,d,e[d],n[d],r)}function zV(t,e,n){e[0]==="-"?t.setProperty(e,n??""):t[e]=n==null?"":typeof n!="number"||Lce.test(e)?n:n+"px"}function eI(t,e,n,r,c){var d;e:if(e==="style")if(typeof n=="string")t.style.cssText=n;else{if(typeof r=="string"&&(t.style.cssText=r=""),r)for(e in r)n&&e in n||zV(t.style,e,"");if(n)for(e in n)r&&n[e]===r[e]||zV(t.style,e,n[e])}else if(e[0]==="o"&&e[1]==="n")d=e!==(e=e.replace(/Capture$/,"")),e=e.toLowerCase()in t?e.toLowerCase().slice(2):e.slice(2),t.l||(t.l={}),t.l[e+d]=n,n?r||t.addEventListener(e,d?FV:BV,d):t.removeEventListener(e,d?FV:BV,d);else if(e!=="dangerouslySetInnerHTML"){if(c)e=e.replace(/xlink(H|:h)/,"h").replace(/sName$/,"s");else if(e!=="width"&&e!=="height"&&e!=="href"&&e!=="list"&&e!=="form"&&e!=="tabIndex"&&e!=="download"&&e in t)try{t[e]=n??"";break e}catch{}typeof n=="function"||(n==null||n===!1&&e.indexOf("-")==-1?t.removeAttribute(e):t.setAttribute(e,n))}}function BV(t){lT=!0;try{return this.l[t.type+!1](Ui.event?Ui.event(t):t)}finally{lT=!1}}function FV(t){lT=!0;try{return this.l[t.type+!0](Ui.event?Ui.event(t):t)}finally{lT=!1}}function Yh(t,e){this.props=t,this.context=e}function wA(t,e){if(e==null)return t.__?wA(t.__,t.__.__k.indexOf(t)+1):null;for(var n;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null)return n.__e;return typeof t.type=="function"?wA(t):null}function lH(t){var e,n;if((t=t.__)!=null&&t.__c!=null){for(t.__e=t.__c.base=null,e=0;e<t.__k.length;e++)if((n=t.__k[e])!=null&&n.__e!=null){t.__e=t.__c.base=n.__e;break}return lH(t)}}function Bce(t){lT?setTimeout(t):rH(t)}function _N(t){(!t.__d&&(t.__d=!0)&&nx.push(t)&&!tI.__r++||LV!==Ui.debounceRendering)&&((LV=Ui.debounceRendering)||Bce)(tI)}function tI(){var t,e,n,r,c,d,m,s;for(nx.sort(function(T,D){return T.__v.__b-D.__v.__b});t=nx.shift();)t.__d&&(e=nx.length,r=void 0,c=void 0,m=(d=(n=t).__v).__e,(s=n.__P)&&(r=[],(c=Lv({},d)).__v=d.__v+1,SL(s,d,c,n.__n,s.ownerSVGElement!==void 0,d.__h!=null?[m]:null,r,m??wA(d),d.__h),fH(r,d),d.__e!=m&&lH(d)),nx.length>e&&nx.sort(function(T,D){return T.__v.__b-D.__v.__b}));tI.__r=0}function cH(t,e,n,r,c,d,m,s,T,D){var P,z,F,$,J,X,te,ie=r&&r.__k||oH,we=ie.length;for(n.__k=[],P=0;P<e.length;P++)if(($=n.__k[P]=($=e[P])==null||typeof $=="boolean"?null:typeof $=="string"||typeof $=="number"||typeof $=="bigint"?rO(null,$,null,null,$):Array.isArray($)?rO(ea,{children:$},null,null,null):$.__b>0?rO($.type,$.props,$.key,$.ref?$.ref:null,$.__v):$)!=null){if($.__=n,$.__b=n.__b+1,(F=ie[P])===null||F&&$.key==F.key&&$.type===F.type)ie[P]=void 0;else for(z=0;z<we;z++){if((F=ie[z])&&$.key==F.key&&$.type===F.type){ie[z]=void 0;break}F=null}SL(t,$,F=F||JO,c,d,m,s,T,D),J=$.__e,(z=$.ref)&&F.ref!=z&&(te||(te=[]),F.ref&&te.push(F.ref,null,$),te.push(z,$.__c||J,$)),J!=null?(X==null&&(X=J),typeof $.type=="function"&&$.__k===F.__k?$.__d=T=uH($,T,t):T=hH(t,$,F,ie,J,T),typeof n.type=="function"&&(n.__d=T)):T&&F.__e==T&&T.parentNode!=t&&(T=wA(F))}for(n.__e=X,P=we;P--;)ie[P]!=null&&(typeof n.type=="function"&&ie[P].__e!=null&&ie[P].__e==n.__d&&(n.__d=dH(r).nextSibling),mH(ie[P],ie[P]));if(te)for(P=0;P<te.length;P++)pH(te[P],te[++P],te[++P])}function uH(t,e,n){for(var r,c=t.__k,d=0;c&&d<c.length;d++)(r=c[d])&&(r.__=t,e=typeof r.type=="function"?uH(r,e,n):hH(n,r,r,c,r.__e,e));return e}function nI(t,e){return e=e||[],t==null||typeof t=="boolean"||(Array.isArray(t)?t.some(function(n){nI(n,e)}):e.push(t)),e}function hH(t,e,n,r,c,d){var m,s,T;if(e.__d!==void 0)m=e.__d,e.__d=void 0;else if(n==null||c!=d||c.parentNode==null)e:if(d==null||d.parentNode!==t)t.appendChild(c),m=null;else{for(s=d,T=0;(s=s.nextSibling)&&T<r.length;T+=1)if(s==c)break e;t.insertBefore(c,d),m=d}return m!==void 0?m:c.nextSibling}function dH(t){var e,n,r;if(t.type==null||typeof t.type=="string")return t.__e;if(t.__k){for(e=t.__k.length-1;e>=0;e--)if((n=t.__k[e])&&(r=dH(n)))return r}return null}function SL(t,e,n,r,c,d,m,s,T){var D,P,z,F,$,J,X,te,ie,we,Ie,Re,Ne,Xe,be,_e=e.type;if(e.constructor!==void 0)return null;n.__h!=null&&(T=n.__h,s=e.__e=n.__e,e.__h=null,d=[s]),(D=Ui.__b)&&D(e);try{e:if(typeof _e=="function"){if(te=e.props,ie=(D=_e.contextType)&&r[D.__c],we=D?ie?ie.props.value:D.__:r,n.__c?X=(P=e.__c=n.__c).__=P.__E:("prototype"in _e&&_e.prototype.render?e.__c=P=new _e(te,we):(e.__c=P=new Yh(te,we),P.constructor=_e,P.render=Vce),ie&&ie.sub(P),P.props=te,P.state||(P.state={}),P.context=we,P.__n=r,z=P.__d=!0,P.__h=[],P._sb=[]),P.__s==null&&(P.__s=P.state),_e.getDerivedStateFromProps!=null&&(P.__s==P.state&&(P.__s=Lv({},P.__s)),Lv(P.__s,_e.getDerivedStateFromProps(te,P.__s))),F=P.props,$=P.state,P.__v=e,z)_e.getDerivedStateFromProps==null&&P.componentWillMount!=null&&P.componentWillMount(),P.componentDidMount!=null&&P.__h.push(P.componentDidMount);else{if(_e.getDerivedStateFromProps==null&&te!==F&&P.componentWillReceiveProps!=null&&P.componentWillReceiveProps(te,we),!P.__e&&P.shouldComponentUpdate!=null&&P.shouldComponentUpdate(te,P.__s,we)===!1||e.__v===n.__v){for(e.__v!==n.__v&&(P.props=te,P.state=P.__s,P.__d=!1),e.__e=n.__e,e.__k=n.__k,e.__k.forEach(function(Te){Te&&(Te.__=e)}),Ie=0;Ie<P._sb.length;Ie++)P.__h.push(P._sb[Ie]);P._sb=[],P.__h.length&&m.push(P);break e}P.componentWillUpdate!=null&&P.componentWillUpdate(te,P.__s,we),P.componentDidUpdate!=null&&P.__h.push(function(){P.componentDidUpdate(F,$,J)})}if(P.context=we,P.props=te,P.__P=t,Re=Ui.__r,Ne=0,"prototype"in _e&&_e.prototype.render){for(P.state=P.__s,P.__d=!1,Re&&Re(e),D=P.render(P.props,P.state,P.context),Xe=0;Xe<P._sb.length;Xe++)P.__h.push(P._sb[Xe]);P._sb=[]}else do P.__d=!1,Re&&Re(e),D=P.render(P.props,P.state,P.context),P.state=P.__s;while(P.__d&&++Ne<25);P.state=P.__s,P.getChildContext!=null&&(r=Lv(Lv({},r),P.getChildContext())),z||P.getSnapshotBeforeUpdate==null||(J=P.getSnapshotBeforeUpdate(F,$)),be=D!=null&&D.type===ea&&D.key==null?D.props.children:D,cH(t,Array.isArray(be)?be:[be],e,n,r,c,d,m,s,T),P.base=e.__e,e.__h=null,P.__h.length&&m.push(P),X&&(P.__E=P.__=null),P.__e=!1}else d==null&&e.__v===n.__v?(e.__k=n.__k,e.__e=n.__e):e.__e=Fce(n.__e,e,n,r,c,d,m,T);(D=Ui.diffed)&&D(e)}catch(Te){e.__v=null,(T||d!=null)&&(e.__e=s,e.__h=!!T,d[d.indexOf(s)]=null),Ui.__e(Te,e,n)}}function fH(t,e){Ui.__c&&Ui.__c(e,t),t.some(function(n){try{t=n.__h,n.__h=[],t.some(function(r){r.call(n)})}catch(r){Ui.__e(r,n.__v)}})}function Fce(t,e,n,r,c,d,m,s){var T,D,P,z=n.props,F=e.props,$=e.type,J=0;if($==="svg"&&(c=!0),d!=null){for(;J<d.length;J++)if((T=d[J])&&"setAttribute"in T==!!$&&($?T.localName===$:T.nodeType===3)){t=T,d[J]=null;break}}if(t==null){if($===null)return document.createTextNode(F);t=c?document.createElementNS("http://www.w3.org/2000/svg",$):document.createElement($,F.is&&F),d=null,s=!1}if($===null)z===F||s&&t.data===F||(t.data=F);else{if(d=d&&hM.call(t.childNodes),D=(z=n.props||JO).dangerouslySetInnerHTML,P=F.dangerouslySetInnerHTML,!s){if(d!=null)for(z={},J=0;J<t.attributes.length;J++)z[t.attributes[J].name]=t.attributes[J].value;(P||D)&&(P&&(D&&P.__html==D.__html||P.__html===t.innerHTML)||(t.innerHTML=P&&P.__html||""))}if(zce(t,F,z,c,s),P)e.__k=[];else if(J=e.props.children,cH(t,Array.isArray(J)?J:[J],e,n,r,c&&$!=="foreignObject",d,m,d?d[0]:n.__k&&wA(n,0),s),d!=null)for(J=d.length;J--;)d[J]!=null&&aH(d[J]);s||("value"in F&&(J=F.value)!==void 0&&(J!==t.value||$==="progress"&&!J||$==="option"&&J!==z.value)&&eI(t,"value",J,z.value,!1),"checked"in F&&(J=F.checked)!==void 0&&J!==t.checked&&eI(t,"checked",J,z.checked,!1))}return t}function pH(t,e,n){try{typeof t=="function"?t(e):t.current=e}catch(r){Ui.__e(r,n)}}function mH(t,e,n){var r,c;if(Ui.unmount&&Ui.unmount(t),(r=t.ref)&&(r.current&&r.current!==t.__e||pH(r,null,e)),(r=t.__c)!=null){if(r.componentWillUnmount)try{r.componentWillUnmount()}catch(d){Ui.__e(d,e)}r.base=r.__P=null,t.__c=void 0}if(r=t.__k)for(c=0;c<r.length;c++)r[c]&&mH(r[c],e,n||typeof t.type!="function");n||t.__e==null||aH(t.__e),t.__=t.__e=t.__d=void 0}function Vce(t,e,n){return this.constructor(t,n)}function TA(t,e,n){var r,c,d;Ui.__&&Ui.__(t,e),c=(r=!1)?null:e.__k,d=[],SL(e,t=e.__k=on(ea,null,[t]),c||JO,JO,e.ownerSVGElement!==void 0,c?null:e.firstChild?hM.call(e.childNodes):null,d,c?c.__e:e.firstChild,r),fH(d,t)}function Uce(t,e){var n={__c:e="__cC"+sH++,__:t,Consumer:function(r,c){return r.children(c)},Provider:function(r){var c,d;return this.getChildContext||(c=[],(d={})[e]=this,this.getChildContext=function(){return d},this.shouldComponentUpdate=function(m){this.props.value!==m.value&&c.some(function(s){s.__e=!0,_N(s)})},this.sub=function(m){c.push(m);var s=m.componentWillUnmount;m.componentWillUnmount=function(){c.splice(c.indexOf(m),1),s&&s.call(m)}}),r.children}};return n.Provider.__=n.Consumer.contextType=n}hM=oH.slice,Ui={__e:function(t,e,n,r){for(var c,d,m;e=e.__;)if((c=e.__c)&&!c.__)try{if((d=c.constructor)&&d.getDerivedStateFromError!=null&&(c.setState(d.getDerivedStateFromError(t)),m=c.__d),c.componentDidCatch!=null&&(c.componentDidCatch(t,r||{}),m=c.__d),m)return c.__E=c}catch(s){t=s}throw t}},nH=0,iH=function(t){return t!=null&&t.constructor===void 0},lT=!1,Yh.prototype.setState=function(t,e){var n;n=this.__s!=null&&this.__s!==this.state?this.__s:this.__s=Lv({},this.state),typeof t=="function"&&(t=t(Lv({},n),this.props)),t&&Lv(n,t),t!=null&&this.__v&&(e&&this._sb.push(e),_N(this))},Yh.prototype.forceUpdate=function(t){this.__v&&(this.__e=!0,t&&this.__h.push(t),_N(this))},Yh.prototype.render=ea,nx=[],rH=typeof Promise=="function"?Promise.prototype.then.bind(Promise.resolve()):setTimeout,tI.__r=0,sH=0;var zm,GP,VV,gH=[],qP=[],UV=Ui.__b,jV=Ui.__r,HV=Ui.diffed,$V=Ui.__c,GV=Ui.unmount;function jce(){for(var t;t=gH.shift();)if(t.__P&&t.__H)try{t.__H.__h.forEach(sO),t.__H.__h.forEach(yN),t.__H.__h=[]}catch(e){t.__H.__h=[],Ui.__e(e,t.__v)}}Ui.__b=function(t){zm=null,UV&&UV(t)},Ui.__r=function(t){jV&&jV(t);var e=(zm=t.__c).__H;e&&(GP===zm?(e.__h=[],zm.__h=[],e.__.forEach(function(n){n.__N&&(n.__=n.__N),n.__V=qP,n.__N=n.i=void 0})):(e.__h.forEach(sO),e.__h.forEach(yN),e.__h=[])),GP=zm},Ui.diffed=function(t){HV&&HV(t);var e=t.__c;e&&e.__H&&(e.__H.__h.length&&(gH.push(e)!==1&&VV===Ui.requestAnimationFrame||((VV=Ui.requestAnimationFrame)||Hce)(jce)),e.__H.__.forEach(function(n){n.i&&(n.__H=n.i),n.__V!==qP&&(n.__=n.__V),n.i=void 0,n.__V=qP})),GP=zm=null},Ui.__c=function(t,e){e.some(function(n){try{n.__h.forEach(sO),n.__h=n.__h.filter(function(r){return!r.__||yN(r)})}catch(r){e.some(function(c){c.__h&&(c.__h=[])}),e=[],Ui.__e(r,n.__v)}}),$V&&$V(t,e)},Ui.unmount=function(t){GV&&GV(t);var e,n=t.__c;n&&n.__H&&(n.__H.__.forEach(function(r){try{sO(r)}catch(c){e=c}}),n.__H=void 0,e&&Ui.__e(e,n.__v))};var qV=typeof requestAnimationFrame=="function";function Hce(t){var e,n=function(){clearTimeout(r),qV&&cancelAnimationFrame(e),setTimeout(t)},r=setTimeout(n,100);qV&&(e=requestAnimationFrame(n))}function sO(t){var e=zm,n=t.__c;typeof n=="function"&&(t.__c=void 0,n()),zm=e}function yN(t){var e=zm;t.__c=t.__(),zm=e}function $ce(t,e){for(var n in e)t[n]=e[n];return t}function WV(t,e){for(var n in t)if(n!=="__source"&&!(n in e))return!0;for(var r in e)if(r!=="__source"&&t[r]!==e[r])return!0;return!1}function YV(t){this.props=t}(YV.prototype=new Yh).isPureReactComponent=!0,YV.prototype.shouldComponentUpdate=function(t,e){return WV(this.props,t)||WV(this.state,e)};var ZV=Ui.__b;Ui.__b=function(t){t.type&&t.type.__f&&t.ref&&(t.props.ref=t.ref,t.ref=null),ZV&&ZV(t)};var Gce=Ui.__e;Ui.__e=function(t,e,n,r){if(t.then){for(var c,d=e;d=d.__;)if((c=d.__c)&&c.__c)return e.__e==null&&(e.__e=n.__e,e.__k=n.__k),c.__c(t,e)}Gce(t,e,n,r)};var XV=Ui.unmount;function _H(t,e,n){return t&&(t.__c&&t.__c.__H&&(t.__c.__H.__.forEach(function(r){typeof r.__c=="function"&&r.__c()}),t.__c.__H=null),(t=$ce({},t)).__c!=null&&(t.__c.__P===n&&(t.__c.__P=e),t.__c=null),t.__k=t.__k&&t.__k.map(function(r){return _H(r,e,n)})),t}function yH(t,e,n){return t&&(t.__v=null,t.__k=t.__k&&t.__k.map(function(r){return yH(r,e,n)}),t.__c&&t.__c.__P===e&&(t.__e&&n.insertBefore(t.__e,t.__d),t.__c.__e=!0,t.__c.__P=n)),t}function WP(){this.__u=0,this.t=null,this.__b=null}function vH(t){var e=t.__.__c;return e&&e.__a&&e.__a(t)}function ER(){this.u=null,this.o=null}Ui.unmount=function(t){var e=t.__c;e&&e.__R&&e.__R(),e&&t.__h===!0&&(t.type=null),XV&&XV(t)},(WP.prototype=new Yh).__c=function(t,e){var n=e.__c,r=this;r.t==null&&(r.t=[]),r.t.push(n);var c=vH(r.__v),d=!1,m=function(){d||(d=!0,n.__R=null,c?c(s):s())};n.__R=m;var s=function(){if(!--r.__u){if(r.state.__a){var D=r.state.__a;r.__v.__k[0]=yH(D,D.__c.__P,D.__c.__O)}var P;for(r.setState({__a:r.__b=null});P=r.t.pop();)P.forceUpdate()}},T=e.__h===!0;r.__u++||T||r.setState({__a:r.__b=r.__v.__k[0]}),t.then(m,m)},WP.prototype.componentWillUnmount=function(){this.t=[]},WP.prototype.render=function(t,e){if(this.__b){if(this.__v.__k){var n=document.createElement("div"),r=this.__v.__k[0].__c;this.__v.__k[0]=_H(this.__b,n,r.__O=r.__P)}this.__b=null}var c=e.__a&&on(ea,null,t.fallback);return c&&(c.__h=null),[on(ea,null,e.__a?null:t.children),c]};var QV=function(t,e,n){if(++n[1]===n[0]&&t.o.delete(e),t.props.revealOrder&&(t.props.revealOrder[0]!=="t"||!t.o.size))for(n=t.u;n;){for(;n.length>3;)n.pop()();if(n[1]<n[0])break;t.u=n=n[2]}};function qce(t){return this.getChildContext=function(){return t.context},t.children}function Wce(t){var e=this,n=t.i;e.componentWillUnmount=function(){TA(null,e.l),e.l=null,e.i=null},e.i&&e.i!==n&&e.componentWillUnmount(),t.__v?(e.l||(e.i=n,e.l={nodeType:1,parentNode:n,childNodes:[],appendChild:function(r){this.childNodes.push(r),e.i.appendChild(r)},insertBefore:function(r,c){this.childNodes.push(r),e.i.appendChild(r)},removeChild:function(r){this.childNodes.splice(this.childNodes.indexOf(r)>>>1,1),e.i.removeChild(r)}}),TA(on(qce,{context:e.context},t.__v),e.l)):e.l&&e.componentWillUnmount()}function Yce(t,e){var n=on(Wce,{__v:t,i:e});return n.containerInfo=e,n}(ER.prototype=new Yh).__a=function(t){var e=this,n=vH(e.__v),r=e.o.get(t);return r[0]++,function(c){var d=function(){e.props.revealOrder?(r.push(c),QV(e,t,r)):c()};n?n(d):d()}},ER.prototype.render=function(t){this.u=null,this.o=new Map;var e=nI(t.children);t.revealOrder&&t.revealOrder[0]==="b"&&e.reverse();for(var n=e.length;n--;)this.o.set(e[n],this.u=[1,0,this.u]);return t.children},ER.prototype.componentDidUpdate=ER.prototype.componentDidMount=function(){var t=this;this.o.forEach(function(e,n){QV(t,n,e)})};var Zce=typeof Symbol<"u"&&Symbol.for&&Symbol.for("react.element")||60103,Xce=/^(?:accent|alignment|arabic|baseline|cap|clip(?!PathU)|color|dominant|fill|flood|font|glyph(?!R)|horiz|image|letter|lighting|marker(?!H|W|U)|overline|paint|pointer|shape|stop|strikethrough|stroke|text(?!L)|transform|underline|unicode|units|v|vector|vert|word|writing|x(?!C))[A-Z]/,Qce=typeof document<"u",Kce=function(t){return(typeof Symbol<"u"&&typeof Symbol()=="symbol"?/fil|che|rad/i:/fil|che|ra/i).test(t)};Yh.prototype.isReactComponent={},["componentWillMount","componentWillReceiveProps","componentWillUpdate"].forEach(function(t){Object.defineProperty(Yh.prototype,t,{configurable:!0,get:function(){return this["UNSAFE_"+t]},set:function(e){Object.defineProperty(this,t,{configurable:!0,writable:!0,value:e})}})});var KV=Ui.event;function Jce(){}function eue(){return this.cancelBubble}function tue(){return this.defaultPrevented}Ui.event=function(t){return KV&&(t=KV(t)),t.persist=Jce,t.isPropagationStopped=eue,t.isDefaultPrevented=tue,t.nativeEvent=t};var JV={configurable:!0,get:function(){return this.class}},eU=Ui.vnode;Ui.vnode=function(t){var e=t.type,n=t.props,r=n;if(typeof e=="string"){var c=e.indexOf("-")===-1;for(var d in r={},n){var m=n[d];Qce&&d==="children"&&e==="noscript"||d==="value"&&"defaultValue"in n&&m==null||(d==="defaultValue"&&"value"in n&&n.value==null?d="value":d==="download"&&m===!0?m="":/ondoubleclick/i.test(d)?d="ondblclick":/^onchange(textarea|input)/i.test(d+e)&&!Kce(n.type)?d="oninput":/^onfocus$/i.test(d)?d="onfocusin":/^onblur$/i.test(d)?d="onfocusout":/^on(Ani|Tra|Tou|BeforeInp|Compo)/.test(d)?d=d.toLowerCase():c&&Xce.test(d)?d=d.replace(/[A-Z0-9]/g,"-$&").toLowerCase():m===null&&(m=void 0),/^oninput$/i.test(d)&&(d=d.toLowerCase(),r[d]&&(d="oninputCapture")),r[d]=m)}e=="select"&&r.multiple&&Array.isArray(r.value)&&(r.value=nI(n.children).forEach(function(s){s.props.selected=r.value.indexOf(s.props.value)!=-1})),e=="select"&&r.defaultValue!=null&&(r.value=nI(n.children).forEach(function(s){s.props.selected=r.multiple?r.defaultValue.indexOf(s.props.value)!=-1:r.defaultValue==s.props.value})),t.props=r,n.class!=n.className&&(JV.enumerable="className"in n,n.className!=null&&(r.class=n.className),Object.defineProperty(r,"className",JV))}t.$$typeof=Zce,eU&&eU(t)};var tU=Ui.__r;Ui.__r=function(t){tU&&tU(t),t.__c};const bH=[],vN=new Map;function xH(t){bH.push(t),vN.forEach(e=>{TH(e,t)})}function nue(t){t.isConnected&&t.getRootNode&&wH(t.getRootNode())}function wH(t){let e=vN.get(t);if(!e||!e.isConnected){if(e=t.querySelector("style[data-fullcalendar]"),!e){e=document.createElement("style"),e.setAttribute("data-fullcalendar","");const n=rue();n&&(e.nonce=n);const r=t===document?document.head:t,c=t===document?r.querySelector("script,link[rel=stylesheet],link[as=style],style"):r.firstChild;r.insertBefore(e,c)}vN.set(t,e),iue(e)}}function iue(t){for(const e of bH)TH(t,e)}function TH(t,e){const{sheet:n}=t,r=n.cssRules.length;e.split("}").forEach((c,d)=>{c=c.trim(),c&&n.insertRule(c+"}",r+d)})}let YP;function rue(){return YP===void 0&&(YP=sue()),YP}function sue(){const t=document.querySelector('meta[name="csp-nonce"]');if(t&&t.hasAttribute("content"))return t.getAttribute("content");const e=document.querySelector("script[nonce]");return e&&e.nonce||""}typeof document<"u"&&wH(document);var oue=':root{--fc-small-font-size:.85em;--fc-page-bg-color:#fff;--fc-neutral-bg-color:hsla(0,0%,82%,.3);--fc-neutral-text-color:grey;--fc-border-color:#ddd;--fc-button-text-color:#fff;--fc-button-bg-color:#2c3e50;--fc-button-border-color:#2c3e50;--fc-button-hover-bg-color:#1e2b37;--fc-button-hover-border-color:#1a252f;--fc-button-active-bg-color:#1a252f;--fc-button-active-border-color:#151e27;--fc-event-bg-color:#3788d8;--fc-event-border-color:#3788d8;--fc-event-text-color:#fff;--fc-event-selected-overlay-color:rgba(0,0,0,.25);--fc-more-link-bg-color:#d0d0d0;--fc-more-link-text-color:inherit;--fc-event-resizer-thickness:8px;--fc-event-resizer-dot-total-width:8px;--fc-event-resizer-dot-border-width:1px;--fc-non-business-color:hsla(0,0%,84%,.3);--fc-bg-event-color:#8fdf82;--fc-bg-event-opacity:0.3;--fc-highlight-color:rgba(188,232,241,.3);--fc-today-bg-color:rgba(255,220,40,.15);--fc-now-indicator-color:red}.fc-not-allowed,.fc-not-allowed .fc-event{cursor:not-allowed}.fc{display:flex;flex-direction:column;font-size:1em}.fc,.fc *,.fc :after,.fc :before{box-sizing:border-box}.fc table{border-collapse:collapse;border-spacing:0;font-size:1em}.fc th{text-align:center}.fc td,.fc th{padding:0;vertical-align:top}.fc a[data-navlink]{cursor:pointer}.fc a[data-navlink]:hover{text-decoration:underline}.fc-direction-ltr{direction:ltr;text-align:left}.fc-direction-rtl{direction:rtl;text-align:right}.fc-theme-standard td,.fc-theme-standard th{border:1px solid var(--fc-border-color)}.fc-liquid-hack td,.fc-liquid-hack th{position:relative}@font-face{font-family:fcicons;font-style:normal;font-weight:400;src:url("data:application/x-font-ttf;charset=utf-8;base64,AAEAAAALAIAAAwAwT1MvMg8SBfAAAAC8AAAAYGNtYXAXVtKNAAABHAAAAFRnYXNwAAAAEAAAAXAAAAAIZ2x5ZgYydxIAAAF4AAAFNGhlYWQUJ7cIAAAGrAAAADZoaGVhB20DzAAABuQAAAAkaG10eCIABhQAAAcIAAAALGxvY2ED4AU6AAAHNAAAABhtYXhwAA8AjAAAB0wAAAAgbmFtZXsr690AAAdsAAABhnBvc3QAAwAAAAAI9AAAACAAAwPAAZAABQAAApkCzAAAAI8CmQLMAAAB6wAzAQkAAAAAAAAAAAAAAAAAAAABEAAAAAAAAAAAAAAAAAAAAABAAADpBgPA/8AAQAPAAEAAAAABAAAAAAAAAAAAAAAgAAAAAAADAAAAAwAAABwAAQADAAAAHAADAAEAAAAcAAQAOAAAAAoACAACAAIAAQAg6Qb//f//AAAAAAAg6QD//f//AAH/4xcEAAMAAQAAAAAAAAAAAAAAAQAB//8ADwABAAAAAAAAAAAAAgAANzkBAAAAAAEAAAAAAAAAAAACAAA3OQEAAAAAAQAAAAAAAAAAAAIAADc5AQAAAAABAWIAjQKeAskAEwAAJSc3NjQnJiIHAQYUFwEWMjc2NCcCnuLiDQ0MJAz/AA0NAQAMJAwNDcni4gwjDQwM/wANIwz/AA0NDCMNAAAAAQFiAI0CngLJABMAACUBNjQnASYiBwYUHwEHBhQXFjI3AZ4BAA0N/wAMJAwNDeLiDQ0MJAyNAQAMIw0BAAwMDSMM4uINIwwNDQAAAAIA4gC3Ax4CngATACcAACUnNzY0JyYiDwEGFB8BFjI3NjQnISc3NjQnJiIPAQYUHwEWMjc2NCcB87e3DQ0MIw3VDQ3VDSMMDQ0BK7e3DQ0MJAzVDQ3VDCQMDQ3zuLcMJAwNDdUNIwzWDAwNIwy4twwkDA0N1Q0jDNYMDA0jDAAAAgDiALcDHgKeABMAJwAAJTc2NC8BJiIHBhQfAQcGFBcWMjchNzY0LwEmIgcGFB8BBwYUFxYyNwJJ1Q0N1Q0jDA0Nt7cNDQwjDf7V1Q0N1QwkDA0Nt7cNDQwkDLfWDCMN1Q0NDCQMt7gMIw0MDNYMIw3VDQ0MJAy3uAwjDQwMAAADAFUAAAOrA1UAMwBoAHcAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMhMjY1NCYjISIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAAVYRGRkR/qoRGRkRA1UFBAUOCQkVDAsZDf2rDRkLDBUJCA4FBQUFBQUOCQgVDAsZDQJVDRkLDBUJCQ4FBAVVAgECBQMCBwQECAX9qwQJAwQHAwMFAQICAgIBBQMDBwQDCQQCVQUIBAQHAgMFAgEC/oAZEhEZGRESGQAAAAADAFUAAAOrA1UAMwBoAIkAABMiBgcOAQcOAQcOARURFBYXHgEXHgEXHgEzITI2Nz4BNz4BNz4BNRE0JicuAScuAScuASMFITIWFx4BFx4BFx4BFREUBgcOAQcOAQcOASMhIiYnLgEnLgEnLgE1ETQ2Nz4BNz4BNz4BMxMzFRQWMzI2PQEzMjY1NCYrATU0JiMiBh0BIyIGFRQWM9UNGAwLFQkJDgUFBQUFBQ4JCRULDBgNAlYNGAwLFQkJDgUFBQUFBQ4JCRULDBgN/aoCVgQIBAQHAwMFAQIBAQIBBQMDBwQECAT9qgQIBAQHAwMFAQIBAQIBBQMDBwQECASAgBkSEhmAERkZEYAZEhIZgBEZGREDVQUEBQ4JCRUMCxkN/asNGQsMFQkIDgUFBQUFBQ4JCBUMCxkNAlUNGQsMFQkJDgUEBVUCAQIFAwIHBAQIBf2rBAkDBAcDAwUBAgICAgEFAwMHBAMJBAJVBQgEBAcCAwUCAQL+gIASGRkSgBkSERmAEhkZEoAZERIZAAABAOIAjQMeAskAIAAAExcHBhQXFjI/ARcWMjc2NC8BNzY0JyYiDwEnJiIHBhQX4uLiDQ0MJAzi4gwkDA0N4uINDQwkDOLiDCQMDQ0CjeLiDSMMDQ3h4Q0NDCMN4uIMIw0MDOLiDAwNIwwAAAABAAAAAQAAa5n0y18PPPUACwQAAAAAANivOVsAAAAA2K85WwAAAAADqwNVAAAACAACAAAAAAAAAAEAAAPA/8AAAAQAAAAAAAOrAAEAAAAAAAAAAAAAAAAAAAALBAAAAAAAAAAAAAAAAgAAAAQAAWIEAAFiBAAA4gQAAOIEAABVBAAAVQQAAOIAAAAAAAoAFAAeAEQAagCqAOoBngJkApoAAQAAAAsAigADAAAAAAACAAAAAAAAAAAAAAAAAAAAAAAAAA4ArgABAAAAAAABAAcAAAABAAAAAAACAAcAYAABAAAAAAADAAcANgABAAAAAAAEAAcAdQABAAAAAAAFAAsAFQABAAAAAAAGAAcASwABAAAAAAAKABoAigADAAEECQABAA4ABwADAAEECQACAA4AZwADAAEECQADAA4APQADAAEECQAEAA4AfAADAAEECQAFABYAIAADAAEECQAGAA4AUgADAAEECQAKADQApGZjaWNvbnMAZgBjAGkAYwBvAG4Ac1ZlcnNpb24gMS4wAFYAZQByAHMAaQBvAG4AIAAxAC4AMGZjaWNvbnMAZgBjAGkAYwBvAG4Ac2ZjaWNvbnMAZgBjAGkAYwBvAG4Ac1JlZ3VsYXIAUgBlAGcAdQBsAGEAcmZjaWNvbnMAZgBjAGkAYwBvAG4Ac0ZvbnQgZ2VuZXJhdGVkIGJ5IEljb01vb24uAEYAbwBuAHQAIABnAGUAbgBlAHIAYQB0AGUAZAAgAGIAeQAgAEkAYwBvAE0AbwBvAG4ALgAAAAMAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAAA=") format("truetype")}.fc-icon{speak:none;-webkit-font-smoothing:antialiased;-moz-osx-font-smoothing:grayscale;display:inline-block;font-family:fcicons!important;font-style:normal;font-variant:normal;font-weight:400;height:1em;line-height:1;text-align:center;text-transform:none;-webkit-user-select:none;-moz-user-select:none;user-select:none;width:1em}.fc-icon-chevron-left:before{content:"\\e900"}.fc-icon-chevron-right:before{content:"\\e901"}.fc-icon-chevrons-left:before{content:"\\e902"}.fc-icon-chevrons-right:before{content:"\\e903"}.fc-icon-minus-square:before{content:"\\e904"}.fc-icon-plus-square:before{content:"\\e905"}.fc-icon-x:before{content:"\\e906"}.fc .fc-button{border-radius:0;font-family:inherit;font-size:inherit;line-height:inherit;margin:0;overflow:visible;text-transform:none}.fc .fc-button:focus{outline:1px dotted;outline:5px auto -webkit-focus-ring-color}.fc .fc-button{-webkit-appearance:button}.fc .fc-button:not(:disabled){cursor:pointer}.fc .fc-button{background-color:transparent;border:1px solid transparent;border-radius:.25em;display:inline-block;font-size:1em;font-weight:400;line-height:1.5;padding:.4em .65em;text-align:center;-webkit-user-select:none;-moz-user-select:none;user-select:none;vertical-align:middle}.fc .fc-button:hover{text-decoration:none}.fc .fc-button:focus{box-shadow:0 0 0 .2rem rgba(44,62,80,.25);outline:0}.fc .fc-button:disabled{opacity:.65}.fc .fc-button-primary{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:hover{background-color:var(--fc-button-hover-bg-color);border-color:var(--fc-button-hover-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:disabled{background-color:var(--fc-button-bg-color);border-color:var(--fc-button-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button-primary:not(:disabled).fc-button-active,.fc .fc-button-primary:not(:disabled):active{background-color:var(--fc-button-active-bg-color);border-color:var(--fc-button-active-border-color);color:var(--fc-button-text-color)}.fc .fc-button-primary:not(:disabled).fc-button-active:focus,.fc .fc-button-primary:not(:disabled):active:focus{box-shadow:0 0 0 .2rem rgba(76,91,106,.5)}.fc .fc-button .fc-icon{font-size:1.5em;vertical-align:middle}.fc .fc-button-group{display:inline-flex;position:relative;vertical-align:middle}.fc .fc-button-group>.fc-button{flex:1 1 auto;position:relative}.fc .fc-button-group>.fc-button.fc-button-active,.fc .fc-button-group>.fc-button:active,.fc .fc-button-group>.fc-button:focus,.fc .fc-button-group>.fc-button:hover{z-index:1}.fc-direction-ltr .fc-button-group>.fc-button:not(:first-child){border-bottom-left-radius:0;border-top-left-radius:0;margin-left:-1px}.fc-direction-ltr .fc-button-group>.fc-button:not(:last-child){border-bottom-right-radius:0;border-top-right-radius:0}.fc-direction-rtl .fc-button-group>.fc-button:not(:first-child){border-bottom-right-radius:0;border-top-right-radius:0;margin-right:-1px}.fc-direction-rtl .fc-button-group>.fc-button:not(:last-child){border-bottom-left-radius:0;border-top-left-radius:0}.fc .fc-toolbar{align-items:center;display:flex;justify-content:space-between}.fc .fc-toolbar.fc-header-toolbar{margin-bottom:1.5em}.fc .fc-toolbar.fc-footer-toolbar{margin-top:1.5em}.fc .fc-toolbar-title{font-size:1.75em;margin:0}.fc-direction-ltr .fc-toolbar>*>:not(:first-child){margin-left:.75em}.fc-direction-rtl .fc-toolbar>*>:not(:first-child){margin-right:.75em}.fc-direction-rtl .fc-toolbar-ltr{flex-direction:row-reverse}.fc .fc-scroller{-webkit-overflow-scrolling:touch;position:relative}.fc .fc-scroller-liquid{height:100%}.fc .fc-scroller-liquid-absolute{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-scroller-harness{direction:ltr;overflow:hidden;position:relative}.fc .fc-scroller-harness-liquid{height:100%}.fc-direction-rtl .fc-scroller-harness>.fc-scroller{direction:rtl}.fc-theme-standard .fc-scrollgrid{border:1px solid var(--fc-border-color)}.fc .fc-scrollgrid,.fc .fc-scrollgrid table{table-layout:fixed;width:100%}.fc .fc-scrollgrid table{border-left-style:hidden;border-right-style:hidden;border-top-style:hidden}.fc .fc-scrollgrid{border-bottom-width:0;border-collapse:separate;border-right-width:0}.fc .fc-scrollgrid-liquid{height:100%}.fc .fc-scrollgrid-section,.fc .fc-scrollgrid-section table,.fc .fc-scrollgrid-section>td{height:1px}.fc .fc-scrollgrid-section-liquid>td{height:100%}.fc .fc-scrollgrid-section>*{border-left-width:0;border-top-width:0}.fc .fc-scrollgrid-section-footer>*,.fc .fc-scrollgrid-section-header>*{border-bottom-width:0}.fc .fc-scrollgrid-section-body table,.fc .fc-scrollgrid-section-footer table{border-bottom-style:hidden}.fc .fc-scrollgrid-section-sticky>*{background:var(--fc-page-bg-color);position:sticky;z-index:3}.fc .fc-scrollgrid-section-header.fc-scrollgrid-section-sticky>*{top:0}.fc .fc-scrollgrid-section-footer.fc-scrollgrid-section-sticky>*{bottom:0}.fc .fc-scrollgrid-sticky-shim{height:1px;margin-bottom:-1px}.fc-sticky{position:sticky}.fc .fc-view-harness{flex-grow:1;position:relative}.fc .fc-view-harness-active>.fc-view{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-col-header-cell-cushion{display:inline-block;padding:2px 4px}.fc .fc-bg-event,.fc .fc-highlight,.fc .fc-non-business{bottom:0;left:0;position:absolute;right:0;top:0}.fc .fc-non-business{background:var(--fc-non-business-color)}.fc .fc-bg-event{background:var(--fc-bg-event-color);opacity:var(--fc-bg-event-opacity)}.fc .fc-bg-event .fc-event-title{font-size:var(--fc-small-font-size);font-style:italic;margin:.5em}.fc .fc-highlight{background:var(--fc-highlight-color)}.fc .fc-cell-shaded,.fc .fc-day-disabled{background:var(--fc-neutral-bg-color)}a.fc-event,a.fc-event:hover{text-decoration:none}.fc-event.fc-event-draggable,.fc-event[href]{cursor:pointer}.fc-event .fc-event-main{position:relative;z-index:2}.fc-event-dragging:not(.fc-event-selected){opacity:.75}.fc-event-dragging.fc-event-selected{box-shadow:0 2px 7px rgba(0,0,0,.3)}.fc-event .fc-event-resizer{display:none;position:absolute;z-index:4}.fc-event-selected .fc-event-resizer,.fc-event:hover .fc-event-resizer{display:block}.fc-event-selected .fc-event-resizer{background:var(--fc-page-bg-color);border-color:inherit;border-radius:calc(var(--fc-event-resizer-dot-total-width)/2);border-style:solid;border-width:var(--fc-event-resizer-dot-border-width);height:var(--fc-event-resizer-dot-total-width);width:var(--fc-event-resizer-dot-total-width)}.fc-event-selected .fc-event-resizer:before{bottom:-20px;content:"";left:-20px;position:absolute;right:-20px;top:-20px}.fc-event-selected,.fc-event:focus{box-shadow:0 2px 5px rgba(0,0,0,.2)}.fc-event-selected:before,.fc-event:focus:before{bottom:0;content:"";left:0;position:absolute;right:0;top:0;z-index:3}.fc-event-selected:after,.fc-event:focus:after{background:var(--fc-event-selected-overlay-color);bottom:-1px;content:"";left:-1px;position:absolute;right:-1px;top:-1px;z-index:1}.fc-h-event{background-color:var(--fc-event-bg-color);border:1px solid var(--fc-event-border-color);display:block}.fc-h-event .fc-event-main{color:var(--fc-event-text-color)}.fc-h-event .fc-event-main-frame{display:flex}.fc-h-event .fc-event-time{max-width:100%;overflow:hidden}.fc-h-event .fc-event-title-container{flex-grow:1;flex-shrink:1;min-width:0}.fc-h-event .fc-event-title{display:inline-block;left:0;max-width:100%;overflow:hidden;right:0;vertical-align:top}.fc-h-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-start),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-end){border-bottom-left-radius:0;border-left-width:0;border-top-left-radius:0}.fc-direction-ltr .fc-daygrid-block-event:not(.fc-event-end),.fc-direction-rtl .fc-daygrid-block-event:not(.fc-event-start){border-bottom-right-radius:0;border-right-width:0;border-top-right-radius:0}.fc-h-event:not(.fc-event-selected) .fc-event-resizer{bottom:0;top:0;width:var(--fc-event-resizer-thickness)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end{cursor:w-resize;left:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-direction-ltr .fc-h-event:not(.fc-event-selected) .fc-event-resizer-end,.fc-direction-rtl .fc-h-event:not(.fc-event-selected) .fc-event-resizer-start{cursor:e-resize;right:calc(var(--fc-event-resizer-thickness)*-.5)}.fc-h-event.fc-event-selected .fc-event-resizer{margin-top:calc(var(--fc-event-resizer-dot-total-width)*-.5);top:50%}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-start,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-end{left:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc-direction-ltr .fc-h-event.fc-event-selected .fc-event-resizer-end,.fc-direction-rtl .fc-h-event.fc-event-selected .fc-event-resizer-start{right:calc(var(--fc-event-resizer-dot-total-width)*-.5)}.fc .fc-popover{box-shadow:0 2px 6px rgba(0,0,0,.15);position:absolute;z-index:9999}.fc .fc-popover-header{align-items:center;display:flex;flex-direction:row;justify-content:space-between;padding:3px 4px}.fc .fc-popover-title{margin:0 2px}.fc .fc-popover-close{cursor:pointer;font-size:1.1em;opacity:.65}.fc-theme-standard .fc-popover{background:var(--fc-page-bg-color);border:1px solid var(--fc-border-color)}.fc-theme-standard .fc-popover-header{background:var(--fc-neutral-bg-color)}';xH(oue);class AL{constructor(e){this.drainedOption=e,this.isRunning=!1,this.isDirty=!1,this.pauseDepths={},this.timeoutId=0}request(e){this.isDirty=!0,this.isPaused()||(this.clearTimeout(),e==null?this.tryDrain():this.timeoutId=setTimeout(this.tryDrain.bind(this),e))}pause(e=""){let{pauseDepths:n}=this;n[e]=(n[e]||0)+1,this.clearTimeout()}resume(e="",n){let{pauseDepths:r}=this;e in r&&(n?delete r[e]:(r[e]-=1,r[e]<=0&&delete r[e]),this.tryDrain())}isPaused(){return Object.keys(this.pauseDepths).length}tryDrain(){if(!this.isRunning&&!this.isPaused()){for(this.isRunning=!0;this.isDirty;)this.isDirty=!1,this.drained();this.isRunning=!1}}clear(){this.clearTimeout(),this.isDirty=!1,this.pauseDepths={}}clearTimeout(){this.timeoutId&&(clearTimeout(this.timeoutId),this.timeoutId=0)}drained(){this.drainedOption&&this.drainedOption()}}function CL(t){t.parentNode&&t.parentNode.removeChild(t)}function zc(t,e){if(t.closest)return t.closest(e);if(!document.documentElement.contains(t))return null;do{if(aue(t,e))return t;t=t.parentElement||t.parentNode}while(t!==null&&t.nodeType===1);return null}function aue(t,e){return(t.matches||t.matchesSelector||t.msMatchesSelector).call(t,e)}function lue(t,e){let n=t instanceof HTMLElement?[t]:t,r=[];for(let c=0;c<n.length;c+=1){let d=n[c].querySelectorAll(e);for(let m=0;m<d.length;m+=1)r.push(d[m])}return r}const cue=/(top|left|right|bottom|width|height)$/i;function ZS(t,e){for(let n in e)EH(t,n,e[n])}function EH(t,e,n){n==null?t.style[e]="":typeof n=="number"&&cue.test(e)?t.style[e]=`${n}px`:t.style[e]=n}function SH(t){var e,n;return(n=(e=t.composedPath)===null||e===void 0?void 0:e.call(t)[0])!==null&&n!==void 0?n:t.target}let nU=0;function dM(){return nU+=1,"fc-dom-"+nU}function fM(t){t.preventDefault()}function uue(t,e){return n=>{let r=zc(n.target,t);r&&e.call(r,n,r)}}function AH(t,e,n,r){let c=uue(n,r);return t.addEventListener(e,c),()=>{t.removeEventListener(e,c)}}function hue(t,e,n,r){let c;return AH(t,"mouseover",e,(d,m)=>{if(m!==c){c=m,n(d,m);let s=T=>{c=null,r(T,m),m.removeEventListener("mouseleave",s)};m.addEventListener("mouseleave",s)}})}const iU=["webkitTransitionEnd","otransitionend","oTransitionEnd","msTransitionEnd","transitionend"];function due(t,e){let n=r=>{e(r),iU.forEach(c=>{t.removeEventListener(c,n)})};iU.forEach(r=>{t.addEventListener(r,n)})}function CH(t){return Object.assign({onClick:t},DH(t))}function DH(t){return{tabIndex:0,onKeyDown(e){(e.key==="Enter"||e.key===" ")&&(t(e),e.preventDefault())}}}let rU=0;function Px(){return rU+=1,String(rU)}function DL(){document.body.classList.add("fc-not-allowed")}function RL(){document.body.classList.remove("fc-not-allowed")}function fue(t){t.style.userSelect="none",t.style.webkitUserSelect="none",t.addEventListener("selectstart",fM)}function pue(t){t.style.userSelect="",t.style.webkitUserSelect="",t.removeEventListener("selectstart",fM)}function mue(t){t.addEventListener("contextmenu",fM)}function gue(t){t.removeEventListener("contextmenu",fM)}function _ue(t){let e=[],n=[],r,c;for(typeof t=="string"?n=t.split(/\s*,\s*/):typeof t=="function"?n=[t]:Array.isArray(t)&&(n=t),r=0;r<n.length;r+=1)c=n[r],typeof c=="string"?e.push(c.charAt(0)==="-"?{field:c.substring(1),order:-1}:{field:c,order:1}):typeof c=="function"&&e.push({func:c});return e}function yue(t,e,n){let r,c;for(r=0;r<n.length;r+=1)if(c=vue(t,e,n[r]),c)return c;return 0}function vue(t,e,n){return n.func?n.func(t,e):bue(t[n.field],e[n.field])*(n.order||1)}function bue(t,e){return!t&&!e?0:e==null?-1:t==null?1:typeof t=="string"||typeof e=="string"?String(t).localeCompare(String(e)):t-e}function ZP(t,e){let n=String(t);return"000".substr(0,e-n.length)+n}function XS(t,e,n){return typeof t=="function"?t(...e):typeof t=="string"?e.reduce((r,c,d)=>r.replace("$"+d,c||""),t):n}function xue(t,e){return t-e}function XP(t){return t%1===0}function wue(t){let e=t.querySelector(".fc-scrollgrid-shrink-frame"),n=t.querySelector(".fc-scrollgrid-shrink-cushion");if(!e)throw new Error("needs fc-scrollgrid-shrink-frame className");if(!n)throw new Error("needs fc-scrollgrid-shrink-cushion className");return t.getBoundingClientRect().width-e.getBoundingClientRect().width+n.getBoundingClientRect().width}const Tue=/^(-?)(?:(\d+)\.)?(\d+):(\d\d)(?::(\d\d)(?:\.(\d\d\d))?)?/;function Rs(t,e){return typeof t=="string"?Eue(t):typeof t=="object"&&t?sU(t):typeof t=="number"?sU({[e||"milliseconds"]:t}):null}function Eue(t){let e=Tue.exec(t);if(e){let n=e[1]?-1:1;return{years:0,months:0,days:n*(e[2]?parseInt(e[2],10):0),milliseconds:n*((e[3]?parseInt(e[3],10):0)*60*60*1e3+(e[4]?parseInt(e[4],10):0)*60*1e3+(e[5]?parseInt(e[5],10):0)*1e3+(e[6]?parseInt(e[6],10):0))}}return null}function sU(t){let e={years:t.years||t.year||0,months:t.months||t.month||0,days:t.days||t.day||0,milliseconds:(t.hours||t.hour||0)*60*60*1e3+(t.minutes||t.minute||0)*60*1e3+(t.seconds||t.second||0)*1e3+(t.milliseconds||t.millisecond||t.ms||0)},n=t.weeks||t.week;return n&&(e.days+=n*7,e.specifiedWeeks=!0),e}function Sue(t,e){return t.years===e.years&&t.months===e.months&&t.days===e.days&&t.milliseconds===e.milliseconds}function Aue(t,e){return{years:t.years-e.years,months:t.months-e.months,days:t.days-e.days,milliseconds:t.milliseconds-e.milliseconds}}function Cue(t){return Uw(t)/365}function Due(t){return Uw(t)/30}function Uw(t){return EA(t)/864e5}function EA(t){return t.years*(365*864e5)+t.months*(30*864e5)+t.days*864e5+t.milliseconds}function bN(t){let e=t.milliseconds;if(e){if(e%1e3!==0)return{unit:"millisecond",value:e};if(e%(1e3*60)!==0)return{unit:"second",value:e/1e3};if(e%(1e3*60*60)!==0)return{unit:"minute",value:e/(1e3*60)};if(e)return{unit:"hour",value:e/(1e3*60*60)}}return t.days?t.specifiedWeeks&&t.days%7===0?{unit:"week",value:t.days/7}:{unit:"day",value:t.days}:t.months?{unit:"month",value:t.months}:t.years?{unit:"year",value:t.years}:{unit:"millisecond",value:0}}function r0(t,e,n){if(t===e)return!0;let r=t.length,c;if(r!==e.length)return!1;for(c=0;c<r;c+=1)if(!(n?n(t[c],e[c]):t[c]===e[c]))return!1;return!0}const Rue=["sun","mon","tue","wed","thu","fri","sat"];function oU(t,e){let n=zv(t);return n[2]+=e*7,Gu(n)}function Uc(t,e){let n=zv(t);return n[2]+=e,Gu(n)}function s0(t,e){let n=zv(t);return n[6]+=e,Gu(n)}function Oue(t,e){return AT(t,e)/7}function AT(t,e){return(e.valueOf()-t.valueOf())/(1e3*60*60*24)}function Iue(t,e){return(e.valueOf()-t.valueOf())/(1e3*60*60)}function Mue(t,e){return(e.valueOf()-t.valueOf())/(1e3*60)}function Pue(t,e){return(e.valueOf()-t.valueOf())/1e3}function kue(t,e){let n=Oo(t),r=Oo(e);return{years:0,months:0,days:Math.round(AT(n,r)),milliseconds:e.valueOf()-r.valueOf()-(t.valueOf()-n.valueOf())}}function Nue(t,e){let n=iI(t,e);return n!==null&&n%7===0?n/7:null}function iI(t,e){return Bv(t)===Bv(e)?Math.round(AT(t,e)):null}function Oo(t){return Gu([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate()])}function Lue(t){return Gu([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours()])}function zue(t){return Gu([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes()])}function Bue(t){return Gu([t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds()])}function Fue(t,e,n){let r=t.getUTCFullYear(),c=QP(t,r,e,n);if(c<1)return QP(t,r-1,e,n);let d=QP(t,r+1,e,n);return d>=1?Math.min(c,d):c}function QP(t,e,n,r){let c=Gu([e,0,1+Vue(e,n,r)]),d=Oo(t),m=Math.round(AT(c,d));return Math.floor(m/7)+1}function Vue(t,e,n){let r=7+e-n;return-((7+Gu([t,0,r]).getUTCDay()-e)%7)+r-1}function aU(t){return[t.getFullYear(),t.getMonth(),t.getDate(),t.getHours(),t.getMinutes(),t.getSeconds(),t.getMilliseconds()]}function lU(t){return new Date(t[0],t[1]||0,t[2]==null?1:t[2],t[3]||0,t[4]||0,t[5]||0)}function zv(t){return[t.getUTCFullYear(),t.getUTCMonth(),t.getUTCDate(),t.getUTCHours(),t.getUTCMinutes(),t.getUTCSeconds(),t.getUTCMilliseconds()]}function Gu(t){return t.length===1&&(t=t.concat([0])),new Date(Date.UTC(...t))}function RH(t){return!isNaN(t.valueOf())}function Bv(t){return t.getUTCHours()*1e3*60*60+t.getUTCMinutes()*1e3*60+t.getUTCSeconds()*1e3+t.getUTCMilliseconds()}function Uue(t,e,n=!1){let r=t.toISOString();return r=r.replace(".000",""),n&&(r=r.replace("T00:00:00Z","")),r.length>10&&(e==null?r=r.replace("Z",""):e!==0&&(r=r.replace("Z",IL(e,!0)))),r}function OL(t){return t.toISOString().replace(/T.*$/,"")}function jue(t){return t.toISOString().match(/^\d{4}-\d{2}/)[0]}function IL(t,e=!1){let n=t<0?"-":"+",r=Math.abs(t),c=Math.floor(r/60),d=Math.round(r%60);return e?`${n+ZP(c,2)}:${ZP(d,2)}`:`GMT${n}${c}${d?`:${ZP(d,2)}`:""}`}function Os(t,e,n){let r,c;return function(...d){if(!r)c=t.apply(this,d);else if(!r0(r,d)){let m=t.apply(this,d);(!e||!e(m,c))&&(c=m)}return r=d,c}}function oO(t,e,n){let r,c;return d=>(r?Ym(r,d)||(c=t.call(this,d)):c=t.call(this,d),r=d,c)}const KP={week:3,separator:9,omitZeroMinute:9,meridiem:9,omitCommas:9},rI={timeZoneName:7,era:6,year:5,month:4,day:2,weekday:2,hour:1,minute:1,second:1},SR=/\s*([ap])\.?m\.?/i,Hue=/,/g,$ue=/\s+/g,Gue=/\u200e/g,que=/UTC|GMT/;class Wue{constructor(e){let n={},r={},c=9;for(let d in e)d in KP?(r[d]=e[d],KP[d]<9&&(c=Math.min(KP[d],c))):(n[d]=e[d],d in rI&&(c=Math.min(rI[d],c)));this.standardDateProps=n,this.extendedSettings=r,this.smallestUnitNum=c,this.buildFormattingFunc=Os(cU)}format(e,n){return this.buildFormattingFunc(this.standardDateProps,this.extendedSettings,n)(e)}formatRange(e,n,r,c){let{standardDateProps:d,extendedSettings:m}=this,s=Jue(e.marker,n.marker,r.calendarSystem);if(!s)return this.format(e,r);let T=s;T>1&&(d.year==="numeric"||d.year==="2-digit")&&(d.month==="numeric"||d.month==="2-digit")&&(d.day==="numeric"||d.day==="2-digit")&&(T=1);let D=this.format(e,r),P=this.format(n,r);if(D===P)return D;let z=ehe(d,T),F=cU(z,m,r),$=F(e),J=F(n),X=the(D,$,P,J),te=m.separator||c||r.defaultSeparator||"";return X?X.before+$+te+J+X.after:D+te+P}getSmallestUnit(){switch(this.smallestUnitNum){case 7:case 6:case 5:return"year";case 4:return"month";case 3:return"week";case 2:return"day";default:return"time"}}}function cU(t,e,n){let r=Object.keys(t).length;return r===1&&t.timeZoneName==="short"?c=>IL(c.timeZoneOffset):r===0&&e.week?c=>Kue(n.computeWeekNumber(c.marker),n.weekText,n.weekTextLong,n.locale,e.week):Yue(t,e,n)}function Yue(t,e,n){t=Object.assign({},t),e=Object.assign({},e),Zue(t,e),t.timeZone="UTC";let r=new Intl.DateTimeFormat(n.locale.codes,t),c;if(e.omitZeroMinute){let d=Object.assign({},t);delete d.minute,c=new Intl.DateTimeFormat(n.locale.codes,d)}return d=>{let{marker:m}=d,s;c&&!m.getUTCMinutes()?s=c:s=r;let T=s.format(m);return Xue(T,d,t,e,n)}}function Zue(t,e){t.timeZoneName&&(t.hour||(t.hour="2-digit"),t.minute||(t.minute="2-digit")),t.timeZoneName==="long"&&(t.timeZoneName="short"),e.omitZeroMinute&&(t.second||t.millisecond)&&delete e.omitZeroMinute}function Xue(t,e,n,r,c){return t=t.replace(Gue,""),n.timeZoneName==="short"&&(t=Que(t,c.timeZone==="UTC"||e.timeZoneOffset==null?"UTC":IL(e.timeZoneOffset))),r.omitCommas&&(t=t.replace(Hue,"").trim()),r.omitZeroMinute&&(t=t.replace(":00","")),r.meridiem===!1?t=t.replace(SR,"").trim():r.meridiem==="narrow"?t=t.replace(SR,(d,m)=>m.toLocaleLowerCase()):r.meridiem==="short"?t=t.replace(SR,(d,m)=>`${m.toLocaleLowerCase()}m`):r.meridiem==="lowercase"&&(t=t.replace(SR,d=>d.toLocaleLowerCase())),t=t.replace($ue," "),t=t.trim(),t}function Que(t,e){let n=!1;return t=t.replace(que,()=>(n=!0,e)),n||(t+=` ${e}`),t}function Kue(t,e,n,r,c){let d=[];return c==="long"?d.push(n):(c==="short"||c==="narrow")&&d.push(e),(c==="long"||c==="short")&&d.push(" "),d.push(r.simpleNumberFormat.format(t)),r.options.direction==="rtl"&&d.reverse(),d.join("")}function Jue(t,e,n){return n.getMarkerYear(t)!==n.getMarkerYear(e)?5:n.getMarkerMonth(t)!==n.getMarkerMonth(e)?4:n.getMarkerDay(t)!==n.getMarkerDay(e)?2:Bv(t)!==Bv(e)?1:0}function ehe(t,e){let n={};for(let r in t)(!(r in rI)||rI[r]<=e)&&(n[r]=t[r]);return n}function the(t,e,n,r){let c=0;for(;c<t.length;){let d=t.indexOf(e,c);if(d===-1)break;let m=t.substr(0,d);c=d+e.length;let s=t.substr(c),T=0;for(;T<n.length;){let D=n.indexOf(r,T);if(D===-1)break;let P=n.substr(0,D);T=D+r.length;let z=n.substr(T);if(m===P&&s===z)return{before:m,after:s}}}return null}function uU(t,e){let n=e.markerToArray(t.marker);return{marker:t.marker,timeZoneOffset:t.timeZoneOffset,array:n,year:n[0],month:n[1],day:n[2],hour:n[3],minute:n[4],second:n[5],millisecond:n[6]}}function sI(t,e,n,r){let c=uU(t,n.calendarSystem),d=e?uU(e,n.calendarSystem):null;return{date:c,start:c,end:d,timeZone:n.timeZone,localeCodes:n.locale.codes,defaultSeparator:r||n.defaultSeparator}}class nhe{constructor(e){this.cmdStr=e}format(e,n,r){return n.cmdFormatter(this.cmdStr,sI(e,null,n,r))}formatRange(e,n,r,c){return r.cmdFormatter(this.cmdStr,sI(e,n,r,c))}}class ihe{constructor(e){this.func=e}format(e,n,r){return this.func(sI(e,null,n,r))}formatRange(e,n,r,c){return this.func(sI(e,n,r,c))}}function Cl(t){return typeof t=="object"&&t?new Wue(t):typeof t=="string"?new nhe(t):typeof t=="function"?new ihe(t):null}const hU={navLinkDayClick:nn,navLinkWeekClick:nn,duration:Rs,bootstrapFontAwesome:nn,buttonIcons:nn,customButtons:nn,defaultAllDayEventDuration:Rs,defaultTimedEventDuration:Rs,nextDayThreshold:Rs,scrollTime:Rs,scrollTimeReset:Boolean,slotMinTime:Rs,slotMaxTime:Rs,dayPopoverFormat:Cl,slotDuration:Rs,snapDuration:Rs,headerToolbar:nn,footerToolbar:nn,defaultRangeSeparator:String,titleRangeSeparator:String,forceEventDuration:Boolean,dayHeaders:Boolean,dayHeaderFormat:Cl,dayHeaderClassNames:nn,dayHeaderContent:nn,dayHeaderDidMount:nn,dayHeaderWillUnmount:nn,dayCellClassNames:nn,dayCellContent:nn,dayCellDidMount:nn,dayCellWillUnmount:nn,initialView:String,aspectRatio:Number,weekends:Boolean,weekNumberCalculation:nn,weekNumbers:Boolean,weekNumberClassNames:nn,weekNumberContent:nn,weekNumberDidMount:nn,weekNumberWillUnmount:nn,editable:Boolean,viewClassNames:nn,viewDidMount:nn,viewWillUnmount:nn,nowIndicator:Boolean,nowIndicatorClassNames:nn,nowIndicatorContent:nn,nowIndicatorDidMount:nn,nowIndicatorWillUnmount:nn,showNonCurrentDates:Boolean,lazyFetching:Boolean,startParam:String,endParam:String,timeZoneParam:String,timeZone:String,locales:nn,locale:nn,themeSystem:String,dragRevertDuration:Number,dragScroll:Boolean,allDayMaintainDuration:Boolean,unselectAuto:Boolean,dropAccept:nn,eventOrder:_ue,eventOrderStrict:Boolean,handleWindowResize:Boolean,windowResizeDelay:Number,longPressDelay:Number,eventDragMinDistance:Number,expandRows:Boolean,height:nn,contentHeight:nn,direction:String,weekNumberFormat:Cl,eventResizableFromStart:Boolean,displayEventTime:Boolean,displayEventEnd:Boolean,weekText:String,weekTextLong:String,progressiveEventRendering:Boolean,businessHours:nn,initialDate:nn,now:nn,eventDataTransform:nn,stickyHeaderDates:nn,stickyFooterScrollbar:nn,viewHeight:nn,defaultAllDay:Boolean,eventSourceFailure:nn,eventSourceSuccess:nn,eventDisplay:String,eventStartEditable:Boolean,eventDurationEditable:Boolean,eventOverlap:nn,eventConstraint:nn,eventAllow:nn,eventBackgroundColor:String,eventBorderColor:String,eventTextColor:String,eventColor:String,eventClassNames:nn,eventContent:nn,eventDidMount:nn,eventWillUnmount:nn,selectConstraint:nn,selectOverlap:nn,selectAllow:nn,droppable:Boolean,unselectCancel:String,slotLabelFormat:nn,slotLaneClassNames:nn,slotLaneContent:nn,slotLaneDidMount:nn,slotLaneWillUnmount:nn,slotLabelClassNames:nn,slotLabelContent:nn,slotLabelDidMount:nn,slotLabelWillUnmount:nn,dayMaxEvents:nn,dayMaxEventRows:nn,dayMinWidth:Number,slotLabelInterval:Rs,allDayText:String,allDayClassNames:nn,allDayContent:nn,allDayDidMount:nn,allDayWillUnmount:nn,slotMinWidth:Number,navLinks:Boolean,eventTimeFormat:Cl,rerenderDelay:Number,moreLinkText:nn,moreLinkHint:nn,selectMinDistance:Number,selectable:Boolean,selectLongPressDelay:Number,eventLongPressDelay:Number,selectMirror:Boolean,eventMaxStack:Number,eventMinHeight:Number,eventMinWidth:Number,eventShortHeight:Number,slotEventOverlap:Boolean,plugins:nn,firstDay:Number,dayCount:Number,dateAlignment:String,dateIncrement:Rs,hiddenDays:nn,fixedWeekCount:Boolean,validRange:nn,visibleRange:nn,titleFormat:nn,eventInteractive:Boolean,noEventsText:String,viewHint:nn,navLinkHint:nn,closeHint:String,timeHint:String,eventHint:String,moreLinkClick:nn,moreLinkClassNames:nn,moreLinkContent:nn,moreLinkDidMount:nn,moreLinkWillUnmount:nn,monthStartFormat:Cl,handleCustomRendering:nn,customRenderingMetaMap:nn,customRenderingReplaces:Boolean},QS={eventDisplay:"auto",defaultRangeSeparator:" - ",titleRangeSeparator:" – ",defaultTimedEventDuration:"01:00:00",defaultAllDayEventDuration:{day:1},forceEventDuration:!1,nextDayThreshold:"00:00:00",dayHeaders:!0,initialView:"",aspectRatio:1.35,headerToolbar:{start:"title",center:"",end:"today prev,next"},weekends:!0,weekNumbers:!1,weekNumberCalculation:"local",editable:!1,nowIndicator:!1,scrollTime:"06:00:00",scrollTimeReset:!0,slotMinTime:"00:00:00",slotMaxTime:"24:00:00",showNonCurrentDates:!0,lazyFetching:!0,startParam:"start",endParam:"end",timeZoneParam:"timeZone",timeZone:"local",locales:[],locale:"",themeSystem:"standard",dragRevertDuration:500,dragScroll:!0,allDayMaintainDuration:!1,unselectAuto:!0,dropAccept:"*",eventOrder:"start,-duration,allDay,title",dayPopoverFormat:{month:"long",day:"numeric",year:"numeric"},handleWindowResize:!0,windowResizeDelay:100,longPressDelay:1e3,eventDragMinDistance:5,expandRows:!1,navLinks:!1,selectable:!1,eventMinHeight:15,eventMinWidth:30,eventShortHeight:30,monthStartFormat:{month:"long",day:"numeric"}},dU={datesSet:nn,eventsSet:nn,eventAdd:nn,eventChange:nn,eventRemove:nn,windowResize:nn,eventClick:nn,eventMouseEnter:nn,eventMouseLeave:nn,select:nn,unselect:nn,loading:nn,_unmount:nn,_beforeprint:nn,_afterprint:nn,_noEventDrop:nn,_noEventResize:nn,_resize:nn,_scrollRequest:nn},fU={buttonText:nn,buttonHints:nn,views:nn,plugins:nn,initialEvents:nn,events:nn,eventSources:nn},ex={headerToolbar:tx,footerToolbar:tx,buttonText:tx,buttonHints:tx,buttonIcons:tx,dateIncrement:tx,plugins:AR,events:AR,eventSources:AR,resources:AR};function tx(t,e){return typeof t=="object"&&typeof e=="object"&&t&&e?Ym(t,e):t===e}function AR(t,e){return Array.isArray(t)&&Array.isArray(e)?r0(t,e):t===e}const rhe={type:String,component:nn,buttonText:String,buttonTextKey:String,dateProfileGeneratorClass:nn,usesMinMaxTime:Boolean,classNames:nn,content:nn,didMount:nn,willUnmount:nn};function JP(t){return PL(t,ex)}function ML(t,e){let n={},r={};for(let c in e)c in t&&(n[c]=e[c](t[c]));for(let c in t)c in e||(r[c]=t[c]);return{refined:n,extra:r}}function nn(t){return t}const{hasOwnProperty:oI}=Object.prototype;function PL(t,e){let n={};if(e){for(let r in e)if(e[r]===tx){let c=[];for(let d=t.length-1;d>=0;d-=1){let m=t[d][r];if(typeof m=="object"&&m)c.unshift(m);else if(m!==void 0){n[r]=m;break}}c.length&&(n[r]=PL(c))}}for(let r=t.length-1;r>=0;r-=1){let c=t[r];for(let d in c)d in n||(n[d]=c[d])}return n}function Sx(t,e){let n={};for(let r in t)e(t[r],r)&&(n[r]=t[r]);return n}function kx(t,e){let n={};for(let r in t)n[r]=e(t[r],r);return n}function OH(t){let e={};for(let n of t)e[n]=!0;return e}function kL(t){let e=[];for(let n in t)e.push(t[n]);return e}function Ym(t,e){if(t===e)return!0;for(let n in t)if(oI.call(t,n)&&!(n in e))return!1;for(let n in e)if(oI.call(e,n)&&t[n]!==e[n])return!1;return!0}const she=/^on[A-Z]/;function ohe(t,e){const n=xN(t,e);for(let r of n)if(!she.test(r))return!1;return!0}function xN(t,e){let n=[];for(let r in t)oI.call(t,r)&&(r in e||n.push(r));for(let r in e)oI.call(e,r)&&t[r]!==e[r]&&n.push(r);return n}function ek(t,e,n={}){if(t===e)return!0;for(let r in e)if(!(r in t&&ahe(t[r],e[r],n[r])))return!1;for(let r in t)if(!(r in e))return!1;return!0}function ahe(t,e,n){return t===e||n===!0?!0:n?n(t,e):!1}function lhe(t,e=0,n,r=1){let c=[];n==null&&(n=Object.keys(t).length);for(let d=e;d<n;d+=r){let m=t[d];m!==void 0&&c.push(m)}return c}let IH={};function che(t,e){IH[t]=e}function uhe(t){return new IH[t]}class hhe{getMarkerYear(e){return e.getUTCFullYear()}getMarkerMonth(e){return e.getUTCMonth()}getMarkerDay(e){return e.getUTCDate()}arrayToMarker(e){return Gu(e)}markerToArray(e){return zv(e)}}che("gregory",hhe);const dhe=/^\s*(\d{4})(-?(\d{2})(-?(\d{2})([T ](\d{2}):?(\d{2})(:?(\d{2})(\.(\d+))?)?(Z|(([-+])(\d{2})(:?(\d{2}))?))?)?)?)?$/;function fhe(t){let e=dhe.exec(t);if(e){let n=new Date(Date.UTC(Number(e[1]),e[3]?Number(e[3])-1:0,Number(e[5]||1),Number(e[7]||0),Number(e[8]||0),Number(e[10]||0),e[12]?+`0.${e[12]}`*1e3:0));if(RH(n)){let r=null;return e[13]&&(r=(e[15]==="-"?-1:1)*(Number(e[16]||0)*60+Number(e[18]||0))),{marker:n,isTimeUnspecified:!e[6],timeZoneOffset:r}}}return null}class phe{constructor(e){let n=this.timeZone=e.timeZone,r=n!=="local"&&n!=="UTC";e.namedTimeZoneImpl&&r&&(this.namedTimeZoneImpl=new e.namedTimeZoneImpl(n)),this.canComputeOffset=!!(!r||this.namedTimeZoneImpl),this.calendarSystem=uhe(e.calendarSystem),this.locale=e.locale,this.weekDow=e.locale.week.dow,this.weekDoy=e.locale.week.doy,e.weekNumberCalculation==="ISO"&&(this.weekDow=1,this.weekDoy=4),typeof e.firstDay=="number"&&(this.weekDow=e.firstDay),typeof e.weekNumberCalculation=="function"&&(this.weekNumberFunc=e.weekNumberCalculation),this.weekText=e.weekText!=null?e.weekText:e.locale.options.weekText,this.weekTextLong=(e.weekTextLong!=null?e.weekTextLong:e.locale.options.weekTextLong)||this.weekText,this.cmdFormatter=e.cmdFormatter,this.defaultSeparator=e.defaultSeparator}createMarker(e){let n=this.createMarkerMeta(e);return n===null?null:n.marker}createNowMarker(){return this.canComputeOffset?this.timestampToMarker(new Date().valueOf()):Gu(aU(new Date))}createMarkerMeta(e){if(typeof e=="string")return this.parse(e);let n=null;return typeof e=="number"?n=this.timestampToMarker(e):e instanceof Date?(e=e.valueOf(),isNaN(e)||(n=this.timestampToMarker(e))):Array.isArray(e)&&(n=Gu(e)),n===null||!RH(n)?null:{marker:n,isTimeUnspecified:!1,forcedTzo:null}}parse(e){let n=fhe(e);if(n===null)return null;let{marker:r}=n,c=null;return n.timeZoneOffset!==null&&(this.canComputeOffset?r=this.timestampToMarker(r.valueOf()-n.timeZoneOffset*60*1e3):c=n.timeZoneOffset),{marker:r,isTimeUnspecified:n.isTimeUnspecified,forcedTzo:c}}getYear(e){return this.calendarSystem.getMarkerYear(e)}getMonth(e){return this.calendarSystem.getMarkerMonth(e)}getDay(e){return this.calendarSystem.getMarkerDay(e)}add(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]+=n.years,r[1]+=n.months,r[2]+=n.days,r[6]+=n.milliseconds,this.calendarSystem.arrayToMarker(r)}subtract(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]-=n.years,r[1]-=n.months,r[2]-=n.days,r[6]-=n.milliseconds,this.calendarSystem.arrayToMarker(r)}addYears(e,n){let r=this.calendarSystem.markerToArray(e);return r[0]+=n,this.calendarSystem.arrayToMarker(r)}addMonths(e,n){let r=this.calendarSystem.markerToArray(e);return r[1]+=n,this.calendarSystem.arrayToMarker(r)}diffWholeYears(e,n){let{calendarSystem:r}=this;return Bv(e)===Bv(n)&&r.getMarkerDay(e)===r.getMarkerDay(n)&&r.getMarkerMonth(e)===r.getMarkerMonth(n)?r.getMarkerYear(n)-r.getMarkerYear(e):null}diffWholeMonths(e,n){let{calendarSystem:r}=this;return Bv(e)===Bv(n)&&r.getMarkerDay(e)===r.getMarkerDay(n)?r.getMarkerMonth(n)-r.getMarkerMonth(e)+(r.getMarkerYear(n)-r.getMarkerYear(e))*12:null}greatestWholeUnit(e,n){let r=this.diffWholeYears(e,n);return r!==null?{unit:"year",value:r}:(r=this.diffWholeMonths(e,n),r!==null?{unit:"month",value:r}:(r=Nue(e,n),r!==null?{unit:"week",value:r}:(r=iI(e,n),r!==null?{unit:"day",value:r}:(r=Iue(e,n),XP(r)?{unit:"hour",value:r}:(r=Mue(e,n),XP(r)?{unit:"minute",value:r}:(r=Pue(e,n),XP(r)?{unit:"second",value:r}:{unit:"millisecond",value:n.valueOf()-e.valueOf()}))))))}countDurationsBetween(e,n,r){let c;return r.years&&(c=this.diffWholeYears(e,n),c!==null)?c/Cue(r):r.months&&(c=this.diffWholeMonths(e,n),c!==null)?c/Due(r):r.days&&(c=iI(e,n),c!==null)?c/Uw(r):(n.valueOf()-e.valueOf())/EA(r)}startOf(e,n){return n==="year"?this.startOfYear(e):n==="month"?this.startOfMonth(e):n==="week"?this.startOfWeek(e):n==="day"?Oo(e):n==="hour"?Lue(e):n==="minute"?zue(e):n==="second"?Bue(e):null}startOfYear(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e)])}startOfMonth(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e)])}startOfWeek(e){return this.calendarSystem.arrayToMarker([this.calendarSystem.getMarkerYear(e),this.calendarSystem.getMarkerMonth(e),e.getUTCDate()-(e.getUTCDay()-this.weekDow+7)%7])}computeWeekNumber(e){return this.weekNumberFunc?this.weekNumberFunc(this.toDate(e)):Fue(e,this.weekDow,this.weekDoy)}format(e,n,r={}){return n.format({marker:e,timeZoneOffset:r.forcedTzo!=null?r.forcedTzo:this.offsetForMarker(e)},this)}formatRange(e,n,r,c={}){return c.isEndExclusive&&(n=s0(n,-1)),r.formatRange({marker:e,timeZoneOffset:c.forcedStartTzo!=null?c.forcedStartTzo:this.offsetForMarker(e)},{marker:n,timeZoneOffset:c.forcedEndTzo!=null?c.forcedEndTzo:this.offsetForMarker(n)},this,c.defaultSeparator)}formatIso(e,n={}){let r=null;return n.omitTimeZoneOffset||(n.forcedTzo!=null?r=n.forcedTzo:r=this.offsetForMarker(e)),Uue(e,r,n.omitTime)}timestampToMarker(e){return this.timeZone==="local"?Gu(aU(new Date(e))):this.timeZone==="UTC"||!this.namedTimeZoneImpl?new Date(e):Gu(this.namedTimeZoneImpl.timestampToArray(e))}offsetForMarker(e){return this.timeZone==="local"?-lU(zv(e)).getTimezoneOffset():this.timeZone==="UTC"?0:this.namedTimeZoneImpl?this.namedTimeZoneImpl.offsetForArray(zv(e)):null}toDate(e,n){return this.timeZone==="local"?lU(zv(e)):this.timeZone==="UTC"?new Date(e.valueOf()):this.namedTimeZoneImpl?new Date(e.valueOf()-this.namedTimeZoneImpl.offsetForArray(zv(e))*1e3*60):new Date(e.valueOf()-(n||0))}}class nC{constructor(e){this.iconOverrideOption&&this.setIconOverride(e[this.iconOverrideOption])}setIconOverride(e){let n,r;if(typeof e=="object"&&e){n=Object.assign({},this.iconClasses);for(r in e)n[r]=this.applyIconOverridePrefix(e[r]);this.iconClasses=n}else e===!1&&(this.iconClasses={})}applyIconOverridePrefix(e){let n=this.iconOverridePrefix;return n&&e.indexOf(n)!==0&&(e=n+e),e}getClass(e){return this.classes[e]||""}getIconClass(e,n){let r;return n&&this.rtlIconClasses?r=this.rtlIconClasses[e]||this.iconClasses[e]:r=this.iconClasses[e],r?`${this.baseIconClass} ${r}`:""}getCustomButtonIconClass(e){let n;return this.iconOverrideCustomButtonOption&&(n=e[this.iconOverrideCustomButtonOption],n)?`${this.baseIconClass} ${this.applyIconOverridePrefix(n)}`:""}}nC.prototype.classes={};nC.prototype.iconClasses={};nC.prototype.baseIconClass="";nC.prototype.iconOverridePrefix="";function aI(t){t();let e=Ui.debounceRendering,n=[];function r(c){n.push(c)}for(Ui.debounceRendering=r,TA(on(mhe,{}),document.createElement("div"));n.length;)n.shift()();Ui.debounceRendering=e}class mhe extends Yh{render(){return on("div",{})}componentDidMount(){this.setState({})}}function MH(t){let e=Uce(t),n=e.Provider;return e.Provider=function(){let r=!this.getChildContext,c=n.apply(this,arguments);if(r){let d=[];this.shouldComponentUpdate=m=>{this.props.value!==m.value&&d.forEach(s=>{s.context=m.value,s.forceUpdate()})},this.sub=m=>{d.push(m);let s=m.componentWillUnmount;m.componentWillUnmount=()=>{d.splice(d.indexOf(m),1),s&&s.call(m)}}}return c},e}class ghe{constructor(e,n,r,c){this.execFunc=e,this.emitter=n,this.scrollTime=r,this.scrollTimeReset=c,this.handleScrollRequest=d=>{this.queuedRequest=Object.assign({},this.queuedRequest||{},d),this.drain()},n.on("_scrollRequest",this.handleScrollRequest),this.fireInitialScroll()}detach(){this.emitter.off("_scrollRequest",this.handleScrollRequest)}update(e){e&&this.scrollTimeReset?this.fireInitialScroll():this.drain()}fireInitialScroll(){this.handleScrollRequest({time:this.scrollTime})}drain(){this.queuedRequest&&this.execFunc(this.queuedRequest)&&(this.queuedRequest=null)}}const Nx=MH({});function _he(t,e,n,r,c,d,m,s,T,D,P,z,F,$){return{dateEnv:c,nowManager:d,options:n,pluginHooks:s,emitter:P,dispatch:T,getCurrentData:D,calendarApi:z,viewSpec:t,viewApi:e,dateProfileGenerator:r,theme:m,isRtl:n.direction==="rtl",addResizeHandler(J){P.on("_resize",J)},removeResizeHandler(J){P.off("_resize",J)},createScrollResponder(J){return new ghe(J,P,Rs(n.scrollTime),n.scrollTimeReset)},registerInteractiveComponent:F,unregisterInteractiveComponent:$}}class Lx extends Yh{shouldComponentUpdate(e,n){return this.debug&&console.log(xN(e,this.props),xN(n,this.state)),!ek(this.props,e,this.propEquality)||!ek(this.state,n,this.stateEquality)}safeSetState(e){ek(this.state,Object.assign(Object.assign({},this.state),e),this.stateEquality)||this.setState(e)}}Lx.addPropsEquality=yhe;Lx.addStateEquality=vhe;Lx.contextType=Nx;Lx.prototype.propEquality={};Lx.prototype.stateEquality={};class Vo extends Lx{}Vo.contextType=Nx;function yhe(t){let e=Object.create(this.prototype.propEquality);Object.assign(e,t),this.prototype.propEquality=e}function vhe(t){let e=Object.create(this.prototype.stateEquality);Object.assign(e,t),this.prototype.stateEquality=e}function M_(t,e){typeof t=="function"?t(e):t&&(t.current=e)}class NL extends Vo{constructor(){super(...arguments),this.id=Px(),this.queuedDomNodes=[],this.currentDomNodes=[],this.handleEl=e=>{const{options:n}=this.context,{generatorName:r}=this.props;(!n.customRenderingReplaces||!wN(r,n))&&this.updateElRef(e)},this.updateElRef=e=>{this.props.elRef&&M_(this.props.elRef,e)}}render(){const{props:e,context:n}=this,{options:r}=n,{customGenerator:c,defaultGenerator:d,renderProps:m}=e,s=PH(e,[],this.handleEl);let T=!1,D,P=[],z;if(c!=null){const F=typeof c=="function"?c(m,on):c;if(F===!0)T=!0;else{const $=F&&typeof F=="object";$&&"html"in F?s.dangerouslySetInnerHTML={__html:F.html}:$&&"domNodes"in F?P=Array.prototype.slice.call(F.domNodes):($?iH(F):typeof F!="function")?D=F:z=F}}else T=!wN(e.generatorName,r);return T&&d&&(D=d(m)),this.queuedDomNodes=P,this.currentGeneratorMeta=z,on(e.elTag,s,D)}componentDidMount(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentDidUpdate(){this.applyQueueudDomNodes(),this.triggerCustomRendering(!0)}componentWillUnmount(){this.triggerCustomRendering(!1)}triggerCustomRendering(e){var n;const{props:r,context:c}=this,{handleCustomRendering:d,customRenderingMetaMap:m}=c.options;if(d){const s=(n=this.currentGeneratorMeta)!==null&&n!==void 0?n:m==null?void 0:m[r.generatorName];s&&d(Object.assign(Object.assign({id:this.id,isActive:e,containerEl:this.base,reportNewContainerEl:this.updateElRef,generatorMeta:s},r),{elClasses:(r.elClasses||[]).filter(bhe)}))}}applyQueueudDomNodes(){const{queuedDomNodes:e,currentDomNodes:n}=this,r=this.base;if(!r0(e,n)){n.forEach(CL);for(let c of e)r.appendChild(c);this.currentDomNodes=e}}}NL.addPropsEquality({elClasses:r0,elStyle:Ym,elAttrs:ohe,renderProps:Ym});function wN(t,e){var n;return!!(e.handleCustomRendering&&t&&(!((n=e.customRenderingMetaMap)===null||n===void 0)&&n[t]))}function PH(t,e,n){const r=Object.assign(Object.assign({},t.elAttrs),{ref:n});return(t.elClasses||e)&&(r.className=(t.elClasses||[]).concat(e||[]).concat(r.className||[]).filter(Boolean).join(" ")),t.elStyle&&(r.style=t.elStyle),r}function bhe(t){return!!t}const kH=MH(0);class z_ extends Yh{constructor(){super(...arguments),this.InnerContent=xhe.bind(void 0,this),this.handleEl=e=>{this.el=e,this.props.elRef&&(M_(this.props.elRef,e),e&&this.didMountMisfire&&this.componentDidMount())}}render(){const{props:e}=this,n=whe(e.classNameGenerator,e.renderProps);if(e.children){const r=PH(e,n,this.handleEl),c=e.children(this.InnerContent,e.renderProps,r);return e.elTag?on(e.elTag,r,c):c}else return on(NL,Object.assign(Object.assign({},e),{elRef:this.handleEl,elTag:e.elTag||"div",elClasses:(e.elClasses||[]).concat(n),renderId:this.context}))}componentDidMount(){var e,n;this.el?(n=(e=this.props).didMount)===null||n===void 0||n.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el})):this.didMountMisfire=!0}componentWillUnmount(){var e,n;(n=(e=this.props).willUnmount)===null||n===void 0||n.call(e,Object.assign(Object.assign({},this.props.renderProps),{el:this.el}))}}z_.contextType=kH;function xhe(t,e){const n=t.props;return on(NL,Object.assign({renderProps:n.renderProps,generatorName:n.generatorName,customGenerator:n.customGenerator,defaultGenerator:n.defaultGenerator,renderId:t.context},e))}function whe(t,e){const n=typeof t=="function"?t(e):t||[];return typeof n=="string"?[n]:n}class pU extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,c={view:n.viewApi};return on(z_,Object.assign({},e,{elTag:e.elTag||"div",elClasses:[...NH(e.viewSpec),...e.elClasses||[]],renderProps:c,classNameGenerator:r.viewClassNames,generatorName:void 0,didMount:r.viewDidMount,willUnmount:r.viewWillUnmount}),()=>e.children)}}function NH(t){return[`fc-${t.type}-view`,"fc-view"]}function The(t,e){let n=null,r=null;return t.start&&(n=e.createMarker(t.start)),t.end&&(r=e.createMarker(t.end)),!n&&!r||n&&r&&r<n?null:{start:n,end:r}}function mU(t,e){let n=[],{start:r}=e,c,d;for(t.sort(Ehe),c=0;c<t.length;c+=1)d=t[c],d.start>r&&n.push({start:r,end:d.start}),d.end>r&&(r=d.end);return r<e.end&&n.push({start:r,end:e.end}),n}function Ehe(t,e){return t.start.valueOf()-e.start.valueOf()}function cT(t,e){let{start:n,end:r}=t,c=null;return e.start!==null&&(n===null?n=e.start:n=new Date(Math.max(n.valueOf(),e.start.valueOf()))),e.end!=null&&(r===null?r=e.end:r=new Date(Math.min(r.valueOf(),e.end.valueOf()))),(n===null||r===null||n<r)&&(c={start:n,end:r}),c}function She(t,e){return(t.start===null?null:t.start.valueOf())===(e.start===null?null:e.start.valueOf())&&(t.end===null?null:t.end.valueOf())===(e.end===null?null:e.end.valueOf())}function LL(t,e){return(t.end===null||e.start===null||t.end>e.start)&&(t.start===null||e.end===null||t.start<e.end)}function pM(t,e){return(t.start===null||e.start!==null&&e.start>=t.start)&&(t.end===null||e.end!==null&&e.end<=t.end)}function Yv(t,e){return(t.start===null||e>=t.start)&&(t.end===null||e<t.end)}function Ahe(t,e){return e.start!=null&&t<e.start?e.start:e.end!=null&&t>=e.end?new Date(e.end.valueOf()-1):t}function LH(t){let e=Math.floor(AT(t.start,t.end))||1,n=Oo(t.start),r=Uc(n,e);return{start:n,end:r}}function zH(t,e=Rs(0)){let n=null,r=null;if(t.end){r=Oo(t.end);let c=t.end.valueOf()-r.valueOf();c&&c>=EA(e)&&(r=Uc(r,1))}return t.start&&(n=Oo(t.start),r&&r<=n&&(r=Uc(n,1))),{start:n,end:r}}function Ow(t,e,n,r){return r==="year"?Rs(n.diffWholeYears(t,e),"year"):r==="month"?Rs(n.diffWholeMonths(t,e),"month"):kue(t,e)}class BH{constructor(e){this.props=e,this.initHiddenDays()}buildPrev(e,n,r){let{dateEnv:c}=this.props,d=c.subtract(c.startOf(n,e.currentRangeUnit),e.dateIncrement);return this.build(d,-1,r)}buildNext(e,n,r){let{dateEnv:c}=this.props,d=c.add(c.startOf(n,e.currentRangeUnit),e.dateIncrement);return this.build(d,1,r)}build(e,n,r=!0){let{props:c}=this,d,m,s,T,D,P;return d=this.buildValidRange(),d=this.trimHiddenDays(d),r&&(e=Ahe(e,d)),m=this.buildCurrentRangeInfo(e,n),s=/^(year|month|week|day)$/.test(m.unit),T=this.buildRenderRange(this.trimHiddenDays(m.range),m.unit,s),T=this.trimHiddenDays(T),D=T,c.showNonCurrentDates||(D=cT(D,m.range)),D=this.adjustActiveRange(D),D=cT(D,d),P=LL(m.range,d),Yv(T,e)||(e=T.start),{currentDate:e,validRange:d,currentRange:m.range,currentRangeUnit:m.unit,isRangeAllDay:s,activeRange:D,renderRange:T,slotMinTime:c.slotMinTime,slotMaxTime:c.slotMaxTime,isValid:P,dateIncrement:this.buildDateIncrement(m.duration)}}buildValidRange(){let e=this.props.validRangeInput,n=typeof e=="function"?e.call(this.props.calendarApi,this.props.dateEnv.toDate(this.props.nowManager.getDateMarker())):e;return this.refineRange(n)||{start:null,end:null}}buildCurrentRangeInfo(e,n){let{props:r}=this,c=null,d=null,m=null,s;return r.duration?(c=r.duration,d=r.durationUnit,m=this.buildRangeFromDuration(e,n,c,d)):(s=this.props.dayCount)?(d="day",m=this.buildRangeFromDayCount(e,n,s)):(m=this.buildCustomVisibleRange(e))?d=r.dateEnv.greatestWholeUnit(m.start,m.end).unit:(c=this.getFallbackDuration(),d=bN(c).unit,m=this.buildRangeFromDuration(e,n,c,d)),{duration:c,unit:d,range:m}}getFallbackDuration(){return Rs({day:1})}adjustActiveRange(e){let{dateEnv:n,usesMinMaxTime:r,slotMinTime:c,slotMaxTime:d}=this.props,{start:m,end:s}=e;return r&&(Uw(c)<0&&(m=Oo(m),m=n.add(m,c)),Uw(d)>1&&(s=Oo(s),s=Uc(s,-1),s=n.add(s,d))),{start:m,end:s}}buildRangeFromDuration(e,n,r,c){let{dateEnv:d,dateAlignment:m}=this.props,s,T,D;if(!m){let{dateIncrement:z}=this.props;z&&EA(z)<EA(r)?m=bN(z).unit:m=c}Uw(r)<=1&&this.isHiddenDay(s)&&(s=this.skipHiddenDays(s,n),s=Oo(s));function P(){s=d.startOf(e,m),T=d.add(s,r),D={start:s,end:T}}return P(),this.trimHiddenDays(D)||(e=this.skipHiddenDays(e,n),P()),D}buildRangeFromDayCount(e,n,r){let{dateEnv:c,dateAlignment:d}=this.props,m=0,s=e,T;d&&(s=c.startOf(s,d)),s=Oo(s),s=this.skipHiddenDays(s,n),T=s;do T=Uc(T,1),this.isHiddenDay(T)||(m+=1);while(m<r);return{start:s,end:T}}buildCustomVisibleRange(e){let{props:n}=this,r=n.visibleRangeInput,c=typeof r=="function"?r.call(n.calendarApi,n.dateEnv.toDate(e)):r,d=this.refineRange(c);return d&&(d.start==null||d.end==null)?null:d}buildRenderRange(e,n,r){return e}buildDateIncrement(e){let{dateIncrement:n}=this.props,r;return n||((r=this.props.dateAlignment)?Rs(1,r):e||Rs({days:1}))}refineRange(e){if(e){let n=The(e,this.props.dateEnv);return n&&(n=zH(n)),n}return null}initHiddenDays(){let e=this.props.hiddenDays||[],n=[],r=0,c;for(this.props.weekends===!1&&e.push(0,6),c=0;c<7;c+=1)(n[c]=e.indexOf(c)!==-1)||(r+=1);if(!r)throw new Error("invalid hiddenDays");this.isHiddenDayHash=n}trimHiddenDays(e){let{start:n,end:r}=e;return n&&(n=this.skipHiddenDays(n)),r&&(r=this.skipHiddenDays(r,-1,!0)),n==null||r==null||n<r?{start:n,end:r}:null}isHiddenDay(e){return e instanceof Date&&(e=e.getUTCDay()),this.isHiddenDayHash[e]}skipHiddenDays(e,n=1,r=!1){for(;this.isHiddenDayHash[(e.getUTCDay()+(r?n:0)+7)%7];)e=Uc(e,n);return e}}function zL(t,e,n,r){return{instanceId:Px(),defId:t,range:e,forcedStartTzo:n??null,forcedEndTzo:r??null}}function Che(t,e,n,r){for(let c=0;c<r.length;c+=1){let d=r[c].parse(t,n);if(d){let{allDay:m}=t;return m==null&&(m=e,m==null&&(m=d.allDayGuess,m==null&&(m=!1))),{allDay:m,duration:d.duration,typeData:d.typeData,typeId:c}}}return null}function Ax(t,e,n){let{dateEnv:r,pluginHooks:c,options:d}=n,{defs:m,instances:s}=t;s=Sx(s,T=>!m[T.defId].recurringDef);for(let T in m){let D=m[T];if(D.recurringDef){let{duration:P}=D.recurringDef;P||(P=D.allDay?d.defaultAllDayEventDuration:d.defaultTimedEventDuration);let z=Dhe(D,P,e,r,c.recurringTypes);for(let F of z){let $=zL(T,{start:F,end:r.add(F,P)});s[$.instanceId]=$}}}return{defs:m,instances:s}}function Dhe(t,e,n,r,c){let m=c[t.recurringDef.typeId].expand(t.recurringDef.typeData,{start:r.subtract(n.start,e),end:n.end},r);return t.allDay&&(m=m.map(Oo)),m}const aO={id:String,groupId:String,title:String,url:String,interactive:Boolean},FH={start:nn,end:nn,date:nn,allDay:Boolean},Rhe=Object.assign(Object.assign(Object.assign({},aO),FH),{extendedProps:nn});function VH(t,e,n,r,c=BL(n),d,m){let{refined:s,extra:T}=UH(t,n,c),D=Ihe(e,n),P=Che(s,D,n.dateEnv,n.pluginHooks.recurringTypes);if(P){let F=TN(s,T,e?e.sourceId:"",P.allDay,!!P.duration,n,d);return F.recurringDef={typeId:P.typeId,typeData:P.typeData,duration:P.duration},{def:F,instance:null}}let z=Ohe(s,D,n,r);if(z){let F=TN(s,T,e?e.sourceId:"",z.allDay,z.hasEnd,n,d),$=zL(F.defId,z.range,z.forcedStartTzo,z.forcedEndTzo);return m&&F.publicId&&m[F.publicId]&&($.instanceId=m[F.publicId]),{def:F,instance:$}}return null}function UH(t,e,n=BL(e)){return ML(t,n)}function BL(t){return Object.assign(Object.assign(Object.assign({},lI),Rhe),t.pluginHooks.eventRefiners)}function TN(t,e,n,r,c,d,m){let s={title:t.title||"",groupId:t.groupId||"",publicId:t.id||"",url:t.url||"",recurringDef:null,defId:(m&&t.id?m[t.id]:"")||Px(),sourceId:n,allDay:r,hasEnd:c,interactive:t.interactive,ui:cI(t,d),extendedProps:Object.assign(Object.assign({},t.extendedProps||{}),e)};for(let T of d.pluginHooks.eventDefMemberAdders)Object.assign(s,T(t));return Object.freeze(s.ui.classNames),Object.freeze(s.extendedProps),s}function Ohe(t,e,n,r){let{allDay:c}=t,d,m=null,s=!1,T,D=null,P=t.start!=null?t.start:t.date;if(d=n.dateEnv.createMarkerMeta(P),d)m=d.marker;else if(!r)return null;return t.end!=null&&(T=n.dateEnv.createMarkerMeta(t.end)),c==null&&(e!=null?c=e:c=(!d||d.isTimeUnspecified)&&(!T||T.isTimeUnspecified)),c&&m&&(m=Oo(m)),T&&(D=T.marker,c&&(D=Oo(D)),m&&D<=m&&(D=null)),D?s=!0:r||(s=n.options.forceEventDuration||!1,D=n.dateEnv.add(m,c?n.options.defaultAllDayEventDuration:n.options.defaultTimedEventDuration)),{allDay:c,hasEnd:s,range:{start:m,end:D},forcedStartTzo:d?d.forcedTzo:null,forcedEndTzo:T?T.forcedTzo:null}}function Ihe(t,e){let n=null;return t&&(n=t.defaultAllDay),n==null&&(n=e.options.defaultAllDay),n}function SA(t,e,n,r,c,d){let m=gp(),s=BL(n);for(let T of t){let D=VH(T,e,n,r,s,c,d);D&&EN(D,m)}return m}function EN(t,e=gp()){return e.defs[t.def.defId]=t.def,t.instance&&(e.instances[t.instance.instanceId]=t.instance),e}function FL(t,e){let n=t.instances[e];if(n){let r=t.defs[n.defId],c=mM(t,d=>Mhe(r,d));return c.defs[r.defId]=r,c.instances[n.instanceId]=n,c}return gp()}function Mhe(t,e){return!!(t.groupId&&t.groupId===e.groupId)}function gp(){return{defs:{},instances:{}}}function VL(t,e){return{defs:Object.assign(Object.assign({},t.defs),e.defs),instances:Object.assign(Object.assign({},t.instances),e.instances)}}function mM(t,e){let n=Sx(t.defs,e),r=Sx(t.instances,c=>n[c.defId]);return{defs:n,instances:r}}function Phe(t,e){let{defs:n,instances:r}=t,c={},d={};for(let m in n)e.defs[m]||(c[m]=n[m]);for(let m in r)!e.instances[m]&&c[r[m].defId]&&(d[m]=r[m]);return{defs:c,instances:d}}function khe(t,e){return Array.isArray(t)?SA(t,null,e,!0):typeof t=="object"&&t?SA([t],null,e,!0):t!=null?String(t):null}function gU(t){return Array.isArray(t)?t:typeof t=="string"?t.split(/\s+/):[]}const lI={display:String,editable:Boolean,startEditable:Boolean,durationEditable:Boolean,constraint:nn,overlap:nn,allow:nn,className:gU,classNames:gU,color:String,backgroundColor:String,borderColor:String,textColor:String},Nhe={display:null,startEditable:null,durationEditable:null,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]};function cI(t,e){let n=khe(t.constraint,e);return{display:t.display||null,startEditable:t.startEditable!=null?t.startEditable:t.editable,durationEditable:t.durationEditable!=null?t.durationEditable:t.editable,constraints:n!=null?[n]:[],overlap:t.overlap!=null?t.overlap:null,allows:t.allow!=null?[t.allow]:[],backgroundColor:t.backgroundColor||t.color||"",borderColor:t.borderColor||t.color||"",textColor:t.textColor||"",classNames:(t.className||[]).concat(t.classNames||[])}}function Lhe(t){return t.reduce(zhe,Nhe)}function zhe(t,e){return{display:e.display!=null?e.display:t.display,startEditable:e.startEditable!=null?e.startEditable:t.startEditable,durationEditable:e.durationEditable!=null?e.durationEditable:t.durationEditable,constraints:t.constraints.concat(e.constraints),overlap:typeof e.overlap=="boolean"?e.overlap:t.overlap,allows:t.allows.concat(e.allows),backgroundColor:e.backgroundColor||t.backgroundColor,borderColor:e.borderColor||t.borderColor,textColor:e.textColor||t.textColor,classNames:t.classNames.concat(e.classNames)}}const Bhe={id:String,defaultAllDay:Boolean,url:String,format:String,events:nn,eventDataTransform:nn,success:nn,failure:nn};function jH(t,e,n=HH(e)){let r;if(typeof t=="string"?r={url:t}:typeof t=="function"||Array.isArray(t)?r={events:t}:typeof t=="object"&&t&&(r=t),r){let{refined:c,extra:d}=ML(r,n),m=Fhe(c,e);if(m)return{_raw:t,isFetching:!1,latestFetchId:"",fetchRange:null,defaultAllDay:c.defaultAllDay,eventDataTransform:c.eventDataTransform,success:c.success,failure:c.failure,publicId:c.id||"",sourceId:Px(),sourceDefId:m.sourceDefId,meta:m.meta,ui:cI(c,e),extendedProps:d}}return null}function HH(t){return Object.assign(Object.assign(Object.assign({},lI),Bhe),t.pluginHooks.eventSourceRefiners)}function Fhe(t,e){let n=e.pluginHooks.eventSourceDefs;for(let r=n.length-1;r>=0;r-=1){let d=n[r].parseMeta(t);if(d)return{sourceDefId:r,meta:d}}return null}function Vhe(t,e,n,r,c){switch(e.type){case"RECEIVE_EVENTS":return Uhe(t,n[e.sourceId],e.fetchId,e.fetchRange,e.rawEvents,c);case"RESET_RAW_EVENTS":return jhe(t,n[e.sourceId],e.rawEvents,r.activeRange,c);case"ADD_EVENTS":return Hhe(t,e.eventStore,r?r.activeRange:null,c);case"RESET_EVENTS":return e.eventStore;case"MERGE_EVENTS":return VL(t,e.eventStore);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return r?Ax(t,r.activeRange,c):t;case"REMOVE_EVENTS":return Phe(t,e.eventStore);case"REMOVE_EVENT_SOURCE":return GH(t,e.sourceId);case"REMOVE_ALL_EVENT_SOURCES":return mM(t,d=>!d.sourceId);case"REMOVE_ALL_EVENTS":return gp();default:return t}}function Uhe(t,e,n,r,c,d){if(e&&n===e.latestFetchId){let m=SA($H(c,e,d),e,d);return r&&(m=Ax(m,r,d)),VL(GH(t,e.sourceId),m)}return t}function jhe(t,e,n,r,c){const{defIdMap:d,instanceIdMap:m}=Ghe(t);let s=SA($H(n,e,c),e,c,!1,d,m);return Ax(s,r,c)}function $H(t,e,n){let r=n.options.eventDataTransform,c=e?e.eventDataTransform:null;return c&&(t=_U(t,c)),r&&(t=_U(t,r)),t}function _U(t,e){let n;if(!e)n=t;else{n=[];for(let r of t){let c=e(r);c?n.push(c):c==null&&n.push(r)}}return n}function Hhe(t,e,n,r){return n&&(e=Ax(e,n,r)),VL(t,e)}function yU(t,e,n){let{defs:r}=t,c=kx(t.instances,d=>r[d.defId].allDay?d:Object.assign(Object.assign({},d),{range:{start:n.createMarker(e.toDate(d.range.start,d.forcedStartTzo)),end:n.createMarker(e.toDate(d.range.end,d.forcedEndTzo))},forcedStartTzo:n.canComputeOffset?null:d.forcedStartTzo,forcedEndTzo:n.canComputeOffset?null:d.forcedEndTzo}));return{defs:r,instances:c}}function GH(t,e){return mM(t,n=>n.sourceId!==e)}function $he(t,e){return{defs:t.defs,instances:Sx(t.instances,n=>!e[n.instanceId])}}function Ghe(t){const{defs:e,instances:n}=t,r={},c={};for(let d in e){const m=e[d],{publicId:s}=m;s&&(r[s]=d)}for(let d in n){const m=n[d],s=e[m.defId],{publicId:T}=s;T&&(c[T]=d)}return{defIdMap:r,instanceIdMap:c}}class gM{constructor(){this.handlers={},this.thisContext=null}setThisContext(e){this.thisContext=e}setOptions(e){this.options=e}on(e,n){qhe(this.handlers,e,n)}off(e,n){Whe(this.handlers,e,n)}trigger(e,...n){let r=this.handlers[e]||[],c=this.options&&this.options[e],d=[].concat(c||[],r);for(let m of d)m.apply(this.thisContext,n)}hasHandlers(e){return!!(this.handlers[e]&&this.handlers[e].length||this.options&&this.options[e])}}function qhe(t,e,n){(t[e]||(t[e]=[])).push(n)}function Whe(t,e,n){n?t[e]&&(t[e]=t[e].filter(r=>r!==n)):delete t[e]}const Yhe={startTime:"09:00",endTime:"17:00",daysOfWeek:[1,2,3,4,5],display:"inverse-background",classNames:"fc-non-business",groupId:"_businessHours"};function Zhe(t,e){return SA(Xhe(t),null,e)}function Xhe(t){let e;return t===!0?e=[{}]:Array.isArray(t)?e=t.filter(n=>n.daysOfWeek):typeof t=="object"&&t?e=[t]:e=[],e=e.map(n=>Object.assign(Object.assign({},Yhe),n)),e}function qH(t,e,n){n.emitter.trigger("select",Object.assign(Object.assign({},UL(t,n)),{jsEvent:e?e.origEvent:null,view:n.viewApi||n.calendarApi.view}))}function Qhe(t,e){e.emitter.trigger("unselect",{jsEvent:t?t.origEvent:null,view:e.viewApi||e.calendarApi.view})}function UL(t,e){let n={};for(let r of e.pluginHooks.dateSpanTransforms)Object.assign(n,r(t,e));return Object.assign(n,dde(t,e.dateEnv)),n}function vU(t,e,n){let{dateEnv:r,options:c}=n,d=e;return t?(d=Oo(d),d=r.add(d,c.defaultAllDayEventDuration)):d=r.add(d,c.defaultTimedEventDuration),d}function jL(t,e,n,r){let c=uI(t.defs,e),d=gp();for(let m in t.defs){let s=t.defs[m];d.defs[m]=Khe(s,c[m],n,r)}for(let m in t.instances){let s=t.instances[m],T=d.defs[s.defId];d.instances[m]=Jhe(s,T,c[s.defId],n,r)}return d}function Khe(t,e,n,r){let c=n.standardProps||{};c.hasEnd==null&&e.durationEditable&&(n.startDelta||n.endDelta)&&(c.hasEnd=!0);let d=Object.assign(Object.assign(Object.assign({},t),c),{ui:Object.assign(Object.assign({},t.ui),c.ui)});n.extendedProps&&(d.extendedProps=Object.assign(Object.assign({},d.extendedProps),n.extendedProps));for(let m of r.pluginHooks.eventDefMutationAppliers)m(d,n,r);return!d.hasEnd&&r.options.forceEventDuration&&(d.hasEnd=!0),d}function Jhe(t,e,n,r,c){let{dateEnv:d}=c,m=r.standardProps&&r.standardProps.allDay===!0,s=r.standardProps&&r.standardProps.hasEnd===!1,T=Object.assign({},t);return m&&(T.range=LH(T.range)),r.datesDelta&&n.startEditable&&(T.range={start:d.add(T.range.start,r.datesDelta),end:d.add(T.range.end,r.datesDelta)}),r.startDelta&&n.durationEditable&&(T.range={start:d.add(T.range.start,r.startDelta),end:T.range.end}),r.endDelta&&n.durationEditable&&(T.range={start:T.range.start,end:d.add(T.range.end,r.endDelta)}),s&&(T.range={start:T.range.start,end:vU(e.allDay,T.range.start,c)}),e.allDay&&(T.range={start:Oo(T.range.start),end:Oo(T.range.end)}),T.range.end<T.range.start&&(T.range.end=vU(e.allDay,T.range.start,c)),T}class Cw{constructor(e,n){this.context=e,this.internalEventSource=n}remove(){this.context.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:this.internalEventSource.sourceId})}refetch(){this.context.dispatch({type:"FETCH_EVENT_SOURCES",sourceIds:[this.internalEventSource.sourceId],isRefetch:!0})}get id(){return this.internalEventSource.publicId}get url(){return this.internalEventSource.meta.url}get format(){return this.internalEventSource.meta.format}}class Io{constructor(e,n,r){this._context=e,this._def=n,this._instance=r||null}setProp(e,n){if(e in FH)console.warn("Could not set date-related prop 'name'. Use one of the date-related methods instead.");else if(e==="id")n=aO[e](n),this.mutate({standardProps:{publicId:n}});else if(e in aO)n=aO[e](n),this.mutate({standardProps:{[e]:n}});else if(e in lI){let r=lI[e](n);e==="color"?r={backgroundColor:n,borderColor:n}:e==="editable"?r={startEditable:n,durationEditable:n}:r={[e]:n},this.mutate({standardProps:{ui:r}})}else console.warn(`Could not set prop '${e}'. Use setExtendedProp instead.`)}setExtendedProp(e,n){this.mutate({extendedProps:{[e]:n}})}setStart(e,n={}){let{dateEnv:r}=this._context,c=r.createMarker(e);if(c&&this._instance){let d=this._instance.range,m=Ow(d.start,c,r,n.granularity);n.maintainDuration?this.mutate({datesDelta:m}):this.mutate({startDelta:m})}}setEnd(e,n={}){let{dateEnv:r}=this._context,c;if(!(e!=null&&(c=r.createMarker(e),!c))&&this._instance)if(c){let d=Ow(this._instance.range.end,c,r,n.granularity);this.mutate({endDelta:d})}else this.mutate({standardProps:{hasEnd:!1}})}setDates(e,n,r={}){let{dateEnv:c}=this._context,d={allDay:r.allDay},m=c.createMarker(e),s;if(m&&!(n!=null&&(s=c.createMarker(n),!s))&&this._instance){let T=this._instance.range;r.allDay===!0&&(T=LH(T));let D=Ow(T.start,m,c,r.granularity);if(s){let P=Ow(T.end,s,c,r.granularity);Sue(D,P)?this.mutate({datesDelta:D,standardProps:d}):this.mutate({startDelta:D,endDelta:P,standardProps:d})}else d.hasEnd=!1,this.mutate({datesDelta:D,standardProps:d})}}moveStart(e){let n=Rs(e);n&&this.mutate({startDelta:n})}moveEnd(e){let n=Rs(e);n&&this.mutate({endDelta:n})}moveDates(e){let n=Rs(e);n&&this.mutate({datesDelta:n})}setAllDay(e,n={}){let r={allDay:e},{maintainDuration:c}=n;c==null&&(c=this._context.options.allDayMaintainDuration),this._def.allDay!==e&&(r.hasEnd=c),this.mutate({standardProps:r})}formatRange(e){let{dateEnv:n}=this._context,r=this._instance,c=Cl(e);return this._def.hasEnd?n.formatRange(r.range.start,r.range.end,c,{forcedStartTzo:r.forcedStartTzo,forcedEndTzo:r.forcedEndTzo}):n.format(r.range.start,c,{forcedTzo:r.forcedStartTzo})}mutate(e){let n=this._instance;if(n){let r=this._def,c=this._context,{eventStore:d}=c.getCurrentData(),m=FL(d,n.instanceId);m=jL(m,{"":{display:"",startEditable:!0,durationEditable:!0,constraints:[],overlap:null,allows:[],backgroundColor:"",borderColor:"",textColor:"",classNames:[]}},e,c);let T=new Io(c,r,n);this._def=m.defs[r.defId],this._instance=m.instances[n.instanceId],c.dispatch({type:"MERGE_EVENTS",eventStore:m}),c.emitter.trigger("eventChange",{oldEvent:T,event:this,relatedEvents:ux(m,c,n),revert(){c.dispatch({type:"RESET_EVENTS",eventStore:d})}})}}remove(){let e=this._context,n=WH(this);e.dispatch({type:"REMOVE_EVENTS",eventStore:n}),e.emitter.trigger("eventRemove",{event:this,relatedEvents:[],revert(){e.dispatch({type:"MERGE_EVENTS",eventStore:n})}})}get source(){let{sourceId:e}=this._def;return e?new Cw(this._context,this._context.getCurrentData().eventSources[e]):null}get start(){return this._instance?this._context.dateEnv.toDate(this._instance.range.start):null}get end(){return this._instance&&this._def.hasEnd?this._context.dateEnv.toDate(this._instance.range.end):null}get startStr(){let e=this._instance;return e?this._context.dateEnv.formatIso(e.range.start,{omitTime:this._def.allDay,forcedTzo:e.forcedStartTzo}):""}get endStr(){let e=this._instance;return e&&this._def.hasEnd?this._context.dateEnv.formatIso(e.range.end,{omitTime:this._def.allDay,forcedTzo:e.forcedEndTzo}):""}get id(){return this._def.publicId}get groupId(){return this._def.groupId}get allDay(){return this._def.allDay}get title(){return this._def.title}get url(){return this._def.url}get display(){return this._def.ui.display||"auto"}get startEditable(){return this._def.ui.startEditable}get durationEditable(){return this._def.ui.durationEditable}get constraint(){return this._def.ui.constraints[0]||null}get overlap(){return this._def.ui.overlap}get allow(){return this._def.ui.allows[0]||null}get backgroundColor(){return this._def.ui.backgroundColor}get borderColor(){return this._def.ui.borderColor}get textColor(){return this._def.ui.textColor}get classNames(){return this._def.ui.classNames}get extendedProps(){return this._def.extendedProps}toPlainObject(e={}){let n=this._def,{ui:r}=n,{startStr:c,endStr:d}=this,m={allDay:n.allDay};return n.title&&(m.title=n.title),c&&(m.start=c),d&&(m.end=d),n.publicId&&(m.id=n.publicId),n.groupId&&(m.groupId=n.groupId),n.url&&(m.url=n.url),r.display&&r.display!=="auto"&&(m.display=r.display),e.collapseColor&&r.backgroundColor&&r.backgroundColor===r.borderColor?m.color=r.backgroundColor:(r.backgroundColor&&(m.backgroundColor=r.backgroundColor),r.borderColor&&(m.borderColor=r.borderColor)),r.textColor&&(m.textColor=r.textColor),r.classNames.length&&(m.classNames=r.classNames),Object.keys(n.extendedProps).length&&(e.collapseExtendedProps?Object.assign(m,n.extendedProps):m.extendedProps=n.extendedProps),m}toJSON(){return this.toPlainObject()}}function WH(t){let e=t._def,n=t._instance;return{defs:{[e.defId]:e},instances:n?{[n.instanceId]:n}:{}}}function ux(t,e,n){let{defs:r,instances:c}=t,d=[],m=n?n.instanceId:"";for(let s in c){let T=c[s],D=r[T.defId];T.instanceId!==m&&d.push(new Io(e,D,T))}return d}function bU(t,e,n,r){let c={},d={},m={},s=[],T=[],D=uI(t.defs,e);for(let P in t.defs){let z=t.defs[P];D[z.defId].display==="inverse-background"&&(z.groupId?(c[z.groupId]=[],m[z.groupId]||(m[z.groupId]=z)):d[P]=[])}for(let P in t.instances){let z=t.instances[P],F=t.defs[z.defId],$=D[F.defId],J=z.range,X=!F.allDay&&r?zH(J,r):J,te=cT(X,n);te&&($.display==="inverse-background"?F.groupId?c[F.groupId].push(te):d[z.defId].push(te):$.display!=="none"&&($.display==="background"?s:T).push({def:F,ui:$,instance:z,range:te,isStart:X.start&&X.start.valueOf()===te.start.valueOf(),isEnd:X.end&&X.end.valueOf()===te.end.valueOf()}))}for(let P in c){let z=c[P],F=mU(z,n);for(let $ of F){let J=m[P],X=D[J.defId];s.push({def:J,ui:X,instance:null,range:$,isStart:!1,isEnd:!1})}}for(let P in d){let z=d[P],F=mU(z,n);for(let $ of F)s.push({def:t.defs[P],ui:D[P],instance:null,range:$,isStart:!1,isEnd:!1})}return{bg:s,fg:T}}function xU(t,e){t.fcSeg=e}function uT(t){return t.fcSeg||t.parentNode.fcSeg||null}function uI(t,e){return kx(t,n=>YH(n,e))}function YH(t,e){let n=[];return e[""]&&n.push(e[""]),e[t.defId]&&n.push(e[t.defId]),n.push(t.ui),Lhe(n)}function ede(t,e){let n=t.map(tde);return n.sort((r,c)=>yue(r,c,e)),n.map(r=>r._seg)}function tde(t){let{eventRange:e}=t,n=e.def,r=e.instance?e.instance.range:e.range,c=r.start?r.start.valueOf():0,d=r.end?r.end.valueOf():0;return Object.assign(Object.assign(Object.assign({},n.extendedProps),n),{id:n.publicId,start:c,end:d,duration:d-c,allDay:Number(n.allDay),_seg:t})}function nde(t,e){let{pluginHooks:n}=e,r=n.isDraggableTransformers,{def:c,ui:d}=t.eventRange,m=d.startEditable;for(let s of r)m=s(m,c,d,e);return m}function ide(t,e){return t.isStart&&t.eventRange.ui.durationEditable&&e.options.eventResizableFromStart}function rde(t,e){return t.isEnd&&t.eventRange.ui.durationEditable}function ZH(t,e,n,r,c,d,m){let{dateEnv:s,options:T}=n,{displayEventTime:D,displayEventEnd:P}=T,z=t.eventRange.def,F=t.eventRange.instance;D==null&&(D=r!==!1),P==null&&(P=c!==!1);let $=F.range.start,J=F.range.end,X=t.start||t.eventRange.range.start,te=t.end||t.eventRange.range.end,ie=Oo($).valueOf()===Oo(X).valueOf(),we=Oo(s0(J,-1)).valueOf()===Oo(s0(te,-1)).valueOf();return D&&!z.allDay&&(ie||we)?(X=ie?$:X,te=we?J:te,P&&z.hasEnd?s.formatRange(X,te,e,{forcedStartTzo:F.forcedStartTzo,forcedEndTzo:F.forcedEndTzo}):s.format(X,e,{forcedTzo:F.forcedStartTzo})):""}function KS(t,e,n){let r=t.eventRange.range;return{isPast:r.end<=e.start,isFuture:r.start>=e.end,isToday:e&&Yv(e,r.start)}}function sde(t){let e=["fc-event"];return t.isMirror&&e.push("fc-event-mirror"),t.isDraggable&&e.push("fc-event-draggable"),(t.isStartResizable||t.isEndResizable)&&e.push("fc-event-resizable"),t.isDragging&&e.push("fc-event-dragging"),t.isResizing&&e.push("fc-event-resizing"),t.isSelected&&e.push("fc-event-selected"),t.isStart&&e.push("fc-event-start"),t.isEnd&&e.push("fc-event-end"),t.isPast&&e.push("fc-event-past"),t.isToday&&e.push("fc-event-today"),t.isFuture&&e.push("fc-event-future"),e}function ode(t){return t.instance?t.instance.instanceId:`${t.def.defId}:${t.range.start.toISOString()}`}function XH(t,e){let{def:n,instance:r}=t.eventRange,{url:c}=n;if(c)return{href:c};let{emitter:d,options:m}=e,{eventInteractive:s}=m;return s==null&&(s=n.interactive,s==null&&(s=!!d.hasHandlers("eventClick"))),s?DH(T=>{d.trigger("eventClick",{el:T.target,event:new Io(e,n,r),jsEvent:T,view:e.viewApi})}):{}}const ade={start:nn,end:nn,allDay:Boolean};function lde(t,e,n){let r=cde(t,e),{range:c}=r;if(!c.start)return null;if(!c.end){if(n==null)return null;c.end=e.add(c.start,n)}return r}function cde(t,e){let{refined:n,extra:r}=ML(t,ade),c=n.start?e.createMarkerMeta(n.start):null,d=n.end?e.createMarkerMeta(n.end):null,{allDay:m}=n;return m==null&&(m=c&&c.isTimeUnspecified&&(!d||d.isTimeUnspecified)),Object.assign({range:{start:c?c.marker:null,end:d?d.marker:null},allDay:m},r)}function ude(t,e){return She(t.range,e.range)&&t.allDay===e.allDay&&hde(t,e)}function hde(t,e){for(let n in e)if(n!=="range"&&n!=="allDay"&&t[n]!==e[n])return!1;for(let n in t)if(!(n in e))return!1;return!0}function dde(t,e){return Object.assign(Object.assign({},KH(t.range,e,t.allDay)),{allDay:t.allDay})}function QH(t,e,n){return Object.assign(Object.assign({},KH(t,e,n)),{timeZone:e.timeZone})}function KH(t,e,n){return{start:e.toDate(t.start),end:e.toDate(t.end),startStr:e.formatIso(t.start,{omitTime:n}),endStr:e.formatIso(t.end,{omitTime:n})}}function fde(t,e,n){let r=UH({editable:!1},n),c=TN(r.refined,r.extra,"",t.allDay,!0,n);return{def:c,ui:YH(c,e),instance:zL(c.defId,t.range),range:t.range,isStart:!0,isEnd:!0}}function pde(t,e,n){let r=!1,c=function(s){r||(r=!0,e(s))},d=function(s){r||(r=!0,n(s))},m=t(c,d);m&&typeof m.then=="function"&&m.then(c,d)}class wU extends Error{constructor(e,n){super(e),this.response=n}}function mde(t,e,n){t=t.toUpperCase();const r={method:t};return t==="GET"?e+=(e.indexOf("?")===-1?"?":"&")+new URLSearchParams(n):(r.body=new URLSearchParams(n),r.headers={"Content-Type":"application/x-www-form-urlencoded"}),fetch(e,r).then(c=>{if(c.ok)return c.json().then(d=>[d,c],()=>{throw new wU("Failure parsing JSON",c)});throw new wU("Request failed",c)})}let tk;function JH(){return tk==null&&(tk=gde()),tk}function gde(){if(typeof document>"u")return!0;let t=document.createElement("div");t.style.position="absolute",t.style.top="0px",t.style.left="0px",t.innerHTML="<table><tr><td><div></div></td></tr></table>",t.querySelector("table").style.height="100px",t.querySelector("div").style.height="100%",document.body.appendChild(t);let n=t.querySelector("div").offsetHeight>0;return document.body.removeChild(t),n}class _de extends Vo{constructor(){super(...arguments),this.state={forPrint:!1},this.handleBeforePrint=()=>{aI(()=>{this.setState({forPrint:!0})})},this.handleAfterPrint=()=>{aI(()=>{this.setState({forPrint:!1})})}}render(){let{props:e}=this,{options:n}=e,{forPrint:r}=this.state,c=r||n.height==="auto"||n.contentHeight==="auto",d=!c&&n.height!=null?n.height:"",m=["fc",r?"fc-media-print":"fc-media-screen",`fc-direction-${n.direction}`,e.theme.getClass("root")];return JH()||m.push("fc-liquid-hack"),e.children(m,d,c,r)}componentDidMount(){let{emitter:e}=this.props;e.on("_beforeprint",this.handleBeforePrint),e.on("_afterprint",this.handleAfterPrint)}componentWillUnmount(){let{emitter:e}=this.props;e.off("_beforeprint",this.handleBeforePrint),e.off("_afterprint",this.handleAfterPrint)}}class CT{constructor(e){this.component=e.component,this.isHitComboAllowed=e.isHitComboAllowed||null}destroy(){}}function yde(t,e){return{component:t,el:e.el,useEventCenter:e.useEventCenter!=null?e.useEventCenter:!0,isHitComboAllowed:e.isHitComboAllowed||null}}function HL(t){return{[t.component.uid]:t}}const SN={};class _M extends Yh{constructor(e,n){super(e,n),this.handleRefresh=()=>{let r=this.computeTiming();r.state.nowDate.valueOf()!==this.state.nowDate.valueOf()&&this.setState(r.state),this.clearTimeout(),this.setTimeout(r.waitMs)},this.handleVisibilityChange=()=>{document.hidden||this.handleRefresh()},this.state=this.computeTiming().state}render(){let{props:e,state:n}=this;return e.children(n.nowDate,n.todayRange)}componentDidMount(){this.setTimeout(),this.context.nowManager.addResetListener(this.handleRefresh),document.addEventListener("visibilitychange",this.handleVisibilityChange)}componentDidUpdate(e){e.unit!==this.props.unit&&(this.clearTimeout(),this.setTimeout())}componentWillUnmount(){this.clearTimeout(),this.context.nowManager.removeResetListener(this.handleRefresh),document.removeEventListener("visibilitychange",this.handleVisibilityChange)}computeTiming(){let{props:e,context:n}=this,r=n.nowManager.getDateMarker(),c=n.dateEnv.startOf(r,e.unit),m=n.dateEnv.add(c,Rs(1,e.unit)).valueOf()-r.valueOf();return m=Math.min(1e3*60*60*24,m),{state:{nowDate:c,todayRange:vde(c)},waitMs:m}}setTimeout(e=this.computeTiming().waitMs){this.timeoutId=setTimeout(()=>{const n=this.computeTiming();this.setState(n.state,()=>{this.setTimeout(n.waitMs)})},e)}clearTimeout(){this.timeoutId&&clearTimeout(this.timeoutId)}}_M.contextType=Nx;function vde(t){let e=Oo(t),n=Uc(e,1);return{start:e,end:n}}class bde{getCurrentData(){return this.currentDataManager.getCurrentData()}dispatch(e){this.currentDataManager.dispatch(e)}get view(){return this.getCurrentData().viewApi}batchRendering(e){e()}updateSize(){this.trigger("_resize",!0)}setOption(e,n){this.dispatch({type:"SET_OPTION",optionName:e,rawOptionValue:n})}getOption(e){return this.currentDataManager.currentCalendarOptionsInput[e]}getAvailableLocaleCodes(){return Object.keys(this.getCurrentData().availableRawLocales)}on(e,n){let{currentDataManager:r}=this;r.currentCalendarOptionsRefiners[e]?r.emitter.on(e,n):console.warn(`Unknown listener name '${e}'`)}off(e,n){this.currentDataManager.emitter.off(e,n)}trigger(e,...n){this.currentDataManager.emitter.trigger(e,...n)}changeView(e,n){this.batchRendering(()=>{if(this.unselect(),n)if(n.start&&n.end)this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e}),this.dispatch({type:"SET_OPTION",optionName:"visibleRange",rawOptionValue:n});else{let{dateEnv:r}=this.getCurrentData();this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e,dateMarker:r.createMarker(n)})}else this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:e})})}zoomTo(e,n){let r=this.getCurrentData(),c;n=n||"day",c=r.viewSpecs[n]||this.getUnitViewSpec(n),this.unselect(),c?this.dispatch({type:"CHANGE_VIEW_TYPE",viewType:c.type,dateMarker:e}):this.dispatch({type:"CHANGE_DATE",dateMarker:e})}getUnitViewSpec(e){let{viewSpecs:n,toolbarConfig:r}=this.getCurrentData(),c=[].concat(r.header?r.header.viewsWithButtons:[],r.footer?r.footer.viewsWithButtons:[]),d,m;for(let s in n)c.push(s);for(d=0;d<c.length;d+=1)if(m=n[c[d]],m&&m.singleUnit===e)return m;return null}prev(){this.unselect(),this.dispatch({type:"PREV"})}next(){this.unselect(),this.dispatch({type:"NEXT"})}prevYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,-1)})}nextYear(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.dateEnv.addYears(e.currentDate,1)})}today(){let e=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:e.nowManager.getDateMarker()})}gotoDate(e){let n=this.getCurrentData();this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:n.dateEnv.createMarker(e)})}incrementDate(e){let n=this.getCurrentData(),r=Rs(e);r&&(this.unselect(),this.dispatch({type:"CHANGE_DATE",dateMarker:n.dateEnv.add(n.currentDate,r)}))}getDate(){let e=this.getCurrentData();return e.dateEnv.toDate(e.currentDate)}formatDate(e,n){let{dateEnv:r}=this.getCurrentData();return r.format(r.createMarker(e),Cl(n))}formatRange(e,n,r){let{dateEnv:c}=this.getCurrentData();return c.formatRange(c.createMarker(e),c.createMarker(n),Cl(r),r)}formatIso(e,n){let{dateEnv:r}=this.getCurrentData();return r.formatIso(r.createMarker(e),{omitTime:n})}select(e,n){let r;n==null?e.start!=null?r=e:r={start:e,end:null}:r={start:e,end:n};let c=this.getCurrentData(),d=lde(r,c.dateEnv,Rs({days:1}));d&&(this.dispatch({type:"SELECT_DATES",selection:d}),qH(d,null,c))}unselect(e){let n=this.getCurrentData();n.dateSelection&&(this.dispatch({type:"UNSELECT_DATES"}),Qhe(e,n))}addEvent(e,n){if(e instanceof Io){let m=e._def,s=e._instance;return this.getCurrentData().eventStore.defs[m.defId]||(this.dispatch({type:"ADD_EVENTS",eventStore:EN({def:m,instance:s})}),this.triggerEventAdd(e)),e}let r=this.getCurrentData(),c;if(n instanceof Cw)c=n.internalEventSource;else if(typeof n=="boolean")n&&([c]=kL(r.eventSources));else if(n!=null){let m=this.getEventSourceById(n);if(!m)return console.warn(`Could not find an event source with ID "${n}"`),null;c=m.internalEventSource}let d=VH(e,c,r,!1);if(d){let m=new Io(r,d.def,d.def.recurringDef?null:d.instance);return this.dispatch({type:"ADD_EVENTS",eventStore:EN(d)}),this.triggerEventAdd(m),m}return null}triggerEventAdd(e){let{emitter:n}=this.getCurrentData();n.trigger("eventAdd",{event:e,relatedEvents:[],revert:()=>{this.dispatch({type:"REMOVE_EVENTS",eventStore:WH(e)})}})}getEventById(e){let n=this.getCurrentData(),{defs:r,instances:c}=n.eventStore;e=String(e);for(let d in r){let m=r[d];if(m.publicId===e){if(m.recurringDef)return new Io(n,m,null);for(let s in c){let T=c[s];if(T.defId===m.defId)return new Io(n,m,T)}}}return null}getEvents(){let e=this.getCurrentData();return ux(e.eventStore,e)}removeAllEvents(){this.dispatch({type:"REMOVE_ALL_EVENTS"})}getEventSources(){let e=this.getCurrentData(),n=e.eventSources,r=[];for(let c in n)r.push(new Cw(e,n[c]));return r}getEventSourceById(e){let n=this.getCurrentData(),r=n.eventSources;e=String(e);for(let c in r)if(r[c].publicId===e)return new Cw(n,r[c]);return null}addEventSource(e){let n=this.getCurrentData();if(e instanceof Cw)return n.eventSources[e.internalEventSource.sourceId]||this.dispatch({type:"ADD_EVENT_SOURCES",sources:[e.internalEventSource]}),e;let r=jH(e,n);return r?(this.dispatch({type:"ADD_EVENT_SOURCES",sources:[r]}),new Cw(n,r)):null}removeAllEventSources(){this.dispatch({type:"REMOVE_ALL_EVENT_SOURCES"})}refetchEvents(){this.dispatch({type:"FETCH_EVENT_SOURCES",isRefetch:!0})}scrollToTime(e){let n=Rs(e);n&&this.trigger("_scrollRequest",{time:n})}}function xde(t,e){return t.left>=e.left&&t.left<e.right&&t.top>=e.top&&t.top<e.bottom}function e$(t,e){let n={left:Math.max(t.left,e.left),right:Math.min(t.right,e.right),top:Math.max(t.top,e.top),bottom:Math.min(t.bottom,e.bottom)};return n.left<n.right&&n.top<n.bottom?n:!1}function wde(t,e){return{left:Math.min(Math.max(t.left,e.left),e.right),top:Math.min(Math.max(t.top,e.top),e.bottom)}}function Tde(t){return{left:(t.left+t.right)/2,top:(t.top+t.bottom)/2}}function Ede(t,e){return{left:t.left-e.left,top:t.top-e.top}}function t$(t,e,n,r){return{dow:t.getUTCDay(),isDisabled:!!(r&&(!r.activeRange||!Yv(r.activeRange,t))),isOther:!!(r&&!Yv(r.currentRange,t)),isToday:!!(e&&Yv(e,t)),isPast:!!(e&&t<e.start),isFuture:!!(e&&t>=e.end)}}function $L(t,e){let n=["fc-day",`fc-day-${Rue[t.dow]}`];return t.isDisabled?n.push("fc-day-disabled"):(t.isToday&&(n.push("fc-day-today"),n.push(e.getClass("today"))),t.isPast&&n.push("fc-day-past"),t.isFuture&&n.push("fc-day-future"),t.isOther&&n.push("fc-day-other")),n}const Sde=Cl({year:"numeric",month:"long",day:"numeric"}),Ade=Cl({week:"long"});function AN(t,e,n="day",r=!0){const{dateEnv:c,options:d,calendarApi:m}=t;let s=c.format(e,n==="week"?Ade:Sde);if(d.navLinks){let T=c.toDate(e);const D=P=>{let z=n==="day"?d.navLinkDayClick:n==="week"?d.navLinkWeekClick:null;typeof z=="function"?z.call(m,c.toDate(e),P):(typeof z=="string"&&(n=z),m.zoomTo(e,n))};return Object.assign({title:XS(d.navLinkHint,[s,T],s),"data-navlink":""},r?CH(D):{onClick:D})}return{"aria-label":s}}let nk=null;function Cde(){return nk===null&&(nk=Dde()),nk}function Dde(){let t=document.createElement("div");ZS(t,{position:"absolute",top:-1e3,left:0,border:0,padding:0,overflow:"scroll",direction:"rtl"}),t.innerHTML="<div></div>",document.body.appendChild(t);let n=t.firstChild.getBoundingClientRect().left>t.getBoundingClientRect().left;return CL(t),n}let ik;function Rde(){return ik||(ik=Ode()),ik}function Ode(){let t=document.createElement("div");t.style.overflow="scroll",t.style.position="absolute",t.style.top="-9999px",t.style.left="-9999px",document.body.appendChild(t);let e=n$(t);return document.body.removeChild(t),e}function n$(t){return{x:t.offsetHeight-t.clientHeight,y:t.offsetWidth-t.clientWidth}}function Ide(t,e=!1){let n=window.getComputedStyle(t),r=parseInt(n.borderLeftWidth,10)||0,c=parseInt(n.borderRightWidth,10)||0,d=parseInt(n.borderTopWidth,10)||0,m=parseInt(n.borderBottomWidth,10)||0,s=n$(t),T=s.y-r-c,D=s.x-d-m,P={borderLeft:r,borderRight:c,borderTop:d,borderBottom:m,scrollbarBottom:D,scrollbarLeft:0,scrollbarRight:0};return Cde()&&n.direction==="rtl"?P.scrollbarLeft=T:P.scrollbarRight=T,e&&(P.paddingLeft=parseInt(n.paddingLeft,10)||0,P.paddingRight=parseInt(n.paddingRight,10)||0,P.paddingTop=parseInt(n.paddingTop,10)||0,P.paddingBottom=parseInt(n.paddingBottom,10)||0),P}function Mde(t,e=!1,n){let r=GL(t),c=Ide(t,e),d={left:r.left+c.borderLeft+c.scrollbarLeft,right:r.right-c.borderRight-c.scrollbarRight,top:r.top+c.borderTop,bottom:r.bottom-c.borderBottom-c.scrollbarBottom};return e&&(d.left+=c.paddingLeft,d.right-=c.paddingRight,d.top+=c.paddingTop,d.bottom-=c.paddingBottom),d}function GL(t){let e=t.getBoundingClientRect();return{left:e.left+window.scrollX,top:e.top+window.scrollY,right:e.right+window.scrollX,bottom:e.bottom+window.scrollY}}function Pde(t){let e=i$(t),n=t.getBoundingClientRect();for(let r of e){let c=e$(n,r.getBoundingClientRect());if(c)n=c;else return null}return n}function i$(t){let e=[];for(;t instanceof HTMLElement;){let n=window.getComputedStyle(t);if(n.position==="fixed")break;/(auto|scroll)/.test(n.overflow+n.overflowY+n.overflowX)&&e.push(t),t=t.parentNode}return e}class hI{constructor(e,n,r,c){this.els=n;let d=this.originClientRect=e.getBoundingClientRect();r&&this.buildElHorizontals(d.left),c&&this.buildElVerticals(d.top)}buildElHorizontals(e){let n=[],r=[];for(let c of this.els){let d=c.getBoundingClientRect();n.push(d.left-e),r.push(d.right-e)}this.lefts=n,this.rights=r}buildElVerticals(e){let n=[],r=[];for(let c of this.els){let d=c.getBoundingClientRect();n.push(d.top-e),r.push(d.bottom-e)}this.tops=n,this.bottoms=r}leftToIndex(e){let{lefts:n,rights:r}=this,c=n.length,d;for(d=0;d<c;d+=1)if(e>=n[d]&&e<r[d])return d}topToIndex(e){let{tops:n,bottoms:r}=this,c=n.length,d;for(d=0;d<c;d+=1)if(e>=n[d]&&e<r[d])return d}getWidth(e){return this.rights[e]-this.lefts[e]}getHeight(e){return this.bottoms[e]-this.tops[e]}similarTo(e){return CR(this.tops||[],e.tops||[])&&CR(this.bottoms||[],e.bottoms||[])&&CR(this.lefts||[],e.lefts||[])&&CR(this.rights||[],e.rights||[])}}function CR(t,e){const n=t.length;if(n!==e.length)return!1;for(let r=0;r<n;r++)if(Math.round(t[r])!==Math.round(e[r]))return!1;return!0}class qL{getMaxScrollTop(){return this.getScrollHeight()-this.getClientHeight()}getMaxScrollLeft(){return this.getScrollWidth()-this.getClientWidth()}canScrollVertically(){return this.getMaxScrollTop()>0}canScrollHorizontally(){return this.getMaxScrollLeft()>0}canScrollUp(){return this.getScrollTop()>0}canScrollDown(){return this.getScrollTop()<this.getMaxScrollTop()}canScrollLeft(){return this.getScrollLeft()>0}canScrollRight(){return this.getScrollLeft()<this.getMaxScrollLeft()}}class kde extends qL{constructor(e){super(),this.el=e}getScrollTop(){return this.el.scrollTop}getScrollLeft(){return this.el.scrollLeft}setScrollTop(e){this.el.scrollTop=e}setScrollLeft(e){this.el.scrollLeft=e}getScrollWidth(){return this.el.scrollWidth}getScrollHeight(){return this.el.scrollHeight}getClientHeight(){return this.el.clientHeight}getClientWidth(){return this.el.clientWidth}}class Nde extends qL{getScrollTop(){return window.scrollY}getScrollLeft(){return window.scrollX}setScrollTop(e){window.scroll(window.scrollX,e)}setScrollLeft(e){window.scroll(e,window.scrollY)}getScrollWidth(){return document.documentElement.scrollWidth}getScrollHeight(){return document.documentElement.scrollHeight}getClientHeight(){return document.documentElement.clientHeight}getClientWidth(){return document.documentElement.clientWidth}}class zx extends Vo{constructor(){super(...arguments),this.uid=Px()}prepareHits(){}queryHit(e,n,r,c){return null}isValidSegDownEl(e){return!this.props.eventDrag&&!this.props.eventResize&&!zc(e,".fc-event-mirror")}isValidDateDownEl(e){return!zc(e,".fc-event:not(.fc-bg-event)")&&!zc(e,".fc-more-link")&&!zc(e,"a[data-navlink]")&&!zc(e,".fc-popover")}}class Lde{constructor(e=n=>n.thickness||1){this.getEntryThickness=e,this.strictOrder=!1,this.allowReslicing=!1,this.maxCoord=-1,this.maxStackCnt=-1,this.levelCoords=[],this.entriesByLevel=[],this.stackCnts={}}addSegs(e){let n=[];for(let r of e)this.insertEntry(r,n);return n}insertEntry(e,n){let r=this.findInsertion(e);this.isInsertionValid(r,e)?this.insertEntryAt(e,r):this.handleInvalidInsertion(r,e,n)}isInsertionValid(e,n){return(this.maxCoord===-1||e.levelCoord+this.getEntryThickness(n)<=this.maxCoord)&&(this.maxStackCnt===-1||e.stackCnt<this.maxStackCnt)}handleInvalidInsertion(e,n,r){if(this.allowReslicing&&e.touchingEntry){const c=Object.assign(Object.assign({},n),{span:r$(n.span,e.touchingEntry.span)});r.push(c),this.splitEntry(n,e.touchingEntry,r)}else r.push(n)}splitEntry(e,n,r){let c=e.span,d=n.span;c.start<d.start&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:c.start,end:d.start}},r),c.end>d.end&&this.insertEntry({index:e.index,thickness:e.thickness,span:{start:d.end,end:c.end}},r)}insertEntryAt(e,n){let{entriesByLevel:r,levelCoords:c}=this;n.lateral===-1?(rk(c,n.level,n.levelCoord),rk(r,n.level,[e])):rk(r[n.level],n.lateral,e),this.stackCnts[JS(e)]=n.stackCnt}findInsertion(e){let{levelCoords:n,entriesByLevel:r,strictOrder:c,stackCnts:d}=this,m=n.length,s=0,T=-1,D=-1,P=null,z=0;for(let J=0;J<m;J+=1){const X=n[J];if(!c&&X>=s+this.getEntryThickness(e))break;let te=r[J],ie,we=EU(te,e.span.start,TU),Ie=we[0]+we[1];for(;(ie=te[Ie])&&ie.span.start<e.span.end;){let Re=X+this.getEntryThickness(ie);Re>s&&(s=Re,P=ie,T=J,D=Ie),Re===s&&(z=Math.max(z,d[JS(ie)]+1)),Ie+=1}}let F=0;if(P)for(F=T+1;F<m&&n[F]<s;)F+=1;let $=-1;return F<m&&n[F]===s&&($=EU(r[F],e.span.end,TU)[0]),{touchingLevel:T,touchingLateral:D,touchingEntry:P,stackCnt:z,levelCoord:s,level:F,lateral:$}}toRects(){let{entriesByLevel:e,levelCoords:n}=this,r=e.length,c=[];for(let d=0;d<r;d+=1){let m=e[d],s=n[d];for(let T of m)c.push(Object.assign(Object.assign({},T),{thickness:this.getEntryThickness(T),levelCoord:s}))}return c}}function TU(t){return t.span.end}function JS(t){return t.index+":"+t.span.start}function r$(t,e){let n=Math.max(t.start,e.start),r=Math.min(t.end,e.end);return n<r?{start:n,end:r}:null}function rk(t,e,n){t.splice(e,0,n)}function EU(t,e,n){let r=0,c=t.length;if(!c||e<n(t[r]))return[0,0];if(e>n(t[c-1]))return[c,0];for(;r<c;){let d=Math.floor(r+(c-r)/2),m=n(t[d]);if(e<m)c=d;else if(e>m)r=d+1;else return[d,1]}return[r,0]}class zde{constructor(e,n){this.emitter=new gM}destroy(){}setMirrorIsVisible(e){}setMirrorNeedsRevert(e){}setAutoScrollEnabled(e){}}const WL={};function Bde(t,e){return!t||e>10?Cl({weekday:"short"}):e>1?Cl({weekday:"short",month:"numeric",day:"numeric",omitCommas:!0}):Cl({weekday:"long"})}const s$="fc-col-header-cell";function o$(t){return t.text}class Fde extends Vo{render(){let{dateEnv:e,options:n,theme:r,viewApi:c}=this.context,{props:d}=this,{date:m,dateProfile:s}=d,T=t$(m,d.todayRange,null,s),D=[s$].concat($L(T,r)),P=e.format(m,d.dayHeaderFormat),z=!T.isDisabled&&d.colCnt>1?AN(this.context,m):{},F=e.toDate(m);e.namedTimeZoneImpl&&(F=s0(F,36e5));let $=Object.assign(Object.assign(Object.assign({date:F,view:c},d.extraRenderProps),{text:P}),T);return on(z_,{elTag:"th",elClasses:D,elAttrs:Object.assign({role:"columnheader",colSpan:d.colSpan,"data-date":T.isDisabled?void 0:OL(m)},d.extraDataAttrs),renderProps:$,generatorName:"dayHeaderContent",customGenerator:n.dayHeaderContent,defaultGenerator:o$,classNameGenerator:n.dayHeaderClassNames,didMount:n.dayHeaderDidMount,willUnmount:n.dayHeaderWillUnmount},J=>on("div",{className:"fc-scrollgrid-sync-inner"},!T.isDisabled&&on(J,{elTag:"a",elAttrs:z,elClasses:["fc-col-header-cell-cushion",d.isSticky&&"fc-sticky"]})))}}const Vde=Cl({weekday:"long"});class Ude extends Vo{render(){let{props:e}=this,{dateEnv:n,theme:r,viewApi:c,options:d}=this.context,m=Uc(new Date(2592e5),e.dow),s={dow:e.dow,isDisabled:!1,isFuture:!1,isPast:!1,isToday:!1,isOther:!1},T=n.format(m,e.dayHeaderFormat),D=Object.assign(Object.assign(Object.assign(Object.assign({date:m},s),{view:c}),e.extraRenderProps),{text:T});return on(z_,{elTag:"th",elClasses:[s$,...$L(s,r),...e.extraClassNames||[]],elAttrs:Object.assign({role:"columnheader",colSpan:e.colSpan},e.extraDataAttrs),renderProps:D,generatorName:"dayHeaderContent",customGenerator:d.dayHeaderContent,defaultGenerator:o$,classNameGenerator:d.dayHeaderClassNames,didMount:d.dayHeaderDidMount,willUnmount:d.dayHeaderWillUnmount},P=>on("div",{className:"fc-scrollgrid-sync-inner"},on(P,{elTag:"a",elClasses:["fc-col-header-cell-cushion",e.isSticky&&"fc-sticky"],elAttrs:{"aria-label":n.format(m,Vde)}})))}}class jde extends Vo{constructor(){super(...arguments),this.createDayHeaderFormatter=Os(Hde)}render(){let{context:e}=this,{dates:n,dateProfile:r,datesRepDistinctDays:c,renderIntro:d}=this.props,m=this.createDayHeaderFormatter(e.options.dayHeaderFormat,c,n.length);return on(_M,{unit:"day"},(s,T)=>on("tr",{role:"row"},d&&d("day"),n.map(D=>c?on(Fde,{key:D.toISOString(),date:D,dateProfile:r,todayRange:T,colCnt:n.length,dayHeaderFormat:m}):on(Ude,{key:D.getUTCDay(),dow:D.getUTCDay(),dayHeaderFormat:m}))))}}function Hde(t,e,n){return t||Bde(e,n)}class $de{constructor(e,n){let r=e.start,{end:c}=e,d=[],m=[],s=-1;for(;r<c;)n.isHiddenDay(r)?d.push(s+.5):(s+=1,d.push(s),m.push(r)),r=Uc(r,1);this.dates=m,this.indices=d,this.cnt=m.length}sliceRange(e){let n=this.getDateDayIndex(e.start),r=this.getDateDayIndex(Uc(e.end,-1)),c=Math.max(0,n),d=Math.min(this.cnt-1,r);return c=Math.ceil(c),d=Math.floor(d),c<=d?{firstIndex:c,lastIndex:d,isStart:n===c,isEnd:r===d}:null}getDateDayIndex(e){let{indices:n}=this,r=Math.floor(AT(this.dates[0],e));return r<0?n[0]-1:r>=n.length?n[n.length-1]+1:n[r]}}class Gde{constructor(e,n){let{dates:r}=e,c,d,m;if(n){for(d=r[0].getUTCDay(),c=1;c<r.length&&r[c].getUTCDay()!==d;c+=1);m=Math.ceil(r.length/c)}else m=1,c=r.length;this.rowCnt=m,this.colCnt=c,this.daySeries=e,this.cells=this.buildCells(),this.headerDates=this.buildHeaderDates()}buildCells(){let e=[];for(let n=0;n<this.rowCnt;n+=1){let r=[];for(let c=0;c<this.colCnt;c+=1)r.push(this.buildCell(n,c));e.push(r)}return e}buildCell(e,n){let r=this.daySeries.dates[e*this.colCnt+n];return{key:r.toISOString(),date:r}}buildHeaderDates(){let e=[];for(let n=0;n<this.colCnt;n+=1)e.push(this.cells[0][n].date);return e}sliceRange(e){let{colCnt:n}=this,r=this.daySeries.sliceRange(e),c=[];if(r){let{firstIndex:d,lastIndex:m}=r,s=d;for(;s<=m;){let T=Math.floor(s/n),D=Math.min((T+1)*n,m+1);c.push({row:T,firstCol:s%n,lastCol:(D-1)%n,isStart:r.isStart&&s===d,isEnd:r.isEnd&&D-1===m}),s=D}}return c}}class qde{constructor(){this.sliceBusinessHours=Os(this._sliceBusinessHours),this.sliceDateSelection=Os(this._sliceDateSpan),this.sliceEventStore=Os(this._sliceEventStore),this.sliceEventDrag=Os(this._sliceInteraction),this.sliceEventResize=Os(this._sliceInteraction),this.forceDayIfListItem=!1}sliceProps(e,n,r,c,...d){let{eventUiBases:m}=e,s=this.sliceEventStore(e.eventStore,m,n,r,...d);return{dateSelectionSegs:this.sliceDateSelection(e.dateSelection,n,r,m,c,...d),businessHourSegs:this.sliceBusinessHours(e.businessHours,n,r,c,...d),fgEventSegs:s.fg,bgEventSegs:s.bg,eventDrag:this.sliceEventDrag(e.eventDrag,m,n,r,...d),eventResize:this.sliceEventResize(e.eventResize,m,n,r,...d),eventSelection:e.eventSelection}}sliceNowDate(e,n,r,c,...d){return this._sliceDateSpan({range:{start:e,end:s0(e,1)},allDay:!1},n,r,{},c,...d)}_sliceBusinessHours(e,n,r,c,...d){return e?this._sliceEventStore(Ax(e,DR(n,!!r),c),{},n,r,...d).bg:[]}_sliceEventStore(e,n,r,c,...d){if(e){let m=bU(e,n,DR(r,!!c),c);return{bg:this.sliceEventRanges(m.bg,d),fg:this.sliceEventRanges(m.fg,d)}}return{bg:[],fg:[]}}_sliceInteraction(e,n,r,c,...d){if(!e)return null;let m=bU(e.mutatedEvents,n,DR(r,!!c),c);return{segs:this.sliceEventRanges(m.fg,d),affectedInstances:e.affectedEvents.instances,isEvent:e.isEvent}}_sliceDateSpan(e,n,r,c,d,...m){if(!e)return[];let s=DR(n,!!r),T=cT(e.range,s);if(T){e=Object.assign(Object.assign({},e),{range:T});let D=fde(e,c,d),P=this.sliceRange(e.range,...m);for(let z of P)z.eventRange=D;return P}return[]}sliceEventRanges(e,n){let r=[];for(let c of e)r.push(...this.sliceEventRange(c,n));return r}sliceEventRange(e,n){let r=e.range;this.forceDayIfListItem&&e.ui.display==="list-item"&&(r={start:r.start,end:Uc(r.start,1)});let c=this.sliceRange(r,...n);for(let d of c)d.eventRange=e,d.isStart=e.isStart&&d.isStart,d.isEnd=e.isEnd&&d.isEnd;return c}}function DR(t,e){let n=t.activeRange;return e?n:{start:s0(n.start,t.slotMinTime.milliseconds),end:s0(n.end,t.slotMaxTime.milliseconds-864e5)}}function a$(t,e,n){let{instances:r}=t.mutatedEvents;for(let c in r)if(!pM(e.validRange,r[c].range))return!1;return l$({eventDrag:t},n)}function Wde(t,e,n){return pM(e.validRange,t.range)?l$({dateSelection:t},n):!1}function l$(t,e){let n=e.getCurrentData(),r=Object.assign({businessHours:n.businessHours,dateSelection:"",eventStore:n.eventStore,eventUiBases:n.eventUiBases,eventSelection:"",eventDrag:null,eventResize:null},t);return(e.pluginHooks.isPropsValid||Yde)(r,e)}function Yde(t,e,n={},r){return!(t.eventDrag&&!Zde(t,e,n,r)||t.dateSelection&&!Xde(t,e,n,r))}function Zde(t,e,n,r){let c=e.getCurrentData(),d=t.eventDrag,m=d.mutatedEvents,s=m.defs,T=m.instances,D=uI(s,d.isEvent?t.eventUiBases:{"":c.selectionConfig});r&&(D=kx(D,r));let P=$he(t.eventStore,d.affectedEvents.instances),z=P.defs,F=P.instances,$=uI(z,t.eventUiBases);for(let J in T){let X=T[J],te=X.range,ie=D[X.defId],we=s[X.defId];if(!c$(ie.constraints,te,P,t.businessHours,e))return!1;let{eventOverlap:Ie}=e.options,Re=typeof Ie=="function"?Ie:null;for(let Xe in F){let be=F[Xe];if(LL(te,be.range)&&($[be.defId].overlap===!1&&d.isEvent||ie.overlap===!1||Re&&!Re(new Io(e,z[be.defId],be),new Io(e,we,X))))return!1}let Ne=c.eventStore;for(let Xe of ie.allows){let be=Object.assign(Object.assign({},n),{range:X.range,allDay:we.allDay}),_e=Ne.defs[we.defId],Te=Ne.instances[J],oe;if(_e?oe=new Io(e,_e,Te):oe=new Io(e,we),!Xe(UL(be,e),oe))return!1}}return!0}function Xde(t,e,n,r){let c=t.eventStore,d=c.defs,m=c.instances,s=t.dateSelection,T=s.range,{selectionConfig:D}=e.getCurrentData();if(r&&(D=r(D)),!c$(D.constraints,T,c,t.businessHours,e))return!1;let{selectOverlap:P}=e.options,z=typeof P=="function"?P:null;for(let F in m){let $=m[F];if(LL(T,$.range)&&(D.overlap===!1||z&&!z(new Io(e,d[$.defId],$),null)))return!1}for(let F of D.allows){let $=Object.assign(Object.assign({},n),s);if(!F(UL($,e),null))return!1}return!0}function c$(t,e,n,r,c){for(let d of t)if(!Kde(Qde(d,e,n,r,c),e))return!1;return!0}function Qde(t,e,n,r,c){return t==="businessHours"?sk(Ax(r,e,c)):typeof t=="string"?sk(mM(n,d=>d.groupId===t)):typeof t=="object"&&t?sk(Ax(t,e,c)):[]}function sk(t){let{instances:e}=t,n=[];for(let r in e)n.push(e[r].range);return n}function Kde(t,e){for(let n of t)if(pM(n,e))return!0;return!1}const RR=/^(visible|hidden)$/;class Jde extends Vo{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,M_(this.props.elRef,e)}}render(){let{props:e}=this,{liquid:n,liquidIsAbsolute:r}=e,c=n&&r,d=["fc-scroller"];return n&&(r?d.push("fc-scroller-liquid-absolute"):d.push("fc-scroller-liquid")),on("div",{ref:this.handleEl,className:d.join(" "),style:{overflowX:e.overflowX,overflowY:e.overflowY,left:c&&-(e.overcomeLeft||0)||"",right:c&&-(e.overcomeRight||0)||"",bottom:c&&-(e.overcomeBottom||0)||"",marginLeft:!c&&-(e.overcomeLeft||0)||"",marginRight:!c&&-(e.overcomeRight||0)||"",marginBottom:!c&&-(e.overcomeBottom||0)||"",maxHeight:e.maxHeight||""}},e.children)}needsXScrolling(){if(RR.test(this.props.overflowX))return!1;let{el:e}=this,n=this.el.getBoundingClientRect().width-this.getYScrollbarWidth(),{children:r}=e;for(let c=0;c<r.length;c+=1)if(r[c].getBoundingClientRect().width>n)return!0;return!1}needsYScrolling(){if(RR.test(this.props.overflowY))return!1;let{el:e}=this,n=this.el.getBoundingClientRect().height-this.getXScrollbarWidth(),{children:r}=e;for(let c=0;c<r.length;c+=1)if(r[c].getBoundingClientRect().height>n)return!0;return!1}getXScrollbarWidth(){return RR.test(this.props.overflowX)?0:this.el.offsetHeight-this.el.clientHeight}getYScrollbarWidth(){return RR.test(this.props.overflowY)?0:this.el.offsetWidth-this.el.clientWidth}}class ax{constructor(e){this.masterCallback=e,this.currentMap={},this.depths={},this.callbackMap={},this.handleValue=(n,r)=>{let{depths:c,currentMap:d}=this,m=!1,s=!1;n!==null?(m=r in d,d[r]=n,c[r]=(c[r]||0)+1,s=!0):(c[r]-=1,c[r]||(delete d[r],delete this.callbackMap[r],m=!0)),this.masterCallback&&(m&&this.masterCallback(null,String(r)),s&&this.masterCallback(n,String(r)))}}createRef(e){let n=this.callbackMap[e];return n||(n=this.callbackMap[e]=r=>{this.handleValue(r,String(e))}),n}collect(e,n,r){return lhe(this.currentMap,e,n,r)}getAll(){return kL(this.currentMap)}}function efe(t){let e=lue(t,".fc-scrollgrid-shrink"),n=0;for(let r of e)n=Math.max(n,wue(r));return Math.ceil(n)}function u$(t,e){return t.liquid&&e.liquid}function tfe(t,e){return e.maxHeight!=null||u$(t,e)}function nfe(t,e,n,r){let{expandRows:c}=n;return typeof e.content=="function"?e.content(n):on("table",{role:"presentation",className:[e.tableClassName,t.syncRowHeights?"fc-scrollgrid-sync-table":""].join(" "),style:{minWidth:n.tableMinWidth,width:n.clientWidth,height:c?n.clientHeight:""}},n.tableColGroupNode,on(r?"thead":"tbody",{role:"presentation"},typeof e.rowContent=="function"?e.rowContent(n):e.rowContent))}function ife(t,e){return r0(t,e,Ym)}function rfe(t,e){let n=[];for(let r of t){let c=r.span||1;for(let d=0;d<c;d+=1)n.push(on("col",{style:{width:r.width==="shrink"?sfe(e):r.width||"",minWidth:r.minWidth||""}}))}return on("colgroup",{},...n)}function sfe(t){return t??4}function ofe(t){for(let e of t)if(e.width==="shrink")return!0;return!1}function afe(t,e){let n=["fc-scrollgrid",e.theme.getClass("table")];return t&&n.push("fc-scrollgrid-liquid"),n}function lfe(t,e){let n=["fc-scrollgrid-section",`fc-scrollgrid-section-${t.type}`,t.className];return e&&t.liquid&&t.maxHeight==null&&n.push("fc-scrollgrid-section-liquid"),t.isSticky&&n.push("fc-scrollgrid-section-sticky"),n}function cfe(t){return on("div",{className:"fc-scrollgrid-sticky-shim",style:{width:t.clientWidth,minWidth:t.tableMinWidth}})}function SU(t){let{stickyHeaderDates:e}=t;return(e==null||e==="auto")&&(e=t.height==="auto"||t.viewHeight==="auto"),e}function ufe(t){let{stickyFooterScrollbar:e}=t;return(e==null||e==="auto")&&(e=t.height==="auto"||t.viewHeight==="auto"),e}class h$ extends Vo{constructor(){super(...arguments),this.processCols=Os(e=>e,ife),this.renderMicroColGroup=Os(rfe),this.scrollerRefs=new ax,this.scrollerElRefs=new ax(this._handleScrollerEl.bind(this)),this.state={shrinkWidth:null,forceYScrollbars:!1,scrollerClientWidths:{},scrollerClientHeights:{}},this.handleSizing=()=>{this.safeSetState(Object.assign({shrinkWidth:this.computeShrinkWidth()},this.computeScrollerDims()))}}render(){let{props:e,state:n,context:r}=this,c=e.sections||[],d=this.processCols(e.cols),m=this.renderMicroColGroup(d,n.shrinkWidth),s=afe(e.liquid,r);e.collapsibleWidth&&s.push("fc-scrollgrid-collapsible");let T=c.length,D=0,P,z=[],F=[],$=[];for(;D<T&&(P=c[D]).type==="header";)z.push(this.renderSection(P,m,!0)),D+=1;for(;D<T&&(P=c[D]).type==="body";)F.push(this.renderSection(P,m,!1)),D+=1;for(;D<T&&(P=c[D]).type==="footer";)$.push(this.renderSection(P,m,!0)),D+=1;let J=!JH();const X={role:"rowgroup"};return on("table",{role:"grid",className:s.join(" "),style:{height:e.height}},!!(!J&&z.length)&&on("thead",X,...z),!!(!J&&F.length)&&on("tbody",X,...F),!!(!J&&$.length)&&on("tfoot",X,...$),J&&on("tbody",X,...z,...F,...$))}renderSection(e,n,r){return"outerContent"in e?on(ea,{key:e.key},e.outerContent):on("tr",{key:e.key,role:"presentation",className:lfe(e,this.props.liquid).join(" ")},this.renderChunkTd(e,n,e.chunk,r))}renderChunkTd(e,n,r,c){if("outerContent"in r)return r.outerContent;let{props:d}=this,{forceYScrollbars:m,scrollerClientWidths:s,scrollerClientHeights:T}=this.state,D=tfe(d,e),P=u$(d,e),z=d.liquid?m?"scroll":D?"auto":"hidden":"visible",F=e.key,$=nfe(e,r,{tableColGroupNode:n,tableMinWidth:"",clientWidth:!d.collapsibleWidth&&s[F]!==void 0?s[F]:null,clientHeight:T[F]!==void 0?T[F]:null,expandRows:e.expandRows,syncRowHeights:!1,rowSyncHeights:[],reportRowHeightChange:()=>{}},c);return on(c?"th":"td",{ref:r.elRef,role:"presentation"},on("div",{className:`fc-scroller-harness${P?" fc-scroller-harness-liquid":""}`},on(Jde,{ref:this.scrollerRefs.createRef(F),elRef:this.scrollerElRefs.createRef(F),overflowY:z,overflowX:d.liquid?"hidden":"visible",maxHeight:e.maxHeight,liquid:P,liquidIsAbsolute:!0},$)))}_handleScrollerEl(e,n){let r=hfe(this.props.sections,n);r&&M_(r.chunk.scrollerElRef,e)}componentDidMount(){this.handleSizing(),this.context.addResizeHandler(this.handleSizing)}componentDidUpdate(){this.handleSizing()}componentWillUnmount(){this.context.removeResizeHandler(this.handleSizing)}computeShrinkWidth(){return ofe(this.props.cols)?efe(this.scrollerElRefs.getAll()):0}computeScrollerDims(){let e=Rde(),{scrollerRefs:n,scrollerElRefs:r}=this,c=!1,d={},m={};for(let s in n.currentMap){let T=n.currentMap[s];if(T&&T.needsYScrolling()){c=!0;break}}for(let s of this.props.sections){let T=s.key,D=r.currentMap[T];if(D){let P=D.parentNode;d[T]=Math.floor(P.getBoundingClientRect().width-(c?e.y:0)),m[T]=Math.floor(P.getBoundingClientRect().height)}}return{forceYScrollbars:c,scrollerClientWidths:d,scrollerClientHeights:m}}}h$.addStateEquality({scrollerClientWidths:Ym,scrollerClientHeights:Ym});function hfe(t,e){for(let n of t)if(n.key===e)return n;return null}class YL extends Vo{constructor(){super(...arguments),this.handleEl=e=>{this.el=e,e&&xU(e,this.props.seg)}}render(){const{props:e,context:n}=this,{options:r}=n,{seg:c}=e,{eventRange:d}=c,{ui:m}=d,s={event:new Io(n,d.def,d.instance),view:n.viewApi,timeText:e.timeText,textColor:m.textColor,backgroundColor:m.backgroundColor,borderColor:m.borderColor,isDraggable:!e.disableDragging&&nde(c,n),isStartResizable:!e.disableResizing&&ide(c,n),isEndResizable:!e.disableResizing&&rde(c),isMirror:!!(e.isDragging||e.isResizing||e.isDateSelecting),isStart:!!c.isStart,isEnd:!!c.isEnd,isPast:!!e.isPast,isFuture:!!e.isFuture,isToday:!!e.isToday,isSelected:!!e.isSelected,isDragging:!!e.isDragging,isResizing:!!e.isResizing};return on(z_,Object.assign({},e,{elRef:this.handleEl,elClasses:[...sde(s),...c.eventRange.ui.classNames,...e.elClasses||[]],renderProps:s,generatorName:"eventContent",customGenerator:r.eventContent,defaultGenerator:e.defaultGenerator,classNameGenerator:r.eventClassNames,didMount:r.eventDidMount,willUnmount:r.eventWillUnmount}))}componentDidUpdate(e){this.el&&this.props.seg!==e.seg&&xU(this.el,this.props.seg)}}class dfe extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,{seg:c}=e,{ui:d}=c.eventRange,m=r.eventTimeFormat||e.defaultTimeFormat,s=ZH(c,m,n,e.defaultDisplayEventTime,e.defaultDisplayEventEnd);return on(YL,Object.assign({},e,{elTag:"a",elStyle:{borderColor:d.borderColor,backgroundColor:d.backgroundColor},elAttrs:XH(c,n),defaultGenerator:ffe,timeText:s}),(T,D)=>on(ea,null,on(T,{elTag:"div",elClasses:["fc-event-main"],elStyle:{color:D.textColor}}),!!D.isStartResizable&&on("div",{className:"fc-event-resizer fc-event-resizer-start"}),!!D.isEndResizable&&on("div",{className:"fc-event-resizer fc-event-resizer-end"})))}}function ffe(t){return on("div",{className:"fc-event-main-frame"},t.timeText&&on("div",{className:"fc-event-time"},t.timeText),on("div",{className:"fc-event-title-container"},on("div",{className:"fc-event-title fc-sticky"},t.event.title||on(ea,null," "))))}const pfe=Cl({day:"numeric"});class d$ extends Vo{constructor(){super(...arguments),this.refineRenderProps=oO(mfe)}render(){let{props:e,context:n}=this,{options:r}=n,c=this.refineRenderProps({date:e.date,dateProfile:e.dateProfile,todayRange:e.todayRange,isMonthStart:e.isMonthStart||!1,showDayNumber:e.showDayNumber,extraRenderProps:e.extraRenderProps,viewApi:n.viewApi,dateEnv:n.dateEnv,monthStartFormat:r.monthStartFormat});return on(z_,Object.assign({},e,{elClasses:[...$L(c,n.theme),...e.elClasses||[]],elAttrs:Object.assign(Object.assign({},e.elAttrs),c.isDisabled?{}:{"data-date":OL(e.date)}),renderProps:c,generatorName:"dayCellContent",customGenerator:r.dayCellContent,defaultGenerator:e.defaultGenerator,classNameGenerator:c.isDisabled?void 0:r.dayCellClassNames,didMount:r.dayCellDidMount,willUnmount:r.dayCellWillUnmount}))}}function f$(t){return!!(t.dayCellContent||wN("dayCellContent",t))}function mfe(t){let{date:e,dateEnv:n,dateProfile:r,isMonthStart:c}=t,d=t$(e,t.todayRange,null,r),m=t.showDayNumber?n.format(e,c?t.monthStartFormat:pfe):"";return Object.assign(Object.assign(Object.assign({date:n.toDate(e),view:t.viewApi},d),{isMonthStart:c,dayNumberText:m}),t.extraRenderProps)}class gfe extends Vo{render(){let{props:e}=this,{seg:n}=e;return on(YL,{elTag:"div",elClasses:["fc-bg-event"],elStyle:{backgroundColor:n.eventRange.ui.backgroundColor},defaultGenerator:_fe,seg:n,timeText:"",isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:!1,isPast:e.isPast,isFuture:e.isFuture,isToday:e.isToday,disableDragging:!0,disableResizing:!0})}}function _fe(t){let{title:e}=t.event;return e&&on("div",{className:"fc-event-title"},t.event.title)}function yfe(t){return on("div",{className:`fc-${t}`})}const vfe=t=>on(Nx.Consumer,null,e=>{let{dateEnv:n,options:r}=e,{date:c}=t,d=r.weekNumberFormat||t.defaultFormat,m=n.computeWeekNumber(c),s=n.format(c,d);return on(z_,Object.assign({},t,{renderProps:{num:m,text:s,date:c},generatorName:"weekNumberContent",customGenerator:r.weekNumberContent,defaultGenerator:bfe,classNameGenerator:r.weekNumberClassNames,didMount:r.weekNumberDidMount,willUnmount:r.weekNumberWillUnmount}))});function bfe(t){return t.text}const ok=10;class xfe extends Vo{constructor(){super(...arguments),this.state={titleId:dM()},this.handleRootEl=e=>{this.rootEl=e,this.props.elRef&&M_(this.props.elRef,e)},this.handleDocumentMouseDown=e=>{const n=SH(e);this.rootEl.contains(n)||this.handleCloseClick()},this.handleDocumentKeyDown=e=>{e.key==="Escape"&&this.handleCloseClick()},this.handleCloseClick=()=>{let{onClose:e}=this.props;e&&e()}}render(){let{theme:e,options:n}=this.context,{props:r,state:c}=this,d=["fc-popover",e.getClass("popover")].concat(r.extraClassNames||[]);return Yce(on("div",Object.assign({},r.extraAttrs,{id:r.id,className:d.join(" "),"aria-labelledby":c.titleId,ref:this.handleRootEl}),on("div",{className:"fc-popover-header "+e.getClass("popoverHeader")},on("span",{className:"fc-popover-title",id:c.titleId},r.title),on("span",{className:"fc-popover-close "+e.getIconClass("close"),title:n.closeHint,onClick:this.handleCloseClick})),on("div",{className:"fc-popover-body "+e.getClass("popoverContent")},r.children)),r.parentEl)}componentDidMount(){document.addEventListener("mousedown",this.handleDocumentMouseDown),document.addEventListener("keydown",this.handleDocumentKeyDown),this.updateSize()}componentWillUnmount(){document.removeEventListener("mousedown",this.handleDocumentMouseDown),document.removeEventListener("keydown",this.handleDocumentKeyDown)}updateSize(){let{isRtl:e}=this.context,{alignmentEl:n,alignGridTop:r}=this.props,{rootEl:c}=this,d=Pde(n);if(d){let m=c.getBoundingClientRect(),s=r?zc(n,".fc-scrollgrid").getBoundingClientRect().top:d.top,T=e?d.right-m.width:d.left;s=Math.max(s,ok),T=Math.min(T,document.documentElement.clientWidth-ok-m.width),T=Math.max(T,ok);let D=c.offsetParent.getBoundingClientRect();ZS(c,{top:s-D.top,left:T-D.left})}}}class wfe extends zx{constructor(){super(...arguments),this.handleRootEl=e=>{this.rootEl=e,e?this.context.registerInteractiveComponent(this,{el:e,useEventCenter:!1}):this.context.unregisterInteractiveComponent(this)}}render(){let{options:e,dateEnv:n}=this.context,{props:r}=this,{startDate:c,todayRange:d,dateProfile:m}=r,s=n.format(c,e.dayPopoverFormat);return on(d$,{elRef:this.handleRootEl,date:c,dateProfile:m,todayRange:d},(T,D,P)=>on(xfe,{elRef:P.ref,id:r.id,title:s,extraClassNames:["fc-more-popover"].concat(P.className||[]),extraAttrs:P,parentEl:r.parentEl,alignmentEl:r.alignmentEl,alignGridTop:r.alignGridTop,onClose:r.onClose},f$(e)&&on(T,{elTag:"div",elClasses:["fc-more-popover-misc"]}),r.children))}queryHit(e,n,r,c){let{rootEl:d,props:m}=this;return e>=0&&e<r&&n>=0&&n<c?{dateProfile:m.dateProfile,dateSpan:Object.assign({allDay:!m.forceTimed,range:{start:m.startDate,end:m.endDate}},m.extraDateSpan),dayEl:d,rect:{left:0,top:0,right:r,bottom:c},layer:1}:null}}class Tfe extends Vo{constructor(){super(...arguments),this.state={isPopoverOpen:!1,popoverId:dM()},this.handleLinkEl=e=>{this.linkEl=e,this.props.elRef&&M_(this.props.elRef,e)},this.handleClick=e=>{let{props:n,context:r}=this,{moreLinkClick:c}=r.options,d=AU(n).start;function m(s){let{def:T,instance:D,range:P}=s.eventRange;return{event:new Io(r,T,D),start:r.dateEnv.toDate(P.start),end:r.dateEnv.toDate(P.end),isStart:s.isStart,isEnd:s.isEnd}}typeof c=="function"&&(c=c({date:d,allDay:!!n.allDayDate,allSegs:n.allSegs.map(m),hiddenSegs:n.hiddenSegs.map(m),jsEvent:e,view:r.viewApi})),!c||c==="popover"?this.setState({isPopoverOpen:!0}):typeof c=="string"&&r.calendarApi.zoomTo(d,c)},this.handlePopoverClose=()=>{this.setState({isPopoverOpen:!1})}}render(){let{props:e,state:n}=this;return on(Nx.Consumer,null,r=>{let{viewApi:c,options:d,calendarApi:m}=r,{moreLinkText:s}=d,{moreCnt:T}=e,D=AU(e),P=typeof s=="function"?s.call(m,T):`+${T} ${s}`,z=XS(d.moreLinkHint,[T],P),F={num:T,shortText:`+${T}`,text:P,view:c};return on(ea,null,!!e.moreCnt&&on(z_,{elTag:e.elTag||"a",elRef:this.handleLinkEl,elClasses:[...e.elClasses||[],"fc-more-link"],elStyle:e.elStyle,elAttrs:Object.assign(Object.assign(Object.assign({},e.elAttrs),CH(this.handleClick)),{title:z,"aria-expanded":n.isPopoverOpen,"aria-controls":n.isPopoverOpen?n.popoverId:""}),renderProps:F,generatorName:"moreLinkContent",customGenerator:d.moreLinkContent,defaultGenerator:e.defaultGenerator||Efe,classNameGenerator:d.moreLinkClassNames,didMount:d.moreLinkDidMount,willUnmount:d.moreLinkWillUnmount},e.children),n.isPopoverOpen&&on(wfe,{id:n.popoverId,startDate:D.start,endDate:D.end,dateProfile:e.dateProfile,todayRange:e.todayRange,extraDateSpan:e.extraDateSpan,parentEl:this.parentEl,alignmentEl:e.alignmentElRef?e.alignmentElRef.current:this.linkEl,alignGridTop:e.alignGridTop,forceTimed:e.forceTimed,onClose:this.handlePopoverClose},e.popoverContent()))})}componentDidMount(){this.updateParentEl()}componentDidUpdate(){this.updateParentEl()}updateParentEl(){this.linkEl&&(this.parentEl=zc(this.linkEl,".fc-view-harness"))}}function Efe(t){return t.text}function AU(t){if(t.allDayDate)return{start:t.allDayDate,end:Uc(t.allDayDate,1)};let{hiddenSegs:e}=t;return{start:Sfe(e),end:Cfe(e)}}function Sfe(t){return t.reduce(Afe).eventRange.range.start}function Afe(t,e){return t.eventRange.range.start<e.eventRange.range.start?t:e}function Cfe(t){return t.reduce(Dfe).eventRange.range.end}function Dfe(t,e){return t.eventRange.range.end>e.eventRange.range.end?t:e}class Rfe{constructor(){this.handlers=[]}set(e){this.currentValue=e;for(let n of this.handlers)n(e)}subscribe(e){this.handlers.push(e),this.currentValue!==void 0&&e(this.currentValue)}}class Ofe extends Rfe{constructor(){super(...arguments),this.map=new Map}handle(e){const{map:n}=this;let r=!1;e.isActive?(n.set(e.id,e),r=!0):n.has(e.id)&&(n.delete(e.id),r=!0),r&&this.set(n)}}const Ife=[],p$={code:"en",week:{dow:0,doy:4},direction:"ltr",buttonText:{prev:"prev",next:"next",prevYear:"prev year",nextYear:"next year",year:"year",today:"today",month:"month",week:"week",day:"day",list:"list"},weekText:"W",weekTextLong:"Week",closeHint:"Close",timeHint:"Time",eventHint:"Event",allDayText:"all-day",moreLinkText:"more",noEventsText:"No events to display"},m$=Object.assign(Object.assign({},p$),{buttonHints:{prev:"Previous $0",next:"Next $0",today(t,e){return e==="day"?"Today":`This ${t}`}},viewHint:"$0 view",navLinkHint:"Go to $0",moreLinkHint(t){return`Show ${t} more event${t===1?"":"s"}`}});function Mfe(t){let e=t.length>0?t[0].code:"en",n=Ife.concat(t),r={en:m$};for(let c of n)r[c.code]=c;return{map:r,defaultCode:e}}function g$(t,e){return typeof t=="object"&&!Array.isArray(t)?_$(t.code,[t.code],t):Pfe(t,e)}function Pfe(t,e){let n=[].concat(t||[]),r=kfe(n,e)||m$;return _$(t,n,r)}function kfe(t,e){for(let n=0;n<t.length;n+=1){let r=t[n].toLocaleLowerCase().split("-");for(let c=r.length;c>0;c-=1){let d=r.slice(0,c).join("-");if(e[d])return e[d]}}return null}function _$(t,e,n){let r=PL([p$,n],["buttonText"]);delete r.code;let{week:c}=r;return delete r.week,{codeArg:t,codes:e,week:c,simpleNumberFormat:new Intl.NumberFormat(t),options:r}}function h0(t){return{id:Px(),name:t.name,premiumReleaseDate:t.premiumReleaseDate?new Date(t.premiumReleaseDate):void 0,deps:t.deps||[],reducers:t.reducers||[],isLoadingFuncs:t.isLoadingFuncs||[],contextInit:[].concat(t.contextInit||[]),eventRefiners:t.eventRefiners||{},eventDefMemberAdders:t.eventDefMemberAdders||[],eventSourceRefiners:t.eventSourceRefiners||{},isDraggableTransformers:t.isDraggableTransformers||[],eventDragMutationMassagers:t.eventDragMutationMassagers||[],eventDefMutationAppliers:t.eventDefMutationAppliers||[],dateSelectionTransformers:t.dateSelectionTransformers||[],datePointTransforms:t.datePointTransforms||[],dateSpanTransforms:t.dateSpanTransforms||[],views:t.views||{},viewPropsTransformers:t.viewPropsTransformers||[],isPropsValid:t.isPropsValid||null,externalDefTransforms:t.externalDefTransforms||[],viewContainerAppends:t.viewContainerAppends||[],eventDropTransformers:t.eventDropTransformers||[],componentInteractions:t.componentInteractions||[],calendarInteractions:t.calendarInteractions||[],themeClasses:t.themeClasses||{},eventSourceDefs:t.eventSourceDefs||[],cmdFormatter:t.cmdFormatter,recurringTypes:t.recurringTypes||[],namedTimeZonedImpl:t.namedTimeZonedImpl,initialView:t.initialView||"",elementDraggingImpl:t.elementDraggingImpl,optionChangeHandlers:t.optionChangeHandlers||{},scrollGridImpl:t.scrollGridImpl||null,listenerRefiners:t.listenerRefiners||{},optionRefiners:t.optionRefiners||{},propSetHandlers:t.propSetHandlers||{}}}function Nfe(t,e){let n={},r={premiumReleaseDate:void 0,reducers:[],isLoadingFuncs:[],contextInit:[],eventRefiners:{},eventDefMemberAdders:[],eventSourceRefiners:{},isDraggableTransformers:[],eventDragMutationMassagers:[],eventDefMutationAppliers:[],dateSelectionTransformers:[],datePointTransforms:[],dateSpanTransforms:[],views:{},viewPropsTransformers:[],isPropsValid:null,externalDefTransforms:[],viewContainerAppends:[],eventDropTransformers:[],componentInteractions:[],calendarInteractions:[],themeClasses:{},eventSourceDefs:[],cmdFormatter:null,recurringTypes:[],namedTimeZonedImpl:null,initialView:"",elementDraggingImpl:null,optionChangeHandlers:{},scrollGridImpl:null,listenerRefiners:{},optionRefiners:{},propSetHandlers:{}};function c(d){for(let m of d){const s=m.name,T=n[s];T===void 0?(n[s]=m.id,c(m.deps),r=zfe(r,m)):T!==m.id&&console.warn(`Duplicate plugin '${s}'`)}}return t&&c(t),c(e),r}function Lfe(){let t=[],e=[],n;return(r,c)=>((!n||!r0(r,t)||!r0(c,e))&&(n=Nfe(r,c)),t=r,e=c,n)}function zfe(t,e){return{premiumReleaseDate:Bfe(t.premiumReleaseDate,e.premiumReleaseDate),reducers:t.reducers.concat(e.reducers),isLoadingFuncs:t.isLoadingFuncs.concat(e.isLoadingFuncs),contextInit:t.contextInit.concat(e.contextInit),eventRefiners:Object.assign(Object.assign({},t.eventRefiners),e.eventRefiners),eventDefMemberAdders:t.eventDefMemberAdders.concat(e.eventDefMemberAdders),eventSourceRefiners:Object.assign(Object.assign({},t.eventSourceRefiners),e.eventSourceRefiners),isDraggableTransformers:t.isDraggableTransformers.concat(e.isDraggableTransformers),eventDragMutationMassagers:t.eventDragMutationMassagers.concat(e.eventDragMutationMassagers),eventDefMutationAppliers:t.eventDefMutationAppliers.concat(e.eventDefMutationAppliers),dateSelectionTransformers:t.dateSelectionTransformers.concat(e.dateSelectionTransformers),datePointTransforms:t.datePointTransforms.concat(e.datePointTransforms),dateSpanTransforms:t.dateSpanTransforms.concat(e.dateSpanTransforms),views:Object.assign(Object.assign({},t.views),e.views),viewPropsTransformers:t.viewPropsTransformers.concat(e.viewPropsTransformers),isPropsValid:e.isPropsValid||t.isPropsValid,externalDefTransforms:t.externalDefTransforms.concat(e.externalDefTransforms),viewContainerAppends:t.viewContainerAppends.concat(e.viewContainerAppends),eventDropTransformers:t.eventDropTransformers.concat(e.eventDropTransformers),calendarInteractions:t.calendarInteractions.concat(e.calendarInteractions),componentInteractions:t.componentInteractions.concat(e.componentInteractions),themeClasses:Object.assign(Object.assign({},t.themeClasses),e.themeClasses),eventSourceDefs:t.eventSourceDefs.concat(e.eventSourceDefs),cmdFormatter:e.cmdFormatter||t.cmdFormatter,recurringTypes:t.recurringTypes.concat(e.recurringTypes),namedTimeZonedImpl:e.namedTimeZonedImpl||t.namedTimeZonedImpl,initialView:t.initialView||e.initialView,elementDraggingImpl:t.elementDraggingImpl||e.elementDraggingImpl,optionChangeHandlers:Object.assign(Object.assign({},t.optionChangeHandlers),e.optionChangeHandlers),scrollGridImpl:e.scrollGridImpl||t.scrollGridImpl,listenerRefiners:Object.assign(Object.assign({},t.listenerRefiners),e.listenerRefiners),optionRefiners:Object.assign(Object.assign({},t.optionRefiners),e.optionRefiners),propSetHandlers:Object.assign(Object.assign({},t.propSetHandlers),e.propSetHandlers)}}function Bfe(t,e){return t===void 0?e:e===void 0?t:new Date(Math.max(t.valueOf(),e.valueOf()))}class d0 extends nC{}d0.prototype.classes={root:"fc-theme-standard",tableCellShaded:"fc-cell-shaded",buttonGroup:"fc-button-group",button:"fc-button fc-button-primary",buttonActive:"fc-button-active"};d0.prototype.baseIconClass="fc-icon";d0.prototype.iconClasses={close:"fc-icon-x",prev:"fc-icon-chevron-left",next:"fc-icon-chevron-right",prevYear:"fc-icon-chevrons-left",nextYear:"fc-icon-chevrons-right"};d0.prototype.rtlIconClasses={prev:"fc-icon-chevron-right",next:"fc-icon-chevron-left",prevYear:"fc-icon-chevrons-right",nextYear:"fc-icon-chevrons-left"};d0.prototype.iconOverrideOption="buttonIcons";d0.prototype.iconOverrideCustomButtonOption="icon";d0.prototype.iconOverridePrefix="fc-icon-";function Ffe(t,e){let n={},r;for(r in t)CN(r,n,t,e);for(r in e)CN(r,n,t,e);return n}function CN(t,e,n,r){if(e[t])return e[t];let c=Vfe(t,e,n,r);return c&&(e[t]=c),c}function Vfe(t,e,n,r){let c=n[t],d=r[t],m=P=>c&&c[P]!==null?c[P]:d&&d[P]!==null?d[P]:null,s=m("component"),T=m("superType"),D=null;if(T){if(T===t)throw new Error("Can't have a custom view type that references itself");D=CN(T,e,n,r)}return!s&&D&&(s=D.component),s?{type:t,component:s,defaults:Object.assign(Object.assign({},D?D.defaults:{}),c?c.rawOptions:{}),overrides:Object.assign(Object.assign({},D?D.overrides:{}),d?d.rawOptions:{})}:null}function CU(t){return kx(t,Ufe)}function Ufe(t){let e=typeof t=="function"?{component:t}:t,{component:n}=e;return e.content?n=DU(e):n&&!(n.prototype instanceof Vo)&&(n=DU(Object.assign(Object.assign({},e),{content:n}))),{superType:e.type,component:n,rawOptions:e}}function DU(t){return e=>on(Nx.Consumer,null,n=>on(z_,{elTag:"div",elClasses:NH(n.viewSpec),renderProps:Object.assign(Object.assign({},e),{nextDayThreshold:n.options.nextDayThreshold}),generatorName:void 0,customGenerator:t.content,classNameGenerator:t.classNames,didMount:t.didMount,willUnmount:t.willUnmount}))}function jfe(t,e,n,r){let c=CU(t),d=CU(e.views),m=Ffe(c,d);return kx(m,s=>Hfe(s,d,e,n,r))}function Hfe(t,e,n,r,c){let d=t.overrides.duration||t.defaults.duration||r.duration||n.duration,m=null,s="",T="",D={};if(d&&(m=$fe(d),m)){let F=bN(m);s=F.unit,F.value===1&&(T=s,D=e[s]?e[s].rawOptions:{})}let P=F=>{let $=F.buttonText||{},J=t.defaults.buttonTextKey;return J!=null&&$[J]!=null?$[J]:$[t.type]!=null?$[t.type]:$[T]!=null?$[T]:null},z=F=>{let $=F.buttonHints||{},J=t.defaults.buttonTextKey;return J!=null&&$[J]!=null?$[J]:$[t.type]!=null?$[t.type]:$[T]!=null?$[T]:null};return{type:t.type,component:t.component,duration:m,durationUnit:s,singleUnit:T,optionDefaults:t.defaults,optionOverrides:Object.assign(Object.assign({},D),t.overrides),buttonTextOverride:P(r)||P(n)||t.overrides.buttonText,buttonTextDefault:P(c)||t.defaults.buttonText||P(QS)||t.type,buttonTitleOverride:z(r)||z(n)||t.overrides.buttonHint,buttonTitleDefault:z(c)||t.defaults.buttonHint||z(QS)}}let RU={};function $fe(t){let e=JSON.stringify(t),n=RU[e];return n===void 0&&(n=Rs(t),RU[e]=n),n}function Gfe(t,e){switch(e.type){case"CHANGE_VIEW_TYPE":t=e.viewType}return t}function qfe(t,e){switch(e.type){case"CHANGE_DATE":return e.dateMarker;default:return t}}function Wfe(t,e,n){let r=t.initialDate;return r!=null?e.createMarker(r):n.getDateMarker()}function Yfe(t,e){switch(e.type){case"SET_OPTION":return Object.assign(Object.assign({},t),{[e.optionName]:e.rawOptionValue});default:return t}}function Zfe(t,e,n,r){let c;switch(e.type){case"CHANGE_VIEW_TYPE":return r.build(e.dateMarker||n);case"CHANGE_DATE":return r.build(e.dateMarker);case"PREV":if(c=r.buildPrev(t,n),c.isValid)return c;break;case"NEXT":if(c=r.buildNext(t,n),c.isValid)return c;break}return t}function Xfe(t,e,n){let r=e?e.activeRange:null;return v$({},ipe(t,n),r,n)}function Qfe(t,e,n,r){let c=n?n.activeRange:null;switch(e.type){case"ADD_EVENT_SOURCES":return v$(t,e.sources,c,r);case"REMOVE_EVENT_SOURCE":return Jfe(t,e.sourceId);case"PREV":case"NEXT":case"CHANGE_DATE":case"CHANGE_VIEW_TYPE":return n?b$(t,c,r):t;case"FETCH_EVENT_SOURCES":return ZL(t,e.sourceIds?OH(e.sourceIds):x$(t,r),c,e.isRefetch||!1,r);case"RECEIVE_EVENTS":case"RECEIVE_EVENT_ERROR":return npe(t,e.sourceId,e.fetchId,e.fetchRange);case"REMOVE_ALL_EVENT_SOURCES":return{};default:return t}}function Kfe(t,e,n){let r=e?e.activeRange:null;return ZL(t,x$(t,n),r,!0,n)}function y$(t){for(let e in t)if(t[e].isFetching)return!0;return!1}function v$(t,e,n,r){let c={};for(let d of e)c[d.sourceId]=d;return n&&(c=b$(c,n,r)),Object.assign(Object.assign({},t),c)}function Jfe(t,e){return Sx(t,n=>n.sourceId!==e)}function b$(t,e,n){return ZL(t,Sx(t,r=>epe(r,e,n)),e,!1,n)}function epe(t,e,n){return w$(t,n)?!n.options.lazyFetching||!t.fetchRange||t.isFetching||e.start<t.fetchRange.start||e.end>t.fetchRange.end:!t.latestFetchId}function ZL(t,e,n,r,c){let d={};for(let m in t){let s=t[m];e[m]?d[m]=tpe(s,n,r,c):d[m]=s}return d}function tpe(t,e,n,r){let{options:c,calendarApi:d}=r,m=r.pluginHooks.eventSourceDefs[t.sourceDefId],s=Px();return m.fetch({eventSource:t,range:e,isRefetch:n,context:r},T=>{let{rawEvents:D}=T;c.eventSourceSuccess&&(D=c.eventSourceSuccess.call(d,D,T.response)||D),t.success&&(D=t.success.call(d,D,T.response)||D),r.dispatch({type:"RECEIVE_EVENTS",sourceId:t.sourceId,fetchId:s,fetchRange:e,rawEvents:D})},T=>{let D=!1;c.eventSourceFailure&&(c.eventSourceFailure.call(d,T),D=!0),t.failure&&(t.failure(T),D=!0),D||console.warn(T.message,T),r.dispatch({type:"RECEIVE_EVENT_ERROR",sourceId:t.sourceId,fetchId:s,fetchRange:e,error:T})}),Object.assign(Object.assign({},t),{isFetching:!0,latestFetchId:s})}function npe(t,e,n,r){let c=t[e];return c&&n===c.latestFetchId?Object.assign(Object.assign({},t),{[e]:Object.assign(Object.assign({},c),{isFetching:!1,fetchRange:r})}):t}function x$(t,e){return Sx(t,n=>w$(n,e))}function ipe(t,e){let n=HH(e),r=[].concat(t.eventSources||[]),c=[];t.initialEvents&&r.unshift(t.initialEvents),t.events&&r.unshift(t.events);for(let d of r){let m=jH(d,e,n);m&&c.push(m)}return c}function w$(t,e){return!e.pluginHooks.eventSourceDefs[t.sourceDefId].ignoreRange}function rpe(t,e){switch(e.type){case"UNSELECT_DATES":return null;case"SELECT_DATES":return e.selection;default:return t}}function spe(t,e){switch(e.type){case"UNSELECT_EVENT":return"";case"SELECT_EVENT":return e.eventInstanceId;default:return t}}function ope(t,e){let n;switch(e.type){case"UNSET_EVENT_DRAG":return null;case"SET_EVENT_DRAG":return n=e.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return t}}function ape(t,e){let n;switch(e.type){case"UNSET_EVENT_RESIZE":return null;case"SET_EVENT_RESIZE":return n=e.state,{affectedEvents:n.affectedEvents,mutatedEvents:n.mutatedEvents,isEvent:n.isEvent};default:return t}}function lpe(t,e,n,r,c){let d=t.headerToolbar?OU(t.headerToolbar,t,e,n,r,c):null,m=t.footerToolbar?OU(t.footerToolbar,t,e,n,r,c):null;return{header:d,footer:m}}function OU(t,e,n,r,c,d){let m={},s=[],T=!1;for(let D in t){let P=t[D],z=cpe(P,e,n,r,c,d);m[D]=z.widgets,s.push(...z.viewsWithButtons),T=T||z.hasTitle}return{sectionWidgets:m,viewsWithButtons:s,hasTitle:T}}function cpe(t,e,n,r,c,d){let m=e.direction==="rtl",s=e.customButtons||{},T=n.buttonText||{},D=e.buttonText||{},P=n.buttonHints||{},z=e.buttonHints||{},F=t?t.split(" "):[],$=[],J=!1;return{widgets:F.map(te=>te.split(",").map(ie=>{if(ie==="title")return J=!0,{buttonName:ie};let we,Ie,Re,Ne,Xe,be;if(we=s[ie])Re=_e=>{we.click&&we.click.call(_e.target,_e,_e.target)},(Ne=r.getCustomButtonIconClass(we))||(Ne=r.getIconClass(ie,m))||(Xe=we.text),be=we.hint||we.text;else if(Ie=c[ie]){$.push(ie),Re=()=>{d.changeView(ie)},(Xe=Ie.buttonTextOverride)||(Ne=r.getIconClass(ie,m))||(Xe=Ie.buttonTextDefault);let _e=Ie.buttonTextOverride||Ie.buttonTextDefault;be=XS(Ie.buttonTitleOverride||Ie.buttonTitleDefault||e.viewHint,[_e,ie],_e)}else if(d[ie])if(Re=()=>{d[ie]()},(Xe=T[ie])||(Ne=r.getIconClass(ie,m))||(Xe=D[ie]),ie==="prevYear"||ie==="nextYear"){let _e=ie==="prevYear"?"prev":"next";be=XS(P[_e]||z[_e],[D.year||"year","year"],D[ie])}else be=_e=>XS(P[ie]||z[ie],[D[_e]||_e,_e],D[ie]);return{buttonName:ie,buttonClick:Re,buttonIcon:Ne,buttonText:Xe,buttonHint:be}})),viewsWithButtons:$,hasTitle:J}}class upe{constructor(e,n,r){this.type=e,this.getCurrentData=n,this.dateEnv=r}get calendar(){return this.getCurrentData().calendarApi}get title(){return this.getCurrentData().viewTitle}get activeStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.start)}get activeEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.activeRange.end)}get currentStart(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.start)}get currentEnd(){return this.dateEnv.toDate(this.getCurrentData().dateProfile.currentRange.end)}getOption(e){return this.getCurrentData().options[e]}}let hpe={ignoreRange:!0,parseMeta(t){return Array.isArray(t.events)?t.events:null},fetch(t,e){e({rawEvents:t.eventSource.meta})}};const dpe=h0({name:"array-event-source",eventSourceDefs:[hpe]});let fpe={parseMeta(t){return typeof t.events=="function"?t.events:null},fetch(t,e,n){const{dateEnv:r}=t.context,c=t.eventSource.meta;pde(c.bind(null,QH(t.range,r)),d=>e({rawEvents:d}),n)}};const ppe=h0({name:"func-event-source",eventSourceDefs:[fpe]}),mpe={method:String,extraParams:nn,startParam:String,endParam:String,timeZoneParam:String};let gpe={parseMeta(t){return t.url&&(t.format==="json"||!t.format)?{url:t.url,format:"json",method:(t.method||"GET").toUpperCase(),extraParams:t.extraParams,startParam:t.startParam,endParam:t.endParam,timeZoneParam:t.timeZoneParam}:null},fetch(t,e,n){const{meta:r}=t.eventSource,c=ype(r,t.range,t.context);mde(r.method,r.url,c).then(([d,m])=>{e({rawEvents:d,response:m})},n)}};const _pe=h0({name:"json-event-source",eventSourceRefiners:mpe,eventSourceDefs:[gpe]});function ype(t,e,n){let{dateEnv:r,options:c}=n,d,m,s,T,D={};return d=t.startParam,d==null&&(d=c.startParam),m=t.endParam,m==null&&(m=c.endParam),s=t.timeZoneParam,s==null&&(s=c.timeZoneParam),typeof t.extraParams=="function"?T=t.extraParams():T=t.extraParams||{},Object.assign(D,T),D[d]=r.formatIso(e.start),D[m]=r.formatIso(e.end),r.timeZone!=="local"&&(D[s]=r.timeZone),D}const vpe={daysOfWeek:nn,startTime:Rs,endTime:Rs,duration:Rs,startRecur:nn,endRecur:nn};let bpe={parse(t,e){if(t.daysOfWeek||t.startTime||t.endTime||t.startRecur||t.endRecur){let n={daysOfWeek:t.daysOfWeek||null,startTime:t.startTime||null,endTime:t.endTime||null,startRecur:t.startRecur?e.createMarker(t.startRecur):null,endRecur:t.endRecur?e.createMarker(t.endRecur):null,dateEnv:e},r;return t.duration&&(r=t.duration),!r&&t.startTime&&t.endTime&&(r=Aue(t.endTime,t.startTime)),{allDayGuess:!t.startTime&&!t.endTime,duration:r,typeData:n}}return null},expand(t,e,n){let r=cT(e,{start:t.startRecur,end:t.endRecur});return r?wpe(t.daysOfWeek,t.startTime,t.dateEnv,n,r):[]}};const xpe=h0({name:"simple-recurring-event",recurringTypes:[bpe],eventRefiners:vpe});function wpe(t,e,n,r,c){let d=t?OH(t):null,m=Oo(c.start),s=c.end,T=[];for(;m<s;){let D;(!d||d[m.getUTCDay()])&&(e?D=r.add(m,e):D=m,T.push(r.createMarker(n.toDate(D)))),m=Uc(m,1)}return T}const Tpe=h0({name:"change-handler",optionChangeHandlers:{events(t,e){IU([t],e)},eventSources:IU}});function IU(t,e){let n=kL(e.getCurrentData().eventSources);if(n.length===1&&t.length===1&&Array.isArray(n[0]._raw)&&Array.isArray(t[0])){e.dispatch({type:"RESET_RAW_EVENTS",sourceId:n[0].sourceId,rawEvents:t[0]});return}let r=[];for(let c of t){let d=!1;for(let m=0;m<n.length;m+=1)if(n[m]._raw===c){n.splice(m,1),d=!0;break}d||r.push(c)}for(let c of n)e.dispatch({type:"REMOVE_EVENT_SOURCE",sourceId:c.sourceId});for(let c of r)e.calendarApi.addEventSource(c)}function Epe(t,e){e.emitter.trigger("datesSet",Object.assign(Object.assign({},QH(t.activeRange,e.dateEnv)),{view:e.viewApi}))}function Spe(t,e){let{emitter:n}=e;n.hasHandlers("eventsSet")&&n.trigger("eventsSet",ux(t,e))}const Ape=[dpe,ppe,_pe,xpe,Tpe,h0({name:"misc",isLoadingFuncs:[t=>y$(t.eventSources)],propSetHandlers:{dateProfile:Epe,eventStore:Spe}})];class Cpe{constructor(e,n){this.runTaskOption=e,this.drainedOption=n,this.queue=[],this.delayedRunner=new AL(this.drain.bind(this))}request(e,n){this.queue.push(e),this.delayedRunner.request(n)}pause(e){this.delayedRunner.pause(e)}resume(e,n){this.delayedRunner.resume(e,n)}drain(){let{queue:e}=this;for(;e.length;){let n=[],r;for(;r=e.shift();)this.runTask(r),n.push(r);this.drained(n)}}runTask(e){this.runTaskOption&&this.runTaskOption(e)}drained(e){this.drainedOption&&this.drainedOption(e)}}function Dpe(t,e,n){let r;return/^(year|month)$/.test(t.currentRangeUnit)?r=t.currentRange:r=t.activeRange,n.formatRange(r.start,r.end,Cl(e.titleFormat||Rpe(t)),{isEndExclusive:t.isRangeAllDay,defaultSeparator:e.titleRangeSeparator})}function Rpe(t){let{currentRangeUnit:e}=t;if(e==="year")return{year:"numeric"};if(e==="month")return{year:"numeric",month:"long"};let n=iI(t.currentRange.start,t.currentRange.end);return n!==null&&n>1?{year:"numeric",month:"short",day:"numeric"}:{year:"numeric",month:"long",day:"numeric"}}class MU{constructor(){this.resetListeners=new Set}handleInput(e,n){const r=this.dateEnv;if(e!==r&&(typeof n=="function"?this.nowFn=n:r||(this.nowAnchorDate=e.toDate(n?e.createMarker(n):e.createNowMarker()),this.nowAnchorQueried=Date.now()),this.dateEnv=e,r))for(const c of this.resetListeners.values())c()}getDateMarker(){return this.nowAnchorDate?this.dateEnv.timestampToMarker(this.nowAnchorDate.valueOf()+(Date.now()-this.nowAnchorQueried)):this.dateEnv.createMarker(this.nowFn())}addResetListener(e){this.resetListeners.add(e)}removeResetListener(e){this.resetListeners.delete(e)}}class Ope{constructor(e){this.computeCurrentViewData=Os(this._computeCurrentViewData),this.organizeRawLocales=Os(Mfe),this.buildLocale=Os(g$),this.buildPluginHooks=Lfe(),this.buildDateEnv=Os(Ipe),this.buildTheme=Os(Mpe),this.parseToolbars=Os(lpe),this.buildViewSpecs=Os(jfe),this.buildDateProfileGenerator=oO(Ppe),this.buildViewApi=Os(kpe),this.buildViewUiProps=oO(zpe),this.buildEventUiBySource=Os(Npe,Ym),this.buildEventUiBases=Os(Lpe),this.parseContextBusinessHours=oO(Bpe),this.buildTitle=Os(Dpe),this.nowManager=new MU,this.emitter=new gM,this.actionRunner=new Cpe(this._handleAction.bind(this),this.updateData.bind(this)),this.currentCalendarOptionsInput={},this.currentCalendarOptionsRefined={},this.currentViewOptionsInput={},this.currentViewOptionsRefined={},this.currentCalendarOptionsRefiners={},this.optionsForRefining=[],this.optionsForHandling=[],this.getCurrentData=()=>this.data,this.dispatch=F=>{this.actionRunner.request(F)},this.props=e,this.actionRunner.pause(),this.nowManager=new MU;let n={},r=this.computeOptionsData(e.optionOverrides,n,e.calendarApi),c=r.calendarOptions.initialView||r.pluginHooks.initialView,d=this.computeCurrentViewData(c,r,e.optionOverrides,n);e.calendarApi.currentDataManager=this,this.emitter.setThisContext(e.calendarApi),this.emitter.setOptions(d.options);let m={nowManager:this.nowManager,dateEnv:r.dateEnv,options:r.calendarOptions,pluginHooks:r.pluginHooks,calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},s=Wfe(r.calendarOptions,r.dateEnv,this.nowManager),T=d.dateProfileGenerator.build(s);Yv(T.activeRange,s)||(s=T.currentRange.start);for(let F of r.pluginHooks.contextInit)F(m);let D=Xfe(r.calendarOptions,T,m),P={dynamicOptionOverrides:n,currentViewType:c,currentDate:s,dateProfile:T,businessHours:this.parseContextBusinessHours(m),eventSources:D,eventUiBases:{},eventStore:gp(),renderableEventStore:gp(),dateSelection:null,eventSelection:"",eventDrag:null,eventResize:null,selectionConfig:this.buildViewUiProps(m).selectionConfig},z=Object.assign(Object.assign({},m),P);for(let F of r.pluginHooks.reducers)Object.assign(P,F(null,null,z));ak(P,m)&&this.emitter.trigger("loading",!0),this.state=P,this.updateData(),this.actionRunner.resume()}resetOptions(e,n){let{props:r}=this;n===void 0?r.optionOverrides=e:(r.optionOverrides=Object.assign(Object.assign({},r.optionOverrides||{}),e),this.optionsForRefining.push(...n)),(n===void 0||n.length)&&this.actionRunner.request({type:"NOTHING"})}_handleAction(e){let{props:n,state:r,emitter:c}=this,d=Yfe(r.dynamicOptionOverrides,e),m=this.computeOptionsData(n.optionOverrides,d,n.calendarApi),s=Gfe(r.currentViewType,e),T=this.computeCurrentViewData(s,m,n.optionOverrides,d);n.calendarApi.currentDataManager=this,c.setThisContext(n.calendarApi),c.setOptions(T.options);let D={nowManager:this.nowManager,dateEnv:m.dateEnv,options:m.calendarOptions,pluginHooks:m.pluginHooks,calendarApi:n.calendarApi,dispatch:this.dispatch,emitter:c,getCurrentData:this.getCurrentData},{currentDate:P,dateProfile:z}=r;this.data&&this.data.dateProfileGenerator!==T.dateProfileGenerator&&(z=T.dateProfileGenerator.build(P)),P=qfe(P,e),z=Zfe(z,e,P,T.dateProfileGenerator),(e.type==="PREV"||e.type==="NEXT"||!Yv(z.currentRange,P))&&(P=z.currentRange.start);let F=Qfe(r.eventSources,e,z,D),$=Vhe(r.eventStore,e,F,z,D),X=y$(F)&&!T.options.progressiveEventRendering&&r.renderableEventStore||$,{eventUiSingleBase:te,selectionConfig:ie}=this.buildViewUiProps(D),we=this.buildEventUiBySource(F),Ie=this.buildEventUiBases(X.defs,te,we),Re={dynamicOptionOverrides:d,currentViewType:s,currentDate:P,dateProfile:z,eventSources:F,eventStore:$,renderableEventStore:X,selectionConfig:ie,eventUiBases:Ie,businessHours:this.parseContextBusinessHours(D),dateSelection:rpe(r.dateSelection,e),eventSelection:spe(r.eventSelection,e),eventDrag:ope(r.eventDrag,e),eventResize:ape(r.eventResize,e)},Ne=Object.assign(Object.assign({},D),Re);for(let _e of m.pluginHooks.reducers)Object.assign(Re,_e(r,e,Ne));let Xe=ak(r,D),be=ak(Re,D);!Xe&&be?c.trigger("loading",!0):Xe&&!be&&c.trigger("loading",!1),this.state=Re,n.onAction&&n.onAction(e)}updateData(){let{props:e,state:n}=this,r=this.data,c=this.computeOptionsData(e.optionOverrides,n.dynamicOptionOverrides,e.calendarApi),d=this.computeCurrentViewData(n.currentViewType,c,e.optionOverrides,n.dynamicOptionOverrides),m=this.data=Object.assign(Object.assign(Object.assign({nowManager:this.nowManager,viewTitle:this.buildTitle(n.dateProfile,d.options,c.dateEnv),calendarApi:e.calendarApi,dispatch:this.dispatch,emitter:this.emitter,getCurrentData:this.getCurrentData},c),d),n),s=c.pluginHooks.optionChangeHandlers,T=r&&r.calendarOptions,D=c.calendarOptions;if(T&&T!==D){T.timeZone!==D.timeZone&&(n.eventSources=m.eventSources=Kfe(m.eventSources,n.dateProfile,m),n.eventStore=m.eventStore=yU(m.eventStore,r.dateEnv,m.dateEnv),n.renderableEventStore=m.renderableEventStore=yU(m.renderableEventStore,r.dateEnv,m.dateEnv));for(let P in s)(this.optionsForHandling.indexOf(P)!==-1||T[P]!==D[P])&&s[P](D[P],m)}this.optionsForHandling=[],e.onData&&e.onData(m)}computeOptionsData(e,n,r){if(!this.optionsForRefining.length&&e===this.stableOptionOverrides&&n===this.stableDynamicOptionOverrides)return this.stableCalendarOptionsData;let{refinedOptions:c,pluginHooks:d,localeDefaults:m,availableLocaleData:s,extra:T}=this.processRawCalendarOptions(e,n);PU(T);let D=this.buildDateEnv(c.timeZone,c.locale,c.weekNumberCalculation,c.firstDay,c.weekText,d,s,c.defaultRangeSeparator),P=this.buildViewSpecs(d.views,this.stableOptionOverrides,this.stableDynamicOptionOverrides,m),z=this.buildTheme(c,d),F=this.parseToolbars(c,this.stableOptionOverrides,z,P,r);return this.stableCalendarOptionsData={calendarOptions:c,pluginHooks:d,dateEnv:D,viewSpecs:P,theme:z,toolbarConfig:F,localeDefaults:m,availableRawLocales:s.map}}processRawCalendarOptions(e,n){let{locales:r,locale:c}=JP([QS,e,n]),d=this.organizeRawLocales(r),m=d.map,s=this.buildLocale(c||d.defaultCode,m).options,T=this.buildPluginHooks(e.plugins||[],Ape),D=this.currentCalendarOptionsRefiners=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hU),dU),fU),T.listenerRefiners),T.optionRefiners),P={},z=JP([QS,s,e,n]),F={},$=this.currentCalendarOptionsInput,J=this.currentCalendarOptionsRefined,X=!1;for(let te in z)this.optionsForRefining.indexOf(te)===-1&&(z[te]===$[te]||ex[te]&&te in $&&ex[te]($[te],z[te]))?F[te]=J[te]:D[te]?(F[te]=D[te](z[te]),X=!0):P[te]=$[te];return X&&(this.currentCalendarOptionsInput=z,this.currentCalendarOptionsRefined=F,this.stableOptionOverrides=e,this.stableDynamicOptionOverrides=n),this.optionsForHandling.push(...this.optionsForRefining),this.optionsForRefining=[],{rawOptions:this.currentCalendarOptionsInput,refinedOptions:this.currentCalendarOptionsRefined,pluginHooks:T,availableLocaleData:d,localeDefaults:s,extra:P}}_computeCurrentViewData(e,n,r,c){let d=n.viewSpecs[e];if(!d)throw new Error(`viewType "${e}" is not available. Please make sure you've loaded all neccessary plugins`);let{refinedOptions:m,extra:s}=this.processRawViewOptions(d,n.pluginHooks,n.localeDefaults,r,c);PU(s),this.nowManager.handleInput(n.dateEnv,m.now);let T=this.buildDateProfileGenerator({dateProfileGeneratorClass:d.optionDefaults.dateProfileGeneratorClass,nowManager:this.nowManager,duration:d.duration,durationUnit:d.durationUnit,usesMinMaxTime:d.optionDefaults.usesMinMaxTime,dateEnv:n.dateEnv,calendarApi:this.props.calendarApi,slotMinTime:m.slotMinTime,slotMaxTime:m.slotMaxTime,showNonCurrentDates:m.showNonCurrentDates,dayCount:m.dayCount,dateAlignment:m.dateAlignment,dateIncrement:m.dateIncrement,hiddenDays:m.hiddenDays,weekends:m.weekends,validRangeInput:m.validRange,visibleRangeInput:m.visibleRange,fixedWeekCount:m.fixedWeekCount}),D=this.buildViewApi(e,this.getCurrentData,n.dateEnv);return{viewSpec:d,options:m,dateProfileGenerator:T,viewApi:D}}processRawViewOptions(e,n,r,c,d){let m=JP([QS,e.optionDefaults,r,c,e.optionOverrides,d]),s=Object.assign(Object.assign(Object.assign(Object.assign(Object.assign(Object.assign({},hU),dU),fU),rhe),n.listenerRefiners),n.optionRefiners),T={},D=this.currentViewOptionsInput,P=this.currentViewOptionsRefined,z=!1,F={};for(let $ in m)m[$]===D[$]||ex[$]&&ex[$](m[$],D[$])?T[$]=P[$]:(m[$]===this.currentCalendarOptionsInput[$]||ex[$]&&ex[$](m[$],this.currentCalendarOptionsInput[$])?$ in this.currentCalendarOptionsRefined&&(T[$]=this.currentCalendarOptionsRefined[$]):s[$]?T[$]=s[$](m[$]):F[$]=m[$],z=!0);return z&&(this.currentViewOptionsInput=m,this.currentViewOptionsRefined=T),{rawOptions:this.currentViewOptionsInput,refinedOptions:this.currentViewOptionsRefined,extra:F}}}function Ipe(t,e,n,r,c,d,m,s){let T=g$(e||m.defaultCode,m.map);return new phe({calendarSystem:"gregory",timeZone:t,namedTimeZoneImpl:d.namedTimeZonedImpl,locale:T,weekNumberCalculation:n,firstDay:r,weekText:c,cmdFormatter:d.cmdFormatter,defaultSeparator:s})}function Mpe(t,e){let n=e.themeClasses[t.themeSystem]||d0;return new n(t)}function Ppe(t){let e=t.dateProfileGeneratorClass||BH;return new e(t)}function kpe(t,e,n){return new upe(t,e,n)}function Npe(t){return kx(t,e=>e.ui)}function Lpe(t,e,n){let r={"":e};for(let c in t){let d=t[c];d.sourceId&&n[d.sourceId]&&(r[c]=n[d.sourceId])}return r}function zpe(t){let{options:e}=t;return{eventUiSingleBase:cI({display:e.eventDisplay,editable:e.editable,startEditable:e.eventStartEditable,durationEditable:e.eventDurationEditable,constraint:e.eventConstraint,overlap:typeof e.eventOverlap=="boolean"?e.eventOverlap:void 0,allow:e.eventAllow,backgroundColor:e.eventBackgroundColor,borderColor:e.eventBorderColor,textColor:e.eventTextColor,color:e.eventColor},t),selectionConfig:cI({constraint:e.selectConstraint,overlap:typeof e.selectOverlap=="boolean"?e.selectOverlap:void 0,allow:e.selectAllow},t)}}function ak(t,e){for(let n of e.pluginHooks.isLoadingFuncs)if(n(t))return!0;return!1}function Bpe(t){return Zhe(t.options.businessHours,t)}function PU(t,e){for(let n in t)console.warn(`Unknown option '${n}'`)}class Fpe extends Vo{render(){let e=this.props.widgetGroups.map(n=>this.renderWidgetGroup(n));return on("div",{className:"fc-toolbar-chunk"},...e)}renderWidgetGroup(e){let{props:n}=this,{theme:r}=this.context,c=[],d=!0;for(let m of e){let{buttonName:s,buttonClick:T,buttonText:D,buttonIcon:P,buttonHint:z}=m;if(s==="title")d=!1,c.push(on("h2",{className:"fc-toolbar-title",id:n.titleId},n.title));else{let F=s===n.activeButton,$=!n.isTodayEnabled&&s==="today"||!n.isPrevEnabled&&s==="prev"||!n.isNextEnabled&&s==="next",J=[`fc-${s}-button`,r.getClass("button")];F&&J.push(r.getClass("buttonActive")),c.push(on("button",{type:"button",title:typeof z=="function"?z(n.navUnit):z,disabled:$,"aria-pressed":F,className:J.join(" "),onClick:T},D||(P?on("span",{className:P,role:"img"}):"")))}}if(c.length>1){let m=d&&r.getClass("buttonGroup")||"";return on("div",{className:m},...c)}return c[0]}}class kU extends Vo{render(){let{model:e,extraClassName:n}=this.props,r=!1,c,d,m=e.sectionWidgets,s=m.center;return m.left?(r=!0,c=m.left):c=m.start,m.right?(r=!0,d=m.right):d=m.end,on("div",{className:[n||"","fc-toolbar",r?"fc-toolbar-ltr":""].join(" ")},this.renderSection("start",c||[]),this.renderSection("center",s||[]),this.renderSection("end",d||[]))}renderSection(e,n){let{props:r}=this;return on(Fpe,{key:e,widgetGroups:n,title:r.title,navUnit:r.navUnit,activeButton:r.activeButton,isTodayEnabled:r.isTodayEnabled,isPrevEnabled:r.isPrevEnabled,isNextEnabled:r.isNextEnabled,titleId:r.titleId})}}class Vpe extends Vo{constructor(){super(...arguments),this.state={availableWidth:null},this.handleEl=e=>{this.el=e,M_(this.props.elRef,e),this.updateAvailableWidth()},this.handleResize=()=>{this.updateAvailableWidth()}}render(){let{props:e,state:n}=this,{aspectRatio:r}=e,c=["fc-view-harness",r||e.liquid||e.height?"fc-view-harness-active":"fc-view-harness-passive"],d="",m="";return r?n.availableWidth!==null?d=n.availableWidth/r:m=`${1/r*100}%`:d=e.height||"",on("div",{"aria-labelledby":e.labeledById,ref:this.handleEl,className:c.join(" "),style:{height:d,paddingBottom:m}},e.children)}componentDidMount(){this.context.addResizeHandler(this.handleResize)}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}updateAvailableWidth(){this.el&&this.props.aspectRatio&&this.setState({availableWidth:this.el.offsetWidth})}}class Upe extends CT{constructor(e){super(e),this.handleSegClick=(n,r)=>{let{component:c}=this,{context:d}=c,m=uT(r);if(m&&c.isValidSegDownEl(n.target)){let s=zc(n.target,".fc-event-forced-url"),T=s?s.querySelector("a[href]").href:"";d.emitter.trigger("eventClick",{el:r,event:new Io(c.context,m.eventRange.def,m.eventRange.instance),jsEvent:n,view:d.viewApi}),T&&!n.defaultPrevented&&(window.location.href=T)}},this.destroy=AH(e.el,"click",".fc-event",this.handleSegClick)}}class jpe extends CT{constructor(e){super(e),this.handleEventElRemove=n=>{n===this.currentSegEl&&this.handleSegLeave(null,this.currentSegEl)},this.handleSegEnter=(n,r)=>{uT(r)&&(this.currentSegEl=r,this.triggerEvent("eventMouseEnter",n,r))},this.handleSegLeave=(n,r)=>{this.currentSegEl&&(this.currentSegEl=null,this.triggerEvent("eventMouseLeave",n,r))},this.removeHoverListeners=hue(e.el,".fc-event",this.handleSegEnter,this.handleSegLeave)}destroy(){this.removeHoverListeners()}triggerEvent(e,n,r){let{component:c}=this,{context:d}=c,m=uT(r);(!n||c.isValidSegDownEl(n.target))&&d.emitter.trigger(e,{el:r,event:new Io(d,m.eventRange.def,m.eventRange.instance),jsEvent:n,view:d.viewApi})}}class Hpe extends Lx{constructor(){super(...arguments),this.buildViewContext=Os(_he),this.buildViewPropTransformers=Os(Gpe),this.buildToolbarProps=Os($pe),this.headerRef=I_(),this.footerRef=I_(),this.interactionsStore={},this.state={viewLabelId:dM()},this.registerInteractiveComponent=(e,n)=>{let r=yde(e,n),m=[Upe,jpe].concat(this.props.pluginHooks.componentInteractions).map(s=>new s(r));this.interactionsStore[e.uid]=m,SN[e.uid]=r},this.unregisterInteractiveComponent=e=>{let n=this.interactionsStore[e.uid];if(n){for(let r of n)r.destroy();delete this.interactionsStore[e.uid]}delete SN[e.uid]},this.resizeRunner=new AL(()=>{this.props.emitter.trigger("_resize",!0),this.props.emitter.trigger("windowResize",{view:this.props.viewApi})}),this.handleWindowResize=e=>{let{options:n}=this.props;n.handleWindowResize&&e.target===window&&this.resizeRunner.request(n.windowResizeDelay)}}render(){let{props:e}=this,{toolbarConfig:n,options:r}=e,c=!1,d="",m;e.isHeightAuto||e.forPrint?d="":r.height!=null?c=!0:r.contentHeight!=null?d=r.contentHeight:m=Math.max(r.aspectRatio,.5);let s=this.buildViewContext(e.viewSpec,e.viewApi,e.options,e.dateProfileGenerator,e.dateEnv,e.nowManager,e.theme,e.pluginHooks,e.dispatch,e.getCurrentData,e.emitter,e.calendarApi,this.registerInteractiveComponent,this.unregisterInteractiveComponent),T=n.header&&n.header.hasTitle?this.state.viewLabelId:void 0;return on(Nx.Provider,{value:s},on(_M,{unit:"day"},D=>{let P=this.buildToolbarProps(e.viewSpec,e.dateProfile,e.dateProfileGenerator,e.currentDate,D,e.viewTitle);return on(ea,null,n.header&&on(kU,Object.assign({ref:this.headerRef,extraClassName:"fc-header-toolbar",model:n.header,titleId:T},P)),on(Vpe,{liquid:c,height:d,aspectRatio:m,labeledById:T},this.renderView(e),this.buildAppendContent()),n.footer&&on(kU,Object.assign({ref:this.footerRef,extraClassName:"fc-footer-toolbar",model:n.footer,titleId:""},P)))}))}componentDidMount(){let{props:e}=this;this.calendarInteractions=e.pluginHooks.calendarInteractions.map(r=>new r(e)),window.addEventListener("resize",this.handleWindowResize);let{propSetHandlers:n}=e.pluginHooks;for(let r in n)n[r](e[r],e)}componentDidUpdate(e){let{props:n}=this,{propSetHandlers:r}=n.pluginHooks;for(let c in r)n[c]!==e[c]&&r[c](n[c],n)}componentWillUnmount(){window.removeEventListener("resize",this.handleWindowResize),this.resizeRunner.clear();for(let e of this.calendarInteractions)e.destroy();this.props.emitter.trigger("_unmount")}buildAppendContent(){let{props:e}=this,n=e.pluginHooks.viewContainerAppends.map(r=>r(e));return on(ea,{},...n)}renderView(e){let{pluginHooks:n}=e,{viewSpec:r}=e,c={dateProfile:e.dateProfile,businessHours:e.businessHours,eventStore:e.renderableEventStore,eventUiBases:e.eventUiBases,dateSelection:e.dateSelection,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,isHeightAuto:e.isHeightAuto,forPrint:e.forPrint},d=this.buildViewPropTransformers(n.viewPropsTransformers);for(let s of d)Object.assign(c,s.transform(c,e));let m=r.component;return on(m,Object.assign({},c))}}function $pe(t,e,n,r,c,d){let m=n.build(c,void 0,!1),s=n.buildPrev(e,r,!1),T=n.buildNext(e,r,!1);return{title:d,activeButton:t.type,navUnit:t.singleUnit,isTodayEnabled:m.isValid&&!Yv(e.currentRange,c),isPrevEnabled:s.isValid,isNextEnabled:T.isValid}}function Gpe(t){return t.map(e=>new e)}class qpe extends bde{constructor(e,n={}){super(),this.isRendering=!1,this.isRendered=!1,this.currentClassNames=[],this.customContentRenderId=0,this.handleAction=r=>{switch(r.type){case"SET_EVENT_DRAG":case"SET_EVENT_RESIZE":this.renderRunner.tryDrain()}},this.handleData=r=>{this.currentData=r,this.renderRunner.request(r.calendarOptions.rerenderDelay)},this.handleRenderRequest=()=>{if(this.isRendering){this.isRendered=!0;let{currentData:r}=this;aI(()=>{TA(on(_de,{options:r.calendarOptions,theme:r.theme,emitter:r.emitter},(c,d,m,s)=>(this.setClassNames(c),this.setHeight(d),on(kH.Provider,{value:this.customContentRenderId},on(Hpe,Object.assign({isHeightAuto:m,forPrint:s},r))))),this.el)})}else this.isRendered&&(this.isRendered=!1,TA(null,this.el),this.setClassNames([]),this.setHeight(""))},nue(e),this.el=e,this.renderRunner=new AL(this.handleRenderRequest),new Ope({optionOverrides:n,calendarApi:this,onAction:this.handleAction,onData:this.handleData})}render(){let e=this.isRendering;e?this.customContentRenderId+=1:this.isRendering=!0,this.renderRunner.request(),e&&this.updateSize()}destroy(){this.isRendering&&(this.isRendering=!1,this.renderRunner.request())}updateSize(){aI(()=>{super.updateSize()})}batchRendering(e){this.renderRunner.pause("batchRendering"),e(),this.renderRunner.resume("batchRendering")}pauseRendering(){this.renderRunner.pause("pauseRendering")}resumeRendering(){this.renderRunner.resume("pauseRendering",!0)}resetOptions(e,n){this.currentDataManager.resetOptions(e,n)}setClassNames(e){if(!r0(e,this.currentClassNames)){let{classList:n}=this.el;for(let r of this.currentClassNames)n.remove(r);for(let r of e)n.add(r);this.currentClassNames=e}}setHeight(e){EH(this.el,"height",e)}}const Wpe=parseInt(String(Bc.version).split(".")[0]),Ype=Wpe<18;class T$ extends ke.Component{constructor(){super(...arguments),this.elRef=ke.createRef(),this.isUpdating=!1,this.isUnmounting=!1,this.state={customRenderingMap:new Map},this.requestResize=()=>{this.isUnmounting||(this.cancelResize(),this.resizeId=requestAnimationFrame(()=>{this.doResize()}))}}render(){const e=[];for(const n of this.state.customRenderingMap.values())e.push(Bc.createElement(Zpe,{key:n.id,customRendering:n}));return Bc.createElement("div",{ref:this.elRef},e)}componentDidMount(){this.isUnmounting=!1;const e=new Ofe;this.handleCustomRendering=e.handle.bind(e),this.calendar=new qpe(this.elRef.current,Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.calendar.render(),this.calendar.on("_beforeprint",()=>{sA.flushSync(()=>{})});let n;e.subscribe(r=>{const c=Date.now(),d=!n;(Ype||d||this.isUpdating||this.isUnmounting||c-n<100?E$:sA.flushSync)(()=>{this.setState({customRenderingMap:r},()=>{n=c,d?this.doResize():this.requestResize()})})})}componentDidUpdate(){this.isUpdating=!0,this.calendar.resetOptions(Object.assign(Object.assign({},this.props),{handleCustomRendering:this.handleCustomRendering})),this.isUpdating=!1}componentWillUnmount(){this.isUnmounting=!0,this.cancelResize(),this.calendar.destroy()}doResize(){this.calendar.updateSize()}cancelResize(){this.resizeId!==void 0&&(cancelAnimationFrame(this.resizeId),this.resizeId=void 0)}getApi(){return this.calendar}}T$.act=E$;class Zpe extends ke.PureComponent{render(){const{customRendering:e}=this.props,{generatorMeta:n}=e,r=typeof n=="function"?n(e.renderProps):n;return sA.createPortal(r,e.containerEl)}}function E$(t){t()}class Xpe extends zx{constructor(){super(...arguments),this.headerElRef=I_()}renderSimpleLayout(e,n){let{props:r,context:c}=this,d=[],m=SU(c.options);return e&&d.push({type:"header",key:"header",isSticky:m,chunk:{elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}}),d.push({type:"body",key:"body",liquid:!0,chunk:{content:n}}),on(pU,{elClasses:["fc-daygrid"],viewSpec:c.viewSpec},on(h$,{liquid:!r.isHeightAuto&&!r.forPrint,collapsibleWidth:r.forPrint,cols:[],sections:d}))}renderHScrollLayout(e,n,r,c){let d=this.context.pluginHooks.scrollGridImpl;if(!d)throw new Error("No ScrollGrid implementation");let{props:m,context:s}=this,T=!m.forPrint&&SU(s.options),D=!m.forPrint&&ufe(s.options),P=[];return e&&P.push({type:"header",key:"header",isSticky:T,chunks:[{key:"main",elRef:this.headerElRef,tableClassName:"fc-col-header",rowContent:e}]}),P.push({type:"body",key:"body",liquid:!0,chunks:[{key:"main",content:n}]}),D&&P.push({type:"footer",key:"footer",isSticky:!0,chunks:[{key:"main",content:cfe}]}),on(pU,{elClasses:["fc-daygrid"],viewSpec:s.viewSpec},on(d,{liquid:!m.isHeightAuto&&!m.forPrint,forPrint:m.forPrint,collapsibleWidth:m.forPrint,colGroups:[{cols:[{span:r,minWidth:c}]}],sections:P}))}}function OR(t,e){let n=[];for(let r=0;r<e;r+=1)n[r]=[];for(let r of t)n[r.row].push(r);return n}function IR(t,e){let n=[];for(let r=0;r<e;r+=1)n[r]=[];for(let r of t)n[r.firstCol].push(r);return n}function NU(t,e){let n=[];if(t){for(let r=0;r<e;r+=1)n[r]={affectedInstances:t.affectedInstances,isEvent:t.isEvent,segs:[]};for(let r of t.segs)n[r.row].segs.push(r)}else for(let r=0;r<e;r+=1)n[r]=null;return n}const S$=Cl({hour:"numeric",minute:"2-digit",omitZeroMinute:!0,meridiem:"narrow"});function A$(t){let{display:e}=t.eventRange.ui;return e==="list-item"||e==="auto"&&!t.eventRange.def.allDay&&t.firstCol===t.lastCol&&t.isStart&&t.isEnd}class C$ extends Vo{render(){let{props:e}=this;return on(dfe,Object.assign({},e,{elClasses:["fc-daygrid-event","fc-daygrid-block-event","fc-h-event"],defaultTimeFormat:S$,defaultDisplayEventEnd:e.defaultDisplayEventEnd,disableResizing:!e.seg.eventRange.def.allDay}))}}class D$ extends Vo{render(){let{props:e,context:n}=this,{options:r}=n,{seg:c}=e,d=r.eventTimeFormat||S$,m=ZH(c,d,n,!0,e.defaultDisplayEventEnd);return on(YL,Object.assign({},e,{elTag:"a",elClasses:["fc-daygrid-event","fc-daygrid-dot-event"],elAttrs:XH(e.seg,n),defaultGenerator:Qpe,timeText:m,isResizing:!1,isDateSelecting:!1}))}}function Qpe(t){return on(ea,null,on("div",{className:"fc-daygrid-event-dot",style:{borderColor:t.borderColor||t.backgroundColor}}),t.timeText&&on("div",{className:"fc-event-time"},t.timeText),on("div",{className:"fc-event-title"},t.event.title||on(ea,null," ")))}class Kpe extends Vo{constructor(){super(...arguments),this.compileSegs=Os(Jpe)}render(){let{props:e}=this,{allSegs:n,invisibleSegs:r}=this.compileSegs(e.singlePlacements);return on(Tfe,{elClasses:["fc-daygrid-more-link"],dateProfile:e.dateProfile,todayRange:e.todayRange,allDayDate:e.allDayDate,moreCnt:e.moreCnt,allSegs:n,hiddenSegs:r,alignmentElRef:e.alignmentElRef,alignGridTop:e.alignGridTop,extraDateSpan:e.extraDateSpan,popoverContent:()=>{let c=(e.eventDrag?e.eventDrag.affectedInstances:null)||(e.eventResize?e.eventResize.affectedInstances:null)||{};return on(ea,null,n.map(d=>{let m=d.eventRange.instance.instanceId;return on("div",{className:"fc-daygrid-event-harness",key:m,style:{visibility:c[m]?"hidden":""}},A$(d)?on(D$,Object.assign({seg:d,isDragging:!1,isSelected:m===e.eventSelection,defaultDisplayEventEnd:!1},KS(d,e.todayRange))):on(C$,Object.assign({seg:d,isDragging:!1,isResizing:!1,isDateSelecting:!1,isSelected:m===e.eventSelection,defaultDisplayEventEnd:!1},KS(d,e.todayRange))))}))}})}}function Jpe(t){let e=[],n=[];for(let r of t)e.push(r.seg),r.isVisible||n.push(r.seg);return{allSegs:e,invisibleSegs:n}}const eme=Cl({week:"narrow"});class tme extends zx{constructor(){super(...arguments),this.rootElRef=I_(),this.state={dayNumberId:dM()},this.handleRootEl=e=>{M_(this.rootElRef,e),M_(this.props.elRef,e)}}render(){let{context:e,props:n,state:r,rootElRef:c}=this,{options:d,dateEnv:m}=e,{date:s,dateProfile:T}=n;const D=n.showDayNumber&&ime(s,T.currentRange,m);return on(d$,{elTag:"td",elRef:this.handleRootEl,elClasses:["fc-daygrid-day",...n.extraClassNames||[]],elAttrs:Object.assign(Object.assign(Object.assign({},n.extraDataAttrs),n.showDayNumber?{"aria-labelledby":r.dayNumberId}:{}),{role:"gridcell"}),defaultGenerator:nme,date:s,dateProfile:T,todayRange:n.todayRange,showDayNumber:n.showDayNumber,isMonthStart:D,extraRenderProps:n.extraRenderProps},(P,z)=>on("div",{ref:n.innerElRef,className:"fc-daygrid-day-frame fc-scrollgrid-sync-inner",style:{minHeight:n.minHeight}},n.showWeekNumber&&on(vfe,{elTag:"a",elClasses:["fc-daygrid-week-number"],elAttrs:AN(e,s,"week"),date:s,defaultFormat:eme}),!z.isDisabled&&(n.showDayNumber||f$(d)||n.forceDayTop)?on("div",{className:"fc-daygrid-day-top"},on(P,{elTag:"a",elClasses:["fc-daygrid-day-number",D&&"fc-daygrid-month-start"],elAttrs:Object.assign(Object.assign({},AN(e,s)),{id:r.dayNumberId})})):n.showDayNumber?on("div",{className:"fc-daygrid-day-top",style:{visibility:"hidden"}},on("a",{className:"fc-daygrid-day-number"}," ")):void 0,on("div",{className:"fc-daygrid-day-events",ref:n.fgContentElRef},n.fgContent,on("div",{className:"fc-daygrid-day-bottom",style:{marginTop:n.moreMarginTop}},on(Kpe,{allDayDate:s,singlePlacements:n.singlePlacements,moreCnt:n.moreCnt,alignmentElRef:c,alignGridTop:!n.showDayNumber,extraDateSpan:n.extraDateSpan,dateProfile:n.dateProfile,eventSelection:n.eventSelection,eventDrag:n.eventDrag,eventResize:n.eventResize,todayRange:n.todayRange}))),on("div",{className:"fc-daygrid-day-bg"},n.bgContent)))}}function nme(t){return t.dayNumberText||on(ea,null," ")}function ime(t,e,n){const{start:r,end:c}=e,d=s0(c,-1),m=n.getYear(r),s=n.getMonth(r),T=n.getYear(d),D=n.getMonth(d);return!(m===T&&s===D)&&(t.valueOf()===r.valueOf()||n.getDay(t)===1&&t.valueOf()<c.valueOf())}function R$(t){return t.eventRange.instance.instanceId+":"+t.firstCol}function O$(t){return R$(t)+":"+t.lastCol}function rme(t,e,n,r,c,d,m){let s=new ame(ie=>{let we=t[ie.index].eventRange.instance.instanceId+":"+ie.span.start+":"+(ie.span.end-1);return c[we]||1});s.allowReslicing=!0,s.strictOrder=r,e===!0||n===!0?(s.maxCoord=d,s.hiddenConsumes=!0):typeof e=="number"?s.maxStackCnt=e:typeof n=="number"&&(s.maxStackCnt=n,s.hiddenConsumes=!0);let T=[],D=[];for(let ie=0;ie<t.length;ie+=1){let we=t[ie],Ie=O$(we);c[Ie]!=null?T.push({index:ie,span:{start:we.firstCol,end:we.lastCol+1}}):D.push(we)}let P=s.addSegs(T),z=s.toRects(),{singleColPlacements:F,multiColPlacements:$,leftoverMargins:J}=sme(z,t,m),X=[],te=[];for(let ie of D){$[ie.firstCol].push({seg:ie,isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let we=ie.firstCol;we<=ie.lastCol;we+=1)F[we].push({seg:jw(ie,we,we+1,m),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let ie=0;ie<m.length;ie+=1)X.push(0);for(let ie of P){let we=t[ie.index],Ie=ie.span;$[Ie.start].push({seg:jw(we,Ie.start,Ie.end,m),isVisible:!1,isAbsolute:!0,absoluteTop:0,marginTop:0});for(let Re=Ie.start;Re<Ie.end;Re+=1)X[Re]+=1,F[Re].push({seg:jw(we,Re,Re+1,m),isVisible:!1,isAbsolute:!1,absoluteTop:0,marginTop:0})}for(let ie=0;ie<m.length;ie+=1)te.push(J[ie]);return{singleColPlacements:F,multiColPlacements:$,moreCnts:X,moreMarginTops:te}}function sme(t,e,n){let r=ome(t,n.length),c=[],d=[],m=[];for(let s=0;s<n.length;s+=1){let T=r[s],D=[],P=0,z=0;for(let $ of T){let J=e[$.index];D.push({seg:jw(J,s,s+1,n),isVisible:!0,isAbsolute:!1,absoluteTop:$.levelCoord,marginTop:$.levelCoord-P}),P=$.levelCoord+$.thickness}let F=[];P=0,z=0;for(let $ of T){let J=e[$.index],X=$.span.end-$.span.start>1,te=$.span.start===s;z+=$.levelCoord-P,P=$.levelCoord+$.thickness,X?(z+=$.thickness,te&&F.push({seg:jw(J,$.span.start,$.span.end,n),isVisible:!0,isAbsolute:!0,absoluteTop:$.levelCoord,marginTop:0})):te&&(F.push({seg:jw(J,$.span.start,$.span.end,n),isVisible:!0,isAbsolute:!1,absoluteTop:$.levelCoord,marginTop:z}),z=0)}c.push(D),d.push(F),m.push(z)}return{singleColPlacements:c,multiColPlacements:d,leftoverMargins:m}}function ome(t,e){let n=[];for(let r=0;r<e;r+=1)n.push([]);for(let r of t)for(let c=r.span.start;c<r.span.end;c+=1)n[c].push(r);return n}function jw(t,e,n,r){if(t.firstCol===e&&t.lastCol===n-1)return t;let c=t.eventRange,d=c.range,m=cT(d,{start:r[e].date,end:Uc(r[n-1].date,1)});return Object.assign(Object.assign({},t),{firstCol:e,lastCol:n-1,eventRange:{def:c.def,ui:Object.assign(Object.assign({},c.ui),{durationEditable:!1}),instance:c.instance,range:m},isStart:t.isStart&&m.start.valueOf()===d.start.valueOf(),isEnd:t.isEnd&&m.end.valueOf()===d.end.valueOf()})}class ame extends Lde{constructor(){super(...arguments),this.hiddenConsumes=!1,this.forceHidden={}}addSegs(e){const n=super.addSegs(e),{entriesByLevel:r}=this,c=d=>!this.forceHidden[JS(d)];for(let d=0;d<r.length;d+=1)r[d]=r[d].filter(c);return n}handleInvalidInsertion(e,n,r){const{entriesByLevel:c,forceHidden:d}=this,{touchingEntry:m,touchingLevel:s,touchingLateral:T}=e;if(this.hiddenConsumes&&m){const D=JS(m);if(!d[D])if(this.allowReslicing){const P=Object.assign(Object.assign({},m),{span:r$(m.span,n.span)}),z=JS(P);d[z]=!0,c[s][T]=P,r.push(P),this.splitEntry(m,n,r)}else d[D]=!0,r.push(m)}super.handleInvalidInsertion(e,n,r)}}class I$ extends zx{constructor(){super(...arguments),this.cellElRefs=new ax,this.frameElRefs=new ax,this.fgElRefs=new ax,this.segHarnessRefs=new ax,this.rootElRef=I_(),this.state={framePositions:null,maxContentHeight:null,segHeights:{}},this.handleResize=e=>{e&&this.updateSizing(!0)}}render(){let{props:e,state:n,context:r}=this,{options:c}=r,d=e.cells.length,m=IR(e.businessHourSegs,d),s=IR(e.bgEventSegs,d),T=IR(this.getHighlightSegs(),d),D=IR(this.getMirrorSegs(),d),{singleColPlacements:P,multiColPlacements:z,moreCnts:F,moreMarginTops:$}=rme(ede(e.fgEventSegs,c.eventOrder),e.dayMaxEvents,e.dayMaxEventRows,c.eventOrderStrict,n.segHeights,n.maxContentHeight,e.cells),J=e.eventDrag&&e.eventDrag.affectedInstances||e.eventResize&&e.eventResize.affectedInstances||{};return on("tr",{ref:this.rootElRef,role:"row"},e.renderIntro&&e.renderIntro(),e.cells.map((X,te)=>{let ie=this.renderFgSegs(te,e.forPrint?P[te]:z[te],e.todayRange,J),we=this.renderFgSegs(te,lme(D[te],z),e.todayRange,{},!!e.eventDrag,!!e.eventResize,!1);return on(tme,{key:X.key,elRef:this.cellElRefs.createRef(X.key),innerElRef:this.frameElRefs.createRef(X.key),dateProfile:e.dateProfile,date:X.date,showDayNumber:e.showDayNumbers,showWeekNumber:e.showWeekNumbers&&te===0,forceDayTop:e.showWeekNumbers,todayRange:e.todayRange,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,extraRenderProps:X.extraRenderProps,extraDataAttrs:X.extraDataAttrs,extraClassNames:X.extraClassNames,extraDateSpan:X.extraDateSpan,moreCnt:F[te],moreMarginTop:$[te],singlePlacements:P[te],fgContentElRef:this.fgElRefs.createRef(X.key),fgContent:on(ea,null,on(ea,null,ie),on(ea,null,we)),bgContent:on(ea,null,this.renderFillSegs(T[te],"highlight"),this.renderFillSegs(m[te],"non-business"),this.renderFillSegs(s[te],"bg-event")),minHeight:e.cellMinHeight})}))}componentDidMount(){this.updateSizing(!0),this.context.addResizeHandler(this.handleResize)}componentDidUpdate(e,n){let r=this.props;this.updateSizing(!Ym(e,r))}componentWillUnmount(){this.context.removeResizeHandler(this.handleResize)}getHighlightSegs(){let{props:e}=this;return e.eventDrag&&e.eventDrag.segs.length?e.eventDrag.segs:e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:e.dateSelectionSegs}getMirrorSegs(){let{props:e}=this;return e.eventResize&&e.eventResize.segs.length?e.eventResize.segs:[]}renderFgSegs(e,n,r,c,d,m,s){let{context:T}=this,{eventSelection:D}=this.props,{framePositions:P}=this.state,z=this.props.cells.length===1,F=d||m||s,$=[];if(P)for(let J of n){let{seg:X}=J,{instanceId:te}=X.eventRange.instance,ie=J.isVisible&&!c[te],we=J.isAbsolute,Ie="",Re="";we&&(T.isRtl?(Re=0,Ie=P.lefts[X.lastCol]-P.lefts[X.firstCol]):(Ie=0,Re=P.rights[X.firstCol]-P.rights[X.lastCol])),$.push(on("div",{className:"fc-daygrid-event-harness"+(we?" fc-daygrid-event-harness-abs":""),key:R$(X),ref:F?null:this.segHarnessRefs.createRef(O$(X)),style:{visibility:ie?"":"hidden",marginTop:we?"":J.marginTop,top:we?J.absoluteTop:"",left:Ie,right:Re}},A$(X)?on(D$,Object.assign({seg:X,isDragging:d,isSelected:te===D,defaultDisplayEventEnd:z},KS(X,r))):on(C$,Object.assign({seg:X,isDragging:d,isResizing:m,isDateSelecting:s,isSelected:te===D,defaultDisplayEventEnd:z},KS(X,r)))))}return $}renderFillSegs(e,n){let{isRtl:r}=this.context,{todayRange:c}=this.props,{framePositions:d}=this.state,m=[];if(d)for(let s of e){let T=r?{right:0,left:d.lefts[s.lastCol]-d.lefts[s.firstCol]}:{left:0,right:d.rights[s.firstCol]-d.rights[s.lastCol]};m.push(on("div",{key:ode(s.eventRange),className:"fc-daygrid-bg-harness",style:T},n==="bg-event"?on(gfe,Object.assign({seg:s},KS(s,c))):yfe(n)))}return on(ea,{},...m)}updateSizing(e){let{props:n,state:r,frameElRefs:c}=this;if(!n.forPrint&&n.clientWidth!==null){if(e){let T=n.cells.map(D=>c.currentMap[D.key]);if(T.length){let D=this.rootElRef.current,P=new hI(D,T,!0,!1);(!r.framePositions||!r.framePositions.similarTo(P))&&this.setState({framePositions:new hI(D,T,!0,!1)})}}const d=this.state.segHeights,m=this.querySegHeights(),s=n.dayMaxEvents===!0||n.dayMaxEventRows===!0;this.safeSetState({segHeights:Object.assign(Object.assign({},d),m),maxContentHeight:s?this.computeMaxContentHeight():null})}}querySegHeights(){let e=this.segHarnessRefs.currentMap,n={};for(let r in e){let c=Math.round(e[r].getBoundingClientRect().height);n[r]=Math.max(n[r]||0,c)}return n}computeMaxContentHeight(){let e=this.props.cells[0].key,n=this.cellElRefs.currentMap[e],r=this.fgElRefs.currentMap[e];return n.getBoundingClientRect().bottom-r.getBoundingClientRect().top}getCellEls(){let e=this.cellElRefs.currentMap;return this.props.cells.map(n=>e[n.key])}}I$.addStateEquality({segHeights:Ym});function lme(t,e){if(!t.length)return[];let n=cme(e);return t.map(r=>({seg:r,isVisible:!0,isAbsolute:!0,absoluteTop:n[r.eventRange.instance.instanceId],marginTop:0}))}function cme(t){let e={};for(let n of t)for(let r of n)e[r.seg.eventRange.instance.instanceId]=r.absoluteTop;return e}class ume extends zx{constructor(){super(...arguments),this.splitBusinessHourSegs=Os(OR),this.splitBgEventSegs=Os(OR),this.splitFgEventSegs=Os(OR),this.splitDateSelectionSegs=Os(OR),this.splitEventDrag=Os(NU),this.splitEventResize=Os(NU),this.rowRefs=new ax}render(){let{props:e,context:n}=this,r=e.cells.length,c=this.splitBusinessHourSegs(e.businessHourSegs,r),d=this.splitBgEventSegs(e.bgEventSegs,r),m=this.splitFgEventSegs(e.fgEventSegs,r),s=this.splitDateSelectionSegs(e.dateSelectionSegs,r),T=this.splitEventDrag(e.eventDrag,r),D=this.splitEventResize(e.eventResize,r),P=r>=7&&e.clientWidth?e.clientWidth/n.options.aspectRatio/6:null;return on(_M,{unit:"day"},(z,F)=>on(ea,null,e.cells.map(($,J)=>on(I$,{ref:this.rowRefs.createRef(J),key:$.length?$[0].date.toISOString():J,showDayNumbers:r>1,showWeekNumbers:e.showWeekNumbers,todayRange:F,dateProfile:e.dateProfile,cells:$,renderIntro:e.renderRowIntro,businessHourSegs:c[J],eventSelection:e.eventSelection,bgEventSegs:d[J].filter(hme),fgEventSegs:m[J],dateSelectionSegs:s[J],eventDrag:T[J],eventResize:D[J],dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,clientWidth:e.clientWidth,clientHeight:e.clientHeight,cellMinHeight:P,forPrint:e.forPrint}))))}componentDidMount(){this.registerInteractiveComponent()}componentDidUpdate(){this.registerInteractiveComponent()}registerInteractiveComponent(){if(!this.rootEl){const e=this.rowRefs.currentMap[0].getCellEls()[0],n=e?e.closest(".fc-daygrid-body"):null;n&&(this.rootEl=n,this.context.registerInteractiveComponent(this,{el:n,isHitComboAllowed:this.props.isHitComboAllowed}))}}componentWillUnmount(){this.rootEl&&(this.context.unregisterInteractiveComponent(this),this.rootEl=null)}prepareHits(){this.rowPositions=new hI(this.rootEl,this.rowRefs.collect().map(e=>e.getCellEls()[0]),!1,!0),this.colPositions=new hI(this.rootEl,this.rowRefs.currentMap[0].getCellEls(),!0,!1)}queryHit(e,n){let{colPositions:r,rowPositions:c}=this,d=r.leftToIndex(e),m=c.topToIndex(n);if(m!=null&&d!=null){let s=this.props.cells[m][d];return{dateProfile:this.props.dateProfile,dateSpan:Object.assign({range:this.getCellRange(m,d),allDay:!0},s.extraDateSpan),dayEl:this.getCellEl(m,d),rect:{left:r.lefts[d],right:r.rights[d],top:c.tops[m],bottom:c.bottoms[m]},layer:0}}return null}getCellEl(e,n){return this.rowRefs.currentMap[e].getCellEls()[n]}getCellRange(e,n){let r=this.props.cells[e][n].date,c=Uc(r,1);return{start:r,end:c}}}function hme(t){return t.eventRange.def.allDay}class dme extends zx{constructor(){super(...arguments),this.elRef=I_(),this.needsScrollReset=!1}render(){let{props:e}=this,{dayMaxEventRows:n,dayMaxEvents:r,expandRows:c}=e,d=r===!0||n===!0;d&&!c&&(d=!1,n=null,r=null);let m=["fc-daygrid-body",d?"fc-daygrid-body-balanced":"fc-daygrid-body-unbalanced",c?"":"fc-daygrid-body-natural"];return on("div",{ref:this.elRef,className:m.join(" "),style:{width:e.clientWidth,minWidth:e.tableMinWidth}},on("table",{role:"presentation",className:"fc-scrollgrid-sync-table",style:{width:e.clientWidth,minWidth:e.tableMinWidth,height:c?e.clientHeight:""}},e.colGroupNode,on("tbody",{role:"presentation"},on(ume,{dateProfile:e.dateProfile,cells:e.cells,renderRowIntro:e.renderRowIntro,showWeekNumbers:e.showWeekNumbers,clientWidth:e.clientWidth,clientHeight:e.clientHeight,businessHourSegs:e.businessHourSegs,bgEventSegs:e.bgEventSegs,fgEventSegs:e.fgEventSegs,dateSelectionSegs:e.dateSelectionSegs,eventSelection:e.eventSelection,eventDrag:e.eventDrag,eventResize:e.eventResize,dayMaxEvents:r,dayMaxEventRows:n,forPrint:e.forPrint,isHitComboAllowed:e.isHitComboAllowed}))))}componentDidMount(){this.requestScrollReset()}componentDidUpdate(e){e.dateProfile!==this.props.dateProfile?this.requestScrollReset():this.flushScrollReset()}requestScrollReset(){this.needsScrollReset=!0,this.flushScrollReset()}flushScrollReset(){if(this.needsScrollReset&&this.props.clientWidth){const e=fme(this.elRef.current,this.props.dateProfile);if(e){const n=e.closest(".fc-daygrid-body"),r=n.closest(".fc-scroller"),c=e.getBoundingClientRect().top-n.getBoundingClientRect().top;r.scrollTop=c?c+1:0}this.needsScrollReset=!1}}}function fme(t,e){let n;return e.currentRangeUnit.match(/year|month/)&&(n=t.querySelector(`[data-date="${jue(e.currentDate)}-01"]`)),n||(n=t.querySelector(`[data-date="${OL(e.currentDate)}"]`)),n}class pme extends qde{constructor(){super(...arguments),this.forceDayIfListItem=!0}sliceRange(e,n){return n.sliceRange(e)}}class mme extends zx{constructor(){super(...arguments),this.slicer=new pme,this.tableRef=I_()}render(){let{props:e,context:n}=this;return on(dme,Object.assign({ref:this.tableRef},this.slicer.sliceProps(e,e.dateProfile,e.nextDayThreshold,n,e.dayTableModel),{dateProfile:e.dateProfile,cells:e.dayTableModel.cells,colGroupNode:e.colGroupNode,tableMinWidth:e.tableMinWidth,renderRowIntro:e.renderRowIntro,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.showWeekNumbers,expandRows:e.expandRows,headerAlignElRef:e.headerAlignElRef,clientWidth:e.clientWidth,clientHeight:e.clientHeight,forPrint:e.forPrint}))}}class gme extends Xpe{constructor(){super(...arguments),this.buildDayTableModel=Os(_me),this.headerRef=I_(),this.tableRef=I_()}render(){let{options:e,dateProfileGenerator:n}=this.context,{props:r}=this,c=this.buildDayTableModel(r.dateProfile,n),d=e.dayHeaders&&on(jde,{ref:this.headerRef,dateProfile:r.dateProfile,dates:c.headerDates,datesRepDistinctDays:c.rowCnt===1}),m=s=>on(mme,{ref:this.tableRef,dateProfile:r.dateProfile,dayTableModel:c,businessHours:r.businessHours,dateSelection:r.dateSelection,eventStore:r.eventStore,eventUiBases:r.eventUiBases,eventSelection:r.eventSelection,eventDrag:r.eventDrag,eventResize:r.eventResize,nextDayThreshold:e.nextDayThreshold,colGroupNode:s.tableColGroupNode,tableMinWidth:s.tableMinWidth,dayMaxEvents:e.dayMaxEvents,dayMaxEventRows:e.dayMaxEventRows,showWeekNumbers:e.weekNumbers,expandRows:!r.isHeightAuto,headerAlignElRef:this.headerElRef,clientWidth:s.clientWidth,clientHeight:s.clientHeight,forPrint:r.forPrint});return e.dayMinWidth?this.renderHScrollLayout(d,m,c.colCnt,e.dayMinWidth):this.renderSimpleLayout(d,m)}}function _me(t,e){let n=new $de(t.renderRange,e);return new Gde(n,/year|month|week/.test(t.currentRangeUnit))}class yme extends BH{buildRenderRange(e,n,r){let c=super.buildRenderRange(e,n,r),{props:d}=this;return vme({currentRange:c,snapToWeek:/^(year|month)$/.test(n),fixedWeekCount:d.fixedWeekCount,dateEnv:d.dateEnv})}}function vme(t){let{dateEnv:e,currentRange:n}=t,{start:r,end:c}=n,d;if(t.snapToWeek&&(r=e.startOfWeek(r),d=e.startOfWeek(c),d.valueOf()!==c.valueOf()&&(c=oU(d,1))),t.fixedWeekCount){let m=e.startOfWeek(e.startOfMonth(Uc(n.end,-1))),s=Math.ceil(Oue(m,c));c=oU(c,6-s)}return{start:r,end:c}}var bme=':root{--fc-daygrid-event-dot-width:8px}.fc-daygrid-day-events:after,.fc-daygrid-day-events:before,.fc-daygrid-day-frame:after,.fc-daygrid-day-frame:before,.fc-daygrid-event-harness:after,.fc-daygrid-event-harness:before{clear:both;content:"";display:table}.fc .fc-daygrid-body{position:relative;z-index:1}.fc .fc-daygrid-day.fc-day-today{background-color:var(--fc-today-bg-color)}.fc .fc-daygrid-day-frame{min-height:100%;position:relative}.fc .fc-daygrid-day-top{display:flex;flex-direction:row-reverse}.fc .fc-day-other .fc-daygrid-day-top{opacity:.3}.fc .fc-daygrid-day-number{padding:4px;position:relative;z-index:4}.fc .fc-daygrid-month-start{font-size:1.1em;font-weight:700}.fc .fc-daygrid-day-events{margin-top:1px}.fc .fc-daygrid-body-balanced .fc-daygrid-day-events{left:0;position:absolute;right:0}.fc .fc-daygrid-body-unbalanced .fc-daygrid-day-events{min-height:2em;position:relative}.fc .fc-daygrid-body-natural .fc-daygrid-day-events{margin-bottom:1em}.fc .fc-daygrid-event-harness{position:relative}.fc .fc-daygrid-event-harness-abs{left:0;position:absolute;right:0;top:0}.fc .fc-daygrid-bg-harness{bottom:0;position:absolute;top:0}.fc .fc-daygrid-day-bg .fc-non-business{z-index:1}.fc .fc-daygrid-day-bg .fc-bg-event{z-index:2}.fc .fc-daygrid-day-bg .fc-highlight{z-index:3}.fc .fc-daygrid-event{margin-top:1px;z-index:6}.fc .fc-daygrid-event.fc-event-mirror{z-index:7}.fc .fc-daygrid-day-bottom{font-size:.85em;margin:0 2px}.fc .fc-daygrid-day-bottom:after,.fc .fc-daygrid-day-bottom:before{clear:both;content:"";display:table}.fc .fc-daygrid-more-link{border-radius:3px;cursor:pointer;line-height:1;margin-top:1px;max-width:100%;overflow:hidden;padding:2px;position:relative;white-space:nowrap;z-index:4}.fc .fc-daygrid-more-link:hover{background-color:rgba(0,0,0,.1)}.fc .fc-daygrid-week-number{background-color:var(--fc-neutral-bg-color);color:var(--fc-neutral-text-color);min-width:1.5em;padding:2px;position:absolute;text-align:center;top:0;z-index:5}.fc .fc-more-popover .fc-popover-body{min-width:220px;padding:10px}.fc-direction-ltr .fc-daygrid-event.fc-event-start,.fc-direction-rtl .fc-daygrid-event.fc-event-end{margin-left:2px}.fc-direction-ltr .fc-daygrid-event.fc-event-end,.fc-direction-rtl .fc-daygrid-event.fc-event-start{margin-right:2px}.fc-direction-ltr .fc-daygrid-more-link{float:left}.fc-direction-ltr .fc-daygrid-week-number{border-radius:0 0 3px 0;left:0}.fc-direction-rtl .fc-daygrid-more-link{float:right}.fc-direction-rtl .fc-daygrid-week-number{border-radius:0 0 0 3px;right:0}.fc-liquid-hack .fc-daygrid-day-frame{position:static}.fc-daygrid-event{border-radius:3px;font-size:var(--fc-small-font-size);position:relative;white-space:nowrap}.fc-daygrid-block-event .fc-event-time{font-weight:700}.fc-daygrid-block-event .fc-event-time,.fc-daygrid-block-event .fc-event-title{padding:1px}.fc-daygrid-dot-event{align-items:center;display:flex;padding:2px 0}.fc-daygrid-dot-event .fc-event-title{flex-grow:1;flex-shrink:1;font-weight:700;min-width:0;overflow:hidden}.fc-daygrid-dot-event.fc-event-mirror,.fc-daygrid-dot-event:hover{background:rgba(0,0,0,.1)}.fc-daygrid-dot-event.fc-event-selected:before{bottom:-10px;top:-10px}.fc-daygrid-event-dot{border:calc(var(--fc-daygrid-event-dot-width)/2) solid var(--fc-event-border-color);border-radius:calc(var(--fc-daygrid-event-dot-width)/2);box-sizing:content-box;height:0;margin:0 4px;width:0}.fc-direction-ltr .fc-daygrid-event .fc-event-time{margin-right:3px}.fc-direction-rtl .fc-daygrid-event .fc-event-time{margin-left:3px}';xH(bme);var xme=h0({name:"@fullcalendar/daygrid",initialView:"dayGridMonth",views:{dayGrid:{component:gme,dateProfileGeneratorClass:yme},dayGridDay:{type:"dayGrid",duration:{days:1}},dayGridWeek:{type:"dayGrid",duration:{weeks:1}},dayGridMonth:{type:"dayGrid",duration:{months:1},fixedWeekCount:!0},dayGridYear:{type:"dayGrid",duration:{years:1}}}});WL.touchMouseIgnoreWait=500;let DN=0,dI=0,RN=!1;class M${constructor(e){this.subjectEl=null,this.selector="",this.handleSelector="",this.shouldIgnoreMove=!1,this.shouldWatchScroll=!0,this.isDragging=!1,this.isTouchDragging=!1,this.wasTouchScroll=!1,this.handleMouseDown=n=>{if(!this.shouldIgnoreMouse()&&wme(n)&&this.tryStart(n)){let r=this.createEventFromMouse(n,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r),this.shouldIgnoreMove||document.addEventListener("mousemove",this.handleMouseMove),document.addEventListener("mouseup",this.handleMouseUp)}},this.handleMouseMove=n=>{let r=this.createEventFromMouse(n);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleMouseUp=n=>{document.removeEventListener("mousemove",this.handleMouseMove),document.removeEventListener("mouseup",this.handleMouseUp),this.emitter.trigger("pointerup",this.createEventFromMouse(n)),this.cleanup()},this.handleTouchStart=n=>{if(this.tryStart(n)){this.isTouchDragging=!0;let r=this.createEventFromTouch(n,!0);this.emitter.trigger("pointerdown",r),this.initScrollWatch(r);let c=n.target;this.shouldIgnoreMove||c.addEventListener("touchmove",this.handleTouchMove),c.addEventListener("touchend",this.handleTouchEnd),c.addEventListener("touchcancel",this.handleTouchEnd),window.addEventListener("scroll",this.handleTouchScroll,!0)}},this.handleTouchMove=n=>{let r=this.createEventFromTouch(n);this.recordCoords(r),this.emitter.trigger("pointermove",r)},this.handleTouchEnd=n=>{if(this.isDragging){let r=n.target;r.removeEventListener("touchmove",this.handleTouchMove),r.removeEventListener("touchend",this.handleTouchEnd),r.removeEventListener("touchcancel",this.handleTouchEnd),window.removeEventListener("scroll",this.handleTouchScroll,!0),this.emitter.trigger("pointerup",this.createEventFromTouch(n)),this.cleanup(),this.isTouchDragging=!1,Tme()}},this.handleTouchScroll=()=>{this.wasTouchScroll=!0},this.handleScroll=n=>{if(!this.shouldIgnoreMove){let r=window.scrollX-this.prevScrollX+this.prevPageX,c=window.scrollY-this.prevScrollY+this.prevPageY;this.emitter.trigger("pointermove",{origEvent:n,isTouch:this.isTouchDragging,subjectEl:this.subjectEl,pageX:r,pageY:c,deltaX:r-this.origPageX,deltaY:c-this.origPageY})}},this.containerEl=e,this.emitter=new gM,e.addEventListener("mousedown",this.handleMouseDown),e.addEventListener("touchstart",this.handleTouchStart,{passive:!0}),Eme()}destroy(){this.containerEl.removeEventListener("mousedown",this.handleMouseDown),this.containerEl.removeEventListener("touchstart",this.handleTouchStart,{passive:!0}),Sme()}tryStart(e){let n=this.querySubjectEl(e),r=e.target;return n&&(!this.handleSelector||zc(r,this.handleSelector))?(this.subjectEl=n,this.isDragging=!0,this.wasTouchScroll=!1,!0):!1}cleanup(){RN=!1,this.isDragging=!1,this.subjectEl=null,this.destroyScrollWatch()}querySubjectEl(e){return this.selector?zc(e.target,this.selector):this.containerEl}shouldIgnoreMouse(){return DN||this.isTouchDragging}cancelTouchScroll(){this.isDragging&&(RN=!0)}initScrollWatch(e){this.shouldWatchScroll&&(this.recordCoords(e),window.addEventListener("scroll",this.handleScroll,!0))}recordCoords(e){this.shouldWatchScroll&&(this.prevPageX=e.pageX,this.prevPageY=e.pageY,this.prevScrollX=window.scrollX,this.prevScrollY=window.scrollY)}destroyScrollWatch(){this.shouldWatchScroll&&window.removeEventListener("scroll",this.handleScroll,!0)}createEventFromMouse(e,n){let r=0,c=0;return n?(this.origPageX=e.pageX,this.origPageY=e.pageY):(r=e.pageX-this.origPageX,c=e.pageY-this.origPageY),{origEvent:e,isTouch:!1,subjectEl:this.subjectEl,pageX:e.pageX,pageY:e.pageY,deltaX:r,deltaY:c}}createEventFromTouch(e,n){let r=e.touches,c,d,m=0,s=0;return r&&r.length?(c=r[0].pageX,d=r[0].pageY):(c=e.pageX,d=e.pageY),n?(this.origPageX=c,this.origPageY=d):(m=c-this.origPageX,s=d-this.origPageY),{origEvent:e,isTouch:!0,subjectEl:this.subjectEl,pageX:c,pageY:d,deltaX:m,deltaY:s}}}function wme(t){return t.button===0&&!t.ctrlKey}function Tme(){DN+=1,setTimeout(()=>{DN-=1},WL.touchMouseIgnoreWait)}function Eme(){dI+=1,dI===1&&window.addEventListener("touchmove",P$,{passive:!1})}function Sme(){dI-=1,dI||window.removeEventListener("touchmove",P$,{passive:!1})}function P$(t){RN&&t.preventDefault()}class Ame{constructor(){this.isVisible=!1,this.sourceEl=null,this.mirrorEl=null,this.sourceElRect=null,this.parentNode=document.body,this.zIndex=9999,this.revertDuration=0}start(e,n,r){this.sourceEl=e,this.sourceElRect=this.sourceEl.getBoundingClientRect(),this.origScreenX=n-window.scrollX,this.origScreenY=r-window.scrollY,this.deltaX=0,this.deltaY=0,this.updateElPosition()}handleMove(e,n){this.deltaX=e-window.scrollX-this.origScreenX,this.deltaY=n-window.scrollY-this.origScreenY,this.updateElPosition()}setIsVisible(e){e?this.isVisible||(this.mirrorEl&&(this.mirrorEl.style.display=""),this.isVisible=e,this.updateElPosition()):this.isVisible&&(this.mirrorEl&&(this.mirrorEl.style.display="none"),this.isVisible=e)}stop(e,n){let r=()=>{this.cleanup(),n()};e&&this.mirrorEl&&this.isVisible&&this.revertDuration&&(this.deltaX||this.deltaY)?this.doRevertAnimation(r,this.revertDuration):setTimeout(r,0)}doRevertAnimation(e,n){let r=this.mirrorEl,c=this.sourceEl.getBoundingClientRect();r.style.transition="top "+n+"ms,left "+n+"ms",ZS(r,{left:c.left,top:c.top}),due(r,()=>{r.style.transition="",e()})}cleanup(){this.mirrorEl&&(CL(this.mirrorEl),this.mirrorEl=null),this.sourceEl=null}updateElPosition(){this.sourceEl&&this.isVisible&&ZS(this.getMirrorEl(),{left:this.sourceElRect.left+this.deltaX,top:this.sourceElRect.top+this.deltaY})}getMirrorEl(){let e=this.sourceElRect,n=this.mirrorEl;return n||(n=this.mirrorEl=this.sourceEl.cloneNode(!0),n.style.userSelect="none",n.style.webkitUserSelect="none",n.style.pointerEvents="none",n.classList.add("fc-event-dragging"),ZS(n,{position:"fixed",zIndex:this.zIndex,visibility:"",boxSizing:"border-box",width:e.right-e.left,height:e.bottom-e.top,right:"auto",bottom:"auto",margin:0}),this.parentNode.appendChild(n)),n}}class k$ extends qL{constructor(e,n){super(),this.handleScroll=()=>{this.scrollTop=this.scrollController.getScrollTop(),this.scrollLeft=this.scrollController.getScrollLeft(),this.handleScrollChange()},this.scrollController=e,this.doesListening=n,this.scrollTop=this.origScrollTop=e.getScrollTop(),this.scrollLeft=this.origScrollLeft=e.getScrollLeft(),this.scrollWidth=e.getScrollWidth(),this.scrollHeight=e.getScrollHeight(),this.clientWidth=e.getClientWidth(),this.clientHeight=e.getClientHeight(),this.clientRect=this.computeClientRect(),this.doesListening&&this.getEventTarget().addEventListener("scroll",this.handleScroll)}destroy(){this.doesListening&&this.getEventTarget().removeEventListener("scroll",this.handleScroll)}getScrollTop(){return this.scrollTop}getScrollLeft(){return this.scrollLeft}setScrollTop(e){this.scrollController.setScrollTop(e),this.doesListening||(this.scrollTop=Math.max(Math.min(e,this.getMaxScrollTop()),0),this.handleScrollChange())}setScrollLeft(e){this.scrollController.setScrollLeft(e),this.doesListening||(this.scrollLeft=Math.max(Math.min(e,this.getMaxScrollLeft()),0),this.handleScrollChange())}getClientWidth(){return this.clientWidth}getClientHeight(){return this.clientHeight}getScrollWidth(){return this.scrollWidth}getScrollHeight(){return this.scrollHeight}handleScrollChange(){}}class N$ extends k${constructor(e,n){super(new kde(e),n)}getEventTarget(){return this.scrollController.el}computeClientRect(){return Mde(this.scrollController.el)}}class Cme extends k${constructor(e){super(new Nde,e)}getEventTarget(){return window}computeClientRect(){return{left:this.scrollLeft,right:this.scrollLeft+this.clientWidth,top:this.scrollTop,bottom:this.scrollTop+this.clientHeight}}handleScrollChange(){this.clientRect=this.computeClientRect()}}const LU=typeof performance=="function"?performance.now:Date.now;class Dme{constructor(){this.isEnabled=!0,this.scrollQuery=[window,".fc-scroller"],this.edgeThreshold=50,this.maxVelocity=300,this.pointerScreenX=null,this.pointerScreenY=null,this.isAnimating=!1,this.scrollCaches=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.animate=()=>{if(this.isAnimating){let e=this.computeBestEdge(this.pointerScreenX+window.scrollX,this.pointerScreenY+window.scrollY);if(e){let n=LU();this.handleSide(e,(n-this.msSinceRequest)/1e3),this.requestAnimation(n)}else this.isAnimating=!1}}}start(e,n,r){this.isEnabled&&(this.scrollCaches=this.buildCaches(r),this.pointerScreenX=null,this.pointerScreenY=null,this.everMovedUp=!1,this.everMovedDown=!1,this.everMovedLeft=!1,this.everMovedRight=!1,this.handleMove(e,n))}handleMove(e,n){if(this.isEnabled){let r=e-window.scrollX,c=n-window.scrollY,d=this.pointerScreenY===null?0:c-this.pointerScreenY,m=this.pointerScreenX===null?0:r-this.pointerScreenX;d<0?this.everMovedUp=!0:d>0&&(this.everMovedDown=!0),m<0?this.everMovedLeft=!0:m>0&&(this.everMovedRight=!0),this.pointerScreenX=r,this.pointerScreenY=c,this.isAnimating||(this.isAnimating=!0,this.requestAnimation(LU()))}}stop(){if(this.isEnabled){this.isAnimating=!1;for(let e of this.scrollCaches)e.destroy();this.scrollCaches=null}}requestAnimation(e){this.msSinceRequest=e,requestAnimationFrame(this.animate)}handleSide(e,n){let{scrollCache:r}=e,{edgeThreshold:c}=this,d=c-e.distance,m=d*d/(c*c)*this.maxVelocity*n,s=1;switch(e.name){case"left":s=-1;case"right":r.setScrollLeft(r.getScrollLeft()+m*s);break;case"top":s=-1;case"bottom":r.setScrollTop(r.getScrollTop()+m*s);break}}computeBestEdge(e,n){let{edgeThreshold:r}=this,c=null,d=this.scrollCaches||[];for(let m of d){let s=m.clientRect,T=e-s.left,D=s.right-e,P=n-s.top,z=s.bottom-n;T>=0&&D>=0&&P>=0&&z>=0&&(P<=r&&this.everMovedUp&&m.canScrollUp()&&(!c||c.distance>P)&&(c={scrollCache:m,name:"top",distance:P}),z<=r&&this.everMovedDown&&m.canScrollDown()&&(!c||c.distance>z)&&(c={scrollCache:m,name:"bottom",distance:z}),T<=r&&this.everMovedLeft&&m.canScrollLeft()&&(!c||c.distance>T)&&(c={scrollCache:m,name:"left",distance:T}),D<=r&&this.everMovedRight&&m.canScrollRight()&&(!c||c.distance>D)&&(c={scrollCache:m,name:"right",distance:D}))}return c}buildCaches(e){return this.queryScrollEls(e).map(n=>n===window?new Cme(!1):new N$(n,!1))}queryScrollEls(e){let n=[];for(let r of this.scrollQuery)typeof r=="object"?n.push(r):n.push(...Array.prototype.slice.call(e.getRootNode().querySelectorAll(r)));return n}}class iC extends zde{constructor(e,n){super(e),this.containerEl=e,this.delay=null,this.minDistance=0,this.touchScrollAllowed=!0,this.mirrorNeedsRevert=!1,this.isInteracting=!1,this.isDragging=!1,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,this.delayTimeoutId=null,this.onPointerDown=c=>{this.isDragging||(this.isInteracting=!0,this.isDelayEnded=!1,this.isDistanceSurpassed=!1,fue(document.body),mue(document.body),c.isTouch||c.origEvent.preventDefault(),this.emitter.trigger("pointerdown",c),this.isInteracting&&!this.pointer.shouldIgnoreMove&&(this.mirror.setIsVisible(!1),this.mirror.start(c.subjectEl,c.pageX,c.pageY),this.startDelay(c),this.minDistance||this.handleDistanceSurpassed(c)))},this.onPointerMove=c=>{if(this.isInteracting){if(this.emitter.trigger("pointermove",c),!this.isDistanceSurpassed){let d=this.minDistance,m,{deltaX:s,deltaY:T}=c;m=s*s+T*T,m>=d*d&&this.handleDistanceSurpassed(c)}this.isDragging&&(c.origEvent.type!=="scroll"&&(this.mirror.handleMove(c.pageX,c.pageY),this.autoScroller.handleMove(c.pageX,c.pageY)),this.emitter.trigger("dragmove",c))}},this.onPointerUp=c=>{this.isInteracting&&(this.isInteracting=!1,pue(document.body),gue(document.body),this.emitter.trigger("pointerup",c),this.isDragging&&(this.autoScroller.stop(),this.tryStopDrag(c)),this.delayTimeoutId&&(clearTimeout(this.delayTimeoutId),this.delayTimeoutId=null))};let r=this.pointer=new M$(e);r.emitter.on("pointerdown",this.onPointerDown),r.emitter.on("pointermove",this.onPointerMove),r.emitter.on("pointerup",this.onPointerUp),n&&(r.selector=n),this.mirror=new Ame,this.autoScroller=new Dme}destroy(){this.pointer.destroy(),this.onPointerUp({})}startDelay(e){typeof this.delay=="number"?this.delayTimeoutId=setTimeout(()=>{this.delayTimeoutId=null,this.handleDelayEnd(e)},this.delay):this.handleDelayEnd(e)}handleDelayEnd(e){this.isDelayEnded=!0,this.tryStartDrag(e)}handleDistanceSurpassed(e){this.isDistanceSurpassed=!0,this.tryStartDrag(e)}tryStartDrag(e){this.isDelayEnded&&this.isDistanceSurpassed&&(!this.pointer.wasTouchScroll||this.touchScrollAllowed)&&(this.isDragging=!0,this.mirrorNeedsRevert=!1,this.autoScroller.start(e.pageX,e.pageY,this.containerEl),this.emitter.trigger("dragstart",e),this.touchScrollAllowed===!1&&this.pointer.cancelTouchScroll())}tryStopDrag(e){this.mirror.stop(this.mirrorNeedsRevert,this.stopDrag.bind(this,e))}stopDrag(e){this.isDragging=!1,this.emitter.trigger("dragend",e)}setIgnoreMove(e){this.pointer.shouldIgnoreMove=e}setMirrorIsVisible(e){this.mirror.setIsVisible(e)}setMirrorNeedsRevert(e){this.mirrorNeedsRevert=e}setAutoScrollEnabled(e){this.autoScroller.isEnabled=e}}class Rme{constructor(e){this.el=e,this.origRect=GL(e),this.scrollCaches=i$(e).map(n=>new N$(n,!0))}destroy(){for(let e of this.scrollCaches)e.destroy()}computeLeft(){let e=this.origRect.left;for(let n of this.scrollCaches)e+=n.origScrollLeft-n.getScrollLeft();return e}computeTop(){let e=this.origRect.top;for(let n of this.scrollCaches)e+=n.origScrollTop-n.getScrollTop();return e}isWithinClipping(e,n){let r={left:e,top:n};for(let c of this.scrollCaches)if(!Ome(c.getEventTarget())&&!xde(r,c.clientRect))return!1;return!0}}function Ome(t){let e=t.tagName;return e==="HTML"||e==="BODY"}class yM{constructor(e,n){this.useSubjectCenter=!1,this.requireInitial=!0,this.disablePointCheck=!1,this.initialHit=null,this.movingHit=null,this.finalHit=null,this.handlePointerDown=r=>{let{dragging:c}=this;this.initialHit=null,this.movingHit=null,this.finalHit=null,this.prepareHits(),this.processFirstCoord(r),this.initialHit||!this.requireInitial?(c.setIgnoreMove(!1),this.emitter.trigger("pointerdown",r)):c.setIgnoreMove(!0)},this.handleDragStart=r=>{this.emitter.trigger("dragstart",r),this.handleMove(r,!0)},this.handleDragMove=r=>{this.emitter.trigger("dragmove",r),this.handleMove(r)},this.handlePointerUp=r=>{this.releaseHits(),this.emitter.trigger("pointerup",r)},this.handleDragEnd=r=>{this.movingHit&&this.emitter.trigger("hitupdate",null,!0,r),this.finalHit=this.movingHit,this.movingHit=null,this.emitter.trigger("dragend",r)},this.droppableStore=n,e.emitter.on("pointerdown",this.handlePointerDown),e.emitter.on("dragstart",this.handleDragStart),e.emitter.on("dragmove",this.handleDragMove),e.emitter.on("pointerup",this.handlePointerUp),e.emitter.on("dragend",this.handleDragEnd),this.dragging=e,this.emitter=new gM}processFirstCoord(e){let n={left:e.pageX,top:e.pageY},r=n,c=e.subjectEl,d;c instanceof HTMLElement&&(d=GL(c),r=wde(r,d));let m=this.initialHit=this.queryHitForOffset(r.left,r.top);if(m){if(this.useSubjectCenter&&d){let s=e$(d,m.rect);s&&(r=Tde(s))}this.coordAdjust=Ede(r,n)}else this.coordAdjust={left:0,top:0}}handleMove(e,n){let r=this.queryHitForOffset(e.pageX+this.coordAdjust.left,e.pageY+this.coordAdjust.top);(n||!vM(this.movingHit,r))&&(this.movingHit=r,this.emitter.trigger("hitupdate",r,!1,e))}prepareHits(){this.offsetTrackers=kx(this.droppableStore,e=>(e.component.prepareHits(),new Rme(e.el)))}releaseHits(){let{offsetTrackers:e}=this;for(let n in e)e[n].destroy();this.offsetTrackers={}}queryHitForOffset(e,n){let{droppableStore:r,offsetTrackers:c}=this,d=null;for(let m in r){let s=r[m].component,T=c[m];if(T&&T.isWithinClipping(e,n)){let D=T.computeLeft(),P=T.computeTop(),z=e-D,F=n-P,{origRect:$}=T,J=$.right-$.left,X=$.bottom-$.top;if(z>=0&&z<J&&F>=0&&F<X){let te=s.queryHit(z,F,J,X);te&&pM(te.dateProfile.activeRange,te.dateSpan.range)&&(this.disablePointCheck||T.el.contains(T.el.getRootNode().elementFromPoint(z+D-window.scrollX,F+P-window.scrollY)))&&(!d||te.layer>d.layer)&&(te.componentId=m,te.context=s.context,te.rect.left+=D,te.rect.right+=D,te.rect.top+=P,te.rect.bottom+=P,d=te)}}}return d}}function vM(t,e){return!t&&!e?!0:!!t!=!!e?!1:ude(t.dateSpan,e.dateSpan)}function L$(t,e){let n={};for(let r of e.pluginHooks.datePointTransforms)Object.assign(n,r(t,e));return Object.assign(n,Ime(t,e.dateEnv)),n}function Ime(t,e){return{date:e.toDate(t.range.start),dateStr:e.formatIso(t.range.start,{omitTime:t.allDay}),allDay:t.allDay}}class Mme extends CT{constructor(e){super(e),this.handlePointerDown=r=>{let{dragging:c}=this,d=r.origEvent.target;c.setIgnoreMove(!this.component.isValidDateDownEl(d))},this.handleDragEnd=r=>{let{component:c}=this,{pointer:d}=this.dragging;if(!d.wasTouchScroll){let{initialHit:m,finalHit:s}=this.hitDragging;if(m&&s&&vM(m,s)){let{context:T}=c,D=Object.assign(Object.assign({},L$(m.dateSpan,T)),{dayEl:m.dayEl,jsEvent:r.origEvent,view:T.viewApi||T.calendarApi.view});T.emitter.trigger("dateClick",D)}}},this.dragging=new iC(e.el),this.dragging.autoScroller.isEnabled=!1;let n=this.hitDragging=new yM(this.dragging,HL(e));n.emitter.on("pointerdown",this.handlePointerDown),n.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}}class Pme extends CT{constructor(e){super(e),this.dragSelection=null,this.handlePointerDown=m=>{let{component:s,dragging:T}=this,{options:D}=s.context,P=D.selectable&&s.isValidDateDownEl(m.origEvent.target);T.setIgnoreMove(!P),T.delay=m.isTouch?kme(s):null},this.handleDragStart=m=>{this.component.context.calendarApi.unselect(m)},this.handleHitUpdate=(m,s)=>{let{context:T}=this.component,D=null,P=!1;if(m){let z=this.hitDragging.initialHit;m.componentId===z.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(z,m)||(D=Nme(z,m,T.pluginHooks.dateSelectionTransformers)),(!D||!Wde(D,m.dateProfile,T))&&(P=!0,D=null)}D?T.dispatch({type:"SELECT_DATES",selection:D}):s||T.dispatch({type:"UNSELECT_DATES"}),P?DL():RL(),s||(this.dragSelection=D)},this.handlePointerUp=m=>{this.dragSelection&&(qH(this.dragSelection,m,this.component.context),this.dragSelection=null)};let{component:n}=e,{options:r}=n.context,c=this.dragging=new iC(e.el);c.touchScrollAllowed=!1,c.minDistance=r.selectMinDistance||0,c.autoScroller.isEnabled=r.dragScroll;let d=this.hitDragging=new yM(this.dragging,HL(e));d.emitter.on("pointerdown",this.handlePointerDown),d.emitter.on("dragstart",this.handleDragStart),d.emitter.on("hitupdate",this.handleHitUpdate),d.emitter.on("pointerup",this.handlePointerUp)}destroy(){this.dragging.destroy()}}function kme(t){let{options:e}=t.context,n=e.selectLongPressDelay;return n==null&&(n=e.longPressDelay),n}function Nme(t,e,n){let r=t.dateSpan,c=e.dateSpan,d=[r.range.start,r.range.end,c.range.start,c.range.end];d.sort(xue);let m={};for(let s of n){let T=s(t,e);if(T===!1)return null;T&&Object.assign(m,T)}return m.range={start:d[0],end:d[3]},m.allDay=r.allDay,m}class rC extends CT{constructor(e){super(e),this.subjectEl=null,this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=m=>{let s=m.origEvent.target,{component:T,dragging:D}=this,{mirror:P}=D,{options:z}=T.context,F=T.context;this.subjectEl=m.subjectEl;let $=this.subjectSeg=uT(m.subjectEl),X=(this.eventRange=$.eventRange).instance.instanceId;this.relevantEvents=FL(F.getCurrentData().eventStore,X),D.minDistance=m.isTouch?0:z.eventDragMinDistance,D.delay=m.isTouch&&X!==T.props.eventSelection?zme(T):null,z.fixedMirrorParent?P.parentNode=z.fixedMirrorParent:P.parentNode=zc(s,".fc"),P.revertDuration=z.dragRevertDuration;let te=T.isValidSegDownEl(s)&&!zc(s,".fc-event-resizer");D.setIgnoreMove(!te),this.isDragging=te&&m.subjectEl.classList.contains("fc-event-draggable")},this.handleDragStart=m=>{let s=this.component.context,T=this.eventRange,D=T.instance.instanceId;m.isTouch?D!==this.component.props.eventSelection&&s.dispatch({type:"SELECT_EVENT",eventInstanceId:D}):s.dispatch({type:"UNSELECT_EVENT"}),this.isDragging&&(s.calendarApi.unselect(m),s.emitter.trigger("eventDragStart",{el:this.subjectEl,event:new Io(s,T.def,T.instance),jsEvent:m.origEvent,view:s.viewApi}))},this.handleHitUpdate=(m,s)=>{if(!this.isDragging)return;let T=this.relevantEvents,D=this.hitDragging.initialHit,P=this.component.context,z=null,F=null,$=null,J=!1,X={affectedEvents:T,mutatedEvents:gp(),isEvent:!0};if(m){z=m.context;let te=z.options;P===z||te.editable&&te.droppable?(F=Lme(D,m,this.eventRange.instance.range.start,z.getCurrentData().pluginHooks.eventDragMutationMassagers),F&&($=jL(T,z.getCurrentData().eventUiBases,F,z),X.mutatedEvents=$,a$(X,m.dateProfile,z)||(J=!0,F=null,$=null,X.mutatedEvents=gp()))):z=null}this.displayDrag(z,X),J?DL():RL(),s||(P===z&&vM(D,m)&&(F=null),this.dragging.setMirrorNeedsRevert(!F),this.dragging.setMirrorIsVisible(!m||!this.subjectEl.getRootNode().querySelector(".fc-event-mirror")),this.receivingContext=z,this.validMutation=F,this.mutatedRelevantEvents=$)},this.handlePointerUp=()=>{this.isDragging||this.cleanup()},this.handleDragEnd=m=>{if(this.isDragging){let s=this.component.context,T=s.viewApi,{receivingContext:D,validMutation:P}=this,z=this.eventRange.def,F=this.eventRange.instance,$=new Io(s,z,F),J=this.relevantEvents,X=this.mutatedRelevantEvents,{finalHit:te}=this.hitDragging;if(this.clearDrag(),s.emitter.trigger("eventDragStop",{el:this.subjectEl,event:$,jsEvent:m.origEvent,view:T}),P){if(D===s){let ie=new Io(s,X.defs[z.defId],F?X.instances[F.instanceId]:null);s.dispatch({type:"MERGE_EVENTS",eventStore:X});let we={oldEvent:$,event:ie,relatedEvents:ux(X,s,F),revert(){s.dispatch({type:"MERGE_EVENTS",eventStore:J})}},Ie={};for(let Re of s.getCurrentData().pluginHooks.eventDropTransformers)Object.assign(Ie,Re(P,s));s.emitter.trigger("eventDrop",Object.assign(Object.assign(Object.assign({},we),Ie),{el:m.subjectEl,delta:P.datesDelta,jsEvent:m.origEvent,view:T})),s.emitter.trigger("eventChange",we)}else if(D){let ie={event:$,relatedEvents:ux(J,s,F),revert(){s.dispatch({type:"MERGE_EVENTS",eventStore:J})}};s.emitter.trigger("eventLeave",Object.assign(Object.assign({},ie),{draggedEl:m.subjectEl,view:T})),s.dispatch({type:"REMOVE_EVENTS",eventStore:J}),s.emitter.trigger("eventRemove",ie);let we=X.defs[z.defId],Ie=X.instances[F.instanceId],Re=new Io(D,we,Ie);D.dispatch({type:"MERGE_EVENTS",eventStore:X});let Ne={event:Re,relatedEvents:ux(X,D,Ie),revert(){D.dispatch({type:"REMOVE_EVENTS",eventStore:X})}};D.emitter.trigger("eventAdd",Ne),m.isTouch&&D.dispatch({type:"SELECT_EVENT",eventInstanceId:F.instanceId}),D.emitter.trigger("drop",Object.assign(Object.assign({},L$(te.dateSpan,D)),{draggedEl:m.subjectEl,jsEvent:m.origEvent,view:te.context.viewApi})),D.emitter.trigger("eventReceive",Object.assign(Object.assign({},Ne),{draggedEl:m.subjectEl,view:te.context.viewApi}))}}else s.emitter.trigger("_noEventDrop")}this.cleanup()};let{component:n}=this,{options:r}=n.context,c=this.dragging=new iC(e.el);c.pointer.selector=rC.SELECTOR,c.touchScrollAllowed=!1,c.autoScroller.isEnabled=r.dragScroll;let d=this.hitDragging=new yM(this.dragging,SN);d.useSubjectCenter=e.useEventCenter,d.emitter.on("pointerdown",this.handlePointerDown),d.emitter.on("dragstart",this.handleDragStart),d.emitter.on("hitupdate",this.handleHitUpdate),d.emitter.on("pointerup",this.handlePointerUp),d.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}displayDrag(e,n){let r=this.component.context,c=this.receivingContext;c&&c!==e&&(c===r?c.dispatch({type:"SET_EVENT_DRAG",state:{affectedEvents:n.affectedEvents,mutatedEvents:gp(),isEvent:!0}}):c.dispatch({type:"UNSET_EVENT_DRAG"})),e&&e.dispatch({type:"SET_EVENT_DRAG",state:n})}clearDrag(){let e=this.component.context,{receivingContext:n}=this;n&&n.dispatch({type:"UNSET_EVENT_DRAG"}),e!==n&&e.dispatch({type:"UNSET_EVENT_DRAG"})}cleanup(){this.subjectSeg=null,this.isDragging=!1,this.eventRange=null,this.relevantEvents=null,this.receivingContext=null,this.validMutation=null,this.mutatedRelevantEvents=null}}rC.SELECTOR=".fc-event-draggable, .fc-event-resizable";function Lme(t,e,n,r){let c=t.dateSpan,d=e.dateSpan,m=c.range.start,s=d.range.start,T={};c.allDay!==d.allDay&&(T.allDay=d.allDay,T.hasEnd=e.context.options.allDayMaintainDuration,d.allDay?m=Oo(n):m=n);let D=Ow(m,s,t.context.dateEnv,t.componentId===e.componentId?t.largeUnit:null);D.milliseconds&&(T.allDay=!1);let P={datesDelta:D,standardProps:T};for(let z of r)z(P,t,e);return P}function zme(t){let{options:e}=t.context,n=e.eventLongPressDelay;return n==null&&(n=e.longPressDelay),n}class Bme extends CT{constructor(e){super(e),this.draggingSegEl=null,this.draggingSeg=null,this.eventRange=null,this.relevantEvents=null,this.validMutation=null,this.mutatedRelevantEvents=null,this.handlePointerDown=d=>{let{component:m}=this,s=this.querySegEl(d),T=uT(s),D=this.eventRange=T.eventRange;this.dragging.minDistance=m.context.options.eventDragMinDistance,this.dragging.setIgnoreMove(!this.component.isValidSegDownEl(d.origEvent.target)||d.isTouch&&this.component.props.eventSelection!==D.instance.instanceId)},this.handleDragStart=d=>{let{context:m}=this.component,s=this.eventRange;this.relevantEvents=FL(m.getCurrentData().eventStore,this.eventRange.instance.instanceId);let T=this.querySegEl(d);this.draggingSegEl=T,this.draggingSeg=uT(T),m.calendarApi.unselect(),m.emitter.trigger("eventResizeStart",{el:T,event:new Io(m,s.def,s.instance),jsEvent:d.origEvent,view:m.viewApi})},this.handleHitUpdate=(d,m,s)=>{let{context:T}=this.component,D=this.relevantEvents,P=this.hitDragging.initialHit,z=this.eventRange.instance,F=null,$=null,J=!1,X={affectedEvents:D,mutatedEvents:gp(),isEvent:!0};d&&(d.componentId===P.componentId&&this.isHitComboAllowed&&!this.isHitComboAllowed(P,d)||(F=Fme(P,d,s.subjectEl.classList.contains("fc-event-resizer-start"),z.range))),F&&($=jL(D,T.getCurrentData().eventUiBases,F,T),X.mutatedEvents=$,a$(X,d.dateProfile,T)||(J=!0,F=null,$=null,X.mutatedEvents=null)),$?T.dispatch({type:"SET_EVENT_RESIZE",state:X}):T.dispatch({type:"UNSET_EVENT_RESIZE"}),J?DL():RL(),m||(F&&vM(P,d)&&(F=null),this.validMutation=F,this.mutatedRelevantEvents=$)},this.handleDragEnd=d=>{let{context:m}=this.component,s=this.eventRange.def,T=this.eventRange.instance,D=new Io(m,s,T),P=this.relevantEvents,z=this.mutatedRelevantEvents;if(m.emitter.trigger("eventResizeStop",{el:this.draggingSegEl,event:D,jsEvent:d.origEvent,view:m.viewApi}),this.validMutation){let F=new Io(m,z.defs[s.defId],T?z.instances[T.instanceId]:null);m.dispatch({type:"MERGE_EVENTS",eventStore:z});let $={oldEvent:D,event:F,relatedEvents:ux(z,m,T),revert(){m.dispatch({type:"MERGE_EVENTS",eventStore:P})}};m.emitter.trigger("eventResize",Object.assign(Object.assign({},$),{el:this.draggingSegEl,startDelta:this.validMutation.startDelta||Rs(0),endDelta:this.validMutation.endDelta||Rs(0),jsEvent:d.origEvent,view:m.viewApi})),m.emitter.trigger("eventChange",$)}else m.emitter.trigger("_noEventResize");this.draggingSeg=null,this.relevantEvents=null,this.validMutation=null};let{component:n}=e,r=this.dragging=new iC(e.el);r.pointer.selector=".fc-event-resizer",r.touchScrollAllowed=!1,r.autoScroller.isEnabled=n.context.options.dragScroll;let c=this.hitDragging=new yM(this.dragging,HL(e));c.emitter.on("pointerdown",this.handlePointerDown),c.emitter.on("dragstart",this.handleDragStart),c.emitter.on("hitupdate",this.handleHitUpdate),c.emitter.on("dragend",this.handleDragEnd)}destroy(){this.dragging.destroy()}querySegEl(e){return zc(e.subjectEl,".fc-event")}}function Fme(t,e,n,r){let c=t.context.dateEnv,d=t.dateSpan.range.start,m=e.dateSpan.range.start,s=Ow(d,m,c,t.largeUnit);if(n){if(c.add(r.start,s)<r.end)return{startDelta:s}}else if(c.add(r.end,s)>r.start)return{endDelta:s};return null}class Vme{constructor(e){this.context=e,this.isRecentPointerDateSelect=!1,this.matchesCancel=!1,this.matchesEvent=!1,this.onSelect=r=>{r.jsEvent&&(this.isRecentPointerDateSelect=!0)},this.onDocumentPointerDown=r=>{let c=this.context.options.unselectCancel,d=SH(r.origEvent);this.matchesCancel=!!zc(d,c),this.matchesEvent=!!zc(d,rC.SELECTOR)},this.onDocumentPointerUp=r=>{let{context:c}=this,{documentPointer:d}=this,m=c.getCurrentData();if(!d.wasTouchScroll){if(m.dateSelection&&!this.isRecentPointerDateSelect){let s=c.options.unselectAuto;s&&(!s||!this.matchesCancel)&&c.calendarApi.unselect(r)}m.eventSelection&&!this.matchesEvent&&c.dispatch({type:"UNSELECT_EVENT"})}this.isRecentPointerDateSelect=!1};let n=this.documentPointer=new M$(document);n.shouldIgnoreMove=!0,n.shouldWatchScroll=!1,n.emitter.on("pointerdown",this.onDocumentPointerDown),n.emitter.on("pointerup",this.onDocumentPointerUp),e.emitter.on("select",this.onSelect)}destroy(){this.context.emitter.off("select",this.onSelect),this.documentPointer.destroy()}}const Ume={fixedMirrorParent:nn},jme={dateClick:nn,eventDragStart:nn,eventDragStop:nn,eventDrop:nn,eventResizeStart:nn,eventResizeStop:nn,eventResize:nn,drop:nn,eventReceive:nn,eventLeave:nn};WL.dataAttrPrefix="";var Hme=h0({name:"@fullcalendar/interaction",componentInteractions:[Mme,Pme,rC,Bme],calendarInteractions:[Vme],elementDraggingImpl:iC,optionRefiners:Ume,listenerRefiners:jme});const $me=()=>{const{events:t,reminders:e,createReminder:n,deleteReminder:r}=oM(),{currentList:c}=cf(),[d,m]=ke.useState(!1),[s,T]=ke.useState({listId:"",itemName:"",intervalWeeks:2}),D=ke.useMemo(()=>c?t.filter(X=>X.listId===c.id):[],[t,c]),P=ke.useMemo(()=>c?e.filter(X=>X.listId===c.id):[],[e,c]),z=D.map(X=>({id:X.id,title:X.title,date:X.date,backgroundColor:X.backgroundColor,borderColor:X.borderColor,extendedProps:{type:X.type,listId:X.listId,listName:X.listName,itemId:X.itemId,itemName:X.itemName}})),F=()=>{T({listId:(c==null?void 0:c.id)||"",itemName:"",intervalWeeks:2}),m(!0)},$=()=>{m(!1)},J=async()=>{s.itemName.trim()&&(await n(s.listId,s.itemName,s.intervalWeeks),$())};return c?de.jsxDEV("div",{className:"calendar-page",children:[de.jsxDEV("div",{className:"calendar-header",children:[de.jsxDEV("h1",{children:["📅 Calendari - ",c.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:95,columnNumber:9},void 0),de.jsxDEV("p",{children:"Esdeveniments i recordatoris de la llista seleccionada"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:96,columnNumber:9},void 0),de.jsxDEV("div",{className:"calendar-actions",children:de.jsxDEV("button",{onClick:F,className:"create-reminder-btn",children:"➕ Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:98,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:97,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:94,columnNumber:7},void 0),de.jsxDEV("div",{className:"calendar-container",children:de.jsxDEV(T$,{plugins:[xme,Hme],initialView:"dayGridMonth",headerToolbar:{left:"prev,next",center:"title",right:""},events:z,height:"auto",locale:"ca",firstDay:1,eventDisplay:"block",dayMaxEvents:3,moreLinkClick:"popover"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:108,columnNumber:9},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:107,columnNumber:7},void 0),de.jsxDEV("div",{className:"reminders-section",children:[de.jsxDEV("h3",{children:"Recordatoris Actius"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:128,columnNumber:9},void 0),de.jsxDEV("div",{className:"reminders-list",children:[P.map(X=>de.jsxDEV("div",{className:"reminder-item",children:[de.jsxDEV("div",{className:"reminder-info",children:[de.jsxDEV("h4",{children:X.itemName},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:133,columnNumber:17},void 0),de.jsxDEV("p",{children:["Cada ",X.intervalWeeks," setmanes"]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:134,columnNumber:17},void 0),de.jsxDEV("p",{children:["Proper recordatori: ",new Date(X.reminderDate).toLocaleDateString("ca-ES")]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:135,columnNumber:17},void 0),X.supermarket&&de.jsxDEV("p",{children:["Supermercat: ",X.supermarket.name]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:137,columnNumber:19},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:132,columnNumber:15},void 0),de.jsxDEV("button",{onClick:()=>r(X.id),className:"delete-reminder-btn",children:"🗑️"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:140,columnNumber:15},void 0)]},X.id,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:131,columnNumber:13},void 0)),P.length===0&&de.jsxDEV("p",{className:"no-reminders",children:"No tens recordatoris actius per aquesta llista"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:149,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:129,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:127,columnNumber:7},void 0),d&&de.jsxDEV("div",{className:"modal-overlay",onClick:$,children:de.jsxDEV("div",{className:"modal-content",onClick:X=>X.stopPropagation(),children:[de.jsxDEV("h3",{children:"Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:158,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{children:"Nom del producte:"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:160,columnNumber:15},void 0),de.jsxDEV("input",{type:"text",value:s.itemName,onChange:X=>T(te=>({...te,itemName:X.target.value})),placeholder:"Ex: Llet, Pa, etc."},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:161,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:159,columnNumber:13},void 0),de.jsxDEV("div",{className:"form-group",children:[de.jsxDEV("label",{children:"Recordar cada (setmanes):"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:172,columnNumber:15},void 0),de.jsxDEV("select",{value:s.intervalWeeks,onChange:X=>T(te=>({...te,intervalWeeks:parseInt(X.target.value)})),children:[de.jsxDEV("option",{value:1,children:"1 setmana"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:180,columnNumber:17},void 0),de.jsxDEV("option",{value:2,children:"2 setmanes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:181,columnNumber:17},void 0),de.jsxDEV("option",{value:3,children:"3 setmanes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:182,columnNumber:17},void 0),de.jsxDEV("option",{value:4,children:"1 mes"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:183,columnNumber:17},void 0),de.jsxDEV("option",{value:8,children:"2 mesos"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:184,columnNumber:17},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:173,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:171,columnNumber:13},void 0),de.jsxDEV("div",{className:"modal-actions",children:[de.jsxDEV("button",{onClick:$,className:"cancel-btn",children:"Cancel·lar"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:189,columnNumber:15},void 0),de.jsxDEV("button",{onClick:J,className:"confirm-btn",children:"Crear Recordatori"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:192,columnNumber:15},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:188,columnNumber:13},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:157,columnNumber:11},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:156,columnNumber:9},void 0)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:93,columnNumber:5},void 0):de.jsxDEV(wx,{pageTitle:"Calendari",pageIcon:"📅",description:"Selecciona una llista per veure els esdeveniments i recordatoris"},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/pages/CalendarPage.tsx",lineNumber:84,columnNumber:7},void 0)};function Gme(){return de.jsxDEV(MQ,{children:de.jsxDEV(lse,{children:de.jsxDEV(cse,{children:[de.jsxDEV(ase,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:23,columnNumber:11},this),de.jsxDEV(lQ,{children:[de.jsxDEV(f_,{path:"/",element:de.jsxDEV(Ose,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:25,columnNumber:38},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:25,columnNumber:13},this),de.jsxDEV(f_,{path:"/pendents",element:de.jsxDEV(Ise,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:26,columnNumber:46},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:26,columnNumber:13},this),de.jsxDEV(f_,{path:"/profile",element:de.jsxDEV(Mse,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:27,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:27,columnNumber:13},this),de.jsxDEV(f_,{path:"/lists",element:de.jsxDEV(Pse,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:28,columnNumber:43},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:28,columnNumber:13},this),de.jsxDEV(f_,{path:"/register",element:de.jsxDEV(Lse,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:29,columnNumber:46},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:29,columnNumber:13},this),de.jsxDEV(f_,{path:"/mapa",element:de.jsxDEV(Vse,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:30,columnNumber:42},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:30,columnNumber:13},this),de.jsxDEV(f_,{path:"/calendari",element:de.jsxDEV($me,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:31,columnNumber:47},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:31,columnNumber:13},this),de.jsxDEV(f_,{path:"/grafics",element:de.jsxDEV(Nce,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:32,columnNumber:45},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:32,columnNumber:13},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:24,columnNumber:11},this)]},void 0,!0,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:22,columnNumber:9},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:21,columnNumber:7},this)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/App.tsx",lineNumber:20,columnNumber:5},this)}K$.createRoot(document.getElementById("root")).render(de.jsxDEV(Bc.StrictMode,{children:de.jsxDEV(sse,{children:de.jsxDEV(Gme,{},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/main.tsx",lineNumber:11,columnNumber:7},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/main.tsx",lineNumber:10,columnNumber:5},void 0)},void 0,!1,{fileName:"C:/Users/paula/OneDrive/Desktop/BOOTCAMP/Sprint8/src/main.tsx",lineNumber:9,columnNumber:3},void 0));
